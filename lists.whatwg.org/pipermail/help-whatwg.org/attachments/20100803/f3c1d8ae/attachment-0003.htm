<tt>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Aug&nbsp;3,&nbsp;2010&nbsp;at&nbsp;1:40&nbsp;PM,&nbsp;Rik&nbsp;Sagar&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:org.whatwg@sagar.org&quot;&gt;org.whatwg@sagar.org&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;br&gt;I&nbsp;would&nbsp;expect&nbsp;in&nbsp;this&nbsp;example&nbsp;that&nbsp;the&nbsp;&lt;i&gt;Worker&nbsp;got&nbsp;loaded&lt;/i&gt; &nbsp;message&nbsp;should&nbsp;be&nbsp;dropped&nbsp;on&nbsp;the&nbsp;floor.&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;I&nbsp;would&nbsp;expect&nbsp;exactly&nbsp;the&nbsp;opposite&nbsp;-&nbsp;that&nbsp;message&nbsp;should&nbsp;be&nbsp;delivered.&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;Here&#39;s&nbsp;the&nbsp;way&nbsp;I&nbsp;look&nbsp;at&nbsp;worker&nbsp;messaging&nbsp;(and&nbsp;events&nbsp;in&nbsp;general)&nbsp;-&nbsp;each&nbsp;javascript&nbsp;context&nbsp;(or&nbsp;&quot;thread&quot;&nbsp;if&nbsp;you&nbsp;will)&nbsp;has&nbsp;what&nbsp;amounts&nbsp;to&nbsp;an&nbsp;event&nbsp;loop.&nbsp;When&nbsp;your&nbsp;javascript&nbsp;code&nbsp;returns&nbsp;from&nbsp;an&nbsp;event&nbsp;handler&nbsp;(or,&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;worker&nbsp;script,&nbsp;returns&nbsp;from&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;returns&nbsp;from&nbsp;executing&nbsp;the&nbsp;initial&nbsp;block&nbsp;of&nbsp;script),&nbsp;you&nbsp;drop&nbsp;back&nbsp;in&nbsp;to&nbsp;your&nbsp;event&nbsp;loop&nbsp;and&nbsp;start&nbsp;dispatching&nbsp;events.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;are&nbsp;a&nbsp;number&nbsp;of&nbsp;things&nbsp;that&nbsp;can&nbsp;generate&nbsp;events&nbsp;(that&nbsp;can&nbsp;be&nbsp;&quot;event&nbsp;sources&quot;)&nbsp;-&nbsp;for&nbsp;example,&nbsp;a&nbsp;timer&nbsp;is&nbsp;an&nbsp;event&nbsp;source.&nbsp;MessagePorts&nbsp;(both&nbsp;explicit&nbsp;MessagePorts&nbsp;and&nbsp;also&nbsp;implicit&nbsp;ones&nbsp;for&nbsp;Dedicated&nbsp;Workers)&nbsp;are&nbsp;event&nbsp;sources,&nbsp;too.&nbsp;When&nbsp;you&nbsp;queue&nbsp;up&nbsp;an&nbsp;event&nbsp;for&nbsp;a&nbsp;MessagePort,&nbsp;it&nbsp;becomes&nbsp;an&nbsp;active&nbsp;event&nbsp;source&nbsp;(meaning&nbsp;that&nbsp;when&nbsp;the&nbsp;associated&nbsp;javascript&nbsp;context&nbsp;re-enters&nbsp;its&nbsp;event&nbsp;loop,&nbsp;that&nbsp;MessagePort&nbsp;can&nbsp;cause&nbsp;an&nbsp;onmessage&nbsp;event&nbsp;to&nbsp;be&nbsp;generated).&nbsp;The&nbsp;event&nbsp;loop&nbsp;traverses&nbsp;the&nbsp;various&nbsp;associated&nbsp;event&nbsp;sources&nbsp;for&nbsp;the&nbsp;javascript&nbsp;context&nbsp;(timers,&nbsp;message&nbsp;ports,&nbsp;etc)&nbsp;and&nbsp;fires&nbsp;off&nbsp;an&nbsp;event&nbsp;from&nbsp;one&nbsp;of&nbsp;the&nbsp;event&nbsp;sources&nbsp;(the&nbsp;spec&nbsp;doesn&#39;t&nbsp;specify&nbsp;an&nbsp;ordering&nbsp;here,&nbsp;so&nbsp;it&#39;s&nbsp;up&nbsp;to&nbsp;the&nbsp;UA&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;prioritize&nbsp;various&nbsp;event&nbsp;sources)&nbsp;-&nbsp;when&nbsp;it&nbsp;fires&nbsp;off&nbsp;the&nbsp;event,&nbsp;any&nbsp;handlers&nbsp;associated&nbsp;with&nbsp;that&nbsp;event&nbsp;will&nbsp;receive&nbsp;the&nbsp;event,&nbsp;and&nbsp;if&nbsp;there&nbsp;are&nbsp;no&nbsp;handlers&nbsp;the&nbsp;typical&nbsp;default&nbsp;handling&nbsp;of&nbsp;the&nbsp;event&nbsp;occurs&nbsp;(gets&nbsp;dropped&nbsp;on&nbsp;the&nbsp;floor,&nbsp;or&nbsp;maybe&nbsp;gets&nbsp;bubbled&nbsp;up&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;DOM&nbsp;events,&nbsp;etc).&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So,&nbsp;in&nbsp;your&nbsp;case&nbsp;above,&nbsp;here&#39;s&nbsp;what&nbsp;happens&nbsp;-&nbsp;webapp_main&nbsp;creates&nbsp;a&nbsp;worker&nbsp;and&nbsp;then&nbsp;adds&nbsp;an&nbsp;&quot;onmessage&quot;&nbsp;handler&nbsp;to&nbsp;the&nbsp;worker&nbsp;object.&nbsp;Now,&nbsp;webapp_worker&nbsp;runs,&nbsp;sets&nbsp;up&nbsp;an&nbsp;onmessage&nbsp;handler&nbsp;(which,&nbsp;btw,&nbsp;will&nbsp;never&nbsp;be&nbsp;executed&nbsp;since&nbsp;you&nbsp;never&nbsp;send&nbsp;any&nbsp;messages&nbsp;to&nbsp;the&nbsp;worker&nbsp;in&nbsp;your&nbsp;example),&nbsp;then&nbsp;fires&nbsp;off&nbsp;a&nbsp;&quot;Worker&nbsp;got&nbsp;loaded&quot;&nbsp;message&nbsp;to&nbsp;webapp_main.&nbsp;Even&nbsp;if&nbsp;this&nbsp;code&nbsp;is&nbsp;executed&nbsp;before&nbsp;webapp_main&nbsp;has&nbsp;set&nbsp;its&nbsp;onmessage&nbsp;handler,&nbsp;the&nbsp;event&nbsp;will&nbsp;not&nbsp;get&nbsp;dropped&nbsp;on&nbsp;the&nbsp;floor&nbsp;-&nbsp;remember&nbsp;that&nbsp;all&nbsp;postMessage()&nbsp;does&nbsp;is&nbsp;put&nbsp;the&nbsp;event&nbsp;in&nbsp;the&nbsp;MessagePort&#39;s&nbsp;queue,&nbsp;then&nbsp;make&nbsp;that&nbsp;MessagePort&nbsp;an&nbsp;active&nbsp;event&nbsp;source.&nbsp;So&nbsp;as&nbsp;long&nbsp;as&nbsp;webapp_main&nbsp;sets&nbsp;an&nbsp;onmessage&nbsp;handler&nbsp;before&nbsp;it&nbsp;returns&nbsp;back&nbsp;to&nbsp;the&nbsp;event&nbsp;loop,&nbsp;there&#39;s&nbsp;no&nbsp;way&nbsp;for&nbsp;the&nbsp;event&nbsp;to&nbsp;get&nbsp;dropped&nbsp;on&nbsp;the&nbsp;floor&nbsp;because&nbsp;the&nbsp;event&nbsp;isn&#39;t&nbsp;even&nbsp;dispatched&nbsp;until&nbsp;you&nbsp;get&nbsp;back&nbsp;to&nbsp;the&nbsp;event&nbsp;loop.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hopefully&nbsp;this&nbsp;helps&nbsp;clear&nbsp;up&nbsp;some&nbsp;of&nbsp;the&nbsp;confusion&nbsp;-&nbsp;it&#39;s&nbsp;important&nbsp;to&nbsp;understand&nbsp;that&nbsp;the&nbsp;various&nbsp;flavors&nbsp;of&nbsp;postMessage()&nbsp;are&nbsp;entirely&nbsp;asynchronous&nbsp;and&nbsp;rely&nbsp;on&nbsp;events&nbsp;being&nbsp;dispatched&nbsp;from&nbsp;the&nbsp;event&nbsp;loop.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Thanks,&lt;br&gt;Rik.&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;Rik&nbsp;Sagar,&nbsp;San&nbsp;Jose,&nbsp;CA&nbsp;95124&lt;br&gt;<br>
Visit&nbsp;:&nbsp;&lt;a&nbsp;href=&quot;http://sagar.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://sagar.org/&lt;/a&gt;&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
<br>
 &lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Aug&nbsp;2,&nbsp;2010&nbsp;at&nbsp;10:09&nbsp;AM,&nbsp;Drew&nbsp;Wilson&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:atwilson@chromium.org&quot;&nbsp;target=&quot;_blank&quot;&gt;atwilson@chromium.org&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);padding-left:1ex&quot;&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;(sending&nbsp;from&nbsp;the&nbsp;correct&nbsp;address&nbsp;this&nbsp;time)&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;sans-serif,&nbsp;&#39;Droid&nbsp;Sans&nbsp;Fallback&#39;&quot;&gt;&lt;span&nbsp;style=&quot;line-height:21px;font-size:medium&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Aug&nbsp;2,&nbsp;2010&nbsp;at&nbsp;7:57&nbsp;AM,&nbsp;Jeremy&nbsp;Orlow&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:jorlow@google.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jorlow@google.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);padding-left:1ex&quot;&gt;<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;----------&nbsp;Forwarded&nbsp;message&nbsp;----------&lt;br&gt;From:&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Tobias&nbsp;Sauerwein&lt;/b&gt;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:tobias.sauerwein@camptocamp.com&quot;&nbsp;target=&quot;_blank&quot;&gt;tobias.sauerwein@camptocamp.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Date:&nbsp;Tue,&nbsp;Jul&nbsp;27,&nbsp;2010&nbsp;at&nbsp;8:46&nbsp;AM&lt;br&gt;Subject:&nbsp;[html5]&nbsp;Web&nbsp;Workers:&nbsp;Race-Condition&nbsp;setting&nbsp;onmessage&nbsp;handler?&lt;br&gt;To:&nbsp;&lt;a&nbsp;href=&quot;mailto:help@lists.whatwg.org&quot;&nbsp;target=&quot;_blank&quot;&gt;help@lists.whatwg.org&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Hi!&lt;br&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
I&nbsp;am&nbsp;wondering&nbsp;what&nbsp;prevents&nbsp;a&nbsp;web&nbsp;worker&nbsp;from&nbsp;running&nbsp;into&nbsp;race-conditions&nbsp;when&nbsp;setting&nbsp;the&nbsp;onmessage&nbsp;handlers.&nbsp;I&nbsp;am&nbsp;worried&nbsp;about&nbsp;that&nbsp;a&nbsp;web&nbsp;worker&nbsp;posts&nbsp;a&nbsp;message&nbsp;before&nbsp;the&nbsp;main&nbsp;script&nbsp;has&nbsp;set&nbsp;up&nbsp;the&nbsp;onmessage&nbsp;handler,&nbsp;or&nbsp;the&nbsp;other&nbsp;way&nbsp;around,&nbsp;that&nbsp;the&nbsp;web&nbsp;worker&nbsp;posts&nbsp;a&nbsp;message&nbsp;before&nbsp;the&nbsp;main&nbsp;script&nbsp;has&nbsp;set&nbsp;up&nbsp;its&nbsp;onmessage&nbsp;handler.&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt;I&nbsp;know&nbsp;that&nbsp;there&nbsp;is&nbsp;a&nbsp;message&nbsp;queue&nbsp;[1],&nbsp;but&nbsp;you&nbsp;can&nbsp;easily&nbsp;make&nbsp;up&nbsp;an&nbsp;example&nbsp;where&nbsp;a&nbsp;message&nbsp;is&nbsp;not&nbsp;enqueued:&lt;br&gt;&lt;br&gt;Main&nbsp;Script:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;border-left:1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);margin:0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;padding-left:1ex&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
var&nbsp;worker&nbsp;=&nbsp;new&nbsp;Worker(&quot;webworker.js&quot;);&lt;br&gt;worker.onmessage&nbsp;=&nbsp;function(event)&nbsp;{&lt;br&gt;   &nbsp;console.log(&#39;onmessage&nbsp;&#39;&nbsp;+&nbsp;event.data)   &nbsp;&lt;br&gt;};&lt;br&gt;worker.postMessage(&quot;start&quot;);&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&#39;webworker.js&#39;:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;style=&quot;border-left:1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);margin:0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;padding-left:1ex&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;setTimeout(&lt;br&gt;   &nbsp;function()&nbsp;{&lt;br&gt;       &nbsp;onmessage&nbsp;=&nbsp;function(event)&nbsp;{&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
           &nbsp;postMessage(&quot;message&nbsp;received&quot;);   &nbsp;&lt;br&gt;       &nbsp;};&lt;br&gt;       &nbsp;postMessage(&quot;done&quot;);&lt;br&gt;   &nbsp;},&nbsp;1000);&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;br&gt;The&nbsp;output&nbsp;is&nbsp;(in&nbsp;Chromium&nbsp;6.0.475.0&nbsp;and&nbsp;Firefox&nbsp;4.01b,&nbsp;Opera&nbsp;10.70&nbsp;also&nbsp;outputs&nbsp;&quot;onmessage&nbsp;message&nbsp;received&quot;):&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt;&lt;blockquote&nbsp;style=&quot;border-left:1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);margin:0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;padding-left:1ex&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;onmessage&nbsp;done&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;So&nbsp;the&nbsp;&quot;onmessage&quot;&nbsp;handler&nbsp;of&nbsp;the&nbsp;web&nbsp;worker&nbsp;is&nbsp;never&nbsp;called.&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt;&lt;br&gt;Is&nbsp;this&nbsp;the&nbsp;behavior&nbsp;the&nbsp;specification&nbsp;requests,&nbsp;or&nbsp;is&nbsp;it&nbsp;a&nbsp;bug&nbsp;in&nbsp;Chrome/Chromium&nbsp;and&nbsp;Firefox?&lt;br&gt;&lt;br&gt;Tobias&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;[1]:&nbsp;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#port-message-queue&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#port-message-queue&lt;/a&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt;<br>
Help&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Help@lists.whatwg.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Help@lists.whatwg.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.whatwg.org/listinfo.cgi/help-whatwg.org&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.whatwg.org/listinfo.cgi/help-whatwg.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;This&nbsp;is&nbsp;the&nbsp;correct&nbsp;behavior.&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;onmessage&nbsp;event&nbsp;at&nbsp;the&nbsp;time&nbsp;that&nbsp;an&nbsp;event&nbsp;arrives&nbsp;at&nbsp;the&nbsp;worker&#39;s&nbsp;event&nbsp;loop,&nbsp;it&nbsp;will&nbsp;be&nbsp;dropped&nbsp;on&nbsp;the&nbsp;floor.&nbsp;The&nbsp;reason&nbsp;this&nbsp;happens&nbsp;is&nbsp;steps&nbsp;7/8&nbsp;in&nbsp;section&nbsp;4.5&nbsp;of&nbsp;the&nbsp;worker&nbsp;spec:&lt;div&gt;<br>
<br>
<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:sans-serif,&#39;Droid&nbsp;Sans&nbsp;Fallback&#39;;font-size:medium;line-height:21px&quot;&gt;&lt;span&nbsp;title=&quot;jump&nbsp;to&nbsp;a&nbsp;code&nbsp;entry-point&quot;&nbsp;style=&quot;border-bottom-style:solid;border-bottom-color:rgb(153,&nbsp;204,&nbsp;153)&quot;&gt;7.&nbsp;Jump&lt;/span&gt; to&nbsp;the &lt;span&nbsp;title=&quot;concept-script&quot;&nbsp;style=&quot;border-bottom-style:solid;border-bottom-color:rgb(153,&nbsp;204,&nbsp;153)&quot;&gt;script&lt;/span&gt;&#39;s &lt;i&gt;initial&nbsp;code&nbsp;entry-point&lt;/i&gt;,&nbsp;and&nbsp;let&nbsp;that&nbsp;run&nbsp;until&nbsp;it&nbsp;either&nbsp;returns,&nbsp;fails&nbsp;to&nbsp;catch&nbsp;an&nbsp;exception,&nbsp;or&nbsp;gets&nbsp;prematurely&nbsp;aborted&nbsp;by&nbsp;the&nbsp;&quot;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-workers/current-work/#kill-a-worker&quot;&nbsp;style=&quot;color:rgb(0,&nbsp;0,&nbsp;204);background-color:transparent&quot;&nbsp;target=&quot;_blank&quot;&gt;kill&nbsp;a&nbsp;worker&lt;/a&gt;&quot;&nbsp;or&nbsp;&quot;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-workers/current-work/#terminate-a-worker&quot;&nbsp;style=&quot;color:rgb(0,&nbsp;0,&nbsp;204);background-color:transparent&quot;&nbsp;target=&quot;_blank&quot;&gt;terminate&nbsp;a&nbsp;worker&lt;/a&gt;&quot;&nbsp;algorithms&nbsp;defined&nbsp;below.&lt;br&gt;<br>
<br>
<br>
<br>
8.&nbsp;If &lt;var&nbsp;title=&quot;&quot;&gt;worker&nbsp;global&nbsp;scope&lt;/var&gt; is&nbsp;actually&nbsp;a &lt;code&nbsp;style=&quot;font-size:inherit;font-family:monospace,&#39;Droid&nbsp;Sans&nbsp;Fallback&#39;,sans-serif;font-variant:normal;color:rgb(255,&nbsp;69,&nbsp;0)&quot;&gt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-workers/current-work/#dedicatedworkerglobalscope&quot;&nbsp;style=&quot;color:inherit;background-color:transparent&quot;&nbsp;target=&quot;_blank&quot;&gt;DedicatedWorkerGlobalScope&lt;/a&gt;&lt;/code&gt; object&nbsp;(i.e.&nbsp;the&nbsp;worker&nbsp;is&nbsp;a&nbsp;dedicated&nbsp;worker),&nbsp;then&nbsp;enable&nbsp;the &lt;span&nbsp;style=&quot;border-bottom-style:solid;border-bottom-color:rgb(153,&nbsp;204,&nbsp;153)&quot;&gt;port&nbsp;message&nbsp;queue&lt;/span&gt; of&nbsp;the&nbsp;worker&#39;s&nbsp;implicit&nbsp;port.&lt;/span&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:sans-serif,&#39;Droid&nbsp;Sans&nbsp;Fallback&#39;;font-size:medium;line-height:21px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:sans-serif,&#39;Droid&nbsp;Sans&nbsp;Fallback&#39;;line-height:21px&quot;&gt;Basically,&nbsp;once&nbsp;the&nbsp;initial&nbsp;worker&nbsp;script&nbsp;returns,&nbsp;the&nbsp;worker&#39;s&nbsp;port&nbsp;is&nbsp;enabled&nbsp;and&nbsp;the&nbsp;normal&nbsp;message&nbsp;port&nbsp;event&nbsp;delivery&nbsp;mechanism&nbsp;kicks&nbsp;in&nbsp;(including&nbsp;dropping&nbsp;unhandled&nbsp;messages&nbsp;on&nbsp;the&nbsp;floor).&nbsp;I&nbsp;can&#39;t&nbsp;say&nbsp;whether&nbsp;Opera&#39;s&nbsp;behavior&nbsp;is&nbsp;correct&nbsp;or&nbsp;not&nbsp;based&nbsp;on&nbsp;your&nbsp;description&nbsp;-&nbsp;if&nbsp;you&nbsp;increase&nbsp;the&nbsp;timeout&nbsp;from&nbsp;1&nbsp;second&nbsp;to&nbsp;10&nbsp;seconds,&nbsp;do&nbsp;you&nbsp;still&nbsp;get&nbsp;the&nbsp;&quot;onmessage&nbsp;message&nbsp;received&quot;?&nbsp;If&nbsp;so,&nbsp;then&nbsp;that&nbsp;may&nbsp;be&nbsp;a&nbsp;bug&nbsp;in&nbsp;Opera&nbsp;because&nbsp;events&nbsp;delivered&nbsp;to&nbsp;workers&nbsp;without&nbsp;an&nbsp;onmessage&nbsp;handler&nbsp;set&nbsp;should&nbsp;be&nbsp;dropped.&lt;/span&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:sans-serif,&#39;Droid&nbsp;Sans&nbsp;Fallback&#39;;line-height:21px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:sans-serif,&#39;Droid&nbsp;Sans&nbsp;Fallback&#39;;font-size:medium;line-height:21px&quot;&gt;&lt;span&nbsp;style=&quot;font-size:small&quot;&gt;-atw&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Help&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Help@lists.whatwg.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Help@lists.whatwg.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.whatwg.org/listinfo.cgi/help-whatwg.org&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.whatwg.org/listinfo.cgi/help-whatwg.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
