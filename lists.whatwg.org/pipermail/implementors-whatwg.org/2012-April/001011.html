<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [imps] validator front end not talking to servlet
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:implementors%40lists.whatwg.org?Subject=Re%3A%20%5Bimps%5D%20validator%20front%20end%20not%20talking%20to%20servlet&In-Reply-To=%3C361D6B1A2B6D194081955E94772543F277D4861B23%40EGEN-MBX01.campus.ads.uwe.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001010.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[imps] validator front end not talking to servlet</H1>
<!--htdig_noindex-->
    <B>Martin Sharratt</B> 
    <A HREF="mailto:implementors%40lists.whatwg.org?Subject=Re%3A%20%5Bimps%5D%20validator%20front%20end%20not%20talking%20to%20servlet&In-Reply-To=%3C361D6B1A2B6D194081955E94772543F277D4861B23%40EGEN-MBX01.campus.ads.uwe.ac.uk%3E"
       TITLE="[imps] validator front end not talking to servlet">Martin.Sharratt at uwe.ac.uk
       </A><BR>
    <I>Tue Apr 24 03:44:43 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001010.html">[imps] validator front end not talking to servlet
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1011">[ date ]</a>
              <a href="thread.html#1011">[ thread ]</a>
              <a href="subject.html#1011">[ subject ]</a>
              <a href="author.html#1011">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Andrei

After building the validator, I remember having problems running it as it seemed to be tied to the terminal process and died as soon as I tried to do something else.  I created an script to run the validator in the background and eventually converted it to a startup script.  This seems to work ok - at least I've had no complaints and it's been up and running since December.  This is on a Debian 6.0 box.    The startup script is copied below.  I can't for the life of me remember where I got the java parameters but suspect this command line is generated by build.py.  If you want to copy the script, you should note that from nohup to the 2&gt;&amp;1 is all one line.


Martin S

#!/bin/bash

### BEGIN INIT INFO
# Provides:        validator.nu
# Required-Start:   $network $remote_fs $syslog $named
# Required-Stop:   $network $remote_fs $syslog $named
# Default-Start:   2 3 4 5
# Default-Stop:
# Short-Description: HTML5 validation add-in to W3c validator
### END INIT INFO

PATH=/sbin:/bin:/usr/sbin:/usr/bin
cd /usr/local/checker
export JAVA_HOME=/usr/lib/jvm/java-6-openjdk
nohup java -XX:-DontCompileHugeMethods -Xms131072k -Xmx131072k -XX:ThreadStackSize=2048 -classpath ./dependencies/commons-codec-1.4/commons-codec-1.4.jar:./dependencies/commons-httpclient-3.1/commons-httpclient-3.1.jar:./dependencies/commons-logging-1.1.1/commons-logging-1.1.1.jar:./dependencies/commons-logging-1.1.1/commons-logging-adapters-1.1.1.jar:./dependencies/commons-logging-1.1.1/commons-logging-api-1.1.1.jar:./dependencies/icu4j-charsets-4_4_2.jar:./dependencies/icu4j-4_4_2.jar:./dependencies/iri-0.5/lib/iri.jar:./dependencies/jetty-6.1.26/lib/servlet-api-2.5-20081211.jar:./dependencies/jetty-6.1.26/lib/jetty-6.1.26.jar:./dependencies/jetty-6.1.26/lib/jetty-util-6.1.26.jar:./dependencies/jetty-6.1.26/lib/ext/jetty-ajp-6.1.26.jar:./dependencies/apache-log4j-1.2.15/log4j-1.2.15.jar:./dependencies/rhino1_7R1/js.jar:./dependencies/xerces-2_9_1/xercesImpl.jar:./dependencies/xerces-2_9_1/xml-apis.jar:./dependencies/slf4j-1.5.2/slf4j-log4j12-1.5.2.jar:./dependencies/commons-fileupload-1.2.1/lib/commons-fileupload-1.2.1.jar:./dependencies/isorelax.jar:./dependencies/mozilla/intl/chardet/java/dist/lib/chardet.jar:./dependencies/saxon9.jar:./jars/non-schema.jar:./jars/io-xml-util.jar:./jars/htmlparser.jar:./jars/hs-aelfred2.jar:./jars/html5-datatypes.jar:./jars/validator.jar:jing-trang/build/jing.jar -Dnu.validator.servlet.log4j-properties=validator/log4j.properties -Dnu.validator.servlet.version=3 -Dnu.validator.servlet.service-name=Validator.nu -Dorg.whattf.datatype.lang-registry=<A HREF="http://www.iana.org/assignments/language-subtag-registry">http://www.iana.org/assignments/language-subtag-registry</A> -Dorg.whattf.datatype.charset-registry=<A HREF="http://www.iana.org/assignments/character-sets">http://www.iana.org/assignments/character-sets</A> -Dorg.whattf.datatype.warn=true -Dnu.validator.servlet.about-page=<A HREF="http://about.validator.nu/">http://about.validator.nu/</A> -Dnu.validator.servlet.style-sheet=<A HREF="http://about.validator.nu/style.css">http://about.validator.nu/style.css</A> -Dnu.validator.servlet.icon=<A HREF="http://about.validator.nu/icon.png">http://about.validator.nu/icon.png</A> -Dnu.validator.servlet.script=<A HREF="http://about.validator.nu/script.js">http://about.validator.nu/script.js</A> -Dnu.validator.spec.microsyntax-descriptions=<A HREF="http://wiki.whatwg.org/wiki/MicrosyntaxDescriptions">http://wiki.whatwg.org/wiki/MicrosyntaxDescriptions</A> -Dnu.validator.spec.alt-advice=<A HREF="http://wiki.whatwg.org/wiki/Validator.nu_alt_advice">http://wiki.whatwg.org/wiki/Validator.nu_alt_advice</A> -Dnu.validator.spec.html5-load=file:validator/spec/html5.html -Dnu.validator.spec.html5-link=<A HREF="http://www.whatwg.org/specs/web-apps/current-work/">http://www.whatwg.org/specs/web-apps/current-work/</A> -Dnu.validator.servlet.max-file-size=7340032 -Dnu.validator.servlet.connection-timeout=5000 -Dnu.validator.servlet.socket-timeout=5000 -Dorg.mortbay.http.HttpRequest.maxFormContentSize=7340032 -Dnu.validator.servlet.host.generic= -Dnu.validator.servlet.host.html5= -Dnu.validator.servlet.host.parsetree= -Dnu.validator.servlet.path.generic=/ -Dnu.validator.servlet.path.html5=/html5/ -Dnu.validator.servlet.path.parsetree=/parsetree/ nu.validator.servlet.Main 8888 &gt;&gt; logs/log.txt 2&gt;&amp;1

.


From: <A HREF="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">implementors-bounces at lists.whatwg.org</A> [mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">implementors-bounces at lists.whatwg.org</A>] On Behalf Of Rancid Iodine
Sent: 19 April 2012 12:20
To: Michael[tm] Smith
Cc: <A HREF="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">implementors at lists.whatwg.org</A>
Subject: Re: [imps] validator front end not talking to servlet

Some progress.

The tcpdump/wireshark traffic capture didn't help, but I tried a few different variations in the whole procedure and long story short here's the result:

http requests will hang if

1 - you build/run the servlet in background

2 - you build/run the servlet it in a screen session

or

3 - you build/run the servlet from a script, as I did from /etc/rc.local

In order to maintain a &quot;service&quot; with this, one needs to build/run the servlet in a console so it's completely hooked into the parent (terminal) process for some reason, and this is what I'm doing now (from a console in our vmware vcenter). Some people would call it an ugly solution, but that would be their problem :). You'd think there's something fairly basic one could do from the linux perspective to get around this, but I'm not sure what it is, never having come across this before.

One final question: is there any provision for the use of a network proxy, thus to enable validation outside of a firewall? Nothing obvious comes up in <A HREF="http://about.validator.nu">http://about.validator.nu</A> , and it's no big issue considering we are more interested in being able to validate html5 inside the firewall, but I ask just in case we can have our cake and eat it too.

Thanks again for all your help.

Andrei
On 18 April 2012 21:58, Michael[tm] Smith &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">mike at w3.org</A>&lt;mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">mike at w3.org</A>&gt;&gt; wrote:
Rancid Iodine &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">rancid.iodine at gmail.com</A>&lt;mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">rancid.iodine at gmail.com</A>&gt;&gt;, 2012-04-18 17:22 +0100:

&gt;<i> I made the changes to log4j.properties which you suggested and restarted
</I>&gt;<i> the servlet. Output looks like this:
</I>&gt;<i> [...]
</I>&gt;<i> Is there any obvious problem in any of that?
</I>No, sorry. I have no idea at all what might be the cause for it no responding.

 --Mike


--
Michael[tm] Smith <A HREF="http://people.w3.org/mike">http://people.w3.org/mike</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/implementors-whatwg.org/attachments/20120424/363e76af/attachment-0002.htm">http://lists.whatwg.org/pipermail/implementors-whatwg.org/attachments/20120424/363e76af/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001010.html">[imps] validator front end not talking to servlet
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1011">[ date ]</a>
              <a href="thread.html#1011">[ thread ]</a>
              <a href="subject.html#1011">[ subject ]</a>
              <a href="author.html#1011">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/implementors-whatwg.org">More information about the Implementors
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
