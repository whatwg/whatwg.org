<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Forms feedback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Forms%20feedback&In-Reply-To=%3CPine.LNX.4.64.1004050244320.4772%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025788.html">
   <LINK REL="Next"  HREF="025821.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Forms feedback</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Forms%20feedback&In-Reply-To=%3CPine.LNX.4.64.1004050244320.4772%40ps20323.dreamhostps.com%3E"
       TITLE="[whatwg] Forms feedback">ian at hixie.ch
       </A><BR>
    <I>Tue Apr  6 02:00:48 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="025788.html">[whatwg] Why are form fields without a name barred from	constraint validation?
</A></li>
        <LI>Next message: <A HREF="025821.html">[whatwg] Forms feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25816">[ date ]</a>
              <a href="thread.html#25816">[ thread ]</a>
              <a href="subject.html#25816">[ subject ]</a>
              <a href="author.html#25816">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, 21 Jan 2010, NARUSE, Yui wrote:
&gt;<i> In 4.10.19.4 URL-encoded form data, The
</I>&gt;<i> application/x-www-form-urlencoded encoding algorithm,
</I>&gt;<i> it says:
</I>&gt;<i> 
</I>&gt;<i> &gt; For each character in the entry's name and value, apply the following 
</I>&gt;<i> &gt; subsubsteps:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If the character isn't in the range U+0020, U+002A, U+002D, U+002E, 
</I>&gt;<i> &gt; U+0030 to U+0039, U+0041 to U+005A, U+005F, U+0061 to U+007A then 
</I>&gt;<i> &gt; replace the character with a string formed as follows: Start with the 
</I>&gt;<i> &gt; empty string, and then, taking each byte of the character when 
</I>&gt;<i> &gt; expressed in the selected character encoding in turn, append to the 
</I>&gt;<i> &gt; string a U+0025 PERCENT SIGN character (%) followed by two characters 
</I>&gt;<i> &gt; in the ranges U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9) and 
</I>&gt;<i> &gt; U+0041 LATIN CAPITAL LETTER A to U+0046 LATIN CAPITAL LETTER F 
</I>&gt;<i> &gt; representing the hexadecimal value of the byte (zero-padded if 
</I>&gt;<i> &gt; necessary).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If the character is a U+0020 SPACE character, replace it with a single 
</I>&gt;<i> &gt; U+002B PLUS SIGN character (+).
</I>&gt;<i> 
</I>&gt;<i> This means, U+9670, encoded as &quot;&#165;x89&#165;x41&quot; in Shift_JIS, must be encoded 
</I>&gt;<i> as &quot;%89%41&quot;, and shouldn't be &quot;%89A&quot;?
</I>
Either is fine (they mean the same thing). I've changed the spec to be 
closer to what browsers do though, thanks.


On Thu, 21 Jan 2010, Aryeh Gregor wrote:
&gt;<i>
</I>&gt;<i> MediaWiki currently uses a search-suggest feature based on lots of
</I>&gt;<i> JavaScript that's used to calculate all sorts of widths and heights to
</I>&gt;<i> painstakingly construct an absolutely-positioned div, and reimplement
</I>&gt;<i> standard dropdown navigation controls on top of that.  It works pretty
</I>&gt;<i> well (go to en.wikipedia.org and start typing a query to see --
</I>&gt;<i> implementation at
</I>&gt;<i> &lt;<A HREF="http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/skins/common/mwsuggest.js?view=markup">http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/skins/common/mwsuggest.js?view=markup</A>&gt;),
</I>&gt;<i> but it's a horrible hack and doesn't integrate perfectly with the
</I>&gt;<i> system.  When I found out Opera implements &lt;datalist&gt;, thanks to the
</I>&gt;<i> helpful spec annotations, I tried rewriting mwsuggest.js to use
</I>&gt;<i> &lt;datalist&gt; where supported.
</I>&gt;<i> 
</I>&gt;<i> My primary feedback here is that a simpler JS API would *really* be
</I>&gt;<i> nice.  In this kind of situation, typically you receive some JSON or
</I>&gt;<i> whatnot from the server, so you have a JavaScript array that you want
</I>&gt;<i> to use for suggestions.  The code to make a given list the suggest
</I>&gt;<i> source for an input is something like:
</I>&gt;<i> 
</I>&gt;<i> var datalist = document.getElementById( 'arbitrary-id' );
</I>&gt;<i> if ( datalist == null ) {
</I>&gt;<i> 	datalist = document.createElement( 'datalist' );
</I>&gt;<i> 	datalist.id = 'arbitrary-id';
</I>&gt;<i> 	document.body.appendChild( datalist );
</I>&gt;<i> } else {
</I>&gt;<i> 	datalist.innerHTML = '';
</I>&gt;<i> }
</I>&gt;<i> input.setAttribute( 'list', 'arbitrary-id' );
</I>&gt;<i> while ( var i = 0; i &lt; suggestions.length; i++ ) {
</I>&gt;<i> 	var option = document.createElement( 'option' );
</I>&gt;<i> 	option.value = suggestions[i];
</I>&gt;<i> 	datalist.appendChild( option );
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> This is all quite awkward.  It was pointed out on IRC that there are
</I>&gt;<i> legitimate use-cases for declarative datalists (e.g.,
</I>&gt;<i> <A HREF="http://html5.lachy.id.au/">http://html5.lachy.id.au/</A>), but I'd expect JS-constructed datalists to
</I>&gt;<i> be a much bigger use-case.  I can think of several sites off the top
</I>&gt;<i> of my head that use absolutely-positioned divs to provide search
</I>&gt;<i> suggestions to users, but none that do so statically.  So I think a
</I>&gt;<i> better API is needed -- preferably just
</I>&gt;<i> 
</I>&gt;<i> input.suggest = suggestions;
</I>&gt;<i> 
</I>&gt;<i> or similar.  The details aren't particularly important, but the
</I>&gt;<i> current API is really cumbersome when used from JS.
</I>
To be fair a lot of the above is redundant with just having the &lt;datalist&gt; 
in the document ahead of time. All you really need is to set the contents 
of the &lt;datalist&gt; element's contents each time; this need not be more than 
one line if what you send from the server is a string of HTML representing 
the &lt;option&gt; elements.

I agree that it would be nice to have a non-DOM way of doing this also, 
though, from a performance point of view if nothing else. However, as 
Aryeh says:

On Thu, 21 Jan 2010, Aryeh Gregor wrote:
&gt;<i>
</I>&gt;<i> It's also worth noting that &lt;datalist&gt; currently seems to be conceived 
</I>&gt;<i> as a combobox, while search suggestions deserve totally different UI. 
</I>&gt;<i> Opera's UI is suitable to search suggestions, but WebKit's proposed UI 
</I>&gt;<i> is inappropriate for them:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://docs.google.com/View?id=dch3zh37_0cf8kc8c4">http://docs.google.com/View?id=dch3zh37_0cf8kc8c4</A>
</I>&gt;<i> 
</I>&gt;<i> There's a little drop-down arrow you have to click to get the list, 
</I>&gt;<i> which is unexpected for search suggestions.  If a separate &quot;suggest&quot; IDL 
</I>&gt;<i> attribute were added, UAs could provide different UI for that and 
</I>&gt;<i> datalist.
</I>
...it would probably make more sense to wait until the current stuff is 
implemented, and then add a separate addition for &quot;suggest&quot; UI and API.


On Mon, 25 Jan 2010, TAMURA, Kent wrote:
&gt;<i> 
</I>&gt;<i> &gt; On setting, if the valueAsNumber attribute does not apply, as defined 
</I>&gt;<i> &gt; for the input element's type&lt; attribute's current state, then throw an 
</I>&gt;<i> &gt; INVALID_STATE_ERR exception. Otherwise, if the valueAsDate attribute 
</I>&gt;<i> &gt; applies, run the algorithm to convert a Date object to a string 
</I>&gt;<i> &gt; defined for that state, passing it a Date object whose time value is 
</I>&gt;<i> &gt; the new value, and set the value of the element to resulting string. 
</I>&gt;<i> &gt; Otherwise, run the algorithm to convert a number to a string as 
</I>&gt;<i> &gt; defined for that state, on the new value, and set the value of the 
</I>&gt;<i> &gt; element to resulting string.
</I>&gt;<i> 
</I>&gt;<i> It seems the current spec doesn't define behavior in a case of setting 
</I>&gt;<i> NaN or Infinitiy to HTMLInputElement::valueAsNumber. Because 
</I>&gt;<i> 'input.valueAsDate = null' makes the value empty, I think 
</I>&gt;<i> 'input.valueAsNumber = Number.NaN' also makes the value empty.
</I>
On Mon, 25 Jan 2010, Philip Taylor wrote:
&gt;<i> 
</I>&gt;<i> <A HREF="http://whatwg.org/html5#float-nan">http://whatwg.org/html5#float-nan</A> : &quot;Except where otherwise specified, 
</I>&gt;<i> if an IDL attribute that is a floating point number type (float) is 
</I>&gt;<i> assigned an Infinity or Not-a-Number (NaN) value, a NOT_SUPPORTED_ERR 
</I>&gt;<i> exception must be raised.&quot;
</I>&gt;<i> 
</I>&gt;<i> This case seems to apply for valueAsNumber.
</I>
Indeed.


On Tue, 26 Jan 2010, TAMURA, Kent wrote:
&gt;<i> &gt;
</I>&gt;<i> &gt;         attribute float valueAsNumber
</I>&gt;<i> 
</I>&gt;<i> valueAsNumber is defined as float, IEEE754 single precision number.
</I>&gt;<i> It should be double because number values for date and time types are
</I>&gt;<i> milliseconds from UNIX epoch.  As of today, milliseconds from UNIX epoch is
</I>&gt;<i> about 1,264,492,163,000.  The float type can't represent this value
</I>&gt;<i> precisely.
</I>&gt;<i> If we do the following with float valueAsNumber, the input value loses the
</I>&gt;<i> data.
</I>&gt;<i>  input.type = &quot;datetime&quot;;
</I>&gt;<i>  input.value = &quot;2010-01-26T08:00Z&quot;;
</I>&gt;<i>  var num = input.valueAsNumber;
</I>&gt;<i>  input.valueAsNumber = num;
</I>
Fixed.


On Tue, 26 Jan 2010, Randy Drielinger wrote:
&gt;<i> 
</I>&gt;<i> Currently the submit button is used to submit a form once (more than 
</I>&gt;<i> average purpose). In some occassions it's possible to submit a form 
</I>&gt;<i> twice, and get it processed twice by the webserver, resulting in a 
</I>&gt;<i> double submit (e.g. forum post). For this specific example, it isn't 
</I>&gt;<i> desired bahavior.
</I>&gt;<i> 
</I>&gt;<i> Should there be a way to prevent a (submit) button in HTML to be clicked 
</I>&gt;<i> more than once or is this clearly a behavior (and therefore be solved 
</I>&gt;<i> with JS)?
</I>
On Tue, 26 Jan 2010, Adam Shannon wrote:
&gt;<i>
</I>&gt;<i> I'm sure you know this, but there is always this simple way.
</I>&gt;<i> 
</I>&gt;<i> &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; onclick=&quot;this.disable=true;&quot; /&gt;
</I>
On Tue, 26 Jan 2010, Kornel wrote:
&gt;<i> 
</I>&gt;<i> No, it's wrong. It may not submit the form, because submit button will 
</I>&gt;<i> be disabled before submission takes place.
</I>&gt;<i> 
</I>&gt;<i> And even in case it does submit, it becomes incredibly annoying when 
</I>&gt;<i> submission fails for some reason (e.g. temporary loss of network 
</I>&gt;<i> coverage) &#151; user won't be allowed to retry submission.
</I>&gt;<i> 
</I>&gt;<i> This is much better IMHO:
</I>&gt;<i> 
</I>&gt;<i> onclick=&quot;var t=this; setTimeout(function(){t.disabled=true},1);
</I>&gt;<i> setTimeout(function(){t.disabled=false},5000)&quot;
</I>
On Tue, 26 Jan 2010, Aaron Bassett wrote:
&gt;<i> 
</I>&gt;<i> Ensuring that your server-side form handler can detect and properly deal 
</I>&gt;<i> with multiple submissions?
</I>&gt;<i> 
</I>&gt;<i> Client-side validation should only ever supplement server-side 
</I>&gt;<i> validation, never replace it. The reason for client-side validation is 
</I>&gt;<i> to improve the user experience, it allows for common data entry problems 
</I>&gt;<i> to be detected and the user notified without a round trip to the server. 
</I>&gt;<i> IMHO disabling the submit button does not add anything to the user's 
</I>&gt;<i> experience, so there is no reason to do it. Unless you are too lazy to 
</I>&gt;<i> have proper server-side validation? ;)
</I>
On Tue, 26 Jan 2010, Kornel wrote:
&gt;<i> 
</I>&gt;<i> I agree that in cases when it's important that duplicate submissions are 
</I>&gt;<i> stopped (placing orders, etc.), there must be server-side protection.
</I>&gt;<i> 
</I>&gt;<i> However it's not always essential (e.g. for idempotent actions or in 
</I>&gt;<i> chat applications) and in these cases authors may be OK with weak 
</I>&gt;<i> protection.
</I>&gt;<i> 
</I>&gt;<i> There are benefits of client-side prevention regardless of server-side 
</I>&gt;<i> validation:
</I>&gt;<i> 
</I>&gt;<i> - if form is large (long wiki page or file upload), it saves time and 
</I>&gt;<i> bandwidth.
</I>&gt;<i>
</I>&gt;<i> - if client-side handles most cases, then server-side check for 
</I>&gt;<i> duplicate submission becomes mainly a fallback and security measure, and 
</I>&gt;<i> doesn't need to be as user-friendly (i.e. it would suffice if it replied 
</I>&gt;<i> with error instead of having to silently redirect to previous 
</I>&gt;<i> submission's result). This simplifies server-side implementation.
</I>
As far as I can tell, nothing prevents a browser today from making submit 
buttons get disabled while the form is submitting. That even seems 
somewhat reasonable (maybe with the stop button resetting the disabled 
state). I don't think there's much to spec here; it's a UI issue.


On Tue, 26 Jan 2010, Aaron Bassett wrote:
&gt;<i>
</I>&gt;<i> I am simply saying that in this particular case (detecting multiple form 
</I>&gt;<i> submissions) there is no benefit I can see to the end-user in disabling 
</I>&gt;<i> the submit button. Let them click it a dozen times if it makes them feel 
</I>&gt;<i> better (like pushing the call button on a lift to make it arrive 
</I>&gt;<i> faster!) If your server-side validation is done correctly it will make 
</I>&gt;<i> no difference.
</I>
Each submission will restart the navigation, so it'll make it slower. 
Also, the client will interrupt its upload each time, so it may in fact 
result in some corruption, if the server can't detect if it got 
everything.


On Fri, 29 Jan 2010, Sidney San Mart&#237;n wrote:
&gt;<i>
</I>&gt;<i> When a user binds to a form's submit event, it's almost always for one 
</I>&gt;<i> of three purposes:
</I>&gt;<i> 
</I>&gt;<i> 1. To prevent submission, if the page or form is in an unsubmittable 
</I>&gt;<i> state
</I>
This can be done now easily with the form validation stuff.


&gt;<i> 2. To handle submission in a non-default way (submit it asynchronously 
</I>&gt;<i> or use it locally)
</I>&gt;<i>
</I>&gt;<i> 3. To add to the data in the form before it's submitted
</I>&gt;<i>
</I>&gt;<i> The result is that every major JavaScript framework has functionality to 
</I>&gt;<i> extract the data from a form. [This page compares][1] the behavior of 
</I>&gt;<i> the most popular ones. *None* of the framework results match any of the 
</I>&gt;<i> others, except for jQuery and jQuery Form, and *none* of the framework 
</I>&gt;<i> results match my UA's results (WebKit r53990). Scripts handling the 
</I>&gt;<i> submit event can't get at the submitter, which makes it impossible to 
</I>&gt;<i> know its name, value, and mouse coordinates (in the case of image 
</I>&gt;<i> inputs) without binding to click on every button in the form and keeping 
</I>&gt;<i> track of which one fired in the same event loop as submit. This is how 
</I>&gt;<i> forms are handled today.
</I>&gt;<i> 
</I>&gt;<i> JavaScript authors shouldn't be in the game of implementing the HTML 
</I>&gt;<i> API. I propose that the [form submission algorithm][2] be rearranged 
</I>&gt;<i> slightly so that the form data set is constructed before the submit 
</I>&gt;<i> event fires, and the data set and submitter are exposed as properties on 
</I>&gt;<i> the submit event.
</I>&gt;<i>
</I>&gt;<i> If I want to submit additional data describing some state on the page, 
</I>&gt;<i> right now I have to create an input, set its type to hidden, set its 
</I>&gt;<i> name and value, append it to the form, and, if I don't plan to target 
</I>&gt;<i> the form at its own browsing context, wait for the submit to run, and 
</I>&gt;<i> remove it from the form. With this new model, sending extra data could 
</I>&gt;<i> be as simple as
</I>&gt;<i> 
</I>&gt;<i>    formData.push({ name: &quot;someAdditionalName&quot;, value: &quot;someAdditionalValue&quot; });
</I>&gt;<i> 
</I>&gt;<i> It's also conceivable that objects could be deleted from the data array 
</I>&gt;<i> (maybe in the case that an input only has relevance to the script 
</I>&gt;<i> handling a form and not to its action), and that the names and values 
</I>&gt;<i> could be writeable without mutating the name or value of the associated 
</I>&gt;<i> input (I don't have use case for this last one). The implementation 
</I>&gt;<i> would have to handle inputs being added, removed, or modified during the 
</I>&gt;<i> submit event. I think that the cleanest way to deal with this would be 
</I>&gt;<i> to update the data object synchronously to reflect those changes, so 
</I>&gt;<i> that behavior remains backwards compatible. There may be a better way, 
</I>&gt;<i> or my whole implementation could be garbage.
</I>&gt;<i> 
</I>&gt;<i> What do you think?
</I>
On Sat, 30 Jan 2010, Anne van Kesteren wrote:
&gt;<i> 
</I>&gt;<i> If we do anything here it needs to be harmonized with 
</I>&gt;<i> <A HREF="http://dev.w3.org/2006/webapi/XMLHttpRequest-2/#the-formdata-interface">http://dev.w3.org/2006/webapi/XMLHttpRequest-2/#the-formdata-interface</A> 
</I>&gt;<i> somehow.
</I>&gt;<i> 
</I>&gt;<i> If the main use case is asynchronous submission it could be something as 
</I>&gt;<i> simple as &lt;form&gt;.formData which seems better than tying it to the submit 
</I>&gt;<i> event.
</I>&gt;<i> 
</I>&gt;<i> (This has been suggested various times before as well by the way. We are 
</I>&gt;<i> just waiting for some more stabilization of various other &lt;form&gt; and 
</I>&gt;<i> XMLHttpRequest features first.)
</I>
As Anne says, this seems overall like a reasonable request, but we've 
added a _lot_ of forms features tp HTML5 already, and few of them have 
been implemented yet. So we should wait until they are implemented before 
adding more.


On Thu, 4 Feb 2010, Philippe Wittenbergh wrote:
&gt;<i> On Feb 4, 2010, at 9:21 PM, Ian Hickson wrote:
</I>&gt;<i> &gt;&gt; 2) What should UAs do when printing? It seems to me that, when 
</I>&gt;<i> &gt;&gt; printing, a &lt;details&gt; element should be open, regardless of the state 
</I>&gt;<i> &gt;&gt; of the boolean open attribute. (because it's a markup attribute, 
</I>&gt;<i> &gt;&gt; there is presumably now way for a print stylesheet to override this). 
</I>&gt;<i> &gt;&gt; Can that be added to the spec?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Generally speaking, browser vendors have found that people expect 
</I>&gt;<i> &gt; their &quot;print&quot; features to just print what's on the screen. However, 
</I>&gt;<i> &gt; I'm certainly open to changing the spec on this if the browser vendors 
</I>&gt;<i> &gt; feel the spec should change -- any implementors have an opinion on 
</I>&gt;<i> &gt; this?
</I>&gt;<i> 
</I>&gt;<i> As a page author and site developer (and as a user), I would certainly 
</I>&gt;<i> want the possibility to display the content of the details element when 
</I>&gt;<i> printing, insofar as it is relevant to the document in a printed state. 
</I>&gt;<i> (that is, a print stylesheet should be able to override the onscreen 
</I>&gt;<i> display state of &lt;details&gt;)
</I>
Well you currently can do this by using the onbeforeprint and onafterprint 
hooks, though that's not exactly pretty. Hopefully it will also be 
possible with media-specific CSS, though that depends on how &lt;details&gt; 
ends up working in CSS. If this proves to not be enough, we'll have to add 
something to support it; however, I'd like to wait until this is more 
widely deployed (so we get more experience) before changing this.


On Wed, 10 Feb 2010, TAMURA, Kent wrote:
&gt;<i>
</I>&gt;<i> The default step base for type=week should be -259,200,000 (the beginning of
</I>&gt;<i> 1970-W01) instead of 0.
</I>&gt;<i> If an implementation follows the current spec and an input element has no
</I>&gt;<i> min attribute, stepMismatch for the element never be false because the step
</I>&gt;<i> base is not aligned to the beginning of a week.
</I>
Fixed, thanks. Good catch.


On Thu, 11 Feb 2010, Aryeh Gregor wrote:
&gt;<i> On Thu, Feb 11, 2010 at 9:39 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 2. Getting validation of forms with the UI designed by the author, but 
</I>&gt;<i> &gt; with the actual validation work (including working out what the 
</I>&gt;<i> &gt; messages should be) done by the UA.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; . . .
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; For #2, the author can use validationMessage to get the relevant 
</I>&gt;<i> &gt; message, which it can then insert into its page dynamically.
</I>&gt;<i> 
</I>&gt;<i> I don't think anyone is going to want to do the UI himself but leave the 
</I>&gt;<i> messages up to the browser -- i.e., I don't think your #2 is a realistic 
</I>&gt;<i> use-case.
</I>
On Fri, 12 Feb 2010, Tab Atkins Jr. wrote:
&gt;<i> On Thu, Feb 11, 2010 at 9:29 PM, Aryeh Gregor &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Simetrical+w3c at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt; Do you know of any actual authors who would want to use
</I>&gt;<i> &gt; validationMessage? &#194;&#160;If there are any authors here who would want to
</I>&gt;<i> &gt; use the validation API with their own UI, would you want to use
</I>&gt;<i> &gt; validationMessage or write your own messages? &#194;&#160;I wouldn't be likely to
</I>&gt;<i> &gt; write my own UI at all, so I'm not the best person to have an opinion
</I>&gt;<i> &gt; here.
</I>&gt;<i> 
</I>&gt;<i> When I use a jQuery validation plugin for my forms today, I pretty
</I>&gt;<i> much always rely on the default error message that the library
</I>&gt;<i> provides.  It's rare for me to override it; I typically only provide
</I>&gt;<i> messages when I'm specifying a custom validation that doesn't have a
</I>&gt;<i> message (as the default error message for a custom validation rule is
</I>&gt;<i> far too generic).
</I>&gt;<i> 
</I>&gt;<i> So yes, I'd use validationMessage in my own UI.  It's easier, as it
</I>&gt;<i> lets me be completely agnostic about the actual error, and just plug
</I>&gt;<i> in whatever the error is into my custom UI.
</I>
On Sat, 13 Feb 2010, Mike Taylor wrote:
&gt;<i>
</I>&gt;<i> I also use a jQuery validation plugin at work--but have a mixture of 
</I>&gt;<i> default and custom errors--depending on what language the &quot;business&quot; is 
</I>&gt;<i> testing that week. Either way, I do think that validationMessage is 
</I>&gt;<i> absolutely useful. In the cases where I might need to change the 
</I>&gt;<i> message, I'm OK with a mixture of setCustomValidity and using the title 
</I>&gt;<i> attribute in conjuction with the pattern attribute to describe what went 
</I>&gt;<i> wrong (which is how Opera currently works, at least).
</I>
Indeed.


On Thu, 11 Feb 2010, Aryeh Gregor wrote:
&gt;<i> On Thu, Feb 11, 2010 at 9:39 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt; It should show the same message it would give the user if the user hit 
</I>&gt;<i> &gt; &quot;enter&quot; to submit the form in this scenario.
</I>&gt;<i> 
</I>&gt;<i> I suggested UAs might snap the value to the max/min onchange or 
</I>&gt;<i> onsubmit, so in this case there would be no error: if the user hit 
</I>&gt;<i> enter, the value would be snapped to the range before submission.  I 
</I>&gt;<i> guess then the value DOM attribute should reflect what would actually be 
</I>&gt;<i> submitted, though, and always be valid.
</I>
Right.


&gt;<i> More generally, however, who says the UA will provide actual text for 
</I>&gt;<i> all validation errors?
</I>
The spec, it's a requirement.


&gt;<i> I'm not sure what a concrete example would be, not being particularly 
</I>&gt;<i> good at UI, but I could imagine UAs using some non-textual cue if you 
</I>&gt;<i> try to submit a form with a missing required input, say.  They could 
</I>&gt;<i> provide some artificial string in that case, though, I guess.
</I>
Indeed.


On Fri, 12 Feb 2010, Tab Atkins Jr. wrote:
&gt;<i> 
</I>&gt;<i> I don't know that I've ever seen a validated form rely solely on 
</I>&gt;<i> non-textual UI for anything, except possibly the failure to fill out a 
</I>&gt;<i> required field (and even then, there's a message somewhere on the page 
</I>&gt;<i> explaining that all the fields with a red border are required or 
</I>&gt;<i> whatever).
</I>&gt;<i> 
</I>&gt;<i> If that were to happen, though, an artificial string would be 
</I>&gt;<i> appropriate.  Ian, do you think this needs to be explicitly stated?
</I>
Done.


&gt;<i> On Fri, Feb 12, 2010 at 12:40 AM, Peter Kasting &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">pkasting at google.com</A>&gt; wrote:
</I>&gt;<i> &gt; I am explicitly opposed to the UA showing validation messages to the user.
</I>&gt;<i> &gt;&#194;&#160;I do not think HTML5 should attempt to address use cases where the 
</I>&gt;<i> &gt; author wants the UA to show the messages. &#194;&#160;I think the design should 
</I>&gt;<i> &gt; provide the author with return values that indicate what the results 
</I>&gt;<i> &gt; of validation were and the author should provide the rest of the UI. 
</I>&gt;<i> &gt; &#194;&#160;In other words, I am opposed to trying to solve use cases #1 and #2 
</I>&gt;<i> &gt; above. &#194;&#160;Any design that attempts to solve them is a mistake. &#194;&#160;Please 
</I>&gt;<i> &gt; remove validationMessage from the spec.
</I>&gt;<i> 
</I>&gt;<i> I *strongly* disagree.  #1 is by far the MOST important use-case for 
</I>&gt;<i> these features, in my opinion.  Without it, several of the new input 
</I>&gt;<i> types and attributes are basically useless.
</I>&gt;<i> 
</I>&gt;<i> Just as important, requiring the author to handle the UI means that 
</I>&gt;<i> accessibility will likely be impaired.  I'm very excited about the new 
</I>&gt;<i> types and error messages making my forms significantly more accessible.  
</I>&gt;<i> When you can provide accessibility like this *for free* with no author 
</I>&gt;<i> intervention, it's silly to pass up the opportunity.
</I>
I agree entirely that without UA UI this whole feature set is pointless. 
It would be designed in a very different way if it wasn't up to the UA to 
support it.


On Fri, 12 Feb 2010, Boris Zbarsky wrote:
&gt;<i> On 2/12/10 12:10 AM, Ian Hickson wrote:
</I>&gt;<i> &gt; HTTP already says for 301, 302, and 307 redirects: &quot;If the [...] 
</I>&gt;<i> &gt; status code is received in response to a request other than GET or 
</I>&gt;<i> &gt; HEAD, the user agent MUST NOT automatically redirect the request 
</I>&gt;<i> &gt; unless it can be confirmed by the user, since this might change the 
</I>&gt;<i> &gt; conditions under which the request was issued&quot;.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Do user agents not implement what HTTP specifies here?
</I>&gt;<i> 
</I>&gt;<i> What Necko (and hence Gecko) implements is the following, as far as I 
</I>&gt;<i> can tell:
</I>&gt;<i> 
</I>&gt;<i> 1)  A 301 or 302 response leads to a silent redirect performed via a
</I>&gt;<i>     GET of the Location header.
</I>&gt;<i> 2)  A 307 response to a request that had a (possibly empty) request
</I>&gt;<i>     body (this always includes the form POST case) puts up one of those
</I>&gt;<i>     dialogs from hell.  It's a prompt that asks: &quot;This web page is
</I>&gt;<i>     being redirected to a new location. Would you like to resend the
</I>&gt;<i>     form data you have typed to the new location?&quot;  No indication of
</I>&gt;<i>     what the new location is.  The user is presented with an &quot;OK&quot;
</I>&gt;<i>     button and a &quot;Cancel&quot; button.  If the user selects the former, the
</I>&gt;<i>     request is redirected.  If the latter, the response-body of the 307
</I>&gt;<i>     response is shown, I think, modulo some SSL stuff.
</I>&gt;<i> 3)  A 307 response to a request that does not have a request body (a
</I>&gt;<i>     situation one can get into by passing null to XHR send(), I think),
</I>&gt;<i>     is silently redirected to the new URI while preserving the request
</I>&gt;<i>     method.  Note that this is somewhat mitigated by the restrictions
</I>&gt;<i>     on cross-origin XHR, if it can be reached via XHR at all.
</I>
On Thu, 11 Feb 2010, Adam Barth wrote:
&gt;<i> 
</I>&gt;<i> Neither Chrome nor IE show a dialog when 307 redirecting a POST.  In any 
</I>&gt;<i> case, the user doesn't have any context for understanding what the 
</I>&gt;<i> dialog would mean, let along making a security decision based on the 
</I>&gt;<i> dialog.
</I>
On Thu, 11 Feb 2010, Jonas Sicking wrote:
&gt;<i> 
</I>&gt;<i> Yeah, I think we should make the same change in firefox. I actually 
</I>&gt;<i> created a pref a while back to control this behavior (in order to allow 
</I>&gt;<i> suppressing the dialog during testing), so it would be a trivial change 
</I>&gt;<i> to Firefox.
</I>
On Thu, 11 Feb 2010, Devdatta wrote:
&gt;<i>
</I>&gt;<i> Even if they do show a dialog box, like CORS, shouldn't a server opt-in 
</I>&gt;<i> to receiving a PUT/DELETE ?
</I>
I've changed the spec to explicit drop cross-origin redirects for PUT and 
DELETE (and indeed anything non-POST and non-safe, should that be 
relevant).


On Fri, 12 Feb 2010, Erik Arvidsson wrote:
&gt;<i>
</I>&gt;<i> At the moment an input element needs to [be] part of a form and have a 
</I>&gt;<i> name attribute for the CSS pseudo classes :valid and :invalid to be 
</I>&gt;<i> applied. These limitations forces people to make their DOM more 
</I>&gt;<i> complicated just to be able to use these pseudo classes. It might have 
</I>&gt;<i> made sense to have these limitations in a world where JavaScript was not 
</I>&gt;<i> available but in many modern web apps there is no need for forms nor 
</I>&gt;<i> name attributes.
</I>&gt;<i> 
</I>&gt;<i> Can we please remove these limitations?
</I>
Done.


On Sun, 14 Feb 2010, TAMURA, Kent wrote:
&gt;<i>
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#definitions">http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#definitions</A>
</I>&gt;<i> &gt; Note: An element can still suffer from these states even when the
</I>&gt;<i> &gt; element is disabled; thus these states can be represented in the
</I>&gt;<i> &gt; DOM even if validating the form during submission wouldn't indicate
</I>&gt;<i> &gt; a problem to the user.
</I>&gt;<i> 
</I>&gt;<i> This paragraph mentions only &quot;disabled&quot;. But it means ValidityState also
</I>&gt;<i> works without a form element, without a name attribute, or with a readonly
</I>&gt;<i> attribute, right?
</I>
The paragraph you quote above is non-normative, meaning that the spec has 
the same requirements with or without that paragraph. You are correct, the 
attribute is live even when the element is readonly, for instance. 
&quot;disabled&quot; is just an example.


&gt;<i> An element is a &quot;candidate for constraint validation&quot; if
</I>&gt;<i> 1. it is a validatable type,
</I>&gt;<i>    e.g. true if &lt;input type=number&gt;, false if &lt;input type=reset&gt;
</I>&gt;<i> 2. has no &quot;disabled&quot; attribute,
</I>&gt;<i> 3. has no &quot;readonly&quot; attribute,
</I>&gt;<i> 4. inside of a &lt;form&gt; element,
</I>&gt;<i> 5. has non-empty &quot;name&quot; attribute, and
</I>&gt;<i> 6. not inside of a &lt;datalist&gt; element.
</I>&gt;<i> 
</I>&gt;<i> I hope ValidityState and the pseudo classes ignores 2-6.
</I>
The pseudo-classes do not ignore 2, 3, and 6. (4 and 5 are now removed.)

The reason :invalid doesn't match a disabled element is that you don't 
want a disabled element to give the user an indication that it needs 
fixing, since the user can't fix it. Same with readonly.


On Tue, 16 Feb 2010, Jonas Sicking wrote:
&gt;<i> 
</I>&gt;<i> In step 7, substep 1, of &quot;Form submission algorithm&quot; remove the bullet 
</I>&gt;<i> that says: &quot;The field element is an input element whose type attribute 
</I>&gt;<i> is in the File Upload state but the control does not have any files 
</I>&gt;<i> selected&quot;. Additionally, add to step 8 &quot;If no files are selected, append 
</I>&gt;<i> an entry in the form data set with the name as the name, the empty 
</I>&gt;<i> string as the value, and &quot;application/octet-stream&quot; as the type.&quot;. See 
</I>&gt;<i> [1] as to why.
</I>&gt;<i> [1] <A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=529859">https://bugzilla.mozilla.org/show_bug.cgi?id=529859</A>
</I>
Done.


&gt;<i> Somewhere it needs to be expressed that processing of &lt;input type=hidden 
</I>&gt;<i> name=&quot;_charset_&quot;&gt; should happen even for multipart/form-data encoded 
</I>&gt;<i> submissions too.
</I>
Done.


&gt;<i> In step 7 substep 1 of the submission process, add a bullet that says:
</I>&gt;<i>
</I>&gt;<i> * The field element does not have a name attribute specified, or is
</I>&gt;<i> the empty string. Except if the field element is an input element
</I>&gt;<i> whose name attribute is in the Image state.
</I>&gt;<i> 
</I>&gt;<i> and remove step 4. This will make it clearer that non-images are not 
</I>&gt;<i> submitted if they lack a non-empty name.
</I>
Done.


On Wed, 17 Feb 2010, Jonas Sicking wrote:
&gt;<i>
</I>&gt;<i> The FormData object [1] is a great way to allow multipart/form-data
</I>&gt;<i> encoded content to be submitted using XMLHttpRequest. It would be
</I>&gt;<i> great if it was possible to get a FormData object representing the
</I>&gt;<i> data contained in a &lt;form&gt;. This in order to allow normal HTML forms
</I>&gt;<i> being used, but using XMLHttpRequest to submit the form data in order
</I>&gt;<i> to allow AJAX to be used.
</I>&gt;<i> 
</I>&gt;<i> So I suggest we add a method like
</I>&gt;<i> 
</I>&gt;<i> interface HTMLFormElement : HTMLElement {
</I>&gt;<i>   ...
</I>&gt;<i>   FormData getFormData();
</I>&gt;<i>   ...
</I>&gt;<i> };
</I>&gt;<i> 
</I>&gt;<i> The reason this is a function rather than a read-only attribute is to
</I>&gt;<i> allow the return FormData to be further modified. I.e. the following
</I>&gt;<i> should be allowed:
</I>&gt;<i> 
</I>&gt;<i> fd = myFormElement.getFormData();
</I>&gt;<i> fd.append(&quot;foo&quot;, &quot;bar&quot;);
</I>&gt;<i> xhr.send(fd);
</I>&gt;<i> 
</I>&gt;<i> If it was a property I would be worried about people expecting the
</I>&gt;<i> following to work:
</I>&gt;<i> myFormElement.formData.append(&quot;foo&quot;, &quot;bar&quot;);
</I>&gt;<i> xhr.send(myFormElement.formData);
</I>&gt;<i> 
</I>&gt;<i> However I don't think there is a good way to make the above work. Thus
</I>&gt;<i> my suggestion to use a function instead. I'm writing a prototype
</I>&gt;<i> implementation over in [2]
</I>&gt;<i> 
</I>&gt;<i> [1] <A HREF="http://dev.w3.org/2006/webapi/XMLHttpRequest-2/Overview.html#the-formdata-interface">http://dev.w3.org/2006/webapi/XMLHttpRequest-2/Overview.html#the-formdata-interface</A>
</I>&gt;<i> [2] <A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=546528">https://bugzilla.mozilla.org/show_bug.cgi?id=546528</A>
</I>
Anne said he'd add a constructor for FormData that takes a &lt;form&gt;, so I 
haven't added anything here.


On Thu, 25 Feb 2010, Timothy D. Morgan wrote:
&gt;<i> 
</I>&gt;<i> As a follow up to my paper advocating HTTP authentication over 
</I>&gt;<i> cookies [1], I've built a simple sample application which demonstrates
</I>&gt;<i> how a combination of XMLHttpRequest and response code tricks can be 
</I>&gt;<i> used to achieve form-based login, logout, and authenticated password
</I>&gt;<i> changes in the four most popular browsers:                   
</I>&gt;<i>   <A HREF="http://www.vsecurity.com/download/tools/fbha-poc_0.1.zip">http://www.vsecurity.com/download/tools/fbha-poc_0.1.zip</A>
</I>&gt;<i> 
</I>&gt;<i> Note that this is achieved without using any checks to determine what 
</I>&gt;<i> browser is being used.
</I>&gt;<i> 
</I>&gt;<i> While this is promising, I still think we should have an HTTP-based 
</I>&gt;<i> log out mechanism.  In addition, the proposed W3C change to 
</I>&gt;<i> XMLHttpRequest authentication behavior will make this code much 
</I>&gt;<i> simpler.
</I>&gt;<i>
</I>&gt;<i> [1] <A HREF="http://www.vsecurity.com/download/papers/WeaningTheWebOffOfSessionCookies.pdf">http://www.vsecurity.com/download/papers/WeaningTheWebOffOfSessionCookies.pdf</A>
</I>
We investigated doing something in HTML to address this a few years ago, 
but the conclusion was that a better way to do this might be to go the 
other way, and make Cookie-based authentication an HTTP auth mechanism.


On Thu, 11 Mar 2010, Mounir Lamouri wrote:
&gt;<i> 
</I>&gt;<i> I'm wondering why meter and progress elements are barred from constraint 
</I>&gt;<i> validation even if they are not implementing the constraint validation 
</I>&gt;<i> API ? I am missing something or it is not needed to specify they are 
</I>&gt;<i> barred from constraint validation ?
</I>
Fixed.


On Mon, 22 Mar 2010, bgy wrote:
&gt;<i> 
</I>&gt;<i> On webkit based browser, we can see a little cross used to reset the 
</I>&gt;<i> field, it's useful, but in some ajax based application, it could be 
</I>&gt;<i> useful to be able to handle this event, to dispatch the event to any 
</I>&gt;<i> controller and reset results.
</I>&gt;<i> 
</I>&gt;<i> Use case:
</I>&gt;<i> 
</I>&gt;<i> Highlight a given text in webpage.
</I>&gt;<i> 
</I>&gt;<i> Input search is likely to be used since the highlight functionnality 
</I>&gt;<i> will search through the webpage and highlight all matched patterns. In a 
</I>&gt;<i> server side solution, the problem is likely to be inexistant, but if we 
</I>&gt;<i> use a plain javascript option, it'll be usefull to handle the reset 
</I>&gt;<i> event to remove the highlighting from the page in browser impletementing 
</I>&gt;<i> this functionnality.
</I>&gt;<i> 
</I>&gt;<i> What are your thoughts about this ?
</I>
I don't really understand the proposal or the use case. Can you elaborate?


On Sat, 27 Mar 2010, Mounir Lamouri wrote:
&gt;<i> 
</I>&gt;<i> It looks like the input color state can't suffer from type mismatch 
</I>&gt;<i> according to the specs but it seems to be the only way to be sure the 
</I>&gt;<i> value is correct. Email and URL states can suffer from type mismatch for 
</I>&gt;<i> the exact same reason.
</I>&gt;<i> 
</I>&gt;<i> I think we should add:
</I>&gt;<i> &quot;Constraint validation: While the value of the element is not a valid
</I>&gt;<i> lowercase simple color, the element is suffering from a type mismatch.&quot;
</I>&gt;<i> in the color state.
</I>&gt;<i> And add &quot;Color&quot; in the &quot;Suffering from type mismatch&quot; definition.
</I>&gt;<i> 
</I>&gt;<i> By the way, it looks like WebKit has implemented type mismatch for color
</I>&gt;<i> state [1] [2].
</I>&gt;<i> 
</I>&gt;<i> [1] <A HREF="https://bugs.webkit.org/show_bug.cgi?id=28966">https://bugs.webkit.org/show_bug.cgi?id=28966</A>
</I>&gt;<i> [2] <A HREF="https://bugs.webkit.org/attachment.cgi?id=39044">https://bugs.webkit.org/attachment.cgi?id=39044</A>
</I>
The color input is supposed to be a colour picker, not text input, so it 
makes no sense to have it be in the type mismatch state. If a UA insists 
on having it be a text control, then the UA must not set the value until 
the user input is a valid color value.


On Mon, 29 Mar 2010, Mounir Lamouri wrote:
&gt;<i> 
</I>&gt;<i> I understand this is because there is only a simple text field for now 
</I>&gt;<i> but in a general matter, having typeMismatch for the color state would 
</I>&gt;<i> be fine because the UI is optional and we can easily imagine UA not 
</I>&gt;<i> adding an UI.
</I>
There has to be a UI -- that's the point of type=color. :-)


On Mon, 29 Mar 2010, Aryeh Gregor wrote:
&gt;<i> 
</I>&gt;<i> It isn't possible for color inputs to suffer from a type mismatch, 
</I>&gt;<i> because the spec says &quot;User agents must not allow the user to set the 
</I>&gt;<i> value to a string that is not a valid lowercase simple color.&quot;  If the 
</I>&gt;<i> user somehow selects an invalid color, the UA is required to simply 
</I>&gt;<i> refuse it, or auto-correct it somehow.  This doesn't work well with a 
</I>&gt;<i> text input, where the user has to type the color incrementally -- I 
</I>&gt;<i> guess the UA could decide to not update the script-visible/submitted 
</I>&gt;<i> value until the user no longer focuses the form field, and if the value 
</I>&gt;<i> isn't valid at that time, it could revert to the previous value.
</I>
Right.


On Mon, 29 Mar 2010, Mounir Lamouri wrote:
&gt;<i>
</I>&gt;<i> Indeed, this sentence must be the reason why the input element in the 
</I>&gt;<i> color state can't suffer from a type mismatch. However, as you said it 
</I>&gt;<i> may be really difficult to respect this where not using a specific UI. I 
</I>&gt;<i> do not even see how we can do that reasonably. It's the same issue for 
</I>&gt;<i> date/time/week/whatever. At least, we can consider number/range to be 
</I>&gt;<i> doable by blocking letters. Type mismatch seems to be a clean way to 
</I>&gt;<i> prevent that.
</I>&gt;<i> 
</I>&gt;<i> If the specific UI is optional, the specifications should let a descent 
</I>&gt;<i> implementation without this specific UI.
</I>
It's pretty easy to do -- you just don't update the .value until the user 
has entered a valid value.


On Tue, 30 Mar 2010, Jonas Sicking wrote:
&gt;<i>
</I>&gt;<i> The spec says
</I>&gt;<i> 
</I>&gt;<i> &quot;When a form-associated element has a form attribute and the ID of any
</I>&gt;<i> of the form elements in the Document changes, then the user agent must
</I>&gt;<i> reset the form owner of that form-associated element.&quot;
</I>&gt;<i> 
</I>&gt;<i> However it does not seem to reset the form owner if a form element
</I>&gt;<i> with an ID is added or removed to the Document. I suspect this is an
</I>&gt;<i> oversight that needs to be fixed.
</I>
Fixed.


&gt;<i> Also, one critical step in the &quot;reset the form owner&quot; algorithm is
</I>&gt;<i> somewhat ambigious. Step 3.1 says
</I>&gt;<i> 
</I>&gt;<i> &quot;If the first element in the Document to have an ID that is
</I>&gt;<i> case-sensitively equal to the element's form content attribute's value
</I>&gt;<i> is a form element, then associate the form-associated element with
</I>&gt;<i> that form  element.&quot;
</I>&gt;<i> 
</I>&gt;<i> However I wonder if &quot;in the Document&quot; includes only nodes that are 
</I>&gt;<i> descendants of Document, or if it includes all nodes whose ownerDocument 
</I>&gt;<i> is the Document. I.e. are disconnected subtrees &quot;in the Document&quot;?
</I>
Fixed by cross-referencing to the definition of &quot;in a Document&quot;.


On Thu, 1 Apr 2010, John Gregg wrote:
&gt;<i>
</I>&gt;<i> For context, Ian Fette started a thread about uploading directories of 
</I>&gt;<i> files in December: 
</I>&gt;<i> <A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2009-December/024455.html">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2009-December/024455.html</A>
</I>&gt;<i> 
</I>&gt;<i> At that time, it was thought that directory upload could be implemented 
</I>&gt;<i> by a UA in response to a &lt;input type=&quot;file&quot; multiple&gt; tag using 
</I>&gt;<i> different UI only, and modifying the FileAPI spec to allow path 
</I>&gt;<i> information in the form
</I>&gt;<i> 
</I>&gt;<i> input.files[0].name=&quot;1.jpg&quot;
</I>&gt;<i> input.files[0].path=&quot;a&quot;
</I>&gt;<i> input.files[1].name=&quot;2.jpg&quot;
</I>&gt;<i> input.files[1].path=&quot;a/b&quot;
</I>&gt;<i> input.files[2].name=&quot;3.jpg&quot;
</I>&gt;<i> input.files[2].path=&quot;a/c&quot;
</I>&gt;<i> 
</I>&gt;<i> I've started developing a prototype of this in WebKit/Chromium.  Based 
</I>&gt;<i> on what I've encountered so far, I would like to propose adding 
</I>&gt;<i> directory upload functionality using an explicit new 'directory' 
</I>&gt;<i> attribute on the file input element.
</I>&gt;<i> 
</I>&gt;<i> The existing behavior of &lt;input type=&quot;file&quot; multiple&gt; would not change, 
</I>&gt;<i> but when processing &lt;input type=&quot;file&quot; directory&gt;, the UA would display 
</I>&gt;<i> a directory selection UI and store the path information, and *not* allow 
</I>&gt;<i> individual files to be selected.  It would allow multiple files to have 
</I>&gt;<i> the same leaf name (.name attribute), as long as the paths were 
</I>&gt;<i> different.  The path attributes would include the name of the chosen 
</I>&gt;<i> directory
</I>&gt;<i> 
</I>&gt;<i> This would be preferable for several reasons:
</I>&gt;<i>
</I>&gt;<i>  - Most built-in file system UI on major platforms (Windows/Mac/Linux) 
</I>&gt;<i> have distinct dialogs for choosing files and choosing directories.  
</I>&gt;<i> Allowing the UA to use these directly makes sense rather than creating 
</I>&gt;<i> hybrids.
</I>&gt;<i>
</I>&gt;<i>  - Avoiding &quot;leaf name&quot; conflicts in a directory tree is not feasible in 
</I>&gt;<i> many applications -- asking a user to ensure unique photo names in a 
</I>&gt;<i> large set of albums before uploading would fail to meet that use case.  
</I>&gt;<i> Therefore HTML documents should know in advance whether the path 
</I>&gt;<i> information will be relevant in the eventual storage of the files.  
</I>&gt;<i> Sites currently using &lt;input type=&quot;file&quot; multiple&gt; would have 
</I>&gt;<i> compatibility problems with an implementation which allowed conflicting 
</I>&gt;<i> file names along different paths.
</I>&gt;<i> 
</I>&gt;<i> What are your thoughts about adding the 'directory' attribute?
</I>
What is the advantage over an &lt;input type=file multiple&gt; control? It seems 
like it would be more backwards compatible to just make this a UI switch 
-- let the user chose whether he's uploading a file, many files, or a 
directory of files. That's also more backwards-compatible.

-- 
Ian Hickson               U+1047E                )\._.,--....,'``.    fL
<A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'
</PRE>




































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025788.html">[whatwg] Why are form fields without a name barred from	constraint validation?
</A></li>
	<LI>Next message: <A HREF="025821.html">[whatwg] Forms feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25816">[ date ]</a>
              <a href="thread.html#25816">[ thread ]</a>
              <a href="subject.html#25816">[ subject ]</a>
              <a href="author.html#25816">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
