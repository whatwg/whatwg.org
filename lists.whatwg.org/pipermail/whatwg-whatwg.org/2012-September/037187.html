<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Security restriction allows content thievery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Security%20restriction%20allows%20content%20thievery&In-Reply-To=%3CPine.LNX.4.64.1209061818570.30734%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="037185.html">
   <LINK REL="Next"  HREF="079464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Security restriction allows content thievery</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Security%20restriction%20allows%20content%20thievery&In-Reply-To=%3CPine.LNX.4.64.1209061818570.30734%40ps20323.dreamhostps.com%3E"
       TITLE="[whatwg] Security restriction allows content thievery">ian at hixie.ch
       </A><BR>
    <I>Thu Sep  6 11:22:42 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="037185.html">[whatwg] Proposal about the table cell relationship combined with the column grouping and the row grouping
</A></li>
        <LI>Next message: <A HREF="079464.html">[whatwg] Security restriction allows content thievery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37187">[ date ]</a>
              <a href="thread.html#37187">[ thread ]</a>
              <a href="subject.html#37187">[ subject ]</a>
              <a href="author.html#37187">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, 16 Jul 2012, Robert Eisele wrote:
&gt;<i>
</I>&gt;<i> Browsers are very restrictive when one tries to access the contents of 
</I>&gt;<i> different domains (including the scheme), embedded via framesets. This 
</I>&gt;<i> is normally a good practice, but I'd suggest to weaken this restriction 
</I>&gt;<i> for the data: URI schema.
</I>
It already is. The origin of documents and images using data: URLs is 
essentially the origin of wherever you found the URL.


&gt;<i> I'm currently building an analysis system like Google Analytics, which 
</I>&gt;<i> gets embedded into a website via a small JavaScript snippet. When I 
</I>&gt;<i> analyzed the data, I came across a very interesting trick because I got 
</I>&gt;<i> a lot of requests (with the data from location.href) where the entire 
</I>&gt;<i> website was embedded into a data:text/html URI - except that all ads of 
</I>&gt;<i> the page were replaced. Fortunately, my tracking code has been left 
</I>&gt;<i> without modifications.
</I>
Weird.


&gt;<i> But the scary thing is that this way you can monetize foreign content by 
</I>&gt;<i> simply embedding it somewhere you can direct traffic to. That's pretty 
</I>&gt;<i> clever, because the original site owner doesn't notice this abuse due to 
</I>&gt;<i> the fact that top.location.href isn't readable. Or even worse, he would 
</I>&gt;<i> never notice it at all when he doesn't sniff the URI with JavaScript, 
</I>&gt;<i> because image files would have no referrer.
</I>&gt;<i> 
</I>&gt;<i> My final approach to convict the abuser is based on the fact, that the 
</I>&gt;<i> JavaScript was dynamically loaded from my server and that I can write to 
</I>&gt;<i> location.href. So I added this piece of code:
</I>&gt;<i> 
</I>&gt;<i> if (top.location.protocol === 'data:') {
</I>&gt;<i>     top.location.href = '<A HREF="http://example.com/trap/">http://example.com/trap/</A>';
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> But even then the referrer will not be passed to the server. So my 
</I>&gt;<i> proposal is that the data URI schema gets an exception on this security 
</I>&gt;<i> behavior.
</I>
I don't understand. What referrer are you trying to set? To what?

-- 
Ian Hickson               U+1047E                )\._.,--....,'``.    fL
<A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'
</PRE>

















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="037185.html">[whatwg] Proposal about the table cell relationship combined with the column grouping and the row grouping
</A></li>
	<LI>Next message: <A HREF="079464.html">[whatwg] Security restriction allows content thievery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37187">[ date ]</a>
              <a href="thread.html#37187">[ thread ]</a>
              <a href="subject.html#37187">[ subject ]</a>
              <a href="author.html#37187">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
