<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Hardware accelerated canvas
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Hardware%20accelerated%20canvas&In-Reply-To=%3CCAD73mdLw%2B4sGjzMjJ7bvOO2s876k95R%3DhaataszmD8ny%3DnbCdw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="079390.html">
   <LINK REL="Next"  HREF="079395.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Hardware accelerated canvas</H1>
<!--htdig_noindex-->
    <B>James Robinson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Hardware%20accelerated%20canvas&In-Reply-To=%3CCAD73mdLw%2B4sGjzMjJ7bvOO2s876k95R%3DhaataszmD8ny%3DnbCdw%40mail.gmail.com%3E"
       TITLE="[whatwg] Hardware accelerated canvas">jamesr at google.com
       </A><BR>
    <I>Tue Sep  4 09:30:26 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="079390.html">[whatwg] Hardware accelerated canvas
</A></li>
        <LI>Next message: <A HREF="079395.html">[whatwg] Hardware accelerated canvas
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79393">[ date ]</a>
              <a href="thread.html#79393">[ thread ]</a>
              <a href="subject.html#79393">[ subject ]</a>
              <a href="author.html#79393">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I believe this ship has already sailed for the most part - several major
browsers (starting with IE9) have shipped GPU based canvas 2d
implementations that simply lose the image buffer on a lost context.  Given
that there are a fair number of benchmarks (of varying quality) around
canvas 2d speed I doubt vendors will be able to give up speed.

It's also important to note that unlike WebGL the only thing lost on a lost
context is the image buffer itself.  With WebGL, the page has to regenerate
a large number of resources (shaders, buffers, textures) before it can
render the next frame.  With canvas the page can just start drawing.  Many
applications redraw the entire canvas on every frame so lost context
recovery is identical to normal operation - just draw the thing.  All other
resources are managed and can be regenerated by the browser without script
intervention.

On Mon, Sep 3, 2012 at 9:11 AM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:

&gt;<i> There are ways to make it work without forgoing acceleration, e.g. taking
</I>&gt;<i> regular &quot;backups&quot; of the canvas contents, remembering every instruction
</I>&gt;<i> that was sent to the canvas, etc.
</I>&gt;<i>
</I>
We investigated these and other options when first looking at GPU
acceleration in Chrome.  None seemed feasible.  Readbacks are expensive.
 Bandwidth from GPU to main memory in split memory systems is limited and
doing a readback is a pipeline stall.  Recording draw commands works for
some path-only use cases but many canvases reference from dynamic sources
such as &lt;video&gt;s or other &lt;canvas&gt;es.  Preserving these resources around is
quite expensive, especially when they might be GPU-resident to start and
require a readback.

The more basic problem with all of these approaches is that they require
considerable complexity, time and memory to deal with a (hopefully) rare
situation.  There will never be a benchmark that involves a context loss in
the middle, so any time spent on recovery is time wasted.


&gt;<i> On Mon, 3 Sep 2012, Benoit Jacob wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Remember this adage from high-performance computing which applies here
</I>&gt;<i> &gt; as well: &quot;The fast drives out the slow even if the fast is wrong&quot;.
</I>&gt;<i>
</I>This isn't an issue of the spec -- there is existing content that would be
&gt;<i> affected.
</I>&gt;<i>
</I>&gt;<i>
</I>It is the spec's problem so far as the spec wants to reflect reality.  I
really doubt UAs are going to be able to implement something significantly
more complicated or slow than what they have been shipping for a few years.

I think it would be useful for some sorts of applications to be notified
when the image buffer data is lost so that they could regenerate it.  This
would be useful for applications that use a canvas to cache mostly-static
intermediate data or applications that only repaint dirty rectangles in
normal operation.

- James

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="079390.html">[whatwg] Hardware accelerated canvas
</A></li>
	<LI>Next message: <A HREF="079395.html">[whatwg] Hardware accelerated canvas
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79393">[ date ]</a>
              <a href="thread.html#79393">[ thread ]</a>
              <a href="subject.html#79393">[ subject ]</a>
              <a href="author.html#79393">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
