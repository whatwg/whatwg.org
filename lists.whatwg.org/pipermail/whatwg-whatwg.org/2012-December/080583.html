<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] I believe source rectangles for HTML5 Canvas drawImage are specified incorrectly
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20I%20believe%20source%20rectangles%20for%20HTML5%20Canvas%20drawImage%0A%20are%20specified%20incorrectly&In-Reply-To=%3CCABpaAqTa2_ECxkAMiYPJ0fpvs53cRMPc2wYbdb9NMQj8qRa4%2BA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="080570.html">
   <LINK REL="Next"  HREF="080592.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] I believe source rectangles for HTML5 Canvas drawImage are specified incorrectly</H1>
<!--htdig_noindex-->
    <B>Justin Novosad</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20I%20believe%20source%20rectangles%20for%20HTML5%20Canvas%20drawImage%0A%20are%20specified%20incorrectly&In-Reply-To=%3CCABpaAqTa2_ECxkAMiYPJ0fpvs53cRMPc2wYbdb9NMQj8qRa4%2BA%40mail.gmail.com%3E"
       TITLE="[whatwg] I believe source rectangles for HTML5 Canvas drawImage are specified incorrectly">junov at chromium.org
       </A><BR>
    <I>Tue Dec 11 07:56:23 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="080570.html">[whatwg] I believe source rectangles for HTML5 Canvas drawImage are specified incorrectly
</A></li>
        <LI>Next message: <A HREF="080592.html">[whatwg] I believe source rectangles for HTML5 Canvas drawImage are specified incorrectly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80583">[ date ]</a>
              <a href="thread.html#80583">[ thread ]</a>
              <a href="subject.html#80583">[ subject ]</a>
              <a href="author.html#80583">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Dec 10, 2012 at 6:53 PM, Rik Cabanier &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cabanier at gmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I assume this would only be for the 9 argument version of drawImage?
</I>&gt;<i>
</I>
Yeah, the all dressed version.


&gt;<i>
</I>&gt;<i> FWIW
</I>&gt;<i> I was curious why this bug doesn't show up in WebKit so I looked at the
</I>&gt;<i> implementation.
</I>&gt;<i> They actually catch cases where there's scaling of a portion of an image
</I>&gt;<i> and special case it by copying the non-scaled image to a temporary canvas
</I>&gt;<i> first:
</I>&gt;<i>         // When the image is scaled using high-quality interpolation, we
</I>&gt;<i> create a temporary CGImage
</I>&gt;<i>         // containing only the portion we want to display. We need to do
</I>&gt;<i> this because high-quality
</I>&gt;<i>         // interpolation smoothes sharp edges, causing pixels from outside
</I>&gt;<i> the source rect to bleed
</I>&gt;<i>         // into the destination rect. See &lt;<A HREF="rdar://problem/6112909">rdar://problem/6112909</A>&gt;.
</I>&gt;<i>
</I>&gt;<i> It would be nice to see why the Safari folks added this code since it
</I>&gt;<i> makes them inconsistent with the spec.
</I>&gt;<i>
</I>&gt;<i>
</I>For the skia port of WebKit (used by Chrome) clamping to the source region
is built into the blitter functions (sw rendering) and shaders (gpu
rendering) so that color bleeding can be prevented without creating a
temporary copy of the image.  The reason it was implemented this way is
that the bleeding was reported as a bug by game developers and the spec was
not as clear then as it is today.

We were getting more complaints about this issue back when there was color
bleeding, which is the main reason why I have been arguing in favor of
clamping to the bounds of the source rectangle.  It seems more web
developers are getting the results they expect from drawImage now that
there is no color bleeding in Chrome, which is unfortunately not spec
compliant behavior.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="080570.html">[whatwg] I believe source rectangles for HTML5 Canvas drawImage are specified incorrectly
</A></li>
	<LI>Next message: <A HREF="080592.html">[whatwg] I believe source rectangles for HTML5 Canvas drawImage are specified incorrectly
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80583">[ date ]</a>
              <a href="thread.html#80583">[ thread ]</a>
              <a href="subject.html#80583">[ subject ]</a>
              <a href="author.html#80583">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
