<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Submitting contentEditable Content In A Form
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Submitting%20contentEditable%20Content%20In%20A%20Form&In-Reply-To=%3CPine.LNX.4.64.1212192012310.20758%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038410.html">
   <LINK REL="Next"  HREF="080706.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Submitting contentEditable Content In A Form</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Submitting%20contentEditable%20Content%20In%20A%20Form&In-Reply-To=%3CPine.LNX.4.64.1212192012310.20758%40ps20323.dreamhostps.com%3E"
       TITLE="[whatwg] Submitting contentEditable Content In A Form">ian at hixie.ch
       </A><BR>
    <I>Wed Dec 19 12:49:20 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="038410.html">[whatwg] Issues with microdata and proposals for improvements
</A></li>
        <LI>Next message: <A HREF="080706.html">[whatwg] Submitting contentEditable Content In A Form
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38426">[ date ]</a>
              <a href="thread.html#38426">[ thread ]</a>
              <a href="subject.html#38426">[ subject ]</a>
              <a href="author.html#38426">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, 22 Oct 2012, Hugh Guiney wrote:
&gt;<i> On Wed, Oct 17, 2012 at 7:23 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I haven't added this, because contenteditable=&quot;&quot; is only truly useful 
</I>&gt;<i> &gt; with scripting enabled, and it's basically one line of script to 
</I>&gt;<i> &gt; support shunting the current value into a hidden input.
</I>&gt;<i> 
</I>&gt;<i> For me, it's also useful even just as a way for blog contributors to 
</I>&gt;<i> edit the content of posts in-context (i.e., with styling applied, as it 
</I>&gt;<i> will appear on the final page, rather than &quot;blindly&quot; inside a textarea). 
</I>&gt;<i> Obviously it's going to be more versatile with scripting enabled, but 
</I>&gt;<i> that's true across the board, and contenteditable doesn't lose all value 
</I>&gt;<i> merely by virtue of the user not being able to add specific formatting: 
</I>&gt;<i> additional formatting could occur server-side (think Markdown 
</I>&gt;<i> expansion); a lot of content on the Web consists primarily or even 
</I>&gt;<i> exclusively of paragraphs; an editor could make purely grammatical, 
</I>&gt;<i> spelling, or factual changes to another user's article draft without 
</I>&gt;<i> touching the underlying structure... And the formatting isn't 
</I>&gt;<i> necessarily an issue anyway as UAs could just as easily add script-less 
</I>&gt;<i> controls, as they've done with the video element. That the attribute is 
</I>&gt;<i> currently useless with scripting disabled is the very reason I've 
</I>&gt;<i> brought this up; it would no longer be useless if there were a way to 
</I>&gt;<i> send its containing element's contents back to the server.
</I>
How common is it for a part of a page to be editable when the page is 
loaded, for there to be no formatting UI, for the page to not mind if the 
user uses the browser's own formatting features (e.g. dragging and 
dropping formatted text into an editable region, using Ctrl+B, etc), and 
for the process of submitting the update to the server to consist of 
literally a form submission?

I don't recall ever seeing a page like this. Literally every time I've 
seen contenteditable, it's had _some_ script beyond what is needed to 
shunt the value into a form control.

If it's something that really does happen commonly, then sure, let's 
support it.


&gt;<i> Additionally, shunting into a hidden input, while perhaps trivial, is 
</I>&gt;<i> essentially a hack to work around this missing feature. As an author, it 
</I>&gt;<i> doesn't strike me as particularly intuitive when every other method of 
</I>&gt;<i> user-entry can be submitted on its own.
</I>
Not every other. Anything involving drag-and-drop, for instance, requires 
script.


&gt;<i> What is the user benefit in making this particular method of data entry 
</I>&gt;<i> require an extra step?
</I>
The benefit to _not_ having a feature is just that the platform is 
smaller, so we avoid all the costs associated with adding a feature:

   <A HREF="http://wiki.whatwg.org/wiki/FAQ#Where.27s_the_harm_in_adding.E2.80.94">http://wiki.whatwg.org/wiki/FAQ#Where.27s_the_harm_in_adding.E2.80.94</A>


&gt;<i> &gt; This becomes especially more relevant when contenteditable is used for 
</I>&gt;<i> &gt; editors that don't just upload HTML; for example, the Google+ editor 
</I>&gt;<i> &gt; is contenteditable=&quot;&quot; but it's not going to upload the HTML, it 
</I>&gt;<i> &gt; uploads structured data.
</I>&gt;<i> 
</I>&gt;<i> If the plaintext-only value is spec'd, that's no longer an issue: it 
</I>&gt;<i> could upload HTML by default, or plaintext when that value is set&#151;which 
</I>&gt;<i> can obviously be transformed or subsumed into a structured data set, as 
</I>&gt;<i> G+ must do already.
</I>
I don't understand what you mean. How would plaintext-only enable 
+mentioning and so forth to be handled without script?


&gt;<i> &gt; On Fri, 7 Sep 2012, Mikko Rantalainen wrote:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; The contenteditable attribute is meant for low level wysiwyg-editor 
</I>&gt;<i> &gt; &gt; like behavior framework and it is not meant to work standalone 
</I>&gt;<i> &gt; &gt; without scripting.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Indeed.
</I>&gt;<i> 
</I>&gt;<i> Why isn't it? What are the drawbacks?
</I>
I'm not sure this question makes sense. Why is a bicycle not meant to have 
an engine? What are the drawbacks of turning a bicycle into a motorcycle?

It's just the design that it has. It may be that there are use cases for a 
rich text editor that doesn't involve scripting, and in that case we 
should design and add such a feature; but that's orthogonal to 
contenteditable, which is specifically designed to be a low-level feature 
to enable people to write editors and so forth.


&gt;<i> &gt; &gt; I'd suggest supporting &lt;textarea type=&quot;text/html&quot;&gt; with a built-in 
</I>&gt;<i> &gt; &gt; HTML wysiwyg editor if any UA wants to support HTML editing without 
</I>&gt;<i> &gt; &gt; JavaScript. In that case, the UA should provide a scriptable method 
</I>&gt;<i> &gt; &gt; for detecting for native support of type=&quot;text/html&quot;. As a result, a 
</I>&gt;<i> &gt; &gt; CMS system could fallback to e.g. TinyMCE or CKeditor to emulate the 
</I>&gt;<i> &gt; &gt; missing support.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This is actually what old versions of IE did (as &lt;htmlarea&gt;, IIRC), 
</I>&gt;<i> &gt; but it was dropped. I don't fully understand why, but I'm skeptical of 
</I>&gt;<i> &gt; introducing a new control for this without making sure we don't make 
</I>&gt;<i> &gt; the same mistakes, which means figuring out what those mistakes were.
</I>&gt;<i> 
</I>&gt;<i> This is a little hard to search for with simple queries as there are a 
</I>&gt;<i> lot of results for DHTML scripts of the same name, but I did find the 
</I>&gt;<i> following article[1] which states that &lt;htmlarea&gt; premiered in version 
</I>&gt;<i> 5, and illustrates the usage, which is identical to how contenteditable 
</I>&gt;<i> works; it's just a block-level element rather than an attribute. 
</I>&gt;<i> Considering the fact that contenteditable was introduced soon afterward 
</I>&gt;<i> in IE 5.5, it seems reasonable to infer that &lt;htmlarea&gt; was essentially 
</I>&gt;<i> a prototype for the same feature. If this is indeed the case, given that 
</I>&gt;<i> the original concept behind the feature seems to be &quot;a textarea that 
</I>&gt;<i> allows markup&quot;, it seems highly likely that generic editable elements 
</I>&gt;<i> would've been used as form controls were there a way to do that.
</I>&gt;<i>
</I>&gt;<i> [1]: <A HREF="http://www.siteexperts.com/ie5/htmlarea/page1.asp">http://www.siteexperts.com/ie5/htmlarea/page1.asp</A>
</I>
My point is that Microsoft, while prototyping how to do rich text editing, 
first started with a form control approach, and then abandoned it and 
instead went for the contenteditable=&quot;&quot; approach. There is presumably a 
reason why they did so. Did the form control approach have some 
fundamental flaw, providing us with lessons from which we can learn? Did 
the person who invented it upset someone else on the team by beating them 
at ping pong, resulting in internal politics that killed the feature and 
resulted in someone else making a new feature for no good technical 
reason? What's the reason? I hesitate to introduce features that were 
previously abandoned without understanding why, because I don't want us to 
just make the same mistakes again.

But as I said above, if it does make sense to support this, then we 
should. I'm just saying we should do it with open eyes.


&gt;<i> &gt; On Thu, 13 Sep 2012, Ojan Vafai wrote:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I think this is a problem that we need to address more generally. 
</I>&gt;<i> &gt; &gt; I'm not sure what the API should look like, but it's not specific to 
</I>&gt;<i> &gt; &gt; contentEditable. I should be able to make a Web Component that 
</I>&gt;<i> &gt; &gt; submits specific values with forms based off it's content. If we 
</I>&gt;<i> &gt; &gt; solve that problem right, it'll be possible to make contentEditable 
</I>&gt;<i> &gt; &gt; elements submit with forms without extra JS code.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Given how easy it is to copy data into a hidden &lt;input&gt;, why isn't 
</I>&gt;<i> &gt; that sufficient? It would actually be pretty difficult to come up with 
</I>&gt;<i> &gt; an API that is simpler than declaring an &lt;input&gt; and settings its 
</I>&gt;<i> &gt; value...
</I>&gt;<i> 
</I>&gt;<i> I don't know that a separate API is necessary here either, but the 
</I>&gt;<i> hidden input trick doesn't really scale well. Consider the submission of 
</I>&gt;<i> multiple contenteditable elements, use case being that a user has 
</I>&gt;<i> privileges to edit certain sections of a document and not others, as in 
</I>&gt;<i> a template-based CMS. The code would have to look something like this, 
</I>&gt;<i> at the bare minimum:
</I>&gt;<i> 
</I>&gt;<i>     var form = document.forms.form;
</I>&gt;<i> 
</I>&gt;<i>     function stripHTML(html) {
</I>&gt;<i>         var div = document.createElement('div');
</I>&gt;<i>         div.innerHTML = html;
</I>&gt;<i>         return div.textContent || div.innerText;
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i>     function shuntContentEditables(event) {
</I>&gt;<i>         event.preventDefault();
</I>&gt;<i> 
</I>&gt;<i>         var editables =
</I>&gt;<i> document.querySelectorAll('[contenteditable]'), i, current,
</I>&gt;<i> hiddenInput, isPlainTextOnly, content;
</I>&gt;<i> 
</I>&gt;<i>         for (i = 0; i &lt; editables.length; ++i) {
</I>&gt;<i>             current = editables.item(i);
</I>&gt;<i>             hiddenInput =
</I>&gt;<i> document.querySelector('input[type=&quot;hidden&quot;][name=&quot;' + current.id +
</I>&gt;<i> '&quot;]');
</I>&gt;<i>             isPlainTextOnly =
</I>&gt;<i> (current.getAttribute('contenteditable').toLowerCase() ===
</I>&gt;<i> 'plaintext-only');
</I>&gt;<i>             content = current.innerHTML;
</I>&gt;<i> 
</I>&gt;<i>             if (isPlainTextOnly) {
</I>&gt;<i>                 hiddenInput.value = stripHTML(content);
</I>&gt;<i>             } else {
</I>&gt;<i>                 hiddenInput.value = content;
</I>&gt;<i>             }
</I>&gt;<i> 
</I>&gt;<i>             form.submit();
</I>&gt;<i>         }
</I>&gt;<i>     }
</I>&gt;<i> 
</I>&gt;<i>     form.addEventListener('submit', shuntContentEditables, false);
</I>&gt;<i> 
</I>&gt;<i> ...30 lines of code!
</I>
This is doing more than what my &quot;one line of code&quot; is equivalent to.

Certainly, the more you support, the more complicated the script gets. It 
would also make the non-script version more complicated. :-)

   
When adding features, we do so by first looking at use cases and then 
working from there. What are the use case for a script-free non-plaintext 
editor in HTML? Would they really be script-free?


On Mon, 22 Oct 2012, Ojan Vafai wrote:
&gt;<i> On Sat, Oct 20, 2012 at 4:55 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt; On Sat, 20 Oct 2012, Aryeh Gregor wrote:
</I>&gt;<i> &gt; &gt; On Thu, Oct 18, 2012 at 1:23 AM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Incidentally, it seems to use a WebKit-specific &quot;plaintext-only&quot; 
</I>&gt;<i> &gt; &gt; &gt; value. Should we spec that? Aryeh? It's filed as:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;    <A HREF="https://www.w3.org/Bugs/Public/show_bug.cgi?id=14554">https://www.w3.org/Bugs/Public/show_bug.cgi?id=14554</A>
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; If this should involve changes to HTML, let me know.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; In principle, yes, this should be specced.  In practice, it would 
</I>&gt;<i> &gt; &gt; require extensive changes to the editing spec and a lot of careful 
</I>&gt;<i> &gt; &gt; thinking, and no one is really working on editing implementations 
</I>&gt;<i> &gt; &gt; anyway.  Gecko's editor code is in maintenance mode, I haven't 
</I>&gt;<i> &gt; &gt; received a single piece of feedback ever about editing from IE or 
</I>&gt;<i> &gt; &gt; Opera people, and WebKit is the one that already implements the 
</I>&gt;<i> &gt; &gt; feature, so I don't see the effort as being worth the time spent 
</I>&gt;<i> &gt; &gt; right now.  (I did receive feedback from Opera about selection, but 
</I>&gt;<i> &gt; &gt; not editing as far as I remember.)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; The same goes for any other proposed editing spec features.  When I 
</I>&gt;<i> &gt; &gt; see people actually implementing the existing spec, that's when it 
</I>&gt;<i> &gt; &gt; will make sense for me to spend more of my time adding more stuff to 
</I>&gt;<i> &gt; &gt; it.  Until then, I might fix bugs, but that's it.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Sounds reasonable.
</I>&gt;<i> 
</I>&gt;<i> FWIW, when I discussed this with Mozilla folk a couple years ago, the 
</I>&gt;<i> only sticking point was what hitting enter should should in a 
</I>&gt;<i> plaintext-only region. In WebKit, it inserts a &lt;br&gt;. Some people thought 
</I>&gt;<i> it should insert a '\n' and/or should based what it inserts off of the 
</I>&gt;<i> CSS whitespace property. Never really came up with a resolution to that 
</I>&gt;<i> question.
</I>
If that's the only issue, we should just pick one and go with it, if 
anyone but WebKit is going to implement it.

-- 
Ian Hickson               U+1047E                )\._.,--....,'``.    fL
<A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'
</PRE>


















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038410.html">[whatwg] Issues with microdata and proposals for improvements
</A></li>
	<LI>Next message: <A HREF="080706.html">[whatwg] Submitting contentEditable Content In A Form
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38426">[ date ]</a>
              <a href="thread.html#38426">[ thread ]</a>
              <a href="subject.html#38426">[ subject ]</a>
              <a href="author.html#38426">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
