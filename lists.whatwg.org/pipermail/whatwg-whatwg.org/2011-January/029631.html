<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Timed tracks: feedback compendium
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Timed%20tracks%3A%20feedback%20compendium&In-Reply-To=%3Cop.voqpal1xsr6mfa%40kirk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="071902.html">
   <LINK REL="Next"  HREF="071906.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Timed tracks: feedback compendium</H1>
<!--htdig_noindex-->
    <B>Philip J&#228;genstedt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Timed%20tracks%3A%20feedback%20compendium&In-Reply-To=%3Cop.voqpal1xsr6mfa%40kirk%3E"
       TITLE="[whatwg] Timed tracks: feedback compendium">philipj at opera.com
       </A><BR>
    <I>Mon Jan  3 07:57:50 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="071902.html">[whatwg] sic element, was: Re: Exposing spelling/grammar suggestions in contentEditable
</A></li>
        <LI>Next message: <A HREF="071906.html">[whatwg] Timed tracks: feedback compendium
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29631">[ date ]</a>
              <a href="thread.html#29631">[ thread ]</a>
              <a href="subject.html#29631">[ subject ]</a>
              <a href="author.html#29631">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Sat, 25 Dec 2010 07:39:02 +0100, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:

&gt;<i>  + I've made &lt;track&gt; have a feature whereby a track can be enabled by
</I>&gt;<i>    default so that users who would otherwise not have any tracks enabled
</I>&gt;<i>    will get it enabled (without overriding the preferences of users who
</I>&gt;<i>    would have some other track enabled by default).
</I>
For the lazy, it's &lt;track default&gt;, see  
<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html#attr-track-default">http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html#attr-track-default</A>

&gt;<i>    text/vtt respectively.
</I>&gt;<i>  + I've added a magic string that is required on the format to make it
</I>&gt;<i>    recognisable in environments with no or unreliable type labeling.
</I>
Is there a reason it's &quot;WEBVTT FILE&quot; instead of just &quot;WEBVTT&quot;? &quot;FILE&quot;  
seems redundant and like unnecessary typing to me.

&gt;<i> On Wed, 8 Sep 2010, Sam Dutton wrote:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Also -- is trackgroup out of the spec?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; What is trackgroup?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'd seen this in the Media TextAssociations documentation:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://www.w3.org/WAI/PF/HTML/wiki/Media_TextAssociations#Examples">http://www.w3.org/WAI/PF/HTML/wiki/Media_TextAssociations#Examples</A>
</I>&gt;<i>
</I>&gt;<i> The feature is mostly there, it's just expressed differently (it's done  
</I>&gt;<i> in
</I>&gt;<i> a way similar to how &lt;link&gt; works: you specify all the relevant  
</I>&gt;<i> attributes
</I>&gt;<i> on each &lt;track&gt;).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Wed, 8 Sep 2010, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In the discussion on public-html-a11y &lt;trackgroup&gt; was suggested to
</I>&gt;&gt;<i> group together mutually exclusive tracks, so that enabling one
</I>&gt;&gt;<i> automatically disables the others in the same trackgroup.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I guess it's up to the UA how to enable and disable &lt;track&gt;s now, but
</I>&gt;&gt;<i> the only option is making them all mutually exclusive (as existing
</I>&gt;&gt;<i> players do) or a weird kind of context menu where it's possible to
</I>&gt;&gt;<i> enable and disable tracks completely independently. Neither options is
</I>&gt;&gt;<i> great, but as a user I would almost certainly prefer all tracks being
</I>&gt;&gt;<i> mutually exclusive and requiring scripts to enable several at once.
</I>&gt;<i>
</I>&gt;<i> It's not clear to me what the use case is for having multiple groups of
</I>&gt;<i> mutually exclusive tracks.
</I>&gt;<i>
</I>&gt;<i> The intent of the spec as written was that a browser would by default  
</I>&gt;<i> just
</I>&gt;<i> have a list of all the subtitle and caption tracks (the latter with
</I>&gt;<i> suitable icons next to them, e.g. the [CC] icon in US locales), and the
</I>&gt;<i> user would pick one (or none) from the list. One could easily imagine a  
</I>&gt;<i> UA
</I>&gt;<i> allowing the user to enable multiple tracks by having the user ctrl-click
</I>&gt;<i> a menu item, though, or some similar solution, much like with the  
</I>&gt;<i> commonly
</I>&gt;<i> seen select box UI.
</I>
In the vast majority of cases, all tracks are intended to be mutually  
exclusive, such as English+English HoH or subtitles in different  
languages. No media player UI (hardware or software) that I have ever used  
allows enabling multiple tracks at once. Without any kind of hint about  
which tracks make sense to enable together, I can't see desktop Opera  
allowing multiple tracks (of the same kind) to be enabled via the main UI.

&gt;&gt;<i> &gt; On Fri, 6 Aug 2010, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; I'm not particularly fond of the current voice markup, mainly for 2
</I>&gt;&gt;<i> &gt; &gt; reasons:
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; First, a cue can only have 1 voice, which makes it impossible to
</I>&gt;&gt;<i> &gt; &gt; style cues spoken/sung simultaneously by 2 or more voices. There's a
</I>&gt;&gt;<i> &gt; &gt; karaoke example of this in
</I>&gt;&gt;<i> &gt; &gt;  
</I>&gt;&gt;<i> &lt;<A HREF="http://wiki.whatwg.org/wiki/Use_cases_for_timed_tracks_rendered_over_video_by_the_UA#Multiple_voices">http://wiki.whatwg.org/wiki/Use_cases_for_timed_tracks_rendered_over_video_by_the_UA#Multiple_voices</A>&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; That's just two cues.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm not sure what you're saying. The male singer's cues are in blue, the
</I>&gt;&gt;<i> female singer's are in red and the part sung together is in green. Are
</I>&gt;&gt;<i> you saying that the last cue should be made into two cues, or something
</I>&gt;&gt;<i> else?
</I>&gt;<i>
</I>&gt;<i> I would just have the three be labeled as three different voices. (I
</I>&gt;<i> thought you were referring to two people saying two different things on
</I>&gt;<i> the screen at the same time, which would be two cues.)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> &gt; &gt; I would prefer if voices could be mixed, as such:
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; 00:01.000 --&gt; 00:02.000
</I>&gt;&gt;<i> &gt; &gt; &lt;1&gt; Speaker 1
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; 00:03.000 --&gt; 00:04.000
</I>&gt;&gt;<i> &gt; &gt; &lt;2&gt; Speaker 2
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; 00:05.000 --&gt; 00:06.000
</I>&gt;&gt;<i> &gt; &gt; &lt;1&gt;&lt;2&gt; Speaker 1+2
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; What's the use case?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To use a different style for the cues that are sung together, so that
</I>&gt;&gt;<i> you know when it's your turn to sing.
</I>&gt;<i>
</I>&gt;<i> It's not clear whether multiple voices is really necessary. Can't you  
</I>&gt;<i> just
</I>&gt;<i> do (using the new syntax):
</I>&gt;<i>
</I>&gt;<i>  00:01.000 --&gt; 00:02.000
</I>&gt;<i>  &lt;v Bob&gt; Speaker 1
</I>&gt;<i> 00:03.000 --&gt; 00:04.000
</I>&gt;<i>  &lt;v Jim&gt; Speaker 2
</I>&gt;<i> 00:05.000 --&gt; 00:06.000
</I>&gt;<i>  &lt;v Bob and Jim&gt; Speaker 1+2
</I>&gt;<i>
</I>&gt;<i> ...where &quot;Bob and Jim&quot; is a third name?
</I>
Sure, one could, but the new syntax/parsing also allows &lt;v Bob&gt;&lt;v Jim&gt;  
Speaker 1+2, which is what I requested.

Using this syntax, I would expect some confusion when you omit the closing  
&lt;/v&gt;, when it's *not* a cue spoken by two voices at the same time, such as:

&lt;v Jim&gt;- Boo!
&lt;v Bob&gt;- Gah!

Gah! is spoken by both Jim and Bob, but that was likely not intended. If  
this causes confusion, we should make validators warn about multiple  
voices with with no closing &lt;/v&gt;.

&gt;&gt;<i> &gt; On Tue, 24 Aug 2010, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; Here's the SRT research I promised:
</I>&gt;&gt;<i> &gt; &gt; <A HREF="http://blog.foolip.org/2010/08/20/srt-research/">http://blog.foolip.org/2010/08/20/srt-research/</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Awesome! Thanks for this.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Addressing points in the same order:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; - charset: resolved by introducing a charset override.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Oh well, that's better than sniffing the encoding or trusting
</I>&gt;&gt;<i> Content-Type I guess.
</I>&gt;<i>
</I>&gt;<i> Based on the additional research you and others provided, I've removed  
</I>&gt;<i> the
</I>&gt;<i> charset=&quot;&quot; attribute again, and given up on the idea of supporting legacy
</I>&gt;<i> content unmodified.
</I>
One charset to rule them all, excellent!

&gt;&gt;<i> &gt; - blank lines not separating cues: I couldn't find a client that
</I>&gt;&gt;<i> &gt;   supported missing the blank line, so I didn't support that. It's a
</I>&gt;&gt;<i> &gt;   small number of files, and a small number of cues within those  
</I>&gt;&gt;<i> files,
</I>&gt;&gt;<i> &gt;   I presume, so I'm not too worried.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Indeed, I couldn't find one either, the players I tested instead
</I>&gt;&gt;<i> rendered the timing line and following cue text together with the
</I>&gt;&gt;<i> previous cue, just like a WebSRT implementation would. What we could do
</I>&gt;&gt;<i> to slightly improve the situation is to make --&gt; invalid in the cue
</I>&gt;&gt;<i> text, so that validators could warn about this. That would require
</I>&gt;&gt;<i> adding a &gt; escape for &gt;, so I'm not sure it's worth it. Perhaps
</I>&gt;&gt;<i> validators could warn about it regardless of the spec.
</I>&gt;<i>
</I>&gt;<i> Certainly if the rest of the line matches a timing line, a warning
</I>&gt;<i> wouldn't be a bad idea, but I don't know that it should be invalid.
</I>
OK, this is something for validators, I agree.

&gt;&gt;<i> For captions and subtitles
</I>&gt;&gt;<i> it's less common, but rendering it underneath the video rather than on
</I>&gt;&gt;<i> top of it is not uncommon, e.g.
</I>&gt;&gt;<i> <A HREF="http://nihseniorhealth.gov/video/promo_qt300.html">http://nihseniorhealth.gov/video/promo_qt300.html</A> or
</I>&gt;<i>
</I>&gt;<i> Conceptually, that's in the video area, it's just that the video isn't
</I>&gt;<i> centered vertically. I suppose we could allow UAs to do that pretty
</I>&gt;<i> easily, if it's commonly desired.
</I>
It's already possible to align the video to the top of its content box  
using &lt;<A HREF="http://dev.w3.org/csswg/css3-images/#object-position">http://dev.w3.org/csswg/css3-images/#object-position</A>&gt;:

video { object-position: center top }

(This is already supported in Opera, but prefixed: -o-object-position)

&gt;&gt;<i> &gt; On Tue, 24 Aug 2010, Silvia Pfeiffer wrote:
</I>&gt;&gt;<i> &gt; &gt;
</I>&gt;&gt;<i> &gt; &gt; I believe [SVG etc] will be [added to WebSRT]. But since we are only
</I>&gt;&gt;<i> &gt; &gt; looking at the ways in which captions and subtitles are used
</I>&gt;&gt;<i> &gt; &gt; currently, we haven't accepted this as an important use case, which
</I>&gt;&gt;<i> &gt; &gt; is fair enough. I am considering likely future use though, which is
</I>&gt;&gt;<i> &gt; &gt; always hard to argue.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; In all my research for subtitles, I found very few cases of anything
</I>&gt;&gt;<i> &gt; like this. Even DVDs, whose subtitle tracks are just hardcoded bitmap
</I>&gt;&gt;<i> &gt; images, don't do anything fancy with them... just plain text and
</I>&gt;&gt;<i> &gt; italics, generally. Why haven't people started doing fancy stuff with
</I>&gt;&gt;<i> &gt; subtitles in all the years that we've had TVs? It's not like they
</I>&gt;&gt;<i> &gt; can't do it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> SVG on the TV? All that was possible was teletext type graphics and
</I>&gt;&gt;<i> indeed, people did a lot of graphics there, e.g.
</I>&gt;&gt;<i> <A HREF="http://www.google.com.au/images?q=teletext">http://www.google.com.au/images?q=teletext</A> .
</I>&gt;<i>
</I>&gt;<i> Not in subtitles though.
</I>
Note that in Sweden captioning for the HoH is delivered via the teletext  
system, which would allow ASCII-art to be displayed. Still, I've never  
seen it. The only case of graphics being used in &quot;subtitles&quot; I can  
remember ever seeing is the DVD of  
&lt;<A HREF="http://en.wikipedia.org/wiki/Cat_Soup">http://en.wikipedia.org/wiki/Cat_Soup</A>&gt;, where the subtitle system is  
(ab)used to overlay some graphics.

&gt;<i> On Fri, 10 Sep 2010, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Not being convinced we need anything more than simple key-value headers
</I>&gt;&gt;<i> in a header, I still looked at the options for comments:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Making any line with a --&gt; in it be a comment would hide a lot of broken
</I>&gt;&gt;<i> cues from validators, so I think we shouldn't do this.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ; appears at the beginning of lines in 15/10000 files and most don't
</I>&gt;&gt;<i> look like they're intended as comments.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # appears at the beginning of lines in 244/10000 files and most don't
</I>&gt;&gt;<i> look like they're intended as comments.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /* only appears in 3/10000 files, so CSS-style comments might work, but
</I>&gt;&gt;<i> does add some complexity
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> // appears at the beginning of lines in 5/10000 files and most look like
</I>&gt;&gt;<i> that *are* intended as comments or are garbage, so it should work.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> (data from OpenSubtitles sample)
</I>&gt;<i>
</I>&gt;<i> Thanks for the data.
</I>&gt;<i>
</I>&gt;<i> If we're going to change the spec to require a magic header, then the
</I>&gt;<i> legacy content is of limited importance at this point, so I guess it
</I>&gt;<i> doesn't really matter. We can add any kind of backwards-compatible new
</I>&gt;<i> syntax in the future.
</I>
If we ever want comments, we need to add support in the parser before any  
content accidentally uses the syntax, in other words pretty soon now.

&gt;<i> On Mon, 13 Sep 2010, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> OK, I think we mostly agree. Any default will sometimes be wrong, so to
</I>&gt;&gt;<i> not have to choose between subtitles and captions, I'd still really
</I>&gt;&gt;<i> prefer if specific HoH-tags like &lt;sound&gt; can be shown or hidden
</I>&gt;&gt;<i> depending on user preference. I think that would lead to more content
</I>&gt;&gt;<i> actually being written for HoH users, as it doesn't requiring
</I>&gt;&gt;<i> maintaining 2 different files.
</I>&gt;<i>
</I>&gt;<i> My main concern with this is that it's not been done before. Given the
</I>&gt;<i> apparent simplicitly of the feature, it seems that there must be some
</I>&gt;<i> reason for this. One reason might be that it's never come up before.
</I>&gt;<i> Another reason might be that captions and subtitles are different in
</I>&gt;<i> subtle ways that make this inappropriate in practice. I think before we
</I>&gt;<i> add this feature, we should try to understand the history here.
</I>&gt;<i>
</I>&gt;<i> Note that even if we were able to point to a single file for both
</I>&gt;<i> subtitles and captions, we'd still have to specify them separately in the
</I>&gt;<i> markup, so that the UI could correctly identify the two options without
</I>&gt;<i> having to download and parse the two tracks first. So I'm not sure it
</I>&gt;<i> would actually help with the problem in question (the default kind).
</I>
Agreed, some experimentation in this area would be useful before spec'ing  
anything.

&gt;<i> On Tue, 14 Sep 2010, Anne van Kesteren wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Apart from text/plain I cannot think of a &quot;web&quot; text format that does
</I>&gt;&gt;<i> not have comments.
</I>&gt;<i>
</I>&gt;<i> But what's the use case? Is it really useful to have comments in a
</I>&gt;<i> subtitle file?
</I>
Being able to put licensing/contact information at the top of the file  
would be useful, just as it is in JavaScript/CSS.

&gt;<i> On Fri, 22 Oct 2010, Simon Pieters wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; It can still be inspired by it though so we don't have to change much.
</I>&gt;&gt;<i> &gt; I'd be curious to hear what other things you'd clean up given the
</I>&gt;&gt;<i> &gt; chance.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> WebSRT has a number of quirks to be compatible with SRT, like supporting
</I>&gt;&gt;<i> both comma and dot as decimal separators, the weird parsing of
</I>&gt;&gt;<i> timestamps, etc.
</I>&gt;<i>
</I>&gt;<i> I've cleaned the timestamp parsing up. I didn't see others.
</I>
I consider the cue id line (the line preceding the timing line) to be  
cruft carried over from SRT. When we now both have classes and the  
possibility of getting a cue by index, so why do we need it?

I suggest making it invalid and having the parser ignore it. Add it back  
only if people actually ask for it.

&gt;<i> On Tue, 5 Oct 2010, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> At the Open Subtitles Design Summit, there was some discussion about
</I>&gt;&gt;<i> captioning for the HoH. I've already put this input into a related bug
</I>&gt;&gt;<i> [2], but to summarize: The default rendering for the voices syntax
</I>&gt;&gt;<i> should probably be to prefix the text cue with the name of the speaker,
</I>&gt;&gt;<i> not to do anything funny with colors or positioning. What's less clear
</I>&gt;&gt;<i> is if it's annoying to always prefix with the speaker, or if it should
</I>&gt;&gt;<i> be done only to disambiguate.
</I>&gt;&gt;<i> [2] <A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=10320">http://www.w3.org/Bugs/Public/show_bug.cgi?id=10320</A>
</I>&gt;<i>
</I>&gt;<i> The bug is about the syntax, nor the rendering.
</I>&gt;<i>
</I>&gt;<i> The syntax suggestion makes sense, and I've updated the spec accordingly.
</I>&gt;<i>
</I>&gt;<i> I'm not sure what to do with the rendering. Could you elaborate on why we
</I>&gt;<i> would show the speaker names? Surely it would be better to let authors
</I>&gt;<i> explicitly put in the speaker names in the text of the cue if that's what
</I>&gt;<i> they want.
</I>
Having watched a bit more captions since the previous mail, I've noticed  
that when prefixing the name, it isn't always prefixed on all cues,  
sometimes only when it's needed to avoid ambiguity. I agree that no  
special default style is needed here, if one wants it it's now easy to do  
with CSS.

&gt;&gt;<i> * Note that certain ale5000-SRT syntax is not part of WebSRT, so that
</I>&gt;&gt;<i> one doesn't have to debug the parsing algorithm to learn that.
</I>&gt;<i>
</I>&gt;<i> Could you suggest some text for this? It's unclear to me exactly what
</I>&gt;<i> would be helpful here. In fact, noting that the language is no longer
</I>&gt;<i> called &quot;SRT&quot;, is this still necessary?
</I>
Changing the name is quite enough to avoid confusion about this.

&gt;&gt;<i> There was also some discussion about metadata. Language is sometimes
</I>&gt;&gt;<i> necessary for the font engine to pick the right glyph.
</I>&gt;<i>
</I>&gt;<i> Could you elaborate on this? My assumption was that we'd just use CSS,
</I>&gt;<i> which doesn't rely on language for this.
</I>
It's not in any spec that I'm aware of, but some browsers (including  
Opera) pick different glyphs depending on the language of the text, which  
really helps when rendering CJK when you have several CJK fonts on the  
system. Browsers will already know the language from &lt;track srclang&gt;, so  
this would be for external players.

&gt;&gt;<i> License is also an often requested piece of metadata.
</I>&gt;<i>
</I>&gt;<i> That would get solved if we allowed comments, which is how it's solved in
</I>&gt;<i> JS (CSS and HTML don't usually get licensed for some reason). I've punted
</I>&gt;<i> on this for now, so as to not make too many parsing changes at once.
</I>
Again, comments need to be added before there's any content accidentally  
using the syntax.

&gt;&gt;<i> Finally, some things I think are broken in the current WebSRT parser:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> * Parsing of timestamps is more liberal than it needs to be. In
</I>&gt;&gt;<i> particular, treating the part after the decimal separator as an integer
</I>&gt;&gt;<i> and dividing by 1000 leads to 00:00:00.1 being interpreted as 0.001
</I>&gt;&gt;<i> seconds, which is weird. This is what e.g. VLC does, but if we need to
</I>&gt;&gt;<i> add a header we could just as well change this to make more sane.
</I>&gt;&gt;<i> Alternatively, if we want to really align with C implementations using
</I>&gt;&gt;<i> scanf, we should also handle negative numbers (00:01:-5,000 means 55
</I>&gt;&gt;<i> seconds), octal and hexadecimal.
</I>&gt;<i>
</I>&gt;<i> Fixed.
</I>
Allowing the hours to be any number of digits made it more complex than  
necessary though, see  
&lt;<A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=11647">http://www.w3.org/Bugs/Public/show_bug.cgi?id=11647</A>&gt;.

&gt;&gt;<i> * The &quot;bad cue&quot; handling is stricter than it should be. After collecting
</I>&gt;&gt;<i> an id, the next line must be a timestamp line. Otherwise, we skip
</I>&gt;&gt;<i> everything until a blank line, so in the following the parser would jump
</I>&gt;&gt;<i> to &quot;bad cue&quot; on line &quot;2&quot; and skip the whole cue.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1
</I>&gt;&gt;<i> 2
</I>&gt;&gt;<i> 00:00:00.000 --&gt; 00:00:01.000
</I>&gt;&gt;<i> Bla
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This doesn't match what most existing SRT parsers do, as they simply
</I>&gt;&gt;<i> look for timing lines and ignore everything else. If we really need to
</I>&gt;&gt;<i> collect the id instead of ignoring it like everyone else, this should be
</I>&gt;&gt;<i> more robust, so that a valid timing line always begins a new cue.
</I>&gt;&gt;<i> Personally, I'd prefer if it is simply ignored and that we use some form
</I>&gt;&gt;<i> of in-cue markup for styling hooks.
</I>&gt;<i>
</I>&gt;<i> The IDs are useful for referencing cues from script, so I haven't removed
</I>&gt;<i> them. I've also left the parsing as is for when neither the first nor
</I>&gt;<i> second line is a timing line, since that gives us a lot of headroom for
</I>&gt;<i> future extensions (we can do anything so long as the second line doesn't
</I>&gt;<i> start with a timestamp and &quot;--&gt;&quot; and another timestamp).
</I>
In the case of feeding future extensions to current parsers, it's way  
better fallback behavior to simply ignore the unrecognized second line  
than to discard the entire cue. The current behavior seems unnecessarily  
strict and makes the parser more complicated than it needs to be. My  
preference is just ignore anything preceding the timing line, but even if  
we must have IDs it can still be made simpler and more robust than what is  
currently spec'ed.

-- 
Philip J&#228;genstedt
Core Developer
Opera Software
</PRE>






























<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="071902.html">[whatwg] sic element, was: Re: Exposing spelling/grammar suggestions in contentEditable
</A></li>
	<LI>Next message: <A HREF="071906.html">[whatwg] Timed tracks: feedback compendium
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29631">[ date ]</a>
              <a href="thread.html#29631">[ thread ]</a>
              <a href="subject.html#29631">[ subject ]</a>
              <a href="author.html#29631">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
