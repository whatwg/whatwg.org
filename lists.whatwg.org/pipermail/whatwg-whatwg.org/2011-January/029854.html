<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] WebWorkers and images
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20WebWorkers%20and%20images&In-Reply-To=%3CCFE27AFD-CC21-4926-AF99-D5A52EABF9F2%40jorgechamorro.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="029855.html">
   <LINK REL="Next"  HREF="029869.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] WebWorkers and images</H1>
<!--htdig_noindex-->
    <B>Jorge</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20WebWorkers%20and%20images&In-Reply-To=%3CCFE27AFD-CC21-4926-AF99-D5A52EABF9F2%40jorgechamorro.com%3E"
       TITLE="[whatwg] WebWorkers and images">jorge at jorgechamorro.com
       </A><BR>
    <I>Thu Jan 13 15:53:10 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="029855.html">[whatwg] WebWorkers and images
</A></li>
        <LI>Next message: <A HREF="029869.html">[whatwg] WebWorkers and images
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29854">[ date ]</a>
              <a href="thread.html#29854">[ thread ]</a>
              <a href="subject.html#29854">[ subject ]</a>
              <a href="author.html#29854">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 13/01/2011, at 23:21, Boris Zbarsky wrote:
&gt;<i> On 1/13/11 4:37 PM, Glenn Maynard wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> I suspect there's something simpler going on here, though--as you
</I>&gt;&gt;<i> said, copying a 10 MB buffer really should be very quick.
</I>&gt;<i> 
</I>&gt;<i> It's really not that quick, actually.  First, you have to allocate a new 10MB buffer.  Then you have to memcpy into it.  Then you have to free it at some point.  I just wrote a simple test C program that has a single 10MB array initialized and then in a loop allocates a 10MB array, memcpys into it, and then frees the 10MB allocation it just made.  It takes about 5ms per loop iteration to run on my system (fairly high-end laptop that was new in July 2010).  The time is split about 50-50 between the allocation and the memcpy.
</I>&gt;<i> 
</I>&gt;<i> Just to be clear, 2.5ms to copy 10MB means that my CPU is spending about 0.25ns per byte.  It's a 2.66Ghz CPU, so that's about 0.66 clock cycles per byte, or about 1.5 bytes per clock cycle.  That's pretty believable if we're having to stall the CPU every so often to wait for RAM.
</I>&gt;<i> 
</I>&gt;<i> Note that a key issue here is that 10MB is larger than half my L3 cache.  If I stick to arrays that are small enough that both source and destination fit in the cache, things are much faster.
</I>

Right, and there's neither the need to duplicate them, nor to occupy say 300Mb/s of memory bandwidth memcpying frames @ 30 fps, nor to trash 5*30 ms of cpu time per second, gratuitously, when it can be avoided.
-- 
Jorge.
</PRE>




















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="029855.html">[whatwg] WebWorkers and images
</A></li>
	<LI>Next message: <A HREF="029869.html">[whatwg] WebWorkers and images
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29854">[ date ]</a>
              <a href="thread.html#29854">[ thread ]</a>
              <a href="subject.html#29854">[ subject ]</a>
              <a href="author.html#29854">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
