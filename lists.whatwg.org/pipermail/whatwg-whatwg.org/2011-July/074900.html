<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] PeerConnection, MediaStream, getUserMedia(),	and other feedback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20PeerConnection%2C%20MediaStream%2C%20getUserMedia%28%29%2C%0A%09and%20other%20feedback&In-Reply-To=%3CCALLKCfOeJLRL1ynw33NSC0bzvfWgQ1HYiZ3oTJJa5OSAN%3D44iQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="074896.html">
   <LINK REL="Next"  HREF="032523.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] PeerConnection, MediaStream, getUserMedia(),	and other feedback</H1>
<!--htdig_noindex-->
    <B>Tommy Widenflycht (&#5839;&#5806;&#5848;&#5848;&#5796;)</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20PeerConnection%2C%20MediaStream%2C%20getUserMedia%28%29%2C%0A%09and%20other%20feedback&In-Reply-To=%3CCALLKCfOeJLRL1ynw33NSC0bzvfWgQ1HYiZ3oTJJa5OSAN%3D44iQ%40mail.gmail.com%3E"
       TITLE="[whatwg] PeerConnection, MediaStream, getUserMedia(),	and other feedback">tommyw at google.com
       </A><BR>
    <I>Tue Jul 26 06:03:26 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="074896.html">[whatwg] PeerConnection, MediaStream, getUserMedia(), and other feedback
</A></li>
        <LI>Next message: <A HREF="032523.html">[whatwg] Muting MediaStreamTracks?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74900">[ date ]</a>
              <a href="thread.html#74900">[ thread ]</a>
              <a href="subject.html#74900">[ subject ]</a>
              <a href="author.html#74900">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, Jul 26, 2011 at 07:30, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; If you send two MediaStream objects constructed from the same
</I>&gt;<i> &gt; LocalMediaStream over a PeerConnection there needs to be a way to
</I>&gt;<i> &gt; separate them on the receiving side.
</I>&gt;<i>
</I>&gt;<i> What's the use case for sending the same feed twice?
</I>&gt;<i>
</I>
There's no proper use case as such but the spec allows this.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I also think it is a bit unfortunate that we now have a 'label' property
</I>&gt;<i> &gt; on the track objects that means something else than the 'label' property
</I>&gt;<i> &gt; on MediaStream, perhaps 'description' would be a more suitable name for
</I>&gt;<i> &gt; the former.
</I>&gt;<i>
</I>&gt;<i> In what sense do they mean different things? I don't understand the
</I>&gt;<i> problem here. Can you elaborate?
</I>&gt;<i>
</I>
label on a MediaStream is a unique identifier, while the label on a
MediaStreamTrack is just a description like &quot;Logitech Vision Pro&quot;, &quot;Line In&quot;
or &quot;Built-in Mic&quot;. I too find this a bit odd.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Wed, 20 Jul 2011, Tommy Widenflycht (&#225;~[~O&#225;~Z&#174;&#225;~[~X&#225;~[~X&#225;~Z&#164;) wrote:
</I>&gt;<i> &gt; On Mon, Jul 18, 2011 at 20:38, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; On Mon, 18 Jul 2011, Tommy Widenflycht (&#195;&#161;~[~O&#195;&#161;~Z&#194;&#174;&#195;&#161;~[~X&#195;&#161;~[~X&#195;&#161;~Z&#194;&#164;)
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I am very confused regarding the below paragraph from the latest
</I>&gt;<i> &gt; &gt; &gt; spec:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; When a track in a MediaStream parent is disabled, any
</I>&gt;<i> &gt; &gt; &gt; MediaStreamTrack objects corresponding to the tracks in any
</I>&gt;<i> &gt; &gt; &gt; MediaStream objects that were created from parent are disassociated
</I>&gt;<i> &gt; &gt; &gt; from any track, and must not be reused for tracks again. If a
</I>&gt;<i> &gt; &gt; &gt; disabled track in a MediaStream parent is re-enabled, from the
</I>&gt;<i> &gt; &gt; &gt; perspective of any MediaStream objects that were created from parent
</I>&gt;<i> &gt; &gt; &gt; it is a new track and thus new MediaStreamTrack objects must be
</I>&gt;<i> &gt; &gt; &gt; created for the tracks that correspond to the re-enabled track.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; After cloning a LocalMediaStream it looks like this:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; LocalMediaStream -&gt; MediaStream1
</I>&gt;<i> &gt; &gt; &gt; Track1(E)           Track1(E)
</I>&gt;<i> &gt; &gt; &gt; Track2(E)           Track2(E)
</I>&gt;<i> &gt; &gt; &gt; Track3(E)           Track3(E)
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; and as I interpret the spec it looks like this if Track1 in the
</I>&gt;<i> &gt; &gt; &gt; LocalMediaStream is disabled:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; LocalMediaStream -&gt; MediaStream1
</I>&gt;<i> &gt; &gt; &gt; Track1(D)           Track2(E)
</I>&gt;<i> &gt; &gt; &gt; Track2(E)           Track3(E)
</I>&gt;<i> &gt; &gt; &gt; Track3(E)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Correct so far (though I'd avoid the term &quot;cloning&quot; since it's not
</I>&gt;<i> &gt; &gt; quite what's going on here -- the spec uses &quot;forking&quot;, which may be
</I>&gt;<i> &gt; &gt; closer though is still not ideal).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; So Track1 disappears from the MediaStream1 object and doesn't come
</I>&gt;<i> &gt; &gt; &gt; back even if Track1 in the LMS object is enabled:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; LocalMediaStream -&gt; MediaStream1
</I>&gt;<i> &gt; &gt; &gt; Track1(E)           Track2(E)
</I>&gt;<i> &gt; &gt; &gt; Track2(E)           Track3(E)
</I>&gt;<i> &gt; &gt; &gt; Track3(E)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; No, it'll create a new track object:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;  LocalMediaStream -&gt; MediaStream1
</I>&gt;<i> &gt; &gt;  Track1(E)           Track4(E)
</I>&gt;<i> &gt; &gt;  Track2(E)           Track2(E)
</I>&gt;<i> &gt; &gt;  Track3(E)           Track3(E)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; This is specified in the sentence that starts &quot;If a disabled track in
</I>&gt;<i> &gt; &gt; a MediaStream parent is re-enabled...&quot;.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks for the explanation. To me this sounds overly complicated, why
</I>&gt;<i> &gt; not just make it so that an disable of a track will override the track
</I>&gt;<i> &gt; settings for forked MediaStreams?
</I>&gt;<i>
</I>&gt;<i> I don't understand what you mean. How would that be different?
</I>&gt;<i>
</I>&gt;<i>
</I>If I may make an analogy to the real world: plumbing.

Each fork of a MediaStream is a new joint in the pipe, my suggestion
introduces a tap at each joint. No matter how you open and close the tap at
the end (or middle); if any previous tap is closed there's nothing coming
through.
The spec currently removes and add the entire pipe after the changed joint.


&gt;<i>
</I>&gt;<i> &gt; Also some follow-up questions regarding the new TrackLists:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What should happen when a track fails? Should the entire stream fail,
</I>&gt;<i> &gt; the MSTrack silently be removed or the MSTrack disassociated with the
</I>&gt;<i> &gt; track (and thus becoming a do-nothing object)?
</I>&gt;<i>
</I>&gt;<i> What do you mean by &quot;fails&quot;?
</I>&gt;<i>
</I>
Yanking the USB cable to the camera for example. This should imho stop the
MS, not just silently send black video.


&gt;<i> &gt; What should happen when a stream with two or more video tracks is
</I>&gt;<i> &gt; associated to a &lt;video&gt; tag? Just render the first enabled one?
</I>&gt;<i>
</I>&gt;<i> Same as if you had a regular video file with multiple tracks.
</I>&gt;<i>
</I>&gt;<i>
</I>And that is? Sorry, this might be written down somewhere and I have missed
it.


/Tommy

-- 
Tommy Widenflycht, Senior Software Engineer
Google Sweden AB, Kungsbron 2, SE-11122 Stockholm, Sweden
Org. nr. 556656-6880
And yes, I have to include the above in every outgoing email according to EU
law.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="074896.html">[whatwg] PeerConnection, MediaStream, getUserMedia(), and other feedback
</A></li>
	<LI>Next message: <A HREF="032523.html">[whatwg] Muting MediaStreamTracks?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#74900">[ date ]</a>
              <a href="thread.html#74900">[ thread ]</a>
              <a href="subject.html#74900">[ subject ]</a>
              <a href="author.html#74900">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
