<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] a rel=attachment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20a%20rel%3Dattachment&In-Reply-To=%3CCA%2Bc2ei9qTff4Xmy2KawsJmg3VT3pEqsJaMAeCA4Gu8%2BZoQBwcg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032459.html">
   <LINK REL="Next"  HREF="032479.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] a rel=attachment</H1>
<!--htdig_noindex-->
    <B>Jonas Sicking</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20a%20rel%3Dattachment&In-Reply-To=%3CCA%2Bc2ei9qTff4Xmy2KawsJmg3VT3pEqsJaMAeCA4Gu8%2BZoQBwcg%40mail.gmail.com%3E"
       TITLE="[whatwg] a rel=attachment">jonas at sicking.cc
       </A><BR>
    <I>Fri Jul 15 11:39:15 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="032459.html">[whatwg] a rel=attachment
</A></li>
        <LI>Next message: <A HREF="032479.html">[whatwg] a rel=attachment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32474">[ date ]</a>
              <a href="thread.html#32474">[ thread ]</a>
              <a href="subject.html#32474">[ subject ]</a>
              <a href="author.html#32474">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>2011/7/14 Ian Fette (&#12452;&#12450;&#12531;&#12501;&#12455;&#12483;&#12486;&#12451;) &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ifette at google.com</A>&gt;:
&gt;<i> Many websites wish to offer a file for download, even though it could
</I>&gt;<i> potentially be viewed inline (take images, PDFs, or word documents as an
</I>&gt;<i> example). Traditionally the only way to achieve this is to set a
</I>&gt;<i> content-disposition header. *However, sometimes it is not possible for the
</I>&gt;<i> page author to have control over the response headers sent by the
</I>&gt;<i> server.*(A related example is offline apps, which may wish to provide
</I>&gt;<i> the user with
</I>&gt;<i> a way to &quot;download&quot; a file stored locally using the filesystem API but again
</I>&gt;<i> can't set any headers.) It would be nice to provide the page author with a
</I>&gt;<i> client side mechanism to trigger a download.
</I>&gt;<i>
</I>&gt;<i> After mulling this over with some application developers who are trying to
</I>&gt;<i> use this functionality, it seems like adding a &quot;rel&quot; attribute to the &lt;a&gt;
</I>&gt;<i> tag would be a straightforward, minimally invasive way to address this use
</I>&gt;<i> case. &lt;a rel=attachment href=blah.pdf&gt; would indicate that the browser
</I>&gt;<i> should treat this link as if the response came with a content-disposition:
</I>&gt;<i> attachment header, and offer to download/save the file for the user.
</I>
We've discussed a different solution to the same problem at mozilla.
The solution we discussed was allowing FileSaver to in addition to
taking a blob argument, allow it to take a url argument.

One concern which was brought up was the ability to cause the user to
download a file from a third party site. I.e. this would allow
evil.com to trick the user into downloading an email from the users
webmail, or download a page from their bank which contains all their
banking information. It might be easier to then trick the user into
re-uploading the saved file to evil.com since from a user's
perspective, it looked like the file came from evil.com

Another possible attack goes something like:
1. evil.com tricks the user into downloading sensitive data from bank.com
2. evil.com then asks the user to download a html from evil.com and
open the newly downloaded file
3. the html file contains script which reads the contents from the
file downloaded from bank.com and sends it back to evil.com

Step 1 and 2 require the user to answer &quot;yes&quot; to a dialog displayed by
the browser. However it's well known that users very often hit
whichever button they suspect will make the dialog go away, rather
than actually read the contents of the dialog.
Step 3 again requires the user to answer &quot;yes&quot; to a dialog displayed
by the browser in at least some browsers. Same caveat applies though.

One very simple remedy to this would be to require CORS opt-in for
cross-site downloads. For same-site downloads no special opt-in would
be required of course.

It's also possible that it would be ok to do this without any opt-ins
since there are a good number of actions that the user has to take in
all these scenarios. Definitely something that I'd be ok with
discussing with our security team.

Tentatively I would feel safer with the CORS option though. And again,
for same-site downloads this isn't a problem at all, but I suspect
that in many cases the file to be downloaded is hosted on a separate
server.

Oh, and I don't have strong opinions at this time on if rel=attachment
or FileSaver or both should be the way to trigger this functionality.

/ Jonas
</PRE>




















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032459.html">[whatwg] a rel=attachment
</A></li>
	<LI>Next message: <A HREF="032479.html">[whatwg] a rel=attachment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32474">[ date ]</a>
              <a href="thread.html#32474">[ thread ]</a>
              <a href="subject.html#32474">[ subject ]</a>
              <a href="author.html#32474">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
