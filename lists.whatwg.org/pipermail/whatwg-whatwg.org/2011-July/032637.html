<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Access to live/raw audio and video stream data from both local and remote sources
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Access%20to%20live/raw%20audio%20and%20video%20stream%20data%20from%20both%0A%20local%20and%20remote%20sources&In-Reply-To=%3C1311728171.2937.90113.camel%40robslapu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032633.html">
   <LINK REL="Next"  HREF="032640.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Access to live/raw audio and video stream data from both local and remote sources</H1>
<!--htdig_noindex-->
    <B>Rob Manson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Access%20to%20live/raw%20audio%20and%20video%20stream%20data%20from%20both%0A%20local%20and%20remote%20sources&In-Reply-To=%3C1311728171.2937.90113.camel%40robslapu%3E"
       TITLE="[whatwg] Access to live/raw audio and video stream data from both local and remote sources">roBman at mob-labs.com
       </A><BR>
    <I>Tue Jul 26 17:56:11 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="032633.html">[whatwg] Styling of datagrid content
</A></li>
        <LI>Next message: <A HREF="032640.html">[whatwg] Fixing undo on the Web - UndoManager and Transaction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32637">[ date ]</a>
              <a href="thread.html#32637">[ thread ]</a>
              <a href="subject.html#32637">[ subject ]</a>
              <a href="author.html#32637">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi,

sorry for posting across multiple groups, but I hope you'll see from my
comments below that this is really needed. 

This is definitely not intended as criticism of any of the work going
on.  It's intended as constructive feedback that hopefully provides
clarification on a key use case and it's supporting requirements.

        &quot;Access to live/raw audio and video stream data from both local
        and remote sources in a consistent way&quot;

I've spent quite a bit of time trying to follow a clear thread of
requirements/solutions that provide API access to raw stream data (e.g.
audio, video, etc.).  But I'm a bit concerned this is falling in the gap
between the DAP and RTC WGs.  If this is not the case then please point
me to the relevant docs and I'll happily get back in my box 8)

Here's how the thread seems to flow at the moment based on public
documents.

On the DAP page [1] the mission states:
        &quot;the Device APIs and Policy Working Group is to create
        client-side APIs that enable the development of Web Applications
        and Web Widgets that interact with devices services such as
        Calendar, Contacts, Camera, etc&quot;

So it seems clear that this is the place to start.  Further down that
page the &quot;HTML Media Capture&quot; and &quot;Media Capture&quot; APIs are listed.

HTML Media Capture (camera/microphone interactions through HTML forms)
initially seems like a good candidate, however the intro in the latest
PWD [2] clearly states:
        &quot;Providing streaming access to these capabilities is outside of
        the scope of this specification.&quot;

Followed by a NOTE that states:
        &quot;The Working Group is investigating the opportunity to specify
        streaming access via the proposed &lt;device&gt; element.&quot;
        
The link on the &quot;proposed &lt;device&gt; element&quot; [3] links to a &quot;no longer
maintained&quot; document that then redirects to the top level of the whatwg
&quot;current work&quot; page [4].  On that page the most relevant link is the
video conferencing and peer-to-peer communication section [5].  More
about that further below.

So back to the DAP page to follow explore the other Media Capture API
(programmatic access to camera/microphone) [1] and it's latest PWD [6].
The abstract states:
        &quot;This specification defines an Application Programming Interface
        (API) that provides access to the audio, image and video capture
        capabilities of the device.&quot;

And the introduction states:
        &quot;The Capture API defines a high-level interface for accessing
        the microphone and camera of a hosting device. It completes the
        HTML Form Based Media Capturing specification [HTMLMEDIACAPTURE]
        with a programmatic access to start a parametrized capture
        process.&quot;
        
So it seems clear that this is not related to streams in any way either.

The Notes column for this API on the DAP page [1] also states:
        &quot;Programmatic API that completes the form based approach
        Need to check if still interest in this
        How does it relate with the Web RTC Working Group?&quot;

Is there an updated position on this?

So if you then head over to the WebRTC WG's charter [7] it states:
        &quot;...to define client-side APIs to enable Real-Time
        Communications in Web browsers.
        
        These APIs should enable building applications that can be run
        inside a browser, requiring no extra downloads or plugins, that
        allow communication between parties using audio, video and
        supplementary real-time communication, without having to use
        intervening servers...&quot;
        
So this is clearly focused upon peer-to-peer communication &quot;between&quot;
systems and the stream related access is naturally just treated as an
ancillary requirement.  The scope section then states:
        &quot;Enabling real-time communications between Web browsers require
        the following client-side technologies to be available:
        
        - API functions to explore device capabilities, e.g. camera,
        microphone, speakers (currently in scope for the Device APIs &amp;
        Policy Working Group)
        - API functions to capture media from local devices (camera and
        microphone) (currently in scope for the Device APIs &amp; Policy
        Working Group)
        - API functions for encoding and other processing of those media
        streams,
        - API functions for establishing direct peer-to-peer
        connections, including firewall/NAT traversal
        - API functions for decoding and processing (including echo
        cancelling, stream synchronization and a number of other
        functions) of those streams at the incoming end,
        - Delivery to the user of those media streams via local screens
        and audio output devices (partially covered with HTML5)&quot;
        
So this is where I really start to feel the gap growing.  The DAP is
pointing to RTC saying not sure how if our Camera/Microphone APIs are
being superseded by the work in the RTC...and the RTC then points back
to say it will be relying on work in the DAP.  However the RTCs
Recommended Track Deliverables list does include:
        &quot;Media Stream Functions, Audio Stream Functions and Video Stream
        Functions&quot;

So then it's back to the whatwg MediaStream and LocalMediaStream current
work [8].  Following this through you end up back at the &lt;audio&gt; and
&lt;video&gt; media element with some brief discussion about media data [9].

Currently the only API that I'm aware of that allows live access to the
audio data through the &lt;audio&gt; tag is the relatively proprietary Mozilla
Audio Data API [10].

And while the video stream data can be accessed by rendering each frame
into a canvas 2d graphics context and then using getImageData to extract
and manipulate it from there [11], this seems more like a work around
than an elegantly designed solution.
 
As I said above, this is not intended as a criticism of the work that
the DAP WG, WebRTC WG or WHATWG are doing.  It's intended as
constructive feedback to highlight that the important use case of
&quot;Access to live/raw audio and video stream data from both local and
remote sources&quot; appears to be falling in the gaps between the groups. 

&gt;<i>From my perspective this is a critical use case for many advanced web
</I>apps that will help bring them in line with what's possible in the
native single vendor stack based apps at the moment (e.g. iPhone &amp;
Android).  And it's also critical for the advancement of web standards
based AR applications and other computer vision, hearing and signal
processing applications.

I understand that a lot of these specifications I've covered are in very
formative stages and that requirements and PWDs are just being drafted
as I write.  And that's exactly why I'm raising this as a single and
consolidated perspective that spans all these groups.  I hope this goes
some way towards &quot;Access to live/raw audio and video stream data from
both local and remote sources&quot; being treated as an essential and core
use case that binds together the work of all these groups.  With a clear
vision for this and a little consolidated work I think this will then
also open up a wide range of other app opportunities that we haven't
even thought of yet.  But at the moment it really feels like this is
being treated as an assumed requirement and could end up as a poorly
formed second class bundle of semi-related API hooks.

For this use case I'd really like these clear requirements to be
supported:
- access the raw stream data for both audio and video in similar ways
- access the raw stream data from both remote and local streams in
similar ways
- ability to inject new data or the transformed original data back into
streams and presented audio/video tags in a consistent way
- all of this be optimised for performance to meet the demands of live
signal processing

roBman

PS: I've also cc'd in the mozilla dev list as I think this directly
relates to the current &quot;booting to the web&quot; thread [12]


[1] <A HREF="http://www.w3.org/2009/dap/">http://www.w3.org/2009/dap/</A>
[2] <A HREF="http://www.w3.org/TR/2011/WD-html-media-capture-20110414/#introduction">http://www.w3.org/TR/2011/WD-html-media-capture-20110414/#introduction</A>
[3] <A HREF="http://dev.w3.org/html5/html-device/">http://dev.w3.org/html5/html-device/</A> 
[4] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/#devices">http://www.whatwg.org/specs/web-apps/current-work/complete/#devices</A> 
[5] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/#auto-toc-9">http://www.whatwg.org/specs/web-apps/current-work/complete/#auto-toc-9</A>
[6] <A HREF="http://www.w3.org/TR/2010/WD-media-capture-api-20100928/">http://www.w3.org/TR/2010/WD-media-capture-api-20100928/</A>
[7] <A HREF="http://www.w3.org/2011/04/webrtc-charter.html">http://www.w3.org/2011/04/webrtc-charter.html</A>
[8] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/video-conferencing-and-peer-to-peer-communication.html#mediastream">http://www.whatwg.org/specs/web-apps/current-work/complete/video-conferencing-and-peer-to-peer-communication.html#mediastream</A> 
[9] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/the-iframe-element.html#media-data">http://www.whatwg.org/specs/web-apps/current-work/complete/the-iframe-element.html#media-data</A>
[10] <A HREF="https://wiki.mozilla.org/Audio_Data_API">https://wiki.mozilla.org/Audio_Data_API</A>
[11] <A HREF="https://developer.mozilla.org/En/Manipulating_video_using_canvas">https://developer.mozilla.org/En/Manipulating_video_using_canvas</A>
[12] <A HREF="http://groups.google.com/group/mozilla.dev.platform/browse_thread/thread/7668a9d46a43e482#">http://groups.google.com/group/mozilla.dev.platform/browse_thread/thread/7668a9d46a43e482#</A> 

</PRE>




























<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032633.html">[whatwg] Styling of datagrid content
</A></li>
	<LI>Next message: <A HREF="032640.html">[whatwg] Fixing undo on the Web - UndoManager and Transaction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32637">[ date ]</a>
              <a href="thread.html#32637">[ thread ]</a>
              <a href="subject.html#32637">[ subject ]</a>
              <a href="author.html#32637">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
