<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Forcing a download
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Forcing%20a%20download&In-Reply-To=%3CCA%2Bc2ei9Q9zWpc1eqx5UMV%2BW6Qji9-1mFWCjJRB19uvpL18XTdA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032611.html">
   <LINK REL="Next"  HREF="032432.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Forcing a download</H1>
<!--htdig_noindex-->
    <B>Jonas Sicking</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Forcing%20a%20download&In-Reply-To=%3CCA%2Bc2ei9Q9zWpc1eqx5UMV%2BW6Qji9-1mFWCjJRB19uvpL18XTdA%40mail.gmail.com%3E"
       TITLE="[whatwg] Forcing a download">jonas at sicking.cc
       </A><BR>
    <I>Fri Jul 22 14:03:12 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="032611.html">[whatwg] Forcing a download
</A></li>
        <LI>Next message: <A HREF="032432.html">[whatwg] Microdata - Handling the case where a string is upgraded	to an object
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32612">[ date ]</a>
              <a href="thread.html#32612">[ thread ]</a>
              <a href="subject.html#32612">[ subject ]</a>
              <a href="author.html#32612">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, Jul 21, 2011 at 11:58 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
&gt;<i> Is there any reason to use CORS here at all? It seems like the simpler
</I>&gt;<i> solution would be the following:
</I>&gt;<i>
</I>&gt;<i> &#160;- If download=&quot;&quot; is set, then by default trigger a download rather than a
</I>&gt;<i> &#160; navigation action. (User can override via context menu.)
</I>&gt;<i> &#160;- Pick a filename for the download as follows:
</I>&gt;<i> &#160; - if the received resource has a Content-Disposition: attachment header
</I>&gt;<i> &#160; &#160; that specifies a filename, use that.
</I>&gt;<i> &#160; - otherwise, if the received resource has a Content-Disposition header
</I>&gt;<i> &#160; &#160; that specifies a filename, and the resource is same-origin, use that
</I>&gt;<i> &#160; &#160; filename.
</I>&gt;<i> &#160; - otherwise, if the received resource is same-origin and the
</I>&gt;<i> &#160; &#160; download=&quot;&quot; attribute specifies a filename, use that.
</I>&gt;<i> &#160; - otherwise, if the received resource has a Content-Disposition:
</I>&gt;<i> &#160; &#160; attachment header and the download=&quot;&quot; attribute specifies a filename,
</I>&gt;<i> &#160; &#160; use the filename from the attribute.
</I>&gt;<i> &#160; - otherwise, if the received resource is same-origin then derive a
</I>&gt;<i> &#160; &#160; filename from the resource.
</I>&gt;<i> &#160; - otherwise, either abort or alert the user that a file is being
</I>&gt;<i> &#160; &#160; downloaded from a different origin and prompt for a filename.
</I>&gt;<i> &#160;- If a mapping from the MIME type to an extension is known, but the
</I>&gt;<i> &#160; filename doesn't have that extension, add it.
</I>&gt;<i>
</I>&gt;<i> This is what I've used for now (modulo some allowances for user
</I>&gt;<i> interfaces), but I welcome suggests for changing this.
</I>
The &quot;otherwise, either abort or alert the user that a file is being
downloaded from a different origin and prompt for a filename&quot; step
seems to allow to *very* different browser behaviors, resulting in a
site working in one browser, but not in another.

I'm still trying to find a date when we can do a security review about
this in mozilla though. It still does seem very strange to me that a
bank site which sends &quot;cache-control: no-store&quot; for a resource in
order to prevent it from being temporarily stored on the users hard
drive, can still end up being *permanently* stored on a users hard
drive. All that's needed is for the user to click a 'yes' button on a
download dialog while watching a seemingly harmless site.

/ Jonas
</PRE>







<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032611.html">[whatwg] Forcing a download
</A></li>
	<LI>Next message: <A HREF="032432.html">[whatwg] Microdata - Handling the case where a string is upgraded	to an object
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32612">[ date ]</a>
              <a href="thread.html#32612">[ thread ]</a>
              <a href="subject.html#32612">[ subject ]</a>
              <a href="author.html#32612">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
