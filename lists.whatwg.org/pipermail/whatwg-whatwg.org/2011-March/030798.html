<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Multiple globals and direct/indirect eval
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Multiple%20globals%20and%20direct/indirect%20eval&In-Reply-To=%3C4D70EED9.8060308%40enseirb-matmeca.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030796.html">
   <LINK REL="Next"  HREF="073072.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Multiple globals and direct/indirect eval</H1>
<!--htdig_noindex-->
    <B>David Bruant</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Multiple%20globals%20and%20direct/indirect%20eval&In-Reply-To=%3C4D70EED9.8060308%40enseirb-matmeca.fr%3E"
       TITLE="[whatwg] Multiple globals and direct/indirect eval">bruant at enseirb-matmeca.fr
       </A><BR>
    <I>Fri Mar  4 05:53:29 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="030796.html">[whatwg] [html5] r5928 - [acgiow] (0) Drop forminput and formchange events, and their associated machiner [...]
</A></li>
        <LI>Next message: <A HREF="073072.html">[whatwg] Multiple globals and direct/indirect eval
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30798">[ date ]</a>
              <a href="thread.html#30798">[ thread ]</a>
              <a href="subject.html#30798">[ subject ]</a>
              <a href="author.html#30798">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>[Adding WhatWG and public-script-coord (WebIDL) to the discussion.
Discussion is ongoing :
- Start of thread :
<A HREF="https://mail.mozilla.org/pipermail/es-discuss/2011-March/012915.html">https://mail.mozilla.org/pipermail/es-discuss/2011-March/012915.html</A>
- Strawman by Dave Herman:
<A HREF="http://wiki.ecmascript.org/doku.php?id=strawman:multiple_globals">http://wiki.ecmascript.org/doku.php?id=strawman:multiple_globals</A> )]

-------------------
Hi,

I am wondering if ECMAScript is the right &quot;place&quot; to standardize this.
Web browsers face multiple global object via a mecanism which isn't
under the ECMAScript scope (namely HTMLIFrameElements
(<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-iframe-element.html#htmliframeelement">http://www.whatwg.org/specs/web-apps/current-work/multipage/the-iframe-element.html#htmliframeelement</A>)
which aren't even DOM but HTMLDOM-specific).
Other ECMAScript implementations could face the issue of having several
globals but with other non-HTMLDOM use cases. For that reason, I think
it'd be dangerous for ECMAScript to standardize anything on the topic.

To answer Jeff Walden's final questions, in my opinion, WebIDL would be
a way better place to standardize this. ECMAScript could at most provide
guidelines for ECMAScript implementors who would have to face this issue
(gathering feedback and experience from implementations).

Cheers,
David



Le 03/03/2011 23:39, Jeff Walden a &#233;crit :
&gt;<i> A few months back I noticed an interesting interaction between how
</I>&gt;<i> direct eval is defined and multiple globals.  What happens if, in one
</I>&gt;<i> global, you call an eval from another global as if it were a direct eval?
</I>&gt;<i>
</I>&gt;<i>   var indirect = otherGlobal.eval;
</I>&gt;<i>   eval = indirect;
</I>&gt;<i>   print(eval(&quot;this&quot;) === this);
</I>&gt;<i>   print(indirect(&quot;this&quot;) === this);
</I>&gt;<i>
</I>&gt;<i> Standards currently don't say what should happen here because it's
</I>&gt;<i> multiple globals, so what should this do?  IE9 and Opera print false
</I>&gt;<i> both times for this.  Firefox prints true, then false -- but only if
</I>&gt;<i> the global and otherGlobal are from the same origin (so on pages with
</I>&gt;<i> the same scheme/host/port, more or less).  If they're from different
</I>&gt;<i> origins (but have set document.domain to the same value) Firefox too
</I>&gt;<i> prints false.  Chrome and Safari throw an EvalError calling another
</I>&gt;<i> window's eval (for both &quot;direct&quot; and indirect calls) without that
</I>&gt;<i> window as |this| for the call.
</I>&gt;<i>
</I>&gt;<i> The Chrome/Safari behavior would resurrect the vestigial EvalError, so
</I>&gt;<i> I don't think it makes sense.  It also contradicts the specification
</I>&gt;<i> of the steps in the definition of the eval function.  Firefox's
</I>&gt;<i> behavior is inconsistent and seems not amenable to host-agnostic
</I>&gt;<i> specification as ECMA would require.  Thus we are left with the
</I>&gt;<i> IE9/Opera behavior, which seems sensible and natural to me: an eval
</I>&gt;<i> function should always act in the context of the global from which it
</I>&gt;<i> came.
</I>&gt;<i>
</I>&gt;<i> What needs to be done to standardize this behavior?  And more
</I>&gt;<i> generally, what needs to be done to begin standardizing multiple
</I>&gt;<i> globals in ECMAScript, including issues like this one?
</I>&gt;<i>
</I>&gt;<i> Jeff
</I>&gt;<i> _______________________________________________
</I>&gt;<i> es-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">es-discuss at mozilla.org</A>
</I>&gt;<i> <A HREF="https://mail.mozilla.org/listinfo/es-discuss">https://mail.mozilla.org/listinfo/es-discuss</A>
</I>
</PRE>














































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030796.html">[whatwg] [html5] r5928 - [acgiow] (0) Drop forminput and formchange events, and their associated machiner [...]
</A></li>
	<LI>Next message: <A HREF="073072.html">[whatwg] Multiple globals and direct/indirect eval
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30798">[ date ]</a>
              <a href="thread.html#30798">[ thread ]</a>
              <a href="subject.html#30798">[ subject ]</a>
              <a href="author.html#30798">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
