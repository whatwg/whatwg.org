<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Redirect handling for &lt;audio&gt; &amp; &lt;video&gt;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Redirect%20handling%20for%20%3Caudio%3E%20%26%20%3Cvideo%3E&In-Reply-To=%3CAANLkTikDXiQXHWVDuc2Ta6NyWoNLG8T_n7eCs4RP8qAL%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030797.html">
   <LINK REL="Next"  HREF="030849.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Redirect handling for &lt;audio&gt; &amp; &lt;video&gt;</H1>
<!--htdig_noindex-->
    <B>Aaron Colwell</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Redirect%20handling%20for%20%3Caudio%3E%20%26%20%3Cvideo%3E&In-Reply-To=%3CAANLkTikDXiQXHWVDuc2Ta6NyWoNLG8T_n7eCs4RP8qAL%40mail.gmail.com%3E"
       TITLE="[whatwg] Redirect handling for &lt;audio&gt; &amp; &lt;video&gt;">acolwell at google.com
       </A><BR>
    <I>Wed Mar  9 10:48:30 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="030797.html">[whatwg] Redirect handling for &lt;audio&gt; &amp; &lt;video&gt;
</A></li>
        <LI>Next message: <A HREF="030849.html">[whatwg] Redirect handling for &lt;audio&gt; &amp; &lt;video&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30846">[ date ]</a>
              <a href="thread.html#30846">[ thread ]</a>
              <a href="subject.html#30846">[ subject ]</a>
              <a href="author.html#30846">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Thanks for your response.. comments inline

On Fri, Mar 4, 2011 at 1:30 AM, Philip J&#228;genstedt &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>&gt; wrote:

&gt;<i> On Thu, 03 Mar 2011 22:15:58 +0100, Aaron Colwell &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">acolwell at google.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i>  Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I was looking at the resource fetch
</I>&gt;&gt;<i> algorithm&lt;
</I>&gt;&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html#concept-media-load-resource">http://www.whatwg.org/specs/web-apps/current-work/multipage/video.html#concept-media-load-resource</A>
</I>&gt;&gt;<i> &gt;section
</I>&gt;&gt;<i> and fetching
</I>&gt;&gt;<i> resources &lt;
</I>&gt;&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#fetch">http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#fetch</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> sections of the HTML5 spec to determine what the proper behavior is for
</I>&gt;&gt;<i> handling
</I>&gt;&gt;<i> redirects. Both YouTube and Vimeo do 302 redirects to different hostnames
</I>&gt;&gt;<i> from
</I>&gt;&gt;<i> the URLs specified in the src attribute. It looks like the spec says that
</I>&gt;&gt;<i> playback should fail in these cases because they are from different
</I>&gt;&gt;<i> origins (Section 2.7 Fetching resources bullet 7). This leads me to a few
</I>&gt;&gt;<i> questions.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. Is my interpretation of the spec correct? Sample YouTube &amp; Vimeo URLs
</I>&gt;&gt;<i> are
</I>&gt;&gt;<i>   shown below.
</I>&gt;&gt;<i>   YouTube : src      : <A HREF="http://v22.lscache6.c.youtube.com/videoplayback?">http://v22.lscache6.c.youtube.com/videoplayback?</A>
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i>             redirect : <A HREF="http://tc.v22.cache6.c.youtube.com/videoplayback?">http://tc.v22.cache6.c.youtube.com/videoplayback?</A>
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   Vimeo   : src      : <A HREF="http://player.vimeo.com/play_redirect?">http://player.vimeo.com/play_redirect?</A> ...
</I>&gt;&gt;<i>             redirect : <A HREF="http://av.vimeo.com/05">http://av.vimeo.com/05</A> ...
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Yes, from what I can tell you're correct, but I think it's not intentional.
</I>&gt;<i> The behavior was changed by &lt;<A HREF="http://html5.org/r/5111">http://html5.org/r/5111</A>&gt; in 2010-06-25, and
</I>&gt;<i> this is the first time I've noticed it. Opera (and I assume most if not all
</I>&gt;<i> other browsers) already supports HTTP redirects for &lt;video&gt; and I don't
</I>&gt;<i> think it makes much sense to disallow it. For security purposes, the origin
</I>&gt;<i> of the resource is considered to be the final destination, not any of the
</I>&gt;<i> origins in the redirect chain.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I agree that redirects should be allowed, but it seems like the force
</I>same-origin flag was introduced to limit the types of redirects. The YouTube
&amp; Vimeo cases mentioned above seem reasonable, but redirects from vimeo.comto
malicious-site.com might not be ok. It looks like the changes reference CORS
as a future solution. Do you have any CORS references that might be helpful?

You also mentioned that the final destination is what should be used for
security. It seems like this could cause problems for canvas.drawImage() (
<A HREF="http://www.whatwg.org/specs/web-apps/current-work/#security-with-canvas-elements">http://www.whatwg.org/specs/web-apps/current-work/#security-with-canvas-elements</A>)
when trying copy video data to the canvas. If I understand you correctly a
page on YouTube would have to come from the final destination origin to
allow canvas.drawImage() to work. Is that correct?


&gt;<i>  2. What about http: -&gt; https: redirects? Some content is required to be
</I>&gt;&gt;<i> delivered
</I>&gt;&gt;<i>   only via https and this sort of redirect enforces that but isn't really
</I>&gt;&gt;<i> a
</I>&gt;&gt;<i> different origin.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Quoting &lt;
</I>&gt;<i> <A HREF="http://tools.ietf.org/html/draft-abarth-principles-of-origin-00#section-3">http://tools.ietf.org/html/draft-abarth-principles-of-origin-00#section-3</A>
</I>&gt;<i> &gt;:
</I>&gt;<i>
</I>&gt;<i> &quot;two URLs are part of the same origin (i.e., represent the same principal)
</I>&gt;<i> if they have the same scheme, host, and port&quot;
</I>&gt;<i>
</I>&gt;<i> Since both the scheme (http vs https) and port (80 vs 443) would be
</I>&gt;<i> different, it's considered a different origin.
</I>

I think I made some poor word choices here. I agree that they are different
origins because the scheme and port are different. I was just trying to get
at the fact they still referred to the same content just over a secure
connection. It seems like there are use cases where a set of &lt;scheme, host,
port&gt; tuples should be considered a single origin from a security point of
view. It just isn't clear to me how we are supposed to express that.


&gt;<i>
</I>&gt;<i>  3. If my interpretation of the spec is correct, are there proposals to
</I>&gt;&gt;<i> change this
</I>&gt;&gt;<i>   or other specs that allow content providers to signal that these
</I>&gt;&gt;<i> different hostnames
</I>&gt;&gt;<i>   actually represent the same &quot;origin&quot;.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I think the force same-origin flag introduced by &lt;<A HREF="http://html5.org/r/5111">http://html5.org/r/5111</A>&gt;
</I>&gt;<i> should be removed from the resource fetch algorithm, but the http vs https
</I>&gt;<i> origin issue is not something that can really be changed.
</I>&gt;<i>
</I>
So what is the process for proposing this type of change? Is this the right
forum?
Why is allowing redirects with the same scheme but different hosts ok, but
redirecting different schemes with the same host not ok? I'm new to this so
I'm just trying to understand.


Aaron
</PRE>



























<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030797.html">[whatwg] Redirect handling for &lt;audio&gt; &amp; &lt;video&gt;
</A></li>
	<LI>Next message: <A HREF="030849.html">[whatwg] Redirect handling for &lt;audio&gt; &amp; &lt;video&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30846">[ date ]</a>
              <a href="thread.html#30846">[ thread ]</a>
              <a href="subject.html#30846">[ subject ]</a>
              <a href="author.html#30846">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
