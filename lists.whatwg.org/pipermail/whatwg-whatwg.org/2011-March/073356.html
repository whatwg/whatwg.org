<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Recording interface (Re:  Peer-to-peer communication, video conferencing, and related topics (2))
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Recording%20interface%20%28Re%3A%20%20Peer-to-peer%20communication%2C%0A%20video%20conferencing%2C%20and%20related%20topics%20%282%29%29&In-Reply-To=%3CBBF498F2D030E84AB1179E24D1AC41D612066ED56E%40ESESSCMS0362.eemea.ericsson.se%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="073339.html">
   <LINK REL="Next"  HREF="073341.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Recording interface (Re:  Peer-to-peer communication, video conferencing, and related topics (2))</H1>
<!--htdig_noindex-->
    <B>Stefan H&#229;kansson LK</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Recording%20interface%20%28Re%3A%20%20Peer-to-peer%20communication%2C%0A%20video%20conferencing%2C%20and%20related%20topics%20%282%29%29&In-Reply-To=%3CBBF498F2D030E84AB1179E24D1AC41D612066ED56E%40ESESSCMS0362.eemea.ericsson.se%3E"
       TITLE="[whatwg] Recording interface (Re:  Peer-to-peer communication, video conferencing, and related topics (2))">stefan.lk.hakansson at ericsson.com
       </A><BR>
    <I>Tue Mar 29 23:37:09 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="073339.html">[whatwg] Recording interface (Re:  Peer-to-peer communication, video conferencing, and related topics (2))
</A></li>
        <LI>Next message: <A HREF="073341.html">[whatwg] Media negotiation (RE:  Peer-to-peer communication, video conferencing, and related topics (2))
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73356">[ date ]</a>
              <a href="thread.html#73356">[ thread ]</a>
              <a href="subject.html#73356">[ subject ]</a>
              <a href="author.html#73356">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg-bounces at lists.whatwg.org</A>
</I>&gt;<i> [mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg-bounces at lists.whatwg.org</A>] On Behalf Of
</I>&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg-request at lists.whatwg.org</A>
</I>&gt;<i> Sent: den 29 mars 2011 20:33
</I>&gt;<i> To: <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at lists.whatwg.org</A>
</I>&gt;<i> Subject: whatwg Digest, Vol 84, Issue 69
</I>&gt;<i> &gt;&gt; &gt;  I also believe that the recording interface should be
</I>&gt;<i> removed from
</I>&gt;<i> &gt;&gt; &gt; this  part of the specification; there should be no requirement
</I>&gt;<i> &gt;&gt; &gt; that all  streams be recordable.
</I>&gt;<i> &gt; Recording of streams is needed for some use cases unrelated
</I>&gt;<i> to video
</I>&gt;<i> &gt; conferencing, such as recording messages.
</I>&gt;<i> Having a recording function is needed in multiple use cases;
</I>&gt;<i> I think we all agree on that.
</I>&gt;<i> This is mostly a matter of style, which I'm happy to defer on.
</I>&gt;<i> &gt;&gt; &gt;  The streams should be regarded as a control surface,
</I>&gt;<i> not as a data
</I>&gt;<i> &gt;&gt; &gt; channel; in  many cases, the question of &quot;what is the
</I>&gt;<i> format of the stream at this point&quot;
</I>&gt;<i> &gt;&gt; &gt;  is literally unanswerable; it may be represented as hardware
</I>&gt;<i> &gt;&gt; &gt; states, memory  buffers, byte streams, or something
</I>&gt;<i> completely different.
</I>&gt;<i> &gt; Agreed.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; &gt;  Recording any of these requires much more specification
</I>&gt;<i> than just
</I>&gt;<i> &gt;&gt; &gt; &quot;record here&quot;.
</I>&gt;<i> &gt; Could you elaborate on what else needs specifying?
</I>&gt;<i> One thing I remember from an API design talk I viewed:
</I>&gt;<i> &quot;An ability to record to a file means that the file format is
</I>&gt;<i> part of your API.&quot;
</I>&gt;<i>
</I>&gt;<i> For instance, for audio recording, it's likely that you want
</I>&gt;<i> control over whether the resulting file is in Ogg Vorbis
</I>&gt;<i> format or in MP3 format; for video, it's likely that you may
</I>&gt;<i> want to specify that it will be stored using the VP8 video
</I>&gt;<i> codec, the Vorbis audio codec and the Matroska container
</I>&gt;<i> format. These desires have to be communicated to the
</I>&gt;<i> underlying audio/video engine,  so that the proper transforms
</I>&gt;<i> can be inserted into the processing stream, and I think they
</I>&gt;<i> have to be communicated across this interface; since the
</I>&gt;<i> output of these operations is a blob without any inherent
</I>&gt;<i> type information, the caller has to already know which format
</I>&gt;<i> the media is in.
</I>This is absolutely correct, and it is not only about codecs or
container formats. Maybe you need to supply info like audio
sampling rate, video frame rate, video resolution, ...
There was an input on this already last November:
<A HREF="http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2010-November/029069.html">http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2010-November/029069.html</A>
&gt;<i>
</I>&gt;<i> Clearer?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Tue, 29 Mar 2011 15:27:58 +0200
</I>&gt;<i> From: &quot;Wilhelm Joys Andersen&quot; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">wilhelmja at opera.com</A>&gt;
</I>&gt;<i> To: <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at lists.whatwg.org</A>
</I>&gt;<i> Subject: [whatwg] &lt;details&gt;, &lt;summary&gt; and styling
</I>&gt;<i> Message-ID: &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">op.vs3w0wvrm3w6te at kunnskapet.oslo.osa</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8; format=flowed; delsp=yes
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm currently writing tests in preparation for Opera's implementation
</I>&gt;<i> of &lt;details&gt; and &lt;summary&gt;. In relation to this, I have a few
</I>&gt;<i> questions
</I>&gt;<i> about issues that, as far as I can tell, are currently
</I>&gt;<i> undefined in the
</I>&gt;<i> specification.
</I>&gt;<i>
</I>&gt;<i> The spec says:
</I>&gt;<i>
</I>&gt;<i>    &quot;If there is no child summary element [of the details element], the
</I>&gt;<i>    user agent should provide its own legend (e.g. &quot;Details&quot;).&quot; [1]
</I>&gt;<i>
</I>&gt;<i> How exactly should this legend be provided? Should the user agent add
</I>&gt;<i> an implied &lt;summary&gt; element to the DOM, similar to &lt;tbody&gt;, a
</I>&gt;<i> pseudo-element, or a magic non-element behaving differently from both
</I>&gt;<i> of the above? In the current WebKit implementation[2], the UA-provided
</I>&gt;<i> legend behaves inconsistently from from an author-provided &lt;summary&gt;
</I>&gt;<i> in the following ways:
</I>&gt;<i>
</I>&gt;<i>   * Although it can be styled with rules applying to
</I>&gt;<i> &lt;summary&gt;, it does
</I>&gt;<i>     not respond to :hover or :first-child.
</I>&gt;<i>
</I>&gt;<i>   * With regards to text selection, it behaves more like an &lt;input
</I>&gt;<i>     type='submit'&gt; than a user-provided &lt;summary&gt;. Text within this
</I>&gt;<i>     implied element may only be selected _together_ with the text
</I>&gt;<i>     preceding and following it.
</I>&gt;<i>
</I>&gt;<i>   * A different mouse cursor is used.
</I>&gt;<i>
</I>&gt;<i> This indicates that it is slightly more magic than I would prefer. I
</I>&gt;<i> believe a closer resemblance to an ordinary element would be more
</I>&gt;<i> convenient for authors - a ::summary pseudo element with &quot;Details&quot; as
</I>&gt;<i> its content() might be the cleanest approach, although that would
</I>&gt;<i> require a few more bytes in the author's stylesheet to cater to both
</I>&gt;<i> author- and UA-defined summaries:
</I>&gt;<i>
</I>&gt;<i>    summary, ::summary {
</I>&gt;<i>      color: green;
</I>&gt;<i>    }
</I>&gt;<i>
</I>&gt;<i> Furthermore, the rendering spec says:
</I>&gt;<i>
</I>&gt;<i>    &quot;The first container is expected to contain at least one line box,
</I>&gt;<i>    and that line box is expected to contain a disclosure
</I>&gt;<i> widget (typically
</I>&gt;<i>    a triangle), horizontally positioned within the left padding of the
</I>&gt;<i>    details element.&quot; [3]
</I>&gt;<i>
</I>&gt;<i> For user agents aiming to support the suggested default rendering, how
</I>&gt;<i> should the disclosure widget be embedded? Ideally, graphical browsers
</I>&gt;<i> should all do this in a similar manner, and in a way that
</I>&gt;<i> allows authors
</I>&gt;<i> to style these elements to the same extent as any other element.
</I>&gt;<i>
</I>&gt;<i> There are several options:
</I>&gt;<i>
</I>&gt;<i>   * A ::marker pseudo element[4].
</I>&gt;<i>   * A default, non-repeating background image positioned within
</I>&gt;<i>     the recommended 40 pixel left padding.
</I>&gt;<i>   * A method similar to list-style-type or list-style-image.
</I>&gt;<i>   * A magically embedded, unstylable widget.
</I>&gt;<i>
</I>&gt;<i> I prefer the first, if possible. The default rendering could
</I>&gt;<i> be something
</I>&gt;<i> like:
</I>&gt;<i>
</I>&gt;<i>    details summary::marker {
</I>&gt;<i>       content: &quot;?&quot;;
</I>&gt;<i>       color: black;
</I>&gt;<i>    }
</I>&gt;<i>
</I>&gt;<i>    details[open] summary::marker {
</I>&gt;<i>       content: &quot;?&quot;;
</I>&gt;<i>    }
</I>&gt;<i>
</I>&gt;<i> RTL might add some additional complexity here, however.
</I>&gt;<i>
</I>&gt;<i> The spec also says:
</I>&gt;<i>
</I>&gt;<i>    &quot;The user agent should allow the user to request that the details
</I>&gt;<i>    be shown or hidden.&quot;[5]
</I>&gt;<i>
</I>&gt;<i> Given, still, a user agent aiming to support the suggested default
</I>&gt;<i> rendering, with a pointing device (mouse, touch) available,
</I>&gt;<i> which parts
</I>&gt;<i> of the &lt;details&gt; or &lt;summary&gt; element should be clickable?
</I>&gt;<i>
</I>&gt;<i> The spec only says:
</I>&gt;<i>
</I>&gt;<i>    &quot;[The disclosure] widget is expected to allow the user to
</I>&gt;<i> request that
</I>&gt;<i>    the details be shown or hidden.
</I>&gt;<i>
</I>&gt;<i> That's a rather small clickable area, which might get
</I>&gt;<i> troublesome to hit
</I>&gt;<i> on a fuzzy touchscreen or for someone with limited motor
</I>&gt;<i> skills. I suggest
</I>&gt;<i> the whole block area of &lt;summary&gt;, too, is made clickable -
</I>&gt;<i> as if it was
</I>&gt;<i> a &lt;label&gt; for the ::marker.
</I>&gt;<i>
</I>&gt;<i> The behaviour for a JavaScript click() on the &lt;details&gt; and &lt;summary&gt;
</I>&gt;<i> elements should also be defined.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Whether or not the answers to the questions above should be
</I>&gt;<i> part of the
</I>&gt;<i> spec or not, I do not know. But browser vendors should try to come to
</I>&gt;<i> some sort of a consensus here, to limit the pain of
</I>&gt;<i> style-minded authors.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [1] :
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/in">http://www.whatwg.org/specs/web-apps/current-work/multipage/in</A>
</I>&gt;<i> teractive-elements.html#the-details-element
</I>&gt;<i> [2] : Tested in Google Chrome 12.0.712.0
</I>&gt;<i> [3] :
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/re">http://www.whatwg.org/specs/web-apps/current-work/multipage/re</A>
</I>&gt;<i> ndering.html#the-details-element-0
</I>&gt;<i> [4] : <A HREF="http://www.w3.org/TR/css3-lists/#markers">http://www.w3.org/TR/css3-lists/#markers</A>
</I>&gt;<i> [5] :
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/in">http://www.whatwg.org/specs/web-apps/current-work/multipage/in</A>
</I>&gt;<i> teractive-elements.html#the-details-element
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Wilhelm Joys Andersen
</I>&gt;<i> Core, Opera Software
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Tue, 29 Mar 2011 15:35:29 +0200
</I>&gt;<i> From: Stefan H?kansson LK &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">stefan.lk.hakansson at ericsson.com</A>&gt;
</I>&gt;<i> To: Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt;, whatwg &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A>&gt;
</I>&gt;<i> Subject: [whatwg] Media negotiation (RE:  Peer-to-peer communication,
</I>&gt;<i>       video conferencing, and related topics (2))
</I>&gt;<i> Message-ID:
</I>&gt;<i>
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">BBF498F2D030E84AB1179E24D1AC41D612066B0DC7 at ESESSCMS0362.eemea</A>
</I>&gt;<i> .ericsson.se&gt;
</I>&gt;<i>
</I>&gt;<i> Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; &gt; &gt; !The web application must be able to    !If the video
</I>&gt;<i> &gt; is going to be displayed !
</I>&gt;<i> &gt; &gt; &gt; &gt; !define the media format to be used for !in a large
</I>&gt;<i> &gt; window, use higher bit-    !
</I>&gt;<i> &gt; &gt; &gt; &gt; !the streams sent to a peer.
</I>&gt;<i> &gt; !rate/resolution. Should media settings!
</I>&gt;<i> &gt; &gt; &gt; &gt; !                                       !be allowed to
</I>&gt;<i> &gt; be changed during a     !
</I>&gt;<i> &gt; &gt; &gt; &gt; !                                       !session (at
</I>&gt;<i> &gt; e.g. window resize)?      !
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Shouldn't this be automatic and renegotiated
</I>&gt;<i> dynamically via SDP
</I>&gt;<i> &gt; &gt; &gt; offer/answer?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Yes, this should be (re)negotiated via SDP, but what is
</I>&gt;<i> &gt; unclear is how
</I>&gt;<i> &gt; &gt; the SDP is populated based on the application's preferences.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Why would the Web application have any say on this? Surely
</I>&gt;<i> &gt; the user agent
</I>&gt;<i> &gt; is in a better position to know what to negotiate, since it
</I>&gt;<i> &gt; will be doing
</I>&gt;<i> &gt; the encoding and decoding itself.
</I>&gt;<i> The best format of the coded media being streamed from UA a
</I>&gt;<i> to UA b depends on a lot of factors. An obvious one is that
</I>&gt;<i> the codec used is supported by both UAs.... As you say much
</I>&gt;<i> of it can be handled without any involvement from the application.
</I>&gt;<i>
</I>&gt;<i> But let's say that the app in UA a does &quot;addStream&quot;. The
</I>&gt;<i> application in UA b (the same application as in UA a) has two
</I>&gt;<i> &lt;video&gt; elements, one using a large display size, one using a
</I>&gt;<i> small size. The UAs don't know in which element the stream
</I>&gt;<i> will be rendered at this stage (that will be known first when
</I>&gt;<i> the app in UA b connects the stream to one of the elements at
</I>&gt;<i> &quot;onaddstream&quot;), so I don't understand how the UAs can select
</I>&gt;<i> a suitable video resolution without the application giving
</I>&gt;<i> some input. (Once the stream is being rendered in an element
</I>&gt;<i> the situation is different - then UA b has knowledge about
</I>&gt;<i> the rendering and could somehow inform UA a.)
</I>&gt;<i>
</I>&gt;<i> Stefan
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 4
</I>&gt;<i> Date: Tue, 29 Mar 2011 15:54:32 +0200
</I>&gt;<i> From: James Graham &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jgraham at opera.com</A>&gt;
</I>&gt;<i> To: <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at lists.whatwg.org</A>
</I>&gt;<i> Subject: Re: [whatwg] &lt;details&gt;, &lt;summary&gt; and styling
</I>&gt;<i> Message-ID: &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">4D91E498.70002 at opera.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=UTF-8; format=flowed
</I>&gt;<i>
</I>&gt;<i> On 03/29/2011 03:27 PM, Wilhelm Joys Andersen wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm currently writing tests in preparation for Opera's
</I>&gt;<i> implementation
</I>&gt;<i> &gt; of &lt;details&gt; and &lt;summary&gt;. In relation to this, I have a
</I>&gt;<i> few questions
</I>&gt;<i> &gt; about issues that, as far as I can tell, are currently
</I>&gt;<i> undefined in the
</I>&gt;<i> &gt; specification.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The spec says:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &quot;If there is no child summary element [of the details element], the
</I>&gt;<i> &gt; user agent should provide its own legend (e.g. &quot;Details&quot;).&quot; [1]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; How exactly should this legend be provided? Should the user
</I>&gt;<i> agent add
</I>&gt;<i> &gt; an implied &lt;summary&gt; element to the DOM, similar to &lt;tbody&gt;, a
</I>&gt;<i> &gt; pseudo-element, or a magic non-element behaving differently
</I>&gt;<i> from both
</I>&gt;<i> &gt; of the above?
</I>&gt;<i>
</I>&gt;<i> FWIW I think that, from a spec point of view, it should just
</I>&gt;<i> act as if
</I>&gt;<i> the first block box container in the shadow tree contained some
</I>&gt;<i> UA-provided text i.e. no magic parser behavior.
</I>&gt;<i>
</I>&gt;<i> &gt; This indicates that it is slightly more magic than I would prefer. I
</I>&gt;<i> &gt; believe a closer resemblance to an ordinary element would be more
</I>&gt;<i> &gt; convenient for authors - a ::summary pseudo element with
</I>&gt;<i> &quot;Details&quot; as
</I>&gt;<i> &gt; its content() might be the cleanest approach, although that would
</I>&gt;<i> &gt; require a few more bytes in the author's stylesheet to cater to both
</I>&gt;<i> &gt; author- and UA-defined summaries:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; summary, ::summary {
</I>&gt;<i> &gt; color: green;
</I>&gt;<i> &gt; }
</I>&gt;<i>
</I>&gt;<i> ::summary could be defined to just match the first block box
</I>&gt;<i> element in
</I>&gt;<i> the &lt;details&gt; shadow tree. That way you could just write
</I>&gt;<i>
</I>&gt;<i> ::summary {color:green}
</I>&gt;<i>
</I>&gt;<i> for both cases. I note that optimising for the non-conforming
</I>&gt;<i> case seems
</I>&gt;<i> a bit unnecessary, however.
</I>&gt;<i>
</I>&gt;<i> &gt; That's a rather small clickable area, which might get
</I>&gt;<i> troublesome to hit
</I>&gt;<i> &gt; on a fuzzy touchscreen or for someone with limited motor
</I>&gt;<i> skills. I suggest
</I>&gt;<i> &gt; the whole block area of &lt;summary&gt;, too, is made clickable -
</I>&gt;<i> as if it was
</I>&gt;<i> &gt; a &lt;label&gt; for the ::marker.
</I>&gt;<i>
</I>&gt;<i> Making the whole ::summary clickable would seem consistent
</I>&gt;<i> with the rest
</I>&gt;<i> of the platform where labels are typically clickable.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 5
</I>&gt;<i> Date: Tue, 29 Mar 2011 10:34:24 -0700
</I>&gt;<i> From: Adam Barth &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">w3c at adambarth.com</A>&gt;
</I>&gt;<i> To: whatwg &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at lists.whatwg.org</A>&gt;
</I>&gt;<i> Subject: [whatwg] WebSockets and redirects
</I>&gt;<i> Message-ID: &lt;BANLkTinNbj5kb-vA0B7NRos8Yaq0dpb=<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">og at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=ISO-8859-1
</I>&gt;<i>
</I>&gt;<i> In this HyBi thread:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.ietf.org/mail-archive/web/hybi/current/msg06951.html">http://www.ietf.org/mail-archive/web/hybi/current/msg06951.html</A>
</I>&gt;<i>
</I>&gt;<i> Folks are arguing that the WebSocket protocol should support HTTP
</I>&gt;<i> redirects during the handshake and that dealing with the security
</I>&gt;<i> consequences of redirects should be dealt with at the API layer.
</I>&gt;<i> If/when that occurs, we should update the API layer to deal with the
</I>&gt;<i> security consequences of the WebSocket protocol following HTTP
</I>&gt;<i> redirects, preferably by aborting any WebSocket connections that the
</I>&gt;<i> server attempts to redirect.
</I>&gt;<i>
</I>&gt;<i> Adam
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 6
</I>&gt;<i> Date: Tue, 29 Mar 2011 17:50:52 +0000 (UTC)
</I>&gt;<i> From: Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt;
</I>&gt;<i> To: Matthew Kaufman &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">matthew at matthew.at</A>&gt;
</I>&gt;<i> Cc: whatwg &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A>&gt;
</I>&gt;<i> Subject: Re: [whatwg] Peer-to-peer communication, video conferencing,
</I>&gt;<i>       and related topics (2)
</I>&gt;<i> Message-ID:
</I>&gt;<i>       &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Pine.LNX.4.64.1103291739590.25791 at ps20323.dreamhostps.com</A>&gt;
</I>&gt;<i> Content-Type: TEXT/PLAIN; charset=US-ASCII
</I>&gt;<i>
</I>&gt;<i> On Tue, 29 Mar 2011, Matthew Kaufman wrote:
</I>&gt;<i> &gt; On Mar 29, 2011, at 3:00 AM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; On Thu, 24 Mar 2011, Matthew Kaufman wrote:
</I>&gt;<i> &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt;&gt; That goal is incompatible with legacy interoperability.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; There is no legacy when it comes to UDP data media
</I>&gt;<i> streams. This is a
</I>&gt;<i> &gt; &gt; new protocol, no existing servers implement it.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Disagree. IF we specify that the media is sent using
</I>&gt;<i> RTP/SRTP (noting
</I>&gt;<i> &gt; the requirement for a handshake to ensure a willing recipient) then
</I>&gt;<i> &gt; quite a few existing endpoints (SIP phones on desks, PSTN
</I>&gt;<i> gateways) can
</I>&gt;<i> &gt; talk directly to/from browsers. This is a significant advantage.
</I>&gt;<i>
</I>&gt;<i> Sure. The spec currently doesn't say what happens with the
</I>&gt;<i> audio/video
</I>&gt;<i> media at all; if browsers implement the same media transports
</I>&gt;<i> as existing
</I>&gt;<i> legacy devices then we get interop essentially for free (assuming a
</I>&gt;<i> gateway for the signaling channel).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; If instead the media is wrapped in (for instance) a masking
</I>&gt;<i> layer, this
</I>&gt;<i> &gt; chance for direct peer-to-peer interoperability is lost.
</I>&gt;<i>
</I>&gt;<i> The masking layer isn't used for the audio/video data. It's
</I>&gt;<i> just for the
</I>&gt;<i> game data, which is a new protocol.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; &gt;&gt; In particular, there are significant security advantages to
</I>&gt;<i> &gt; &gt;&gt; end-to-end keying rather than transmitting keys over the
</I>&gt;<i> signaling
</I>&gt;<i> &gt; &gt;&gt; channel.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Could you elaborate on these?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; End-to-end keying (see my earlier refs to the DTLS-SRTP
</I>&gt;<i> RFCs) gives you
</I>&gt;<i> &gt; significantly greater privacy for the media (because the
</I>&gt;<i> web service
</I>&gt;<i> &gt; doesn't know the negotiated key), including the possibility
</I>&gt;<i> for perfect
</I>&gt;<i> &gt; forward secrecy for these channels.
</I>&gt;<i>
</I>&gt;<i> For audio/video media, sure (though note that the Web page
</I>&gt;<i> has access to
</I>&gt;<i> record the data on either end, so the privacy is limited to
</I>&gt;<i> whether the
</I>&gt;<i> UA allows the user to control whether recording works or
</I>&gt;<i> not). But for the
</I>&gt;<i> data UDP media channel there is no privacy gain here, since
</I>&gt;<i> all the data
</I>&gt;<i> is generated by the Web service in the first place.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; DTLS also builds in existing, vetted security mechanisms instead of
</I>&gt;<i> &gt; rolling something new from scratch.
</I>&gt;<i>
</I>&gt;<i> We have to balance the benefit of having something really
</I>&gt;<i> simple against
</I>&gt;<i> the benefits of having something already vetted. Also, it is
</I>&gt;<i> dangerous to
</I>&gt;<i> assume that something already vetted is automatically fine in a Web
</I>&gt;<i> browser environment. For example, most existing protocols are
</I>&gt;<i> vetted on
</I>&gt;<i> the assumption that the local client is trusted, sicne if the
</I>&gt;<i> local client
</I>&gt;<i> wasn't trusted it could send out any arbitrary packets it
</I>&gt;<i> wanted over the
</I>&gt;<i> network. This assumption doesn't hold in a Web browser
</I>&gt;<i> environment, where
</I>&gt;<i> the local client is split into two parts, one of which is trusted and
</I>&gt;<i> implements the protocol, but the other of which can be
</I>&gt;<i> actively hostile
</I>&gt;<i> and provides all the inputs to the protocol.
</I>&gt;<i>
</I>&gt;<i> With the data UDP media stream protocol, the security aspects are
</I>&gt;<i> reasonably easy to reason about, so it should be straight-forward to
</I>&gt;<i> evaluate even though it is a new formulation. Also, it reuses
</I>&gt;<i> existing
</I>&gt;<i> well-understood techniques in a straight-forward way, which
</I>&gt;<i> also helps.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I have previously shown why an optional API for forcing
</I>&gt;<i> keys would be
</I>&gt;<i> &gt; advantageous. (legacy interop with SDES-keyed SRTP, and
</I>&gt;<i> some multi-party
</I>&gt;<i> &gt; cases)
</I>&gt;<i>
</I>&gt;<i> I apparently missed that; if you could point me to your
</I>&gt;<i> earlier mail or
</I>&gt;<i> reiterate the salient points for this that would be great.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ian Hickson               U+1047E
</I>&gt;<i> )\._.,--....,'``.    fL
</I>&gt;<i> <A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \
</I>&gt;<i> _\  ;`._ ,.
</I>&gt;<i> Things that are impossible just take longer.
</I>&gt;<i> `._.-(,_..'--(,_..'`-.;.'
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 7
</I>&gt;<i> Date: Tue, 29 Mar 2011 14:19:34 -0400
</I>&gt;<i> From: Aryeh Gregor &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Simetrical+w3c at gmail.com</A>&gt;
</I>&gt;<i> To: Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt;
</I>&gt;<i> Cc: <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at lists.whatwg.org</A>
</I>&gt;<i> Subject: Re: [whatwg] DOM Range: redefining behavior under DOM
</I>&gt;<i>       mutation
</I>&gt;<i> Message-ID:
</I>&gt;<i>       &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">AANLkTik83MrFZNn+1fZC7FkrtCr7GdJ_W7OoBuhUzZ5R at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=UTF-8
</I>&gt;<i>
</I>&gt;<i> On Mon, Mar 28, 2011 at 8:05 PM, Boris Zbarsky
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:
</I>&gt;<i> &gt; One problem here is that there is not a concept of &quot;moved&quot;
</I>&gt;<i> in the DOM.
</I>&gt;<i> &gt; There's just removed and inserted. ?Trying to insert
</I>&gt;<i> something that already
</I>&gt;<i> &gt; has a parent will remove it and then do the insert. ?Thanks
</I>&gt;<i> to the wonders
</I>&gt;<i> &gt; of mutation events and userdata, script can execute in
</I>&gt;<i> state when the node
</I>&gt;<i> &gt; being moved is not in the DOM, which means that ranges need
</I>&gt;<i> to update
</I>&gt;<i> &gt; separately for the removal and insertion because the state
</I>&gt;<i> of the range in
</I>&gt;<i> &gt; the intermediate state with the node outside the DOM needs to be
</I>&gt;<i> &gt; well-defined.
</I>&gt;<i>
</I>&gt;<i> Hmm, I see.  I was assuming that insertBefore() would just atomically
</I>&gt;<i> change the parent from the new one to the old one.  Looking more
</I>&gt;<i> closely at DOM Core, I see it's specced the way you describe it
</I>&gt;<i> (although nothing says when the mutation events fire).  That's
</I>&gt;<i> certainly a problem for my plan.  It would be possible to work around
</I>&gt;<i> it by requiring that insertBefore() and similar methods do special
</I>&gt;<i> magic for Ranges independent of the actual DOM mutations done,
</I>&gt;<i> however.  That already has to happen for
</I>&gt;<i> insertData()/deleteData()/appendData(), right?  All browsers treat
</I>&gt;<i> those differently from just setting the data to the equivalent string.
</I>&gt;<i>
</I>&gt;<i> &gt; Now if we dropped support for mutation events and userdata handlers
</I>&gt;<i> &gt; first.....
</I>&gt;<i>
</I>&gt;<i> Is that feasible?  I get the impression implementers would all love
</I>&gt;<i> it, but somehow they haven't done it yet.
</I>&gt;<i>
</I>&gt;<i> &gt; Gecko's implementation of A.insertBefore(B, C), in
</I>&gt;<i> pseudocode and ignoring
</I>&gt;<i> &gt; all the sanity-checking and for cases when B is not a
</I>&gt;<i> document fragment is:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ?if (B.ownerDocument != A.ownerDocument) {
</I>&gt;<i> &gt; ? ?A.ownerDocument.adoptNode(B); ?// This can run arbitrary script
</I>&gt;<i> &gt; ?}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ?if (B.parentNode) {
</I>&gt;<i> &gt; ? ?B.parentNode.removeChild(B); ? // This can run arbitrary script
</I>&gt;<i> &gt; ?}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ?// Mutate the child storage of A to put B in the child list; notify
</I>&gt;<i> &gt; ?// observers
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Both the removeChild call and the mutation of A's child
</I>&gt;<i> list notify mutation
</I>&gt;<i> &gt; observers. ?Ranges are mutation observers, and use the
</I>&gt;<i> notifications to
</I>&gt;<i> &gt; update themselves. ?So from the point of view of a range,
</I>&gt;<i> the removal and
</I>&gt;<i> &gt; insertion are two distinct events.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -Boris
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; P.S. ?I suspect that actual interoperability for the edge
</I>&gt;<i> cases of this
</I>&gt;<i> &gt; stuff is poor: nothing defines whether the adopt happens before the
</I>&gt;<i> &gt; removeChild above, nothing defines what happens if user
</I>&gt;<i> data handlers or
</I>&gt;<i> &gt; mutation events mutate the DOM, etc.
</I>&gt;<i>
</I>&gt;<i> DOM Core says it's supposed to be basically
</I>&gt;<i>
</I>&gt;<i>     if (B.ownerDocument != A.ownerDocument) {
</I>&gt;<i>         A.ownerDocument.adoptNode(B);
</I>&gt;<i>     }
</I>&gt;<i>
</I>&gt;<i>     // Insert into the children
</I>&gt;<i> &lt;<A HREF="http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html#dom-">http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html#dom-</A>
</I>&gt;<i> node-insertbefore&gt;
</I>&gt;<i>
</I>&gt;<i> where adoptNode() removes the node from its parent before changing the
</I>&gt;<i> ownerDocument.  This seems to be how both IE, Gecko and Opera actually
</I>&gt;<i> behave -- moving a node from one document to another has the
</I>&gt;<i> ownerDocument equal to the old document on DOMNodeRemoved, and the new
</I>&gt;<i> document on DOMNodeInserted.  (WebKit throws if you do insertBefore()
</I>&gt;<i> cross-document, and I can't get it to fire any DOM mutation events
</I>&gt;<i> even if it's same-document.)  When I thoughtlessly mutated the DOM
</I>&gt;<i> from the event handler, though, I definitely hit a lack of interop.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Anyway, then what does Gecko do for execCommand()?  Does that just
</I>&gt;<i> have special-case logic to adjust the selection to fit the new DOM?
</I>&gt;<i> It would be nice if we could eliminate that in a clean way, from both
</I>&gt;<i> the specs and implementations.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> whatwg mailing list
</I>&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at lists.whatwg.org</A>
</I>&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> End of whatwg Digest, Vol 84, Issue 69
</I>&gt;<i> **************************************
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="073339.html">[whatwg] Recording interface (Re:  Peer-to-peer communication, video conferencing, and related topics (2))
</A></li>
	<LI>Next message: <A HREF="073341.html">[whatwg] Media negotiation (RE:  Peer-to-peer communication, video conferencing, and related topics (2))
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73356">[ date ]</a>
              <a href="thread.html#73356">[ thread ]</a>
              <a href="subject.html#73356">[ subject ]</a>
              <a href="author.html#73356">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
