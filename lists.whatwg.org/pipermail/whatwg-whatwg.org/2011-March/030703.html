<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] set input.value when input element has composition	string
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20set%20input.value%20when%20input%20element%20has%20composition%0A%09string&In-Reply-To=%3C4D6CABF1.1020709%40ga2.so-net.ne.jp%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="073026.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] set input.value when input element has composition	string</H1>
<!--htdig_noindex-->
    <B>Makoto Kato</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20set%20input.value%20when%20input%20element%20has%20composition%0A%09string&In-Reply-To=%3C4D6CABF1.1020709%40ga2.so-net.ne.jp%3E"
       TITLE="[whatwg] set input.value when input element has composition	string">m_kato at ga2.so-net.ne.jp
       </A><BR>
    <I>Tue Mar  1 00:18:57 PST 2011</I>
    <P><UL>
        
        <LI>Next message: <A HREF="073026.html">[whatwg] set input.value when input element has composition	string
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30703">[ date ]</a>
              <a href="thread.html#30703">[ thread ]</a>
              <a href="subject.html#30703">[ subject ]</a>
              <a href="author.html#30703">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi, Kang-Hao.

On 2011/02/28 21:31, Kang-Hao (Kenny) Lu wrote:
&gt;<i> Hello Makoto,
</I>&gt;<i> (Cc+ public-webapps)
</I>&gt;<i>
</I>&gt;<i> (11/02/25 15:16), Makoto Kato wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is simple sample.  This behavior is different on all web browsers
</I>&gt;&gt;<i> when input element has composition/preedit string for IME.
</I>&gt;<i> A relevant question here, I think, is where the cursor should go when
</I>&gt;<i> the value of the text box is set by script. For Safari5, it always goes
</I>&gt;<i> to the end when the value is set. For FF4.0b11, the cursor stays in
</I>&gt;<i> previous position when the value to be set is the same and goes to the
</I>&gt;<i> end when the value is different. Is this a known incompatibility? I find
</I>&gt;<i> the behavior of FF quite strange.
</I>
On Safari 5, even if textbox has IME composition string, text into 
textbox can be replaced by DOM/script.  But other browser's behaviors 
are different, and this is no specification when textbox has composition 
string.  Although IE, Chrome and Opera keep composition string after 
value is replaced by DOM, each behavior is different.

This is the result for this test on each browsers.  When textbox has IME 
composition string such as ABCDEFG, then script (textbox.value = &quot;123&quot;;) 
is called, textbox becomes...

1. &quot;123ABCDEFG&quot; (ABCDEFG keeps composition state and caret is after G).
2. &quot;123&quot; (composition string is removed).
3. &quot;ABCDEFG&quot; (ABCDEFG keeps composition state and caret is after G).

Which behavior is right?  1 is Opera 11, 2 is Safari 5, and 3 is Chrome 
10 and IE9.

Also, on Firefox/Gecko, since there is some bugs, key input cannot work 
until IME is turned off.  So to fix this, I am talking with Ehsan about 
right specification.  But there is no discussion about this 
specification/behavior at WHATWG.

&gt;&gt;<i> If input element has composition string by IME, should it cancel
</I>&gt;&gt;<i> composition string and set value by script?  Or should it cancel
</I>&gt;&gt;<i> setting value since it has composition string?
</I>&gt;<i> What makes sense to me is:
</I>&gt;<i> 1. the cursor always goes to the end
</I>&gt;<i> 2. the composition string goes with the cursor, which should not change.
</I>&gt;<i>
</I>&gt;<i> But I am not sure whether this is the right way to go.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Kenny
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;script&gt;
</I>&gt;&gt;<i> function setvalue() {
</I>&gt;&gt;<i>    document.getElementById('test').value = &quot;replaced&quot;;
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i> &lt;/script&gt;
</I>&gt;&gt;<i> &lt;body onload=&quot;setTimeout('setvalue()',5000)&quot;&gt;
</I>&gt;&gt;<i> &lt;input type=&quot;text&quot; id=&quot;test&quot;/&gt;
</I>&gt;&gt;<i> &lt;/body&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -- Makoto Kato
</I>&gt;&gt;<i>
</I>-- Makoto Kato
</PRE>




<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="073026.html">[whatwg] set input.value when input element has composition	string
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30703">[ date ]</a>
              <a href="thread.html#30703">[ thread ]</a>
              <a href="subject.html#30703">[ subject ]</a>
              <a href="author.html#30703">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
