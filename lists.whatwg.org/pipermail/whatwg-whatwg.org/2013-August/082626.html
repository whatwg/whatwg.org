<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Disabling document.domain setting on iframe at sandbox (especially with allow-same-origin)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Disabling%20document.domain%20setting%20on%20iframe%40sandbox%0A%20%28especially%20with%20allow-same-origin%29&In-Reply-To=%3Calpine.DEB.2.00.1308030221040.27623%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="082624.html">
   <LINK REL="Next"  HREF="082627.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Disabling document.domain setting on iframe at sandbox (especially with allow-same-origin)</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Disabling%20document.domain%20setting%20on%20iframe%40sandbox%0A%20%28especially%20with%20allow-same-origin%29&In-Reply-To=%3Calpine.DEB.2.00.1308030221040.27623%40ps20323.dreamhostps.com%3E"
       TITLE="[whatwg] Disabling document.domain setting on iframe at sandbox (especially with allow-same-origin)">ian at hixie.ch
       </A><BR>
    <I>Fri Aug  2 19:35:42 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="082624.html">[whatwg] Disabling document.domain setting on iframe at sandbox (especially with allow-same-origin)
</A></li>
        <LI>Next message: <A HREF="082627.html">[whatwg] Disabling document.domain setting on iframe at sandbox (especially with allow-same-origin)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82626">[ date ]</a>
              <a href="thread.html#82626">[ thread ]</a>
              <a href="subject.html#82626">[ subject ]</a>
              <a href="author.html#82626">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Fri, 2 Aug 2013, Boris Zbarsky wrote:
&gt;<i> On 8/2/13 6:55 PM, Ian Hickson wrote:
</I>&gt;<i> &gt; How does it solve it? (What _is_ the &quot;mail.google.com vs 
</I>&gt;<i> &gt; calendar.google.com case&quot;?)
</I>&gt;<i> 
</I>&gt;<i> The case is when mail.google.com tries to attack calendar.google.com, 
</I>&gt;<i> and they can't be in different processes as mitigation because you never 
</I>&gt;<i> know when they'll both set domain to &quot;google.com&quot;...
</I>
Ah, ok. It's clearer to describe that as the &quot;victim.example.com vs 
hostile.example.com&quot; case, since the fact that calendar.google.com 
redirects to www.google.com and mail.google.com doesn't is mostly just an 
accident of history at this point.

Yes, the model I described in es-discuss doesn't attempt to mitigate that 
case. It groups similar-origin browsing contexts that share an event loop. 
It has the advantage (over models that do mitigate that specific case) 
that it happens to be compatible with the legacy security model (the one 
implemented, until recently, by all browsers); it has the disadvantage 
that near siblings, origin-wise, only have one level of protection against 
each other, not the full defense-in-depth. Honestly, though, at the point 
where you're able to trick a similar-origin site into changing 
document.domain so you can attack it, it's not clear to me that the extra 
level of defense is worth much. You can already, e.g., do XHR to the other 
origin, at that point, or read or write to its localStorage, or read its 
cookies, or send postMessage() with their origin credentials, or speak to 
their workers. I dunno, it seems like the fact that you can't get to 
objects in other iframes of that origin at that point is mostly moot.

-- 
Ian Hickson               U+1047E                )\._.,--....,'``.    fL
<A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="082624.html">[whatwg] Disabling document.domain setting on iframe at sandbox (especially with allow-same-origin)
</A></li>
	<LI>Next message: <A HREF="082627.html">[whatwg] Disabling document.domain setting on iframe at sandbox (especially with allow-same-origin)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82626">[ date ]</a>
              <a href="thread.html#82626">[ thread ]</a>
              <a href="subject.html#82626">[ subject ]</a>
              <a href="author.html#82626">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
