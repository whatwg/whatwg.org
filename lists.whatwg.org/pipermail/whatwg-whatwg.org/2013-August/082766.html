<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal: ImageData constructor or factory method with preexisting data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20ImageData%20constructor%20or%20factory%20method%20with%0A%20preexisting%20data&In-Reply-To=%3CCAMYvS2dPknmZgKokZCvL-rwWt30jP_UBLdiMrFcWJ6jRJd8ONA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="082756.html">
   <LINK REL="Next"  HREF="040440.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal: ImageData constructor or factory method with preexisting data</H1>
<!--htdig_noindex-->
    <B>Kenneth Russell</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20ImageData%20constructor%20or%20factory%20method%20with%0A%20preexisting%20data&In-Reply-To=%3CCAMYvS2dPknmZgKokZCvL-rwWt30jP_UBLdiMrFcWJ6jRJd8ONA%40mail.gmail.com%3E"
       TITLE="[whatwg] Proposal: ImageData constructor or factory method with preexisting data">kbr at google.com
       </A><BR>
    <I>Tue Aug 13 14:25:45 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="082756.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
        <LI>Next message: <A HREF="040440.html">[whatwg] Blurry lines in 2D Canvas (and SVG)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82766">[ date ]</a>
              <a href="thread.html#82766">[ thread ]</a>
              <a href="subject.html#82766">[ subject ]</a>
              <a href="author.html#82766">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, Aug 13, 2013 at 11:57 AM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
&gt;<i> On Mon, 12 Aug 2013, Kenneth Russell wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The use case is the passing of ImageData objects back and forth to
</I>&gt;&gt;<i> workers to fill and refill with data.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> An ImageData is essentially a wrapper for the underlying
</I>&gt;&gt;<i> Uint8ClampedArray, providing an associated width and height. However,
</I>&gt;&gt;<i> the only way to draw raw pixels into a Canvas is using an ImageData.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Currently a Unit8ClampedArray can be constructed, but the only way to
</I>&gt;&gt;<i> create an ImageData is to ask a Canvas for one, and there's no way to
</I>&gt;&gt;<i> associate it with a pre-allocated Uint8ClampedArray.
</I>&gt;<i>
</I>&gt;<i> Why can't you just send an ImageData over?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> This means that if you want to pass an ImageData to a worker for
</I>&gt;&gt;<i> filling, transferring the underlying Uint8ClampedArray, you need to be
</I>&gt;&gt;<i> very careful about bookkeeping, and to not lose the reference to the
</I>&gt;&gt;<i> ImageData object.
</I>&gt;<i>
</I>&gt;<i> Sure. Just send the ImageData over. That seems relatively
</I>&gt;<i> straight-forward. What am I missing?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> IMO there ought to be a factory method for ImageData taking a
</I>&gt;&gt;<i> Uint8ClampedArray, width, height, and possibly resolution (or a
</I>&gt;&gt;<i> dictionary?), which validates the width, height and resolution against
</I>&gt;&gt;<i> the size of the Uint8ClampedArray, and makes a new ImageData object.
</I>&gt;&gt;<i> This would ease management of ImageData instances.
</I>&gt;<i>
</I>&gt;<i> We could have a constructor for ImageData objects, sure. That would be
</I>&gt;<i> relatively easy to add, if it's really needed. I don't understand why it's
</I>&gt;<i> hard to keep track of ImageData objects, though. Can you elaborate?
</I>
I have in mind new APIs for typed arrays which allow sharding of typed
arrays to workers and re-assembly of the component pieces when the
work is complete. This would involve multiple manipulations of the
ArrayBuffer and its views. It would be most convenient if the result
could be wrapped in an ImageData if it's destined to be drawn to a
Canvas. Otherwise it's likely that a data copy will need to be
incurred.

-Ken

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="082756.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
	<LI>Next message: <A HREF="040440.html">[whatwg] Blurry lines in 2D Canvas (and SVG)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82766">[ date ]</a>
              <a href="thread.html#82766">[ thread ]</a>
              <a href="subject.html#82766">[ subject ]</a>
              <a href="author.html#82766">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
