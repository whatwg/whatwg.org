<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Script preloading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Script%20preloading&In-Reply-To=%3CCADC%3D%2Bjf7t_t4XzxLQ3zH6MnbqVXuCXrofA__%2B%3DHactftAe_4wg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="082897.html">
   <LINK REL="Next"  HREF="082913.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Script preloading</H1>
<!--htdig_noindex-->
    <B>Brian Kardell</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Script%20preloading&In-Reply-To=%3CCADC%3D%2Bjf7t_t4XzxLQ3zH6MnbqVXuCXrofA__%2B%3DHactftAe_4wg%40mail.gmail.com%3E"
       TITLE="[whatwg] Script preloading">bkardell at gmail.com
       </A><BR>
    <I>Thu Aug 29 05:58:24 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="082897.html">[whatwg] Script preloading
</A></li>
        <LI>Next message: <A HREF="082913.html">[whatwg] Script preloading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82905">[ date ]</a>
              <a href="thread.html#82905">[ thread ]</a>
              <a href="subject.html#82905">[ subject ]</a>
              <a href="author.html#82905">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Aug 29, 2013 1:21 AM, &quot;Jonas Sicking&quot; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Hi Ryosuke,
</I>&gt;<i>
</I>&gt;<i> Based on the feedback here, it doesn't sound like you are a huge fan
</I>&gt;<i> of the original proposal in this thread.
</I>&gt;<i>
</I>&gt;<i> At this point, has any implementation come out in support of the
</I>&gt;<i> proposal in this thread as a preferred solution over
</I>&gt;<i> noexecute/execute()?
</I>&gt;<i>
</I>&gt;<i> The strongest support I've seen in this thread, though I very well
</I>&gt;<i> could have missed some, is &quot;it's better than status quo&quot;.
</I>&gt;<i>
</I>&gt;<i> Is that the case?
</I>&gt;<i>
</I>&gt;<i> / Jonas
</I>&gt;<i>
</I>&gt;<i> On Wed, Aug 28, 2013 at 7:43 PM, Ryosuke Niwa &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">rniwa at apple.com</A>&gt; wrote:
</I>&gt;<i> &gt; On Jul 13, 2013, at 5:55 AM, Andy Davies &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">dajdavies at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; On 12 July 2013 01:25, Bruno Racineux &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bruno at hexanet.net</A>&gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; On browser preloading:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; There seems to an inherent conflict between 'indiscriminate'
</I>Pre-parsers/
&gt;<i> &gt;&gt;&gt; PreloadScanner and &quot;responsive design&quot; for mobile. Responsive designs
</I>&gt;<i> &gt;&gt;&gt; mostly implies that everything needed for a full screen desktop is
</I>&gt;<i> &gt;&gt;&gt; provided in markup to all devices.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; The pre-loader is a tradeoff, it's aiming to increase network
</I>utilisation
&gt;<i> &gt;&gt; by speculatively downloading resources it can discover.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Some of the resources downloaded may be not be used but with good
</I>design
&gt;<i> &gt;&gt; and mobile first approaches hopefully this number can be minimised.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Even if some unused resources get downloaded how much it matter?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It matters a lot when you only have GSM wireless connection, and barely
</I>loading anything at all.
&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; By starting the downloads earlier, connections will be opened sooner,
</I>and
&gt;<i> &gt;&gt; the TCP congestion window to grow sooner. Of course this has to be
</I>balanced
&gt;<i> &gt;&gt; against visitors who might be paying to download those unused bytes,
</I>and
&gt;<i> &gt;&gt; whether the unused resources are blocking something on the critical
</I>path
&gt;<i> &gt;&gt; from being downloaded (believe some preloaders can re-prioritise
</I>resources
&gt;<i> &gt;&gt; if they need them before the preloader has downloaded them)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Exactly.  I'd to make sure whatever API we come up gives enough
</I>flexibility for the UAs to decide whether a given resource needs to be
loaded immediatley.
&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Jul 12, 2013, at 11:56 AM, Kyle Simpson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">getify at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; My scope (as it always has been) put simply: I want (for all the
</I>reasons here and before) to have a &quot;silver bullet&quot; in script loading, which
lets me load any number of scripts in parallel, and to the extent that is
reasonable, be fully in control of what order they run in, if at all,
responding to conditions AS THE SCRIPTS EXECUTE, not merely as they might
have existed at the time of initial request. I want such a facility because
I want to continue to have LABjs be a best-in-class fully-capable script
loader that sets the standard for best-practice on-demand script loading.
&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Because of the different network conditions and constraints various
</I>devices have, I'm wary of any solution that gives the full control over
when each script is loaded.  While I'm sure large corporations with lots of
resources will get this right, I don't want to provide a preloading API
that's hard to use for ordinary Web developers.
&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Jul 15, 2013, at 7:55 AM, Kornel Lesi&#324;ski &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">kornel at geekhood.net</A>&gt;
</I>wrote:
&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; There's a very high overlap between module dependencies and &lt;script
</I>dependencies&gt; proposal. I think at very least it would be useful to define
&lt;script dependencies&gt; in terms of ES6 modules, or even abandon markup
solution to avoid duplicating features.
&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; ES6 modules however do not solve the performance problem. In fact they
</I>would benefit from UA having a list of all dependencies up front (otherwise
file's dependencies can only be discovered after that file is loaded, which
costs as many RTTs as the height of the dependency tree).
&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; So I think that eventually ES6 modules + link[rel=subresource] could
</I>be the answer. The &lt;link&gt; would expose URLs to (pre)load for performance,
but modules would handle actual loading/execution for flexibility and
reliability.
&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yes, we should definitely consider how this preloading API works with
</I>ES6 modules.
&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Jul 22, 2013, at 3:22 PM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Having the load event anytime we are done with a network request also
</I>&gt;<i> &gt;&gt; seems beneficial. Rather than having most APIs use &quot;load&quot; whereas this
</I>&gt;<i> &gt;&gt; would use &quot;preload&quot;.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Generally speaking &quot;load&quot; means &quot;loaded and processed&quot;. The
</I>&gt;<i> &gt;&gt; 'noexecute' flag would change what the &quot;and processed&quot; piece includes.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't think it'll be confusing if the script had noexecute.  We can
</I>even call it noautoexecute if we wanted.
&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; But I'm fine either way here. The same question and risk of confusion
</I>&gt;<i> &gt;&gt; seems to exist with the &quot;whenneeded&quot; attribute. In general
</I>&gt;<i> &gt;&gt; &quot;whenneeded&quot; seems very similar to &quot;noexecute&quot;, but with a little bit
</I>&gt;<i> &gt;&gt; more stuff done automatically, for better or worse.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I like the simplicity of noexecute and excute().  However, I'm a little
</I>worried that it doesn't provide any information as to how important a given
script is.  So Web browsers have no choice but to request all scripts
immediately.
&gt;<i> &gt;
</I>&gt;<i> &gt; I'd like to eventually provide APIs that allow authors to codify which
</I>scripts are &quot;vital&quot; so that Web browsers can properly prioritize each
script request.
&gt;<i> &gt;
</I>&gt;<i> &gt; Implementation wise, noexecute/execute() will be extremely easy to
</I>implement in WebKit.
&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; I.e. something like:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &lt;script src=&quot;script1.js&quot; id=&quot;s1&quot;&gt;
</I>&gt;<i> &gt;&gt; &lt;script src=&quot;script2.js&quot; dependencies=&quot;s1&quot;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; would run correctly in downlevel browsers, but would force the scripts
</I>&gt;<i> &gt;&gt; to be blocking.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &lt;script src=&quot;script1.js&quot; id=&quot;s1&quot; async&gt;
</I>&gt;<i> &gt;&gt; &lt;script src=&quot;script2.js&quot; async dependencies=&quot;s1&quot;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; would give you performant non-blocking behavior in downlevel browsers,
</I>&gt;<i> &gt;&gt; but at the expense of the scripts not always running in scripts in the
</I>&gt;<i> &gt;&gt; right order.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Use defer instead?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - R. Niwa
</I>&gt;<i> &gt;
</I>
I didn't get to it until this morning, but several folks on twitter have
made the same general point I would toss in so let's move it here:

&quot;@slicknet: @Hixie @paul_irish this proposal conflates preloading with
dependency management. I would ignore the latter (as I did originally).&quot;

&quot;@paul_irish: @slicknet @Hixie I feel similarly. Adding HTML semantics for
dep mgmt duplicates the work of AMD/CJS and ES6 modules.
#writingemailishard :)&quot;

&quot;@_JamesMGreene: @paul_irish @slicknet @Hixie Agreed, adding script
dependency management in HTML would be complicated, messy, and verbose.&quot;

Me: what they said.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="082897.html">[whatwg] Script preloading
</A></li>
	<LI>Next message: <A HREF="082913.html">[whatwg] Script preloading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#82905">[ date ]</a>
              <a href="thread.html#82905">[ thread ]</a>
              <a href="subject.html#82905">[ subject ]</a>
              <a href="author.html#82905">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
