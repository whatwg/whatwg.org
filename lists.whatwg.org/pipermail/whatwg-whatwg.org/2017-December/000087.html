<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20DOM%20Feature%20Mod%3A%20Add%20metering%20/%20parallelism%20%26%0A%20throttling%20options%20to%20AddEventListenerOptions&In-Reply-To=%3CCA%2BxEH7MH95QBKNTT6biqG8VBw%3DFPTwTtcx%2BRmvQphHwcGbKcwA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000086.html">
   <LINK REL="Next"  HREF="000088.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions</H1>
<!--htdig_noindex-->
    <B>Sylon Zero</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20DOM%20Feature%20Mod%3A%20Add%20metering%20/%20parallelism%20%26%0A%20throttling%20options%20to%20AddEventListenerOptions&In-Reply-To=%3CCA%2BxEH7MH95QBKNTT6biqG8VBw%3DFPTwTtcx%2BRmvQphHwcGbKcwA%40mail.gmail.com%3E"
       TITLE="[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions">sylonzero at gmail.com
       </A><BR>
    <I>Fri Dec  1 12:55:28 PST 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000086.html">[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
</A></li>
        <LI>Next message (by thread): <A HREF="000088.html">[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87">[ date ]</a>
              <a href="thread.html#87">[ thread ]</a>
              <a href="subject.html#87">[ subject ]</a>
              <a href="author.html#87">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>David,

To clarify your message: it sounds like it is primarily feedback to
Jonathan about the fact that a wide range of use cases and awareness of
options exist in the Web community at large, and also that some of the
existing options in the addEventListener parameters are useful even though
one may be able to handle some of those using custom code. Is that a fair
summary of your points?

I wanted to make sure I didn&#8217;t miss out on any feedback you were giving on
the proposal itself.

- Sai.

On Fri, Dec 1, 2017 at 4:36 AM David Bruant &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bruant.d at gmail.com</A>&gt; wrote:

&gt;<i> Le 28/11/2017 &#224; 00:48, Jonathan Zuckerman a &#233;crit :
</I>&gt;<i> &gt; You&#8217;re probably aware there are libraries that offer functionality of
</I>&gt;<i> this
</I>&gt;<i> &gt; sort (debounce and throttle in underscore/lodash is the one I&#8217;m most
</I>&gt;<i> &gt; familiar with) and the web community seems content to add a small
</I>&gt;<i> &gt; dependency when such functionality is required.
</I>&gt;<i> With all due respect, i think it's dangerous to start a sentence by &quot;the
</I>&gt;<i> web community&quot; given how broad and ever-changing this group of human
</I>&gt;<i> beings is.
</I>&gt;<i>
</I>&gt;<i> For one data point, it's been 6 years that i regularly give advanced
</I>&gt;<i> JavaScript trainings to people who are already JS practitionners and
</I>&gt;<i> they don't know about the concept of event queue and barely about basic
</I>&gt;<i> perf advices (reduce round trips to a minimum, minimize the size of
</I>&gt;<i> what's sent, etc.). Debounce/throttling is further down the road.
</I>&gt;<i>
</I>&gt;<i> By the logic of &quot;the web community seems content to add a small
</I>&gt;<i> dependency&quot;, the 'once' option [1], probably shouldn't have seen the
</I>&gt;<i> light given how easy it is to rewrite. Same for 'passive'. Same for
</I>&gt;<i> Element.prototype.remove (&quot;DOM4&quot;). etc.
</I>&gt;<i> I'm glad they exist though.
</I>&gt;<i>
</I>&gt;<i> David
</I>&gt;<i>
</I>&gt;<i> [1]
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener">https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener</A>
</I>&gt;<i>
</I>&gt;<i> &gt; How would you convince
</I>&gt;<i> &gt; browser vendors to implement this?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Mon, Nov 27, 2017 at 18:05 Sylon Zero &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">sylonzero at gmail.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; *Core Problem Statement* Processor functions that subscribe to events
</I>&gt;<i> via a
</I>&gt;<i> &gt;&gt; topic string may need to be prioritized for processing based on the
</I>&gt;<i> topic
</I>&gt;<i> &gt;&gt; itself. Conversely, certain events may be more numerous but should not
</I>&gt;<i> &gt;&gt; limit the ability of the JS environment to respond and process other
</I>&gt;<i> &gt;&gt; events, that may be more critical to either the User Experience (UX) or
</I>&gt;<i> &gt;&gt; integrity of the system (e.g. events that trigger saving data to a
</I>&gt;<i> &gt;&gt; back-end).
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; *Background Information* As Browser/CommonJS environments bring
</I>&gt;<i> paradigms
</I>&gt;<i> &gt;&gt; like UI event handling and back-end event handling into the same problem
</I>&gt;<i> &gt;&gt; space, it is useful to apply common patterns used in Message-based
</I>&gt;<i> &gt;&gt; Publish-Subscribe environments with message brokers, which is what the
</I>&gt;<i> JS
</I>&gt;<i> &gt;&gt; execution context often behaves as. The use case here is to ensure that
</I>&gt;<i> one
</I>&gt;<i> &gt;&gt; kind of event (e.g. event listeners for a &#8216;mouseMove&#8217; event) don&#8217;t
</I>&gt;<i> saturate
</I>&gt;<i> &gt;&gt; or delay execution of other events (e.g. &#8216;dataAvailableForAutosave&#8217;)
</I>&gt;<i> due to
</I>&gt;<i> &gt;&gt; massive differences in event volume or conversely, expensive operations
</I>&gt;<i> &gt;&gt; that block the execution thread in question.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; *Proposed Solution* Add metering options to the addEventListener
</I>&gt;<i> &gt;&gt; *Options* configuration
</I>&gt;<i> &gt;&gt; object. These options control how the JS execution environment controls
</I>&gt;<i> the
</I>&gt;<i> &gt;&gt; throttling/firing of event handler instances in response to events that
</I>&gt;<i> &gt;&gt; match the topic string of the subscription created by addEventListener.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Proposed options:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;     - maxInstances [Number / Function] used to decide how many event
</I>&gt;<i> &gt;&gt;     listeners can be invoked before throttling occurs. Throttling does
</I>&gt;<i> not
</I>&gt;<i> &gt;&gt; lose
</I>&gt;<i> &gt;&gt;     events but simply queues them.
</I>&gt;<i> &gt;&gt;     - throttlingQueueLength [Number] used to maintain an in-memory
</I>&gt;<i> queue of
</I>&gt;<i> &gt;&gt;     un-processed events per Topic string, after throttling kicks in.
</I>&gt;<i> &gt;&gt;     - throttlingQueuePolicy [String] Values could be exception - throws
</I>&gt;<i> an
</I>&gt;<i> &gt;&gt;     exception when the queue length is exceeded, rolling - drops the
</I>&gt;<i> oldest
</I>&gt;<i> &gt;&gt;     events and pushes newer ones into the queue, expand- allow the
</I>&gt;<i> queue to
</I>&gt;<i> &gt;&gt;     expand to cover all events.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; *Additional Options* It might be even more useful if the options allowed
</I>&gt;<i> &gt;&gt; targeting or creation of Web Workers (or Node child processes,
</I>&gt;<i> depending on
</I>&gt;<i> &gt;&gt; the execution context) based on the event handler configuration. This
</I>&gt;<i> could
</I>&gt;<i> &gt;&gt; potentially target CPU cores and/or O/S child processes / threads
</I>&gt;<i> &gt;&gt; (depending on the O/S terminology for parallel execution).
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; *Related Thread* The proposal identified in the link below (by &#352;ime
</I>&gt;<i> &gt;&gt; Vidas) could
</I>&gt;<i> &gt;&gt; be part of this solution as it defines other metering options around
</I>&gt;<i> &gt;&gt; debounce (which improves scale around event handling, which is in the
</I>&gt;<i> same
</I>&gt;<i> &gt;&gt; problem space) and handling throttling through frequency, which should
</I>&gt;<i> be
</I>&gt;<i> &gt;&gt; one of the alternatives in addition to my proposal above (as I believe
</I>&gt;<i> they
</I>&gt;<i> &gt;&gt; are orthogonal): <A HREF="https://discourse.wicg.io/t/add-event-throttlin">https://discourse.wicg.io/t/add-event-throttlin</A>
</I>&gt;<i> &gt;&gt; g-and-debouncing-to-addeventlisteneroptions/2436/19
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Sai Prakash
</I>&gt;<i> &gt;&gt; @SylonZero
</I>&gt;<i> &gt;&gt;
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000086.html">[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
</A></li>
	<LI>Next message (by thread): <A HREF="000088.html">[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#87">[ date ]</a>
              <a href="thread.html#87">[ thread ]</a>
              <a href="subject.html#87">[ subject ]</a>
              <a href="author.html#87">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
