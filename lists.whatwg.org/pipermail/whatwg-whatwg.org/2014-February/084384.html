<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Supporting more address levels in autocomplete
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Supporting%20more%20address%20levels%20in%20autocomplete&In-Reply-To=%3Calpine.DEB.2.00.1403010109000.32463%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="084378.html">
   <LINK REL="Next"  HREF="084385.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Supporting more address levels in autocomplete</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Supporting%20more%20address%20levels%20in%20autocomplete&In-Reply-To=%3Calpine.DEB.2.00.1403010109000.32463%40ps20323.dreamhostps.com%3E"
       TITLE="[whatwg] Supporting more address levels in autocomplete">ian at hixie.ch
       </A><BR>
    <I>Fri Feb 28 17:47:06 PST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="084378.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
        <LI>Next message: <A HREF="084385.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84384">[ date ]</a>
              <a href="thread.html#84384">[ thread ]</a>
              <a href="subject.html#84384">[ subject ]</a>
              <a href="author.html#84384">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, 24 Feb 2014, Jukka K. Korpela wrote:
&gt;<i> 2014-02-22 3:03, Ian Hickson wrote:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; (Note that a lot of people in the UK have no idea how to write their 
</I>&gt;<i> &gt; address according to current standards. For example, people often 
</I>&gt;<i> &gt; include the county, give the &quot;real&quot; town rather than the &quot;post town&quot;, 
</I>&gt;<i> &gt; put things out of order, indent each line of the address, etc.)
</I>&gt;<i> 
</I>&gt;<i> The phenomenon is probably not limited to the UK. Few people even know 
</I>&gt;<i> the current standards (national and international).
</I>
Well sure, but since we're writing a standard, if our assumption is that 
people don't know standards, we're not going to reach a useful conclusion.


&gt;<i> Some fine-grained control for naming different components of an address 
</I>&gt;<i> are undoubtedly useful at times. It would be even more useful to have a 
</I>&gt;<i> common, &quot;standard&quot; name for just an address. That is, whatever someone 
</I>&gt;<i> wants the sender to put in an envelope. Its internal structure does not 
</I>&gt;<i> matter, as long as it works, and as usual, it is up to the recipient to 
</I>&gt;<i> specify the address in a manner that works.
</I>&gt;<i> 
</I>&gt;<i> Forms that require the user to split his address to small pieces may 
</I>&gt;<i> have their reasons. But if you just want to have an address to send 
</I>&gt;<i> stuff to, then all you need is a working postal address. A textarea 
</I>&gt;<i> with, say, name=&quot;postal&quot;, if used on different pages, would then let the 
</I>&gt;<i> user enter his entire address very simply, after just once typing it.
</I>&gt;<i> 
</I>&gt;<i> Probably &quot;postal&quot; should be specified so that it relates to a postal 
</I>&gt;<i> address that is complete for delivery except the recipient name. The 
</I>&gt;<i> reason is that the name is so often asked separately
</I>
On Mon, 24 Feb 2014, Evan Stade wrote:
&gt;<i>
</I>&gt;<i> I agree with this, and plan to propose it separately from the proposal 
</I>&gt;<i> currently under discussion. It might be hard to parse a working address 
</I>&gt;<i> out of a free-form input, but the other direction is doable enough: 
</I>&gt;<i> creating a block of text suitable to printing on an envelope given 
</I>&gt;<i> tokenized values. This tackles the problem of how to format an 
</I>&gt;<i> autocompleted address for a particular country and UI language (i.e. in 
</I>&gt;<i> the user agent has to know how to do it, but the website doesn't).
</I>
We can definitely add something like this. We already have a simpler 
version of this for street addresses.


On Mon, 24 Feb 2014, Charles McCathie Nevile wrote:
&gt;<i> 
</I>&gt;<i> That depends on whether you want to force your customers to think like 
</I>&gt;<i> the Post Office, or whether you prefer to be responsive to your 
</I>&gt;<i> customers. Speaking without data, I suspect that nervousness at not 
</I>&gt;<i> being able to put *what someone thinks* is their address translates 
</I>&gt;<i> fairly readily into a certain amount of failure to proceed with a 
</I>&gt;<i> transaction.
</I>
I'd love to see real data on this. I can imagine scenarios that would lead 
this to go both ways.


On Mon, 24 Feb 2014, Dan Brickley wrote:
&gt;&gt;<i> 
</I>&gt;<i> Who is using the data? Just post offices? Or taxi drivers, pizza 
</I>&gt;<i> delivery bikers, pedestrians?
</I>
The latter three are unlikely to really need much more depth at the 
locality level.


On Mon, 24 Feb 2014, Evan Stade wrote:
&gt;<i>
</I>&gt;<i> Regarding UK addresses, libaddressinput[1], which is used by Google for 
</I>&gt;<i> various products, currently accepts two levels of administrative region 
</I>&gt;<i> for GB: city and optional county.
</I>
You need two levels, but those aren't it. :-) Counties haven't officially 
been used in UK addresses since the mid 90s.


&gt;<i> &gt; This would be the first open-ended field name. Do we really want to 
</I>&gt;<i> &gt; make this open-ended? What happens if a form has n=1..3, and another 
</I>&gt;<i> &gt; has n=2..4? What if one has n=1, n=2, and n=4, but not n=3?
</I>&gt;<i> 
</I>&gt;<i> I don't know why a web author would do this
</I>
Web authors do all kinds of crazy stuff. We have to be ready for it such 
that we never end up forced to introduce weird heuristics.


&gt;<i> but n=m doesn't require n=m-1 or n=m+1 to be present. n=2..4 would just 
</I>&gt;<i> mean the site didn't get the n=1 value.
</I>
My concern is that authors do something like this:

   &lt;input ... autocomplete=&quot;address-line-1&quot;&gt;
   &lt;input ... autocomplete=&quot;address-level-2&quot;&gt;
   &lt;input ... autocomplete=&quot;address-level-3&quot;&gt;

...and then the user enters their address:

   1600 Amphitheatre Parkway
   Mountain View
   CA

...and then the user goes to another site:

   &lt;input ... autocomplete=&quot;address-line-1&quot;&gt;
   &lt;input ... autocomplete=&quot;address-line-2&quot;&gt;
   &lt;input ... autocomplete=&quot;address-level-1&quot;&gt;
   &lt;input ... autocomplete=&quot;address-level-2&quot;&gt;
   &lt;input ... autocomplete=&quot;address-level-3&quot;&gt;

...and the browser autofills:

   1600 Amphitheatre Parkway
   (empty)
   Mountain View
   Mountain View
   CA

...or some such.


&gt;<i> &gt; How does a site know how many levels to offer?
</I>&gt;<i> 
</I>&gt;<i> It offers as many as it knows what to do with. It probably wouldn't know 
</I>&gt;<i> what to do with n=5, or n=100, and it's highly unlikely a user agent 
</I>&gt;<i> would return a value for those levels anyway, so practically speaking, 
</I>&gt;<i> n=1 to n=3 should be sufficient for now (although n=4 seems possible in 
</I>&gt;<i> the near future). But I don't see the purpose in setting a limit in the 
</I>&gt;<i> spec.
</I>
This makes me extremely uncomfortable.

We're saying, &quot;we don't know how to do this, I hope you do&quot;. Why would we 
be less able to answer this than Web authors? It's not like Web authors 
are experts in postal addresses.

I think we should pick the number that is actually needed, and be firm 
that that is the number.


&gt;<i> &gt; What should a Chinese user interacting with a US company put in as 
</I>&gt;<i> &gt; their address, if they want something shipped to China?
</I>&gt;<i> 
</I>&gt;<i> They would put in the same address regardless of the nationality of the 
</I>&gt;<i> company, assuming the company is able to properly handle their address. 
</I>
Shouldn't we want everyone to be able to handle everyone's address?


&gt;<i> Which inputs are visible to the user should depend on which country 
</I>&gt;<i> they're entering. This means that if a user changes the country, the 
</I>&gt;<i> inputs shuffle around and hide or show.
</I>
Are we really expecting many sites to do this? I've only seen the most 
advanced sites do this.


&gt;<i> &gt; So they would be synonyms? Or separate fields?
</I>&gt;<i> 
</I>&gt;<i> They are pseudo-synonyms.
</I>
I don't know what that means.


&gt;<i> In the US, &quot;region&quot; aligns with &quot;address-level-1&quot;, and either one would 
</I>&gt;<i> return the same value. In the UAE, where there are cities but no higher 
</I>&gt;<i> level administrative region, &quot;locality&quot; aligns with &quot;address-level-1&quot;. 
</I>&gt;<i> In China, &quot;address-level-1&quot; is a province a province-level city such as 
</I>&gt;<i> Beijing. Beijing is also &quot;region&quot;, confusingly, and a district of the 
</I>&gt;<i> city is a &quot;locality&quot;.
</I>
If we're going to do this, we need to have a mapping for every locality 
defined in the spec. This seems like a losing proposition.

Why not make them straight synonyms?


&gt;<i> So generally speaking, if I ship to both China and the US, I would 
</I>&gt;<i> create a form with &quot;address-level-[1..4]&quot; and if the user starts to 
</I>&gt;<i> enter a US address, only show the first 2 levels. If the user starts to 
</I>&gt;<i> enter a Chinese address, show more levels. If using requestAutocomplete, 
</I>&gt;<i> all the inputs are hidden all the time anyway.
</I>
Are we going to have a list in the spec giving how many levels should be 
given for each country?

Note that the &quot;country&quot; field is often near the end of the form. How do 
you know which country the user is entering an address for when all the 
user's entered is three lines of text?

(Most Web developers don't have access to a reverse geocoder that can 
guess the answer from the first line.)


On Tue, 25 Feb 2014, J&#252;rg Lehni wrote:
&gt;<i>
</I>&gt;<i> I think it is dangerous to make any kind of assumption about valid 
</I>&gt;<i> postal addresses.
</I>&gt;<i> 
</I>&gt;<i> Here's a great list of all kinds of exceptions to rules that programmers 
</I>&gt;<i> tend to believe to be true:
</I>&gt;<i> 
</I>&gt;<i> (Don't we love rules?)
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.mjt.me.uk/posts/falsehoods-programmers-believe-about-addresses/">http://www.mjt.me.uk/posts/falsehoods-programmers-believe-about-addresses/</A>
</I>
I didn't see any there that were contradicted by the assumptions in the 
HTML spec; did you have any particular ones in mind?

-- 
Ian Hickson               U+1047E                )\._.,--....,'``.    fL
<A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="084378.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
	<LI>Next message: <A HREF="084385.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84384">[ date ]</a>
              <a href="thread.html#84384">[ thread ]</a>
              <a href="subject.html#84384">[ subject ]</a>
              <a href="author.html#84384">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
