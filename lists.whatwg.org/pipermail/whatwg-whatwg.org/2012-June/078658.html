<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Navigation triggered from unload
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Navigation%20triggered%20from%20unload&In-Reply-To=%3C4FD8C419.2060003%40opera.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="078646.html">
   <LINK REL="Next"  HREF="036374.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Navigation triggered from unload</H1>
<!--htdig_noindex-->
    <B>James Graham</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Navigation%20triggered%20from%20unload&In-Reply-To=%3C4FD8C419.2060003%40opera.com%3E"
       TITLE="[whatwg] Navigation triggered from unload">jgraham at opera.com
       </A><BR>
    <I>Wed Jun 13 09:47:21 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="078646.html">[whatwg] Navigation triggered from unload
</A></li>
        <LI>Next message: <A HREF="036374.html">[whatwg] Domain transfer security
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78658">[ date ]</a>
              <a href="thread.html#78658">[ thread ]</a>
              <a href="subject.html#78658">[ subject ]</a>
              <a href="author.html#78658">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 06/12/2012 08:56 PM, Boris Zbarsky wrote:
&gt;<i> On 6/12/12 6:30 AM, James Graham wrote:
</I>&gt;&gt;<i> Based on some tests ([1]-[5]), it seems that WebKit seems to cancel the
</I>&gt;&gt;<i> navigation in the unload handler always, Opera seems to always carry out
</I>&gt;&gt;<i> the navigation in the unload handler, and Gecko seems to follow WebKit
</I>&gt;&gt;<i> in the cross-origin case and Opera in the same-origin case. In all cases
</I>&gt;&gt;<i> the unload handler is only called once.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [1] <A HREF="http://hoppipolla.co.uk/tests/navigation/003.html">http://hoppipolla.co.uk/tests/navigation/003.html</A>
</I>&gt;&gt;<i> [2] <A HREF="http://hoppipolla.co.uk/tests/navigation/004.html">http://hoppipolla.co.uk/tests/navigation/004.html</A>
</I>&gt;&gt;<i> [3] <A HREF="http://hoppipolla.co.uk/tests/navigation/005.html">http://hoppipolla.co.uk/tests/navigation/005.html</A>
</I>&gt;&gt;<i> [4] <A HREF="http://hoppipolla.co.uk/tests/navigation/006.html">http://hoppipolla.co.uk/tests/navigation/006.html</A>
</I>&gt;&gt;<i> [5] <A HREF="http://hoppipolla.co.uk/tests/navigation/007.html">http://hoppipolla.co.uk/tests/navigation/007.html</A>
</I>&gt;<i>
</I>&gt;<i> For what it's worth, we initially tried to do what you say WebKit does
</I>&gt;<i> but ran into web compat issues. See
</I>&gt;<i> <A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=371360">https://bugzilla.mozilla.org/show_bug.cgi?id=371360</A> for the original bug
</I>&gt;<i> where we blocked all navigation during unload and
</I>&gt;<i> <A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=409888">https://bugzilla.mozilla.org/show_bug.cgi?id=409888</A> for the bug where we
</I>&gt;<i> changed to the current behavior. I believe the spec says what it says
</I>&gt;<i> based on our implementation experience here...
</I>
Hmm, so I wonder if the WebKit people consider it a problem that they 
don't pass the tests in those bug reports. I couldn't find any of the 
original sites still responding, so it's hard to know if there is still 
a compat. problem here. If there isn't, the greater conceptual 
simplicity of the WebKit model is quite appealing.

&gt;<i> P.S. Opera's behavior is not quite as simple as you describe: as far as
</I>&gt;<i> I can tell it depends on whether the unload is happening due to the user
</I>&gt;<i> typing something in the url bar or due to the user clicking a link, say.
</I>
That seems to be true. On the other hand it appears that gecko will 
still respect navigation from unload even if the unload was triggered by 
explicit user interaction (e.g. by editing the address bar), as long as 
all the origins match, so you can end up at a different page to the one 
you expected. That is very surprising behaviour (although I see that you 
can argue that it is possible in other ways).

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="078646.html">[whatwg] Navigation triggered from unload
</A></li>
	<LI>Next message: <A HREF="036374.html">[whatwg] Domain transfer security
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78658">[ date ]</a>
              <a href="thread.html#78658">[ thread ]</a>
              <a href="subject.html#78658">[ subject ]</a>
              <a href="author.html#78658">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
