<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] &lt;canvas&gt; shadow compositing oddities
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Ccanvas%3E%20shadow%20compositing%20oddities&In-Reply-To=%3Cea09c0d10807290629i72261665n6c6b8efc47d25277%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="057715.html">
   <LINK REL="Next"  HREF="057699.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] &lt;canvas&gt; shadow compositing oddities</H1>
<!--htdig_noindex-->
    <B>Philip Taylor</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Ccanvas%3E%20shadow%20compositing%20oddities&In-Reply-To=%3Cea09c0d10807290629i72261665n6c6b8efc47d25277%40mail.gmail.com%3E"
       TITLE="[whatwg] &lt;canvas&gt; shadow compositing oddities">excors+whatwg at gmail.com
       </A><BR>
    <I>Tue Jul 29 06:29:03 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="057715.html">[whatwg] &lt;canvas&gt; shadow compositing oddities
</A></li>
        <LI>Next message: <A HREF="057699.html">[whatwg] Making it possible to do an anchor link to any DOM node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57718">[ date ]</a>
              <a href="thread.html#57718">[ thread ]</a>
              <a href="subject.html#57718">[ subject ]</a>
              <a href="author.html#57718">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Sun, Jul 27, 2008 at 8:06 PM, Eric Butler &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ebutler at mozilla.com</A>&gt; wrote:
&gt;<i> [...]
</I>&gt;<i> However, following the spec's drawing model, there are a few operators that
</I>&gt;<i> behave rather unexpectedly if the shadow color is left at its default value.
</I>&gt;<i> For instance, since A in B always results in transparency if either A or B
</I>&gt;<i> is fully transparent, source-in will always simply clear the clipping region
</I>&gt;<i> to fully transparent no matter what the source and destination are.
</I>
Oops - that does seem quite broken. (It's probably my fault - I didn't
notice that problem when I was looking at how shadows should work...)

&gt;<i> It would seem Safari isn't quite following the spec here, since it appears
</I>&gt;<i> to never draw shadows when the shadow color is fully transparent or
</I>&gt;<i> something and doesn't encounter these issues.
</I>
As far as I can tell: It never draws shadows when shadowColor.alpha &lt;
1/256, regardless of the other attributes. Also, it never draws
shadows when blur=0 and abs(offsetX) &lt;= 1 and abs(offsetY) &lt;= 1,
regardless of the colour.

In the cases where it does draw shadows, there's also an issue that
its compositor ignores the area outside the shape that's being drawn
(instead of treating it as transparent-black, as is required by the
spec and implemented by Opera and (usually) Firefox) - so in cases
like <A HREF="http://philip.html5.org/demos/canvas/shadow-composite.html">http://philip.html5.org/demos/canvas/shadow-composite.html</A> with
the source-in mode, WebKit fails to clear the area outside the
shape/shadow to transparent-black. (I'm testing with Safari 3.0.4 - I
hope not much has changed since then). That is probably a sufficiently
unusual situation that it's sensible for the spec to stay as it is and
require WebKit to change, though the spec still needs to change for
the default shadows-disabled case.

-- 
Philip Taylor
<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">excors at gmail.com</A>

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="057715.html">[whatwg] &lt;canvas&gt; shadow compositing oddities
</A></li>
	<LI>Next message: <A HREF="057699.html">[whatwg] Making it possible to do an anchor link to any DOM node
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57718">[ date ]</a>
              <a href="thread.html#57718">[ thread ]</a>
              <a href="subject.html#57718">[ subject ]</a>
              <a href="author.html#57718">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
