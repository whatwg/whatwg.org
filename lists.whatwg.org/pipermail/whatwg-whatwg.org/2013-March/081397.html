<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal: ImageData constructor or factory method with preexisting data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20ImageData%20constructor%20or%20factory%20method%20with%0A%20preexisting%20data&In-Reply-To=%3CCABpaAqR8LbJpsOgL8i4PPhdfs_xuAfr7rOa%2BrwS%3DF27FbM8TPQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081393.html">
   <LINK REL="Next"  HREF="081398.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal: ImageData constructor or factory method with preexisting data</H1>
<!--htdig_noindex-->
    <B>Justin Novosad</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20ImageData%20constructor%20or%20factory%20method%20with%0A%20preexisting%20data&In-Reply-To=%3CCABpaAqR8LbJpsOgL8i4PPhdfs_xuAfr7rOa%2BrwS%3DF27FbM8TPQ%40mail.gmail.com%3E"
       TITLE="[whatwg] Proposal: ImageData constructor or factory method with preexisting data">junov at chromium.org
       </A><BR>
    <I>Mon Mar 11 19:48:41 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081393.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
        <LI>Next message: <A HREF="081398.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81397">[ date ]</a>
              <a href="thread.html#81397">[ thread ]</a>
              <a href="subject.html#81397">[ subject ]</a>
              <a href="author.html#81397">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Mar 11, 2013 at 8:00 PM, Rik Cabanier &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cabanier at gmail.com</A>&gt; wrote:

&gt;<i> Do you expect that createImageData creates an internal copy of the
</I>&gt;<i> Uint8ClampedArray object
</I>&gt;<i> or is it live?
</I>&gt;<i>
</I>
That only matters if the referenced data is writable, in which case there
probably should be an internal copy.  That is not necessarily the
motivation behind this proposal (Ken?)

The use cases I see for this new interface is for relaying image data, that
is *not* generated in JS.  For example, suppose a chunk of image data is
 generated on the server side and sent to the client via WebSocket. On the
client side, you just want to copy the data field of the message event onto
a 2D canvas. With the current API, an intermediate copy is required in
order to wrap the incoming data into an ImageData object.

 -Justin


&gt;<i>
</I>&gt;<i> On Mon, Mar 11, 2013 at 4:28 PM, Kenneth Russell &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">kbr at google.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; It would be useful to be able to create an ImageData [1] object with
</I>&gt;<i> &gt; preexisting data. The main use case is to display arbitrary data in
</I>&gt;<i> &gt; the 2D canvas context with no data copies.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Proposed IDL:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [NoInterfaceObject]
</I>&gt;<i> &gt; interface ImageDataFactories {
</I>&gt;<i> &gt;   ImageData createImageData(Uint8ClampedArray data, double sw, double
</I>&gt;<i> sh);
</I>&gt;<i> &gt; };
</I>&gt;<i> &gt; Window implements ImageDataFactories;
</I>&gt;<i> &gt; WorkerGlobalScope implements ImageDataFactories;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; createImageData would throw an exception if the length of the
</I>&gt;<i> &gt; Uint8ClampedArray was not equal to 4 * floor(sw) * floor(sh), or at
</I>&gt;<i> &gt; least, if the length of the array was less than this value. (Similar
</I>&gt;<i> &gt; wording would be used to that of CanvasRenderingContext2D's
</I>&gt;<i> &gt; createImageData.)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't think it is necessary to provide a createImageDataHD in this
</I>&gt;<i> &gt; interface. The caller will know the devicePixelRatio and determine
</I>&gt;<i> &gt; whether to generate high-DPI data.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [1]
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Comments?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -Ken
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081393.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
	<LI>Next message: <A HREF="081398.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81397">[ date ]</a>
              <a href="thread.html#81397">[ thread ]</a>
              <a href="subject.html#81397">[ subject ]</a>
              <a href="author.html#81397">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
