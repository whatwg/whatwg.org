<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Question about document.referrer (and document.URL, document.location.href) when IDN domains are in use
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Question%20about%20document.referrer%20%28and%20document.URL%2C%0A%20document.location.href%29%20when%20IDN%20domains%20are%20in%20use&In-Reply-To=%3C514A7477.6040905%40mit.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081530.html">
   <LINK REL="Next"  HREF="081539.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Question about document.referrer (and document.URL, document.location.href) when IDN domains are in use</H1>
<!--htdig_noindex-->
    <B>Boris Zbarsky</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Question%20about%20document.referrer%20%28and%20document.URL%2C%0A%20document.location.href%29%20when%20IDN%20domains%20are%20in%20use&In-Reply-To=%3C514A7477.6040905%40mit.edu%3E"
       TITLE="[whatwg] Question about document.referrer (and document.URL, document.location.href) when IDN domains are in use">bzbarsky at MIT.EDU
       </A><BR>
    <I>Wed Mar 20 19:46:15 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081530.html">[whatwg] [html][webcomponents]: Link element in body?
</A></li>
        <LI>Next message: <A HREF="081539.html">[whatwg] Question about document.referrer (and document.URL, document.location.href) when IDN domains are in use
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39264">[ date ]</a>
              <a href="thread.html#39264">[ thread ]</a>
              <a href="subject.html#39264">[ subject ]</a>
              <a href="author.html#39264">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>The spec for document.referrer says:

   The referrer attribute must return the document's referrer.

The &quot;document's referrer&quot; is not really defined anywhere in a useful way 
that I can find.

This then follows with a non-normative note:

    Note: In the case of HTTP, the referrer IDL attribute will match the
    Referer (sic) header that was sent when fetching the current page.

In cases when the hostname is non-ASCII, the Referer header will have it 
encoded in punycode.  The question is what should happen for 
document.referrer.  Right now, I see the following behavior:

1)  Gecko shows exactly the string we put on the wire in 
document.referrer (punycode and all).  document.URL and 
document.location.href show the non-ASCII chars in some cases.

2)  WebKit (or at least Chrome) seems to return punycode for all three 
of these.

3)  Opera seems to return non-ASCII chars for all three of these, at 
least in some cases.

No idea what IE does.

The question is whether it's more important for document.referrer to 
match the HTTP header (so the note will actually be true) or 
location.href and .URL...  Well, and the other question is what .URL and 
location.href should return, since clearly we don't exactly have interop 
there.

-Boris
</PRE>





















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081530.html">[whatwg] [html][webcomponents]: Link element in body?
</A></li>
	<LI>Next message: <A HREF="081539.html">[whatwg] Question about document.referrer (and document.URL, document.location.href) when IDN domains are in use
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39264">[ date ]</a>
              <a href="thread.html#39264">[ thread ]</a>
              <a href="subject.html#39264">[ subject ]</a>
              <a href="author.html#39264">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
