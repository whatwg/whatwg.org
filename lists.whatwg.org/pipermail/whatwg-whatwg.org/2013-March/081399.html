<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal: ImageData constructor or factory method with preexisting data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20ImageData%20constructor%20or%20factory%20method%20with%0A%20preexisting%20data&In-Reply-To=%3CCAGN7qDCSx4vjQMw-69UqjL1sSm0wLfAU3%3D75ZDunHodCfn%2BvoA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081398.html">
   <LINK REL="Next"  HREF="081400.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal: ImageData constructor or factory method with preexisting data</H1>
<!--htdig_noindex-->
    <B>Rik Cabanier</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20ImageData%20constructor%20or%20factory%20method%20with%0A%20preexisting%20data&In-Reply-To=%3CCAGN7qDCSx4vjQMw-69UqjL1sSm0wLfAU3%3D75ZDunHodCfn%2BvoA%40mail.gmail.com%3E"
       TITLE="[whatwg] Proposal: ImageData constructor or factory method with preexisting data">cabanier at gmail.com
       </A><BR>
    <I>Mon Mar 11 20:58:37 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081398.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
        <LI>Next message: <A HREF="081400.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81399">[ date ]</a>
              <a href="thread.html#81399">[ thread ]</a>
              <a href="subject.html#81399">[ subject ]</a>
              <a href="author.html#81399">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Mar 11, 2013 at 8:27 PM, Glenn Maynard &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">glenn at zewt.org</A>&gt; wrote:

&gt;<i> On Mon, Mar 11, 2013 at 9:48 PM, Justin Novosad &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">junov at chromium.org</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> The use cases I see for this new interface is for relaying image data,
</I>&gt;&gt;<i> that
</I>&gt;&gt;<i>
</I>&gt;<i> is *not* generated in JS.  For example, suppose a chunk of image data is
</I>&gt;&gt;<i>  generated on the server side and sent to the client via WebSocket. On the
</I>&gt;&gt;<i> client side, you just want to copy the data field of the message event
</I>&gt;&gt;<i> onto
</I>&gt;&gt;<i> a 2D canvas. With the current API, an intermediate copy is required in
</I>&gt;&gt;<i> order to wrap the incoming data into an ImageData object.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If data is generated server-side, then the createImageBitmap API is
</I>&gt;<i> probably what you want.
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/#imagebitmap">http://www.whatwg.org/specs/web-apps/current-work/#imagebitmap</A>
</I>&gt;<i>
</I>
That would have the added benefit of having CORS. Drawing with a generic
data buffer should probably taint the canvas state.


&gt;<i>
</I>&gt;<i> If there are use cases for creating an ImageData, I recommend not making a
</I>&gt;<i> copy, so all this is doing is taking an existing ArrayBuffer and creating a
</I>&gt;<i> thin wrapper around the same buffer.
</I>&gt;<i>
</I>
I think that would make implementations that defer rendering much more
complex and slower. (It would force putImage to execute immediately since
it doesn't know if the buffer will change in JS)


&gt;<i>
</I>&gt;<i> That said, avoiding an extra copy for data that just came in over the
</I>&gt;<i> network doesn't seem like much of an optimization (and it's probably
</I>&gt;<i> compressed anyway), and if copy semantics are wanted, unnecessary copies
</I>&gt;<i> can still be avoided with copy-on-write.
</I>&gt;<i>
</I>
I agree. It seems better if you use a real image for file transfer since
you will get better network throughput and you can store it compressed in
memory.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081398.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
	<LI>Next message: <A HREF="081400.html">[whatwg] Proposal: ImageData constructor or factory method with preexisting data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81399">[ date ]</a>
              <a href="thread.html#81399">[ thread ]</a>
              <a href="subject.html#81399">[ subject ]</a>
              <a href="author.html#81399">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
