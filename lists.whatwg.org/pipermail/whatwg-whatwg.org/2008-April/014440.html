<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] postMessage() issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%28%29%20issues&In-Reply-To=%3C278fd46c0804171039x6906edbg40b86ad12eb9b2f7%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014439.html">
   <LINK REL="Next"  HREF="014489.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] postMessage() issues</H1>
<!--htdig_noindex-->
    <B>Aaron Boodman</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%28%29%20issues&In-Reply-To=%3C278fd46c0804171039x6906edbg40b86ad12eb9b2f7%40mail.gmail.com%3E"
       TITLE="[whatwg] postMessage() issues">aa at google.com
       </A><BR>
    <I>Thu Apr 17 10:39:47 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="014439.html">[whatwg] postMessage() issues
</A></li>
        <LI>Next message: <A HREF="014489.html">[whatwg] postMessage() issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14440">[ date ]</a>
              <a href="thread.html#14440">[ thread ]</a>
              <a href="subject.html#14440">[ subject ]</a>
              <a href="author.html#14440">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Apr 16, 2008 at 3:17 PM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:
&gt;<i> Maciej Stachowiak wrote:
</I>&gt;&gt;<i> - Processing a reply synchronously is awkward in any case, since you need
</I>&gt;&gt;<i> a callback.
</I>&gt;<i>
</I>&gt;<i> I'm not sure I follow this argument, I actually come to the opposite
</I>&gt;<i> conclusion.
</I>&gt;<i>
</I>&gt;<i> Say that a page is communicating with multiple iframes using
</I>&gt;<i> postMessage, and expect replies from all of them.
</I>&gt;<i>
</I>&gt;<i> If postMessage is synchronous it is easy to associate a given &quot;reply&quot;
</I>&gt;<i> with a given postMessage call, it's simply the reply you get between the
</I>&gt;<i> time you make the postMessage call and when it returns. So you could install
</I>&gt;<i> a generic listener for the message event and let the listener set a global
</I>&gt;<i> variable. Then you just do a postMessage and pick up the reply from the
</I>&gt;<i> global variable.
</I>&gt;<i>
</I>&gt;<i> If postMessage is asynchronous you need to agree on using some identifier in
</I>&gt;<i> the messages, or you have to use the pipes mechanism for all communication.
</I>&gt;<i> Granted, with javascript generators you can almost get the same behavior as
</I>&gt;<i> for synchronous calling, but that is non-trivial.
</I>
This is a really good argument. FWIW, I had not considered the case of
coordinating between multiple iframes. That does make the async
version significantly more complex.

IMO, the tradeoff is still worth it, though. And in the future, with
something like Hixie's messaging proposal, this problem will go away
(because you'll have stateful objects that represent a conversation).

&gt;<i> So one thing I should note first of all is that the implementation that
</I>&gt;<i> is currently in the Firefox 3 betas are synchronous. It is unlikely that
</I>&gt;<i> we can get this changed by final shipping since we are more or less in
</I>&gt;<i> code freeze already.
</I>&gt;<i>
</I>&gt;<i> Of course, we implemented this knowing that it's part of HTML5 which is
</I>&gt;<i> nowhere near complete, so obviously we were aware that it might change.
</I>&gt;<i> However it might mean that developers will have to put in workarounds in
</I>&gt;<i> order to support the FF3 release :(
</I>
What about if we just left the sync/async-ness unspecified for the
first version of postMessage. In practice this means that
implementations might be incompatible, but I don't the workarounds are
that big a deal. Authors have this problem already today with XHR in
certain edge cases (sometimes onreadystatechange is not asynchronous)?

In the future, when the messaging proposal evolves, we tighten it down
and make it async.


- a

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014439.html">[whatwg] postMessage() issues
</A></li>
	<LI>Next message: <A HREF="014489.html">[whatwg] postMessage() issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14440">[ date ]</a>
              <a href="thread.html#14440">[ thread ]</a>
              <a href="subject.html#14440">[ subject ]</a>
              <a href="author.html#14440">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
