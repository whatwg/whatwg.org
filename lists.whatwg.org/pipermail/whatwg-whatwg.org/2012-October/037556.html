<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Document referrer and script entry point
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Document%20referrer%20and%20script%20entry%20point&In-Reply-To=%3CCAKBxTcL11WdqUueoMuX4eYZ7h1EE3wbEs5%3DzxtNQU7zZQPscKA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="079840.html">
   <LINK REL="Next"  HREF="079832.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Document referrer and script entry point</H1>
<!--htdig_noindex-->
    <B>Bobby Holley</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Document%20referrer%20and%20script%20entry%20point&In-Reply-To=%3CCAKBxTcL11WdqUueoMuX4eYZ7h1EE3wbEs5%3DzxtNQU7zZQPscKA%40mail.gmail.com%3E"
       TITLE="[whatwg] Document referrer and script entry point">bobbyholley at gmail.com
       </A><BR>
    <I>Tue Oct  9 06:45:18 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="079840.html">[whatwg] Null characters
</A></li>
        <LI>Next message: <A HREF="079832.html">[whatwg] Document referrer and script entry point
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37556">[ date ]</a>
              <a href="thread.html#37556">[ thread ]</a>
              <a href="subject.html#37556">[ subject ]</a>
              <a href="author.html#37556">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>The spec says the following about Document.referrer:

The referrer attribute must return either the address of the active
document of the source browsing context at the time the navigation was
started (that is, the page which navigated the browsing context to the
current document) (3.1.3).

This implies that if document |a| calls into a same-origin function
running in the scope of document |b|, which navigates an iframe to
|<i>c|, c.referrer should point to |b|.
</I>
The alternate implementation would be to let c.referrer equal the
script entry point, which would be |a|.

A cursory analysis indicates that Gecko and WebKit implement spec
behavior. Opera and IE implement the alternate behavior. My testcase
is here: <A HREF="http://people.mozilla.org/~bholley/testcases/a-calls-b-navigates-c/a.html">http://people.mozilla.org/~bholley/testcases/a-calls-b-navigates-c/a.html</A>

I'd like to change Gecko to implement the alternate behavior - that is
to say, making document.referrer refer to the script entry point at
the time of navigation. We already track the script-entry point
per-spec, so finding that is easy. In contrast, finding the
immediately-calling document requires some nasty JS introspection that
I'd like to get rid of.

However, that would leave WebKit as the only engine implementing the
spec behavior. Any WebKit folks want to chime in on this issue? Ian,
how do you feel about this spec-wise?

Cheers,
bholley
</PRE>




































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="079840.html">[whatwg] Null characters
</A></li>
	<LI>Next message: <A HREF="079832.html">[whatwg] Document referrer and script entry point
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#37556">[ date ]</a>
              <a href="thread.html#37556">[ thread ]</a>
              <a href="subject.html#37556">[ subject ]</a>
              <a href="author.html#37556">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
