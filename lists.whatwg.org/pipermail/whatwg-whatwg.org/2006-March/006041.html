<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] The problem of duplicate ID as a security issue
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20The%20problem%20of%20duplicate%20ID%20as%20a%20security%20issue&In-Reply-To=%3Cop.s6ih5sasmcpsjg%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006039.html">
   <LINK REL="Next"  HREF="006049.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] The problem of duplicate ID as a security issue</H1>
<!--htdig_noindex-->
    <B>Mihai Sucan</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20The%20problem%20of%20duplicate%20ID%20as%20a%20security%20issue&In-Reply-To=%3Cop.s6ih5sasmcpsjg%40localhost.localdomain%3E"
       TITLE="[whatwg] The problem of duplicate ID as a security issue">mihai.sucan at gmail.com
       </A><BR>
    <I>Thu Mar 16 07:18:54 PST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="006039.html">[whatwg] The problem of duplicate ID as a security issue
</A></li>
        <LI>Next message: <A HREF="006049.html">[whatwg] The problem of duplicate ID as a security issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6041">[ date ]</a>
              <a href="thread.html#6041">[ thread ]</a>
              <a href="subject.html#6041">[ subject ]</a>
              <a href="author.html#6041">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Le Thu, 16 Mar 2006 14:47:24 +0200, Alexey Feldgendler  
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">alexey at feldgendler.ru</A>&gt; a &#233;crit:

&gt;<i> On Thu, 16 Mar 2006 18:33:30 +0600, Mihai Sucan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">mihai.sucan at gmail.com</A>&gt;  
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&lt;...&gt;
&gt;<i>
</I>&gt;&gt;<i> Therefore, it's clear nothing has to be changed in quirks mode, but in  
</I>&gt;&gt;<i> standards mode:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. break during parsing.
</I>&gt;&gt;<i> 2. break JS code if it sets the id of a node to a duplicate ID.
</I>&gt;<i>
</I>&gt;<i> And what if the JS code clones a node with non-empty ID? Should it throw  
</I>&gt;<i> an exception when such a node is inserted into the document?
</I>
This is something I forgot about.

The DOM 3 Core [1] spec should define the behaviour. I've just looked  
right now ... and no special details are given about cloneNode and the ID  
attribute.

Yet getElementById is defined as [2]:

&lt;blockquote&gt;
	Returns the Element that has an ID attribute with the given value. If no  
such element exists, this returns null.
	If more than one element has an ID attribute with that value, what is  
returned is undefined.
&lt;/blockquote&gt;

Therefore... the appropriate behaviour for getElementById(&quot;duplicate-ID&quot;)  
is to return null. This is something not respected by any major browser,  
even in standards mode. This is the best behaviour for duplicate IDs,  
better than breaking the script, better than returning *one* of the nodes  
having the same ID.

&gt;&gt;<i> Or simply leave it as it is: quirks mode behaviour.
</I>&gt;<i>
</I>&gt;<i> Maybe you're right. Really, the standards more should be as strict as  
</I>&gt;<i> possible.
</I>
Strict or not strict? That's the question.

If strict: return null, no error as DOM 3 Core defines getElementById.

Returning null in quirks mode still breaks pages.

&gt;&gt;&gt;<i> Simply picking the last matching node is actually hiding a bug and  
</I>&gt;&gt;&gt;<i> letting it go unnoticed. (Why the last one? Why not the first, for  
</I>&gt;&gt;&gt;<i> example?)
</I>&gt;<i>
</I>&gt;&gt;<i> That's true, but this happens in many, many other cases.
</I>&gt;<i>
</I>&gt;<i> In standards mode? What are these cases?
</I>
I was referring to the fact bugs made by web author are being let to go  
unnoticed, even in standards mode. Luckily, Opera 9 and Firefox 1.5 have  
started showing more errors in consoles (CSS, JS, XML, HTML, etc).

[1] <A HREF="http://www.w3.org/TR/DOM-Level-3-Core/">http://www.w3.org/TR/DOM-Level-3-Core/</A>
[2] <A HREF="http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-getElBId">http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-getElBId</A>

-- 
<A HREF="http://www.robodesign.ro">http://www.robodesign.ro</A>
ROBO Design - We bring you the future

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006039.html">[whatwg] The problem of duplicate ID as a security issue
</A></li>
	<LI>Next message: <A HREF="006049.html">[whatwg] The problem of duplicate ID as a security issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6041">[ date ]</a>
              <a href="thread.html#6041">[ thread ]</a>
              <a href="subject.html#6041">[ subject ]</a>
              <a href="author.html#6041">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
