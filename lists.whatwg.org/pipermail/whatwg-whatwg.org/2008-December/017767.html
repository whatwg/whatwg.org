<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] When closing the browser
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20When%20closing%20the%20browser&In-Reply-To=%3C494296FA.7040801%40email.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017766.html">
   <LINK REL="Next"  HREF="017773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] When closing the browser</H1>
<!--htdig_noindex-->
    <B>Calogero Alex Baldacchino</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20When%20closing%20the%20browser&In-Reply-To=%3C494296FA.7040801%40email.it%3E"
       TITLE="[whatwg] When closing the browser">alex.baldacchino at email.it
       </A><BR>
    <I>Fri Dec 12 08:53:14 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="017766.html">[whatwg] When closing the browser
</A></li>
        <LI>Next message: <A HREF="017773.html">[whatwg] When closing the browser
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17767">[ date ]</a>
              <a href="thread.html#17767">[ thread ]</a>
              <a href="subject.html#17767">[ subject ]</a>
              <a href="author.html#17767">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Bil Corry ha scritto:
&gt;<i> Speaking of 'onbeforeunload' and 'beforeunload' -- it'd be helpful if there was a way to distinguish between the user taking an action which leaves the site vs. taking an action that returns to the site.  E.g.:
</I>&gt;<i>
</I>&gt;<i> 	leaves site:
</I>&gt;<i> 		closes browser
</I>&gt;<i> 		closes tab
</I>&gt;<i> 		closes window
</I>&gt;<i> 		back/forward to different site
</I>&gt;<i> 		GET/POST to another site
</I>&gt;<i> 		navigates away using address bar
</I>&gt;<i>
</I>&gt;<i> 	returns to site:
</I>&gt;<i> 		reloads page
</I>&gt;<i> 		back/forward to same site
</I>&gt;<i> 		GET/POST to same site
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> For privacy, it shouldn't reveal which specific action triggered the event, but knowing if the user is leaving the site means webapps can finally auto-logout the user, which in turn greatly improves security.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> - Bil 
</I>&gt;<i>
</I>&gt;<i>   
</I>
That's a nice idea; the before unload event, for instance, might hold a 
boolean attribute telling whether the user is navigating to the same 
domain or not. Anyway, such might fail somehow (or sometimes) if (a 
relevant part of) the webapp were contained in a frame/iframe inside a 
document coming from a different domain.

Actually, I think your proposed behaviour might be worked around with 
short-living persistent cookies (when enabled, of course). For a login 
mechanism fully based on (non-http-only) cookies, setting a short-timed 
expire date (a matter of few seconds) should do the trick: if the user 
action is directed to the same site, the server would recieve the cookie 
before its expiration; when loading a page within the login cookie 
lifetime, the page would change the expiration time accordingly. For a 
more complex (and secure) login mechanism, a short-living persistent 
cookie might hold a 'secondary' session-id with an expiration date set, 
before unloading, so to match a predefined delay: the webapp would issue 
a delayed logout, so that after the choosen delay every session data 
would be invalidated, and the user logged-out; if an attacker grabbed 
such a secondary cookie, he wouldn't get any relevant login information, 
and its suitability for a cross-site attack (e.g. by loading a page from 
the target site before the cookie expiration) would be restricted to an 
arbitrarily short time (such would be a similar strategy to bank token 
generators: imperfect but working).

Otherwise, the user might be prompted for an explicit logout request 
before unloading (as suggested for volatile data). Perhaps a combination 
of three methods (the boolean attribute telling about same-domain 
navigation, a short-living cookie and an explicit choice by the user) 
might improve the overall security.

 
 
 --
 Caselle da 1GB, trasmetti allegati fino a 3GB e in piu' IMAP, POP3 e SMTP autenticato? GRATIS solo con Email.it <A HREF="http://www.email.it/f">http://www.email.it/f</A>
 
 Sponsor:
 CheBanca! La prima banca che ti d&#224; gli interessi in anticipo.
* Fino al 4,70% sul Conto Deposito, zero spese e interessi subito. Aprilo!
 Clicca qui: <A HREF="http://adv.email.it/cgi-bin/foclick.cgi?mid=8435&amp;d=12-12">http://adv.email.it/cgi-bin/foclick.cgi?mid=8435&amp;d=12-12</A>

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017766.html">[whatwg] When closing the browser
</A></li>
	<LI>Next message: <A HREF="017773.html">[whatwg] When closing the browser
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17767">[ date ]</a>
              <a href="thread.html#17767">[ thread ]</a>
              <a href="subject.html#17767">[ subject ]</a>
              <a href="author.html#17767">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
