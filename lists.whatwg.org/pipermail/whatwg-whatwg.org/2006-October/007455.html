<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Canvas lack of drawString method
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%20lack%20of%20drawString%20method&In-Reply-To=%3C84ce626f0610250134p246cadau3fad3a95acafa42b%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007454.html">
   <LINK REL="Next"  HREF="007456.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Canvas lack of drawString method</H1>
<!--htdig_noindex-->
    <B>Charles Iliya Krempeaux</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%20lack%20of%20drawString%20method&In-Reply-To=%3C84ce626f0610250134p246cadau3fad3a95acafa42b%40mail.gmail.com%3E"
       TITLE="[whatwg] Canvas lack of drawString method">supercanadian at gmail.com
       </A><BR>
    <I>Wed Oct 25 01:34:13 PDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="007454.html">[whatwg] Canvas lack of drawString method (p.s.)
</A></li>
        <LI>Next message: <A HREF="007456.html">[whatwg] Canvas lack of drawString method
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7455">[ date ]</a>
              <a href="thread.html#7455">[ thread ]</a>
              <a href="subject.html#7455">[ subject ]</a>
              <a href="author.html#7455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hello,

I believe it starts to gets more complex when you get into globalization.
(Not that I'm an expert on that, but....)  More thought may be needed to be
put into this to make this work in a global sense (and not just with
roman-based alphabets like ours.)


See ya

On 10/25/06, Stefan Haustein &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">sh at kobjects.org</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> Hi David,
</I>&gt;<i>
</I>&gt;<i> of course adding only textStyle and drawText() is much better than
</I>&gt;<i> nothing at all! :)
</I>&gt;<i>
</I>&gt;<i> However, I would still prefer an API design that keeps it simple to add
</I>&gt;<i> those methods later. Perhaps they could be included and simply return
</I>&gt;<i> null if the requested information is not available (e.g. for a dumb EPS
</I>&gt;<i> render target?). Also, if we do not have access to font metrics, I think
</I>&gt;<i> we need an additional parameter for drawText() that specifies the
</I>&gt;<i> alignment of the text relative to the reference point, as illustrated in
</I>&gt;<i> the image below:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.developer.com/img/articles/2002/12/26/03fig12.jpg">http://www.developer.com/img/articles/2002/12/26/03fig12.jpg</A>
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i> Stefan
</I>&gt;<i>
</I>&gt;<i> David Hyatt wrote:
</I>&gt;<i> &gt; I'm very reluctant to expose font metrics and information (yet).  I
</I>&gt;<i> &gt; think once you start getting into specifying fonts, you open up a can
</I>&gt;<i> &gt; of worms that would make this sort of API addition a lot harder.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; dave
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Oct 24, 2006, at 4:05 PM, Stefan Haustein wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Hi David,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I think it is very important to be able to determine the rendered
</I>&gt;<i> &gt;&gt; size of the text. Otherwise, there is no reliable way to make sure
</I>&gt;<i> &gt;&gt; things do not overlap. Also, some kinds of applications (flash-like
</I>&gt;<i> &gt;&gt; effects, labels expressing weight or distance, WYSIWYG text editors)
</I>&gt;<i> &gt;&gt; may require variable font sizes or styles.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; What do you think about
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; context.textStyle = &quot;barchart&quot;; // style by reference
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; context.textStyle = {  // set style directly
</I>&gt;<i> &gt;&gt;  &quot;font-size&quot;: &quot;8px&quot;,
</I>&gt;<i> &gt;&gt;  &quot;font-family&quot;: &quot;Monaco, monospace&quot;
</I>&gt;<i> &gt;&gt; }
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; context.drawText(x,y,string); context.getFontAscent();
</I>&gt;<i> &gt;&gt; context.getFontDescent();
</I>&gt;<i> &gt;&gt; context.getFontLeading();
</I>&gt;<i> &gt;&gt; context.getTextWidth(string);
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Best regards,
</I>&gt;<i> &gt;&gt; Stefan
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; David Hyatt wrote:
</I>&gt;<i> &gt;&gt;&gt; I think a drawText method would be extremely useful.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Rather than specifying stylistic information explicitly (via a font
</I>&gt;<i> &gt;&gt;&gt; object), I'd use a special parenthetical pseudo-element. thus
</I>&gt;<i> &gt;&gt;&gt; allowing the author to specify the style as for any other element on
</I>&gt;<i> &gt;&gt;&gt; a page.... something like this...
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; canvas::canvas-text(barchart)
</I>&gt;<i> &gt;&gt;&gt; {
</I>&gt;<i> &gt;&gt;&gt;     font-size: 8px;
</I>&gt;<i> &gt;&gt;&gt;     font-family: Monaco, monospace;
</I>&gt;<i> &gt;&gt;&gt; }
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; and then the API would be something like:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; drawText(y-coord of baseline, &quot;barchart&quot;, myText)
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; and letter-spacing/word-spacing would work, small-caps would work,
</I>&gt;<i> &gt;&gt;&gt; text-shadow would work, etc. etc.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; fitTextToPath might be an interesting API too.
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; dave
</I>&gt;<i> &gt;&gt;&gt; (<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">hyatt at apple.com</A>)
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; On Oct 23, 2006, at 4:07 PM, Stefan Haustein wrote:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt; Gervase Markham wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; Stefan Haustein wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; I think drawElement(elem) opens up a whole new can of worms:
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - how would an application determine the size of the text box?
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - where is the baseline position, needed for exact axis label
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; positioning?
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - there are probably issues with dynamically calculated text values
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - code with lots of cross references to elements will be
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; difficult to read
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - it needs to be specified whether css properties are inherited
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; from the parent element of &quot;elem&quot;.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - how much horizontal/vertical space is drawElement permitted to
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; use for rendering?
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; The answer to all of these things is that the browser renders all
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; the elements in the page as it would if the &lt;canvas&gt; were not
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; supported and the alternate content were being used. It then
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; basically screenshots the area corresponding to the element (yes,
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; I know this needs careful definition) and draws that into the
</I>&gt;<i> canvas.
</I>&gt;<i> &gt;&gt;&gt;&gt; I do not see how your statement answers any of my questions except
</I>&gt;<i> &gt;&gt;&gt;&gt; from the last one. You can specify some CSS constraints, but how do
</I>&gt;<i> &gt;&gt;&gt;&gt; you determine the actual rendering height of a text box with a
</I>&gt;<i> &gt;&gt;&gt;&gt; specific width? How do you determine the pixel position of the
</I>&gt;<i> &gt;&gt;&gt;&gt; baseline? The cross reference and the dynamic text issues are not
</I>&gt;<i> &gt;&gt;&gt;&gt; addressed at all.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; Like I said, we want to leverage the browser's deep and complex
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; knowledge of text rendering as much as possible, and just take the
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; resulting pixel output as it would be shown to the user.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - the implementation in actual browsers may be more complex than
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; it seems because of problems with internal data structures for
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; rendering hints and implicitly introducing the ability to render
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; the same element twice.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; - what happens with contained plugins, canvas elements,
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; self-references... all this stuff needs to be well-defined
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; Indeed. I know it's easy to state and there are edge cases. But we
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; could put limits on it like e.g. no plugins, no &lt;object&gt;, and
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; still have something very useful for rendering text.
</I>&gt;<i> &gt;&gt;&gt;&gt; So I assume we agree that the element rendering proposal would
</I>&gt;<i> &gt;&gt;&gt;&gt; still need significant specification work and is probably much more
</I>&gt;<i> &gt;&gt;&gt;&gt; difficult to implement. The element rendering approach may make
</I>&gt;<i> &gt;&gt;&gt;&gt; working with bulk text simpler, but this case is already handled
</I>&gt;<i> &gt;&gt;&gt;&gt; quite fine by HTML outside the Canvas element. By asking for too
</I>&gt;<i> &gt;&gt;&gt;&gt; much, we may end up with nothing at all.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt; Andrew has provided a clear and simple proposal that can easily be
</I>&gt;<i> &gt;&gt;&gt;&gt; implemented without too much consideration of side effects. Putting
</I>&gt;<i> &gt;&gt;&gt;&gt; labels on maps, precise text positioning, starwars-like 3d
</I>&gt;<i> &gt;&gt;&gt;&gt; scrolling text, labels for game characters or in physics
</I>&gt;<i> &gt;&gt;&gt;&gt; simulations, all the stuff that could only be done in a canvas
</I>&gt;<i> &gt;&gt;&gt;&gt; element, is trivial to implement with the drawText() approach, but
</I>&gt;<i> &gt;&gt;&gt;&gt; seems much more complex or impossible with the element rendering
</I>&gt;<i> &gt;&gt;&gt;&gt; approach.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; Moreover, drawElement() would not solve the drawText problem for
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt; non-browser environments such as Rhino.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; How are we anticipating &lt;canvas&gt; might be used in a non-browser
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; context?
</I>&gt;<i> &gt;&gt;&gt;&gt; Canvas and some other parts of the spec (e.g. connections) may make
</I>&gt;<i> &gt;&gt;&gt;&gt; a lot of sense for Javascript outside of the browser context.  This
</I>&gt;<i> &gt;&gt;&gt;&gt; may be outside of the scope of WHATWG, but if we can take out some
</I>&gt;<i> &gt;&gt;&gt;&gt; building blocks and use them somewhere else, this is at least a
</I>&gt;<i> &gt;&gt;&gt;&gt; sign of good and modular API design.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt; Best regards,
</I>&gt;<i> &gt;&gt;&gt;&gt; Stefan
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
    Charles Iliya Krempeaux, B.Sc.

    charles @ reptile.ca
    supercanadian @ gmail.com

    developer weblog: <A HREF="http://ChangeLog.ca/">http://ChangeLog.ca/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20061025/41178838/attachment.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20061025/41178838/attachment.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007454.html">[whatwg] Canvas lack of drawString method (p.s.)
</A></li>
	<LI>Next message: <A HREF="007456.html">[whatwg] Canvas lack of drawString method
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7455">[ date ]</a>
              <a href="thread.html#7455">[ thread ]</a>
              <a href="subject.html#7455">[ subject ]</a>
              <a href="author.html#7455">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
