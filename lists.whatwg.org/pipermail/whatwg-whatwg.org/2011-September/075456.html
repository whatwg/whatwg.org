<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal for improved handling of '#' inside of data URIs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20improved%20handling%20of%20%27%23%27%20inside%20of%20data%0A%20URIs&In-Reply-To=%3Cop.v1nd6mhc1ejg13%40vertiform346%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="075441.html">
   <LINK REL="Next"  HREF="075457.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal for improved handling of '#' inside of data URIs</H1>
<!--htdig_noindex-->
    <B>Michael A. Puls II</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20improved%20handling%20of%20%27%23%27%20inside%20of%20data%0A%20URIs&In-Reply-To=%3Cop.v1nd6mhc1ejg13%40vertiform346%3E"
       TITLE="[whatwg] Proposal for improved handling of '#' inside of data URIs">shadow2531 at gmail.com
       </A><BR>
    <I>Sun Sep 11 07:21:48 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="075441.html">[whatwg] Proposal for improved handling of '#' inside of data	URIs
</A></li>
        <LI>Next message: <A HREF="075457.html">[whatwg] Proposal for improved handling of '#' inside of data URIs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75456">[ date ]</a>
              <a href="thread.html#75456">[ thread ]</a>
              <a href="subject.html#75456">[ subject ]</a>
              <a href="author.html#75456">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Sat, 10 Sep 2011 17:15:09 -0400, Daniel Holbert &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">dholbert at mozilla.com</A>&gt;  
wrote:

&gt;<i> Browsers handle the &quot;#&quot; character in data URIs very differently, and the  
</I>&gt;<i> arguably &quot;correct&quot; behavior is probably not what authors actually want  
</I>&gt;<i> in many cases.
</I>&gt;<i>
</I>&gt;<i> This could be more intuitive/do-what-I-mean if we restricted the cases  
</I>&gt;<i> under which &quot;#&quot; is treated as a fragment-ID delimiter inside of data  
</I>&gt;<i> URIs.   In particular: when a &quot;#&quot; character is followed by &quot;&gt;&quot; or &quot;&lt;&quot; in  
</I>&gt;<i> a data URI, I propose that we *don't* treat the &quot;#&quot; as a delimiter, and  
</I>&gt;<i> instead just treat it as part of the encoded document.
</I>
Not only must &quot;#&quot; be &quot;%23&quot; if you don't want it as a frag id, but &quot;&gt;&quot; and  
&quot;&lt;&quot; should be &quot;%3E&quot; and &quot;%3C&quot;.

Encoding the data (markup for example) for the data URI is simple. Just  
use encodeURIComponent(markup) (on a UTF-8 page) in JS on the data. You  
still hand-author the markup. You just paste the markup into a textarea  
and have something (like encodeURIComponent()) percent-encode it for you.

Of course, if you can percent-encode everything needed as you type, you  
can hand-author the URI data. But, who wants to do that, except for simple  
data? It's like hand-authoring mime messages. It's not something you would  
normally do to create an email or mht file.

If you need to encode the data URI data as base64 instead, you can do  
encodeURIComponent(btoa(unescape(encodeURIComponent(markup)))); (on a  
utf-8 page).

And, there's already &lt;<A HREF="http://software.hixie.ch/utilities/cgi/data/data">http://software.hixie.ch/utilities/cgi/data/data</A>&gt;  
too.

Given that, I personally don't think browsers should be too lax with  
authors that don't properly-encode their data. Javascript URI  
(bookmarklet) authors already get away with that (even though there's  
pages like &lt;<A HREF="http://shadow2531.com/js/jsuri.html">http://shadow2531.com/js/jsuri.html</A>&gt;), but at the same time  
often run into unexpected (to them) percent-decoding of the URI data  
before it's executed.

-- 
Michael

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="075441.html">[whatwg] Proposal for improved handling of '#' inside of data	URIs
</A></li>
	<LI>Next message: <A HREF="075457.html">[whatwg] Proposal for improved handling of '#' inside of data URIs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75456">[ date ]</a>
              <a href="thread.html#75456">[ thread ]</a>
              <a href="subject.html#75456">[ subject ]</a>
              <a href="author.html#75456">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
