<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] [MIME Sniffing] Editorial feedback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BMIME%20Sniffing%5D%20Editorial%20feedback&In-Reply-To=%3CCAJE5ia_sr%3DpmTctrM%3DxEznJZz0krW_dcQpAxdTTjbYKXXNymnA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033328.html">
   <LINK REL="Next"  HREF="033330.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] [MIME Sniffing] Editorial feedback</H1>
<!--htdig_noindex-->
    <B>Adam Barth</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BMIME%20Sniffing%5D%20Editorial%20feedback&In-Reply-To=%3CCAJE5ia_sr%3DpmTctrM%3DxEznJZz0krW_dcQpAxdTTjbYKXXNymnA%40mail.gmail.com%3E"
       TITLE="[whatwg] [MIME Sniffing] Editorial feedback">w3c at adambarth.com
       </A><BR>
    <I>Wed Sep 28 16:23:25 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="033328.html">[whatwg] [MIME Sniffing] Editorial feedback
</A></li>
        <LI>Next message: <A HREF="033330.html">[whatwg] [html5] r6590 - [giow] (0) Explicitly disallow combining characters at the start of text nodes. [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75617">[ date ]</a>
              <a href="thread.html#75617">[ thread ]</a>
              <a href="subject.html#75617">[ subject ]</a>
              <a href="author.html#75617">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I've taken all of your suggestions, except as noted below.  Thanks for
your detailed feedback.

Adam


On Mon, Sep 26, 2011 at 2:27 PM, timeless &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">timeless at gmail.com</A>&gt; wrote:
&gt;&gt;<i> Otherwise, if the octets in s starting at pos match any of the sequences of octets in the first column of the following table, then the user agent MUST follow the steps given in the corresponding cell in the second column of the same row. |
</I>&gt;<i>
</I>&gt;<i> What's the stray `|` character at the end of that doing?
</I>&gt;<i>
</I>&gt;<i> The ToC feels double spaced, is that normal?
</I>&gt;<i>
</I>&gt;<i> Would you mind quoting your attributes in source? Things like
</I>&gt;<i> class=no-num or href=#web-data scare me. It's easier if you just quote
</I>&gt;<i> all attributes :)
</I>&gt;<i>
</I>&gt;<i> Also, I generally recommend `&lt;span ...&gt;x&lt;/span&gt; ` over `&lt;span ...&gt;x
</I>&gt;<i> &lt;/span&gt;` &lt;- i.e. trailing space outside of span (see toc)
</I>&gt;<i>
</I>&gt;&gt;<i> &lt;p&gt;Many web servers supply incorrect Content-Type header fields with their HTTP
</I>&gt;<i>
</I>&gt;<i> Can you mark up `Content-Type` in something which results in roughly
</I>&gt;<i> &quot;typewriter&quot; font?
</I>&gt;<i>
</I>&gt;<i> s/user agents/User Agents/ as in:
</I>&gt;&gt;<i> responses. &#160;In order to be compatible with these servers, user agents consider
</I>&gt;<i>
</I>&gt;&gt;<i> Without a clear specification of how to &quot;sniff&quot; the media type, each user agent implementor was forced to reverse engineer the behavior of the other user agents and to develop
</I>&gt;<i>
</I>&gt;<i> s/the other/other/ -- there are some UAs who were ignored when the
</I>&gt;<i> sniffing of a given UA was developed :)
</I>&gt;<i>
</I>&gt;&gt;<i> their own algorithm
</I>&gt;<i>
</I>&gt;<i> I'm not sure if `algorithm` here belongs in singular or plural, I got
</I>&gt;<i> distracted :)
</I>&gt;<i>
</I>&gt;&gt;<i> an HTTP response to be interpreted as one media type but some user agents interpret the responses as another media type.
</I>&gt;<i>
</I>&gt;<i> s/responses/response/ (agreement with first part)
</I>&gt;<i>
</I>&gt;&gt;<i> However, if a user agent does interpret a low-privilege media type, such as image/gif, as a high-privilege media type, such as text/html, the user agent has created a privilege escalation vulnerability in the server.
</I>&gt;<i>
</I>&gt;<i> s/, the user agent/, then the user agent/
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I believe abarth has addressed the above.
</I>&gt;<i>
</I>&gt;&gt;<i> This document describes a content sniffing algorithm that carefully balances the compatibility needs of user agent implementors with the security constraints.
</I>&gt;<i>
</I>&gt;<i> `the security constraints` is problematic, I don't think `the`
</I>&gt;<i> references anything
</I>&gt;<i> so either drop `the`, or provide a reference :/
</I>&gt;<i>
</I>&gt;&gt;<i> and metrics collected from implementations deployed to a sizable number of users .
</I>&gt;<i>
</I>&gt;<i> s/ ././
</I>
There's actually a reference that goes there.  I just haven't figured
out how to do references yet.

&gt;&gt;<i> (such as &quot;strip any leading space characters&quot; or &quot;return false and abort these steps&quot;) are to be interpreted with the meaning of the key word (&quot;MUST&quot;, &quot;SHOULD&quot;, &quot;MAY&quot;, etc)
</I>&gt;<i>
</I>&gt;<i> s/etc/etc./g
</I>&gt;<i>
</I>&gt;<i> &quot;official-type&quot; should probably be given some styling -- preferably
</I>&gt;<i> not the same styling as &quot;Content-Type&quot;
</I>&gt;<i>
</I>&gt;&gt;<i> (Such messages are invalid according to RFC2616.
</I>&gt;<i>
</I>&gt;<i> s/./.)/
</I>&gt;<i>
</I>&gt;<i> The rfcs should be href references of some sort :)
</I>
Yeah, I need to crack the references problem at some point.  :)

&gt;&gt;<i> For octets received via HTTP, the Content-Type HTTP header field, if present, indicates the media type. Let the official-type be the media type indicted by the HTTP Content-Type header field, if present. If the Content-Type header field is absent or if its value cannot be interpreted as a media type (e.g. because its value doesn't contain a U+002F SOLIDUS ('/') character), then there is no official-type. (Such messages are invalid according to RFC2616.
</I>&gt;<i>
</I>&gt;&gt;<i> If an HTTP response contains multiple Content-Type header fields, the User Agent MUST use the textually last Content-Type header field to the official-type. For example, if the last Content-Type header field contains the value &quot;foo&quot;, then there is no official media type because &quot;foo&quot; cannot be interpreted as a media type (even if the HTTP response contains another Content-Type header field that could be interpreted as a media type).
</I>&gt;<i>
</I>&gt;<i> The for example part here applies to the previous paragraph, the
</I>&gt;<i> sentence needs to be moved to the paragraph before the instruction for
</I>&gt;<i> multiple header fields.
</I>
It's an example that combines both rules.

&gt;&gt;<i> FTP RFC0959
</I>&gt;<i>
</I>&gt;<i> Is there a reason for the leading 0?
</I>&gt;<i>
</I>&gt;&gt;<i> Comparisons between media types, as defined by MIME specifications, are done in an ASCII case-insensitive manner. [RFC2046]
</I>&gt;<i>
</I>&gt;<i> You need to somehow note that this is merely a note about mime
</I>&gt;<i> equivalence and doesn't relate to how the spec works.
</I>
I'm not sure I understand.  It's in green and labeled as a &quot;note&quot;.

&gt;&gt;<i> If the official-type ends in &quot;+xml&quot;, or if it is either &quot;text/xml&quot; or &quot;application/xml&quot;, then let the sniffed-type be the official-type and abort these steps.
</I>&gt;<i>
</I>&gt;<i> Please mark up `sniffed-type` and `official-type`
</I>&gt;<i>
</I>&gt;&gt;<i> If the official-type is an image type supported by the User Agent (e.g., &quot;image/png&quot;, &quot;image/gif&quot;, &quot;image/jpeg&quot;, etc), then jump to the &quot;images&quot; section below.
</I>&gt;<i>
</I>&gt;<i> s/etc//
</I>&gt;<i>
</I>&gt;&gt;<i> If none of the first n octets are binary data octets then let the sniffed-type be &quot;text/plain&quot; and abort these steps.
</I>&gt;&gt;<i> Binary Data Byte Ranges
</I>&gt;<i>
</I>&gt;<i> You don't actually define a `binary data octet` as any item within the
</I>&gt;<i> ranges defined in the `binary data byte ranges`.
</I>&gt;<i>
</I>&gt;&gt;<i> If the first octets match one of the octet sequences in the &quot;pattern&quot; column of the table in the &quot;unknown type&quot; section below, ignoring any rows whose cell in the &quot;security&quot; column says &quot;scriptable&quot; (or &quot;n/a&quot;), then let the sniffed-type be the type given in the corresponding cell in the &quot;sniffed type&quot; column on that row and abort these steps.
</I>&gt;<i>
</I>&gt;<i> If you could make `&quot;unknown type&quot; section` a link to the section, that
</I>&gt;<i> would be helpful.
</I>&gt;<i>
</I>&gt;&gt;<i> For each row in the table below:
</I>&gt;&gt;<i> If the row has no &quot;WS&quot; octets:
</I>&gt;<i>
</I>&gt;<i> I know that &quot;WS&quot; appears in the table below, but it hasn't been
</I>&gt;<i> defined yet, and I don't want to guess what it means (whitespace?) --
</I>&gt;<i> I guessed wrong for the other one.
</I>&gt;<i>
</I>&gt;&gt;<i> If the row has a &quot;WS&quot; octet or a &quot;_&gt;&quot; octet:
</I>&gt;<i>
</I>&gt;&gt;<i> &quot;WS&quot; means &quot;whitespace&quot;, and allows insignificant whitespace to be skipped when sniffing for a type signature.
</I>&gt;<i>
</I>&gt;<i> Oh, so that's where you hid the definition -- way too late :)
</I>&gt;<i>
</I>&gt;&gt;<i> &quot;_&gt;&quot; means &quot;space-or-bracket&quot;, and allows HTML tag names to terminate with either a space or a greater than sign.
</I>&gt;<i>
</I>&gt;<i> Oh _ doesn't mean underscore
</I>&gt;<i>
</I>&gt;<i> Please put those definitions before their use, not way below their use :(
</I>
I'm tempted to just rename them to be less semantic.  They're just
symbols that don't mean anything, really.

&gt;&gt;<i> If the octets of the masked-data matches the given pattern octets exactly, then let the sniffed-type be the type given in the cell of the third column in that row and abort these steps.
</I>&gt;<i>
</I>&gt;<i> s/matches/match/
</I>&gt;<i>
</I>&gt;&gt;<i> LOOP: If index-stream points beyond the end of the octet stream, then this row doesn't match and skip this row.
</I>&gt;<i>
</I>&gt;<i> Please style `LOOP`
</I>&gt;<i>
</I>&gt;&gt;<i> If the index-pattern-th octet of the pattern is a normal hexadecimal octet and not a &quot;WS&quot; octet or a &quot;_&gt;&quot; octet:
</I>&gt;<i>
</I>&gt;<i> s/or a/nor a/
</I>&gt;<i> s/not/neither/
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> If the index-stream-th octet of the stream is one of 0x09 (ASCII TAB), 0x0A (ASCII LF), 0x0C (ASCII FF), 0x0D (ASCII CR), or 0x20 (ASCII space), then increment only the index-stream to the next octet in the octet stream.
</I>&gt;<i>
</I>&gt;<i> If you could style the 0xXX items in something &lt;tt&gt;-ish, that'd be appreciated.
</I>&gt;<i> ... And if you could style the names (ASCII TAB, etc.) in something,
</I>&gt;<i> that'd also be appreciated.
</I>
That's a lot of editing!  I'm not sure that buys us much.

&gt;&gt;<i> If the first n octets match the signature for MP4 (as define in ), then let the sniffed-type be video/mp4 and abort these steps.
</I>&gt;<i>
</I>&gt;<i> s/define/defined/
</I>&gt;<i>
</I>&gt;<i> -- The markup you're using failed to generate a visible-reference,
</I>&gt;<i> could you get the tool to generate an XXX when it fails? :)
</I>&gt;<i>
</I>&gt;&gt;<i> FF FF FF FF FF FF WS 3C 3f 78 6d 6c text/xml Scriptable &lt;?xml (Note the case sensitivity and lack of trailing _&gt;)
</I>&gt;<i>
</I>&gt;<i> s/sensitivity/sensitivity [mask = FF instead of DF]/
</I>&gt;<i>
</I>&gt;&gt;<i> A JPEG SOI marker followed by a octet of another marker.
</I>&gt;<i>
</I>&gt;<i> s/a octet/an octet/
</I>&gt;<i>
</I>&gt;<i> -- the table doesn't currently handle .SWF; in the past, that has been a problem
</I>&gt;<i> <A HREF="http://www.digitalpreservation.gov/formats/fdd/fdd000130.shtml">http://www.digitalpreservation.gov/formats/fdd/fdd000130.shtml</A>
</I>
That is intentional.  Sniffing SWF is bad times.

&gt;&gt;<i> If n is less than 4, then the sequence does not match the signature for MP4 and abort these steps.
</I>&gt;<i>
</I>&gt;<i> `and` doesn't work; s/ and/;/ ?
</I>&gt;<i>
</I>&gt;<i> In all previous cases, the form was `let foo and abort these steps`;
</I>&gt;<i> here it's `then &lt;statement of truth&gt; and`.
</I>&gt;<i>
</I>&gt;<i> The fix is probably to move to &quot;return TRUTH/FALSE value and abort
</I>&gt;<i> these steps&quot; (or let state-determined-truth-value-be TRUTH/FASLE value
</I>&gt;<i> and ...).
</I>
Hum...  I see the problem.

&gt;&gt;<i> For each I from 2 to box-size/4 - 1 (inclusive):
</I>&gt;<i>
</I>&gt;<i> If you could put `box-size/4 - 1` into some markup to indicate that
</I>&gt;<i> it's a math section, that'd be helpful.
</I>
I put it in &lt;code&gt;.  I'm not sure that's the prettiest, but we can iterate.

&gt;&gt;<i> If octets 4*i through 4*i + 2 (inclusive) of the sequence are 0x6D 0x70 0x34 (the ASCII string &quot;mp4&quot;), then the sequence does match the signature for MP4 and abort these steps.
</I>&gt;<i>
</I>&gt;<i> And here for `4*i` and `4*i + 2`
</I>&gt;<i>
</I>&gt;<i> I think you need s/If octets/If any octets/, otherwise, it's ambiguous
</I>&gt;<i> between `any` and `all`.
</I>&gt;<i>
</I>&gt;&gt;<i> 7 Images
</I>&gt;<i> ...
</I>&gt;&gt;<i> &#160; &#160; Otherwise, let the sniffed-type be the official-type and abort these steps.
</I>&gt;<i>
</I>&gt;<i> I'd rather otherwise be step 3 instead of part of the bulleted list
</I>&gt;<i> inside step 2
</I>
:<i>)
</I>
&gt;&gt;<i> If the octets with positions pos to pos+2 in s are exactly equal to 0x2D, 0x2D, 0x3E respectively (ASCII for &quot;--&gt;&quot;), then increase pos by 3 and jump back to the previous step (the step labeled loop start) in the overall algorithm in this section.
</I>&gt;<i>
</I>&gt;<i> `loop start` should be a link to the LOOP label and preferably have
</I>&gt;<i> the same case as the LOOP label.
</I>&gt;<i>
</I>&gt;&gt;<i> Return to step 2 in these substeps.
</I>&gt;<i>
</I>&gt;<i> It'd be nice if this was a link to an anchor in the right part of the steps.
</I>&gt;<i>
</I>&gt;&gt;<i> If RDF-flag is 1 and RSS-flag is 1, then let the sniffed-type be &quot;application/rss+xml&quot; and abort these steps.
</I>&gt;<i>
</I>&gt;<i> s/and/or/ ??
</I>
and is correct.  I've made it strong.  It's got to have both qualities
before we'll change the type.

Adam

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033328.html">[whatwg] [MIME Sniffing] Editorial feedback
</A></li>
	<LI>Next message: <A HREF="033330.html">[whatwg] [html5] r6590 - [giow] (0) Explicitly disallow combining characters at the start of text nodes. [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75617">[ date ]</a>
              <a href="thread.html#75617">[ thread ]</a>
              <a href="subject.html#75617">[ subject ]</a>
              <a href="author.html#75617">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
