<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Canvas 2D memory management
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%202D%20memory%20management&In-Reply-To=%3CCAGN7qDDTvU7%2BstaUdSmH9H7%3Di2p-4jZ6vbN7ZkpMBYRYcBs4pA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="080926.html">
   <LINK REL="Next"  HREF="080931.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Canvas 2D memory management</H1>
<!--htdig_noindex-->
    <B>Rik Cabanier</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%202D%20memory%20management&In-Reply-To=%3CCAGN7qDDTvU7%2BstaUdSmH9H7%3Di2p-4jZ6vbN7ZkpMBYRYcBs4pA%40mail.gmail.com%3E"
       TITLE="[whatwg] Canvas 2D memory management">cabanier at gmail.com
       </A><BR>
    <I>Fri Jan 11 14:56:41 PST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="080926.html">[whatwg] Canvas 2D memory management
</A></li>
        <LI>Next message: <A HREF="080931.html">[whatwg] Canvas 2D memory management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80927">[ date ]</a>
              <a href="thread.html#80927">[ thread ]</a>
              <a href="subject.html#80927">[ subject ]</a>
              <a href="author.html#80927">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Fri, Jan 11, 2013 at 2:36 PM, Robert O'Callahan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt;wrote:

&gt;<i> On Sat, Jan 12, 2013 at 6:41 AM, Rik Cabanier &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cabanier at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Some of you concerns with memory management could be addressed with
</I>&gt;&gt;<i> WeakMaps.
</I>&gt;&gt;<i> Basically, you can put all your images in a WeakMap and during the draw
</I>&gt;&gt;<i> cycle, you pull them out and use them. If they're no longer there, it
</I>&gt;&gt;<i> meant
</I>&gt;&gt;<i> that the garbage collector has kicked in to free up memory and you need to
</I>&gt;&gt;<i> reload (which will unfortunately cause a jank). I'm unsure how smart the
</I>&gt;&gt;<i> garbage collector is because you probably want the items in the WeakMaps
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> be deleted last.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> WeakMaps don't work like that. You can only test whether something is in a
</I>&gt;<i> WeakMap by looking it up with a key object. If the key object stays alive
</I>&gt;<i> and the WeakMap stays alive, then the value must also stay alive. On other
</I>&gt;<i> hand, if the key object or the WeakMap have been collected, obviously you
</I>&gt;<i> can't do the lookup. So you can't observe whether GC has happened using a
</I>&gt;<i> WeakMap. (This is by design.)
</I>&gt;<i>
</I>&gt;<i> Sorry about that!
</I>yes, you are correct that you can't use it that way.

Someone told me that WeakMaps work the same way as Flash's dictionary with
weak keys, but that is not the case.

FWIW, flash game developers use dictionaries with 'weak keys' as I
described earlier. If the memory runs low, the garbage collector will
delete objects from that cache.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="080926.html">[whatwg] Canvas 2D memory management
</A></li>
	<LI>Next message: <A HREF="080931.html">[whatwg] Canvas 2D memory management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80927">[ date ]</a>
              <a href="thread.html#80927">[ thread ]</a>
              <a href="subject.html#80927">[ subject ]</a>
              <a href="author.html#80927">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
