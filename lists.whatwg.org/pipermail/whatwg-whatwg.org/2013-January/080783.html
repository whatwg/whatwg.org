<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] ProgressEvents for Images
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20ProgressEvents%20for%20Images&In-Reply-To=%3CCABirCh-9csUUhLJJey1KkOa2Ox%2Bm5LzWnQm14XUASFSJb7%2Bo-g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038506.html">
   <LINK REL="Next"  HREF="080784.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] ProgressEvents for Images</H1>
<!--htdig_noindex-->
    <B>Glenn Maynard</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20ProgressEvents%20for%20Images&In-Reply-To=%3CCABirCh-9csUUhLJJey1KkOa2Ox%2Bm5LzWnQm14XUASFSJb7%2Bo-g%40mail.gmail.com%3E"
       TITLE="[whatwg] ProgressEvents for Images">glenn at zewt.org
       </A><BR>
    <I>Thu Jan  3 17:42:24 PST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="038506.html">[whatwg] ProgressEvents for Images
</A></li>
        <LI>Next message: <A HREF="080784.html">[whatwg] ProgressEvents for Images
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80783">[ date ]</a>
              <a href="thread.html#80783">[ thread ]</a>
              <a href="subject.html#80783">[ subject ]</a>
              <a href="author.html#80783">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, Jan 3, 2013 at 6:49 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:

&gt;<i> &gt; As an aside, it's odd that if images are unsupported or disabled, no
</I>&gt;<i> &gt; event is fired at all (&quot;update the image data&quot;, step 4).  That means
</I>&gt;<i> &gt; that if you do this:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; var url = URL.createObjectURL(blob);
</I>&gt;<i> &gt; img.src = url;
</I>&gt;<i> &gt; img.onload = img.onerror = function(e) { URL.revokeObjectURL(url); }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; the blob will leak a reference if images are disabled.  This seems like
</I>&gt;<i> &gt; a very easy mistake to make, with no clean workaround...
</I>&gt;<i>
</I>&gt;<i> It'd be pretty sad to use up all that bandwidth for no reason...
</I>&gt;<i>
</I>
Loading the image and discarding the data isn't an option, of course--the
very reason some people disable images is to save bandwidth.

It might make sense to fire onerror if the image doesn't get loaded because
images are disabled.  Guaranteeing (or coming closer to guaranteeing, at
least) that onload or onerror will always be fired would reduce the
differences in event flow when images are disabled.

The particular case above should be fixed, at least in the most common
cases, by auto-revoking blobs, since you'll no longer need to carefully
call revokeObjectURL.  (I've come to the conclusion that
URL.revokeObjectURL was a very badly flawed idea, since it introduces
manual resource management in a platform not designed for it.)

-- 
Glenn Maynard

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038506.html">[whatwg] ProgressEvents for Images
</A></li>
	<LI>Next message: <A HREF="080784.html">[whatwg] ProgressEvents for Images
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#80783">[ date ]</a>
              <a href="thread.html#80783">[ thread ]</a>
              <a href="subject.html#80783">[ subject ]</a>
              <a href="author.html#80783">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
