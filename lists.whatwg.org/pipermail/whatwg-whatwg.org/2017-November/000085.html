<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20DOM%20Feature%20Mod%3A%20Add%20metering%20/%20parallelism%20%26%0A%20throttling%20options%20to%20AddEventListenerOptions&In-Reply-To=%3CCAPP4rD9%2BcMkoaPXJ13DZ%2BTnQpqvSeJTOOQkybuAr-QYeXNKkWg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000084.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions</H1>
<!--htdig_noindex-->
    <B>Jonathan Zuckerman</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20DOM%20Feature%20Mod%3A%20Add%20metering%20/%20parallelism%20%26%0A%20throttling%20options%20to%20AddEventListenerOptions&In-Reply-To=%3CCAPP4rD9%2BcMkoaPXJ13DZ%2BTnQpqvSeJTOOQkybuAr-QYeXNKkWg%40mail.gmail.com%3E"
       TITLE="[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions">j.zuckerman at gmail.com
       </A><BR>
    <I>Tue Nov 28 04:05:09 PST 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000084.html">[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85">[ date ]</a>
              <a href="thread.html#85">[ thread ]</a>
              <a href="subject.html#85">[ subject ]</a>
              <a href="author.html#85">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>&gt;<i>From my own experience, only about half of the times I&#8217;ve required debounce
</I>or throttle has been related to event handling, so if your proposal was
accepted I&#8217;d still need to include a library to satisfy the other scenarios.
On Tue, Nov 28, 2017 at 00:01 Sylon Zero &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">sylonzero at gmail.com</A>&gt; wrote:

&gt;<i> I think libraries having those functions emphasizes the point here, as
</I>&gt;<i> that validates the existence and need for those patterns which then raises
</I>&gt;<i> the requirement: should this be native to the browser?
</I>&gt;<i>
</I>&gt;<i> I believe the answer is yes, given how much work has already been put into
</I>&gt;<i> standardizing the resource/computation model around the browser (web
</I>&gt;<i> workers, local storage, etc) which is architecturally, IMHO, a related
</I>&gt;<i> effort. Those capabilities come to life when there are smarter ways to
</I>&gt;<i> utilize and route work to them through built-in features related to
</I>&gt;<i> processing events/messages. In an effort to not create a science project
</I>&gt;<i> out of some sort of top-down attack on this requirement, a simple
</I>&gt;<i> middle-out approach with immediate results would be to extend the
</I>&gt;<i> eventListener behavior that is prevalent in both browser and node.js
</I>&gt;<i> scenarios.
</I>&gt;<i>
</I>&gt;<i> The case I am making first and foremost is that these recognizable
</I>&gt;<i> patterns will be increasingly requisite (and not an after-thought, to be
</I>&gt;<i> brought in via Underscore) in building web apps in the near term as web app
</I>&gt;<i> complexity &amp; use has increased dramatically with multiple cloud-scale
</I>&gt;<i> offerings running in the SaaS space (think Netflix, LinkedIn, Facebook,
</I>&gt;<i> Slack, etc) and more being built in various startups &amp; emerging
</I>&gt;<i> businesses. If the browser is to gain parity as an Application Platform
</I>&gt;<i> allowing the development of web applications to rival native ones, then the
</I>&gt;<i> ability to deal with volatile/durable messaging and events, storage and
</I>&gt;<i> routing of work should be a core capability.
</I>&gt;<i>
</I>&gt;<i> *Broader implications:*
</I>&gt;<i> If I may, let me add that I also think there is a growing confluence
</I>&gt;<i> between the hybrid desktop app and browser-based SPAs (the Electron
</I>&gt;<i> framework and its numerous successful projects like Atom, Slack, Visual
</I>&gt;<i> Studio Code are great examples) and if the browser is to continue to evolve
</I>&gt;<i> as a platform to encourage this trend (which is fabulous for the web
</I>&gt;<i> community), then investments must be made to extend / normalize the browser
</I>&gt;<i> standards in much the same way that the concept of a standardized
</I>&gt;<i> Application Server helped standardize app architectures. This implies a
</I>&gt;<i> future with registration of libraries/components (managed code), better
</I>&gt;<i> local storage/caching options, improved integration with security contexts
</I>&gt;<i> (per O/S), and likely much more. At least, I think it does :-).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, Nov 27, 2017 at 6:48 PM, Jonathan Zuckerman &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">j.zuckerman at gmail.com</A>
</I>&gt;<i> &gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> You&#8217;re probably aware there are libraries that offer functionality of
</I>&gt;&gt;<i> this sort (debounce and throttle in underscore/lodash is the one I&#8217;m most
</I>&gt;&gt;<i> familiar with) and the web community seems content to add a small
</I>&gt;&gt;<i> dependency when such functionality is required. How would you convince
</I>&gt;&gt;<i> browser vendors to implement this?
</I>&gt;&gt;<i> On Mon, Nov 27, 2017 at 18:05 Sylon Zero &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">sylonzero at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> *Core Problem Statement* Processor functions that subscribe to events
</I>&gt;&gt;&gt;<i> via a
</I>&gt;&gt;&gt;<i> topic string may need to be prioritized for processing based on the topic
</I>&gt;&gt;&gt;<i> itself. Conversely, certain events may be more numerous but should not
</I>&gt;&gt;&gt;<i> limit the ability of the JS environment to respond and process other
</I>&gt;&gt;&gt;<i> events, that may be more critical to either the User Experience (UX) or
</I>&gt;&gt;&gt;<i> integrity of the system (e.g. events that trigger saving data to a
</I>&gt;&gt;&gt;<i> back-end).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> *Background Information* As Browser/CommonJS environments bring paradigms
</I>&gt;&gt;&gt;<i> like UI event handling and back-end event handling into the same problem
</I>&gt;&gt;&gt;<i> space, it is useful to apply common patterns used in Message-based
</I>&gt;&gt;&gt;<i> Publish-Subscribe environments with message brokers, which is what the JS
</I>&gt;&gt;&gt;<i> execution context often behaves as. The use case here is to ensure that
</I>&gt;&gt;&gt;<i> one
</I>&gt;&gt;&gt;<i> kind of event (e.g. event listeners for a &#8216;mouseMove&#8217; event) don&#8217;t
</I>&gt;&gt;&gt;<i> saturate
</I>&gt;&gt;&gt;<i> or delay execution of other events (e.g. &#8216;dataAvailableForAutosave&#8217;) due
</I>&gt;&gt;&gt;<i> to
</I>&gt;&gt;&gt;<i> massive differences in event volume or conversely, expensive operations
</I>&gt;&gt;&gt;<i> that block the execution thread in question.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> *Proposed Solution* Add metering options to the addEventListener
</I>&gt;&gt;&gt;<i> *Options* configuration
</I>&gt;&gt;&gt;<i> object. These options control how the JS execution environment controls
</I>&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;<i> throttling/firing of event handler instances in response to events that
</I>&gt;&gt;&gt;<i> match the topic string of the subscription created by addEventListener.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Proposed options:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>    - maxInstances [Number / Function] used to decide how many event
</I>&gt;&gt;&gt;<i>    listeners can be invoked before throttling occurs. Throttling does
</I>&gt;&gt;&gt;<i> not lose
</I>&gt;&gt;&gt;<i>    events but simply queues them.
</I>&gt;&gt;&gt;<i>    - throttlingQueueLength [Number] used to maintain an in-memory queue
</I>&gt;&gt;&gt;<i> of
</I>&gt;&gt;&gt;<i>    un-processed events per Topic string, after throttling kicks in.
</I>&gt;&gt;&gt;<i>    - throttlingQueuePolicy [String] Values could be exception - throws an
</I>&gt;&gt;&gt;<i>    exception when the queue length is exceeded, rolling - drops the
</I>&gt;&gt;&gt;<i> oldest
</I>&gt;&gt;&gt;<i>    events and pushes newer ones into the queue, expand- allow the queue
</I>&gt;&gt;&gt;<i> to
</I>&gt;&gt;&gt;<i>    expand to cover all events.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> *Additional Options* It might be even more useful if the options allowed
</I>&gt;&gt;&gt;<i> targeting or creation of Web Workers (or Node child processes, depending
</I>&gt;&gt;&gt;<i> on
</I>&gt;&gt;&gt;<i> the execution context) based on the event handler configuration. This
</I>&gt;&gt;&gt;<i> could
</I>&gt;&gt;&gt;<i> potentially target CPU cores and/or O/S child processes / threads
</I>&gt;&gt;&gt;<i> (depending on the O/S terminology for parallel execution).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> *Related Thread* The proposal identified in the link below (by &#352;ime
</I>&gt;&gt;&gt;<i> Vidas) could
</I>&gt;&gt;&gt;<i> be part of this solution as it defines other metering options around
</I>&gt;&gt;&gt;<i> debounce (which improves scale around event handling, which is in the
</I>&gt;&gt;&gt;<i> same
</I>&gt;&gt;&gt;<i> problem space) and handling throttling through frequency, which should be
</I>&gt;&gt;&gt;<i> one of the alternatives in addition to my proposal above (as I believe
</I>&gt;&gt;&gt;<i> they
</I>&gt;&gt;&gt;<i> are orthogonal): <A HREF="https://discourse.wicg.io/t/add-event-throttlin">https://discourse.wicg.io/t/add-event-throttlin</A>
</I>&gt;&gt;&gt;<i> g-and-debouncing-to-addeventlisteneroptions/2436/19
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Sai Prakash
</I>&gt;&gt;&gt;<i> @SylonZero
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000084.html">[whatwg] DOM Feature Mod: Add metering / parallelism &amp; throttling options to AddEventListenerOptions
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#85">[ date ]</a>
              <a href="thread.html#85">[ thread ]</a>
              <a href="subject.html#85">[ subject ]</a>
              <a href="author.html#85">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
