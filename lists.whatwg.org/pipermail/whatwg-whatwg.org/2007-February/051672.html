<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Expected behaviour when a &lt;base&gt; is within an	innerHTML fragment
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Expected%20behaviour%20when%20a%20%3Cbase%3E%20is%20within%20an%0A%09innerHTML%20fragment&In-Reply-To=%3C51ABCD84-83DE-4AE5-B401-F1FB99DBEFFC%40googlemail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="051669.html">
   <LINK REL="Next"  HREF="051673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Expected behaviour when a &lt;base&gt; is within an	innerHTML fragment</H1>
<!--htdig_noindex-->
    <B>Geoffrey Sneddon</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Expected%20behaviour%20when%20a%20%3Cbase%3E%20is%20within%20an%0A%09innerHTML%20fragment&In-Reply-To=%3C51ABCD84-83DE-4AE5-B401-F1FB99DBEFFC%40googlemail.com%3E"
       TITLE="[whatwg] Expected behaviour when a &lt;base&gt; is within an	innerHTML fragment">foolistbar at googlemail.com
       </A><BR>
    <I>Sun Feb 11 07:14:01 PST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="051669.html">[whatwg] Expected behaviour when a &lt;base&gt; is within an	innerHTML fragment
</A></li>
        <LI>Next message: <A HREF="051673.html">[whatwg] Expected behaviour when a &lt;base&gt; is within an	innerHTML fragment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51672">[ date ]</a>
              <a href="thread.html#51672">[ thread ]</a>
              <a href="subject.html#51672">[ subject ]</a>
              <a href="author.html#51672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 11 Feb 2007, at 11:37, Jorgen Horstink wrote:
&gt;<i> On Feb 11, 2007, at 12:01 PM, Geoffrey Sneddon wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> To take this from a discussion last month on atom-syntax:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What is meant to happen if you set innerHTML of a &lt;div&gt; where the  
</I>&gt;&gt;<i> set value has both a &lt;base&gt; and an &lt;a&gt;?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> first of all the &lt;base&gt; element can only be inserted in HTML  
</I>&gt;<i> documents.
</I>
That's perfectly fine&#8230; If you have control over the content being  
inserted.

&gt;<i> The spec states that there can only be one &lt;base&gt; element. The  
</I>&gt;<i> &lt;base&gt; element must  be used before any elements that use relative  
</I>&gt;<i> URI's.
</I>
Sure, there MUST only be one, and in &lt;head&gt;, but as the parsing  
section dictates, if there is one in &lt;body&gt; it gets moved into  
&lt;head&gt;. It also, as stands, leaves it possible for the parser to  
place multiple &lt;base&gt; elements in &lt;head&gt;.

&gt;<i>
</I>&gt;<i> If the insertion mode is &quot;in body&quot; handle the token as follows:
</I>&gt;<i>       A start tag token whose tag name is one of: &quot;base&quot;, &quot;link&quot;,  
</I>&gt;<i> &quot;meta&quot;, &quot;title&quot;
</I>&gt;<i>       Parse error. Process the token as if the insertion mode had  
</I>&gt;<i> been &quot;in head&quot;. [1]
</I>&gt;<i>
</I>&gt;<i> So inserting a &lt;base&gt; element in the body results in a parse error.
</I>&gt;<i>
</I>&gt;<i> [1] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/#how-to0">http://www.whatwg.org/specs/web-apps/current-work/#how-to0</A>
</I>
As Anne has already said, the spec says how to deal with parse errors  
(they aren't fatal errors, as parsing continues as normal). Also, as  
what you quote says, the element gets inserted &quot;in head&quot;.

The point is whether it:
	a) Gets inserted into the &lt;head&gt;, and changes all the links in the  
document.
	b) Appears in some magic place, and changes the links in the HTML  
fragment.
	c) Gets ignored.

I'm personally in favour of b), as using the normal parsing rules  
(placing it in &lt;head&gt;) may well end up changing more than what is  
wanted. I'll do some testing of current implementations later.

- Geoffrey Sneddon

(I accidentally sent this to just Jorgen! Sorry!)


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="051669.html">[whatwg] Expected behaviour when a &lt;base&gt; is within an	innerHTML fragment
</A></li>
	<LI>Next message: <A HREF="051673.html">[whatwg] Expected behaviour when a &lt;base&gt; is within an	innerHTML fragment
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51672">[ date ]</a>
              <a href="thread.html#51672">[ thread ]</a>
              <a href="subject.html#51672">[ subject ]</a>
              <a href="author.html#51672">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
