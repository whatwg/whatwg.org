<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Access to live/raw audio and video stream data from both local and remote sources
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Access%20to%20live/raw%20audio%20and%20video%20stream%20data%20from%0A%20both%20local%20and%20remote%20sources&In-Reply-To=%3C1314169092.31109.73475.camel%40robslapu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032975.html">
   <LINK REL="Next"  HREF="032977.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Access to live/raw audio and video stream data from both local and remote sources</H1>
<!--htdig_noindex-->
    <B>Rob Manson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Access%20to%20live/raw%20audio%20and%20video%20stream%20data%20from%0A%20both%20local%20and%20remote%20sources&In-Reply-To=%3C1314169092.31109.73475.camel%40robslapu%3E"
       TITLE="[whatwg] Access to live/raw audio and video stream data from both local and remote sources">roBman at mob-labs.com
       </A><BR>
    <I>Tue Aug 23 23:58:12 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="032975.html">[whatwg] Access to live/raw audio and video stream data from both local and remote sources
</A></li>
        <LI>Next message: <A HREF="032977.html">[whatwg] add html-attribute for &quot;responsive images&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75249">[ date ]</a>
              <a href="thread.html#75249">[ thread ]</a>
              <a href="subject.html#75249">[ subject ]</a>
              <a href="author.html#75249">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Stefan,

thanks for your reply and following up...this all sounds good.
Especially the alignment with the Audio WG.  I'd love to see some
resolution on the Web Audio vs Audio Data proposals.

By &quot;raw&quot; I was just clumsily referring to being able to access the data
within the tracks within the stream programmatically.

Here's a very clumsy example I created that shows the type of access I
mean <A HREF="http://robman.com.au/using-live-audio-data-to-drive-your-css-in-ht">http://robman.com.au/using-live-audio-data-to-drive-your-css-in-ht</A>
Obviously this uses the non-standard Mozilla Audio Data API.

At the moment you can do a similar-ish thing with video by pumping it
into a canvas element then using getImageData...but this is a bit of a
clumsy and inefficient pipeline.

Ideally we could programmatically reach into the stream data of any of
the video and audio tracks to process the data in any number of ways
including signal analysis, image recognition, dynamic interface
creation, etc.

In fact I'm presenting at a conference on Friday on just that topic
<A HREF="http://uxaustralia.com.au/conference-2011/is-that-sense-able">http://uxaustralia.com.au/conference-2011/is-that-sense-able</A>

I think the Khronos StreamInput work has this type of thing in mind too
so I wonder if that's also been discussed within the RTC/DAP/Audio WGs?


roBman

PS: I am really concerned about being labelled as a &quot;cross posting spam
king&quot; so I apologise for creating any of these cross posting storms.
However, it really seems like the best way to make sure that this
cross-group discussion is shared with all the relevant groups.


On Wed, 2011-08-24 at 08:39 +0200, Stefan H&#229;kansson LK wrote:
&gt;<i> Rob,
</I>&gt;<i> 
</I>&gt;<i> I'm sorry for the late answer. The W3C DAP and WebRTC chairs have 
</I>&gt;<i> discussed this, and come to the following:
</I>&gt;<i> 
</I>&gt;<i> - The WebRTC WG deals with access to live (audio and video) streams, and 
</I>&gt;<i> also currently have support for local recording of them in the API 
</I>&gt;<i> proposal [1].
</I>&gt;<i> 
</I>&gt;<i> - DAP has a note about the &lt;device&gt; element in the HTML Media Capture 
</I>&gt;<i> draft, but the &lt;device&gt; element has been replaced by &quot;getUserMedia&quot; [1].
</I>&gt;<i> 
</I>&gt;<i> - In the WebRTC charter there are references to DAP regarding device 
</I>&gt;<i> exploration and media capturing as that was deemed as in DAP scope at 
</I>&gt;<i> the time of writing the WebRTC charter. This has however since been 
</I>&gt;<i> resolved, for media streams this will be handled by WebRTC.
</I>&gt;<i> 
</I>&gt;<i> - WebRTC is planning coordination with the Audio WG to ensure alignment 
</I>&gt;<i> regarding media streams.
</I>&gt;<i> 
</I>&gt;<i> A question: what do you mean by &quot;raw&quot; audio and video stream data? The 
</I>&gt;<i> MediaStreams discussed in WebRTC are more of logical references (which 
</I>&gt;<i> you can attach to audio/video elements for rendering, to a 
</I>&gt;<i> PeerConnection for streaming to a peer and so on).
</I>&gt;<i> 
</I>&gt;<i> Stefan (for the DAP and WebRTC chairs).
</I>&gt;<i> 
</I>&gt;<i> [1] <A HREF="http://dev.w3.org/2011/webrtc/editor/webrtc.html">http://dev.w3.org/2011/webrtc/editor/webrtc.html</A>
</I>&gt;<i> 
</I>&gt;<i> On 2011-07-27 02:56, Rob Manson wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; sorry for posting across multiple groups, but I hope you'll see from my
</I>&gt;<i> &gt; comments below that this is really needed.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This is definitely not intended as criticism of any of the work going
</I>&gt;<i> &gt; on.  It's intended as constructive feedback that hopefully provides
</I>&gt;<i> &gt; clarification on a key use case and it's supporting requirements.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;          &quot;Access to live/raw audio and video stream data from both local
</I>&gt;<i> &gt;          and remote sources in a consistent way&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I've spent quite a bit of time trying to follow a clear thread of
</I>&gt;<i> &gt; requirements/solutions that provide API access to raw stream data (e.g.
</I>&gt;<i> &gt; audio, video, etc.).  But I'm a bit concerned this is falling in the gap
</I>&gt;<i> &gt; between the DAP and RTC WGs.  If this is not the case then please point
</I>&gt;<i> &gt; me to the relevant docs and I'll happily get back in my box 8)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Here's how the thread seems to flow at the moment based on public
</I>&gt;<i> &gt; documents.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On the DAP page [1] the mission states:
</I>&gt;<i> &gt;          &quot;the Device APIs and Policy Working Group is to create
</I>&gt;<i> &gt;          client-side APIs that enable the development of Web Applications
</I>&gt;<i> &gt;          and Web Widgets that interact with devices services such as
</I>&gt;<i> &gt;          Calendar, Contacts, Camera, etc&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So it seems clear that this is the place to start.  Further down that
</I>&gt;<i> &gt; page the &quot;HTML Media Capture&quot; and &quot;Media Capture&quot; APIs are listed.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; HTML Media Capture (camera/microphone interactions through HTML forms)
</I>&gt;<i> &gt; initially seems like a good candidate, however the intro in the latest
</I>&gt;<i> &gt; PWD [2] clearly states:
</I>&gt;<i> &gt;          &quot;Providing streaming access to these capabilities is outside of
</I>&gt;<i> &gt;          the scope of this specification.&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Followed by a NOTE that states:
</I>&gt;<i> &gt;          &quot;The Working Group is investigating the opportunity to specify
</I>&gt;<i> &gt;          streaming access via the proposed&lt;device&gt;  element.&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The link on the &quot;proposed&lt;device&gt;  element&quot; [3] links to a &quot;no longer
</I>&gt;<i> &gt; maintained&quot; document that then redirects to the top level of the whatwg
</I>&gt;<i> &gt; &quot;current work&quot; page [4].  On that page the most relevant link is the
</I>&gt;<i> &gt; video conferencing and peer-to-peer communication section [5].  More
</I>&gt;<i> &gt; about that further below.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So back to the DAP page to follow explore the other Media Capture API
</I>&gt;<i> &gt; (programmatic access to camera/microphone) [1] and it's latest PWD [6].
</I>&gt;<i> &gt; The abstract states:
</I>&gt;<i> &gt;          &quot;This specification defines an Application Programming Interface
</I>&gt;<i> &gt;          (API) that provides access to the audio, image and video capture
</I>&gt;<i> &gt;          capabilities of the device.&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; And the introduction states:
</I>&gt;<i> &gt;          &quot;The Capture API defines a high-level interface for accessing
</I>&gt;<i> &gt;          the microphone and camera of a hosting device. It completes the
</I>&gt;<i> &gt;          HTML Form Based Media Capturing specification [HTMLMEDIACAPTURE]
</I>&gt;<i> &gt;          with a programmatic access to start a parametrized capture
</I>&gt;<i> &gt;          process.&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So it seems clear that this is not related to streams in any way either.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The Notes column for this API on the DAP page [1] also states:
</I>&gt;<i> &gt;          &quot;Programmatic API that completes the form based approach
</I>&gt;<i> &gt;          Need to check if still interest in this
</I>&gt;<i> &gt;          How does it relate with the Web RTC Working Group?&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Is there an updated position on this?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So if you then head over to the WebRTC WG's charter [7] it states:
</I>&gt;<i> &gt;          &quot;...to define client-side APIs to enable Real-Time
</I>&gt;<i> &gt;          Communications in Web browsers.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;          These APIs should enable building applications that can be run
</I>&gt;<i> &gt;          inside a browser, requiring no extra downloads or plugins, that
</I>&gt;<i> &gt;          allow communication between parties using audio, video and
</I>&gt;<i> &gt;          supplementary real-time communication, without having to use
</I>&gt;<i> &gt;          intervening servers...&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So this is clearly focused upon peer-to-peer communication &quot;between&quot;
</I>&gt;<i> &gt; systems and the stream related access is naturally just treated as an
</I>&gt;<i> &gt; ancillary requirement.  The scope section then states:
</I>&gt;<i> &gt;          &quot;Enabling real-time communications between Web browsers require
</I>&gt;<i> &gt;          the following client-side technologies to be available:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;          - API functions to explore device capabilities, e.g. camera,
</I>&gt;<i> &gt;          microphone, speakers (currently in scope for the Device APIs&amp;
</I>&gt;<i> &gt;          Policy Working Group)
</I>&gt;<i> &gt;          - API functions to capture media from local devices (camera and
</I>&gt;<i> &gt;          microphone) (currently in scope for the Device APIs&amp;  Policy
</I>&gt;<i> &gt;          Working Group)
</I>&gt;<i> &gt;          - API functions for encoding and other processing of those media
</I>&gt;<i> &gt;          streams,
</I>&gt;<i> &gt;          - API functions for establishing direct peer-to-peer
</I>&gt;<i> &gt;          connections, including firewall/NAT traversal
</I>&gt;<i> &gt;          - API functions for decoding and processing (including echo
</I>&gt;<i> &gt;          cancelling, stream synchronization and a number of other
</I>&gt;<i> &gt;          functions) of those streams at the incoming end,
</I>&gt;<i> &gt;          - Delivery to the user of those media streams via local screens
</I>&gt;<i> &gt;          and audio output devices (partially covered with HTML5)&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So this is where I really start to feel the gap growing.  The DAP is
</I>&gt;<i> &gt; pointing to RTC saying not sure how if our Camera/Microphone APIs are
</I>&gt;<i> &gt; being superseded by the work in the RTC...and the RTC then points back
</I>&gt;<i> &gt; to say it will be relying on work in the DAP.  However the RTCs
</I>&gt;<i> &gt; Recommended Track Deliverables list does include:
</I>&gt;<i> &gt;          &quot;Media Stream Functions, Audio Stream Functions and Video Stream
</I>&gt;<i> &gt;          Functions&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So then it's back to the whatwg MediaStream and LocalMediaStream current
</I>&gt;<i> &gt; work [8].  Following this through you end up back at the&lt;audio&gt;  and
</I>&gt;<i> &gt; &lt;video&gt;  media element with some brief discussion about media data [9].
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Currently the only API that I'm aware of that allows live access to the
</I>&gt;<i> &gt; audio data through the&lt;audio&gt;  tag is the relatively proprietary Mozilla
</I>&gt;<i> &gt; Audio Data API [10].
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; And while the video stream data can be accessed by rendering each frame
</I>&gt;<i> &gt; into a canvas 2d graphics context and then using getImageData to extract
</I>&gt;<i> &gt; and manipulate it from there [11], this seems more like a work around
</I>&gt;<i> &gt; than an elegantly designed solution.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As I said above, this is not intended as a criticism of the work that
</I>&gt;<i> &gt; the DAP WG, WebRTC WG or WHATWG are doing.  It's intended as
</I>&gt;<i> &gt; constructive feedback to highlight that the important use case of
</I>&gt;<i> &gt; &quot;Access to live/raw audio and video stream data from both local and
</I>&gt;<i> &gt; remote sources&quot; appears to be falling in the gaps between the groups.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; From my perspective this is a critical use case for many advanced web
</I>&gt;<i> &gt; apps that will help bring them in line with what's possible in the
</I>&gt;<i> &gt; native single vendor stack based apps at the moment (e.g. iPhone&amp;
</I>&gt;<i> &gt; Android).  And it's also critical for the advancement of web standards
</I>&gt;<i> &gt; based AR applications and other computer vision, hearing and signal
</I>&gt;<i> &gt; processing applications.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I understand that a lot of these specifications I've covered are in very
</I>&gt;<i> &gt; formative stages and that requirements and PWDs are just being drafted
</I>&gt;<i> &gt; as I write.  And that's exactly why I'm raising this as a single and
</I>&gt;<i> &gt; consolidated perspective that spans all these groups.  I hope this goes
</I>&gt;<i> &gt; some way towards &quot;Access to live/raw audio and video stream data from
</I>&gt;<i> &gt; both local and remote sources&quot; being treated as an essential and core
</I>&gt;<i> &gt; use case that binds together the work of all these groups.  With a clear
</I>&gt;<i> &gt; vision for this and a little consolidated work I think this will then
</I>&gt;<i> &gt; also open up a wide range of other app opportunities that we haven't
</I>&gt;<i> &gt; even thought of yet.  But at the moment it really feels like this is
</I>&gt;<i> &gt; being treated as an assumed requirement and could end up as a poorly
</I>&gt;<i> &gt; formed second class bundle of semi-related API hooks.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; For this use case I'd really like these clear requirements to be
</I>&gt;<i> &gt; supported:
</I>&gt;<i> &gt; - access the raw stream data for both audio and video in similar ways
</I>&gt;<i> &gt; - access the raw stream data from both remote and local streams in
</I>&gt;<i> &gt; similar ways
</I>&gt;<i> &gt; - ability to inject new data or the transformed original data back into
</I>&gt;<i> &gt; streams and presented audio/video tags in a consistent way
</I>&gt;<i> &gt; - all of this be optimised for performance to meet the demands of live
</I>&gt;<i> &gt; signal processing
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; roBman
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; PS: I've also cc'd in the mozilla dev list as I think this directly
</I>&gt;<i> &gt; relates to the current &quot;booting to the web&quot; thread [12]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [1] <A HREF="http://www.w3.org/2009/dap/">http://www.w3.org/2009/dap/</A>
</I>&gt;<i> &gt; [2] <A HREF="http://www.w3.org/TR/2011/WD-html-media-capture-20110414/#introduction">http://www.w3.org/TR/2011/WD-html-media-capture-20110414/#introduction</A>
</I>&gt;<i> &gt; [3] <A HREF="http://dev.w3.org/html5/html-device/">http://dev.w3.org/html5/html-device/</A>
</I>&gt;<i> &gt; [4] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/#devices">http://www.whatwg.org/specs/web-apps/current-work/complete/#devices</A>
</I>&gt;<i> &gt; [5] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/#auto-toc-9">http://www.whatwg.org/specs/web-apps/current-work/complete/#auto-toc-9</A>
</I>&gt;<i> &gt; [6] <A HREF="http://www.w3.org/TR/2010/WD-media-capture-api-20100928/">http://www.w3.org/TR/2010/WD-media-capture-api-20100928/</A>
</I>&gt;<i> &gt; [7] <A HREF="http://www.w3.org/2011/04/webrtc-charter.html">http://www.w3.org/2011/04/webrtc-charter.html</A>
</I>&gt;<i> &gt; [8] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/video-conferencing-and-peer-to-peer-communication.html#mediastream">http://www.whatwg.org/specs/web-apps/current-work/complete/video-conferencing-and-peer-to-peer-communication.html#mediastream</A>
</I>&gt;<i> &gt; [9] <A HREF="http://www.whatwg.org/specs/web-apps/current-work/complete/the-iframe-element.html#media-data">http://www.whatwg.org/specs/web-apps/current-work/complete/the-iframe-element.html#media-data</A>
</I>&gt;<i> &gt; [10] <A HREF="https://wiki.mozilla.org/Audio_Data_API">https://wiki.mozilla.org/Audio_Data_API</A>
</I>&gt;<i> &gt; [11] <A HREF="https://developer.mozilla.org/En/Manipulating_video_using_canvas">https://developer.mozilla.org/En/Manipulating_video_using_canvas</A>
</I>&gt;<i> &gt; [12] <A HREF="http://groups.google.com/group/mozilla.dev.platform/browse_thread/thread/7668a9d46a43e482#">http://groups.google.com/group/mozilla.dev.platform/browse_thread/thread/7668a9d46a43e482#</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032975.html">[whatwg] Access to live/raw audio and video stream data from both local and remote sources
</A></li>
	<LI>Next message: <A HREF="032977.html">[whatwg] add html-attribute for &quot;responsive images&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75249">[ date ]</a>
              <a href="thread.html#75249">[ thread ]</a>
              <a href="subject.html#75249">[ subject ]</a>
              <a href="author.html#75249">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
