<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] AppCache-related e-mails
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20AppCache-related%20e-mails&In-Reply-To=%3CCAHpoE%3DifgBKeN4edxA9Yrau43JT7AHxhP%3DOV-_3UBB9OeWGpiA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="075076.html">
   <LINK REL="Next"  HREF="075084.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] AppCache-related e-mails</H1>
<!--htdig_noindex-->
    <B>Michael Nordman</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20AppCache-related%20e-mails&In-Reply-To=%3CCAHpoE%3DifgBKeN4edxA9Yrau43JT7AHxhP%3DOV-_3UBB9OeWGpiA%40mail.gmail.com%3E"
       TITLE="[whatwg] AppCache-related e-mails">michaeln at google.com
       </A><BR>
    <I>Tue Aug  2 17:23:02 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="075076.html">[whatwg] AppCache-related e-mails
</A></li>
        <LI>Next message: <A HREF="075084.html">[whatwg] AppCache-related e-mails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75054">[ date ]</a>
              <a href="thread.html#75054">[ thread ]</a>
              <a href="subject.html#75054">[ subject ]</a>
              <a href="author.html#75054">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> On Mon, 13 Jun 2011, Michael Nordman wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Let's say there's a page in the cache to be used as a fallback resource,
</I>&gt;<i> &gt; refers to the manifest by relative url...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &lt;html manifest='x'&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Depending on the url that invokes the fallback resource, 'x' will be
</I>&gt;<i> &gt; resolved to different absolute urls. When it doesn't match the actual
</I>&gt;<i> &gt; manifest url, the fallback resource will get tagged as FOREIGN and will
</I>&gt;<i> &gt; no longer be used to satisfy main resource loads.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm not sure if this is a bug in chrome or a bug in the appcache spec
</I>&gt;<i> &gt; just yet. I'm pretty certain that Safari will have the same behavior as
</I>&gt;<i> &gt; chrome in this respect (the same bug). The value of the manifest
</I>&gt;<i> &gt; attribute is interpreted as relative to the location of the loaded
</I>&gt;<i> &gt; document in chrome and all webkit based browsers and that value is used
</I>&gt;<i> &gt; to detect foreign'ness.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The workaround/solution for this is to NOT put a manifest attribute in
</I>&gt;<i> &gt; the &lt;html&gt; tag of the fallback resource (or to put either an absolute
</I>&gt;<i> &gt; url or host relative url as the manifest attribute value).
</I>&gt;<i>
</I>&gt;<i> Or just make sure you always use relative URLs, even in the manifest.
</I>&gt;<i>
</I>&gt;<i> I don't really understand the problem here. Can you elaborate further?
</I>&gt;<i>
</I>&gt;<i>
</I>Suppose the fallback resource is setup like this...

FALLBACK:
/ FallbackPage.html

... and that page contains a relative link to the manifest in its
&lt;html&gt; tag like so...
&lt;html manifest=file.manifest&gt;

Any server request that fails under / will get FallbackPage.html in
response. For example...

/SomePage.html

When the fallback is used in this case the manifest url will be
interpreted as /file.manifest

/Some/Other/Page.html

And in this case the manifest url will be interpreted as
/Some/Other/file.manifest


On Fri, 1 Jul 2011, Michael Nordman wrote:
&gt;<i> &gt;
</I>&gt;<i> &gt; Cross-origin resources listed in the CACHE section aren't retrieved with
</I>&gt;<i> &gt; the 'Origin' header
</I>&gt;<i>
</I>&gt;<i> This is incorrect. They are fetched with the origin of the manifest. What
</I>&gt;<i> makes you say no Origin header is included?
</I>

I don't see mention of that in the draft? If that were the case then this
wouldn't be an issue.

I'm not familiar with CORS usage. Do xorigin subresource loads of all kinds
(.js, .css, .png) carry the Origin header?

I can imagine a server implementation that would examine the Origin header
upfront, and if it didn't like what it saw, instead of computing the
response without the origin listed in the Access-Control-Allow-Origin
response header... it just wouldn't compute the response body and return an
empty response without the origin listed in the Access-Control-Allow-Origin
response header.

If general subresource loads aren't sent with the Origin header, fetching
all manifest listed resource with that header set could cause problems.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="075076.html">[whatwg] AppCache-related e-mails
</A></li>
	<LI>Next message: <A HREF="075084.html">[whatwg] AppCache-related e-mails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75054">[ date ]</a>
              <a href="thread.html#75054">[ thread ]</a>
              <a href="subject.html#75054">[ subject ]</a>
              <a href="author.html#75054">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
