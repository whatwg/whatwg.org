<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] API for encoding/decoding ArrayBuffers into text
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3CCAMYvS2dPVZyaEOc%2B6_5jSuP6OZON%2BC1k6036scG7KB9nCF1XSQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077465.html">
   <LINK REL="Next"  HREF="077467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] API for encoding/decoding ArrayBuffers into text</H1>
<!--htdig_noindex-->
    <B>Kenneth Russell</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3CCAMYvS2dPVZyaEOc%2B6_5jSuP6OZON%2BC1k6036scG7KB9nCF1XSQ%40mail.gmail.com%3E"
       TITLE="[whatwg] API for encoding/decoding ArrayBuffers into text">kbr at google.com
       </A><BR>
    <I>Mon Mar 26 18:11:37 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077465.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
        <LI>Next message: <A HREF="077467.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77466">[ date ]</a>
              <a href="thread.html#77466">[ thread ]</a>
              <a href="subject.html#77466">[ subject ]</a>
              <a href="author.html#77466">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Mar 26, 2012 at 5:33 PM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:
&gt;<i> On Mon, Mar 26, 2012 at 4:40 PM, Joshua Bell &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jsbell at chromium.org</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> * We lost the ability to decode from a arraybuffer and see how many
</I>&gt;&gt;&gt;<i> bytes were consumed before a null-terminator was hit. One not terribly
</I>&gt;&gt;&gt;<i> elegant solution would be to add a TextDecoder.decodeWithLength method
</I>&gt;&gt;&gt;<i> which return a DOMString+length tuple.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Agreed, but of course see above - there was consensus earlier in the thread
</I>&gt;&gt;<i> that searching for null terminators should be done outside the API,
</I>&gt;&gt;<i> therefore the caller will have the length handy already. Yes, this would be
</I>&gt;&gt;<i> a big flaw since decoding at tightly packed data structure (e.g. array of
</I>&gt;&gt;<i> null terminated strings w/o length) would be impossible with just the
</I>&gt;&gt;<i> nullTerminator flag.
</I>&gt;<i>
</I>&gt;<i> Requiring callers to find the null character first, and then use that
</I>&gt;<i> will require one additional pass over the encoded binary data though.
</I>&gt;<i> Also, if we put the API for finding the null character on the Decoder
</I>&gt;<i> object it doesn't seem like we're creating an API which is easier to
</I>&gt;<i> use, just one that has moved some of the logic from the API to every
</I>&gt;<i> caller.
</I>&gt;<i>
</I>&gt;<i> Though I guess the best solution would be to add methods to DataView
</I>&gt;<i> which allows consuming an ArrayBuffer up to a null terminated point
</I>&gt;<i> and returns the decoded string. Potentially such a method could take a
</I>&gt;<i> Decoder object as argument.
</I>
The rationale for specifying the string encoding and decoding
functionality outside the typed array specification is to keep the
typed array spec small and easily implementable. The indexed property
getters and setters on the typed array views, and methods on DataView,
are designed to be implementable with a small amount of assembly code
in JavaScript engines. I'd strongly prefer to continue to design the
encoding/decoding functionality separately from the typed array views.

-Ken

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077465.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
	<LI>Next message: <A HREF="077467.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77466">[ date ]</a>
              <a href="thread.html#77466">[ thread ]</a>
              <a href="subject.html#77466">[ subject ]</a>
              <a href="author.html#77466">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
