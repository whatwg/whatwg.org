<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] API for encoding/decoding ArrayBuffers into text
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3CCA%2Bc2ei_8GL53vp5ZWMEFBNKSdZkvGenujjv34S7Uadt7hMrHpA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077469.html">
   <LINK REL="Next"  HREF="077473.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] API for encoding/decoding ArrayBuffers into text</H1>
<!--htdig_noindex-->
    <B>Jonas Sicking</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3CCA%2Bc2ei_8GL53vp5ZWMEFBNKSdZkvGenujjv34S7Uadt7hMrHpA%40mail.gmail.com%3E"
       TITLE="[whatwg] API for encoding/decoding ArrayBuffers into text">jonas at sicking.cc
       </A><BR>
    <I>Mon Mar 26 22:41:47 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077469.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
        <LI>Next message: <A HREF="077473.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77471">[ date ]</a>
              <a href="thread.html#77471">[ thread ]</a>
              <a href="subject.html#77471">[ subject ]</a>
              <a href="author.html#77471">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Mar 26, 2012 at 6:24 PM, Glenn Maynard &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">glenn at zewt.org</A>&gt; wrote:
&gt;<i> On Mon, Mar 26, 2012 at 7:33 PM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Requiring callers to find the null character first, and then use that
</I>&gt;&gt;<i> will require one additional pass over the encoded binary data though.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> That's extremely fast (memchr), and it's probably the fastest thing to do
</I>&gt;<i> anyway, compared to embedding null-termination logic into the inner loop of
</I>&gt;<i> decode functions.
</I>
The memchr is purely overhead, I.e. we are comparing memchr+decoding
to decoding. So I don't see what's backing up the &quot;probably the
fastest thing&quot; claim.

&gt;<i> Unless there's a concrete benchmark showing that it's slower, and slower
</I>&gt;<i> enough to actually matter, this shouldn't be a consideration.&#160; It's a
</I>&gt;<i> premature optimization.
</I>
My argument is that it's both faster and more author friendly.

I admit I missed the previous discussion which led to the agreement to
keep the length measuring outside, so I don't know what arguments were
presented. Any pointers would be appreciated.

&gt;&gt;<i> Also, if we put the API for finding the null character on the Decoder
</I>&gt;&gt;<i> object it doesn't seem like we're creating an API which is easier to
</I>&gt;&gt;<i> use, just one that has moved some of the logic from the API to every
</I>&gt;&gt;<i> caller.
</I>&gt;<i>
</I>&gt;<i> It doesn't seem materially harder (a little more code, yes, but that's not
</I>&gt;<i> the same thing), and it's more general-purpose.
</I>
I agree it doesn't seem materially harder. I also agree that I don't
have data to show that it's materially slower. But it sounds like
we're in agreement that keeping the logic outside is both harder and
slower which honestly doesn't speak strongly in its favor.

I don't understand the argument that the alternative is more
&quot;general-purpose&quot;. The API is already generic in that you can use
whatever delimiter you want since you pass in a view. The only
functionality which is not available is finding a null-terminator in
an arraybuffer which you are arguing below shouldn't be part of the
decoder (which I agree with).

/ Jonas

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077469.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
	<LI>Next message: <A HREF="077473.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77471">[ date ]</a>
              <a href="thread.html#77471">[ thread ]</a>
              <a href="subject.html#77471">[ subject ]</a>
              <a href="author.html#77471">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
