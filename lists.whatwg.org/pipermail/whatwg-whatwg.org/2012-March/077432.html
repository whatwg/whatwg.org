<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] API for encoding/decoding ArrayBuffers into text
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3Cop.wbkrq72d64w2qv%40annevk-macbookpro.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077431.html">
   <LINK REL="Next"  HREF="077436.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] API for encoding/decoding ArrayBuffers into text</H1>
<!--htdig_noindex-->
    <B>Anne van Kesteren</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3Cop.wbkrq72d64w2qv%40annevk-macbookpro.local%3E"
       TITLE="[whatwg] API for encoding/decoding ArrayBuffers into text">annevk at opera.com
       </A><BR>
    <I>Thu Mar 22 06:58:09 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077431.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
        <LI>Next message: <A HREF="077436.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77432">[ date ]</a>
              <a href="thread.html#77432">[ thread ]</a>
              <a href="subject.html#77432">[ subject ]</a>
              <a href="author.html#77432">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, 22 Mar 2012 14:47:05 +0100, Glenn Maynard &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">glenn at zewt.org</A>&gt; wrote:
&gt;<i> A problem with this is that the bugs resulting from not calling eof() are
</I>&gt;<i> subtle.  The only thing eof() would ever do, I think, is return U+FFFD
</I>&gt;<i> characters if there are leftover characters in the internal buffer; if  
</I>&gt;<i> you
</I>&gt;<i> never call eof(), you'll never get incorrect results unless you test with
</I>&gt;<i> invalid inputs.
</I>&gt;<i>
</I>&gt;<i> It's minor, as subtle-edge-cases-that-people-won't-get-right go, but it's
</I>&gt;<i> at least worth a mention.  Maybe people who would use this API instead of
</I>&gt;<i> the simpler non-streaming version (which could be a thin wrapper on this)
</I>&gt;<i> in the first place are also more likely to get this right.
</I>&gt;<i>
</I>&gt;<i> I'm guessing a common, incorrect pattern would be:
</I>&gt;<i>
</I>&gt;<i> string = new Encoder(&quot;euc-kr&quot;).encode(bytes);
</I>&gt;<i>
</I>&gt;<i> which would *not* be equivalent to bytes.encode(&quot;euc-kr&quot;).
</I>
Another way would be to have a second optional argument that indicates  
whether more bytes are coming (defaults to false), but I'm not sure of the  
chances that would be used correctly. The reasons you outline are probably  
why many browser implementations deal with EOF poorly too.


-- 
Anne van Kesteren
<A HREF="http://annevankesteren.nl/">http://annevankesteren.nl/</A>

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077431.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
	<LI>Next message: <A HREF="077436.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77432">[ date ]</a>
              <a href="thread.html#77432">[ thread ]</a>
              <a href="subject.html#77432">[ subject ]</a>
              <a href="author.html#77432">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
