<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] API for encoding/decoding ArrayBuffers into text
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3CCAD649j5MW3aVY9DUk23d%2BG%3DRfnTad-Hh33ceY%3D8nBNwutBvMFw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077411.html">
   <LINK REL="Next"  HREF="077417.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] API for encoding/decoding ArrayBuffers into text</H1>
<!--htdig_noindex-->
    <B>Joshua Bell</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20API%20for%20encoding/decoding%20ArrayBuffers%20into%20text&In-Reply-To=%3CCAD649j5MW3aVY9DUk23d%2BG%3DRfnTad-Hh33ceY%3D8nBNwutBvMFw%40mail.gmail.com%3E"
       TITLE="[whatwg] API for encoding/decoding ArrayBuffers into text">jsbell at chromium.org
       </A><BR>
    <I>Wed Mar 21 08:53:36 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077411.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
        <LI>Next message: <A HREF="077417.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77415">[ date ]</a>
              <a href="thread.html#77415">[ thread ]</a>
              <a href="subject.html#77415">[ subject ]</a>
              <a href="author.html#77415">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Mar 21, 2012 at 12:42 PM, Anne van Kesteren &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">annevk at opera.com</A>&gt;wrote:

&gt;<i> On Wed, 21 Mar 2012 01:27:47 -0700, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> This leaves us with 2 or 3. So the question is if we should support
</I>&gt;&gt;<i> streaming or not. I suspect doing so would be worth it.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> For XMLHttpRequest it might be, yes.
</I>&gt;<i>
</I>&gt;<i> I think we should expose the same encoding set throughout the platform.
</I>&gt;<i> One reason to limit the encoding set initially might be because we have not
</I>&gt;<i> all converged yet on our encoding sets. Gecko, Safari, and Internet
</I>&gt;<i> Explorer expose a lot more encodings than Opera and Chrome.
</I>&gt;<i>
</I>
Just to throw it out there - does anyone feel we can/should offer
asymmetric encode/decode support, i.e. supporting more encodings for decode
operations than for encode operations?

As for the API, how about:
&gt;<i>
</I>&gt;<i>  enc = new Encoder(&quot;euc-kr&quot;)
</I>&gt;<i>  string1 = enc.encode(bytes1)
</I>&gt;<i>  string2 = enc.encode(bytes2)
</I>&gt;<i>  string3 = enc.eof() // might return empty string if all is fine
</I>&gt;<i>
</I>&gt;<i> And similarly you would have
</I>&gt;<i>
</I>&gt;<i>  dec = new Decoder(&quot;shift_jis&quot;)
</I>&gt;<i>  bytes = dec.decode(string)
</I>&gt;<i>
</I>&gt;<i> Or alternatively you could have a single object that exposes both encode()
</I>&gt;<i> and decode() and tracks state for both:
</I>&gt;<i>
</I>&gt;<i>  enc = new Encoding(&quot;gb18030&quot;)
</I>&gt;<i>  bytes1  = enc.decode(string1)
</I>&gt;<i>  string2 = enc.encode(bytes2)
</I>

That's the direction my thinking was headed. Glenn pointed out that the
state that's implicitly captured in the above objects could instead be
returned as an explicit but opaque state object that's passed in and out of
stateless functions. As a potential user of the API, I find the above
&quot;object-oriented&quot; style easier to understand.

Re: Encoding object vs. an Encoder/Decoder pair - I'd prefer the latter as
it makes the state being captured and any methods/attributes to interrogate
the state clearer.

Bikeshedding on the name - we'd have to put &quot;String&quot; or &quot;Text&quot; in there
somewhere, since audio/video/image codecs will likely want to use similar
terms.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077411.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
	<LI>Next message: <A HREF="077417.html">[whatwg] API for encoding/decoding ArrayBuffers into text
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77415">[ date ]</a>
              <a href="thread.html#77415">[ thread ]</a>
              <a href="subject.html#77415">[ subject ]</a>
              <a href="author.html#77415">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
