<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Asynchronous database API feedback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Asynchronous%20database%20API%20feedback&In-Reply-To=%3C278fd46c0712091218p265c6919q8deab46653c05220%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013117.html">
   <LINK REL="Next"  HREF="013126.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Asynchronous database API feedback</H1>
<!--htdig_noindex-->
    <B>Aaron Boodman</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Asynchronous%20database%20API%20feedback&In-Reply-To=%3C278fd46c0712091218p265c6919q8deab46653c05220%40mail.gmail.com%3E"
       TITLE="[whatwg] Asynchronous database API feedback">aa at google.com
       </A><BR>
    <I>Sun Dec  9 12:18:48 PST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="013117.html">[whatwg] Asynchronous database API feedback
</A></li>
        <LI>Next message: <A HREF="013126.html">[whatwg] Asynchronous database API feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13118">[ date ]</a>
              <a href="thread.html#13118">[ thread ]</a>
              <a href="subject.html#13118">[ subject ]</a>
              <a href="author.html#13118">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Dec 9, 2007 3:52 AM, Maciej Stachowiak &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">mjs at apple.com</A>&gt; wrote:
&gt;<i> On a mobile device, it doesn't make sense for your home directory to
</I>&gt;<i> be on a network drive either. However, if you use one of several
</I>&gt;<i> shared workstations, you probably want your local data to be there
</I>&gt;<i> when the rest of your homedir is.
</I>
I don't think this is true. For the applications we have built with
Gears, the local data is a cache of the truth which is on the server.
Two major reasons for having local data is that a) it's fast, and b)
it will be there when you unexpectedly go offline. Both of these are
lost if the &quot;local&quot; data is actually on a network drive.

&gt;<i> I'll be more convinced if there's a better answer to this than &quot;make
</I>&gt;<i> reasonable assumptions&quot;.
</I>&gt;<i>
</I>&gt;<i> Thinking about it now, I can imagine a way to make this more concrete:
</I>&gt;<i> give synchronous transactions a time limit, and if they exceed it they
</I>&gt;<i> report an error and fail. We can be generous and say the limit is 5
</I>&gt;<i> seconds, although that's awful close to unacceptable UI lockup
</I>&gt;<i> territory. Possible drawbacks:
</I>
Ok, that sounds good. Actually that is the way we have implemented
Gears today, and I guess I assumed that a timeout was part of the
picture. We have a five-second timeout on the database and what we
have told developers is that if you are getting timeout errors,
something is dreadfully wrong, you should not try again but
investigate why this is happening.

&gt;<i> - I'm not sure it will be any easier to handle timeout errors than it
</I>&gt;<i> would be to use the async API (since, if your request is too big to
</I>&gt;<i> complete in reasonable time on this device, you probably have to use
</I>&gt;<i> the async API as your fallback).
</I>
Or just let it be an error :-). If you start hearing this from
developers, you probably change your app to use only the async API in
that case, or report it to the vendor (you or I) and say &quot;why is it
taking 5 seconds to select 1 row? Is there a bug?&quot;.

&gt;<i> Thoughts? Would you be willing to use a synchronous API with a
</I>&gt;<i> timeout? Do you think it's reasonable for other web developers? (I'm
</I>&gt;<i> honestly not sure, I haven't thought it through in detail.)
</I>
I think it's reasonable. Sorry I assumed the design already implied
something like this.

&gt;<i> Getting back to storage, consider devices with a Flash drive as the
</I>&gt;<i> primary disk. Most web developers won't test on these (did you?), but
</I>&gt;<i> they have very different performance characteristics than hard drives.
</I>&gt;<i> While there are no seek latencies to content with, and reads can be
</I>&gt;<i> pretty fast, the write throughput can be quite a bit worse, especially
</I>&gt;<i> for scattered small writes. In many cases, such devices have special
</I>&gt;<i> filesystems that try to spread writes over the entire device, to
</I>&gt;<i> increase Flash lifetime. But the result can be that write latencies
</I>&gt;<i> get much worse than usual at unpredictable times.
</I>
I still feel that there are many simple use cases for a local database
for which a developer can assume the read and write latency should
always be less than five seconds. If we cannot provide this, I feel
that localstorage will not be successful, so it won't matter what API
it uses.

- a

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013117.html">[whatwg] Asynchronous database API feedback
</A></li>
	<LI>Next message: <A HREF="013126.html">[whatwg] Asynchronous database API feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13118">[ date ]</a>
              <a href="thread.html#13118">[ thread ]</a>
              <a href="subject.html#13118">[ subject ]</a>
              <a href="author.html#13118">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
