<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Cue points in media elements
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Cue%20points%20in%20media%20elements&In-Reply-To=%3C001401c78c63%245dfd97e0%246501a8c0%40disxgdg31szkx7%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011152.html">
   <LINK REL="Next"  HREF="011156.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Cue points in media elements</H1>
<!--htdig_noindex-->
    <B>ddailey</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Cue%20points%20in%20media%20elements&In-Reply-To=%3C001401c78c63%245dfd97e0%246501a8c0%40disxgdg31szkx7%3E"
       TITLE="[whatwg] Cue points in media elements">ddailey at zoominternet.net
       </A><BR>
    <I>Tue May  1 19:41:20 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="011152.html">[whatwg] Cue points in media elements
</A></li>
        <LI>Next message: <A HREF="011156.html">[whatwg] &lt;include&gt; element
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11161">[ date ]</a>
              <a href="thread.html#11161">[ thread ]</a>
              <a href="subject.html#11161">[ subject ]</a>
              <a href="author.html#11161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hearing about cue points in media elements. Just sorta reminds me of 
keyTimes in SMIL.

I know SMIL seems funky to some people, but I do really love it! It is so 
way cool! So far as I know it doesn't do quite what you're talking about 
here, but it does similar stuff including non-linear distortions of timing 
elements and the like.

It's declarative (though I don't think it's Turing complete -- wager of 
virtual beans proposed) and its syntax is worthy of emulation in that 
classical &quot;ontology recapitulates philology&quot; sort of sense. It is so much a 
W3C standard that it has six or eight or twelve standards devoted to it.

David Dailey
(who is trying to learn how not to re-invent wheels)
<A HREF="http://srufaculty.sru.edu/david.dailey/copyright/dailey_on_copyright.htm">http://srufaculty.sru.edu/david.dailey/copyright/dailey_on_copyright.htm</A>

Damn bastard mutant wheels keep popping up around me like unwanted 
copyrighted utterances in a world where intellectual landfills are charged 
by the bit!
-- anonymous

----- Original Message ----- 
From: &quot;Brian Campbell&quot; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Brian.P.Campbell at Dartmouth.EDU</A>&gt;
To: &quot;Ralph Giles&quot; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">giles at xiph.org</A>&gt;
Cc: &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A>&gt;
Sent: Tuesday, May 01, 2007 4:57 PM
Subject: Re: [whatwg] Cue points in media elements


&gt;<i> On Apr 30, 2007, at 7:15 PM, Ralph Giles wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Thanks for adding to the discussion. We're very interested in
</I>&gt;&gt;<i> implementing support for presentations as well, so it's good
</I>&gt;&gt;<i> to hear from someone with experience.
</I>&gt;<i>
</I>&gt;<i> Thanks for responding, I'm glad to hear your input.
</I>&gt;<i>
</I>&gt;&gt;<i> On Sun, Apr 29, 2007 at 03:14:27AM -0400, Brian Campbell wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> in our language, you might see something like this:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>   (movie &quot;Foo.mov&quot; :name 'movie)
</I>&gt;&gt;&gt;<i>   (wait @movie (tc 2 3))
</I>&gt;&gt;&gt;<i>   (show @bullet-1)
</I>&gt;&gt;&gt;<i>   (wait @movie)
</I>&gt;&gt;&gt;<i>   (show @bullet-2)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If the user skips to the end of the media clip, that simply causes
</I>&gt;&gt;&gt;<i> all WAITs on that  media clip to return instantly. If they skip
</I>&gt;&gt;&gt;<i> forward in the media clip, without ending it, all WAITs before that
</I>&gt;&gt;&gt;<i> point will return instantly.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How does this work if, for example, the user seeks forward, and then
</I>&gt;&gt;<i> back to an earlier position? Would some of the 'show's be undone,  or do
</I>&gt;&gt;<i> they not seek backward with the media playback?
</I>&gt;<i>
</I>&gt;<i> We don't expose arbitrary seeking controls to our users; just play/ pause, 
</I>&gt;<i> skip forward &amp; back one card (which resets all state to a  known value) 
</I>&gt;<i> and skip past the current video/audio (which just causes  all waits on 
</I>&gt;<i> that media element to return instantly).
</I>&gt;<i>
</I>&gt;&gt;<i> Is the essential
</I>&gt;&gt;<i> component of your system that all the shows be called in sequence
</I>&gt;&gt;<i> to build up a display state, or that the last state trigger before the
</I>&gt;&gt;<i> current playback point have been triggered?
</I>&gt;<i>
</I>&gt;<i> The former.
</I>&gt;<i>
</I>&gt;&gt;<i> Isn't this slow if a bunch
</I>&gt;&gt;<i> of intermediate animations are triggered by a seek?
</I>&gt;<i>
</I>&gt;<i> Yes, though this is more a bug in our animation API (which could be 
</I>&gt;<i> taught to skip directly to the end of an animation when associated 
</I>&gt;<i> video/audio ends, but that just hasn't been done yet).
</I>&gt;<i>
</I>&gt;<i> Actually, that brings up another point, which is a bit more  speculative. 
</I>&gt;<i> It may be nice to have a way to register a callback that  will be called 
</I>&gt;<i> at animation rates (at least 15 frames/second or so)  that is called with 
</I>&gt;<i> the current play time of a media element. This  would allow you to keep 
</I>&gt;<i> animations in sync with video, even if the  video might stall briefly, or 
</I>&gt;<i> seek forward or backward for whatever  reason. We haven't implemented this 
</I>&gt;<i> in our current system (as I said,  it still has the bug that animations 
</I>&gt;<i> still take their full time to  play even when you skip video), but it may 
</I>&gt;<i> be helpful for this sort  of thing.
</I>&gt;<i>
</I>&gt;&gt;<i> Does your system support live streaming as well? That complicates the
</I>&gt;&gt;<i> design some when the presentation media updates appear dynamically.
</I>&gt;<i>
</I>&gt;<i> No, we only support progressive download.
</I>&gt;<i>
</I>&gt;&gt;<i> Anyway I think you could implement your system with the currently
</I>&gt;&gt;<i> proposed interface by checking the current playback position and
</I>&gt;&gt;<i> clearing a separate list of waits inside your timeupdate callback.
</I>&gt;<i>
</I>&gt;<i> I agree, it would be possible, but from my current reading of the  spec it 
</I>&gt;<i> sounds like some cue points might be missed until quite a bit  later 
</I>&gt;<i> (since timeupdate isn't guaranteed to be called every time  anything 
</I>&gt;<i> discontinuous happens with the media). In general, having to  do extra 
</I>&gt;<i> bookkeeping to keep track of the state of the media may be  fragile, so 
</I>&gt;<i> stronger guarantees about when cue points are fired is  better than trying 
</I>&gt;<i> to keep track of what's going on with timeupdate  events.
</I>&gt;<i>
</I>&gt;&gt;<i> I agree this should be clarified. The appropriate interpretation  should
</I>&gt;&gt;<i> be when the current playback position reaches the frame  corresponding to
</I>&gt;&gt;<i> the queue point, but digital media has quantized frames, while the cue
</I>&gt;&gt;<i> points are floating point numbers. Triggering all cue point callbacks
</I>&gt;&gt;<i> between the last current playback position and the current one
</I>&gt;&gt;<i> (including during seeks) would be one option, and do what you want as
</I>&gt;&gt;<i> long as you aren't seeking backward. I'd be more in favor of  triggering
</I>&gt;&gt;<i> any cue point callbacks that lie between the current playback position
</I>&gt;&gt;<i> and the current playback position of the next frame (audio frame for
</I>&gt;&gt;<i> &lt;audio/&gt; and video frame for &lt;video/&gt; I guess). That means more
</I>&gt;&gt;<i> bookkeeping to implement your system, but is less surprising in other
</I>&gt;&gt;<i> cases.
</I>&gt;<i>
</I>&gt;<i> Sure, that would probably work. As I said, bookkeeping is generally a 
</I>&gt;<i> problem because it might get out of sync, but with stronger  guarantees 
</I>&gt;<i> about when cue points are triggered, I think it could work.
</I>&gt;<i>
</I>&gt;&gt;&gt;<i>                                                           If video
</I>&gt;&gt;&gt;<i> playback freezes for a second, and so misses a cue point, is that
</I>&gt;&gt;&gt;<i> considered to have been &quot;reached&quot;?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As I read it, cue points are relative to the current playback  position,
</I>&gt;&gt;<i> which does not advance if the stream buffer underruns, but it would
</I>&gt;&gt;<i> if playback restarts after a gap, as might happen if the connection
</I>&gt;&gt;<i> drops, or in an RTP stream. My proposal above would need to be amended
</I>&gt;&gt;<i> to handle that case, and the decoder dropping frames...finding the  right
</I>&gt;&gt;<i> language here is hard.
</I>&gt;<i>
</I>&gt;<i> Yes, it's a tricky little problem. Our current system stays out of 
</I>&gt;<i> trouble because it makes quite a few simplifying assumptions (video  is 
</I>&gt;<i> played forward only, progressive download, not streaming, etc). 
</I>&gt;<i> Obviously, in order to support a more general API, you're going to  have 
</I>&gt;<i> to deal with some trickier issues.
</I>&gt;<i>
</I>&gt;<i> I guess the main question to ask is what is the purpose of a cue  point? 
</I>&gt;<i> Is it to specify &quot;at the moment this is called, the media is  at this 
</I>&gt;<i> point,&quot; and what does that mean when you have quantized  frames and 
</I>&gt;<i> floating point times? Is it to specify &quot;the media has  passed this 
</I>&gt;<i> particular point in playback&quot;, and what does that mean  when you're 
</I>&gt;<i> playing backwards or seeking?
</I>&gt;<i>
</I>&gt;&gt;<i> I really like this idea. It would also be nice if, for example, the
</I>&gt;&gt;<i> closed caption text were available through the DOM so it could be
</I>&gt;&gt;<i> presented elsewhere, searched locally, and so on. But what about  things
</I>&gt;&gt;<i> like album art, which might be embedded in an audio stream? Should  that
</I>&gt;&gt;<i> be accessible? Should a video element expose a set of known cue points
</I>&gt;&gt;<i> embedded in the file?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> A more abstract interface is necessary than just 'caption events'.
</I>&gt;<i>
</I>&gt;<i> My instinct is to avoid trying to make a more general interface if 
</I>&gt;<i> possible. There are endless types of access you can build to  information 
</I>&gt;<i> in underlying media elements, and I think it would put a  large burden on 
</I>&gt;<i> implementors if they had to support accessing all of  those types of 
</I>&gt;<i> information. Accessibility is one of the most  important concerns in HTML, 
</I>&gt;<i> however, so I think that having special  case support for accessibility 
</I>&gt;<i> without providing all of the other  features would be an acceptable 
</I>&gt;<i> tradeoff.
</I>&gt;<i>
</I>&gt;&gt;<i> Here
</I>&gt;&gt;<i> are some use cases worth considering:
</I>&gt;<i>
</I>&gt;<i> &lt;snip a bunch of interesting use cases&gt;
</I>&gt;<i>
</I>&gt;&gt;<i> All of these can be handled by special server-side components and  AJAX,
</I>&gt;&gt;<i> for example, so the main question is whether the media elements should
</I>&gt;&gt;<i> expose this sort of data through the DOM.
</I>&gt;<i>
</I>&gt;<i> Special server-side components and AJAX drastically increases the 
</I>&gt;<i> complexity of the system, increases the authoring burden, and makes  it so 
</I>&gt;<i> that it's not possible to distribute stand-alone content, so if  possible, 
</I>&gt;<i> I'd prefer to make it possible to do everything we need  with just plain 
</I>&gt;<i> old JavaScript and the DOM.
</I>&gt;<i>
</I>&gt;<i> 
</I>


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011152.html">[whatwg] Cue points in media elements
</A></li>
	<LI>Next message: <A HREF="011156.html">[whatwg] &lt;include&gt; element
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11161">[ date ]</a>
              <a href="thread.html#11161">[ thread ]</a>
              <a href="subject.html#11161">[ subject ]</a>
              <a href="author.html#11161">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
