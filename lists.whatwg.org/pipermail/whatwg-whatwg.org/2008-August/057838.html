<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] &lt;canvas&gt; shadow compositing oddities
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Ccanvas%3E%20shadow%20compositing%20oddities&In-Reply-To=%3C489774A8.3050205%40mozilla.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="057837.html">
   <LINK REL="Next"  HREF="057840.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] &lt;canvas&gt; shadow compositing oddities</H1>
<!--htdig_noindex-->
    <B>Eric Butler</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Ccanvas%3E%20shadow%20compositing%20oddities&In-Reply-To=%3C489774A8.3050205%40mozilla.com%3E"
       TITLE="[whatwg] &lt;canvas&gt; shadow compositing oddities">ebutler at mozilla.com
       </A><BR>
    <I>Mon Aug  4 14:29:12 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="057837.html">[whatwg] database transactions should be serialized
</A></li>
        <LI>Next message: <A HREF="057840.html">[whatwg] &lt;canvas&gt; shadow compositing oddities
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57838">[ date ]</a>
              <a href="thread.html#57838">[ thread ]</a>
              <a href="subject.html#57838">[ subject ]</a>
              <a href="author.html#57838">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Philip Taylor wrote:
&gt;<i> On Sun, Jul 27, 2008 at 8:06 PM, Eric Butler &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ebutler at mozilla.com</A>&gt; wrote:
</I>&gt;<i>   
</I>&gt;&gt;<i> [...]
</I>&gt;&gt;<i> However, following the spec's drawing model, there are a few operators that
</I>&gt;&gt;<i> behave rather unexpectedly if the shadow color is left at its default value.
</I>&gt;&gt;<i> For instance, since A in B always results in transparency if either A or B
</I>&gt;&gt;<i> is fully transparent, source-in will always simply clear the clipping region
</I>&gt;&gt;<i> to fully transparent no matter what the source and destination are.
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i> Oops - that does seem quite broken. (It's probably my fault - I didn't
</I>&gt;<i> notice that problem when I was looking at how shadows should work...
</I>
The need to be able to disable shadows explicitly seems clear. But I 
also believe that the spec should provide
for a means to disable normal drawing and only draw shadows to increase 
the usefulness of shadows.

As it stands, if you draw with shadows, you'll end up getting some of 
the shadows drawn on top of some of
the actual shapes. But perhaps the developer wants to have all shadows 
behind all shapes for a particular set
of shapes. The only way to accomplish that would be to create a second 
canvas, do all the drawing without
shadows on that, then draw the canvas with its shadow back to the 
original, which seems cumbersome
to use and is terribly inefficient.

It would be simpler if the user could simply turn on only shadows, do 
the drawing once, then turn on only
normal rendering and do the drawing again. You cannot simply set the 
fill/stroke style to transparent for
the same reason that it doesn't quite work for shadows. So I believe 
that the spec should provide for the
means to explicitly disable both shadows and normal drawing separately.

To that end, perhaps there could be an attribute which indicated what 
the current state of the drawing model
was: object only, shadow only, or objects and shadows, defaulting to 
drawing only objects. This would create
more expected output for all composite operators, and would allow 
developers to do some more complex
tricks with shadows.

Oliver Hunt wrote:
&gt;<i>
</I>&gt;<i> We could special case opacity 0, with 0,0 offset, and 0 blur radius as 
</I>&gt;<i> being a &quot;do not draw shadow&quot; flag perhaps?
</I>&gt;<i>
</I>This wouldn't solve the problem of disabling normal drawing and doesn't 
seem like a very clean API to me.
A more explicit attribute seems better in my opinion.

While it is true that having shadows and objects always in the drawing 
model can be hacked around when all but
certain uncommon composite operators are being used, it seems unclean to 
have to keep flipping the style back
and forth to hack around things. Furthermore, it is extremely difficult 
if not impossible to achieve certain effects
without the ability to modify the drawing model. So I believe such a 
means should be provided.

-Eric Butler

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="057837.html">[whatwg] database transactions should be serialized
</A></li>
	<LI>Next message: <A HREF="057840.html">[whatwg] &lt;canvas&gt; shadow compositing oddities
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#57838">[ date ]</a>
              <a href="thread.html#57838">[ thread ]</a>
              <a href="subject.html#57838">[ subject ]</a>
              <a href="author.html#57838">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
