<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Fwd: Discussing WebSRT and alternatives/improvements
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Fwd%3A%20Discussing%20WebSRT%20and%20alternatives/improvements&In-Reply-To=%3Cop.vhz0cji2sr6mfa%40nog%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="070416.html">
   <LINK REL="Next"  HREF="070419.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Fwd: Discussing WebSRT and alternatives/improvements</H1>
<!--htdig_noindex-->
    <B>Philip J&#228;genstedt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Fwd%3A%20Discussing%20WebSRT%20and%20alternatives/improvements&In-Reply-To=%3Cop.vhz0cji2sr6mfa%40nog%3E"
       TITLE="[whatwg] Fwd: Discussing WebSRT and alternatives/improvements">philipj at opera.com
       </A><BR>
    <I>Wed Aug 25 07:39:45 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="070416.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
        <LI>Next message: <A HREF="070419.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70417">[ date ]</a>
              <a href="thread.html#70417">[ thread ]</a>
              <a href="subject.html#70417">[ subject ]</a>
              <a href="author.html#70417">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, 25 Aug 2010 14:39:00 +0200, Silvia Pfeiffer  
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">silviapfeiffer1 at gmail.com</A>&gt; wrote:

&gt;<i> On Wed, Aug 25, 2010 at 7:20 PM, Philip J&#228;genstedt  
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>&gt;wrote:
</I>&gt;<i>
</I>
&gt;&gt;&gt;&gt;<i> The question, then, is if parsers that handle the mentioned markup  
</I>&gt;&gt;&gt;&gt;<i> also
</I>&gt;&gt;&gt;&gt;<i> ignore &lt;1&gt;, &lt;ruby&gt; and &lt;rt&gt;. I haven't tested it, but I assume that  
</I>&gt;&gt;&gt;&gt;<i> some
</I>&gt;&gt;&gt;&gt;<i> will ignore it and some won't. How many percent of the media player
</I>&gt;&gt;&gt;&gt;<i> market
</I>&gt;&gt;&gt;&gt;<i> would have to handle this correctly for these extensions to be OK, in
</I>&gt;&gt;&gt;&gt;<i> your
</I>&gt;&gt;&gt;&gt;<i> opinion?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If a single one breaks, it would be bad IMO because the expectations of
</I>&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;<i> users of that software will be broken even if it may just be a small
</I>&gt;&gt;&gt;<i> percentage of users and we have no influence on the upgrade path of  
</I>&gt;&gt;&gt;<i> that
</I>&gt;&gt;&gt;<i> software - in particular if it is proprietary.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Neither a new file extension, MIME type or header is enough to stop some
</I>&gt;&gt;<i> implementations from treating it as SRT and break. The only remaining
</I>&gt;&gt;<i> option, AFAICT, is making the format fundamentally incompatible with  
</I>&gt;&gt;<i> SRT. Is
</I>&gt;&gt;<i> it worth it?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If it has a different file extension and a different mime type and even a
</I>&gt;<i> different header, I don't think any existing software will open it as  
</I>&gt;<i> SRT.
</I>&gt;<i> Why would it think that a random file is a SRT file? It would need to be  
</I>&gt;<i> an
</I>&gt;<i> application that accepts absolutely anything that you give it as SRT and
</I>&gt;<i> then that software has more fundamental problems.
</I>
I renamed a SRT file to .wsrt and added WEBSRT on a line before the cues  
and it still plays just fine in MPlayer, using `mplayer video.ogv -sub  
subs.wsrt`. VLC won't open a subtitle file with .wsrt extension, but the  
same file (with a WEBSRT header) works with the extension srt or txt.  
Totem is the other way around, the file extension doesn't matter, but it  
rejects files with a header.

The results are hardly consistent, but at least one player exist for which  
it's not enough to change the file extension and add a header. If we want  
to make sure that no content is treated as SRT by any application, the  
format must be more incompatible.

&gt;&gt;&gt;&gt;<i> At this point, what is your recommendation? The following ideas have  
</I>&gt;&gt;&gt;&gt;<i> been
</I>&gt;&gt;&gt;&gt;<i> on the table:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> * Change the file extension to something other than .srt.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I don't have an opinion, browsers ignore the file extension anyway.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Yes, I think we should definitely have a new file extension.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'll leave this to others to decide, but since browsers have no concept  
</I>&gt;&gt;<i> of
</I>&gt;&gt;<i> file extensions, just using .srt will work. If the format is SRT-like  
</I>&gt;&gt;<i> it's
</I>&gt;&gt;<i> likely at least some files will use .srt in practice.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> All SRT files in practice use the .srt extension - it is typically how  
</I>&gt;<i> these
</I>&gt;<i> formats are identified by applications. Just because *nix ignores file
</I>&gt;<i> extensions mostly for identifying file types doesn't mean that  
</I>&gt;<i> applications
</I>&gt;<i> do. Again, I believe strongly that re-using the same file extension is  
</I>&gt;<i> the
</I>&gt;<i> one biggest pain we can inflict on the community.
</I>
As shown above, several popular (?) media players ignore or give little  
weight to the file extension.

&gt;&gt;<i>  * Change the MIME type to something other than text/srt.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I doubt it makes any difference, as most software that deal with SRT
</I>&gt;&gt;&gt;&gt;<i> today
</I>&gt;&gt;&gt;&gt;<i> have no concept of MIME types. No matter what I'd want exactly 1 MIME
</I>&gt;&gt;&gt;&gt;<i> type
</I>&gt;&gt;&gt;&gt;<i> or alternatively make browsers ignore the MIME type completely.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> You're right in that existing SRT software probably doesn't deal much  
</I>&gt;&gt;&gt;<i> with
</I>&gt;&gt;&gt;<i> a
</I>&gt;&gt;&gt;<i> SRT mime type. Right now text/x-srt or text/srt is sometimes used for  
</I>&gt;&gt;&gt;<i> SRT
</I>&gt;&gt;&gt;<i> files, but often text/plain is also in use and more likely from a Web
</I>&gt;&gt;&gt;<i> server. Since this is the space where Web browsers play, I am not  
</I>&gt;&gt;&gt;<i> overly
</I>&gt;&gt;&gt;<i> fussed, though I think logically text/websrt makes more sense with a  
</I>&gt;&gt;&gt;<i> .wsrt
</I>&gt;&gt;&gt;<i> extension. Then, also SRT files can be served as text/websrt to allow  
</I>&gt;&gt;&gt;<i> them
</I>&gt;&gt;&gt;<i> to take part in the WebSRT infrastructure if indeed they will continue  
</I>&gt;&gt;&gt;<i> to
</I>&gt;&gt;&gt;<i> be
</I>&gt;&gt;&gt;<i> valid WebSRT files.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is there anything you expect would break if WebSRT files were served as
</I>&gt;&gt;<i> text/srt?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm asking because I don't know how anal Web browsers are about mime  
</I>&gt;<i> types.
</I>&gt;<i> I would think a Web browser should accept WebSRT and SRT files in  
</I>&gt;<i> text/plain
</I>&gt;<i> format as well as WebSRT files in text/websrt format and SRT files in
</I>&gt;<i> text/srt format. Would something break if they even came as text/html? I
</I>&gt;<i> would expect that it makes a difference when these are loaded directly  
</I>&gt;<i> as a
</I>&gt;<i> resource for display (e.g. when you directly go to
</I>&gt;<i> <A HREF="http://example.com/mycaptions.wsrt">http://example.com/mycaptions.wsrt</A>), but not when used through a &lt;track&gt;
</I>&gt;<i> element, where WebSRT is the baseline format and thus is expected.
</I>
It's actually easier for a browser to ignore the MIME type than it is to  
be strict about it, at least when the format is easily identified by  
sniffing (sniffing code is needed anyway for local files). WebSRT isn't  
very easy to sniff, so that would be an argument in favor of a mandatory  
magic header.

The main reason to care about the MIME type is some kind of &quot;doing the  
right thing&quot; by not letting people get away with misconfigured servers.  
Sometimes I feel it's just a waste of everyone's time though, it would  
generally be less work for both browsers and authors to not bother.

&gt;&gt;<i>  * Add a header to WebSRT to make it uniquely identifiable.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The header would have to be mandatory and browsers would have to  
</I>&gt;&gt;&gt;&gt;<i> reject
</I>&gt;&gt;&gt;&gt;<i> files that don't have it. Such files would be compatible with some
</I>&gt;&gt;&gt;&gt;<i> existing
</I>&gt;&gt;&gt;&gt;<i> software and break some, depending on how they sniff. We could also  
</I>&gt;&gt;&gt;&gt;<i> put
</I>&gt;&gt;&gt;&gt;<i> metadata in such a header.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Yes, I think we need to introduce a header. Maybe we can hide all the
</I>&gt;&gt;&gt;<i> structure in what SRT recognizes as comments (i.e. start the lines as  
</I>&gt;&gt;&gt;<i> &quot;;&quot;.
</I>&gt;&gt;&gt;<i> But I believe we need some hints like the @profile to identify the  
</I>&gt;&gt;&gt;<i> type of
</I>&gt;&gt;&gt;<i> the cues and the &lt;link&gt; to link to a style sheet, and we need metadata
</I>&gt;&gt;&gt;<i> like
</I>&gt;&gt;&gt;<i> the &lt;meta&gt; element of HTML headers.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I had no idea that semicolon was used for comments in SRT, is this usage
</I>&gt;&gt;<i> widespread? Does it work in most players?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I thought it was, but maybe it was just introduced for WebSRT. It is not
</I>&gt;<i> tested in Hixie's SRT research[2]. Can you take a quick look through your
</I>&gt;<i> SRT file collection if there are any? I'm probably wrong about this  
</I>&gt;<i> seeing
</I>&gt;<i> as it's not mentioned in the wiki page for SRT [3].
</I>&gt;<i>
</I>&gt;<i> [2] <A HREF="http://wiki.whatwg.org/wiki/SRT_research">http://wiki.whatwg.org/wiki/SRT_research</A>
</I>&gt;<i> [3] <A HREF="http://en.wikipedia.org/wiki/SubRip">http://en.wikipedia.org/wiki/SubRip</A>
</I>
OK, I grepped the 10000 files. Only 15 had any lines beginning with a  
semicolon, and by manual inspection it doesn't look like any of them are  
clearly intended as comments (it's hard to tell, all are in foreign  
languages). None of them were at the very beginning of the file.

&gt;&gt;<i>  * Make something deliberately incompatible with SRT.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> It doesn't make a big difference to browsers implementing the format.
</I>&gt;&gt;&gt;&gt;<i> We'd
</I>&gt;&gt;&gt;&gt;<i> be replacing something that mostly works in existing players with
</I>&gt;&gt;&gt;&gt;<i> something
</I>&gt;&gt;&gt;&gt;<i> that never works.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> That was the idea of WMML and I took that path because I thought it  
</I>&gt;&gt;&gt;<i> would
</I>&gt;&gt;&gt;<i> be
</I>&gt;&gt;&gt;<i> advantageous for other Web applications, such as built on libxml2,  
</I>&gt;&gt;&gt;<i> expat,
</I>&gt;&gt;&gt;<i> php's SimpleXML, pyexpat for python, Nokogiri for ruby etc. But I  
</I>&gt;&gt;&gt;<i> really
</I>&gt;&gt;&gt;<i> like the idea of WebSRT to allow arbitrary metadata in the cues without
</I>&gt;&gt;&gt;<i> having to put it into CDATA sections.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I don't mind creating a format that is still somewhat compatible with  
</I>&gt;&gt;&gt;<i> SRT.
</I>&gt;&gt;&gt;<i> We don't have to force incompatibility - but we should also not have it
</I>&gt;&gt;&gt;<i> restrict us. In either case, it is a new format.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm not trying to be annoying, but this seems to clash with your  
</I>&gt;&gt;<i> preference
</I>&gt;&gt;<i> to not break any existing software. Anything that resembles SRT *will*  
</I>&gt;&gt;<i> be
</I>&gt;&gt;<i> treated as SRT in some existing players.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> No, I think that's a misconception. I think most players test the file
</I>&gt;<i> extension and maybe the mime type before opening a file as srt. A quick  
</I>&gt;<i> test
</I>&gt;<i> in VLC on my Mac shows that when I go to &quot;Subtitle -&gt; Open File&quot; I am not
</I>&gt;<i> allowed to open anything that doesn't have an extension that VLC accepts  
</I>&gt;<i> -
</I>&gt;<i> they get filtered out. Thus, what the actual file looks like really  
</I>&gt;<i> doesn't
</I>&gt;<i> matter - what matter is what it sells itself as through the file  
</I>&gt;<i> extension,
</I>&gt;<i> the mime type, or some magic identifier at the beginning of the file.  
</I>&gt;<i> Which
</I>&gt;<i> is used depends on your OS and your application.
</I>
Some application use the file extension, some rely on sniffing and at  
least GStreamer (and thus Totem) weighs both of these together.

I think we've made some interesting finds in this thread, but we're  
starting to go in circles by now. Perhaps we should give it a rest until  
we get input from a third party. A medal to anyone who has followed it  
this far :)

-- 
Philip J&#228;genstedt
Core Developer
Opera Software

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="070416.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
	<LI>Next message: <A HREF="070419.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70417">[ date ]</a>
              <a href="thread.html#70417">[ thread ]</a>
              <a href="subject.html#70417">[ subject ]</a>
              <a href="author.html#70417">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
