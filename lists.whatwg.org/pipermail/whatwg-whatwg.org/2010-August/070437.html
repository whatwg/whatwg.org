<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Firing popstate for all history entry changes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Firing%20popstate%20for%20all%20history%20entry%20changes&In-Reply-To=%3CAANLkTinZYzZEXg-yqDMu8S7VM4B5SqF_jvqAkA2pAvB5%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="070435.html">
   <LINK REL="Next"  HREF="070514.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Firing popstate for all history entry changes</H1>
<!--htdig_noindex-->
    <B>Justin Lebar</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Firing%20popstate%20for%20all%20history%20entry%20changes&In-Reply-To=%3CAANLkTinZYzZEXg-yqDMu8S7VM4B5SqF_jvqAkA2pAvB5%40mail.gmail.com%3E"
       TITLE="[whatwg] Firing popstate for all history entry changes">justin.lebar at gmail.com
       </A><BR>
    <I>Wed Aug 25 15:22:41 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="070435.html">[whatwg] Firing popstate for all history entry changes
</A></li>
        <LI>Next message: <A HREF="070514.html">[whatwg] Firing popstate for all history entry changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70437">[ date ]</a>
              <a href="thread.html#70437">[ thread ]</a>
              <a href="subject.html#70437">[ subject ]</a>
              <a href="author.html#70437">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>&gt;<i> It might also help if the event wasn't called &quot;popstate&quot;, since that
</I>&gt;<i> implies a 1:1 relationship with pushState calls, but you can already
</I>&gt;<i> get popstate events without corresponding pushState calls.
</I>&gt;<i> &quot;historytraversal&quot; perhaps?
</I>
I think we've decided here that the time for major changes to this API
has past -- it's already in use in the wild.  If we *do* want to
change the API, I'd like to get in line.  :)

&gt;<i> However, it seems like the (web) developer's mental model for popstate
</I>&gt;<i> would be much simpler if it fired whenever the current session history
</I>&gt;<i> entry changed, regardless of whether it has a state object or was the
</I>&gt;<i> first entry.
</I>
This is the model Firefox uses, and we're prepared to ship it in the
upcoming release of version 4.  It's divergent from WebKit, which has
already shipped, but WebKit is going to have to change anyway.
(<A HREF="http://webkit.org/b/41372">http://webkit.org/b/41372</A>)

-Justin

On Wed, Aug 25, 2010 at 2:55 PM, Mihai Parparita &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">mihaip at chromium.org</A>&gt; wrote:
&gt;<i> There's been some discussion on <A HREF="http://webkit.org/b/41372">http://webkit.org/b/41372</A> about
</I>&gt;<i> Gecko's vs. WebKit's implementation of the popstate event. It turns
</I>&gt;<i> out that a careful reading of
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html#history-traversal,">http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html#history-traversal,</A>
</I>&gt;<i> specifically of item 10, indicates that if you have this sequence of
</I>&gt;<i> steps:
</I>&gt;<i>
</I>&gt;<i> 1. Go to a page
</I>&gt;<i> 2. Change the location's fragment to #step1
</I>&gt;<i> 3. Change the location's fragment to #step2
</I>&gt;<i> 4. Go back
</I>&gt;<i> 5. Go back
</I>&gt;<i>
</I>&gt;<i> Then popstate should be fired after every step, except for step 4
</I>&gt;<i> (test case at <A HREF="https://bugs.webkit.org/attachment.cgi?id=65467">https://bugs.webkit.org/attachment.cgi?id=65467</A>). That's
</I>&gt;<i> because in step 4 we're going back from one history entry without a
</I>&gt;<i> state object to another without a state object, and the target entry
</I>&gt;<i> is not the first one for the document either.
</I>&gt;<i>
</I>&gt;<i> However, it seems like the (web) developer's mental model for popstate
</I>&gt;<i> would be much simpler if it fired whenever the current session history
</I>&gt;<i> entry changed, regardless of whether it has a state object or was the
</I>&gt;<i> first entry. Then if someone wished to listen to all history events,
</I>&gt;<i> they would just have to use onpopstate, instead of a combination of
</I>&gt;<i> onpopstate and onhashchange.
</I>&gt;<i>
</I>&gt;<i> It might also help if the event wasn't called &quot;popstate&quot;, since that
</I>&gt;<i> implies a 1:1 relationship with pushState calls, but you can already
</I>&gt;<i> get popstate events without corresponding pushState calls.
</I>&gt;<i> &quot;historytraversal&quot; perhaps?
</I>&gt;<i>
</I>&gt;<i> Mihai
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="070435.html">[whatwg] Firing popstate for all history entry changes
</A></li>
	<LI>Next message: <A HREF="070514.html">[whatwg] Firing popstate for all history entry changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70437">[ date ]</a>
              <a href="thread.html#70437">[ thread ]</a>
              <a href="subject.html#70437">[ subject ]</a>
              <a href="author.html#70437">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
