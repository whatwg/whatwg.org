<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Race condition in media load algorithm
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Race%20condition%20in%20media%20load%20algorithm&In-Reply-To=%3Cop.vgwm7cpfsr6mfa%40philip-pc.gothenburg.osa%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="069827.html">
   <LINK REL="Next"  HREF="069868.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Race condition in media load algorithm</H1>
<!--htdig_noindex-->
    <B>Philip J&#228;genstedt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Race%20condition%20in%20media%20load%20algorithm&In-Reply-To=%3Cop.vgwm7cpfsr6mfa%40philip-pc.gothenburg.osa%3E"
       TITLE="[whatwg] Race condition in media load algorithm">philipj at opera.com
       </A><BR>
    <I>Wed Aug  4 01:29:26 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="069827.html">[whatwg] Race condition in media load algorithm
</A></li>
        <LI>Next message: <A HREF="069868.html">[whatwg] Race condition in media load algorithm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69866">[ date ]</a>
              <a href="thread.html#69866">[ thread ]</a>
              <a href="subject.html#69866">[ subject ]</a>
              <a href="author.html#69866">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, 03 Aug 2010 17:40:33 +0200, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:

&gt;<i> On 8/3/10 4:27 AM, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i> For the record, here's how I interpreted &quot;await a stable state&quot;:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The only state that is not stable is a running script.
</I>&gt;<i>
</I>&gt;<i> I don't think that's true; for example you could be in an unstable state  
</I>&gt;<i> if you're in the middle of the parser inserting some nodes into the DOM.
</I>
If the parser running in considered an unstable state, then we would have  
to wait until the whole document has finished parsing before running the  
resource selection algorithm. Thus, &lt;video&gt; would be unnecessarily delayed  
in a way that &lt;img&gt; isn't. The spec is certainly written in a way that  
makes good sense when triggering the resource selection algorithm when the  
parser first sets a src attribute or appends a child source element and  
then waiting in NETWORK_NO_SOURCE for more source elements. If this isn't  
the intention, I have really completely misunderstood what the spec is  
trying to do. Whatever the language used, I suggest letting the parser  
trigger the resource selection algorithm synchronously.

&gt;&gt;<i> Therefore, when reaching that step, if the
</I>&gt;&gt;<i> resource selection algorithm was triggered by a script, wait until that
</I>&gt;&gt;<i> script has finished and then continue.
</I>&gt;<i>
</I>&gt;<i> Per spec as currently written, this will give the wrong behavior.  For  
</I>&gt;<i> example, if the script in question calls showModalDialog, this is  
</I>&gt;<i> supposed to interrupt the script task and spin the event loop, and so  
</I>&gt;<i> your synchronous section would need to run while the modal dialog is up.  
</I>&gt;<i>   It doesn't sound like your implementation does that.
</I>
That could be, but is this behavior actually useful for anything? It's  
certainly simpler to implement and more predictable for authors to always  
wait until the current script has finished executing.

-- 
Philip J&#228;genstedt
Core Developer
Opera Software

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="069827.html">[whatwg] Race condition in media load algorithm
</A></li>
	<LI>Next message: <A HREF="069868.html">[whatwg] Race condition in media load algorithm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69866">[ date ]</a>
              <a href="thread.html#69866">[ thread ]</a>
              <a href="subject.html#69866">[ subject ]</a>
              <a href="author.html#69866">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
