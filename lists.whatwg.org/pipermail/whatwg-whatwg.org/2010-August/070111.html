<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Fwd: Discussing WebSRT and alternatives/improvements
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Fwd%3A%20Discussing%20WebSRT%20and%20alternatives/improvements&In-Reply-To=%3CAANLkTin4xOS9zs_E2gZ7PC_rnj%2BdDxJ3OTGtWvBn7VUk%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="070077.html">
   <LINK REL="Next"  HREF="070125.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Fwd: Discussing WebSRT and alternatives/improvements</H1>
<!--htdig_noindex-->
    <B>Silvia Pfeiffer</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Fwd%3A%20Discussing%20WebSRT%20and%20alternatives/improvements&In-Reply-To=%3CAANLkTin4xOS9zs_E2gZ7PC_rnj%2BdDxJ3OTGtWvBn7VUk%40mail.gmail.com%3E"
       TITLE="[whatwg] Fwd: Discussing WebSRT and alternatives/improvements">silviapfeiffer1 at gmail.com
       </A><BR>
    <I>Tue Aug 10 16:43:01 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="070077.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
        <LI>Next message: <A HREF="070125.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70111">[ date ]</a>
              <a href="thread.html#70111">[ thread ]</a>
              <a href="subject.html#70111">[ subject ]</a>
              <a href="author.html#70111">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, Aug 10, 2010 at 7:49 PM, Philip J&#228;genstedt &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>&gt;wrote:

&gt;<i> On Tue, 10 Aug 2010 01:34:02 +0200, Silvia Pfeiffer &lt;
</I>&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">silviapfeiffer1 at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>  On Tue, Aug 10, 2010 at 12:04 AM, Philip J&#228;genstedt &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>
</I>&gt;&gt;<i> &gt;wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  On Sat, 07 Aug 2010 09:57:39 +0200, Silvia Pfeiffer &lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">silviapfeiffer1 at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I guess this is in support of Henri's proposal of parsing the cue using
</I>&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;<i> HTML fragment parser (same as innerHTML)? That would be easy to
</I>&gt;&gt;&gt;<i> implement,
</I>&gt;&gt;&gt;<i> but how do we then mark up speakers? Using &lt;span class=&quot;narrator&quot;&gt;&lt;/span&gt;
</I>&gt;&gt;&gt;<i> around each cue is very verbose. HTML isn't very good for marking up
</I>&gt;&gt;&gt;<i> dialog,
</I>&gt;&gt;&gt;<i> which is quite a limitation when dealing with subtitles...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I actually think that the &lt;span @class&gt; mechanism is much more flexible
</I>&gt;&gt;<i> than
</I>&gt;&gt;<i> what we have in WebSRT right now. If we want multiple speakers to be able
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> speak in the same subtitle, then that's not possible in WebSRT. It's a
</I>&gt;&gt;<i> little more verbose in HTML, but not massively.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We might be able to add a special markup similar to the &lt;[timestamp]&gt;
</I>&gt;&gt;<i> markup
</I>&gt;&gt;<i> that Hixie introduced for Karaoke. This is beyond the innerHTML parser and
</I>&gt;&gt;<i> I
</I>&gt;&gt;<i> am not sure if it breaks it. But if it doesn't, then maybe we can also
</I>&gt;&gt;<i> introduce a &lt;[voice]&gt; marker to be used similarly?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> An HTML parser parsing &lt;1&gt; or &lt;00:01:30&gt; will produce text nodes &quot;&lt;1&gt;&quot; and
</I>&gt;<i> &quot;&lt;00:01:30&gt;&quot;. Without having read the HTML parsing algorithm I guess that
</I>&gt;<i> elements need to begin with a letter or similar. So, it's not possible to
</I>&gt;<i> (ab)use the HTML parser to handle inner timestamps of numerical voices, we'd
</I>&gt;<i> have to replace those with something else, probably more verbose.
</I>


I have checked the parse spec and
<A HREF="http://www.whatwg.org/specs/web-apps/current-work/#tag-open-state">http://www.whatwg.org/specs/web-apps/current-work/#tag-open-state</A> indeed
implies that a tag starting with a number is a parse error. Both, the
timestamps and the voice markers thus seem problems when going with an
innerHTML parser. Is there a way to resolve this? I mean: I'd quite happily
drop the voice markers for a &lt;span @class&gt; but I am not sure what to do
about the timestamps. We could do what I did in WMML and introduce a &lt;t&gt;
element with the timestamp as a @at attribute, but that is again more
verbose. We could also introduce an @at attribute in &lt;span&gt; which would then
at least end up in the DOM and can be dealt with specially.

Just for those who think it's a fancy karaoke feature and isn't really
required: it's actually also a useful feature for captions, in particular
when recording live captions that are usually &quot;paint-on&quot;. Requirement CC-14
on <A HREF="http://www.w3.org/WAI/PF/HTML/wiki/Media_Accessibility_Requirements">http://www.w3.org/WAI/PF/HTML/wiki/Media_Accessibility_Requirements</A> also
refers to this need and 608/708 captions provide this functionality, too.



&gt;<i>
</I>&gt;&gt;&gt;<i> Similarly, I think that the WebSRT parser should be designed to ignore
</I>&gt;&gt;&gt;<i> things that it doesn't recognize, in particular unknown voices (if we
</I>&gt;&gt;&gt;<i> keep
</I>&gt;&gt;&gt;<i> those). Requiring parsers to fail when the version number is increased
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> oh, you misunderstood me: I am not saying that parser have to fail - it's
</I>&gt;&gt;<i> good if they don't. But I am saying that if we make a change to the
</I>&gt;&gt;<i> specification that is not backwards compatible with the previous one and
</I>&gt;&gt;<i> will thus invariably break parsers, we have to notify parsers somehow such
</I>&gt;&gt;<i> that if they get parse errors they can e.g. notify the user that this is a
</I>&gt;&gt;<i> new version of the WebSRT format which their software doesn't support yet.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> A browser won't bother their users by saying &quot;hey, there was something in
</I>&gt;<i> this page I didn't understand&quot;, as users won't know what to do to fix it.
</I>


I'm not overly worried about browsers. They will just display the wrong
text. They are not normally an authoring or transcoding application. I am
more worried about non-browser applications here, in particular those where
interpreting the text the wrong way will lead to disaster, such as the wrong
data in an archive etc.



&gt;<i>
</I>&gt;<i>  Think for example about the case where we had a requirement that a double
</I>&gt;&gt;<i> newline starts a new cue, but now we want to introduce a means where the
</I>&gt;&gt;<i> double newline is escaped and can be made part of a cue.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Other formats keep track of their version, such as MS Word files. It is to
</I>&gt;&gt;<i> be hoped that most new features can be introduced without breaking
</I>&gt;&gt;<i> backwards
</I>&gt;&gt;<i> compatibility and we can write the parsing requirements such that certain
</I>&gt;&gt;<i> things will be ignored, but in and of itself, WebSRT doesn't provide for
</I>&gt;&gt;<i> this extensibility. Right now, there is for example extensibility with the
</I>&gt;&gt;<i> &quot;WebSRT settings parsing&quot; (that's the stuff behind the timestamps) where
</I>&gt;&gt;<i> further &quot;setting:value&quot; settings can be introduced. But for example the
</I>&gt;&gt;<i> introduction of new &quot;cue identifiers&quot; (that's the &lt;&gt; marker at the start
</I>&gt;&gt;<i> of
</I>&gt;&gt;<i> a cue) would be difficult without a version string, since anything that
</I>&gt;&gt;<i> doesn't match the given list will just be parsed as cue-internal tag and
</I>&gt;&gt;<i> thus end up as part of the cue text where plain text parsing is used.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The bug I filed suggested allowing arbitrary voices, to simplify the parser
</I>&gt;<i> and to make future extensions possible. For a web format I think this is a
</I>&gt;<i> better approach format than versioning. I haven't done a full review of the
</I>&gt;<i> parser, but there are probably more places where it could be more forgiving
</I>&gt;<i> so as to allow future tweaking.
</I>


That's a good approach and will reduce the need for breaking
backwards-compatibility. In an xml-based format that need is 0, while with a
text format where the structure is ad-hoc, that need can never be reduced to
0. That's what I am concerned about and that's why I think we need a version
identifier. If we end up never using/changing the version identifier, the
better so. But I'd much rather we have it now and can identify what
specification a file adheres to than not being able to do so later.




&gt;<i>
</I>&gt;<i>  On the other hand, keeping the same extension and (unregistered) MIME type
</I>&gt;&gt;&gt;<i> as SRT has plenty of benefits, such as immediately being able to use
</I>&gt;&gt;&gt;<i> existing SRT files in browsers without changing their file extension or
</I>&gt;&gt;&gt;<i> MIME
</I>&gt;&gt;&gt;<i> type.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> There is no harm for browsers to accept both MIME types if they are sure
</I>&gt;&gt;<i> they can parse old srt as well as new websrt. But these two formats are
</I>&gt;&gt;<i> different enough that they should be given a different extension and mime
</I>&gt;&gt;<i> type. I do not see a single advantage in stealing the MIME type of an
</I>&gt;&gt;<i> existing format for a new specification.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> But there's no spec for the old SRT, the only thing one could do is parser
</I>&gt;<i> it with a WebSRT parser.
</I>

I can write that spec in an afternoon and register the mime type with IANA.
That really isn't a problem. People have managed to write correct SRT files
without having a spec, because it's so trivial. Creating a spec is just a
formality. For now, the wikipedia page really is sufficient.



&gt;<i> That would make text/srt and text/websrt synonymous, which is kind of
</I>&gt;<i> pointless.
</I>

No, it's only pointless if you are a browser vendor. For everyone else it is
a huge advantage to be able to choose between a guaranteed simple format and
a complex format with all the bells and whistles.



&gt;<i> The advantages of taking text/srt is that all existing software to create
</I>&gt;<i> SRT can be used to create WebSRT
</I>

That's not strictly true. If they load a WebSRT file that was created by
some other software for further editing and that WebSRT file uses advanced
WebSRT functionality, the authoring software will break.



&gt;<i> and servers that already send text/srt don't need to be updated. In either
</I>&gt;<i> case I think we should support only one mime type.
</I>

What's the harm in supporting two mime types but using the same parser to
parse them?



&gt;<i>   * there is no definition of the &quot;canvas&quot; dimensions that the cues are
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>  prepared for (width/height) and expected to work with other than
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> saying
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> it
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> is the video dimensions - but these can change and the proportions
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> should
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> be
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> changed with that
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>  I'm not sure what you're saying here. Should the subtitle file be
</I>&gt;&gt;&gt;&gt;&gt;<i> hard-coded to a particular size? In the quite peculiar case where the
</I>&gt;&gt;&gt;&gt;&gt;<i> same
</I>&gt;&gt;&gt;&gt;&gt;<i> subtitles really don't work at two different resolutions, couldn't we
</I>&gt;&gt;&gt;&gt;&gt;<i> just
</I>&gt;&gt;&gt;&gt;&gt;<i> have two files? In what cases would this be needed?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Most subtitles will be created with a specific width and height in mind.
</I>&gt;&gt;&gt;&gt;<i> For
</I>&gt;&gt;&gt;&gt;<i> example, the width in characters relies on the video canvas having at
</I>&gt;&gt;&gt;&gt;<i> least
</I>&gt;&gt;&gt;&gt;<i> that size and the number of lines used usually refers to a lower third
</I>&gt;&gt;&gt;&gt;<i> of
</I>&gt;&gt;&gt;&gt;<i> a
</I>&gt;&gt;&gt;&gt;<i> video - where that is too small, it might cover the whole video. So, my
</I>&gt;&gt;&gt;&gt;<i> proposal is not the hard-code the subtitles to a particular size, but to
</I>&gt;&gt;&gt;&gt;<i> put
</I>&gt;&gt;&gt;&gt;<i> the minimum width and height that are being used for the creation of the
</I>&gt;&gt;&gt;&gt;<i> subtitles into the file. Then, the file can be scaled below or above
</I>&gt;&gt;&gt;&gt;<i> this
</I>&gt;&gt;&gt;&gt;<i> size to adjust to the actual available space.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In practice, does this mean scaling font-size by
</I>&gt;&gt;&gt;<i> width_actual/width_intended or similar? Personally, I prefer subtitles to
</I>&gt;&gt;&gt;<i> be
</I>&gt;&gt;&gt;<i> something like 20 screen pixels regardless of video size, as that is
</I>&gt;&gt;&gt;<i> readable. Making them bigger hides more of the video, while making them
</I>&gt;&gt;&gt;<i> smaller makes them hard to read. But I guess we could let the CSS media
</I>&gt;&gt;&gt;<i> query min-width and similar be evaluated against the size of the
</I>&gt;&gt;&gt;<i> containing
</I>&gt;&gt;&gt;<i> video element, to make it possible anyway.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Have you ever tried to keep the small font size of subtitles on a 320x240
</I>&gt;&gt;<i> video when going full-screen? They are almost unusable at that size.
</I>&gt;&gt;<i> YouTube
</I>&gt;&gt;<i> doesn't do a good job at that, incidentally, so you can go check it out
</I>&gt;&gt;<i> there - go full-screen and see how tiny the captions become then step back
</I>&gt;&gt;<i> from your screen to where you'd want to watch the video from and notice
</I>&gt;&gt;<i> how
</I>&gt;&gt;<i> the captions are basically unreadable.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When you scale the font-size with the video, you do not hide more of the
</I>&gt;&gt;<i> video - you hide the exact same part of the video. Video and font get
</I>&gt;&gt;<i> larger
</I>&gt;&gt;<i> in the same way. And that's exactly the need that we have.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Existing media players have basically two different ways of handling this.
</I>&gt;<i> The kind you're describing is like MPlayer, where subtitles appear to
</I>&gt;<i> actually be rendered on to the video frames and then scaled together with
</I>&gt;<i> the video. The kind I've used more is like Totem, where subtitles are
</I>&gt;<i> rendered in a separate layer at a fixed size in pixels, regardless of
</I>&gt;<i> whether or not you're watching in fullscreen. This means that word wrapping
</I>&gt;<i> will be different depending on screen size.
</I>

In the Totem case, does the font size increase with a change in screen size?

My suggestion is to have them in different layers, but there is knowledge
about the intended anchoring, i.e. where is the text supposed to appear on
the video screen. The keep that anchoring intact no matter what the video
size.



&gt;<i> I find both MPlayer's and Totem's behavior annoying in some situations, but
</I>&gt;<i> personally prefer Totem most of the time.
</I>&gt;<i>
</I>
Do you find MPlayer's behavior annoying because by rescaling already
rendered text, the text loses resolution and becomes less readable? This is
definitely not the behaviour I am after.

Cheers,
Silvia.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100811/9df8d382/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100811/9df8d382/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="070077.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
	<LI>Next message: <A HREF="070125.html">[whatwg] Fwd: Discussing WebSRT and alternatives/improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70111">[ date ]</a>
              <a href="thread.html#70111">[ thread ]</a>
              <a href="subject.html#70111">[ subject ]</a>
              <a href="author.html#70111">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
