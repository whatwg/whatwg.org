<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] HTML Cookie API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML%20Cookie%20API&In-Reply-To=%3C5dd9e5c51002241220q1c448c9do2a8bbfcb67dd4be1%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="067603.html">
   <LINK REL="Next"  HREF="067605.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] HTML Cookie API</H1>
<!--htdig_noindex-->
    <B>Jeremy Orlow</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML%20Cookie%20API&In-Reply-To=%3C5dd9e5c51002241220q1c448c9do2a8bbfcb67dd4be1%40mail.gmail.com%3E"
       TITLE="[whatwg] HTML Cookie API">jorlow at chromium.org
       </A><BR>
    <I>Wed Feb 24 12:20:11 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="067603.html">[whatwg] HTML Cookie API
</A></li>
        <LI>Next message: <A HREF="067605.html">[whatwg] HTML Cookie API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67604">[ date ]</a>
              <a href="thread.html#67604">[ thread ]</a>
              <a href="subject.html#67604">[ subject ]</a>
              <a href="author.html#67604">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Feb 24, 2010 at 9:07 PM, David Flanagan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">david at davidflanagan.com</A>&gt;wrote:

&gt;<i> Jeremy Orlow wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> Also note that the spec currently has the notion of a storage mutex which
</I>&gt;&gt;<i> should be taken whenever a script tries to access a cookie (or local
</I>&gt;&gt;<i> storage) and is held until the script finishes.  The network stack is also
</I>&gt;&gt;<i> supposed to take this lock whenever getting or setting a cookie.  No one has
</I>&gt;&gt;<i> implemented the storage mutex or stated any intention of doing so because
</I>&gt;&gt;<i> this is basically impossible today.  But, if there were an asynchronous API
</I>&gt;&gt;<i> that most people were using, it actually could be possible that we'd want to
</I>&gt;&gt;<i> implement such a mutex since cookies would then obey run to completion
</I>&gt;&gt;<i> semantics without having serious lock contention.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> Well if no one is going to implement the storage mutex, then I probably
</I>&gt;<i> need to retract my last message
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  But yeah.  Definitely any API that touches information spanning tabs (and
</I>&gt;&gt;<i> probably even APIs spanning origins within those tabs) really should be
</I>&gt;&gt;<i> designed in an async manor from now on.  Otherwise we're just digging the
</I>&gt;&gt;<i> whole deeper in terms of forcing ourselves into a single threaded world.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> J
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I worry that this comes down to web developers who want simple APIs vs
</I>&gt;<i> browser implementors who say we can't have them (at least not if we also
</I>&gt;<i> want speed.)
</I>&gt;<i>
</I>&gt;<i> Concurrency issues are not my strong suit, but shouldn't it be possible to
</I>&gt;<i> have safe, synchronous read-only access to cookies (caching volatile values
</I>&gt;<i> like cookies within each thread and then clearing that cache when the thread
</I>&gt;<i> returns to the event loop).  Can't the requirement for a mutex or an
</I>&gt;<i> asynchronous API be limited to setCookie()?
</I>&gt;<i>
</I>
&gt;<i>From a technical standpoint, this is very doable.  And, done right, I think
</I>I could be in favor of it.

But I believe the counter argument is that any relaxation of run
to completion semantics is going to confuse developers and probably result
in them writing racy code without realizing it.  Many developers won't
understand when it's safe to use the cached value vs needing to use the
asynchronous interface.  And if the less safe one is easier to use....

I agree that asynchronous interfaces have disadvantages, but as far as I can
tell many of them are costs that you pay once (learning them and getting use
to them) or once per app (if you handle one asynchronous call or need to use
setTimeout, then probably using another won't require too much restructuring
of your code).  Maybe I'm just a browser developer who's completely out of
touch with reality though.  :-)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100224/ef58d2f4/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100224/ef58d2f4/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="067603.html">[whatwg] HTML Cookie API
</A></li>
	<LI>Next message: <A HREF="067605.html">[whatwg] HTML Cookie API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67604">[ date ]</a>
              <a href="thread.html#67604">[ thread ]</a>
              <a href="subject.html#67604">[ subject ]</a>
              <a href="author.html#67604">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
