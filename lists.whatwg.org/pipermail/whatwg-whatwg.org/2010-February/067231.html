<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Canvas size and double buffering.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%20size%20and%20double%20buffering.&In-Reply-To=%3C62C1D44C-BA0B-4A3A-BC1D-6590DF3EACA4%40continuation.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="067228.html">
   <LINK REL="Next"  HREF="067232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Canvas size and double buffering.</H1>
<!--htdig_noindex-->
    <B>Brian Campbell</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%20size%20and%20double%20buffering.&In-Reply-To=%3C62C1D44C-BA0B-4A3A-BC1D-6590DF3EACA4%40continuation.org%3E"
       TITLE="[whatwg] Canvas size and double buffering.">lambda at continuation.org
       </A><BR>
    <I>Wed Feb  3 21:50:09 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="067228.html">[whatwg] Canvas size and double buffering.
</A></li>
        <LI>Next message: <A HREF="067232.html">[whatwg] Canvas size and double buffering.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67231">[ date ]</a>
              <a href="thread.html#67231">[ thread ]</a>
              <a href="subject.html#67231">[ subject ]</a>
              <a href="author.html#67231">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Feb 3, 2010, at 7:00 PM, Tim Hutt wrote:

&gt;<i> On 3 February 2010 23:16, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:
</I>&gt;&gt;<i> On 2/3/10 6:12 PM, Tim Hutt wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Ah yes that works nicely
</I>&gt;<i> 
</I>&gt;<i> Hmm maybe I spoke too soon. The interaction of the CSS size and the
</I>&gt;<i> canvas.width/height is confounding! It seems if you set a CSS width
</I>&gt;<i> of, say 80% then that is that and you are stuck with it. Unfortunately
</I>&gt;<i> it doesn't round to the nearest pixel!
</I>&gt;<i> 
</I>&gt;<i> I have created a test case here:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://concentriclivers.com/canvas.html">http://concentriclivers.com/canvas.html</A> (the source is nicely
</I>&gt;<i> formatted and very short)
</I>&gt;<i> 
</I>&gt;<i> If anyone can get it to work as described on that page, then thank
</I>&gt;<i> you! Otherwise I think things need to be changed to make it possible.
</I>
That example:
  * Works for me in Chrome (5.0.307.1 dev, all browsers listed are on Mac OS X 10.6.2).
  * Works in Safari (WebKit nightly 6531.21.10, r54122) except for when you cause a scroll bar to appear or disappear by resizing; then you get a moir&#233; pattern in the vertical stripes until you resize again. It appears that you get the resize event before the scrollbar appears, so the scrollbar appearing causes the canvas to scale down without sending a resize event allowing the canvas to redraw.
  * Doesn't work in Firefox (3.6). At most sizes, you get grey lines, due to the non-integral width; only occasionally does it look correct. Also, the canvas always resizes to a square; does Firefox try to preserve the aspect ratio when scaling a canvas in one dimension only?
  * Fails badly in Opera (10.10). It fails to redraw because &quot;width&quot; and &quot;height&quot; aren't defined on the BoundingClientRect; just left, right, top, and bottom. For some reason it also ignores the 500px height of the canvas given in the HTML, instead using the default of 300x150, with the width overridden to 80%.

I think the most reasonable approach would be to say that the getBoundingClientRect().width or height is rounded to the nearest pixel. Boxes are displayed rounded to the nearest pixel, with no fractional pixels being drawn, right? Why would they report a width or height that is different than how they are displayed? All browsers that I've tested (the ones listed above, so not IE) report integral values for getBoundingClientRect().width and height (or for left and right in the case of Opera, which doesn't support width and height).

-- Brian
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="067228.html">[whatwg] Canvas size and double buffering.
</A></li>
	<LI>Next message: <A HREF="067232.html">[whatwg] Canvas size and double buffering.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67231">[ date ]</a>
              <a href="thread.html#67231">[ thread ]</a>
              <a href="subject.html#67231">[ subject ]</a>
              <a href="author.html#67231">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
