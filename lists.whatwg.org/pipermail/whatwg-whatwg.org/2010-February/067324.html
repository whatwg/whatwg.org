<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] &lt;video&gt; feedback
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Cvideo%3E%20feedback&In-Reply-To=%3C847CE927-11F4-4411-A18C-CF4815ED6CAF%40apple.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="067321.html">
   <LINK REL="Next"  HREF="067327.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] &lt;video&gt; feedback</H1>
<!--htdig_noindex-->
    <B>Eric Carlson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Cvideo%3E%20feedback&In-Reply-To=%3C847CE927-11F4-4411-A18C-CF4815ED6CAF%40apple.com%3E"
       TITLE="[whatwg] &lt;video&gt; feedback">eric.carlson at apple.com
       </A><BR>
    <I>Wed Feb 10 10:37:32 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="067321.html">[whatwg] &lt;video&gt; feedback
</A></li>
        <LI>Next message: <A HREF="067327.html">[whatwg] &lt;video&gt; feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67324">[ date ]</a>
              <a href="thread.html#67324">[ thread ]</a>
              <a href="subject.html#67324">[ subject ]</a>
              <a href="author.html#67324">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On Feb 10, 2010, at 8:01 AM, Brian Campbell wrote:

&gt;<i> On Feb 9, 2010, at 9:03 PM, Ian Hickson wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> On Sat, 31 Oct 2009, Brian Campbell wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> At 4 timeupdate events per second, it isn't all that useful. I can 
</I>&gt;&gt;&gt;<i> replace it with setInterval, at whatever rate I want, query the time, 
</I>&gt;&gt;&gt;<i> and get the synchronization I need, but that makes the timeupdate event 
</I>&gt;&gt;&gt;<i> seem to be redundant.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The important thing with timeupdate is that it also fires whenever the 
</I>&gt;&gt;<i> time changes in a significant way, e.g. immediately after a seek, or when 
</I>&gt;&gt;<i> reaching the end of the resource, etc. Also, the user agent can start 
</I>&gt;&gt;<i> lowering the rate in the face of high CPU load, which makes it more 
</I>&gt;&gt;<i> user-friendly than setInterval().
</I>&gt;<i> 
</I>&gt;<i> I agree, it is important to be able to reduce the rate in the face of high CPU load, but as currently implemented in WebKit, if you use timeupdate to keep anything in sync with the video, it feels fairly laggy and jerky. This means that for higher quality synchronization, you need to use setInterval, which defeats the purpose of making timeupdate more user friendly.
</I>&gt;<i> 
</I>&gt;<i> Perhaps this is just a bug I should file to WebKit, as they are choosing an update interval at the extreme end of the allowed range for their default behavior; but I figured that it might make sense to mention a reasonable default value (such as 30 times per second, or once per frame displayed) in the spec, to give some guidance to browser vendors about what authors will be expecting.
</I>&gt;<i> 
</I>  I disagree that 30 times per second is a &quot;reasonable default&quot;. I understand that it would be useful for what you want to do, but your use case is not a typical. I think most pages won't listen for 'timeupdate' events at all so instead of making every page incur the extra overhead of waking up, allocating, queueing, and firing an event 30 times per second, WebKit sticks with  the minimum frequency the spec mandates figuring that people like you that need something more can roll their own.


&gt;&gt;<i> On Thu, 5 Nov 2009, Brian Campbell wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Would something like &lt;video&gt; firing events for every frame rendered 
</I>&gt;&gt;&gt;&gt;<i> help you out?  This would help also fix the &lt;canvas&gt; over/under 
</I>&gt;&gt;&gt;&gt;<i> painting issue and improve synchronization.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Yes, this would be considerably better than what is currently specced.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> There surely is a better solution than copying data from the &lt;video&gt; 
</I>&gt;&gt;<i> element to a &lt;canvas&gt; on every frame for whatever the problem that that 
</I>&gt;&gt;<i> solves is. What is the actual use case where you'd do that?
</I>&gt;<i> 
</I>&gt;<i> This was not my use case (my use case was just synchronizing bullets, slide transitions, and animations to video), but an example I can think of is using this to composite video. Most (if not all) video formats supported by &lt;video&gt; in the various browsers do not store alpha channel information. In order to composite video against a dynamic background, authors may copy video data to a canvas, then paint transparent to all pixels matching a given color.
</I>&gt;<i> 
</I>&gt;<i> This use case would clearly be better served by video formats that include alpha information, and implementations that support compositing video over other content, but given that we're having trouble finding any video format at all that the browsers can agree on, this seems to be a long way off, so stop-gap measures may be useful in the interim.
</I>&gt;<i> 
</I>&gt;<i> Compositing video over dynamic content is actually an extremely important use case for rich, interactive multimedia, which I would like to encourage browser vendors to implement, but I'm not even sure where to start, given the situation on formats and codecs. I believe I've seen this discussed in Theora, but never went anywhere, and I don't have any idea how I'd even start getting involved in the MPEG standardization process.
</I>&gt;<i> 
</I>  Have you actually tried this? Rendering video frames to a canvas and processing every pixel from script is *extremely* processor intensive, you are unlikely to get reasonable frame rate. 

  The H.262 does support alpha (see AVC spec 2nd edition, section 7.3.2.1.2 Sequence parameter set extension), but we do not support it correctly in WebKit at the moment. *Please* file bugs against WebKit if you would like to see this properly supported. QuickTime movies support alpha for a number of video formats (eg. png, animation, lossless, etc), you might give that a try.

eric

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="067321.html">[whatwg] &lt;video&gt; feedback
</A></li>
	<LI>Next message: <A HREF="067327.html">[whatwg] &lt;video&gt; feedback
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67324">[ date ]</a>
              <a href="thread.html#67324">[ thread ]</a>
              <a href="subject.html#67324">[ subject ]</a>
              <a href="author.html#67324">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
