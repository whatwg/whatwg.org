<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] some thoughts on sandboxed IFRAMEs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20some%20thoughts%20on%20sandboxed%20IFRAMEs&In-Reply-To=%3C448e9a321002040944w169b27a1i1b6a8757bf3bb787%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="067248.html">
   <LINK REL="Next"  HREF="067257.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] some thoughts on sandboxed IFRAMEs</H1>
<!--htdig_noindex-->
    <B>Michal Zalewski</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20some%20thoughts%20on%20sandboxed%20IFRAMEs&In-Reply-To=%3C448e9a321002040944w169b27a1i1b6a8757bf3bb787%40mail.gmail.com%3E"
       TITLE="[whatwg] some thoughts on sandboxed IFRAMEs">lcamtuf at coredump.cx
       </A><BR>
    <I>Thu Feb  4 09:44:03 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="067248.html">[whatwg] some thoughts on sandboxed IFRAMEs
</A></li>
        <LI>Next message: <A HREF="067257.html">[whatwg] some thoughts on sandboxed IFRAMEs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67250">[ date ]</a>
              <a href="thread.html#67250">[ thread ]</a>
              <a href="subject.html#67250">[ subject ]</a>
              <a href="author.html#67250">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>&gt;<i> Not escaping &quot; is so easily and quickly discovered that I really don't
</I>&gt;<i> think that's a problem.
</I>
The same argument could be made for not escaping &lt;, but I don't think
it's valid in practice - particularly for (hypothetically) constrained
input fields.

&gt;&gt;<i> That would be great. I think Adam proposed we have a separate
</I>&gt;&gt;<i> sandbox=&quot;...&quot; toggle for this. Whether it's on or off by default
</I>&gt;&gt;<i> probably doesn't matter much.
</I>&gt;<i> Adam's feedback (not quoted here, but in the same thread as the e-mail to
</I>&gt;<i> which this is a reply) suggests that this is actually a bad idea, so I've
</I>&gt;<i> not changed this.
</I>
There are obvious, existing usage cases where sites struggle to
prevent automated resource loading across domains - e.g., almost every
HTML-supporting mail client; so it strikes me that if we go along with
this reasoning because a perfect solution may not exist, we're also
effectively saying that what they are doing should not be attempted at
all (then what's the alternative? one should probably be a part of
HTML5).

&gt;<i> If there's no HTML, there's no need for a sandbox, so the simplest
</I>&gt;<i> solution is just to escape the &lt;s and &amp;s.
</I>
Which people fail at, big time. There are 50,000+ entries on
xssed.com, many of them against big sites presumably developed by
skilled developers with the help of sophisticated frameworks -
microsoft.com, google.com, amazon.com, ebay.com, etc. It is a really
low-effort tweak to accommodate it here, and it may offer a very
significant security benefit, so...?

&gt;&gt;<i> Keep in mind that pretty much every web application already needs to
</I>&gt;&gt;<i> safely generate unique, unpredictable tokens - for session identifiers
</I>&gt;&gt;<i> that guard authenticated sessions. If they can't get it right, they are
</I>&gt;&gt;<i> hosed anyway - but problems here are not horribly common, in my
</I>&gt;&gt;<i> experience at least, and web app frameworks do a decent job of helping
</I>&gt;&gt;<i> developers by providing token-generating facilities.
</I>&gt;<i>
</I>&gt;<i> Pretty much the same can be said of escaping text.
</I>&gt;<i>
</I>&gt;<i> Also, based on Adam's comments, it seems that things aren't really as rosy
</I>&gt;<i> as all that for token generators.
</I>
I think the difference is huge; in a typical web framework, you need
to explicitly escape every single piece of potentially dangerous
attacker-controlled input to stay safe - and because people tend to do
some validation at input stage, it's very difficult to audit for it.
Escaping also needs to be very different depending on the context
(URLs need to be encoded differently than HTML parameters, and
differently than standalone text).

So even though your framework may provide several escape() functions,
it's very easy to get it wrong, and people constantly do. OTOH, if
your framework provides a get_token() function, there's really not
that much to using it properly.

I'm coming from a background of doing lots of security reviews for
existing applications, so while I appreciate that the difference may
be subtle, the real-world error patterns speak to me pretty strongly;
and I do think that insufficient escaping is drastically more common
than used, but insufficiently unpredictable XSRF tokens.

/mz

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="067248.html">[whatwg] some thoughts on sandboxed IFRAMEs
</A></li>
	<LI>Next message: <A HREF="067257.html">[whatwg] some thoughts on sandboxed IFRAMEs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67250">[ date ]</a>
              <a href="thread.html#67250">[ thread ]</a>
              <a href="subject.html#67250">[ subject ]</a>
              <a href="author.html#67250">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
