<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Binary Streaming with XHR
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Binary%20Streaming%20with%20XHR&In-Reply-To=%3CCAJhzemU%2BA_052%3Dj0O3oOsTG1qGAbmGo0qxmdJ7qqeGGt%2Bn%3DzRA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036979.html">
   <LINK REL="Next"  HREF="079254.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Binary Streaming with XHR</H1>
<!--htdig_noindex-->
    <B>Jussi Kalliokoski</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Binary%20Streaming%20with%20XHR&In-Reply-To=%3CCAJhzemU%2BA_052%3Dj0O3oOsTG1qGAbmGo0qxmdJ7qqeGGt%2Bn%3DzRA%40mail.gmail.com%3E"
       TITLE="[whatwg] Binary Streaming with XHR">jussi.kalliokoski at gmail.com
       </A><BR>
    <I>Fri Aug 24 03:23:03 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="036979.html">[whatwg] MediaController events
</A></li>
        <LI>Next message: <A HREF="079254.html">[whatwg] Binary Streaming with XHR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36980">[ date ]</a>
              <a href="thread.html#36980">[ thread ]</a>
              <a href="subject.html#36980">[ subject ]</a>
              <a href="author.html#36980">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hello,

I've got a little proposal to solve a problem we're facing with one of our
codebases ( aurora.js [1], i.e. audio codecs in JavaScript ).

We need to stream the audio files (you don't want to store a 2 hour long
live stream in the memory or wait until a whole file is loaded before
playing). Currently we're using partial requests to fetch the data, but
it's very expensive both in terms of CPU (currently the streaming takes
more CPU than the actual decoding, I suspect this is a sum of garbage
collection and other factors) and network.

My proposal is that we add a feature for streaming to XHRs that are of the
arraybuffer response type.

My first idea was that if you set a property called &quot;chunkSize&quot; on the XHR,
it would start dispatching an event called &quot;onchunk&quot; whenever a chunk of
that size has been loaded. That event would contain a property &quot;chunk&quot; that
would be an array buffer containing that data. However, I'm having second
thoughts on that approach as it is likely to produce a lot of garbage.

Instead, my refined idea is that you'd set a &quot;chunk&quot; property on the XHR to
an ArrayBuffer, and each time a chunk of the size of the &quot;chunk&quot; was ready,
it would set the values of the &quot;chunk&quot; property accordingly and the
&quot;onchunk&quot; event would be dispatched.

Thoughts?

Cheers,
Jussi

[1] <A HREF="https://github.com/ofmlabs/aurora.js">https://github.com/ofmlabs/aurora.js</A>
</PRE>






<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036979.html">[whatwg] MediaController events
</A></li>
	<LI>Next message: <A HREF="079254.html">[whatwg] Binary Streaming with XHR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36980">[ date ]</a>
              <a href="thread.html#36980">[ thread ]</a>
              <a href="subject.html#36980">[ subject ]</a>
              <a href="author.html#36980">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
