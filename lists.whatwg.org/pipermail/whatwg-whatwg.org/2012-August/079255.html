<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Binary Streaming with XHR
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Binary%20Streaming%20with%20XHR&In-Reply-To=%3CCAJhzemVbt625WZR6i91OXoJULUHJW07hUcf8VNsWpyF2qZjdVw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="079254.html">
   <LINK REL="Next"  HREF="079256.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Binary Streaming with XHR</H1>
<!--htdig_noindex-->
    <B>Jussi Kalliokoski</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Binary%20Streaming%20with%20XHR&In-Reply-To=%3CCAJhzemVbt625WZR6i91OXoJULUHJW07hUcf8VNsWpyF2qZjdVw%40mail.gmail.com%3E"
       TITLE="[whatwg] Binary Streaming with XHR">jussi.kalliokoski at gmail.com
       </A><BR>
    <I>Fri Aug 24 05:19:43 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="079254.html">[whatwg] Binary Streaming with XHR
</A></li>
        <LI>Next message: <A HREF="079256.html">[whatwg] Binary Streaming with XHR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79255">[ date ]</a>
              <a href="thread.html#79255">[ thread ]</a>
              <a href="subject.html#79255">[ subject ]</a>
              <a href="author.html#79255">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Fri, Aug 24, 2012 at 3:04 PM, Nils Dagsson Moskopp &lt;
<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">nils at dieweltistgarnichtso.net</A>&gt; wrote:

&gt;<i> Jussi Kalliokoski &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jussi.kalliokoski at gmail.com</A>&gt; schrieb am Fri, 24 Aug
</I>&gt;<i> 2012 13:23:03 +0300:
</I>&gt;<i>
</I>&gt;<i> &gt;[&#8230;]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; My first idea was that if you set a property called &quot;chunkSize&quot; on
</I>&gt;<i> &gt; the XHR, it would start dispatching an event called &quot;onchunk&quot;
</I>&gt;<i> &gt; whenever a chunk of that size has been loaded. That event would
</I>&gt;<i> &gt; contain a property &quot;chunk&quot; that would be an array buffer containing
</I>&gt;<i> &gt; that data. However, I'm having second thoughts on that approach as it
</I>&gt;<i> &gt; is likely to produce a lot of garbage.
</I>&gt;<i>
</I>&gt;<i> Can you elaborate on the nature of the lot of garbage you are expecting?
</I>&gt;<i>
</I>
Yes. The &quot;chunk&quot; property on the event would be a fresh ArrayBuffer, so
unless it gets bound somewhere, it becomes garbage.


&gt;<i> &gt; Instead, my refined idea is that you'd set a &quot;chunk&quot; property on the
</I>&gt;<i> &gt; XHR to an ArrayBuffer, and each time a chunk of the size of the
</I>&gt;<i> &gt; &quot;chunk&quot; was ready, it would set the values of the &quot;chunk&quot; property
</I>&gt;<i> &gt; accordingly and the &quot;onchunk&quot; event would be dispatched.
</I>&gt;<i>
</I>&gt;<i> Maybe I have not understood it, but at first glance that approach seems
</I>&gt;<i> prone to race conditions. What happens if the next chunk is ready while
</I>&gt;<i> the &#8220;onchunk&#8220; event for the last one has not been processed? Does the
</I>&gt;<i> &#8220;chunk&#8221; property get overwritten and the previous chunk's data is lost?
</I>&gt;<i>
</I>
This is not the case, let me clarify. Setting the chunk would be scheduled
in the event loop, so unless the event loop is leaking, no race conditions
should happen.

Cheers, Jussi

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="079254.html">[whatwg] Binary Streaming with XHR
</A></li>
	<LI>Next message: <A HREF="079256.html">[whatwg] Binary Streaming with XHR
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79255">[ date ]</a>
              <a href="thread.html#79255">[ thread ]</a>
              <a href="subject.html#79255">[ subject ]</a>
              <a href="author.html#79255">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
