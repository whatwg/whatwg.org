<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] When a script element's child nodes are changed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20When%20a%20script%20element%27s%20child%20nodes%20are%20changed&In-Reply-To=%3C4EA9E338.2000503%40mozilla.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="075992.html">
   <LINK REL="Next"  HREF="075962.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] When a script element's child nodes are changed</H1>
<!--htdig_noindex-->
    <B>David Flanagan</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20When%20a%20script%20element%27s%20child%20nodes%20are%20changed&In-Reply-To=%3C4EA9E338.2000503%40mozilla.com%3E"
       TITLE="[whatwg] When a script element's child nodes are changed">dflanagan at mozilla.com
       </A><BR>
    <I>Thu Oct 27 16:03:20 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="075992.html">[whatwg] New attributes would degrade better than new elements
</A></li>
        <LI>Next message: <A HREF="075962.html">[whatwg] When a script element's child nodes are changed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33672">[ date ]</a>
              <a href="thread.html#33672">[ thread ]</a>
              <a href="subject.html#33672">[ subject ]</a>
              <a href="author.html#33672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>&#167;4.3.1 The Script Element says:
&gt;<i>
</I>&gt;<i> When a |script 
</I>&gt;<i> &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element</A>&gt;| 
</I>&gt;<i> element that is not marked as being &quot;parser-inserted&quot; 
</I>&gt;<i> &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#parser-inserted">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#parser-inserted</A>&gt; 
</I>&gt;<i> experiences one of the events listed in the following list, the user 
</I>&gt;<i> agent must synchronously prepare 
</I>&gt;<i> &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#prepare-a-script">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#prepare-a-script</A>&gt; 
</I>&gt;<i> the |script 
</I>&gt;<i> &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element</A>&gt;| 
</I>&gt;<i> element:
</I>&gt;<i>
</I>&gt;<i>   * The |script
</I>&gt;<i>     &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element</A>&gt;|
</I>&gt;<i>     element gets inserted into a document
</I>&gt;<i>     &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#insert-an-element-into-a-document">http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#insert-an-element-into-a-document</A>&gt;.
</I>&gt;<i>   * The |script
</I>&gt;<i>     &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element</A>&gt;|
</I>&gt;<i>     element is in a |Document|
</I>&gt;<i>     &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#in-a-document">http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#in-a-document</A>&gt;
</I>&gt;<i>     and its child nodes are changed.
</I>&gt;<i>   * The |script
</I>&gt;<i>     &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-script-element</A>&gt;|
</I>&gt;<i>     element is in a |Document|
</I>&gt;<i>     &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#in-a-document">http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#in-a-document</A>&gt;
</I>&gt;<i>     and has a |src
</I>&gt;<i>     &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#attr-script-src">http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#attr-script-src</A>&gt;|
</I>&gt;<i>     attribute set where previously the element had no such attribute.
</I>&gt;<i>
</I>Bullet point 2 seems ambiguous to me.  Does it mean only that the list 
of children changes, or does it mean that any change to any child node 
also causes the script to be prepared?  In particular, if a script with 
no src attribute whose only child is an empty text node is inserted into 
the document, the prepare() algorithm will abort before the 
already_started flag is set.  Later, if I do 
script.firstChild.insertData(jscode) does that trigger script execution?

I haven't tried it out yet to see what browsers do, but I think that the 
spec should be clarified to make it explicit.

     David
</PRE>





































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="075992.html">[whatwg] New attributes would degrade better than new elements
</A></li>
	<LI>Next message: <A HREF="075962.html">[whatwg] When a script element's child nodes are changed
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33672">[ date ]</a>
              <a href="thread.html#33672">[ thread ]</a>
              <a href="subject.html#33672">[ subject ]</a>
              <a href="author.html#33672">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
