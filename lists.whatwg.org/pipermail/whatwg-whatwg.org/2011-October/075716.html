<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] [CORS] WebKit tainting image instead of throwing error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BCORS%5D%20WebKit%20tainting%20image%20instead%20of%20throwing%20error&In-Reply-To=%3CCAJE5ia-6A3B%2Ba7SheeYxyFLbkGpLwb52O3VarAgPh7HbfPCs1Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="075715.html">
   <LINK REL="Next"  HREF="075717.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] [CORS] WebKit tainting image instead of throwing error</H1>
<!--htdig_noindex-->
    <B>Adam Barth</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BCORS%5D%20WebKit%20tainting%20image%20instead%20of%20throwing%20error&In-Reply-To=%3CCAJE5ia-6A3B%2Ba7SheeYxyFLbkGpLwb52O3VarAgPh7HbfPCs1Q%40mail.gmail.com%3E"
       TITLE="[whatwg] [CORS] WebKit tainting image instead of throwing error">w3c at adambarth.com
       </A><BR>
    <I>Thu Oct  6 09:11:54 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="075715.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
        <LI>Next message: <A HREF="075717.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75716">[ date ]</a>
              <a href="thread.html#75716">[ thread ]</a>
              <a href="subject.html#75716">[ subject ]</a>
              <a href="author.html#75716">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, Oct 6, 2011 at 8:45 AM, Odin H&#248;rthe Omdal &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">odinho at opera.com</A>&gt; wrote:
&gt;<i> On Thu, 06 Oct 2011 17:05:29 +0200, Adam Barth &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">w3c at adambarth.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> The reason it's implemented like that is because I didn't add any new
</I>&gt;&gt;<i> security checks. &#160;I just expanded the canvas taint-checking code to
</I>&gt;&gt;<i> understand that a CORS-approved image could pass.
</I>&gt;<i>
</I>&gt;<i> Ok, so not really intended then. Good :-)
</I>&gt;<i>
</I>&gt;&gt;<i> w.r.t. to blocking the whole image, there isn't any security benefit
</I>&gt;&gt;<i> for doing so (if we did so, attackers would just omit the crossorigin
</I>&gt;&gt;<i> attribute). &#160;If you want to prevent folks from embedding the image,
</I>&gt;&gt;<i> you need something that works regardless of how the image was
</I>&gt;&gt;<i> requested (like From-Origin).
</I>&gt;<i>
</I>&gt;<i> Well. I could, as server operator, block everything that didn't have an
</I>&gt;<i> Origin-attribute. It wouldn't work then for browsing normal pages on your
</I>&gt;<i> own, but maybe for a special api of some such.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Anyway, that was really never my concern; the whole reason for actually
</I>&gt;<i> having a crossorigin-attribute on the image would be because you want to get
</I>&gt;<i> that extra check so you can be able to use it like you want.
</I>&gt;<i>
</I>&gt;<i> With WebKit now, if I built such an application, I wouldn't have any nice
</I>&gt;<i> and obvious method of knowing whether I really could use the picture or not.
</I>&gt;<i> Throwing an error on the image on the other hand makes it fail early, before
</I>&gt;<i> I do all the canvas-processing.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Since the crossOrigin attribute exist, it'd make sense to have it behave as
</I>&gt;<i> a real way for you to say &#171;I'm going to use this and I need an explicit
</I>&gt;<i> allowance&#187;.
</I>&gt;<i>
</I>&gt;<i> Right now, the attribute doesn't really do anything from the author's point
</I>&gt;<i> of view. It /may/ make an untainted image, or it might not. It's obviously
</I>&gt;<i> different from always making tainted images (like not using the attribute
</I>&gt;<i> would), but I think the whole reason why someone would go to the extra
</I>&gt;<i> trouble of adding &#171;crossOrigin&#187; is if they really want an untainted image.
</I>&gt;<i>
</I>&gt;<i> If they don't care about tainting, and just really want the picture, they
</I>&gt;<i> can refrain from setting the crossOrigin attribute.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If they actually want a fallback, they can easily just reload the picture
</I>&gt;<i> without crossorigin, and they will probably get the cached image directly
</I>&gt;<i> from the browser (because it already has it, only won't show it).
</I>&gt;<i>
</I>&gt;<i> Obviously, if there hadn't been a crossOrigin-attribute, this would be the
</I>&gt;<i> nice way to handle all image fetching.
</I>
It sounds like you're arguing that it's better for developers if we
fail fast and hard, which is the opposite of how most of the web
platform is design (vis HTML versus XML).

The arguments revolving around wishful thinking about how the world
should have been don't carry much weight for me.  :)

Adam

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="075715.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
	<LI>Next message: <A HREF="075717.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75716">[ date ]</a>
              <a href="thread.html#75716">[ thread ]</a>
              <a href="subject.html#75716">[ subject ]</a>
              <a href="author.html#75716">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
