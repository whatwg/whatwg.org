<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] [CORS] WebKit tainting image instead of throwing error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BCORS%5D%20WebKit%20tainting%20image%20instead%20of%20throwing%20error&In-Reply-To=%3Cop.v2ua340d49xobu%40id-c0850%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033390.html">
   <LINK REL="Next"  HREF="075667.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] [CORS] WebKit tainting image instead of throwing error</H1>
<!--htdig_noindex-->
    <B>Odin H&#248;rthe Omdal</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BCORS%5D%20WebKit%20tainting%20image%20instead%20of%20throwing%20error&In-Reply-To=%3Cop.v2ua340d49xobu%40id-c0850%3E"
       TITLE="[whatwg] [CORS] WebKit tainting image instead of throwing error">odinho at opera.com
       </A><BR>
    <I>Tue Oct  4 11:32:18 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="033390.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
        <LI>Next message: <A HREF="075667.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75662">[ date ]</a>
              <a href="thread.html#75662">[ thread ]</a>
              <a href="subject.html#75662">[ subject ]</a>
              <a href="author.html#75662">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>If the CORS-check did not succeed on &lt;img
src=<A HREF="http://crossorigin.example.net">http://crossorigin.example.net</A> crossorigin&gt;, this should happen
according to spec:

&gt;<i> Discard all fetched data and prevent any tasks from the fetch algorithm  
</I>&gt;<i> from being queued. For the purposes of the calling algorithm, the user  
</I>&gt;<i> agent must act as if there was a fatal network error and no resource was  
</I>&gt;<i> obtained. If a CORS resource sharing check failed, the user agent may  
</I>&gt;<i> report a cross-origin resource access failure to the user (e.g. in a  
</I>&gt;<i> debugging console).
</I>
&lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#potentially-cors-enabled-fetch">http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#potentially-cors-enabled-fetch</A>&gt;


In this scenario an author wanting to do some canvas processing with the
image, will be able to check img.onerror to see whether she can use that
image. The image won't load on a failed check. Gecko does this.

WebKit, on the other hand, only taints the image and loads it anyway,
breaking the spec. The error will instead crop up in a way that is more
verbose and harder to miss when she tries to read the image data out.


Is WebKit's method a lesser surprise than the image just not showing up
(if they don't check for thrown error)? It'd be nice to hear why it's
implemented like that, if there are any good reasons. WebKit's method
seemed most obvious to me at first, but after investigating a bit I'm not
sure anymore...

--
Odin H&#248;rthe Omdal
Core QA, Opera Software

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033390.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
	<LI>Next message: <A HREF="075667.html">[whatwg] [CORS] WebKit tainting image instead of throwing error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75662">[ date ]</a>
              <a href="thread.html#75662">[ thread ]</a>
              <a href="subject.html#75662">[ subject ]</a>
              <a href="author.html#75662">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
