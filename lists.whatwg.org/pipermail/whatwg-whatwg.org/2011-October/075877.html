<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] NUL characters in CDATA?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20NUL%20characters%20in%20CDATA%3F&In-Reply-To=%3C4EA59B15.8010406%40mozilla.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033501.html">
   <LINK REL="Next"  HREF="033505.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] NUL characters in CDATA?</H1>
<!--htdig_noindex-->
    <B>David Flanagan</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20NUL%20characters%20in%20CDATA%3F&In-Reply-To=%3C4EA59B15.8010406%40mozilla.com%3E"
       TITLE="[whatwg] NUL characters in CDATA?">dflanagan at mozilla.com
       </A><BR>
    <I>Mon Oct 24 10:06:29 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="033501.html">[whatwg] NUL characters in CDATA?
</A></li>
        <LI>Next message: <A HREF="033505.html">[whatwg] How to render typographic puns in HTML5 -- aside, legend,	alt, other?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75877">[ date ]</a>
              <a href="thread.html#75877">[ thread ]</a>
              <a href="subject.html#75877">[ subject ]</a>
              <a href="author.html#75877">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I'm responding to my own email here...  Please disregard this thread: 
the bug was in my code, not the tests or the spec.  (The tokenizer 
leaves the NUL characters in CDATA sections, but when those characters 
are inserted into foreign content (as they always are) the NUL 
characters are transformed as the tests expect. My code wasn't doing the 
transformation correctly.)

     David

On 10/14/11 9:19 PM, David Flanagan wrote:
&gt;<i> The HTML parsing spec says this about tokenizing CDATA sections:
</I>&gt;<i>
</I>&gt;&gt;<i> Consume every character up to the next occurrence of the three 
</I>&gt;&gt;<i> character sequence U+005D RIGHT SQUARE BRACKET U+005D RIGHT SQUARE 
</I>&gt;&gt;<i> BRACKET U+003E GREATER-THAN SIGN (|]]&gt;|), or the end of the file 
</I>&gt;&gt;<i> (EOF), whichever comes first. Emit a series of character tokens 
</I>&gt;&gt;<i> consisting of all the characters consumed except the matching three 
</I>&gt;&gt;<i> character sequence at the end (if one was found before the end of the 
</I>&gt;&gt;<i> file).
</I>&gt;<i> By my reading, if there are NUL \u0000 characters in the input inside 
</I>&gt;<i> a CDATA section they will be left unchanged.
</I>&gt;<i>
</I>&gt;<i> But the html5lib test suite includes this test case 
</I>&gt;<i> testdata/tree-construction/plain-text-unsafe.dat:
</I>&gt;<i>
</I>&gt;<i> #data
</I>&gt;<i> &lt;svg&gt;&lt;![CDATA[\u0000filler\u0000text\u0000]]&gt;
</I>&gt;<i> #errors
</I>&gt;<i> #document
</I>&gt;<i> | &lt;html&gt;
</I>&gt;<i> | &lt;head&gt;
</I>&gt;<i> | &lt;body&gt;
</I>&gt;<i> | &lt;svg svg&gt;
</I>&gt;<i> |       &quot;\uFFFDfiller\uFFFDtext\uFFFD&quot;
</I>&gt;<i>
</I>&gt;<i> In order to copy this test into my email window, I had to change the 
</I>&gt;<i> non-printing characters to Unicode \u escapes, but this is the basic 
</I>&gt;<i> test data and it seems to contradict the spec.
</I>&gt;<i>
</I>&gt;<i> Which is right?  Should the spec be modified so that the CDATA section 
</I>&gt;<i> state is like the bogus comment state and includes the text &quot; with any 
</I>&gt;<i> U+0000 NULL characters replaced by U+FFFD REPLACEMENT CHARACTER 
</I>&gt;<i> characters.&quot;?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i>     David
</I>

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033501.html">[whatwg] NUL characters in CDATA?
</A></li>
	<LI>Next message: <A HREF="033505.html">[whatwg] How to render typographic puns in HTML5 -- aside, legend,	alt, other?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75877">[ date ]</a>
              <a href="thread.html#75877">[ thread ]</a>
              <a href="subject.html#75877">[ subject ]</a>
              <a href="author.html#75877">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
