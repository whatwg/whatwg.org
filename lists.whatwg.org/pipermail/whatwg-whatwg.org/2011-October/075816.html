<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] How should overflow be handled when parsing integers?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20How%20should%20overflow%20be%20handled%20when%20parsing%20integers%3F&In-Reply-To=%3CA8C6C61A-0E31-46DE-8CEC-EA4132CE5330%40webkit.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="075786.html">
   <LINK REL="Next"  HREF="033510.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] How should overflow be handled when parsing integers?</H1>
<!--htdig_noindex-->
    <B>Daniel Bates</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20How%20should%20overflow%20be%20handled%20when%20parsing%20integers%3F&In-Reply-To=%3CA8C6C61A-0E31-46DE-8CEC-EA4132CE5330%40webkit.org%3E"
       TITLE="[whatwg] How should overflow be handled when parsing integers?">dbates at webkit.org
       </A><BR>
    <I>Tue Oct 18 15:35:43 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="075786.html">[whatwg] How should overflow be handled when parsing integers?
</A></li>
        <LI>Next message: <A HREF="033510.html">[whatwg] DOCTYPE declaration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75816">[ date ]</a>
              <a href="thread.html#75816">[ thread ]</a>
              <a href="subject.html#75816">[ subject ]</a>
              <a href="author.html#75816">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On Oct 16, 2011, at 11:02 AM, Mounir Lamouri wrote:

&gt;<i> On 10/16/2011 02:17 PM, Daniel Bates wrote:
</I>&gt;&gt;<i> How should overflow be handled when parsing integers?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Step 8 of the parsing algorithm in both&lt;<A HREF="http://dev.w3.org/html5/spec/Overview.html#rules-for-parsing-integers">http://dev.w3.org/html5/spec/Overview.html#rules-for-parsing-integers</A>&gt;  and&lt;<A HREF="http://dev.w3.org/html5/spec/Overview.html#non-negative-integers">http://dev.w3.org/html5/spec/Overview.html#non-negative-integers</A>&gt;  doesn't mention how to handle integer overflow when interpreting the result of a sequence of base-ten integers.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Currently in WebKit we consider such overflow a parsing error. Is there any reason not to consider overflow a parsing error? Regardless, I suggest codifying the handling of overflow in the aforementioned sections.
</I>&gt;<i> 
</I>&gt;<i> Gecko also considers that an overflow is a parsing error. Presto and IE6 doesn't seem to.
</I>&gt;<i> The specs should probably mention this by whether consider it as a parsing error or request the UA to default to the highest value (which Presto and IE6 seem to do but not using the same value).
</I>
Notice that spec tends to provide guidance when the rules for parsing a number return an error. For instance, the spec defines what happens when parsing the value of the tabindex attribute returns an error: &lt;<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/editing.html#sequential-focus-navigation-and-the-tabindex-attribute">http://www.whatwg.org/specs/web-apps/current-work/multipage/editing.html#sequential-focus-navigation-and-the-tabindex-attribute</A>&gt;.

I suggest that we return an error in step 8 of the rules for parsing signed/non-negative integers when the sequence of characters cannot be interpreted as an base-ten integer that is representable using an integer datatype. Then we can leave it up to the relevant sections of the spec to define how to handle such a parser error (like in the case for tabindex), including whether to fall back to an agreed default value or leave it up to the UA (which may default to the highest value).

&gt;<i> 
</I>&gt;&gt;<i> This issue came up recently in WebKit with respect to the parsing of the maxlength attribute (<A HREF="https://bugs.webkit.org/show_bug.cgi?id=68981">https://bugs.webkit.org/show_bug.cgi?id=68981</A>).
</I>&gt;<i> 
</I>&gt;<i> Actually, this problem wouldn't have been that annoying if Webkit was following the specs regarding maxlength attribute: if the content attribute value isn't a valid non-negative integer, the element has no maximum allowed value length.
</I>
Thank you for bringing this up and directly commenting about this on the bug (<A HREF="https://bugs.webkit.org/show_bug.cgi?id=68981">https://bugs.webkit.org/show_bug.cgi?id=68981</A>). Currently WebKit doesn't conform to this behavior. As mentioned by Kent Tamura on the bug, this issue is covered by WebKit bug #44883 (<A HREF="https://bugs.webkit.org/show_bug.cgi?id=44883">https://bugs.webkit.org/show_bug.cgi?id=44883</A>).

Dan


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="075786.html">[whatwg] How should overflow be handled when parsing integers?
</A></li>
	<LI>Next message: <A HREF="033510.html">[whatwg] DOCTYPE declaration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75816">[ date ]</a>
              <a href="thread.html#75816">[ thread ]</a>
              <a href="subject.html#75816">[ subject ]</a>
              <a href="author.html#75816">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
