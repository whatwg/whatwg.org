<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Media aware JS loading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Media%20aware%20JS%20loading&In-Reply-To=%3CCACj%3DBEjaJUpkEcCAArr1L%2B%3D3vWaG-P96OMzzq09kHHciSbC0CA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081936.html">
   <LINK REL="Next"  HREF="081871.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Media aware JS loading</H1>
<!--htdig_noindex-->
    <B>Yoav Weiss</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Media%20aware%20JS%20loading&In-Reply-To=%3CCACj%3DBEjaJUpkEcCAArr1L%2B%3D3vWaG-P96OMzzq09kHHciSbC0CA%40mail.gmail.com%3E"
       TITLE="[whatwg] Media aware JS loading">yoav at yoav.ws
       </A><BR>
    <I>Thu May 16 06:22:53 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081936.html">[whatwg] Microdata status
</A></li>
        <LI>Next message: <A HREF="081871.html">[whatwg] Media aware JS loading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39588">[ date ]</a>
              <a href="thread.html#39588">[ thread ]</a>
              <a href="subject.html#39588">[ subject ]</a>
              <a href="author.html#39588">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Arguably, the biggest problem in responsive Web design today is the fact
that many resource loading mechanisms are media query agnostic, and
download resources upfront regardless of whether they will be used or not.

One of the biggest resources in question (right after images) is external
JavaScript. JavaScript also has secondary performance effects, beside its
download size, since parsing and running it are also time (&amp; battery)
consuming operations.

Currently authors that want their scripts to load only under certain
viewport sizes are forced to use JS based script loaders, which have the
side-effect of preventing these scripts from being parsed out by the
preloader.

I believe that an HTML based solution would be a better fit, will be easier
to use by authors, and will enable preloaders to do their job and preload
these scripts.

Common use-cases for avoiding the load of JS based components based on
layout are:

* JS based maps, which don't fit in a narrow layout
* Social widgets, which don't fit in a narrow layout
* Mobile/desktop oriented UI libraries
* Ad placements

I was thinking along the lines of adding a `media` attribute to the
`&lt;script&gt;` element.
Doing that raises several interesting questions:

* What will be the execution order of these scripts if the media conditions
of the page change?
* Should `media` be permitted for scripts with no `defer`/`async`
attributes, that may contain document.write directives?
* Should scripts re-run if media conditions changed more than once (e.g.
their `media` intially matched conditions, then stopped, then matched again)
* Should events handlers that were registered by scripts which media no
longer matches run?

I believe that mandating `async` (at least as a first step) will enable
avoiding the running-order problems, with authors being obliged to avoid
any dependencies between `media` scripts and other (`media` or non-`media`)
scripts.

Regarding the script re-run and event handler scenarios, I'm not sure what
the right answer should be.

I'd highly appreciate any thoughts on the subject.

Yoav
</PRE>













<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081936.html">[whatwg] Microdata status
</A></li>
	<LI>Next message: <A HREF="081871.html">[whatwg] Media aware JS loading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39588">[ date ]</a>
              <a href="thread.html#39588">[ thread ]</a>
              <a href="subject.html#39588">[ subject ]</a>
              <a href="author.html#39588">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
