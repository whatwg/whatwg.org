<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal: API to ask the user for a file
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20API%20to%20ask%20the%20user%20for%20a%20file&In-Reply-To=%3C1367425362.71574.YahooMailNeo%40web141104.mail.bf1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039484.html">
   <LINK REL="Next"  HREF="039486.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal: API to ask the user for a file</H1>
<!--htdig_noindex-->
    <B>JC</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%3A%20API%20to%20ask%20the%20user%20for%20a%20file&In-Reply-To=%3C1367425362.71574.YahooMailNeo%40web141104.mail.bf1.yahoo.com%3E"
       TITLE="[whatwg] Proposal: API to ask the user for a file">mg05182-wwg at yahoo.ca
       </A><BR>
    <I>Wed May  1 09:22:42 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="039484.html">[whatwg] canvas 2d's ellipse
</A></li>
        <LI>Next message: <A HREF="039486.html">[whatwg] Base URL&#8217;s effect on an empty @src element
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39485">[ date ]</a>
              <a href="thread.html#39485">[ thread ]</a>
              <a href="subject.html#39485">[ subject ]</a>
              <a href="author.html#39485">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>&gt;<i> On Mon, Apr 29, 2013 at 1:41 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>
&gt;&gt;<i>  On Mon, 29 Apr 2013, JC wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i>  So far the only way to ask a user to select a file (e.g. to upload an
</I>&gt;&gt;&gt;<i>  attachment in a mail client) without showing the ugly &quot;file 
</I>&gt;<i> input&quot; UI is
</I>&gt;&gt;&gt;<i>  to create one of these elements, hide it somehow, and invoke the 
</I>&gt;<i> &quot;click&quot;
</I>&gt;&gt;&gt;<i>  method on it and listen for the &quot;changed&quot; event.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i>  You can also just accept a drag-and-dropped file.
</I>
I have that too, but there's always going to be a manager who thinks that drag and drop is not good enough or not user friendly or they really want to see an upload button (and I happen to have one of those managers).

&gt;&gt;<i>  Having the &lt;input type=file&gt; UI hidden is probably not supposed to be
</I>&gt;&gt;<i>  possible (though it's hard for us to stop it), because it means you can
</I>&gt;&gt;<i>  trick people into clicking the button and bringing up the dialog, which
</I>&gt;&gt;<i>  can, if you know what browser/OS they're using, let you in some cases
</I>&gt;&gt;<i>  trick them into uploading a particular file. (It's gotten harder with
</I>&gt;&gt;<i>  browsers going away from allowing arbitrary text input into that
</I>&gt;&gt;<i>  control, though, so this might no longer be that big a deal.)
</I>&gt;<i> 
</I>&gt;<i> I think all modern browsers intentionally let webpages create custom
</I>&gt;<i> UIs for &lt;input type=file&gt; by completely hiding the &lt;input&gt; and then
</I>&gt;<i> rendering a custom UI using various &lt;div&gt; and &lt;span&gt; tags. When the
</I>&gt;<i> custom UI is clicked the page calls myInputElement.click() in order to
</I>&gt;<i> bring up the file picker UI.
</I>&gt;<i> 
</I>&gt;<i> Gecko contains some anti-annoyance protections as to prevent the page
</I>&gt;<i> from spawning file picker dialogs indefinitely. This is done by
</I>&gt;<i> hooking up &lt;input type=file&gt;.click() to popup blocking infrastructure.
</I>&gt;<i> 
</I>&gt;<i> So the API being requested here is actually available. But in a really
</I>&gt;<i> ugly way through the HTMLInputElement interface.
</I>
Yes, that's what I said in my proposal.

&gt;<i> But I don't really buy the argument that we should supply a new one
</I>&gt;<i> because the existing API isn't &quot;reliably available&quot;. If the 
</I>&gt;<i> current
</I>&gt;<i> API is problematic because there is no way to check if it works, then
</I>&gt;<i> I'd prefer to add a way to check if it works, rather than adding a
</I>&gt;<i> whole new API.
</I>

I guess I should have mention too that the existing API is not only unreliable but also very inconvenient. Since the trick depends on the &quot;changed&quot; event and there's no official way to clear the list of files selected the last time, in order to ensure that the event is fired if the same file is selected again the element has to be removed and replaced by a new one every time the user selects a file, that additional trick is documented here:&#160;<A HREF="http://stackoverflow.com/questions/10214947/upload-files-using-input-type-file-field-with-change-event-not-always-firin">http://stackoverflow.com/questions/10214947/upload-files-using-input-type-file-field-with-change-event-not-always-firin</A> (and I was neither the person who asked or answered that question, so there's more people struggling with this issue).

--&#160;
JC
</PRE>



<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039484.html">[whatwg] canvas 2d's ellipse
</A></li>
	<LI>Next message: <A HREF="039486.html">[whatwg] Base URL&#8217;s effect on an empty @src element
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39485">[ date ]</a>
              <a href="thread.html#39485">[ thread ]</a>
              <a href="subject.html#39485">[ subject ]</a>
              <a href="author.html#39485">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
