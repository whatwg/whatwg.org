<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Media aware JS loading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Media%20aware%20JS%20loading&In-Reply-To=%3CCADGdg3Ahi2%3DEdRc2dU2fjhM_KrnJaoBWwieLwOVjmq2B_i_OKA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081894.html">
   <LINK REL="Next"  HREF="081897.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Media aware JS loading</H1>
<!--htdig_noindex-->
    <B>Paul Kinlan</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Media%20aware%20JS%20loading&In-Reply-To=%3CCADGdg3Ahi2%3DEdRc2dU2fjhM_KrnJaoBWwieLwOVjmq2B_i_OKA%40mail.gmail.com%3E"
       TITLE="[whatwg] Media aware JS loading">paulkinlan at google.com
       </A><BR>
    <I>Sat May 25 14:19:49 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081894.html">[whatwg] Media aware JS loading
</A></li>
        <LI>Next message: <A HREF="081897.html">[whatwg] Media aware JS loading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81896">[ date ]</a>
              <a href="thread.html#81896">[ thread ]</a>
              <a href="subject.html#81896">[ subject ]</a>
              <a href="author.html#81896">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>We developed formfactorjs for exactly this type of case (
github.com/paulkinlan/formfactor) about 2 years ago.

The use case we had was that we had one app that had to respond differently
based on the form factor type, so a TV would load js that was specific to
just the TV (ie loading remote controller logic) and a tablet would loads
js that responded to finger based touch gestures and a phone type media
query would load js for thumb based gestures.

We got to the point where were talking about trying to have media queries
on script element to save us from this library we created, however we
quickly found that things like orientation changes would mean that there is
a high degree of chance that the developer would have scripts that would
need to be loaded at some undeterminable time in the future that would
clash with the scripts that had already been loaded and ruin the state in
our app (such as scripts sectioned by min-width queries).

We didn't find any reasonable solution for this issue other than force a
reload of the page :/

P
On 25 May 2013 21:25, &quot;Yoav Weiss&quot; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">yoav at yoav.ws</A>&gt; wrote:

&gt;<i> &gt;
</I>&gt;<i> &gt; How bad is the current situation with JS-based loaders? I would expect a
</I>&gt;<i> &gt; JS-based loader and the couple of feature-detection tests to be rather
</I>&gt;<i> &gt; small as well as heavily cachable, so not that awful for performance.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> JS based loaders have several drawbacks:
</I>&gt;<i> * JS files are not discovered by the preloader, which means the browsers
</I>&gt;<i> can't prioirtize their download appropriately.
</I>&gt;<i> * They require JS inlining, which will become significantly harder with CSP
</I>&gt;<i> (JS nonces make it possible, but it'd require server side logic)
</I>&gt;<i> * Arguably, attributes make authoring easier, which may mean authors are
</I>&gt;<i> more likely to avoid useless JS downloads.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I'm not sure I understand your point about preloading scripts parsing. Do
</I>&gt;<i> &gt; you want them to be preparsed (which costs in battery as you mention) or
</I>&gt;<i> &gt; not preparsed (which will result in longer time when actually needing the
</I>&gt;<i> &gt; script)?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I was referring to HTML parsing (so the discvery of JS resources in HTML),
</I>&gt;<i> not the parsing/execution of the JS resources themselves.
</I>&gt;<i>
</I>&gt;<i>  How much time can be expected to be gained from such a feature given the
</I>&gt;<i> &gt; state-of-the-art JS loaders?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Overall, what is the expected gain between a JS-based loader and a
</I>&gt;<i> &gt; declarative media-aware loader? 1ms? 100ms?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; While the expected gain may vary per site, I'd estimate that it's
</I>&gt;<i> probably
</I>&gt;<i> in the area of hundreds of ms for most sites. A recent study by Google
</I>&gt;<i> (addressing this specific issue) showed that the PreloadScanner gives ~20%
</I>&gt;<i> improvement <A HREF="https://plus.google.com/+PaulIrish/posts/WcsqfSFZAfR">https://plus.google.com/+PaulIrish/posts/WcsqfSFZAfR</A>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081894.html">[whatwg] Media aware JS loading
</A></li>
	<LI>Next message: <A HREF="081897.html">[whatwg] Media aware JS loading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81896">[ date ]</a>
              <a href="thread.html#81896">[ thread ]</a>
              <a href="subject.html#81896">[ subject ]</a>
              <a href="author.html#81896">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
