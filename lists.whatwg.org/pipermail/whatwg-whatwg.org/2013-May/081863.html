<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Notifications: in workers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Notifications%3A%20in%20workers&In-Reply-To=%3CCAArhhiuRkqZjRHpaXM52JTZSvO8iv91m3fFMjkcZG1VmS9h-CQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081862.html">
   <LINK REL="Next"  HREF="081864.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Notifications: in workers</H1>
<!--htdig_noindex-->
    <B>Andrew Wilson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Notifications%3A%20in%20workers&In-Reply-To=%3CCAArhhiuRkqZjRHpaXM52JTZSvO8iv91m3fFMjkcZG1VmS9h-CQ%40mail.gmail.com%3E"
       TITLE="[whatwg] Notifications: in workers">atwilson at google.com
       </A><BR>
    <I>Fri May 17 00:13:55 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081862.html">[whatwg] Notifications: in workers
</A></li>
        <LI>Next message: <A HREF="081864.html">[whatwg] Notifications: in workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81863">[ date ]</a>
              <a href="thread.html#81863">[ thread ]</a>
              <a href="subject.html#81863">[ subject ]</a>
              <a href="author.html#81863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, May 16, 2013 at 5:45 PM, Anne van Kesteren &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">annevk at annevk.nl</A>&gt; wrote:

&gt;<i> On Wed, May 15, 2013 at 8:24 AM, Andrew Wilson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">atwilson at google.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; On Tue, May 14, 2013 at 9:19 PM, Anne van Kesteren &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">annevk at annevk.nl</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt;&gt; Chrome currently does not seem to do any of this particularly well,
</I>&gt;<i> &gt;&gt; but when you click a notification from say the notification center
</I>&gt;<i> &gt;&gt; there should be some &quot;going to the relevant site&quot; going on. E.g. via
</I>&gt;<i> &gt;&gt; focusing a particular browsing context that spawned the notification.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm not sure that's true - as I said, the specification says nothing
</I>&gt;<i> about
</I>&gt;<i> &gt; this, and the page that displays the notification is free to focus itself
</I>&gt;<i> &gt; via an onclick handler if it likes.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As an example, if you click on a gmail new-mail notification, instead of
</I>&gt;<i> &gt; focusing gmail (which might be in the middle of some other operation
</I>&gt;<i> such as
</I>&gt;<i> &gt; composing an email, or you might be viewing a different message thread)
</I>&gt;<i> we
</I>&gt;<i> &gt; open the associated email in a new window. So in this case, we actively
</I>&gt;<i> do
</I>&gt;<i> &gt; *not* want to focus the source browsing context.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So the chrome behavior is intentional.
</I>&gt;<i>
</I>&gt;<i> Fair enough.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;&gt; Trying to brain storm as to what should be done when you click a
</I>&gt;<i> &gt;&gt; notification of a site that is no longer there. Navigating to a URL
</I>&gt;<i> &gt;&gt; was one idea. Starting up an event worker as outlined (roughly) in
</I>&gt;<i> &gt;&gt; <A HREF="http://annevankesteren.nl/2013/05/applifying">http://annevankesteren.nl/2013/05/applifying</A> might be a better idea.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; That's not a bad idea - as you know from my separate email with you, I'm
</I>&gt;<i> &gt; less enamored with using Workers for these kinds of on-demand/background
</I>&gt;<i> &gt; footprint tasks, because they are limited in so many ways (can't display
</I>&gt;<i> a
</I>&gt;<i> &gt; visible browsing context, for example). I prefer having instead a page
</I>&gt;<i> that
</I>&gt;<i> &gt; is loaded off-screen, albeit perhaps with a limited lifetime as you
</I>&gt;<i> describe
</I>&gt;<i> &gt; in that page.
</I>&gt;<i>
</I>&gt;<i> So how would that work if open gmail.com twice, in two distinct
</I>&gt;<i> browsing contexts? Long term we want those to be able to use distinct
</I>&gt;<i> threads I think, but they should be able to share a single event
</I>&gt;<i> page/worker.
</I>&gt;<i>
</I>
I'll have to ping the gmail team to ask what they did there in their
prototype.


&gt;<i>
</I>&gt;<i> Not having the ability to focus (draw attention to) and open windows
</I>&gt;<i> does seem like something we should solve. (The cross-origin loading
</I>&gt;<i> case you mentioned should really be solved using WebSocket or CORS. I
</I>&gt;<i> heard from at least one guy from your app team that they want to move
</I>&gt;<i> to something like that long term and the &lt;iframe&gt; thing is mostly a
</I>&gt;<i> intermediate hack.)
</I>&gt;<i>
</I>&gt;<i>
</I>The &lt;iframe&gt; thing (and other &lt;script&gt;-based solutions like JSONP) are
definitely hacks, but they are hacks with a fairly long history in the web
world. Agreed about CORS, although we've been talking about CORS support in
workers for a while now with no implementations AFAIK - maybe we just need
a compelling feature like this to drive teams to actually build it.

Agreed that there's nothing stopping us from building whatever APIs we
think we need into workers (window.open, window.focus, etc) to support the
use cases that are already supported by the main browsing contexts, if
there's a compelling reason to use workers instead.


&gt;<i>
</I>&gt;<i> &gt;&gt; Yeah, that's currently not described. You think we should leave that
</I>&gt;<i> &gt;&gt; to developers? That might work, although that leaves the questions
</I>&gt;<i> &gt;&gt; about the site being closed.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Yeah, it does. Currently in Chrome we basically punt on this, with the
</I>&gt;<i> &gt; expectation that well-behaved pages close their notifications via an
</I>&gt;<i> &gt; document.onclose handler. I hadn't really considered the case of the app
</I>&gt;<i> &gt; developer wanting their notifications to hang around after the window
</I>&gt;<i> closes
</I>&gt;<i> &gt; and still have some action undertaken when the user clicks on them.
</I>&gt;<i>
</I>&gt;<i> That seems like something we want to support, no? E.g. you get a push
</I>&gt;<i> message, so you open the event page/worker, and that dispatches a
</I>&gt;<i> notification, but then you want to kill the event page/worker so it
</I>&gt;<i> doesn't continue to use system resources. Couple days later the user
</I>&gt;<i> might click the notification and then you'd open the event page/worker
</I>&gt;<i> again.
</I>&gt;<i>
</I>
Agreed, I think this is a valid use case once you support event
pages/workers as targets for notifications (it also probably has some uses
for things like server-initiated notifications, where the server can
specify a URL to navigate to when the user clicks, although I've never
really paid attention to the server-initiated notification discussions so I
don't quite follow their use cases).


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> <A HREF="http://annevankesteren.nl/">http://annevankesteren.nl/</A>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081862.html">[whatwg] Notifications: in workers
</A></li>
	<LI>Next message: <A HREF="081864.html">[whatwg] Notifications: in workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81863">[ date ]</a>
              <a href="thread.html#81863">[ thread ]</a>
              <a href="subject.html#81863">[ subject ]</a>
              <a href="author.html#81863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
