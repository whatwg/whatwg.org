<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] An alternative approach to section 9 of Mime Sniffing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20An%20alternative%20approach%20to%20section%209%20of%20Mime%20Sniffing&In-Reply-To=%3CC85F8FFA5D634C5FA4FF434F8F568ABF%40PeterPC%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081899.html">
   <LINK REL="Next"  HREF="081877.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] An alternative approach to section 9 of Mime Sniffing</H1>
<!--htdig_noindex-->
    <B>Peter Occil</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20An%20alternative%20approach%20to%20section%209%20of%20Mime%20Sniffing&In-Reply-To=%3CC85F8FFA5D634C5FA4FF434F8F568ABF%40PeterPC%3E"
       TITLE="[whatwg] An alternative approach to section 9 of Mime Sniffing">poccil14 at gmail.com
       </A><BR>
    <I>Wed May 22 23:10:49 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081899.html">[whatwg] Fetch: please review!
</A></li>
        <LI>Next message: <A HREF="081877.html">[whatwg] An alternative approach to section 9 of Mime Sniffing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39603">[ date ]</a>
              <a href="thread.html#39603">[ thread ]</a>
              <a href="subject.html#39603">[ subject ]</a>
              <a href="author.html#39603">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I propose rewriting section 9 and parts of section 10 in a different way, to use the ABNF format in RFC 5234. (Note that ABNFs are already  used in the current Fetch specification.) With this approach, the definitions for &quot;byte pattern&quot;,  &quot;pattern mask&quot;, and the &quot;pattern matching algorithm&quot; can be eliminated (all of which are found before section 9.1).

An example for the image pattern matching algorithm is given below.
 
---------------------------------------------------

9.1  Matching an image type pattern

The image pattern matching algorithm takes a byte sequence as input.  The algorithm goes through the following image types in the order given.  For each image MIME type given below, if the start of the byte sequence matches its ABNF, return the concatenation of &quot;image/&quot; and the name of the ABNF (in lowercase), and terminate the image pattern matching algorithm. 

vnd.microsoft.icon = %x00.00.01.00 
   ; A Windows Icon signature. 
bmp = %x42.4D 
   ; The string &quot;BM&quot;, a BMP signature. 
gif = %x47.49.46.38 (%x37 / %x39) %x61 
   ; The string &quot;GIF87a&quot; or &quot;GIF89a&quot;, a GIF signature. 
webp = %x52.49.46.46 4OCTET %57.45.42.50.56.50
   ; The string &quot;RIFF&quot; followed by four bytes followed by the string &quot;WEBPVP&quot;. 
png = %x89.50.4E.47.0D.0A.1A.0A
   ; The byte 0x89 followed by the string &quot;PNG&quot;
   ; followed by CR LF SUB LF, the PNG signature. 
jpeg = %xFF.D8.FF
   ;     The JPEG Start of Image marker followed by the indicator 
   ; byte of another marker. 

If the start of the byte sequence doesn't match any ABNF given above, return undefined.

---------------------------------------------------

I would appreciate comments.

--Peter
</PRE>




















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081899.html">[whatwg] Fetch: please review!
</A></li>
	<LI>Next message: <A HREF="081877.html">[whatwg] An alternative approach to section 9 of Mime Sniffing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39603">[ date ]</a>
              <a href="thread.html#39603">[ thread ]</a>
              <a href="subject.html#39603">[ subject ]</a>
              <a href="author.html#39603">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
