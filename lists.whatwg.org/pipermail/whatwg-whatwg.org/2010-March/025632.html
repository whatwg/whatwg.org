<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] WebSocket bufferedAmount includes overhead or not
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20WebSocket%20bufferedAmount%20includes%20overhead%20or%20not&In-Reply-To=%3C4BABAABE.90206%40helsinki.fi%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025631.html">
   <LINK REL="Next"  HREF="025634.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] WebSocket bufferedAmount includes overhead or not</H1>
<!--htdig_noindex-->
    <B>Olli Pettay</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20WebSocket%20bufferedAmount%20includes%20overhead%20or%20not&In-Reply-To=%3C4BABAABE.90206%40helsinki.fi%3E"
       TITLE="[whatwg] WebSocket bufferedAmount includes overhead or not">Olli.Pettay at helsinki.fi
       </A><BR>
    <I>Thu Mar 25 11:26:06 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="025631.html">[whatwg] WebSocket bufferedAmount includes overhead or not
</A></li>
        <LI>Next message: <A HREF="025634.html">[whatwg] WebSocket bufferedAmount includes overhead or not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25632">[ date ]</a>
              <a href="thread.html#25632">[ thread ]</a>
              <a href="subject.html#25632">[ subject ]</a>
              <a href="author.html#25632">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 3/25/10 5:55 PM, Anne van Kesteren wrote:
&gt;<i> On Thu, 25 Mar 2010 16:35:19 +0100, Olli Pettay
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Olli.Pettay at helsinki.fi</A>&gt; wrote:
</I>&gt;&gt;<i> On 3/25/10 4:25 PM, Niklas Beischer wrote:
</I>&gt;&gt;&gt;<i> Easy. The bufferedAmount is: &quot;The amount of bytes waiting to be
</I>&gt;&gt;&gt;<i> transferred, including protocol overhead&quot;.
</I>&gt;&gt;<i> That doesn't define exactly what the bufferedAmount means and what
</I>&gt;&gt;<i> kinds of values are expected.
</I>&gt;&gt;<i> What I'd expect the API to tell me is, for example, that if I call
</I>&gt;&gt;<i> ws.send(foo), and nothing is yet sent over the network, what is the
</I>&gt;&gt;<i> exact value of bufferedAmount.
</I>&gt;&gt;<i> Again, I'd really wish to keep the API to work reasonable similar
</I>&gt;&gt;<i> way as XHR+progress events where protocol overhead isn't reported.
</I>&gt;<i>
</I>&gt;<i> Why? Progress events are completely different from this. This is about
</I>&gt;<i> not saturating the network with too much data; it makes sense if the
</I>&gt;<i> actual amount of data that is going to hit the network is known.
</I>
bufferedAmount is not only about &quot;not saturating&quot;.

Let's put the question otherway around:
from API point of view, why should bufferedAmount contain some bytes
which aren't specified in the API spec?
If the API specifies that bufferedAmount is always 
to_be_sent_data_in_UTF8_length+(1 or 2), that would be sort of ok.
Very very ugly, but ok.

Also, some implementations may not put the protocol
overhead bytes to the buffer at all, but just write them to the
socket when needed.



-Olli


  (Yes, I
&gt;<i> changed my mind.)
</I>&gt;<i>
</I>&gt;<i>
</I>
</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025631.html">[whatwg] WebSocket bufferedAmount includes overhead or not
</A></li>
	<LI>Next message: <A HREF="025634.html">[whatwg] WebSocket bufferedAmount includes overhead or not
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25632">[ date ]</a>
              <a href="thread.html#25632">[ thread ]</a>
              <a href="subject.html#25632">[ subject ]</a>
              <a href="author.html#25632">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
