<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] WebSocket bufferedAmount includes overhead or not.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20WebSocket%20bufferedAmount%20includes%20overhead%20or%20not.&In-Reply-To=%3C3DB9A92A-96A5-4DEA-BB2C-E3760EDD1F40%40webkit.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="067694.html">
   <LINK REL="Next"  HREF="067696.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] WebSocket bufferedAmount includes overhead or not.</H1>
<!--htdig_noindex-->
    <B>Alexey Proskuryakov</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20WebSocket%20bufferedAmount%20includes%20overhead%20or%20not.&In-Reply-To=%3C3DB9A92A-96A5-4DEA-BB2C-E3760EDD1F40%40webkit.org%3E"
       TITLE="[whatwg] WebSocket bufferedAmount includes overhead or not.">ap at webkit.org
       </A><BR>
    <I>Fri Mar  5 13:13:31 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="067694.html">[whatwg] WebSocket bufferedAmount includes overhead or not.
</A></li>
        <LI>Next message: <A HREF="067696.html">[whatwg] WebSocket bufferedAmount includes overhead or not.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67695">[ date ]</a>
              <a href="thread.html#67695">[ thread ]</a>
              <a href="subject.html#67695">[ subject ]</a>
              <a href="author.html#67695">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On 05.03.2010, at 12:56, Olli Pettay wrote:

&gt;<i> And you're saying that javascript really needs to know about the
</I>&gt;<i> frame boundary bytes to detect if it is streaming too fast.
</I>&gt;<i> Doesn't sound likely to me.
</I>
OK

&gt;&gt;<i> That's true, but I don't know how many of these have already been  
</I>&gt;&gt;<i> sent
</I>&gt;&gt;<i> unless I perform lots of additional bookkeeping.
</I>&gt;<i> &quot;lots&quot;
</I>&gt;<i>
</I>&gt;&gt;<i> Consider sending &quot;data&quot;
</I>&gt;&gt;<i> message three times in a row:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> \x00data\xFF\x00data\xFF\x00data\xFF
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If we are to exclude protocol overhead in bufferedAmount, and we know
</I>&gt;&gt;<i> that there are 8 bytes still queued (a\xFF\x00data\xFF), and we know
</I>&gt;&gt;<i> that there were three frames sent (with an overhead of 6 bytes) how
</I>&gt;&gt;<i> would we know that the answer is 5?
</I>&gt;<i>
</I>&gt;<i> You could for example have a circular list for the frame boundary byte
</I>&gt;<i> indexes and when something is removed from the queue, you just update
</I>&gt;<i> the pointer which points to the first frame boundary byte index in the
</I>&gt;<i> queue. Then if the circular list is implemented in a reasonable way,
</I>&gt;<i> counting all the frame boundary bytes in the queue is just one
</I>&gt;<i> subtraction.
</I>

Yes, that's lots of work for something no one should care about, as  
you implied above. And that's work that makes the results slightly  
misleading, even if that's so slightly that it's not important in  
practice.

Remembering frame offsets even after data has been serialized to a  
stream is an unusual requirement for networking code.

- WBR, Alexey Proskuryakov


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="067694.html">[whatwg] WebSocket bufferedAmount includes overhead or not.
</A></li>
	<LI>Next message: <A HREF="067696.html">[whatwg] WebSocket bufferedAmount includes overhead or not.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67695">[ date ]</a>
              <a href="thread.html#67695">[ thread ]</a>
              <a href="subject.html#67695">[ subject ]</a>
              <a href="author.html#67695">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
