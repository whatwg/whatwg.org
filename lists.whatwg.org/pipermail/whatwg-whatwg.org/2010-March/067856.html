<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Limitations of the DnD API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Limitations%20of%20the%20DnD%20API&In-Reply-To=%3C20100320133808.GA25521%40inforealm.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="067866.html">
   <LINK REL="Next"  HREF="067942.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Limitations of the DnD API</H1>
<!--htdig_noindex-->
    <B>Stef Epardaud</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Limitations%20of%20the%20DnD%20API&In-Reply-To=%3C20100320133808.GA25521%40inforealm.org%3E"
       TITLE="[whatwg] Limitations of the DnD API">stef at epardaud.fr
       </A><BR>
    <I>Sat Mar 20 06:38:08 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="067866.html">[whatwg] EventSource remark
</A></li>
        <LI>Next message: <A HREF="067942.html">[whatwg] More questions about the DnD API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67856">[ date ]</a>
              <a href="thread.html#67856">[ thread ]</a>
              <a href="subject.html#67856">[ subject ]</a>
              <a href="author.html#67856">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hello,

I'm trying to implement the picture reordering feature of picasa in
HTML5 and I'm having several problems.

The feature is as follows:

- I have a list of small pictures arranged in a sequence of lines
- I can select or unselect pictures by clicking them
- I can drag the selected pictures to a new location, to reorder them
- When I start dragging I have a drag image that shows what is being
  dragged
- It is possible to select non-continuous ranges of pictures
- Pictures are arranged in sections represented by a picture-sized box
  with the name of the section, followed by the section's pictures
  themselves
- It is possible to select a section, in which case all its pictures are
  selected
- When dragging, I want to update the drag image with information about
  what happens should you drop things over here

I have tried several approaches for setting the drag image:

- Use Selection to instruct the browser of what is selected, and leave
  the drag image alone, as this gives me the best drag image since
  non-continuous images are represented with the selection &quot;holes&quot; in
  the drag image.
- Create a new DOM element to represent the selection and put some info
  in there like how many images are selected and a few of the images
  stacked together.
- The same using a canvas.

Using the window.getSelection is nice visually but there's no way to
update the drag image with contextual information. Also when adding the
section boxes to the selection, their text becomes visually selected and
that looks bad.

I did not find it possible to use a new DOM element to represent the
selection, unless I append it to the document, which looks bad, since
it's only meant for the selection.

I used the canvas for the same feature, and struggled really hard
because it's not meant for laying out components (especially text and
breaking): I just wanted to put some of my selected elements (divs
really) in the canvas and it turns out I can only draw images and text
manually, not copy any (visible) element from the DOM.

Also using the canvas, once I set the DataTransfer.setDragImage to the
canvas, I cannot update it anymore with contextual information. It seems
this becomes unrelated to the real canvas, which I can still change (I
see it change if I add it to the document).

So I propose a few features:

- Allow the Selection.addRange API to specify whether there should be a
  visual information that the text is selected or not. When selecting a
  whole element, the browser can show (and FF does for example) that it
  is selected, no need to also show the text is selected too (although
  the default current behaviour is good).
- Allow access to the browser's drag image when he makes it himself
  (when not setting it, it uses the Selection), as something we can
  modify&#8230; canvas, DOM, ImageData, I don't care :)
- Allow using non-visible DOM elements (and those not in the Document)
  for drag image. Also keep track of their modifications.
- Keep track of modifications to the Canvas when using a Canvas as drag
  image.

If there's anything I missed (that would let me do what I want) don't
hesitate to let me know, that would help me :)
Also don't pay too much attention to the features I describe, they might
be stupid, but if my problems are real (and not just cause by my bad
usage of the API), it would be nice to find a way to fix those problems.

Thanks.
-- 
St&#233;phane Epardaud

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="067866.html">[whatwg] EventSource remark
</A></li>
	<LI>Next message: <A HREF="067942.html">[whatwg] More questions about the DnD API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67856">[ date ]</a>
              <a href="thread.html#67856">[ thread ]</a>
              <a href="subject.html#67856">[ subject ]</a>
              <a href="author.html#67856">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
