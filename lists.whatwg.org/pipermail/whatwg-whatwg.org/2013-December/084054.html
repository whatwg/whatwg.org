<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] onclose events for MessagePort
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20onclose%20events%20for%20MessagePort&In-Reply-To=%3CCA%2Bc2ei-HRv8rQWpse41Fu4pFg1w_ZO2qbdAAF3v_rV4P%3D5h7FQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="084042.html">
   <LINK REL="Next"  HREF="084058.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] onclose events for MessagePort</H1>
<!--htdig_noindex-->
    <B>Jonas Sicking</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20onclose%20events%20for%20MessagePort&In-Reply-To=%3CCA%2Bc2ei-HRv8rQWpse41Fu4pFg1w_ZO2qbdAAF3v_rV4P%3D5h7FQ%40mail.gmail.com%3E"
       TITLE="[whatwg] onclose events for MessagePort">jonas at sicking.cc
       </A><BR>
    <I>Thu Dec 12 15:40:09 PST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="084042.html">[whatwg] onclose events for MessagePort
</A></li>
        <LI>Next message: <A HREF="084058.html">[whatwg] onclose events for MessagePort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84054">[ date ]</a>
              <a href="thread.html#84054">[ thread ]</a>
              <a href="subject.html#84054">[ subject ]</a>
              <a href="author.html#84054">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Dec 11, 2013 at 4:54 PM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:
&gt;&gt;&gt;<i> The proposal at [1] does not prevent bfcaching *anytime* that
</I>&gt;&gt;&gt;<i> MessagePorts are alive in a page that is navigated away from. We can
</I>&gt;&gt;&gt;<i> always bfcache the page if we don't know of any &quot;other sides&quot; having
</I>&gt;&gt;&gt;<i> pinned their port. If we later detect that a port is being pinned, we
</I>&gt;&gt;&gt;<i> can indicate an error to the pinning side, and throw the bfcached page
</I>&gt;&gt;&gt;<i> out of the bfcache at that time.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It might be too late by then, since you might have already navigated back
</I>&gt;&gt;<i> to the bfcached page. This is why the IPC has to be synchronous, at the
</I>&gt;&gt;<i> latest during the back() navigation. (Not literally synchronous, I guess,
</I>&gt;&gt;<i> since otherwise you'd have trouble handling a mirror image scenario where
</I>&gt;&gt;<i> both sides were playing this game, but at least it needs to block the
</I>&gt;&gt;<i> history traversal back to a document that is bfcached but for which we may
</I>&gt;&gt;<i> not yet have received confirmation that the bfcache is clean.)
</I>&gt;<i>
</I>&gt;<i> No sync IPC needed. When a port is pinned, you send an async message
</I>&gt;<i> to the process which contains the page for the &quot;other side&quot;. When that
</I>&gt;<i> process receives the message you check if the page is currently being
</I>&gt;<i> displayed.
</I>
To add additional clarification here. It's ok if the receiving page
has gone into bfcache and come back while the message was in transit.
If the user is away from the page short enough that the page is
rendered again by the time the message arrives, then the page will be
able to respond and no errors need to be signaled. I.e. effectively
the responder never disappeared.

/ Jonas

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="084042.html">[whatwg] onclose events for MessagePort
</A></li>
	<LI>Next message: <A HREF="084058.html">[whatwg] onclose events for MessagePort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84054">[ date ]</a>
              <a href="thread.html#84054">[ thread ]</a>
              <a href="subject.html#84054">[ subject ]</a>
              <a href="author.html#84054">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
