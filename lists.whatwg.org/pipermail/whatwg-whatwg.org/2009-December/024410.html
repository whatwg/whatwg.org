<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Thread to run Web Socket feedback from the protocol ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Thread%20to%20run%20Web%20Socket%20feedback%20from%20the%20protocol%20%3F&In-Reply-To=%3CE4EC4CDC-F53D-4D53-B4DC-145750DF6611%40webkit.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024409.html">
   <LINK REL="Next"  HREF="024412.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Thread to run Web Socket feedback from the protocol ?</H1>
<!--htdig_noindex-->
    <B>Alexey Proskuryakov</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Thread%20to%20run%20Web%20Socket%20feedback%20from%20the%20protocol%20%3F&In-Reply-To=%3CE4EC4CDC-F53D-4D53-B4DC-145750DF6611%40webkit.org%3E"
       TITLE="[whatwg] Thread to run Web Socket feedback from the protocol ?">ap at webkit.org
       </A><BR>
    <I>Wed Dec  9 10:44:56 PST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="024409.html">[whatwg] Thread to run Web Socket feedback from the protocol ?
</A></li>
        <LI>Next message: <A HREF="024412.html">[whatwg] Thread to run Web Socket feedback from the protocol ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24410">[ date ]</a>
              <a href="thread.html#24410">[ thread ]</a>
              <a href="subject.html#24410">[ subject ]</a>
              <a href="author.html#24410">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On 09.12.2009, at 10:07, Ian Hickson wrote:

&gt;&gt;&gt;<i> I'm absolutely fine with changing WebSocket to change readyState as
</I>&gt;&gt;&gt;<i> part of the same task that dispatches the event
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, that is what I think the spec should say.
</I>&gt;<i>
</I>&gt;<i> Done.
</I>

As discussed on IRC, this leaves us with a race condition between  
close() and queued messages. The spec says that once close() is  
invoked, incoming data should be dropped, but queued tasks to dispatch  
message event will still be coming.

This race condition can of course be fixed without much difficulty. It  
may be more difficult to similarly rearrange XHR specs.

I find it unfortunate that where the spec says &quot;queue a task&quot;, most  
(or all) implementations will perform those actions immediately. This  
may be indistinguishable from JavaScript client code, but it will be a  
source of confusion for developers.

- WBR, Alexey Proskuryakov

</PRE>














<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024409.html">[whatwg] Thread to run Web Socket feedback from the protocol ?
</A></li>
	<LI>Next message: <A HREF="024412.html">[whatwg] Thread to run Web Socket feedback from the protocol ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24410">[ date ]</a>
              <a href="thread.html#24410">[ thread ]</a>
              <a href="subject.html#24410">[ subject ]</a>
              <a href="author.html#24410">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
