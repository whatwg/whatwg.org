<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] More YouTube response
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20More%20YouTube%20response&In-Reply-To=%3Cop.vfgthagcatwj1d%40philip-pc.gothenburg.osa%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="069314.html">
   <LINK REL="Next"  HREF="069338.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] More YouTube response</H1>
<!--htdig_noindex-->
    <B>Philip J&#228;genstedt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20More%20YouTube%20response&In-Reply-To=%3Cop.vfgthagcatwj1d%40philip-pc.gothenburg.osa%3E"
       TITLE="[whatwg] More YouTube response">philipj at opera.com
       </A><BR>
    <I>Wed Jul  7 01:49:48 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="069314.html">[whatwg] More YouTube response
</A></li>
        <LI>Next message: <A HREF="069338.html">[whatwg] More YouTube response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69326">[ date ]</a>
              <a href="thread.html#69326">[ thread ]</a>
              <a href="subject.html#69326">[ subject ]</a>
              <a href="author.html#69326">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, 06 Jul 2010 17:42:22 +0200, Marques Johansson  
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">marques at displague.com</A>&gt; wrote:

&gt;<i> On Tue, Jul 6, 2010 at 10:59 AM, Philip J&#228;genstedt  
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Tue, 06 Jul 2010 16:24:45 +0200, Marques Johansson &lt;
</I>&gt;&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">marques at displague.com</A>&gt; wrote:
</I>&gt;&gt;<i> Some UAs request video without sending &quot;Range: bytes 0-&quot;.  The server  
</I>&gt;&gt;<i> has
</I>&gt;&gt;<i> no
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> way to negotiate that the UA (a) must use ranges to complete the  
</I>&gt;&gt;&gt;<i> request
</I>&gt;&gt;&gt;<i> or
</I>&gt;&gt;&gt;<i> that (b) the range requested is too large, retry will a smaller range.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The first request is tricky for the browser too. Having no idea of how  
</I>&gt;&gt;<i> big
</I>&gt;&gt;<i> the resource is or what the bitrate is, there is no bounded request that
</I>&gt;&gt;<i> makes sense, in my opinion. The downside is that for a conservative
</I>&gt;&gt;<i> approach, the only solution is to abort the connection half way through,
</I>&gt;&gt;<i> with the server having no idea when this will happen. I haven't seen any
</I>&gt;&gt;<i> negative effects of this in practice yet, but this thread has me  
</I>&gt;&gt;<i> thinking
</I>&gt;&gt;<i> that it could be better. Handling a short reply gracefully would be a  
</I>&gt;&gt;<i> good
</I>&gt;&gt;<i> start.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> For webm files, Chrome requests 0-1024 and then some block near the end  
</I>&gt;<i> of
</I>&gt;<i> the file.  I assume that the meta data / time ranges are stored at these
</I>&gt;<i> locations.
</I>&gt;<i>
</I>&gt;<i> As for bounded requests that make sense - I'm sure the server hosting the
</I>&gt;<i> content could suggest something ;-)
</I>
If the index is stored in the beginning of the file, there should be no  
need to seek to the end. What we want is to get at least metadata and the  
first frame in a single request, and I can't guess any number that doesn't  
risk being larger than the file itself. Somehow involving the server just  
amounts to two network roundtrips, which was exactly what we were trying  
to avoid.

&gt;<i> I've tried having the server disconnect a HTTP/1.1 200 response by doing  
</I>&gt;<i> a
</I>&gt;<i> php exit() before having sent the &quot;Content-Length&quot; specified number of
</I>&gt;<i> bytes.  Browsers did not attempt to pick up where the server left off.
</I>&gt;<i>
</I>&gt;<i> I think you are suggesting that the client disconnect but without  
</I>&gt;<i> scripting
</I>&gt;<i>
</I>&gt;<i> I don't really have control over that and if with scripting that doesn't
</I>&gt;<i> seem doable unless the video element could be feed with an appendBytes()
</I>&gt;<i> type of function.
</I>
Yes, the browser disconnects, and scripts have no influence over it. With  
preload=&quot;metadata&quot; implemented, it should disconnect as soon as possible  
after getting enough data for the first frame. For preload=&quot;auto&quot;, it will  
disconnect after buffering X seconds of data. If you need more granularity  
than that, I suggest server-side control informed by information collected  
by JavaScript. If browsers handled a short reply to a range request, it  
should work just fine, no?

-- 
Philip J&#228;genstedt
Core Developer
Opera Software

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="069314.html">[whatwg] More YouTube response
</A></li>
	<LI>Next message: <A HREF="069338.html">[whatwg] More YouTube response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69326">[ date ]</a>
              <a href="thread.html#69326">[ thread ]</a>
              <a href="subject.html#69326">[ subject ]</a>
              <a href="author.html#69326">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
