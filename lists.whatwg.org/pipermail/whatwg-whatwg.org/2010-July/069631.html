<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] An API to resize and rotate images client-side
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20An%20API%20to%20resize%20and%20rotate%20images%20client-side&In-Reply-To=%3CAANLkTin9f7z5w3uExHRB_k5G0-9CGN3tM15i7efVu80N%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="069630.html">
   <LINK REL="Next"  HREF="069718.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] An API to resize and rotate images client-side</H1>
<!--htdig_noindex-->
    <B>Gregg Tavares (wrk)</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20An%20API%20to%20resize%20and%20rotate%20images%20client-side&In-Reply-To=%3CAANLkTin9f7z5w3uExHRB_k5G0-9CGN3tM15i7efVu80N%40mail.gmail.com%3E"
       TITLE="[whatwg] An API to resize and rotate images client-side">gman at google.com
       </A><BR>
    <I>Mon Jul 26 18:43:37 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="069630.html">[whatwg] An API to resize and rotate images client-side
</A></li>
        <LI>Next message: <A HREF="069718.html">[whatwg] An API to resize and rotate images client-side
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69631">[ date ]</a>
              <a href="thread.html#69631">[ thread ]</a>
              <a href="subject.html#69631">[ subject ]</a>
              <a href="author.html#69631">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Jul 26, 2010 at 6:34 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> On Thu, 20 May 2010, David Levin wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Twice when this was brought up on whatwg developers out of the blue
</I>&gt;<i> &gt; mentioned that the image resizing was a useful thing for them (once early
</I>&gt;<i> in
</I>&gt;<i> &gt; this thread and once long ago when canvas in workers was brought up).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In addition to that anecdotal evidence, here are several other places
</I>&gt;<i> this
</I>&gt;<i> &gt; comes up which I can list quickly:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - For example, take Facebook. If I upload a huge photo to Facebook, it
</I>&gt;<i> &gt; seems to upload the whole thing and then resizes it on the server (down
</I>&gt;<i> &gt; to something much smaller than 1600 X 1200).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - This is similar for other social sites like dating sites or Orkut that
</I>&gt;<i> &gt; only allow a maximum size of photo. Typically, either they force the
</I>&gt;<i> &gt; user to resize the image (which is a horrible experience) or they resize
</I>&gt;<i> &gt; the image on the client using gears (with workers and canvas) or flash,
</I>&gt;<i> &gt; etc. (or canvas but for more than one browser that may hang the UI).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - Similarly Gmail now allows dragging images into email
</I>&gt;<i> &gt; (<A HREF="http://gmailblog.blogspot.com/2010/05/drag-images-into-messages.html">http://gmailblog.blogspot.com/2010/05/drag-images-into-messages.html</A>).
</I>&gt;<i> &gt; The full resolution image isn't necessary for this. It would be better
</I>&gt;<i> &gt; to have a resized image.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - Something like Google Docs or Wave which show real time participation
</I>&gt;<i> &gt; of other people typing would benefit from getting a thumbnail of an
</I>&gt;<i> &gt; inserted image to other people in the conversation. (One could envision
</I>&gt;<i> &gt; this for any real time chat/communication website.)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - When you upload photos to picasaweb from the Picasa client, it offers
</I>&gt;<i> &gt; to resize them to 1600X1200 before uploading them. Also, it offers an
</I>&gt;<i> &gt; option to upload a thumbnail first before uploading the bigger picture,
</I>&gt;<i> &gt; so the album can appear even quicker (just at a really low resolution).
</I>&gt;<i> &gt; Ideally, a website could do something similar.
</I>&gt;<i>
</I>&gt;<i> On Tue, 25 May 2010, David Levin wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; <A HREF="http://webkit.org/demos/canvas-perf/canvas.html">http://webkit.org/demos/canvas-perf/canvas.html</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Firefox 3.7a4 (no D2D)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Direct image copy: 39ms
</I>&gt;<i> &gt; Indirect copy with (via ImageData): 160ms
</I>&gt;<i> &gt; Copy with 2x scale: 646.5ms
</I>&gt;<i> &gt; Copy with 0.5x scale: 42.5ms
</I>&gt;<i> &gt; Copy with rotate: 358ms
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Firefox 3.7a4 (D2D)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Direct image copy: 115ms
</I>&gt;<i> &gt; Indirect copy with (via ImageData): 365.5ms
</I>&gt;<i> &gt; Copy with 2x scale: 246ms
</I>&gt;<i> &gt; Copy with 0.5x scale: 48.5ms
</I>&gt;<i> &gt; Copy with rotate: 100.5ms
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Chrome 4.1.249.1064 (45376)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Direct image copy: 32.5ms
</I>&gt;<i> &gt; Indirect copy with (via ImageData): 207.5ms
</I>&gt;<i> &gt; Copy with 2x scale: 378.5ms
</I>&gt;<i> &gt; Copy with 0.5x scale: 27.5ms
</I>&gt;<i> &gt; Copy with rotate: 367ms
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; While the GPU does help in some scenarios, unfortunately it must still
</I>&gt;<i> &gt; take some time to do its work, so it doesn't enable us to do sync apis
</I>&gt;<i> &gt; that don't hang the UI.
</I>&gt;<i>
</I>&gt;<i> The logical conclusion is that we should make one of the following choices:
</I>&gt;<i>
</I>&gt;<i>  1. Provide dedicated asynchronous APIs for this use case.
</I>&gt;<i>    For example, a method to go from an image URL to a Blob representing
</I>&gt;<i>    that image at a different size and/or rotation.
</I>&gt;<i>
</I>&gt;<i>  2. Provide generic APIs for that can handle this use case amongst others.
</I>&gt;<i>    For example, porting the 2D canvas API to workers.
</I>&gt;<i>
</I>&gt;<i>
</I>I'd like to add I think there's a lot more enthusiasm for #2
because there are many other situations that need to do
CPU intensive computing without bogging down the
main browser thread.

I'm not knocking #1. I'm just suggesting that there are
more champions for #2 since it solves problems for
more people.

Any pointers to why this hasn't happened already?
I'm guessing there have already been giant debates
on how to share data between workers and the
main thread and or how to expose more services
to workers.



&gt;<i>  3. Not address this use case (yet).
</I>&gt;<i>
</I>&gt;<i> For #1, my preference would be to add two methods to &lt;img&gt;, one to make
</I>&gt;<i> &lt;img&gt; resize and rotate the image and then fire 'load' again, and one to
</I>&gt;<i> obtain the current image as a Blob, much like toDataURL() on &lt;canvas&gt;
</I>&gt;<i> (where a similar toBlob() would also be useful).
</I>&gt;<i>
</I>&gt;<i> For #2, we'd need to provide an Image object (a non-DOM version of
</I>&gt;<i> HTMLImageElement) and a Canvas object (a non-DOM version of
</I>&gt;<i> HTMLCanvasElement) in workers.
</I>&gt;<i>
</I>&gt;<i> But unless we have a critical mass of browser vendors agreed on one of
</I>&gt;<i> these approaches, we have to default to #3. Currently it seems only the
</I>&gt;<i> Chrome team is especially interested in either #1 or #2.
</I>&gt;<i>
</I>&gt;<i> My recommendation, in the absence of enthusiasm from other browser
</I>&gt;<i> vendors, would be for the Chrome team to experiment with #1 or #2. If I
</I>&gt;<i> have misread the current situation and there is a willingness to implement
</I>&gt;<i> #1 or #2 in more browsers, then please let me know. I'd be happy to spec
</I>&gt;<i> one of those options. (#1 would be easy to do; #2 might take longer, since
</I>&gt;<i> it is significantly more work.)
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ian Hickson               U+1047E                )\._.,--....,'``.    fL
</I>&gt;<i> <A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
</I>&gt;<i> Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100726/f22c21e7/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100726/f22c21e7/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="069630.html">[whatwg] An API to resize and rotate images client-side
</A></li>
	<LI>Next message: <A HREF="069718.html">[whatwg] An API to resize and rotate images client-side
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69631">[ date ]</a>
              <a href="thread.html#69631">[ thread ]</a>
              <a href="subject.html#69631">[ subject ]</a>
              <a href="author.html#69631">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
