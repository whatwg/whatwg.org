<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] More YouTube response
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20More%20YouTube%20response&In-Reply-To=%3Cop.vfffwqjkatwj1d%40philip-pc.gothenburg.osa%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="069311.html">
   <LINK REL="Next"  HREF="069314.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] More YouTube response</H1>
<!--htdig_noindex-->
    <B>Philip J&#228;genstedt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20More%20YouTube%20response&In-Reply-To=%3Cop.vfffwqjkatwj1d%40philip-pc.gothenburg.osa%3E"
       TITLE="[whatwg] More YouTube response">philipj at opera.com
       </A><BR>
    <I>Tue Jul  6 07:59:04 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="069311.html">[whatwg] More YouTube response
</A></li>
        <LI>Next message: <A HREF="069314.html">[whatwg] More YouTube response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69313">[ date ]</a>
              <a href="thread.html#69313">[ thread ]</a>
              <a href="subject.html#69313">[ subject ]</a>
              <a href="author.html#69313">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, 06 Jul 2010 16:24:45 +0200, Marques Johansson  
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">marques at displague.com</A>&gt; wrote:

&gt;<i> On Mon, Jul 5, 2010 at 4:26 PM, Aryeh Gregor
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Simetrical+w3c at gmail.com</A>&lt;Simetrical%<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">2Bw3c at gmail.com</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Mon, Jul 5, 2010 at 4:10 PM, Marques Johansson  
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">marques at displague.com</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i> &gt; For my purposes I am interested in application-controlled video  
</I>&gt;&gt;<i> delivery.
</I>&gt;&gt;<i>  I
</I>&gt;&gt;<i> &gt; want to be able to deliver unprotected mp4, webm, or ogv content in a
</I>&gt;&gt;<i> &gt; metered way.  If the user has payed to watch the entire video once and
</I>&gt;&gt;<i> has
</I>&gt;&gt;<i> &gt; managed to work around HTTP no-cache and the other constraints that a
</I>&gt;&gt;<i> normal
</I>&gt;&gt;<i> &gt; browser viewed experience would have, then they will have succeeding  
</I>&gt;&gt;<i> in
</I>&gt;&gt;<i> &gt; downloading a copy of the video - a task which they could have
</I>&gt;&gt;<i> accomplished
</I>&gt;&gt;<i> &gt; with a VM session or through other means regardless of DRM.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> There's no way to stop this at the markup level, since the user could
</I>&gt;&gt;<i> just configure a user-agent to ignore the attributes, or manually
</I>&gt;&gt;<i> remove them with a tool like Firebug.  More to the point, since this
</I>&gt;&gt;<i> feature doesn't provide significant benefit to many users or authors,
</I>&gt;&gt;<i> no user agent would bother implementing it in the first place.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You should instead look into to writing server-side scripts that meet
</I>&gt;&gt;<i> your needs.  When the user requests a video, have the script check how
</I>&gt;&gt;<i> much video the user is authorized to view, and just truncate it after
</I>&gt;&gt;<i> that point.  Or have it insert an extra clip at the end of what
</I>&gt;&gt;<i> they're allowed to view saying &quot;you have to pay more to keep viewing&quot;,
</I>&gt;&gt;<i> then truncate it.  Or whatever.  This is pretty easy to do, and not
</I>&gt;&gt;<i> possible for the user to circumvent.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If the UA didn't follow the prescribed size constraints they would get a  
</I>&gt;<i> 403
</I>&gt;<i> response (or a better 4xx range too large if it existed).
</I>&gt;<i>
</I>&gt;<i> The benefit to the user is that they could have less open network
</I>&gt;<i> connections while streaming video from server controlled sites and those
</I>&gt;<i> sites will have the ability to meter their usage more accurately.
</I>&gt;<i>
</I>&gt;<i> Inserting an extra clip at the end is more of a playlist or scripting
</I>&gt;<i> answer.  Or perhaps a a live re-encoding answer.   I'm looking for a way  
</I>&gt;<i> to
</I>&gt;<i> give the user the raw video file in a metered way.  A 200 response or
</I>&gt;<i> partial 206 responses that returns less than the full requested range is  
</I>&gt;<i> not
</I>&gt;<i> handled by browsers in a consistent or usable way (for this purpose).   
</I>&gt;<i> Only
</I>&gt;<i> Chrome will continue to fetch where the previous short 206 response left  
</I>&gt;<i> off
</I>&gt;<i> (request 1-10, server replies 1-5, request 6-10, server replies 6-10).   
</I>&gt;<i> The
</I>&gt;<i> HTTP spec isn't clear about whether UAs should take this behavior - and  
</I>&gt;<i> so
</I>&gt;<i> they don't.
</I>&gt;<i>
</I>&gt;<i> Some UAs request video without sending &quot;Range: bytes 0-&quot;.  The server  
</I>&gt;<i> has no
</I>&gt;<i> way to negotiate that the UA (a) must use ranges to complete the request  
</I>&gt;<i> or
</I>&gt;<i> that (b) the range requested is too large, retry will a smaller range.
</I>
The first request is tricky for the browser too. Having no idea of how big  
the resource is or what the bitrate is, there is no bounded request that  
makes sense, in my opinion. The downside is that for a conservative  
approach, the only solution is to abort the connection half way through,  
with the server having no idea when this will happen. I haven't seen any  
negative effects of this in practice yet, but this thread has me thinking  
that it could be better. Handling a short reply gracefully would be a good  
start.

&gt;&gt;<i> These requests can be seen as generally allowing servers to reduce load
</I>&gt;&gt;<i> for
</I>&gt;&gt;<i> &gt; video or large file downloads.  Since a client may be able to  
</I>&gt;&gt;<i> download 5
</I>&gt;&gt;<i> &gt; minutes of video in under a minute I would like to see the client
</I>&gt;&gt;<i> disconnect
</I>&gt;&gt;<i> &gt; from the server and reconnect in 5 minutes to get the additional  
</I>&gt;&gt;<i> content.
</I>&gt;&gt;<i>  I
</I>&gt;&gt;<i> &gt; would like to see the server have the ability to enforce this (through
</I>&gt;&gt;<i> HTTP
</I>&gt;&gt;<i> &gt; errors) or at least suggest it (through HTML5 attributes or additional
</I>&gt;&gt;<i> HTTP
</I>&gt;&gt;<i> &gt; headers).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Well-written clients should already buffer only as much as they need
</I>&gt;&gt;<i> to ensure the video will play smoothly.  The preload=&quot;&quot; attribute is
</I>&gt;&gt;<i> already provided to allow authors to control this behavior.  When the
</I>&gt;&gt;<i> client has read enough for now, it will just stop reading new content
</I>&gt;&gt;<i> from the server until it needs more.  If the server thinks that the
</I>&gt;&gt;<i> client is reading too fast, on the other hand, it can just send fewer
</I>&gt;&gt;<i> packets.  Again, I don't think anything needs to be changed in HTML
</I>&gt;&gt;<i> here.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> All of the current video clients make requests like &quot;Range: 0-&quot; or (when  
</I>&gt;<i> you
</I>&gt;<i> seek) &quot;Range: 0-end_of_file&quot;.  I don't want to give them the whole 2gb  
</I>&gt;<i> file
</I>&gt;<i> right now, they may seek to the end of the video at any moment while the
</I>&gt;<i> server is paying to send that data and the transfer will have been  
</I>&gt;<i> wasted.
</I>&gt;<i>  I don't want to throttle the connection because that is also a waste of
</I>&gt;<i> resources.  I want the UA to request X many bytes (which equates to some
</I>&gt;<i> fragment of time), disconnect if they will be busy beyond the keep-alive
</I>&gt;<i> time, and come back when they need more video data.  A 200 response and  
</I>&gt;<i> an
</I>&gt;<i> unbounded 206 response do not permit this.
</I>&gt;<i>
</I>&gt;<i> If the &lt;video&gt; tag included a minbuffer and a maxbuffer (at least the
</I>&gt;<i> latter) then the client would always have an upper bound on video ranges
</I>&gt;<i> requested.  If the UA failed to include this the server can give them a  
</I>&gt;<i> 403,
</I>&gt;<i> 416, or some 4xx that does not yet exist.
</I>
Let's wait until preload=&quot;&quot; is actually implemented to see if more  
fine-grained control is actually needed.

-- 
Philip J&#228;genstedt
Core Developer
Opera Software

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="069311.html">[whatwg] More YouTube response
</A></li>
	<LI>Next message: <A HREF="069314.html">[whatwg] More YouTube response
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#69313">[ date ]</a>
              <a href="thread.html#69313">[ thread ]</a>
              <a href="subject.html#69313">[ subject ]</a>
              <a href="author.html#69313">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
