<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Canvas: clarification of compositing operations needed
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%3A%20clarification%20of%20compositing%20operations%20needed&In-Reply-To=%3C4C50AB62.2040109%40davidflanagan.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027426.html">
   <LINK REL="Next"  HREF="027404.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Canvas: clarification of compositing operations needed</H1>
<!--htdig_noindex-->
    <B>David Flanagan</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Canvas%3A%20clarification%20of%20compositing%20operations%20needed&In-Reply-To=%3C4C50AB62.2040109%40davidflanagan.com%3E"
       TITLE="[whatwg] Canvas: clarification of compositing operations needed">david at davidflanagan.com
       </A><BR>
    <I>Wed Jul 28 15:12:50 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="027426.html">[whatwg] Canvas: clarification of compositing operations needed
</A></li>
        <LI>Next message: <A HREF="027404.html">[whatwg] Changing punctuation value of input element in telephone state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27407">[ date ]</a>
              <a href="thread.html#27407">[ thread ]</a>
              <a href="subject.html#27407">[ subject ]</a>
              <a href="author.html#27407">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Tab Atkins Jr. wrote:
&gt;<i> On Wed, Jul 28, 2010 at 2:43 PM, David Flanagan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">david at davidflanagan.com</A>&gt; wrote:
</I>&gt;&gt;<i> Firefox and Chrome disagree about the implementation of the
</I>&gt;&gt;<i> destination-atop, source-in, destination-in, and source-out compositing
</I>&gt;&gt;<i> operators.  Test code is attached.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Chrome doesn't touch any destination pixels that are not underneath the
</I>&gt;&gt;<i> source pixels.  Firefox, on the other hand, treats the entire canvas (inside
</I>&gt;&gt;<i> the clipping region) as the destination and if you use the destination-in
</I>&gt;&gt;<i> operator, for example, will erase any pixels outside of whatever you are
</I>&gt;&gt;<i> drawing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I suspect, based on the reference to an &quot;infinite transparent black bitmap&quot;
</I>&gt;&gt;<i> in 4.8.11.1.13 Drawing model that Firefox gets this right and Chrome gets it
</I>&gt;&gt;<i> wrong, but it would be nice to have that confirmed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I suggest clarifying 4.8.11.1.3 Compositing to mention that the compositing
</I>&gt;&gt;<i> operation takes place on all pixels within the clipping region, and that
</I>&gt;&gt;<i> some compositing operators clear large portions of the canvas.
</I>&gt;<i> 
</I>&gt;<i> The spec is completely clear on this matter - Firefox is right,
</I>&gt;<i> Chrome/Safari are wrong.  They do it wrongly because that's how
</I>&gt;<i> CoreGraphics, their graphics library, does things natively.
</I>&gt;<i> 
</I>&gt;<i> ~TJ
</I>&gt;<i> 
</I>
Thanks for the confirmation and the explanation of why webkit gets it 
wrong.

I disagree that the spec is completely clear, however.  In order to 
understand it you have to skip from section 3 on compositing operators 
to section 13 which mentions the infinite bitmap and compositing within 
the clipping region. There is no mention of the relevance of the 
clipping region in the section on compositing which seems like an oversight.

Also, descriptions of the operators cover only transparent and opaque 
pixels; they don't explain how compositing is done for translucent 
pixels, except by oblique reference to the Porter-Duff paper.

	David
</PRE>












<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027426.html">[whatwg] Canvas: clarification of compositing operations needed
</A></li>
	<LI>Next message: <A HREF="027404.html">[whatwg] Changing punctuation value of input element in telephone state
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27407">[ date ]</a>
              <a href="thread.html#27407">[ thread ]</a>
              <a href="subject.html#27407">[ subject ]</a>
              <a href="author.html#27407">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
