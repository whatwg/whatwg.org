<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Run to completion in the face of modal dialog boxes	(WAS: Storage mutex)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Run%20to%20completion%20in%20the%20face%20of%20modal%20dialog%20boxes%0A%09%28WAS%3A%20Storage%20mutex%29&In-Reply-To=%3Cbd8f24d20908262110jd87d44rfb96d4fedbb2e53%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="064609.html">
   <LINK REL="Next"  HREF="064645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Run to completion in the face of modal dialog boxes	(WAS: Storage mutex)</H1>
<!--htdig_noindex-->
    <B>Darin Fisher</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Run%20to%20completion%20in%20the%20face%20of%20modal%20dialog%20boxes%0A%09%28WAS%3A%20Storage%20mutex%29&In-Reply-To=%3Cbd8f24d20908262110jd87d44rfb96d4fedbb2e53%40mail.gmail.com%3E"
       TITLE="[whatwg] Run to completion in the face of modal dialog boxes	(WAS: Storage mutex)">darin at chromium.org
       </A><BR>
    <I>Wed Aug 26 21:10:13 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="064609.html">[whatwg] Run to completion in the face of modal dialog boxes	(WAS: Storage mutex)
</A></li>
        <LI>Next message: <A HREF="064645.html">[whatwg] Run to completion in the face of modal dialog boxes	(WAS: Storage mutex)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64642">[ date ]</a>
              <a href="thread.html#64642">[ thread ]</a>
              <a href="subject.html#64642">[ subject ]</a>
              <a href="author.html#64642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Aug 26, 2009 at 12:54 PM, Darin Fisher &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">darin at chromium.org</A>&gt; wrote:

&gt;<i> On Wed, Aug 26, 2009 at 12:49 PM, Jeremy Orlow &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jorlow at chromium.org</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Wed, Aug 26, 2009 at 11:17 AM, Darin Fisher &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">darin at chromium.org</A>&gt;wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Wed, Aug 26, 2009 at 1:27 AM, Jeremy Orlow &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jorlow at chromium.org</A>&gt;wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> On Wed, Aug 26, 2009 at 12:51 AM, Darin Fisher &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">darin at chromium.org</A>&gt;wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>  On Sun, Aug 23, 2009 at 11:33 PM, Robert O'Callahan &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> That behaviour sounds worse than what Firefox currently does, where an
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> alert disables input to all tabs in the window (which is already pretty
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> bad), because it willl make applications in visually unrelated tabs and
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> windows hang.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> You can have script connections that span multiple tabs in multiple
</I>&gt;&gt;&gt;&gt;&gt;<i> windows, so in order to preserve the run-to-completion semantics of
</I>&gt;&gt;&gt;&gt;&gt;<i> JavaScript, it is important that
</I>&gt;&gt;&gt;&gt;&gt;<i> window.{alert,confirm,prompt,showModalDialog} be modal across all windows in
</I>&gt;&gt;&gt;&gt;&gt;<i> the browser.  This is why those APIs suck rocks, and we should never create
</I>&gt;&gt;&gt;&gt;&gt;<i> APIs like them again.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I don't understand your point here.  Are you saying that the current
</I>&gt;&gt;&gt;&gt;<i> firefox behavior is not correct, that releasing the storage lock on these
</I>&gt;&gt;&gt;&gt;<i> events is not correct, or something else?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I meant that the current Firefox behavior is technically incorrect.  No
</I>&gt;&gt;&gt;<i> one likes app modal dialogs, but how else can you guarantee
</I>&gt;&gt;&gt;<i> run-to-completion semantics? How else do you prevent other scripts from
</I>&gt;&gt;&gt;<i> modifying your state while you are stuck calling into window.alert().
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I don't know much about this issue, but it seems like something that
</I>&gt;&gt;<i> should either be fixed in Firefox (and other browsers?) or changed in the
</I>&gt;&gt;<i> spec.  I'm interested to hear if others have thoughts on it.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Chrome and Safari both implement app-modal alerts.  Firefox and IE
</I>&gt;<i> implement window modal, which is clearly buggy, but of course the world
</I>&gt;<i> hasn't imploded.  I haven't tested Opera.
</I>&gt;<i>
</I>&gt;<i> Personally, I would like to change Chrome to not put up app modal alerts.
</I>&gt;<i>  I think it is bad UI, but I'm not sure how to do so without also breaking
</I>&gt;<i> the contract that JavaScript execution appear single threaded.
</I>&gt;<i>
</I>&gt;<i> -Darin
</I>&gt;<i>
</I>

Also, just for completeness, if you consider scoping an alert to a window,
then what happens when an alert is generated by another window?  If each
alert is implemented using a nested event loop, then closing the first alert
will not return execution control back to the page that call alert.

So, the user will be left with a dead browser window.  This is very similar
to the problem that exists with app modal alerts where one window is
inactive while another is showing an alert.

Without something like co-routines, I'm not sure how to solve this.

-Darin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090826/e3dfb49c/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090826/e3dfb49c/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="064609.html">[whatwg] Run to completion in the face of modal dialog boxes	(WAS: Storage mutex)
</A></li>
	<LI>Next message: <A HREF="064645.html">[whatwg] Run to completion in the face of modal dialog boxes	(WAS: Storage mutex)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64642">[ date ]</a>
              <a href="thread.html#64642">[ thread ]</a>
              <a href="subject.html#64642">[ subject ]</a>
              <a href="author.html#64642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
