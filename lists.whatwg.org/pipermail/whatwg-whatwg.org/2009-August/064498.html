<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Comments on the definition of a valid e-mail address
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Comments%20on%20the%20definition%20of%20a%20valid%20e-mail%20address&In-Reply-To=%3Cd62cf1d10908231923l443083e4n503c094d4bc5d681%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="064497.html">
   <LINK REL="Next"  HREF="064499.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Comments on the definition of a valid e-mail address</H1>
<!--htdig_noindex-->
    <B>Peter Kasting</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Comments%20on%20the%20definition%20of%20a%20valid%20e-mail%20address&In-Reply-To=%3Cd62cf1d10908231923l443083e4n503c094d4bc5d681%40mail.gmail.com%3E"
       TITLE="[whatwg] Comments on the definition of a valid e-mail address">pkasting at google.com
       </A><BR>
    <I>Sun Aug 23 19:23:49 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="064497.html">[whatwg] Comments on the definition of a valid e-mail address
</A></li>
        <LI>Next message: <A HREF="064499.html">[whatwg] Comments on the definition of a valid e-mail address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64498">[ date ]</a>
              <a href="thread.html#64498">[ thread ]</a>
              <a href="subject.html#64498">[ subject ]</a>
              <a href="author.html#64498">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Thanks very much for this analysis!

On Sun, Aug 23, 2009 at 12:41 PM, Aryeh Gregor
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Simetrical+w3c at gmail.com</A>&lt;Simetrical%<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">2Bw3c at gmail.com</A>&gt;
&gt;<i> wrote:
</I>
&gt;<i> Inspection showed that the overwhelming majority of the failures were
</I>&gt;<i> due to the presence of excess whitespace, often a single trailing
</I>&gt;<i> space, or a space inserted before or after the @ sign.  When I
</I>&gt;<i> adjusted the regex to ignore those failures, I got a smaller list, 202
</I>&gt;<i> (about 0.007% of the total):
</I>

I think telling user agents to strip leading and trailing whitespace is a
good idea.  I'm not as sure about stripping whitespace in the middle.

Some of these were clearly wrong, and shouldn't have been confirmed to
&gt;<i> begin with.  Some even didn't have an @ sign, so probably were
</I>&gt;<i> submitted in some window when we did no validation at all (and I have
</I>&gt;<i> no idea how they got confirmed).  Of the ones that possibly work,
</I>

You said there were 202 rows total in this group.  How many of those 202 are
&quot;ones that possibly work&quot;?

I ask because if it is significantly less than 202, then the failure rate
(if we strip whitespace) is noticeably less than 0.007% of your sample.  I
am not as firmly on the side of &quot;never reject anything conceivably valid&quot;,
probably because I think there's more of a chance of type=email obsoleting
silly JS-based validators if we do it right.

So why not have the spec say that in the case of e-mail addresses, the

browser may warn the user, but should permit them to submit the
&gt;<i> address anyway?  If the user is willing to override the warning, then
</I>&gt;<i> it's likely that they personally know that the e-mail address works,
</I>&gt;<i> e.g., because they use it.
</I>

I don't think this is a very valuable option because I don't think a UA can
make good UX out of it (I speak as a member of the Chromium team who works
on UX).

Alternatively, you could just loosen the restrictions even further,
&gt;<i> and only ban input that doesn't contain an @ sign.  (Or that doesn't
</I>&gt;<i> match ^[^@]+@[^@]+\.[^@]+$, or whatever.)
</I>

One notable datum missing from your otherwise useful analysis is how many
_invalid_ email addresses not allowed by the current definition would be
allowed by this.  I suspect the number is large.  I would be willing to
trade a tiny number (&lt;0.007%?) of false negatives to avoid a large number of
false positives, especially since I suspect that if the check were weakened
this far authors would be more likely to continue with their (currently
lousy) hand-written validators.


&gt;<i> Or just don't ban anything
</I>&gt;<i> at all, like with type=tel.
</I>

I don't support this.

I think this input type has only been implemented in Opera so far.


I am mentoring a student who is writing a patch for this in WebKit as we
speak -- we were just discussing the implementation yesterday and I believe
he hopes to have it out for review tomorrow.

I don't think there are serious interoperability concerns
&gt;<i> with changing it at this point,
</I>

I agree, it would be fairly easy to switch if the validation algorithm were
changed.

PK
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090823/3d2c4a6b/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090823/3d2c4a6b/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="064497.html">[whatwg] Comments on the definition of a valid e-mail address
</A></li>
	<LI>Next message: <A HREF="064499.html">[whatwg] Comments on the definition of a valid e-mail address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64498">[ date ]</a>
              <a href="thread.html#64498">[ thread ]</a>
              <a href="subject.html#64498">[ subject ]</a>
              <a href="author.html#64498">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
