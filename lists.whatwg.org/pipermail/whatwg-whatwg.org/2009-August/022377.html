<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Web Storage: apparent contradiction in spec
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Web%20Storage%3A%20apparent%20contradiction%20in%20spec&In-Reply-To=%3C4A96A2EC.1040206%40graffitiweb.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022346.html">
   <LINK REL="Next"  HREF="022381.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Web Storage: apparent contradiction in spec</H1>
<!--htdig_noindex-->
    <B>Schuyler Duveen</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Web%20Storage%3A%20apparent%20contradiction%20in%20spec&In-Reply-To=%3C4A96A2EC.1040206%40graffitiweb.org%3E"
       TITLE="[whatwg] Web Storage: apparent contradiction in spec">whatwg at graffitiweb.org
       </A><BR>
    <I>Thu Aug 27 08:14:52 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="022346.html">[whatwg] Note on the DETAILS element
</A></li>
        <LI>Next message: <A HREF="022381.html">[whatwg] Web Storage: apparent contradiction in spec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22377">[ date ]</a>
              <a href="thread.html#22377">[ thread ]</a>
              <a href="subject.html#22377">[ subject ]</a>
              <a href="author.html#22377">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I'm one of the lurking web application developers.  This discussion has
gone mostly how I was hoping, but since 'offline apps' has come up
again, I might bootstrap that a bit.  Below are some use cases, but I'll
summarize my perspective briefly.

1. To run Doom requiring 500M of localStorage sounds like an
'application'--both users and developers currently have the expectation
that users have to approve something like that before being installed to
their computers to consume possibly valuable resources.  A preliminary
prompt to the user sounds reasonable and expected here.

2. Once, I've approved of an application to store data locally, that
data could very easily be incredibly precious to both user and
developer.  Neither would want that data to be swept away by a
garbage-collecting browser without user/developer action.

3. If the developer is presented with an unprompted option to store data
 permanently or just have it 'cached'--I'm not sure why the developer
(both the nefarious and the good) would ever opt for the only-cached
version.

4. We'd like either (OffTopic)
   a. localStorage to work for <A HREF="file://">file://</A>
AND/OR
   b. there to be some way for someone with file access to change the
      manifest file cache in offline applications (while preserving

SOME USE CASES
--------------
Where I work (<A HREF="http://ccnmtl.columbia.edu">http://ccnmtl.columbia.edu</A>), we have two main use cases
for offline applications, which would be great if they were accomodated
in the spec and even more importantly, browsers :-)

1. Static deployment as an 'offline app'
<A HREF="http://ccnmtl.columbia.edu/portfolio/medicine_and_health/masivukeni.html">http://ccnmtl.columbia.edu/portfolio/medicine_and_health/masivukeni.html</A>

Requirements/Constraints:
  * We were most familiar with programming and deploying web
applications, so we preferred to use html/js (and python for backend to
content development)
  * The application was to be run on a laptop which could not (and
should not) connect to the Internet while being used.
  * Data (including user accounts) is then maintained using localStorage.
  * Rare updates (for critical bugs, e.g.) would not require online
access again.

Experience/Lessons:
  * We deployed this with Firefox's legacy globalStorage (before ffox3.5
came out) and static html files accessed at <A HREF="file://">file://</A>
  * As written, it no longer works in ffox 3.5 or even with updates to
ffox 3.0, because whereas <A HREF="file://localhost/">file://localhost/</A> once worked (and thus
globalStorage['localhost']), but seems to have been removed.
Thankfully, as deployed, it's not connected to the Internet to receive
updates :-)
  * If we implemented it again (which we will!) for HTML5, we would have
the laptop download the files as an offline app with a manifest.  Then
localStorage would (hopefully) still work, and work upon visiting the
domain--even offline.  However, this might cause problems in updating
the cached files without bringing the computer back online.

2. Deprecating experience for unprivileged users.
  * We have some services which allow annotation of primary sources
(video/audio/images).
  * Some of these sites have public content, but we do not have the
resources or interest in storing annotation/analysis from other users.
Nonetheless, we've considered offline storage as a way to allow
non-privileged users to analyze the content and store their data
locally--to be saved for their own benefit and possibly later to be
uploaded or shared elsewhere.

In concluding, many thanks to all those that are working on HTML5 (esp.
the browser vendors).  It's an exciting time to be a web developer.

cheers,
Schuyler

&gt;<i> Message: 1
</I>&gt;<i> Date: Wed, 26 Aug 2009 20:54:12 -0700
</I>&gt;<i> From: Drew Wilson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">atwilson at google.com</A>&gt;
</I>&gt;<i> To: Linus Upson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">linus at google.com</A>&gt;
</I>&gt;<i> Cc: Brady Eidson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">beidson at apple.com</A>&gt;, WHATWG List &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A>&gt;,
</I>&gt;<i> 	Jeremy Orlow &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jorlow at chromium.org</A>&gt;, Jens Alfke &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">snej at google.com</A>&gt;,
</I>&gt;<i> 	Aaron Boodman &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">aa at google.com</A>&gt;
</I>&gt;<i> Subject: Re: [whatwg] Web Storage: apparent contradiction in spec
</I>&gt;<i> Message-ID:
</I>&gt;<i> 	&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">f965ae410908262054y7d405cbdq2f7b115c7b694dda at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i> 
</I>&gt;<i> This is one of those times when I *really* wish that the application
</I>&gt;<i> developer community was more active on this list. I absolutely understand
</I>&gt;<i> Linus' point of view, but I also feel like we are really hamstringing
</I>&gt;<i> applications when we make choices like this and I wish that those developers
</I>&gt;<i> were more vocally represented in these types of discussions.
</I>&gt;<i> Going down this path would basically kill the ability to have offline web
</I>&gt;<i> applications, because there would be no guarantees that the data would
</I>&gt;<i> persist until the user comes back online. But since that point's already
</I>&gt;<i> been made several times, I guess it's not a compelling argument.
</I>&gt;<i> 
</I>&gt;<i> -atw
</I>&gt;<i> 
</I>&gt;<i> On Wed, Aug 26, 2009 at 8:23 PM, Linus Upson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">linus at google.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> I simply want clicking on links to be safe. In a previous thread I wrote
</I>&gt;&gt;<i> &quot;safe and stateless&quot; but I'm coming to the opinion that stateless is
</I>&gt;&gt;<i> a corollary of safe. Clicking on links shouldn't, either by filling my disk
</I>&gt;&gt;<i> or hitting my global quota, someday lead to a dialog which reads, &quot;Please
</I>&gt;&gt;<i> choose what to delete so that web sites will continue to work.&quot; The
</I>&gt;&gt;<i> candidate delete list will be thousands long and hidden in that haystack
</I>&gt;&gt;<i> will be a few precious needles.
</I>&gt;&gt;<i> I also want to avoid any [Yes] [No] dialogs. Can I do something scary [Yes]
</I>&gt;&gt;<i> [No]? Can I do something innocuous [Yes] [No]? Users shouldn't be forced to
</I>&gt;&gt;<i> make those kinds of safety judgements. I'm guilty of instigating at least
</I>&gt;&gt;<i> one of those dialogs. As shamed politicians do I'll retreat to the passive
</I>&gt;&gt;<i> voice: Mistakes were made.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm not opposed to web apps manipulating files on the user's computer, but
</I>&gt;&gt;<i> the user should be in explicit control. I'd support &lt;input type=&quot;open&quot;&gt; and
</I>&gt;&gt;<i> &lt;input type=&quot;save&quot;&gt; that worked similarly to &lt;input type=&quot;file&quot;&gt;. User
</I>&gt;&gt;<i> agents are already registering for file types so that double clicking a file
</I>&gt;&gt;<i> with a certain extension can be automatically sent to an URL, perhaps
</I>&gt;&gt;<i> residing in an AppCache.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In addition, I'd like to see the pop-up dialogs for the location API
</I>&gt;&gt;<i> removed. I find the &quot;Can I know where you are?&quot; dialogs on the iPhone very
</I>&gt;&gt;<i> annoying. Mistakes were made. Perhaps we can find a way to make &lt;input
</I>&gt;&gt;<i> type=&quot;location&quot;&gt; work well instead.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Linus
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, Aug 26, 2009 at 5:14 PM, Brady Eidson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">beidson at apple.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I started writing a detailed rebuttal to Linus's reply, but by the time I
</I>&gt;&gt;&gt;<i> was finished, many others had already delivered more targetted replies.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So I'll cut the rebuttal format and make a few specific points.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  - Many apps act as a &quot;shoebox&quot; for managing specific types of data, and
</I>&gt;&gt;&gt;<i> users are used to using these apps to manage that data directly.  See
</I>&gt;&gt;&gt;<i> iTunes, Windows Media Player, iPhoto, and desktop mail clients as examples.
</I>&gt;&gt;&gt;<i>  This trend is growing, not waning.  Browsers are already a &quot;shoebox&quot; for
</I>&gt;&gt;&gt;<i> history, bookmarks, and other types of data.
</I>&gt;&gt;&gt;<i> Claiming that this data is &quot;hidden&quot; from users who are used to handling
</I>&gt;&gt;&gt;<i> obscure file management scenarios  and therefore we shouldn't fully respect
</I>&gt;&gt;&gt;<i> it is trying to fit in with the past, not trying to make the future better.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  - No one is suggesting that UAs not have whatever freedom they want in
</I>&gt;&gt;&gt;<i> deciding *what* or *how much* to store.  We're only suggesting that once the
</I>&gt;&gt;&gt;<i> UA has committed to storing it, it *not* be allowed to arbitrarily purge it.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  - One use of LocalStorage is as a cache for data that is transient and
</I>&gt;&gt;&gt;<i> non-critical in nature, or that will live on a server.  But another,
</I>&gt;&gt;&gt;<i> just-as-valid use of LocalStorage is for persistent, predictable storage in
</I>&gt;&gt;&gt;<i> the client UA that will never rely on anything in the cloud.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  - And on that note, if developers don't have faith that data in
</I>&gt;&gt;&gt;<i> LocalStorage is actually persistent and safe, they won't use it.
</I>&gt;&gt;&gt;<i> I've given talks on this point 4 times in the last year, and I am stating
</I>&gt;&gt;&gt;<i> this as a fact, based on real-world feedback from actual, real-world web
</I>&gt;&gt;&gt;<i> developers:  If LocalStorage is defined in the standard to be a purgable
</I>&gt;&gt;&gt;<i> cache, developers will continue to use what they're already comfortable
</I>&gt;&gt;&gt;<i> with, which is Flash's LocalStorage.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> When a developer is willing to instantiate a plug-in just to reliably
</I>&gt;&gt;&gt;<i> store simple nuggets of data - like user preferences and settings - because
</I>&gt;&gt;&gt;<i> they don't trust the browser, then I think we've failed in moving the web
</I>&gt;&gt;&gt;<i> forward.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I truly hope we can sway the &quot;LocalStorage is a cache crowd.&quot;  But if we
</I>&gt;&gt;&gt;<i> can't, then I would have to suggest something crazy - that we add a third
</I>&gt;&gt;&gt;<i> Storage object.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> (Note that Jens - from Google - has already loosely suggested this)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So we'd have something like:
</I>&gt;&gt;&gt;<i> -SessionStorage - That fills the &quot;per browsing context&quot; role and whose
</I>&gt;&gt;&gt;<i> optionally transient nature is already well spec'ed
</I>&gt;&gt;&gt;<i> -CachedStorage - That fills Google's interpretation of the &quot;LocalStorage&quot;
</I>&gt;&gt;&gt;<i> role in that it's global, and &quot;will probably be around on the disk in the
</I>&gt;&gt;&gt;<i> future, maybe&quot;
</I>&gt;&gt;&gt;<i> -FileStorage - That fills Apple's interpretation of the &quot;LocalStorage&quot;
</I>&gt;&gt;&gt;<i> role in that it's global, and is as sacred as a file on the disk (or a song
</I>&gt;&gt;&gt;<i> in your media library, or a photo in your photo library, or a bookmark,
</I>&gt;&gt;&gt;<i> or...)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The names are just suggestions at this point.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ~Brady
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>
</PRE>














































































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022346.html">[whatwg] Note on the DETAILS element
</A></li>
	<LI>Next message: <A HREF="022381.html">[whatwg] Web Storage: apparent contradiction in spec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22377">[ date ]</a>
              <a href="thread.html#22377">[ thread ]</a>
              <a href="subject.html#22377">[ subject ]</a>
              <a href="author.html#22377">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
