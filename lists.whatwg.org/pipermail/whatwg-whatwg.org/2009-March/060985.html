<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Accessing cookies from workers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Accessing%20cookies%20from%20workers&In-Reply-To=%3Cf965ae410903051755g6a1356c0q29eb4d15c2b04f1e%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="060982.html">
   <LINK REL="Next"  HREF="060987.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Accessing cookies from workers</H1>
<!--htdig_noindex-->
    <B>Drew Wilson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Accessing%20cookies%20from%20workers&In-Reply-To=%3Cf965ae410903051755g6a1356c0q29eb4d15c2b04f1e%40mail.gmail.com%3E"
       TITLE="[whatwg] Accessing cookies from workers">atwilson at google.com
       </A><BR>
    <I>Thu Mar  5 17:55:47 PST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="060982.html">[whatwg] Accessing cookies from workers
</A></li>
        <LI>Next message: <A HREF="060987.html">[whatwg] Accessing cookies from workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60985">[ date ]</a>
              <a href="thread.html#60985">[ thread ]</a>
              <a href="subject.html#60985">[ subject ]</a>
              <a href="author.html#60985">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>In my particular case, I'm trying to figure out how to use cookie-based
authentication from workers.
I could use postMessage() to a main window to set cookies. However, I have
another motivation for exploring this: my team is planning to experiment
with persistent workers (workers that continue running even after all
entangled windows are closed). In that case, there may not be any window you
can use to set cookies. I'll send more about this in a separate thread.

Finally, there's one thing you can do with cookies that I don't think you
can do with local storage: share data with other subdomains (i.e. if I'm
running code under foo.example.com, I can write a cookie with 'domain=.
example.com' and it'll be visible to code running under
bar.example.comalso). This is useful for things like single sign-on
authentication.

-atw

On Thu, Mar 5, 2009 at 5:42 PM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:

&gt;<i> On Thu, Mar 5, 2009 at 5:23 PM, Michael Nordman &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">michaeln at google.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt;&gt; Allowing cookie to be set would unfortunately create a synchronous
</I>&gt;<i> &gt;&gt; communication channel between the worker and the main window. This is
</I>&gt;<i> &gt;&gt; something that we need to avoid to prevent users from having to deal
</I>&gt;<i> &gt;&gt; with locking and other thread related issues.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hmmm... the cookie setting API could be async in workers.
</I>&gt;<i>
</I>&gt;<i> Or you could just use postMessage() and ask the main thread to do it?
</I>&gt;<i>
</I>&gt;<i> What is the use case for reading/writing cookies though? Could use use
</I>&gt;<i> localStorage instead (once we figure out a different API for it that
</I>&gt;<i> doesn't have the shared-state problem that the current API has)
</I>&gt;<i>
</I>&gt;<i> Even just synchronous read access has race-condition problems. For
</I>&gt;<i> example the following script:
</I>&gt;<i>
</I>&gt;<i> if (docCookies == &quot;hello&quot;) {
</I>&gt;<i>  doStuff();
</I>&gt;<i> }
</I>&gt;<i> else {
</I>&gt;<i>  log(&quot;cookies certainly aren't 'hello', they are: &quot; + docCookies);
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> could result in &quot;cookies certainly aren't 'hello', they are: hello&quot;
</I>&gt;<i> being printed.
</I>&gt;<i>
</I>&gt;<i> / Jonas
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090305/a758711b/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090305/a758711b/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="060982.html">[whatwg] Accessing cookies from workers
</A></li>
	<LI>Next message: <A HREF="060987.html">[whatwg] Accessing cookies from workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#60985">[ date ]</a>
              <a href="thread.html#60985">[ thread ]</a>
              <a href="subject.html#60985">[ subject ]</a>
              <a href="author.html#60985">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
