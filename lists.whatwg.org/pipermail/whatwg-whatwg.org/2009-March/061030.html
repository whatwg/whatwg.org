<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] URL encoding for XHR and Workers.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20URL%20encoding%20for%20XHR%20and%20Workers.&In-Reply-To=%3C28040fc60903091152j48e9105aha236e1a1a080aa73%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="061005.html">
   <LINK REL="Next"  HREF="061037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] URL encoding for XHR and Workers.</H1>
<!--htdig_noindex-->
    <B>Dmitry Titov</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20URL%20encoding%20for%20XHR%20and%20Workers.&In-Reply-To=%3C28040fc60903091152j48e9105aha236e1a1a080aa73%40mail.gmail.com%3E"
       TITLE="[whatwg] URL encoding for XHR and Workers.">dimich at chromium.org
       </A><BR>
    <I>Mon Mar  9 11:52:32 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="061005.html">[whatwg] URL encoding for XHR and Workers.
</A></li>
        <LI>Next message: <A HREF="061037.html">[whatwg] URL encoding for XHR and Workers.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61030">[ date ]</a>
              <a href="thread.html#61030">[ thread ]</a>
              <a href="subject.html#61030">[ subject ]</a>
              <a href="author.html#61030">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Update:Ian Hixie pointed to places in spec which specify very clearly that
all URLs in workers will be encoded in UTF-8 (including query part) before
sent over wire regardless of whether it is a new worker, importScripts or
XHR URL.

The &quot;encoding of the script&quot; is set to UTF-8 as prescribed by Workers spec,
section 2.5, step 3. This overrides the 'inherited' encoding from the parent
document and even http header for the worker's script. At the same time,
HTML5 spec, section 2.5.1 says URL that came from script has encoding of the
script.

So the FF beta behavior (encode URLs using the encoding of the top-level
document that created the first level worker) seems to be incorrect, I plan
to file a bug on it.

Dmitry


On Sat, Mar 7, 2009 at 9:39 AM, Anne van Kesteren &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">annevk at opera.com</A>&gt; wrote:

&gt;<i> On Sat, 07 Mar 2009 00:51:51 +0100, Dmitry Titov &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">dimich at chromium.org</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> - XmlHttpRequest created on the Page would send its URL to server encoded
</I>&gt;&gt;<i> using UTF8, irrespective to the encoding of the Page. However, a
</I>&gt;&gt;<i> XmlHttpRequest created in the Worker would send the URL encoded using
</I>&gt;&gt;<i> Page's encoding. It seems that either XHR on the Page should also use Page's
</I>&gt;&gt;<i> encoding, or XHR in the Worker should use UTF-8. Bug?
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I don't see how Web Workers specification overrides UTF-8 here. Admittedly,
</I>&gt;<i> XMLHttpRequest does need to be updated to be able to get base URLs not
</I>&gt;<i> derived from Window/Document.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Anne van Kesteren
</I>&gt;<i> <A HREF="http://annevankesteren.nl/">http://annevankesteren.nl/</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090309/c1c94d22/attachment-0001.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090309/c1c94d22/attachment-0001.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="061005.html">[whatwg] URL encoding for XHR and Workers.
</A></li>
	<LI>Next message: <A HREF="061037.html">[whatwg] URL encoding for XHR and Workers.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61030">[ date ]</a>
              <a href="thread.html#61030">[ thread ]</a>
              <a href="subject.html#61030">[ subject ]</a>
              <a href="author.html#61030">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
