<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] postMessage object cloning
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%20object%20cloning&In-Reply-To=%3CDA7BF391-3EDD-4EE0-8E9F-D06305FD5080%40apple.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="061124.html">
   <LINK REL="Next"  HREF="061147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] postMessage object cloning</H1>
<!--htdig_noindex-->
    <B>Oliver Hunt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%20object%20cloning&In-Reply-To=%3CDA7BF391-3EDD-4EE0-8E9F-D06305FD5080%40apple.com%3E"
       TITLE="[whatwg] postMessage object cloning">oliver at apple.com
       </A><BR>
    <I>Mon Mar 16 17:33:59 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="061124.html">[whatwg] Syntax to access video elements time-ranges,	a change from old 	pattern
</A></li>
        <LI>Next message: <A HREF="061147.html">[whatwg] Text Encoding used to decode Web Worker's script.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61144">[ date ]</a>
              <a href="thread.html#61144">[ thread ]</a>
              <a href="subject.html#61144">[ subject ]</a>
              <a href="author.html#61144">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>So I've been looking at the object cloning rules for postMessage and  
have noticed a couple of things that seem less than ideal.  The first  
is that it fails to specify the behaviour of cloning for prototype  
chains.  While this is definitely an issue specific to JS rather than  
binding languages as a whole, JS is the language of the web, so if I  
have an object, a la:
myObject = {};
myObject.__proto__ = {foo: &quot;bar&quot;}

Do we clone the prototype object?  Do we flatten the prototype list?  
or do we drop the prototype?

The other issue i bumped into is behaviour of ImageData/ 
CanvasPixelArray -- currently (per spec) these will not be cloned, and  
instead have to be marshalled into and out of arrays by the  
developer.  This seems less than ideal -- could the internal  
structuring algorithm be extended to include these types.  The  
alternative is to allow CPA, etc to be automatically marshalled to  
arrays, which (while not ideal) would at least get processing correct  
in one direction.  Unfortunately the developer would still have to  
manually marshall data coming from the worker, hence my preference for  
allowing ImageData and CPA to be cloned.

--Oliver


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="061124.html">[whatwg] Syntax to access video elements time-ranges,	a change from old 	pattern
</A></li>
	<LI>Next message: <A HREF="061147.html">[whatwg] Text Encoding used to decode Web Worker's script.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61144">[ date ]</a>
              <a href="thread.html#61144">[ thread ]</a>
              <a href="subject.html#61144">[ subject ]</a>
              <a href="author.html#61144">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
