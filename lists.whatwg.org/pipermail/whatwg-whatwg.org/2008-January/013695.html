<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Referer header sent with &lt;a ping&gt;?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Referer%20header%20sent%20with%20%3Ca%20ping%3E%3F&In-Reply-To=%3Cop.t5et761y4suneb%40aimac.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013664.html">
   <LINK REL="Next"  HREF="013797.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Referer header sent with &lt;a ping&gt;?</H1>
<!--htdig_noindex-->
    <B>Kornel Lesinski</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Referer%20header%20sent%20with%20%3Ca%20ping%3E%3F&In-Reply-To=%3Cop.t5et761y4suneb%40aimac.local%3E"
       TITLE="[whatwg] Referer header sent with &lt;a ping&gt;?">kornel at osiolki.net
       </A><BR>
    <I>Wed Jan 23 17:25:03 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="013664.html">[whatwg] Referer header sent with &lt;a ping&gt;?
</A></li>
        <LI>Next message: <A HREF="013797.html">[whatwg] Referer header sent with &lt;a ping&gt;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13695">[ date ]</a>
              <a href="thread.html#13695">[ thread ]</a>
              <a href="subject.html#13695">[ subject ]</a>
              <a href="author.html#13695">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, 23 Jan 2008 07:27:16 -0000, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:

&gt;&gt;<i> HTML5 doesn't say anything about whether a referer should be sent with
</I>&gt;&gt;<i> the POST generated by &lt;a ping&gt;. There is a new attack vector &lt;a ping&gt;
</I>&gt;&gt;<i> opens (as currently being discussed on mozilla.dev.platform) that would
</I>&gt;&gt;<i> be blocked if the referer were not sent.
</I>&gt;<i>
</I>&gt;<i> Fixed. I also said to not include Cookies or HTTP auth headers.  
</I>&gt;<i> Legitimate uses can always include whatever information they want in the  
</I>&gt;<i> ping=&quot;&quot;
</I>&gt;<i> attribute's value itself.
</I>
Doesn't that kill use of ping for tracking ad clicks? I think ad providers  
want to have cookies to track individual users across domains, and site  
that serves &lt;a&gt; is unable to provide that. Maybe ping could allow only  
cookies with a certain name/naming scheme?


I don't think that attack vector discussed on mozilla.dev.platform should  
be taken so seriously. In my opinion case when &lt;a ping&gt; enables attack  
(instead of being just one of countless possible attack vectors) is very  
very unlikely:

- If site accepts data from GET as well as POST (e.g. is using PHP's  
register_globals), then &lt;a ping&gt; is not needed at all -- a better attack  
can be performed with simple &lt;img src&gt; or &lt;a href&gt;.
- If site allows HTML from untrusted source and allows ping to slip  
through, it is very likely that the site can be tricked to allow other  
potentially dangerous attributes or scripts.
- Because not all browsers/proxies/firewalls send Referer header,  
public-facing websites have to accept POSTs without Referer, so forbidding  
Referer for &lt;a ping&gt; may not increase security and even make it harder to  
protect against CSRF.

OTOH Referer can help save bandwidth. Without it page may need to include  
its own URL in every &lt;a ping&gt; attribute. On pages with lots of links  
(portals, directories) this can noticeably increases size of HTML.

Maybe these problems could be solved with an additional HTTP header in the  
ping request? e.g.:

X-Ping: from=&quot;<A HREF="http://example.com/here&quot;,">http://example.com/here&quot;,</A> to=&quot;<A HREF="http://example.com/there&quot;">http://example.com/there&quot;</A>

This would make it easy to protect against unwanted ping-originated  
requests (one could configure server or set up application firewall to  
filter pings), and URL in &lt;a ping&gt; wouldn't have to contain copies of  
page's URL and href.

-- 
regards, Kornel Lesi&#324;ski

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013664.html">[whatwg] Referer header sent with &lt;a ping&gt;?
</A></li>
	<LI>Next message: <A HREF="013797.html">[whatwg] Referer header sent with &lt;a ping&gt;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13695">[ date ]</a>
              <a href="thread.html#13695">[ thread ]</a>
              <a href="subject.html#13695">[ subject ]</a>
              <a href="author.html#13695">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
