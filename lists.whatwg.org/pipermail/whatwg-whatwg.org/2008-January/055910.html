<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Referer header sent with &lt;a ping&gt;?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Referer%20header%20sent%20with%20%3Ca%20ping%3E%3F&In-Reply-To=%3C4796BE40.6050500%40dolphinling.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="055915.html">
   <LINK REL="Next"  HREF="055911.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Referer header sent with &lt;a ping&gt;?</H1>
<!--htdig_noindex-->
    <B>dolphinling</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Referer%20header%20sent%20with%20%3Ca%20ping%3E%3F&In-Reply-To=%3C4796BE40.6050500%40dolphinling.net%3E"
       TITLE="[whatwg] Referer header sent with &lt;a ping&gt;?">lists at dolphinling.net
       </A><BR>
    <I>Tue Jan 22 20:10:40 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="055915.html">[whatwg] &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt;
</A></li>
        <LI>Next message: <A HREF="055911.html">[whatwg] Referer header sent with &lt;a ping&gt;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55910">[ date ]</a>
              <a href="thread.html#55910">[ thread ]</a>
              <a href="subject.html#55910">[ subject ]</a>
              <a href="author.html#55910">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>HTML5 doesn't say anything about whether a referer should be sent with the POST 
generated by &lt;a ping&gt;. There is a new attack vector &lt;a ping&gt; opens (as currently 
being discussed on mozilla.dev.platform) that would be blocked if the referer 
were not sent.

----------
The attack vector relies on the following (not-uncommon) things:

1) There is a site that checks that a request is a POST before doing something 
potentially harmful (note that some sites do this but still respond to query 
parameters in the URL)
2) The server depends on user authentication
3) The server checks the referer before doing something potentially harmful, and 
only allows the action if the referer was from the same server

...And for the attack vector to be *new*, it relies on
4) The server has either an out-of-date blacklist that doesn't block &lt;a ping&gt; or 
a whitelist that explicitly allows &lt;a ping&gt;

(The attack is then obviously &lt;a href=&quot;innocentpage&quot; 
ping=&quot;userdata?dosomething=evil&quot;&gt; posted on a user-editable part of that server).

I have in the past known sites that fit all 4 criteria (now upgraded to use a 
proper whitelist, though), and I'd be surprised if others didn't exist.
----------

Note that there may be other ways of blocking this attack vector, but the 
question here is whether the referer is needed, as it doesn't seem to make any 
new legitimate things possible, and would help in this case (and perhaps 
others--e.g. privacy).

-- 
dolphinling
&lt;<A HREF="http://dolphinling.net/">http://dolphinling.net/</A>&gt;

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="055915.html">[whatwg] &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt;
</A></li>
	<LI>Next message: <A HREF="055911.html">[whatwg] Referer header sent with &lt;a ping&gt;?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#55910">[ date ]</a>
              <a href="thread.html#55910">[ thread ]</a>
              <a href="subject.html#55910">[ subject ]</a>
              <a href="author.html#55910">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
