<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Flow Control on Websockets
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Flow%20Control%20on%20Websockets&In-Reply-To=%3CCAH9hSJbHzVpS_SbUDwj2PjLAngD2iEP1_JPVr1u6iz%3D5m30b_A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="083449.html">
   <LINK REL="Next"  HREF="083467.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Flow Control on Websockets</H1>
<!--htdig_noindex-->
    <B>Takeshi Yoshino</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Flow%20Control%20on%20Websockets&In-Reply-To=%3CCAH9hSJbHzVpS_SbUDwj2PjLAngD2iEP1_JPVr1u6iz%3D5m30b_A%40mail.gmail.com%3E"
       TITLE="[whatwg] Flow Control on Websockets">tyoshino at google.com
       </A><BR>
    <I>Thu Oct 17 23:46:09 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="083449.html">[whatwg] Flow Control on Websockets
</A></li>
        <LI>Next message: <A HREF="083467.html">[whatwg] Flow Control on Websockets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83466">[ date ]</a>
              <a href="thread.html#83466">[ thread ]</a>
              <a href="subject.html#83466">[ subject ]</a>
              <a href="author.html#83466">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Fri, Oct 18, 2013 at 10:36 AM, William Chan (&#38472;&#26234;&#26124;)
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">willchan at chromium.org</A>&gt;wrote:

&gt;<i> &gt; Your second question is whether it's possible to stop the browser
</I>&gt;<i> &gt; reading from the socket. Yes, just don't return from your onmessage
</I>&gt;<i> &gt; handler until you've actually finished handling the message. If you
</I>&gt;<i> &gt; fire up a new worker then tell the browser you're done, you're seeing
</I>&gt;<i> &gt; the inevitable result of that. You have to wait on the worker - or, if
</I>&gt;<i> &gt; you want to process say four messages in parallel, wait on the worker
</I>&gt;<i> &gt; pool until it's dropped below four active before returning.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Pardon the ignorance, but doesn't the onmessage handler run on the main
</I>&gt;<i> thread? If you don't return from it, then doesn't that block the main
</I>&gt;<i> thread? If so, then I think that's a bad solution. Blocking the main thread
</I>&gt;<i> is generally terrible IMO and should be avoided.
</I>&gt;<i>
</I>&gt;<i>
</I>If an app is designed so that main JS thread does actual work (yes, this is
basically bad choice as Willchan said), we could choose to make back
pressure based on buffer consumption (onmessage processing) rate.

If an app is designed to be responsive and such work is done by some other
asynchronous HTML5 API, this method doesn't work.

If such blocking work is done in a worker, this method should work. (FYI,
Chrome (Blink) doesn't have such flow control between network thread and
worker thread yet, so this shouldn't work on Chrome for now).

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="083449.html">[whatwg] Flow Control on Websockets
</A></li>
	<LI>Next message: <A HREF="083467.html">[whatwg] Flow Control on Websockets
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83466">[ date ]</a>
              <a href="thread.html#83466">[ thread ]</a>
              <a href="subject.html#83466">[ subject ]</a>
              <a href="author.html#83466">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
