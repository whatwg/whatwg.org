<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] onclose events for MessagePort
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20onclose%20events%20for%20MessagePort&In-Reply-To=%3C1216650740754482938%40gmail297201516%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="040994.html">
   <LINK REL="Next"  HREF="041028.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] onclose events for MessagePort</H1>
<!--htdig_noindex-->
    <B>David Barrett-Kahn</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20onclose%20events%20for%20MessagePort&In-Reply-To=%3C1216650740754482938%40gmail297201516%3E"
       TITLE="[whatwg] onclose events for MessagePort">dbk at google.com
       </A><BR>
    <I>Thu Oct 10 08:43:47 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="040994.html">[whatwg] onclose events for MessagePort
</A></li>
        <LI>Next message: <A HREF="041028.html">[whatwg] onclose events for MessagePort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41027">[ date ]</a>
              <a href="thread.html#41027">[ thread ]</a>
              <a href="subject.html#41027">[ subject ]</a>
              <a href="author.html#41027">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>This is a feature we've long wanted for Google Docs, but not for the most
obvious reason.  We have a situation where more than one tab can be
visualizing the same document.  Under those conditions, we have a
requirement that one of the documents hold a lock which entitles it to do
things with the locally stored version of the document which other tabs and
workers in the system cannot.  Implementing this locking system is painful
and inefficient.  One of the main reasons is that it's impossible to get a
notification in the shared worker (where the lock 'lives') when the
lock-holding tab has closed.  We would use a message port onclose event for
this, reducing the complexity of our current system (which involves polling
loops and other very undesirable things) tremendously.

Generally speaking it's just a disappointing moment when you discover
message ports don't have this capability and you have to jury rig an
unreliable workaround, like so many times before.  A communications channel
with no 'is connected' status on it is just... not finished.

Why is revealing when garbage collection happens such a terrible thing
anyway?  Java does it...

-Dave

On Wed Oct 09 2013 at 1:11:09 AM, David Levin &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">levin at google.com</A>&gt; wrote:

&gt;<i> On Tue, Oct 1, 2013 at 11:13 AM, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; On 10/1/13 2:11 PM, Ian Hickson wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; How often do we expect two tabs to be talking to each other though?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Or a page to an out-of-process subframe?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; How often do we expect MessageChannel to be used at all?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Speaking as an web developer, I've found MessageChannel to be pretty useful
</I>&gt;<i> when writing a complex web application because it allows you to isolate
</I>&gt;<i> different communication pathways and hop across multiple iframes in a
</I>&gt;<i> single bound (while only knowing about the next step at any one layer... it
</I>&gt;<i> is hard to explain why this is useful without having to dive into the app).
</I>&gt;<i> You can do this all on top of window.postMessage but it is more complicated
</I>&gt;<i> and fragile. (Due to this, I've had to write a a layer above these that
</I>&gt;<i> allows me to use either so that my code can work on browsers that don't
</I>&gt;<i> support MessageChannel but it will be easier to debug on those that do.)
</I>&gt;<i>
</I>&gt;<i> dave
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  Is that even possible on phone browsers?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Sure is in Firefox and FirefoxOS.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  Anyway, I'm happy to support this in principle.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; OK, good.  ;)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -Boris
</I>&gt;<i> &gt;
</I>&gt;<i>
</I></PRE>





















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="040994.html">[whatwg] onclose events for MessagePort
</A></li>
	<LI>Next message: <A HREF="041028.html">[whatwg] onclose events for MessagePort
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41027">[ date ]</a>
              <a href="thread.html#41027">[ thread ]</a>
              <a href="subject.html#41027">[ subject ]</a>
              <a href="author.html#41027">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
