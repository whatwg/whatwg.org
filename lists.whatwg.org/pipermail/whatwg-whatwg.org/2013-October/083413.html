<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Outline style to use for drawSystemFocusRing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Outline%20style%20to%20use%20for%20drawSystemFocusRing&In-Reply-To=%3CCAGN7qDAtt2qWx%2BYkJtSA3LsfQ0ZmKiAjcy3%3D3J4gG8qPCW30Ng%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="083465.html">
   <LINK REL="Next"  HREF="040970.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Outline style to use for drawSystemFocusRing</H1>
<!--htdig_noindex-->
    <B>Rik Cabanier</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Outline%20style%20to%20use%20for%20drawSystemFocusRing&In-Reply-To=%3CCAGN7qDAtt2qWx%2BYkJtSA3LsfQ0ZmKiAjcy3%3D3J4gG8qPCW30Ng%40mail.gmail.com%3E"
       TITLE="[whatwg] Outline style to use for drawSystemFocusRing">cabanier at gmail.com
       </A><BR>
    <I>Wed Oct 16 13:45:08 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="083465.html">[whatwg] Outline style to use for drawSystemFocusRing
</A></li>
        <LI>Next message: <A HREF="040970.html">[whatwg] Upload enhancements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83413">[ date ]</a>
              <a href="thread.html#83413">[ thread ]</a>
              <a href="subject.html#83413">[ subject ]</a>
              <a href="author.html#83413">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Oct 16, 2013 at 12:46 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:

&gt;<i> On Thu, 12 Sep 2013, Dominic Mazzoni wrote:
</I>&gt;<i> &gt; On Wed, Sep 11, 2013 at 5:54 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; On Tue, 10 Sep 2013, Dominic Mazzoni wrote:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; We've finished implementing drawSystemFocusRing and
</I>&gt;<i> &gt; &gt; &gt; drawCustomFocusRing in Chrome. Try it in Chrome 31 or higher (either
</I>&gt;<i> &gt; &gt; &gt; canary or dev channel should work today). You'll need to go to
</I>&gt;<i> &gt; &gt; &gt; <A HREF="chrome://flags">chrome://flags</A> and enable *experimental canvas features*, then
</I>&gt;<i> &gt; &gt; &gt; restart the browser.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Here's a demo I built that uses drawSystemFocusRing:
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://dmazzoni-google.github.io/canvas-focus-ring-demo/">http://dmazzoni-google.github.io/canvas-focus-ring-demo/</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Looks good. Was your conclusion that the spec was ok as is, or did you
</I>&gt;<i> &gt; &gt; deviate from the spec in some way that needs a spec change
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I think drawSystemFocusRing is good to go. If you want, you can update
</I>&gt;<i> &gt; the spec to reflect that an implementation is available (behind a flag).
</I>&gt;<i>
</I>&gt;<i> Anyone can update the spec's annotations, actually -- just
</I>&gt;<i> alt+double-click on the annotation box or the relevant part of the spec,
</I>&gt;<i> and it'll bring up an editor. (You may have to log in first; see the UI at
</I>&gt;<i> the very top right of the spec.)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Only one minor issue for clarification: if the current path is a line or
</I>&gt;<i> &gt; unclosed polygon, should it be closed (or otherwise outlined) when
</I>&gt;<i> &gt; drawing the focus ring? Currently we're not doing so in Chrome, but it
</I>&gt;<i> &gt; might help to clarify. For example, if the path is a line, what's drawn
</I>&gt;<i> &gt; is just an additional stroke on that line, not a &quot;ring&quot;.
</I>&gt;<i>
</I>&gt;<i> Done.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I'm not as sure about drawCustomFocusRing. The spec says &quot;If the user
</I>&gt;<i> &gt; has requested the use of particular focus rings&quot;, but I'm not aware of
</I>&gt;<i> &gt; any platform API we could use to query that.
</I>&gt;<i>
</I>&gt;<i> It may be that on some platforms there is no such API.
</I>&gt;<i>
</I>&gt;<i> WCAG 2.0 claims that &quot;many platforms allow the user to customize the
</I>&gt;<i> rendering of this focus indicator&quot;, though I admit that I don't see any
</I>&gt;<i> references for this claim:
</I>&gt;<i>
</I>&gt;<i>    <A HREF="http://www.w3.org/TR/WCAG-TECHS/G165.html">http://www.w3.org/TR/WCAG-TECHS/G165.html</A>
</I>&gt;<i>
</I>&gt;<i> IBM similarly claims &quot;users may customize the default indicator in Windows
</I>&gt;<i> to a brighter color&quot;:
</I>&gt;<i>
</I>&gt;<i>    <A HREF="http://www-03.ibm.com/able/guidelines/web/webfocusvisible_aa.html#tech3">http://www-03.ibm.com/able/guidelines/web/webfocusvisible_aa.html#tech3</A>
</I>&gt;<i>
</I>&gt;<i> I haven't been able to support those claims. However, Win32 in particular
</I>&gt;<i> has some APIs for changing focus rings (see below for references).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; So, what we implemented in Chrome for drawCustomFocusRing is basically
</I>&gt;<i> &gt; just a function that notifies assistive technology of the bounding rect
</I>&gt;<i> &gt; of the focused region within the canvas. It's still useful, but if
</I>&gt;<i> &gt; that's all it does, then drawCustomFocusRing is a poor name. Perhaps it
</I>&gt;<i> &gt; should be called something like notifyFocusLocation or something like
</I>&gt;<i> &gt; that.
</I>&gt;<i>
</I>&gt;<i> The name isn't ideal, it's true. I don't know what a better name should
</I>&gt;<i> be, though. It's really &quot;let me know if I should draw a focus ring, and if
</I>&gt;<i> I should, then take the opportunity to also notify the accessibility
</I>&gt;<i> tools&quot;, which doesn't make for a very pithy method name.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, 30 Sep 2013, Dominic Mazzoni wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The correct thing to do for those users is to use accessibility APIs to
</I>&gt;<i> &gt; make the operating system aware of the focused object and its bounds. If
</I>&gt;<i> &gt; users have ZoomText or MAGic installed, or if they're using VoiceOver or
</I>&gt;<i> &gt; Orca, their assistive technology will draw its own focus ring *in
</I>&gt;<i> &gt; addition* to the application's focus ring.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; No other application hides its focus ring just because, e.g., ZoomText
</I>&gt;<i> &gt; is drawing a focus ring. The rest of the web doesn't do it. Why do we
</I>&gt;<i> &gt; need it for canvas?
</I>&gt;<i>
</I>&gt;<i> If it's the case that the OS ring can't be customised, and that what
</I>&gt;<i> people refer to when they talk about customised rings is having the ring
</I>&gt;<i> drawn again by ATs, then you're right -- drawCustomFocusRing() would never
</I>&gt;<i> draw anything. However, it's not clear to me that that is the case.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; The problem is that there aren't existing operating system or browser
</I>&gt;<i> &gt; settings that specifies that the user wants better focus rings.
</I>&gt;<i>
</I>&gt;<i> Are we sure? That isn't clear to me. If it was true, why would WCAG 2.0
</I>&gt;<i> say that authors shouldn't fiddle with the focus ring style, for example?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Finally, as a meta-argument, if we really want a preference for custom
</I>&gt;<i> &gt; focus rings, then wouldn't we want that for the rest of the web? If I'm
</I>&gt;<i> &gt; building a custom form control and I need to choose a drawing style when
</I>&gt;<i> &gt; focused, wouldn't I want to know if the user wanted custom focus rings,
</I>&gt;<i> &gt; too? In other words, what makes this need canvas-specific?
</I>&gt;<i>
</I>&gt;<i> It's canvas-specific because in the non-canvas state, the browser already
</I>&gt;<i> does this, in theory. The focus in the non-canvas case is drawn by the
</I>&gt;<i> browser using the :focus rules, which, in principle, are set to the user's
</I>&gt;<i> preferred state.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, 30 Sep 2013, Dominic Mazzoni wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; scrollPathIntoView can't be used to notify accessibility software of the
</I>&gt;<i> &gt; focused object location as-is because it doesn't have an element to fire
</I>&gt;<i> &gt; on, and it doesn't know if the scrolling is because of focus or not.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If we added a canvas fallback element as a parameter to
</I>&gt;<i> &gt; scrollPathIntoView, I don't think we'd need drawCustomFocusRing.
</I>&gt;<i>
</I>&gt;<i> I don't understand how this would work.
</I>&gt;<i>
</I>&gt;<i> Suppose you have a control that is floating around the screen. You need
</I>&gt;<i> the keyboard-focus-driven magnification to follow this control while it's
</I>&gt;<i> focused. You don't want to scroll to that control every time it moves, you
</I>&gt;<i> only want to scroll to it when it's focused.
</I>&gt;<i>
</I>&gt;<i> So what you do is when it's focused, you scrollPathIntoView(), and then
</I>&gt;<i> every 16 milliseconds you move the control and redraw its focus ring, by
</I>&gt;<i> calling drawCustomFocusRing() (or drawSystemFocusRing() if you don't care
</I>&gt;<i> exactly what it looks like), and that updates the AT.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Wed, 2 Oct 2013, Rik Cabanier wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't understand. If the path that is active during
</I>&gt;<i> &gt; drawCustom/SystemFocusRing is off screen and the element is focused, the
</I>&gt;<i> &gt; browser will scroll to that area.
</I>&gt;<i>
</I>&gt;<i> drawCustomFocusRing() and drawSystemFocusRing() shouldn't cause anything
</I>&gt;<i> to scroll. That would be very confusing, IMHO. (When would you scroll?
</I>&gt;<i>
</I>
You would scroll when the hidden element gets focus.


&gt;<i> Consider the case of the control originally being off-screen on purpose,
</I>&gt;<i> and animating into position. You want the focus ring drawn the whole time,
</I>&gt;<i> and the zoom to follow it maybe, but you only want to scroll once, at the
</I>&gt;<i> start, to the location that it will have at the end.)
</I>

Yes, there should only be 1 scroll. Not to the location of the hidden
element (which only exists in the dom) but to the location of the focus
ring.


&gt;<i> On Fri, 4 Oct 2013, Dominic Mazzoni wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What I don't understand is how a browser is supposed to implement the
</I>&gt;<i> &gt; high contrast focus ring support on a real operating system that exists
</I>&gt;<i> &gt; today. Are there other apps that do this? Are there published guidelines
</I>&gt;<i> &gt; anywhere?
</I>&gt;<i>
</I>&gt;<i> It would appear that on Win32, the SystemParametersInfo function has
</I>&gt;<i> SPI_GETFOCUSBORDERHEIGHT, SPI_GETFOCUSBORDERWIDTH, and SPI_GETHIGHCONTRAST
</I>&gt;<i> options that may be relevant here.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Windows has a system setting for high-contrast mode. When you turn on
</I>&gt;<i> &gt; high contrast mode, it changes the default color palette. There's no
</I>&gt;<i> &gt; other effect on the focus ring that I know of.
</I>&gt;<i>
</I>&gt;<i> This may be the high contrast theme, which is distinct from high contrast
</I>&gt;<i> mode, according to the Remarks section here:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724947(v=vs.85">http://msdn.microsoft.com/en-us/library/windows/desktop/ms724947(v=vs.85</A>).aspx
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Windows also has settings for the focus ring width. I agree those should
</I>&gt;<i> &gt; affect the system focus ring, but I don't think users would expect that
</I>&gt;<i> &gt; to override a canvas author's focus ring.
</I>&gt;<i>
</I>&gt;<i> Why not? If they've set their ring to be unusually wide, why wouldn't they
</I>&gt;<i> want this to apply to canvas apps as well?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; High contrast mode may affect the system focus ring color, it's true -
</I>&gt;<i> &gt; but there's no reason to believe that this system focus ring would look
</I>&gt;<i> &gt; better on a canvas when high contrast mode is on, and in fact it might
</I>&gt;<i> &gt; look much worse.
</I>&gt;<i>
</I>&gt;<i> But presumably if you're in high-contrast mode, you might want to render a
</I>&gt;<i> more contrasty focus ring, even if it's not the system one.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Or, here's another argument: a canvas can contain absolutely anything.
</I>&gt;<i> &gt; It might contain a wild and crazy color palette. Only the canvas author
</I>&gt;<i> &gt; knows what focus ring is going to be visible on top of that canvas. If
</I>&gt;<i> &gt; the canvas is white text on a black background, then a dark-colored
</I>&gt;<i> &gt; focus ring is going to be practically invisible, and vice versa.
</I>&gt;<i>
</I>&gt;<i> Cursors solve this problem by having a white border around a black border
</I>&gt;<i> around a white arrow (or vice versa). I could see a high-contrast focus
</I>&gt;<i> ring being done in a similar fashion.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; It just doesn't make any sense to me that we're providing an API that
</I>&gt;<i> &gt; says, if you want to draw your own focus ring, use this - BUT, under
</I>&gt;<i> &gt; some circumstances we're going to tell you not to draw it and the
</I>&gt;<i> &gt; browser or operating system is going to draw it for you, even though the
</I>&gt;<i> &gt; browser has no idea what colors are on your canvas and what type of
</I>&gt;<i> &gt; focus ring would be visible against it.
</I>&gt;<i>
</I>&gt;<i> Well, the browser can know what the colours are, and can draw rings that
</I>&gt;<i> are colour-agnostic. But sure.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; If the author wants to draw their own focus ring, it's probably for a
</I>&gt;<i> &gt; good reason. We should let them.
</I>&gt;<i>
</I>&gt;<i> Well we're never stopping them, are we? I mean, they can always do what
</I>&gt;<i> they want...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I think if the user asked for a particular kind of focus ring, we should
</I>&gt;<i> probably honour that. But if there's no real way to implement that, then
</I>&gt;<i> drawCustomFocusRing() could indeed just never draw.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ian Hickson               U+1047E                )\._.,--....,'``.    fL
</I>&gt;<i> <A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
</I>&gt;<i> Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="083465.html">[whatwg] Outline style to use for drawSystemFocusRing
</A></li>
	<LI>Next message: <A HREF="040970.html">[whatwg] Upload enhancements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83413">[ date ]</a>
              <a href="thread.html#83413">[ thread ]</a>
              <a href="subject.html#83413">[ subject ]</a>
              <a href="author.html#83413">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
