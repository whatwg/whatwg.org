<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Content type sniffing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Content%20type%20sniffing&In-Reply-To=%3C7789133a0901120912jda5a8bfp9dd1447f38bcf8c%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018155.html">
   <LINK REL="Next"  HREF="018153.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Content type sniffing</H1>
<!--htdig_noindex-->
    <B>Adam Barth</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Content%20type%20sniffing&In-Reply-To=%3C7789133a0901120912jda5a8bfp9dd1447f38bcf8c%40mail.gmail.com%3E"
       TITLE="[whatwg] Content type sniffing">whatwg at adambarth.com
       </A><BR>
    <I>Mon Jan 12 09:12:31 PST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="018155.html">[whatwg] Content type sniffing
</A></li>
        <LI>Next message: <A HREF="018153.html">[whatwg] getElementsByClassName case sensitivity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18156">[ date ]</a>
              <a href="thread.html#18156">[ thread ]</a>
              <a href="subject.html#18156">[ subject ]</a>
              <a href="author.html#18156">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Jan 12, 2009 at 7:54 AM, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:
&gt;<i> I'm not quite sure what to make of this, actually.  Specifically, where is
</I>&gt;<i> the &quot;22.19%&quot; number for &quot;HTML Tags&quot; coming from?  22.19% of what? The magic
</I>&gt;<i> numbers stuff actually adds up to 100%, but of what?
</I>
Sorry, the % was confusing.  I've removed them.  These table are the
relative frequency with which those rules fire in the content sniffer.
 Probably should have scaled them all to be out of 100 or out of 1,
but it was more convenient to scale them out of the totals that I did.

&gt;&gt;<i> I'm sympathetic to adding more HTML tags to the list, but I'm not sure
</I>&gt;&gt;<i> how far down the tail we should go.  In Chrome, we went for 99.999%
</I>&gt;&gt;<i> compatibility, which might be a bit far down the tail.
</I>&gt;<i>
</I>&gt;<i> Doesn't seem that way to me, given the number of web pages out there.
</I>
I don't think it makes sense to compare that percentage to the number
of web pages.  Instead, imagine a user who views 100 pages a day.
That user will, in a crude &quot;average&quot; sense, come across a broken web
page once every three years.

&gt;&gt;<i> <A HREF="http://src.chromium.org/viewvc/chrome/trunk/src/net/base/mime_sniffer.cc?view=markup">http://src.chromium.org/viewvc/chrome/trunk/src/net/base/mime_sniffer.cc?view=markup</A>
</I>&gt;<i>
</I>&gt;<i> Ah, ok.  The relevant Gecko code is
</I>&gt;<i> &lt;<A HREF="http://hg.mozilla.org/mozilla-central/annotate/9f82199fdb9c/netwerk/streamconv/converters/nsUnknownDecoder.cpp#l477">http://hg.mozilla.org/mozilla-central/annotate/9f82199fdb9c/netwerk/streamconv/converters/nsUnknownDecoder.cpp#l477</A>&gt;.
</I>
Yes, I've examined that code in detail.  :)  Here is a web page that
will let you compare the sniffing algorithms used by four popular
browsers:

<A HREF="http://webblaze.cs.berkeley.edu/2009/content-sniffing/">http://webblaze.cs.berkeley.edu/2009/content-sniffing/</A>

&gt;<i> I'd probably be fine with trimming that list down a bit, but I'm not quite
</I>&gt;<i> sure what the downsides of having more tags in it are here.
</I>
Most of the cost is complexity (which leads to security
vulnerabilities).  People who let users upload content and who build
firewalls that filter content at the application layer (for example,
to look for malware) need to understand browser content sniffing
algorithms in order to build secure products.  There is a huge
complexity win for standardizing the algorithm across multiple
implementations, and there is a small complexity loss for each
sniffing heuristic we add.

One plan for going forward is to resolve
<A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=465007">https://bugzilla.mozilla.org/show_bug.cgi?id=465007</A> and then open
another bug for harmonizing the HTML heuristic (with the expectation
that harmonization will probably involve changing both the spec and
the implementation).

Adam

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018155.html">[whatwg] Content type sniffing
</A></li>
	<LI>Next message: <A HREF="018153.html">[whatwg] getElementsByClassName case sensitivity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18156">[ date ]</a>
              <a href="thread.html#18156">[ thread ]</a>
              <a href="subject.html#18156">[ subject ]</a>
              <a href="author.html#18156">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
