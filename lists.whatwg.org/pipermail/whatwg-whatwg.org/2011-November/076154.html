<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Size of SVG-&gt;Img-&gt;Canvas
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Size%20of%20SVG-%3EImg-%3ECanvas&In-Reply-To=%3C01804B6F1D74DE41819D69F2866C60EF512A5491EE%40HQMAIL03.nvidia.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033878.html">
   <LINK REL="Next"  HREF="076157.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Size of SVG-&gt;Img-&gt;Canvas</H1>
<!--htdig_noindex-->
    <B>Gavin Kistner</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Size%20of%20SVG-%3EImg-%3ECanvas&In-Reply-To=%3C01804B6F1D74DE41819D69F2866C60EF512A5491EE%40HQMAIL03.nvidia.com%3E"
       TITLE="[whatwg] Size of SVG-&gt;Img-&gt;Canvas">gkistner at nvidia.com
       </A><BR>
    <I>Thu Nov 17 15:14:05 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="033878.html">[whatwg] Size of SVG-&gt;Img-&gt;Canvas
</A></li>
        <LI>Next message: <A HREF="076157.html">[whatwg] Size of SVG-&gt;Img-&gt;Canvas
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#76154">[ date ]</a>
              <a href="thread.html#76154">[ thread ]</a>
              <a href="subject.html#76154">[ subject ]</a>
              <a href="author.html#76154">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Imagine an SVG file displayed in an img: &lt;img id=&quot;i&quot; src=&quot;my.svg&quot; ... &gt;

The SVG file can have an explicit size (height and width attributes, in a variety of CSS units), or it can have no size (defaulting to &quot;100%&quot;). Whether or not the SVG file has explicit units, it may have an intrinsic aspect ratio (via the viewBox attribute).

The img can have an explicit size (height and width attributes) or no size. Separate from these, it may or may not have a separate display size (CSS units).

Now imagine that the user draws this img to a canvas:

    myCanvasContext.drawImage( document.querySelector('#i'), 0, 0 );

In each of the eight combinations of (img heightwidth/CSS heightwidth/SVG heightwidth) being present or not, what are the intrinsic dimensions of the &quot;image&quot; drawn to the canvas?
(Should it always use the raster bitmap created for the img? Should it re-rasterize the sourced SVG at the specified height/width?)

I have a test page showing current behavior here: <A HREF="http://phrogz.net/SVG/svg_to_img_to_canvas.html">http://phrogz.net/SVG/svg_to_img_to_canvas.html</A>

Note: Firefox has bug 700533 that currently prevents it from drawing the image to the canvas when the SVG has no height/width.
<A HREF="https://bugzilla.mozilla.org/show_bug.cgi?id=700533">https://bugzilla.mozilla.org/show_bug.cgi?id=700533</A>

Note: Chrome v16 on Win7 produces non-deterministic results when the SVG has no height/width; each reload can result in different appearance of the SVG-in-img. This may be bug 16167.
<A HREF="https://bugs.webkit.org/show_bug.cgi?id=16167">https://bugs.webkit.org/show_bug.cgi?id=16167</A>

Add one followup: what if you draw the image to the canvas at a 'large' resolution, drawImage(img,0,0,200,200)?

Presumably this shouldn't change what source pixels are used for `drawImage`. However, I've added this test to my URL above and we see that Chrome has perfectly anti-aliashed circles in all cases, where Firefox is visibly upscaling a lower-resolution bitmap.
-----------------------------------------------------------------------------------
This email message is for the sole use of the intended recipient(s) and may contain
confidential information.  Any unauthorized review, use, disclosure or distribution
is prohibited.  If you are not the intended recipient, please contact the sender by
reply email and destroy all copies of the original message.
-----------------------------------------------------------------------------------

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033878.html">[whatwg] Size of SVG-&gt;Img-&gt;Canvas
</A></li>
	<LI>Next message: <A HREF="076157.html">[whatwg] Size of SVG-&gt;Img-&gt;Canvas
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#76154">[ date ]</a>
              <a href="thread.html#76154">[ thread ]</a>
              <a href="subject.html#76154">[ subject ]</a>
              <a href="author.html#76154">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
