<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] should we add beforeload/afterload events to the web	platform?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20should%20we%20add%20beforeload/afterload%20events%20to%20the%20web%0A%09platform%3F&In-Reply-To=%3CCAJQvAuc8BmMDcBCiJfyD5ErMvQCmUgQsm3-fv3kVQ62hsXcASA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="076648.html">
   <LINK REL="Next"  HREF="034315.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] should we add beforeload/afterload events to the web	platform?</H1>
<!--htdig_noindex-->
    <B>Henri Sivonen</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20should%20we%20add%20beforeload/afterload%20events%20to%20the%20web%0A%09platform%3F&In-Reply-To=%3CCAJQvAuc8BmMDcBCiJfyD5ErMvQCmUgQsm3-fv3kVQ62hsXcASA%40mail.gmail.com%3E"
       TITLE="[whatwg] should we add beforeload/afterload events to the web	platform?">hsivonen at iki.fi
       </A><BR>
    <I>Fri Jan 13 03:12:30 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="076648.html">[whatwg] should we add beforeload/afterload events to the web platform?
</A></li>
        <LI>Next message: <A HREF="034315.html">[whatwg] &lt;di&gt;? Please?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#76646">[ date ]</a>
              <a href="thread.html#76646">[ thread ]</a>
              <a href="subject.html#76646">[ subject ]</a>
              <a href="author.html#76646">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Fri, Jan 13, 2012 at 4:23 AM, Roman Rudenko &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">roman at mobify.com</A>&gt; wrote:
&gt;<i> This might not work as nicely in Firefox, which, according to Boris,
</I>&gt;<i> does not maintain separation between main and speculative parser.
</I>
Firefox doesn't support preventing HTTP GETs when the page
imperatively rewrites its declarative parts. In principle, Firefox may
preload all declarative resources that a page points to before any
script on the page gets a chance to run. Declarative language allows
browsers to optimize stuff for the whole Web. I think we shouldn't
pessimize any of those optimizations for the whole Web in order to
cater to the tiny, tiny part of the Web that wants to rewrite
declarative HTML on the client side in the name of responsive design.

If you don't want browsers to initiate HTTP GETs for scripts, images,
video poster frames, style sheets, etc. (maybe in the future
iframes!), don't put the URLs of those things into the HTML source you
send to the browser in the first place. That is, if you don't want the
browser to fetch foo.jpg, don't say &lt;img src=&quot;foo.jpg&quot;&gt; in the source
you send to the browser. If you need a placeholder, use &lt;img
data-transformable-src=&quot;foo.jpg&quot;&gt;.

Note that if you do
&lt;script&gt;document.write(&quot;&lt;plaintext
style='display:none;'&gt;&quot;);&lt;/script&gt;&lt;img src=&quot;foo.jpg&quot;&gt;
Firefox will still most likely start fetching foo.jpg (by design).

That said, please do include the images, etc., you want fetched in the
source. If you do want foo.jpg fetched, saying &lt;img src=&quot;foo.jpg&quot;&gt; in
the HTML source is a latency win over letting a script cause the
fetch.

To the extent the problem is that you don't know what you want fetched
before probing the client characteristics, I think adding JS APIs is
not the right solution. The right solutions are:
 1) If cruft is optional, don't give the cruft to anyone. If there's a
bunch of inessential scripts that you don't want mobile browsers to
load, don't give them do desktop browsers, either.
 2) Making the client probing declarative. If there is a true, broad
and persistent (longer than, say, 2 years) need to load different
images based on client characteristics, we should introduce a
declarative way to pick the desired image. Something along the lines
of
&lt;picture&gt;
&lt;source condition=&quot;that the browser can evaluate without JS&quot; src=&quot;img1.jpg&quot;&gt;
&lt;source condition=&quot;that the browser can evaluate without JS&quot; src=&quot;img2.jpg&quot;&gt;
&lt;img src=&quot;img3.jpg&quot;&gt;
&lt;/picture&gt;

-- 
Henri Sivonen
<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">hsivonen at iki.fi</A>
<A HREF="http://hsivonen.iki.fi/">http://hsivonen.iki.fi/</A>

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="076648.html">[whatwg] should we add beforeload/afterload events to the web platform?
</A></li>
	<LI>Next message: <A HREF="034315.html">[whatwg] &lt;di&gt;? Please?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#76646">[ date ]</a>
              <a href="thread.html#76646">[ thread ]</a>
              <a href="subject.html#76646">[ subject ]</a>
              <a href="author.html#76646">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
