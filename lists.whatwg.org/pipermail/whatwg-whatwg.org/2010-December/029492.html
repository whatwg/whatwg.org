<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg]  HTMLCanvasElement.toFile()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%20HTMLCanvasElement.toFile%28%29&In-Reply-To=%3CAANLkTin%3DbBqKTcE1%2BnLgrdeFDCbV8jZ%2BUeGvMHUS4kSz%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="071769.html">
   <LINK REL="Next"  HREF="029503.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg]  HTMLCanvasElement.toFile()</H1>
<!--htdig_noindex-->
    <B>Glenn Maynard</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%20HTMLCanvasElement.toFile%28%29&In-Reply-To=%3CAANLkTin%3DbBqKTcE1%2BnLgrdeFDCbV8jZ%2BUeGvMHUS4kSz%40mail.gmail.com%3E"
       TITLE="[whatwg]  HTMLCanvasElement.toFile()">glenn at zewt.org
       </A><BR>
    <I>Sat Dec 18 17:39:10 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="071769.html">[whatwg] Handling unknown 'duration's
</A></li>
        <LI>Next message: <A HREF="029503.html">[whatwg] Application Cache for on-line sites
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29492">[ date ]</a>
              <a href="thread.html#29492">[ thread ]</a>
              <a href="subject.html#29492">[ subject ]</a>
              <a href="author.html#29492">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Replying to an old message; sorry if this has been covered since then.

<A HREF="http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2010-January/024691.html:">http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2010-January/024691.html:</A>
&gt;&gt;<i> I suggest we add a function like:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> File toFile(in DOMString name, in optional DOMString type, in any...
</I>&gt;&gt;<i> args);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This function takes the same arguments as toDataURL(), plus an
</I>&gt;&gt;<i> additional 'name' argument.
</I>&gt;<i>
</I>&gt;<i> The File should stick to representing files. After all, you would not make a File object to
</I>&gt;<i> convert something to text for uploading. Nor would it make sense to do
</I>&gt;<i> an asynchronous read from this. And under the covers, you would want
</I>&gt;<i> to pass the actual binary data to the upload code, not a file with a
</I>&gt;<i> file name.
</I>
It does make a lot of sense to do asynchronous reads from file data
generated from a canvas.

For a larger canvas, generating a PNG can take some time.  By making a
copy (or COW) of the canvas, reading PNG data from it can be done
asynchronously.  This would keep the whole page from halting for half
a second (or more; PNG can be expensive at higher compression levels)
while the data is generated.

For example, this would be very important if an image editor is
backing up the user's work in the background, as Gmail does with
message text.  If the user is drawing on the canvas, having the UI
hitch for 500ms (or even 100ms) would be disruptive.

The hard part is that you can't have a Blob whose size isn't known in
advance, so this would probably need a separate class, making it a
much larger undertaking.  (The same would be needed for things like
deflating/inflating data: can't slice it and don't know the final
size.)  But, the async reads and compression themselves do make a lot
of sense.

-- 
Glenn Maynard
</PRE>







































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="071769.html">[whatwg] Handling unknown 'duration's
</A></li>
	<LI>Next message: <A HREF="029503.html">[whatwg] Application Cache for on-line sites
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#29492">[ date ]</a>
              <a href="thread.html#29492">[ thread ]</a>
              <a href="subject.html#29492">[ subject ]</a>
              <a href="author.html#29492">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
