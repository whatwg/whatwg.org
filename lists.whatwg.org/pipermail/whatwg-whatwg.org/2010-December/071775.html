<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal for a tab visibility API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20a%20tab%20visibility%20API&In-Reply-To=%3CAANLkTinqicMkj8ke%3DdCCKiGWjVwgBKLayMNjGb4kUyzd%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="071779.html">
   <LINK REL="Next"  HREF="071778.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal for a tab visibility API</H1>
<!--htdig_noindex-->
    <B>Bjartur Thorlacius</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20a%20tab%20visibility%20API&In-Reply-To=%3CAANLkTinqicMkj8ke%3DdCCKiGWjVwgBKLayMNjGb4kUyzd%40mail.gmail.com%3E"
       TITLE="[whatwg] Proposal for a tab visibility API">svartman95 at gmail.com
       </A><BR>
    <I>Mon Dec 20 12:56:20 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="071779.html">[whatwg] Proposal for a tab visibility API
</A></li>
        <LI>Next message: <A HREF="071778.html">[whatwg] Proposal for a tab visibility API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71775">[ date ]</a>
              <a href="thread.html#71775">[ thread ]</a>
              <a href="subject.html#71775">[ subject ]</a>
              <a href="author.html#71775">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 12/20/10, Alex Komoroske &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">komoroske at chromium.org</A>&gt; wrote:
&gt;<i> Thanks for your comments.  I've replied inline.
</I>&gt;<i>
</I>&gt;<i> On Sun, Dec 19, 2010 at 8:11 PM, Bjartur Thorlacius
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">svartman95 at gmail.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Wed, 15 Dec 2010 19:27:51 -0000, Alex Komoroske
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">komoroske at chromium.org</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Regarding the fact that background tabs aren't necessarily invisible:
</I>&gt;&gt;&gt;<i> -----
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>  On December 8, Boris Zbarsky wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> There is no such guarantee for background tabs.  For example, browsers
</I>&gt;&gt;&gt;<i> may
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> show tab previews in various contexts (Panorama in Firefox 4, e.g.).
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -----
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The point of the API, as proposed, is that page scripts will know when
</I>&gt;&gt;&gt;<i> their
</I>&gt;&gt;&gt;<i> content is guaranteed to be invisible to the user--that is, the API will
</I>&gt;&gt;&gt;<i> not
</I>&gt;&gt;&gt;<i> provide a false positive about invisibility.  However, the API may
</I>&gt;&gt;&gt;<i> provide
</I>&gt;&gt;&gt;<i> false negatives about invisibility, for reasons many others on this
</I>&gt;&gt;&gt;<i> thread
</I>&gt;&gt;&gt;<i> have been pointed out (including different windowing systems, multiple
</I>&gt;&gt;&gt;<i> monitors, partial transparency, etc.).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The easiest way to achieve this guarantee is to only consider a tab
</I>&gt;&gt;&gt;<i> hidden
</I>&gt;&gt;&gt;<i> when it is a background tab within* *a window.  The window itself, of
</I>&gt;&gt;&gt;<i> course, may be on a little-noticed second monitor, partially obscured,
</I>&gt;&gt;&gt;<i> etc.
</I>The obvious way to achieve this is to only consider a tab/window hidden when
it's not on-screen, and consider it visible when it's on-screen. What good is
being the current tab when the window is off-screen?


&gt;&gt;<i> I don&#180;t see how that information is useful.  Now, you have to define
</I>&gt;&gt;<i> 'window'
</I>&gt;&gt;<i> and 'tab' differently and define a background state of the latter. Do
</I>&gt;&gt;<i> multiple
</I>&gt;&gt;<i> non-backgrounded (attached) tabs in a window need special treatment? If
</I>&gt;&gt;<i> you use the term 'tab' anywhere it _will_ be confused with the UI
</I>&gt;&gt;<i> metaphor,
</I>&gt;&gt;<i> causing confusion with the approach to hierarchical window management.
</I>&gt;&gt;<i> I don't understand what the term 'tab' means to you. To me a tab is a
</I>&gt;&gt;<i> window.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm not sure that I understand the point of confusion.  When I say 'tab', I
</I>&gt;<i> mean the current UI construct implemented in Firefox, Safari, Chrome, Opera,
</I>&gt;<i> Internet Explorer, and others.  Each window can have one or more tabs, and
</I>&gt;<i> in curent implementations (with very few exceptions), each window can only
</I>&gt;<i> have a single visible tab.
</I>&gt;<i>
</I>In context of many of the less-widely used browsers the word 'tab' is
never used.
Each top-level browsing context has an associated window, which may be
grouped with other windows and that group may be represented as a tab strip,
wherefrom windows may be selected. They may also be tiled, and a tab strip
which allows multiple windows to be selected (tabbed desktops), causing them
to tile. How does your proposal work wrt tagged windows (as used in wmii, dwm)?

I don't understand an UI construct used by WMs is of any interest to
applications.
AFAIK, X11 only notifies clients about changing visibility, and by extension,
partial overlaps. Why would apps rather know whether they're selected in a tab
strip (creating an unnecessary requirement for tab strips) than whether they're
visible? With the aforementioned WMs (wmii, dwm) windows may be in multiple
groups (tags). In wmii, windows are managed hierarchically. This isn't of any
concern to anyone but the user. Applications shouldn't care at all.
They're given a
resizing window of variable visibility to draw on; tabs don't matter.

&gt;<i> I'm not sure that I have seen your counterproposal.  Based on your comments
</I>&gt;<i> in this thread, I presume that it includes an ability for pages to declare
</I>&gt;<i> what capabilities they require (e.g. an animation requires that it be
</I>&gt;<i> visible) and then the browser automatically pauses scripts when those
</I>&gt;<i> required conditions are not met.  Is that a proper understanding of your
</I>&gt;<i> counterproposal?  Is there a more comprehensive/detailed version of the
</I>&gt;<i> proposal that I could read and comment on?
</I>&gt;<i>
</I>Yes, your understanding is correct, and no, there is none.


&gt;&gt;&gt;<i>  On December 8th, Maciej Stachowiak wrote:
</I>&gt;&gt;&gt;&gt;<i> This use case can be handled without help from the page. In Safari,
</I>&gt;&gt;&gt;&gt;<i> video
</I>&gt;&gt;&gt;&gt;<i> (whether through media elements or plugins) won't start playing when a
</I>&gt;&gt;&gt;&gt;<i> user
</I>&gt;&gt;&gt;&gt;<i> opens a tab in the background, until the user switches to that tab.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -----
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Although what you describe satisfies the specific use case, it doesn't
</I>&gt;&gt;&gt;<i> address the more general use case of animations (either explicit via
</I>&gt;&gt;&gt;<i> javascript or via CSS Animations) or content that is not a plugin/video
</I>&gt;&gt;&gt;<i> file.
</I>&gt;&gt;&gt;<i>
</I>Modularity is good.

&gt;&gt;&gt;<i>  I argue that there are two potentially viable solutions: Implementations
</I>&gt;&gt;<i> exploiting more methods &#225; la Safari, stopping animations or apps declaring
</I>&gt;&gt;<i> dependencies on various things like visibility and audibility. There are
</I>&gt;&gt;<i> previous proposals regarding throwing CSS media events upon change, which
</I>&gt;&gt;<i> could potentially be integrated with this.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The whole things smells of over-engineering. A resource of MIME media type
</I>&gt;&gt;<i> &quot;audio&quot; obviously can't be rendered without audibility, &quot;image&quot; resources
</I>&gt;&gt;<i> sans (2D) visibility nor &quot;model&quot; resources sans 3D visibility. &quot;Text&quot;
</I>&gt;&gt;<i> resources can be rendered both visually and aurally, and &quot;model&quot;s can also
</I>&gt;&gt;<i> be rendered to 2D displays, as long they're interactive (they're
</I>&gt;&gt;<i> redrawable
</I>&gt;&gt;<i> and user input is accessible).
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Although I agree that in some limited cases the correct behavior is clear,
</I>&gt;<i> in practice there is a lot of gray area for many common cases.  A multi-user
</I>&gt;<i> collaborative puzzle should continue executing even when in the background
</I>&gt;<i> (perhaps another player made a move that should play a sound to alert this
</I>&gt;<i> user of the new move); a single-player puzzle might not need to execute at
</I>&gt;<i> all when backgrounded.  The more complex the web app, the more likely that
</I>&gt;<i> the precise needs for pausing can't be met precisely with simple &quot;semantic&quot;
</I>&gt;<i> directives to the browser.
</I>&gt;<i>
</I>A multiplayer puzzle needs either focus and visibility (and'll use a network
connection when available) or a network connection and a notification
mechanism. The developer will be aware of what interfaces the app utilizes, and
declaring dependencies on interfaces he might otherwise take for granted might,
as a surplus, prompt him to think about accessibility issues that may rise when
the interfaces can't be used.

&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Regarding solving the use cases that cannot be addressed currently:
</I>&gt;&gt;&gt;<i> ------
</I>&gt;&gt;&gt;<i> On December 8th, Maciej Stachowiak wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> That leaves the following use cases:
</I>&gt;&gt;&gt;<i> * A puzzle game has a timer that keeps track of how long the user has
</I>&gt;&gt;&gt;<i> taken
</I>&gt;&gt;&gt;<i> to solve the puzzle.  It wants to pause the timer when the user has
</I>&gt;&gt;&gt;<i> hidden
</I>&gt;&gt;&gt;<i> the tab.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> The counter is paused while the script's suspended, wall-clock keeps
</I>&gt;&gt;<i> going.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  * A web app that uses polling to fetch dynamic content can pause polling
</I>&gt;&gt;&gt;<i> when it knows the page is hidden from the user.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> A suspended script can't phone home.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  * A page wants to detect when it is being prerendered so it can behave
</I>&gt;&gt;&gt;<i> appropriately.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> The only use case for this I can see is confusing users. That's probably
</I>&gt;&gt;<i> just me.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm not sure that I understand this point.  Given the existence of a
</I>&gt;<i> pre-rendering feature, how would providing information to the page about
</I>&gt;<i> whether it is being pre-rendered lead to confusion of users?
</I>&gt;<i>
</I>My misunderstanding. It cannot cause user-confusion. Ignore.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="071779.html">[whatwg] Proposal for a tab visibility API
</A></li>
	<LI>Next message: <A HREF="071778.html">[whatwg] Proposal for a tab visibility API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71775">[ date ]</a>
              <a href="thread.html#71775">[ thread ]</a>
              <a href="subject.html#71775">[ subject ]</a>
              <a href="author.html#71775">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
