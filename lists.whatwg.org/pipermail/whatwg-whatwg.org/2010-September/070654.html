<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Video with MIME type application/octet-stream
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Video%20with%20MIME%20type%20application/octet-stream&In-Reply-To=%3C4C859BE6.9080903%40mit.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="070655.html">
   <LINK REL="Next"  HREF="070656.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Video with MIME type application/octet-stream</H1>
<!--htdig_noindex-->
    <B>Boris Zbarsky</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Video%20with%20MIME%20type%20application/octet-stream&In-Reply-To=%3C4C859BE6.9080903%40mit.edu%3E"
       TITLE="[whatwg] Video with MIME type application/octet-stream">bzbarsky at MIT.EDU
       </A><BR>
    <I>Mon Sep  6 18:56:54 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="070655.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
        <LI>Next message: <A HREF="070656.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70654">[ date ]</a>
              <a href="thread.html#70654">[ thread ]</a>
              <a href="subject.html#70654">[ subject ]</a>
              <a href="author.html#70654">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 9/6/10 3:19 PM, Aryeh Gregor wrote:
&gt;<i> On Mon, Sep 6, 2010 at 4:14 AM, Philip J&#228;genstedt&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>&gt;  wrote:
</I>&gt;&gt;<i> The Ogg page begins with the 4 bytes &quot;OggS&quot;, which is what Opera (GStreamer)
</I>&gt;&gt;<i> checks for. For additional safety, one could also check for the trailing
</I>&gt;&gt;<i> version indicator, which ought to be a NULL byte for current Ogg. [1] [2]
</I>&gt;<i>
</I>&gt;<i> &quot;OggS\0&quot; as the first five bytes seems safe to check for.  It's rather
</I>&gt;<i> short, I guess because it's repeated on every page, but five bytes is
</I>&gt;<i> long enough that it should occur by random only negligibly often, in
</I>&gt;<i> either text or binary files.
</I>
So if a text file starts with U+4F67 U+6753 (both CJK ideographs) and 
any ASCII character (can this happen in the real world?) you're OK with 
treating it as Ogg?  Same for files staring with U+674F U+5367 (both CJK 
ideographs) and any plane-0 character whose Unicode codepoint is 0 mod 
2^16 (plenty of CJK stuff like that)?  Is your CJK good enough that you 
know text files would never start like this, or are you just assuming 
that people who are silly enough to use UTF-16 for their text files and 
aren't in Europe don't matter?  Or that you don't care about people who 
happen to not use a BOM?

&gt;<i> It looks like you could check for 0x1a 0x45 0xdf 0xa3 as the first
</I>&gt;<i> four bytes
</I>
U+1A45 is Thai, looks like.  DFA3 is a surrogate, so you're ok there.

U+451A is CJK.  U+A3DF looks like a Yi syllable, so you're more or less 
ok there too.  I'm assuming you've already checked this byte sequence 
out in UTF-8 and some other common encodings?

-Boris

P.S.  Sniffing is harder that you seem to think.  It really is...

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="070655.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
	<LI>Next message: <A HREF="070656.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70654">[ date ]</a>
              <a href="thread.html#70654">[ thread ]</a>
              <a href="subject.html#70654">[ subject ]</a>
              <a href="author.html#70654">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
