<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Video with MIME type application/octet-stream
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Video%20with%20MIME%20type%20application/octet-stream&In-Reply-To=%3CAANLkTimHHvcxVN2uF%2BL_CV793ZWVgXj45GaZ2s4-oVNc%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="070670.html">
   <LINK REL="Next"  HREF="070675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Video with MIME type application/octet-stream</H1>
<!--htdig_noindex-->
    <B>Aryeh Gregor</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Video%20with%20MIME%20type%20application/octet-stream&In-Reply-To=%3CAANLkTimHHvcxVN2uF%2BL_CV793ZWVgXj45GaZ2s4-oVNc%40mail.gmail.com%3E"
       TITLE="[whatwg] Video with MIME type application/octet-stream">Simetrical+w3c at gmail.com
       </A><BR>
    <I>Tue Sep  7 12:29:00 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="070670.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
        <LI>Next message: <A HREF="070675.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70674">[ date ]</a>
              <a href="thread.html#70674">[ thread ]</a>
              <a href="subject.html#70674">[ subject ]</a>
              <a href="author.html#70674">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, Sep 7, 2010 at 5:51 AM, And Clover &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">and-py at doxdesk.com</A>&gt; wrote:
&gt;<i> Quite. It surprises and saddens me that anyone wants to argue for *more*
</I>&gt;<i> sniffing, and even enshrining it in a web standard.
</I>
I'm not a fan of sniffing, but I'm also not a fan of blindly believing
clearly wrong MIME types and thereby forcing authors to do needless
configuration work, which they might not even be able to do.  I'm not
yet sure what the correct tradeoff is here, but I'm pretty sure it's
not &quot;no sniffing at all under any conditions&quot;.

&gt;<i> Sniffing is a perpetual disaster that, after several security-sensitive
</I>&gt;<i> problems, web browsers have been moving to deprecate/mitigate. If browsers
</I>&gt;<i> want to guess types when no Content-Type is specified(*) then fine, but
</I>&gt;<i> there is no good reason to ignore an explicitly-set type. I don't want my
</I>&gt;<i> `application/octet-stream` file download service to be repurposeable as a
</I>&gt;<i> video player for some other party!
</I>
If you don't want that, you should be using access control, not MIME types.

&gt;<i> For reasons already argued about here, you will never make the results of
</I>&gt;<i> content-sniffing reliable, so why bother to standardise it? A standardised
</I>&gt;<i> unreliable feature is no better than an unstandardised one.
</I>
Sure it is, because it's unreliable in the same way across all
browsers.  That means that in any given case, all browsers will work
the same.  This is particularly essential for security -- undocumented
sniffing behavior has caused more than one vulnerability in the past.

&gt;<i> The typing mechanism of the web (and more) is Content-Type, period. There
</I>&gt;<i> should be no confusion of this with officially-endorsed sniffing.
</I>
We already have officially endorsed sniffing where web compat requires it:

<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#content-type-sniffing">http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#content-type-sniffing</A>
<A HREF="http://tools.ietf.org/html/draft-abarth-mime-sniff-05">http://tools.ietf.org/html/draft-abarth-mime-sniff-05</A>

The question is if we can avoid it for new content types like
video/audio.  If not, we should spec it in advance so we at least have
something that's as sane as possible under the circumstances.

&gt;<i> That it is
</I>&gt;<i> 'hard' for web authors to ensure the correct Content-Types are set is:
</I>&gt;<i>
</I>&gt;<i> * not W3/WHATWG's problem. If web servers make adding Content-Type
</I>&gt;<i> information hard, then web servers need to be updated to make it easier;
</I>
I don't know about the W3C, but reality is the WHATWG's problem.  We
can't let things be broken and just say it's someone else's fault.  We
need to institute workarounds at our level for failures on other
levels if that's what's necessary to get good security and a good
user/author experience.

&gt;<i> * not really true, at least for Apache which can allow AddType et al in the
</I>&gt;<i> .htaccess files that low-end shared hosts use. This may not be widely-known
</I>&gt;<i> or practised, but that doesn't really merit changing the standards for
</I>&gt;<i> everyone else to cope with.
</I>
Creating a .htaccess file is a technical procedure that most users
will not know how to do, particularly since the problem will probably
just manifest itself as &quot;the video doesn't work&quot;.  It's also not
possible on some hosts -- although it's certainly possible on the
large majority of cheap shared hosts, and of course on hosts where the
author has root access.

On Tue, Sep 7, 2010 at 6:52 AM, Philip J&#228;genstedt &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>&gt; wrote:
&gt;<i> It hasn't been explicitly stated, but I assume that the only cases where
</I>&gt;<i> sniffing for video formats would be employed would be for missing
</I>&gt;<i> Content-Type, text/plain and application/octet-stream.
</I>
If those are the only common MIME types incorrectly served for unknown
file types, that seems reasonable.  (Some files might be actively
misidentified, like if I have an Ogg file saved as .jpeg, but
hopefully this will be very rare.)

On Tue, Sep 7, 2010 at 8:56 AM, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:
&gt;<i> On 9/7/10 4:11 AM, Philip J&#228;genstedt wrote:
</I>&gt;&gt;<i> It's garbage in at least UTF-8, Big5 and GBK.
</I>&gt;<i>
</I>&gt;<i> Thanks.  I assume that applies to the OggS\0 sequence too, right?  I
</I>&gt;<i> appreciate the data!
</I>&gt;<i>
</I>&gt;&gt;<i> I'm not sure what infrastructure is in place, but perhaps one could
</I>&gt;&gt;<i> *not* sniff if Content-Type also indicates an encoding?
</I>&gt;<i>
</I>&gt;<i> As long as &quot;indicates an encoding&quot; doesn't include UTF-8 or ISO-8859-1
</I>&gt;<i> (thanks, Apache!), that should be reasonable, I think.
</I>
So at least for Ogg and WebM, how about:

* Sniff only if Content-Type is typical of what popular browsers serve
for unrecognized filetypes.  E.g., only for no Content-Type,
text/plain, or application/octet-stream, and only if the encoding is
either not present or is UTF-8 or ISO-8859-1.  Or whatever web servers
do here.
* Sniff the same both for video tags and top-level browsing contexts,
so &quot;open video in new tab&quot; doesn't mysteriously fail on some setups.
* If a file in a top-level browsing context is sniffed as video but
then some kind of error is returned before the video plays the first
frame, fall back to allowing the user to download it, or whatever the
usual action would be if no sniffing had occurred.

Within these constraints, false positives in the sniffing algorithm
are made significantly more unlikely and should be pretty harmless --
if it fails in &lt;video&gt; it would fail anyway, and if it fails in a
top-level browsing context it will fall back quickly to the usual
behavior.  (Unless your non-video file actually so closely resembles a
video file that it will actually begin to play -- hopefully we can all
agree that's a negligible concern.)  Does this sound like a reasonable
direction to go in?

On Tue, Sep 7, 2010 at 12:12 PM, Maciej Stachowiak &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">mjs at apple.com</A>&gt; wrote:
&gt;<i> At least in the case of Safari, we initially added sniffing for the benefit of video types likely to be played with the QuickTime plugin - mainly .mov and various flavors of MPEG. It is common for these to be served with an incorrect MIME type. And we did not want to impose a high transition cost on content already being served via the QuickTime plugin. The QuickTime plugin may be a slightly less relevant consideration now than when we first thought about this, but at this point it is possible content has been migrated to &lt;video&gt; while still carrying broken MIME types.
</I>
What sorts of incorrect MIME types are usually present here, and how
do they come about?  I assume it's not a matter of web servers not
recognizing the file extension.

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="070670.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
	<LI>Next message: <A HREF="070675.html">[whatwg] Video with MIME type application/octet-stream
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#70674">[ date ]</a>
              <a href="thread.html#70674">[ thread ]</a>
              <a href="subject.html#70674">[ subject ]</a>
              <a href="author.html#70674">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
