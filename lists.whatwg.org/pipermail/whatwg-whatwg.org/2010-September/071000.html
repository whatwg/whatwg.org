<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] HTML5 7.6.1 Selection problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML5%207.6.1%20Selection%20problems&In-Reply-To=%3CAANLkTimzB962rfjL04qbFN_5fGC43B_7z9ZJ0HKfQpwV%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="071010.html">
   <LINK REL="Next"  HREF="071004.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] HTML5 7.6.1 Selection problems</H1>
<!--htdig_noindex-->
    <B>Tim Down</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML5%207.6.1%20Selection%20problems&In-Reply-To=%3CAANLkTimzB962rfjL04qbFN_5fGC43B_7z9ZJ0HKfQpwV%40mail.gmail.com%3E"
       TITLE="[whatwg] HTML5 7.6.1 Selection problems">timdown at gmail.com
       </A><BR>
    <I>Wed Sep 22 17:21:05 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="071010.html">[whatwg] Propsal: Mechanism for converting rgb, hex, and named color strings between one another
</A></li>
        <LI>Next message: <A HREF="071004.html">[whatwg] a typo in 8.6.1 APIs for the browsing context selection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71000">[ date ]</a>
              <a href="thread.html#71000">[ thread ]</a>
              <a href="subject.html#71000">[ subject ]</a>
              <a href="author.html#71000">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I am concerned about some aspects of section 7.6.1 in the HTML5
specification, relating to Selection objects. My main concern is that
some parts do not match current browser behaviour, in particular
relating to &quot;backwards&quot; selections (i.e. where the focus point comes
before the anchor point within the document).

Current browsers, unlike the HTML5 spec, allow both detection and
creation of backwards selections. Detection is via the anchorNode,
anchorOffset, focusNode and focusOffset properties. The selection
focus may be at a point in the document prior to the selection anchor,
meaning that the selection is backwards. In the HTML5 spec, the
selection focus must always be the same or after the anchor in the
document (<A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=10624">http://www.w3.org/Bugs/Public/show_bug.cgi?id=10624</A>).
Creation is via the expand method: it's possible to create a Range and
add it to the selection (making the selection anchor equal to the
start of the Range) and use the expand() method to move the selection
focus to any point in the document, including a point before the
selection anchor. HTML5 does not specify the expand() method
(<A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=10691">http://www.w3.org/Bugs/Public/show_bug.cgi?id=10691</A>). It seems to me
that it's important to be able create and manipulate backwards
selections: browsers already do it and it's useful within the context
of an editable element or document.

An unrelated issue is in the toString() method of Selection objects.
In HTML5, this takes a simplistic approach of concatenating the
results of calling toString() on each Range within the selection. This
is unfortunately not how any browser implements it or ever has:
toString() in Mozilla, WebKit and Opera returns only the text within
the selection that is visible to the user, omitting, for example, text
nodes within elements hidden by CSS properties such as display and
text nodes within &lt;script&gt; elements
(<A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=10583">http://www.w3.org/Bugs/Public/show_bug.cgi?id=10583</A>). The behaviour
is somewhat similar to that of an element's innerText property as
implemented in IE or WebKit.

In summary, the changes I'd like to see in section 7.6.1 of the HTML5 spec:

1. Change the specification of anchorNode, anchorOffset, focusNode and
focusOffset to be dependent on the direction of the selection but
still match either the start or end of the last range in the
selection;

2. Add the expand() method of Selection objects, matching current
browser behaviour;

3. Change the specification of the toString() method of Selection
objects to match current browser behaviour.


Tim Down

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="071010.html">[whatwg] Propsal: Mechanism for converting rgb, hex, and named color strings between one another
</A></li>
	<LI>Next message: <A HREF="071004.html">[whatwg] a typo in 8.6.1 APIs for the browsing context selection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#71000">[ date ]</a>
              <a href="thread.html#71000">[ thread ]</a>
              <a href="subject.html#71000">[ subject ]</a>
              <a href="author.html#71000">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
