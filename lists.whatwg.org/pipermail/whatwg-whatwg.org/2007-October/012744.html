<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] SQL API error handling
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20SQL%20API%20error%20handling&In-Reply-To=%3C189B2A59-CA22-4D11-B0D9-D82B5055DEF3%40apple.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012743.html">
   <LINK REL="Next"  HREF="012746.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] SQL API error handling</H1>
<!--htdig_noindex-->
    <B>Brady Eidson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20SQL%20API%20error%20handling&In-Reply-To=%3C189B2A59-CA22-4D11-B0D9-D82B5055DEF3%40apple.com%3E"
       TITLE="[whatwg] SQL API error handling">beidson at apple.com
       </A><BR>
    <I>Mon Oct 15 22:23:42 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="012743.html">[whatwg] SQL API error handling
</A></li>
        <LI>Next message: <A HREF="012746.html">[whatwg] SQL API error handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12744">[ date ]</a>
              <a href="thread.html#12744">[ thread ]</a>
              <a href="subject.html#12744">[ subject ]</a>
              <a href="author.html#12744">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On Oct 15, 2007, at 8:37 PM, Ian Hickson wrote:
&gt;&gt;&gt;&gt;<i> * CORRUPT, insofar as the Database API lets you delete databases  
</I>&gt;&gt;&gt;&gt;<i> (it
</I>&gt;&gt;&gt;&gt;<i> doesn't currently, but we've thought of adding that to Gears).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You may be correct that authors shouldn't be dealing with this.
</I>&gt;&gt;<i> Guaranteeing the integrity of the database at open is prohibitive  
</I>&gt;&gt;<i> (you
</I>&gt;&gt;<i> may have to scan the entire database), and no guarantee in  
</I>&gt;&gt;<i> practice, so
</I>&gt;&gt;<i> it's possible that you can detect corruption at any arbitrary  
</I>&gt;&gt;<i> statement.
</I>&gt;<i>
</I>&gt;<i> Sure, but that problem occurs everywhere. I mean, there's no JS  
</I>&gt;<i> exception
</I>&gt;<i> for &quot;your CPU core just overheated&quot;, but we don't guarentee that won't
</I>&gt;<i> happen either. Database corruption will occur either for hardware  
</I>&gt;<i> reasons
</I>&gt;<i> or due to software bugs. Hardware failures could cause all kinds of  
</I>&gt;<i> random
</I>&gt;<i> stuff, including software bugs (through corruption of executables).  
</I>&gt;<i> Having
</I>&gt;<i> an API to handle software bugs seems silly, since if we could assume  
</I>&gt;<i> that
</I>&gt;<i> that API was bug free, why not assume the rest of the API is too. This
</I>&gt;<i> just seems like a case we shouldn't worry about.
</I>

I agree with your principals here, but think databases are a different  
story.  In some embedded (and client-server) database implementations  
- including SQLite - continuing to operate on a database that is known  
to be corrupt can lead to the process crashing.  Unlike the &quot;CPU core  
just overheated&quot; case, it is a dangerous state software can help avoid.

How the user agent handles the problem long term (ask the user what to  
do, silently delete and recreate it, let the database continue to be  
corrupt, etc) may not need to be specified, but perhaps it would be  
prudent to change the spec to at least suggest that if a database  
becomes &quot;known to be corrupt,&quot; operations on all open handles to that  
database should start throwing INVALID_STATE_ERR exceptions.

Thanks,
~Brady

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012743.html">[whatwg] SQL API error handling
</A></li>
	<LI>Next message: <A HREF="012746.html">[whatwg] SQL API error handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12744">[ date ]</a>
              <a href="thread.html#12744">[ thread ]</a>
              <a href="subject.html#12744">[ subject ]</a>
              <a href="author.html#12744">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
