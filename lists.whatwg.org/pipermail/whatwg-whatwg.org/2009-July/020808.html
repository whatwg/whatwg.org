<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Adding SVG Filter-like functionality to Canvas 2D	Context
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Adding%20SVG%20Filter-like%20functionality%20to%20Canvas%202D%0A%09Context&In-Reply-To=%3Cf7458d480907061552i14a135edyb79bdcf9debaebb6%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020803.html">
   <LINK REL="Next"  HREF="020813.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Adding SVG Filter-like functionality to Canvas 2D	Context</H1>
<!--htdig_noindex-->
    <B>Hans Schmucker</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Adding%20SVG%20Filter-like%20functionality%20to%20Canvas%202D%0A%09Context&In-Reply-To=%3Cf7458d480907061552i14a135edyb79bdcf9debaebb6%40mail.gmail.com%3E"
       TITLE="[whatwg] Adding SVG Filter-like functionality to Canvas 2D	Context">hansschmucker at gmail.com
       </A><BR>
    <I>Mon Jul  6 15:52:08 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020803.html">[whatwg] Adding SVG Filter-like functionality to Canvas 2D	Context
</A></li>
        <LI>Next message: <A HREF="020813.html">[whatwg] Adding SVG Filter-like functionality to Canvas 2D	Context
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20808">[ date ]</a>
              <a href="thread.html#20808">[ thread ]</a>
              <a href="subject.html#20808">[ subject ]</a>
              <a href="author.html#20808">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, Jul 7, 2009 at 12:15 AM, Robert O'Callahan&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt; wrote:
&gt;<i> On Tue, Jul 7, 2009 at 9:21 AM, &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">hansschmucker at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Tue, Jul 7, 2009 at 2:09 AM, <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">hansschmucker at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; SVG Filters are a relatively easy spec, where the most important parts
</I>&gt;&gt;<i> &gt; can be implemented in a matter of hours.
</I>&gt;&gt;<i> On Jul 6, 2009 10:54pm, Robert O'Callahan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; Speaking as an implementor of SVG filters, I don't believe you :-).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I said most parts (by which I meant the actual image manipulations, which
</I>&gt;&gt;<i> are defined pretty well in the SVG spec, not the surrounding issues of when
</I>&gt;&gt;<i> to do drawing updates and so on that wouldn't apply to a Canvas anyway) :) .
</I>&gt;&gt;<i> OK, I made it sound simpler than it is, but when you get right down to it,
</I>&gt;&gt;<i> just the drawing code isn't terribly complicated.
</I>&gt;<i>
</I>&gt;<i> Some of the filters aren't complicated, but some are. You're also talking
</I>&gt;<i> about duplicating the object model. And looking forward, if we do some
</I>&gt;<i> JIT-based or GPU-based filter acceleration, duplicating that work would
</I>&gt;<i> really suck. I would say the drawing code has to be shared even if the
</I>&gt;<i> object model is not.
</I>&gt;<i>
</I>&gt;&gt;<i> On Jul 6, 2009 10:54pm, Robert O'Callahan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; I agree that we need a convenient way to use filters with canvas. But I
</I>&gt;&gt;<i> &gt; would rather not create an entirely new object model.
</I>&gt;&gt;<i> &gt; How about a drawImageWithFilter method that takes the same set of
</I>&gt;&gt;<i> &gt; parameters as drawImage plus a reference to an SVG element? The image is
</I>&gt;&gt;<i> &gt; used for Source/SourceAlpha and the size of the image establishes the object
</I>&gt;&gt;<i> &gt; bounding box for filter and filter primitive units. Since drawImage can draw
</I>&gt;&gt;<i> &gt; a canvas, this seems completely flexible.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm fearing that the dependency on SVG would bring a lot of problems if a
</I>&gt;&gt;<i> browser vendor wants to include just Canvas, like WebKit on the Palm Pre.
</I>&gt;<i>
</I>&gt;<i> Webkit on iPhone and I think Android, and Fennec too, support SVG. If Palm
</I>&gt;<i> decides differently, that's their call and they can take the consequences. I
</I>&gt;<i> am deeply averse to duplicating functionality across specs &quot;just in case&quot;
</I>&gt;<i> someone implements one but not the other. It punishes authors and vendors of
</I>&gt;<i> full-function browsers.
</I>
It may just be me, but I think that the success of Canvas, which is
way ahead of HTML5 in general, is largely due to the fact that it's
pretty much standalone. You don't have to read through hundreds of
pages of other documentation, you just read the Canvas spec and that's
pretty much it. Same for parties who want to implement it, there's
virtually no big dependency.

Of course, how you actually implement it (i.e. by sharing code with
the SVG filters) is not even something a spec is supposed to dictate,
you can share as much code as you want as long as the result is what
the spec says.

&gt;&gt;<i> Also, the SVG model is pretty complex when you include all the ways to
</I>&gt;&gt;<i> cross-reference data. What would happen if a filter would want to load an
</I>&gt;&gt;<i> image? Canvas can't work asyc, so either the whole call would fail or we'd
</I>&gt;&gt;<i> lock up the browser for ages.
</I>&gt;<i>
</I>&gt;<i> You'd just use whatever image you've got, just like SVG filter drawing does
</I>&gt;<i> normally. It's no different from doing drawImage with a partially loaded
</I>&gt;<i> image.
</I>Is this really useful for Canvas? Partial results are fine when all
you do is filter, but if the filter is part of a larger drawing
routine, then the result could be pretty undesirable. And since
there's no direct way to check for the status of the resource, all the
Canvas user could do would be trying again and again until it works
should we decide that methods should throw an error if a resource
isn't loaded yet.

&gt;&gt;<i> Security issues would also increase tenfold as Canvas has a pretty simple
</I>&gt;&gt;<i> security model. If we'd allow normal SVG filters, we'd probably need to flag
</I>&gt;&gt;<i> the Canvas as &quot;dirty&quot;, since SVG flters allow for loading of data from many
</I>&gt;&gt;<i> sources, including what's currently on the screen.
</I>&gt;<i>
</I>&gt;<i> You mean BackgroundImage? That makes no sense for canvas usage anyway, we'd
</I>&gt;<i> just ignore it. Foreign image usage would taint the canvas, that's easy to
</I>&gt;<i> do.
</I>Nope, I meant the filter loading an SVG, loading a HTML via
foreignElement, loading another SVG via iframe, loading an image from
another server. BackgroundImage is of no use for Canvas anyway.

&gt;&gt;<i> Including a dedicated filter API for Canvas would keep it simple and
</I>&gt;&gt;<i> self-contained, allowing for much easier implementation, wouldn't it?
</I>&gt;<i> No, not really. Duplicating code is evil. Adding layers of abstraction so
</I>&gt;<i> that the same code can be used through different interfaces is less evil,
</I>&gt;<i> but it's still bad.
</I>I think that abstraction would provide an OK compromise, but that's up
to the implementing parties.

&gt;&gt;<i> It would also give us a chance to strip out SVG stuff that doesn't make
</I>&gt;&gt;<i> any sense for Canvas or is too complicated for too little benefit.
</I>&gt;<i> You see that as a chance. I see it as an opportunity for endless arguments.
</I>&gt;<i> And experience suggests that over time both sets of functionality will grow
</I>&gt;<i> to meet all users' requirements.
</I>But do you really want to explain to everybody who wants to use it
that the colorspace is not normal RGBA32, but some strange....
something? That the applied rectangle is actually 1.2x the given size
in any dimension? There is simply a lot of stuff in SVG that's meant
for graphics artists, not programmers. The usage would be different in
Canvas from what it is in SVG.

&gt;<i> BTW with an HTML5 parser you can write &lt;svg&gt; content directly in HTML, which
</I>&gt;<i> makes it really easy to write an SVG filter to use with &lt;canvas&gt;.
</I>And suddenly we have another dependency :) But seriously: What good is
a filter that is supplied somewhere in the document body to a dynamic
graphic. Why would I want to meddle with the DOM, when really all I
want to set is a local property? Maybe I could pipe the SVG in via
E4X, but that's just another dependency, that doesn't really do any
good.

&gt;<i> One thing I would change is SVG filters should not clip to the filter region
</I>&gt;<i> or the filter primitive subregions. That's actually a change that should be
</I>&gt;<i> made to SVG (and I think the SVG WG is planning to make it), but for canvas
</I>&gt;<i> that should be the default.
</I>I think I'll have to look that one up :)

--hans
</PRE>











































































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020803.html">[whatwg] Adding SVG Filter-like functionality to Canvas 2D	Context
</A></li>
	<LI>Next message: <A HREF="020813.html">[whatwg] Adding SVG Filter-like functionality to Canvas 2D	Context
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20808">[ date ]</a>
              <a href="thread.html#20808">[ thread ]</a>
              <a href="subject.html#20808">[ subject ]</a>
              <a href="author.html#20808">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
