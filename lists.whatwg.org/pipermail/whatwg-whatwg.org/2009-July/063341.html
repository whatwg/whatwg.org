<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] HTML 5 video tag questions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML%205%20video%20tag%20questions&In-Reply-To=%3Cop.uw1tv2snatwj1d%40sisko.linkoping.osa%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="063317.html">
   <LINK REL="Next"  HREF="063359.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] HTML 5 video tag questions</H1>
<!--htdig_noindex-->
    <B>Philip J&#228;genstedt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML%205%20video%20tag%20questions&In-Reply-To=%3Cop.uw1tv2snatwj1d%40sisko.linkoping.osa%3E"
       TITLE="[whatwg] HTML 5 video tag questions">philipj at opera.com
       </A><BR>
    <I>Tue Jul 14 01:29:52 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="063317.html">[whatwg] HTML 5 video tag questions
</A></li>
        <LI>Next message: <A HREF="063359.html">[whatwg] HTML 5 video tag questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63341">[ date ]</a>
              <a href="thread.html#63341">[ thread ]</a>
              <a href="subject.html#63341">[ subject ]</a>
              <a href="author.html#63341">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, 13 Jul 2009 23:32:44 +0200, Tab Atkins Jr. &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jackalmage at gmail.com</A>&gt;  
wrote:

&gt;<i> On Mon, Jul 13, 2009 at 4:01 PM, Philip J&#228;genstedt&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">philipj at opera.com</A>&gt;  
</I>&gt;<i> wrote:
</I>&gt;&gt;<i> I thought you meant
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;video&gt;
</I>&gt;&gt;<i>  &lt;source fallback&gt;
</I>&gt;&gt;<i>    fallback content here
</I>&gt;&gt;<i>  &lt;/source&gt;
</I>&gt;&gt;<i> &lt;/video&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I would prefer if fallback content and source elements weren't mixed on  
</I>&gt;&gt;<i> the
</I>&gt;&gt;<i> same level, but maybe that's just me.
</I>&gt;<i>
</I>&gt;<i> Eh, fallback content for non-&lt;video&gt; browsers is already there, so
</I>&gt;<i> it's nothing new.
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> (You could also just put @fallback on the second &lt;source&gt; and drop the
</I>&gt;&gt;&gt;<i> third &lt;source&gt; entirely for the same effect.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Once the source element is iterated by the resource selection algorithm  
</I>&gt;&gt;<i> and
</I>&gt;&gt;<i> starts loading, the fallback attribute or the whole source element  
</I>&gt;&gt;<i> might be
</I>&gt;&gt;<i> removed. You would have to set a flag at some point to remember the  
</I>&gt;&gt;<i> fallback
</I>&gt;&gt;<i> state and unset it... when? What is the effect of
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;video&gt;
</I>&gt;&gt;<i> &lt;source fallback&gt;
</I>&gt;&gt;<i> &lt;source src=&quot;cant.play.ogg&quot;&gt;
</I>&gt;&gt;<i> fallback here
</I>&gt;&gt;<i> &lt;/video&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ?
</I>&gt;<i>
</I>&gt;<i> It would hit the first &lt;source&gt;, note that there's no @src, see that
</I>&gt;<i> there is @fallback, and immediately drop to showing fallback content.
</I>&gt;<i>
</I>&gt;&gt;<i> Is fallback irrevocable or could the same video element go back to  
</I>&gt;&gt;<i> showing
</I>&gt;&gt;<i> video under some circumstances?
</I>&gt;<i>
</I>&gt;<i> It should be revocable in the exact same circumstances that a &lt;video&gt;
</I>&gt;<i> element might start playing from one &lt;source&gt;, and then switch to
</I>&gt;<i> another.  From my reading of the algorithm I don't think this is
</I>&gt;<i> possible, so fallback would be irrevocable.
</I>
Right, anything but irrevocable fallback would make this even stranger  
than object fallback. Let's not go there.

&gt;&gt;<i> Does audio also have fallback content?
</I>&gt;<i>
</I>&gt;<i> It uses &lt;source&gt; and the same source-selection algorithm (and the same
</I>&gt;<i> fallback situation in the case of non-&lt;audio&gt; browsers), so yes.
</I>&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> This is why I suggested &lt;video&gt;&lt;source
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> src=&quot;cant.play.ogg&quot;&gt;&lt;new-fallback-element&gt;Ooops!&lt;/new-fallback-element&gt;&lt;/video&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I still think the use of this is questionable though.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm not sure why you think the usecase is questionable.  It seems
</I>&gt;&gt;&gt;<i> pretty clear - it'd be nice to have a non-script way of showing
</I>&gt;&gt;&gt;<i> content (specifically, alternate video players) when the browser
</I>&gt;&gt;&gt;<i> supports &lt;video&gt; but can't play any of the provided sources.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, handling the (minor) use case video support + no supported source  
</I>&gt;&gt;<i> + no
</I>&gt;&gt;<i> script would be nice, but only if it doesn't make an even bigger mess  
</I>&gt;&gt;<i> of the
</I>&gt;&gt;<i> resource selection algorithm and doesn't allow switching back and forth
</I>&gt;&gt;<i> between video and fallback.
</I>&gt;<i>
</I>&gt;&gt;<i> From what I can tell of the resource selection algorithm, fallback
</I>&gt;<i> should be irrevocable, just like a successful &lt;source&gt; load is.
</I>&gt;<i>
</I>&gt;<i> The resource selection algorithm appears to need fairly trivial
</I>&gt;<i> changes to accommodate this.  Step 4, when parsing @src from &lt;video&gt;,
</I>&gt;<i> insert a new substep between substeps 2 and 3.  Pull the first
</I>&gt;<i> sentence from the current substep 3 into this new substep, and say
</I>&gt;<i> something like &quot;If the element has a fallback attribute, abort this
</I>&gt;<i> algorithm immediately and display the fallback content.&quot;  When parsing
</I>
See below for why we can't put the fallback attribute on the video element.

&gt;<i> &lt;source&gt; elements, change step 3 so that whenever any of those
</I>&gt;<i> conditions are met, if the &lt;source&gt; has @fallback the algorithm aborts
</I>&gt;<i> immediately and shows the fallback content, otherwise it fires the
</I>&gt;<i> error event and jumps to the &quot;search loop&quot; step as normal.
</I>
This would only cause fallback to be used when the source element is  
rejected up front, not if it is a candidate for the resource fetch  
algorithm that fails to fetch/play. So you also need to check @fallback  
before step 6. However, by then the source element may very well be  
removed from the DOM, so I you'd have to assign @fallback to a variable  
earlier in the algorithm and check that.

This approach is implementable in my guesstimation, but I'd really want to  
know more about the history of object fallback issues. Should fallback  
content be treated as if it were display:none, or are there nastier hacks  
involved?

&gt;<i> Alternately, we could just put @fallback always on the &lt;video&gt; element
</I>&gt;<i> directly, rather than on &lt;source&gt;.  That would preserve the first part
</I>&gt;<i> of what I said, but now we have a step between substeps 9 and 10 that
</I>&gt;<i> checks for @fallback on the &lt;video&gt;.  If it finds it, it immediately
</I>&gt;<i> aborts and shows the fallback content, otherwise substep 10 proceeds
</I>&gt;<i> normally (waiting forever).
</I>
That would cause the fallback to be triggered unconditionally during  
parsing:

&lt;video fallback&gt;
&lt;source src=&quot;foo&quot; type=&quot;video/x-unsupported&quot;&gt;
&lt;!-- steps 8-10 run here --&gt;
&lt;source src=&quot;bar&quot; type=&quot;video/x-supported&quot;&gt;
&lt;/video&gt;

There's nothing in the resource selection algorithm that's special-cased  
for static markup by hooking into the parser, which would be required to  
make it work (but then only for static markup). Putting @fallback on the  
video element just won't work.

-- 
Philip J&#228;genstedt
Core Developer
Opera Software

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="063317.html">[whatwg] HTML 5 video tag questions
</A></li>
	<LI>Next message: <A HREF="063359.html">[whatwg] HTML 5 video tag questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#63341">[ date ]</a>
              <a href="thread.html#63341">[ thread ]</a>
              <a href="subject.html#63341">[ subject ]</a>
              <a href="author.html#63341">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
