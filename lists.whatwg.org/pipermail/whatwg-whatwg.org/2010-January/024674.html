<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] using postMessage() to send to a newly-created window
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20using%20postMessage%28%29%20to%20send%20to%20a%20newly-created%20window&In-Reply-To=%3Cf965ae411001051504s2f3abdc1y13f8c4da3303d4f7%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024740.html">
   <LINK REL="Next"  HREF="024675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] using postMessage() to send to a newly-created window</H1>
<!--htdig_noindex-->
    <B>Drew Wilson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20using%20postMessage%28%29%20to%20send%20to%20a%20newly-created%20window&In-Reply-To=%3Cf965ae411001051504s2f3abdc1y13f8c4da3303d4f7%40mail.gmail.com%3E"
       TITLE="[whatwg] using postMessage() to send to a newly-created window">atwilson at google.com
       </A><BR>
    <I>Tue Jan  5 15:04:49 PST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="024740.html">[whatwg] Inconsistent behavior for empty-string URLs
</A></li>
        <LI>Next message: <A HREF="024675.html">[whatwg] question about the popstate event
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24674">[ date ]</a>
              <a href="thread.html#24674">[ thread ]</a>
              <a href="subject.html#24674">[ subject ]</a>
              <a href="author.html#24674">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I ran into this early last year when I was first investigating MessagePorts:

<A HREF="http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2009-March/018893.html">http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2009-March/018893.html</A>

I dimly recall that the response I got off-list (via IRC?) was that this was
expected behavior (the intended use for window.postMessage() is for
communicating with child iframes, where you can register an onload handler
to be notified when it's safe to post messages), but I agree that it would
be worthwhile to explicitly state this somewhere in the spec.

-atw

On Mon, Dec 21, 2009 at 7:24 PM, Dirk Pranke &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">dpranke at chromium.org</A>&gt; wrote:

&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> In the course of testing something today, I attempted to create a
</I>&gt;<i> window and immediately post a message to it, and was surprised that it
</I>&gt;<i> didn't seem to work.
</I>&gt;<i>
</I>&gt;<i> E.g.:
</I>&gt;<i>
</I>&gt;<i> var w = window.open(&quot;<A HREF="http://x">http://x</A>&quot;);
</I>&gt;<i> w.postMessage(&quot;hello, world&quot;, &quot;*&quot;);
</I>&gt;<i>
</I>&gt;<i> w never got the message - this seemed to be consistent across Safari,
</I>&gt;<i> Chrome, and FF (all I had installed on my Mac at the time, so
</I>&gt;<i> apologies to Opera, IE, and anyone else I've left out).
</I>&gt;<i>
</I>&gt;<i> Is this supposed to work? If not, is there a reliable way for the the
</I>&gt;<i> source to know when it is safe to send a message to the target? The
</I>&gt;<i> only way I can think of is for the target to send a message back to
</I>&gt;<i> the source, which only works if the target can get a reference to the
</I>&gt;<i> source using window.opener, which may or may not be possible or
</I>&gt;<i> desirable ...
</I>&gt;<i>
</I>&gt;<i> If this isn't supposed to work, can we state this explicitly in the spec?
</I>&gt;<i>
</I>&gt;<i> -- dirk
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100105/354eec99/attachment.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20100105/354eec99/attachment.htm</A>&gt;
</PRE>







<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024740.html">[whatwg] Inconsistent behavior for empty-string URLs
</A></li>
	<LI>Next message: <A HREF="024675.html">[whatwg] question about the popstate event
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24674">[ date ]</a>
              <a href="thread.html#24674">[ thread ]</a>
              <a href="subject.html#24674">[ subject ]</a>
              <a href="author.html#24674">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
