<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Cryptographically strong random numbers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Cryptographically%20strong%20random%20numbers&In-Reply-To=%3CAANLkTikzq3goBBDXShOArSpCBWqE2uLGFjM1Bp7Eegj6%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030469.html">
   <LINK REL="Next"  HREF="030471.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Cryptographically strong random numbers</H1>
<!--htdig_noindex-->
    <B>Adam Barth</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Cryptographically%20strong%20random%20numbers&In-Reply-To=%3CAANLkTikzq3goBBDXShOArSpCBWqE2uLGFjM1Bp7Eegj6%40mail.gmail.com%3E"
       TITLE="[whatwg] Cryptographically strong random numbers">w3c at adambarth.com
       </A><BR>
    <I>Mon Feb 14 11:31:08 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="030469.html">[whatwg] Cryptographically strong random numbers
</A></li>
        <LI>Next message: <A HREF="030471.html">[whatwg] Cryptographically strong random numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30470">[ date ]</a>
              <a href="thread.html#30470">[ thread ]</a>
              <a href="subject.html#30470">[ subject ]</a>
              <a href="author.html#30470">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Feb 14, 2011 at 8:31 AM, Mark S. Miller &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">erights at google.com</A>&gt; wrote:

&gt;<i> On Mon, Feb 14, 2011 at 2:47 AM, Adam Barth &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">w3c at adambarth.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> That's a pretty long time horizon.  You're going to start discussing
</I>&gt;&gt;<i> it in 2-4 months?  That seems a bit overwrought for what amounts to
</I>&gt;&gt;<i> four lines of code.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The committee meets once every two months. Between meetings, we discuss
</I>&gt;<i> things on es-discuss, so please do.
</I>&gt;<i>
</I>&gt;<i> What are the four lines of code?
</I>&gt;<i>
</I>
<A HREF="http://trac.webkit.org/browser/trunk/Source/WebCore/page/Crypto.cpp">http://trac.webkit.org/browser/trunk/Source/WebCore/page/Crypto.cpp</A>

On Mon, Feb 14, 2011 at 8:40 AM, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:

&gt;<i> On 2/14/11 11:31 AM, Mark S. Miller wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Mon, Feb 14, 2011 at 2:47 AM, Adam Barth &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">w3c at adambarth.com</A>
</I>&gt;&gt;<i> &lt;mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">w3c at adambarth.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    That's a pretty long time horizon.  You're going to start discussing
</I>&gt;&gt;<i>    it in 2-4 months?  That seems a bit overwrought for what amounts to
</I>&gt;&gt;<i>    four lines of code.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> For what it's worth, it's a lot more than 4 lines of code in Gecko, because
</I>&gt;<i> we don't have an existing source of strong randomness in Spidermonkey.  It'd
</I>&gt;<i> be about that much code in the DOM, where we could pass the buck to NSS, but
</I>&gt;<i> for Spidermonkey it would take a good bit more work.
</I>

Similarly, the WebKit implementation just passes the buck to the WTF layer,
which already knows how to fill a void* with n cryptographically random
bytes.  The implementation will be similarly trivial in most applications
that link with OpenSSL or NSS or that run on Mac, Linux, or Windows.

On Mon, Feb 14, 2011 at 10:05 AM, Brendan Eich &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">brendan at mozilla.org</A>&gt; wrote:

&gt;<i> On Feb 14, 2011, at 8:40 AM, Boris Zbarsky wrote:
</I>&gt;<i> &gt; On 2/14/11 11:31 AM, Mark S. Miller wrote:
</I>&gt;<i> &gt;&gt; On Mon, Feb 14, 2011 at 2:47 AM, Adam Barth &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">w3c at adambarth.com</A>
</I>&gt;<i> &gt;&gt; &lt;mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">w3c at adambarth.com</A>&gt;&gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;    That's a pretty long time horizon.  You're going to start discussing
</I>&gt;<i> &gt;&gt;    it in 2-4 months?  That seems a bit overwrought for what amounts to
</I>&gt;<i> &gt;&gt;    four lines of code.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; For what it's worth, it's a lot more than 4 lines of code in Gecko,
</I>&gt;<i> because we don't have an existing source of strong randomness in
</I>&gt;<i> Spidermonkey.  It'd be about that much code in the DOM, where we could pass
</I>&gt;<i> the buck to NSS, but for Spidermonkey it would take a good bit more work.
</I>&gt;<i>
</I>&gt;<i> Not really. We use callback-style APIs to delegate such chores as l10n to
</I>&gt;<i> the embedding, and the same can be done for randomness-hunting. It's just
</I>&gt;<i> interfacing, or buck-passing -- but I'm still wondering what magical four
</I>&gt;<i> lines of code provide useful lower bounds on bits of entropy in WebKit. Is
</I>&gt;<i> this just non-interoperable delegation to the host OS?
</I>&gt;<i>
</I>
What's non-interoperable about filling an ArrayBuffer with random bytes?
 I'm not sure I understand your question.

Adam, I like moving fast (but beware, that's how JS and the DOM were
&gt;<i> created), but we need a cross-browser spec of some kind, even if we all add
</I>&gt;<i> crypto.getRandomValues quickly. The original y2k-buggy,
</I>&gt;<i> cloned-from-java.util.Date JS Date object of 1995 required a lot of work for
</I>&gt;<i> ES1 to remove OS dependencies that made for interop hell.
</I>&gt;<i>
</I>
In this case, the API is several order of magnitude simpler than Date.  The
choices to make roughly boil down to the name of the function, which types
to support, and what sorts of exceptions to throw in which error cases.


&gt;<i> For a core language standard, we would want some kind of minimum quality
</I>&gt;<i> guarantee on the randomness.
</I>&gt;<i>
</I>
I'm not sure that's possible without either allowing the API to block for
arbitrary periods of time or to fail.  Assuming we want a non-blocking,
non-failing API, we can't make any guarantees about the quality of the
randomness.  In that sense, crypto.getRandomValues is &quot;best effort.&quot;

Obviously, a blocking API is in appropriate for the browser setting.
 There's certainly a place for failing randomness sources (e.g., analogous
to /dev/random versus /dev/urandom, although /dev/random is blocking rather
than failing).  The need just isn't as dire, in my view.  I'd certainly be
happy if ECMAScript came along in six months or a year with a nice
cryptographic library, including a variety of random generators (e.g.,
perhaps seedable, failing, and with algorithmic agility).  However, I'm
disinclined to wait on the basic best-effort PRNG for that to happen.


&gt;<i> Quick thought on the name: to avoid vagueness and the &quot;why not wider int or
</I>&gt;<i> even float element type&quot; questions that have already come up, call the
</I>&gt;<i> method getRandomBytes.
</I>&gt;<i>
</I>
I added support for all the integer ArrayBuffer types, so getRandomBytes
isn't a particularly accurate name.

Adam
</PRE>



















































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030469.html">[whatwg] Cryptographically strong random numbers
</A></li>
	<LI>Next message: <A HREF="030471.html">[whatwg] Cryptographically strong random numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30470">[ date ]</a>
              <a href="thread.html#30470">[ thread ]</a>
              <a href="subject.html#30470">[ subject ]</a>
              <a href="author.html#30470">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
