<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal for separating script downloads and execution
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20separating%20script%20downloads%20and%20execution&In-Reply-To=%3C85E2B608F9544FF49F6DCB45985A67D1%40spartacus%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030340.html">
   <LINK REL="Next"  HREF="030345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal for separating script downloads and execution</H1>
<!--htdig_noindex-->
    <B>Kyle Simpson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20separating%20script%20downloads%20and%20execution&In-Reply-To=%3C85E2B608F9544FF49F6DCB45985A67D1%40spartacus%3E"
       TITLE="[whatwg] Proposal for separating script downloads and execution">getify at gmail.com
       </A><BR>
    <I>Wed Feb  9 07:37:04 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="030340.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
        <LI>Next message: <A HREF="030345.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30343">[ date ]</a>
              <a href="thread.html#30343">[ thread ]</a>
              <a href="subject.html#30343">[ subject ]</a>
              <a href="author.html#30343">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>?&gt;&gt; Regardless, considering such things is way outside the scope of anything
&gt;&gt;<i> that's going to be useful for web developers in the near-term dealing
</I>&gt;&gt;<i> with these use-cases.
</I>&gt;<i>
</I>&gt;<i> Yes, but so is the proposal here, no?
</I>
No, I don't think so. A huge part of my point with the proposal is that it 
builds on existing spec wording AND it has browser implementation precedent 
from IE, and *some* stated support from Opera. That makes a &quot;solution&quot; a bit 
more tangible and foreseeable in the near future, as opposed to for instance 
saying that all mobile device JavaScript engines must be changed so that 
they take more advantage of multi-threading -- a task which could be years 
before realized.


&gt;<i> Yes, but what makes you think that those very same sites will make good 
</I>&gt;<i> use of the functionality we're proposing here?
</I>
Fair enough, the offenders will probably keep on offending. EXCEPT that web 
performance advocates like myself (and Steve Souders, and many others) will 
have something tangible to take to them in performance evangelism efforts. 
Right now, if we try to get them to address their bad performance, it 
involves suggesting an extremely complex and convoluted set of brittle 
hacks, which they are rightly hesitant to consider.

It's a much easier &quot;sell&quot; if we can say &quot;look, here's this simple mechanism 
dedicated specifically to helping the problem your site has, would you 
consider it?&quot;


&gt;<i> Neither will the browser eagerly parsing.  ;)
</I>&gt;<i>
</I>&gt;&gt;<i> What's VERY important to note: (perhaps) the most critical part of
</I>&gt;&gt;<i> user-experience satisfaction in web page interaction is the *initial*
</I>&gt;&gt;<i> page-load experience.
</I>&gt;<i>
</I>&gt;<i> Really?  The pages I hate the most are the ones that make every single 
</I>&gt;<i> damn action slow.  I have had no real pageload issues (admittedly, on 
</I>&gt;<i> &quot;desktop&quot;) in a good long while, but pages that freeze up for a while 
</I>&gt;<i> doing sync XHR or computing digits of pi or whatever when you just try to 
</I>&gt;<i> use their menus are all over the place....
</I>
There's lots and lots of research into how user-satisfaction in web pages 
and web applications is more driven by the initial page-load experience than 
any other factor (not exclusively, just majority). Again, I refer you to the 
great work Steve Souders has done in this area. There's plenty of 
information about how when sites speed up their page-load (and nothing 
else), user retention (and a whole related host of other positive 
user-satisfaction indicators) all go up, sometimes dramatically.


&gt;&gt;<i> So if it's a tradeoff where I can get my page-load
</I>&gt;&gt;<i> to go much quicker on a mobile device (and get some useful content in
</I>&gt;&gt;<i> front of them quickly) in exchange for some lag later in the lifetime of
</I>&gt;&gt;<i> the page, that's a choice I (and many other devs) are likely to want to
</I>&gt;&gt;<i> make.
</I>&gt;<i>
</I>&gt;<i> See, as a user that seems like the wrong tradeoff to me if done to the 
</I>&gt;<i> degree I see people doing it.
</I>
We can debate that point forever and never really come to a definitive 
consensus. I myself sometimes feel like this technique can be taken 
overboard and I'm not entirely behind all attempts to defer script 
execution. But nonetheless, there's provable validity to making some 
tradeoffs like that, and seeing user happiness go up. We're simply asking 
for the means to make those tradeoffs without costly/ugly hacks. That's all.

There's obviously an &quot;art&quot; here in balance. But the numbers clearly indicate 
that addressing page-load performance bottlenecks leads to huge gains in 
user-satisfaction.


&gt;<i> Perhaps they just have different goals?  For example, completely 
</I>&gt;<i> hypothetically, the browser may have a goal of never taking more than 50ms 
</I>&gt;<i> to respond to a user action.  This is clearly a non-goal for web authors, 
</I>&gt;<i> right?
</I>
In fact, no. As I asserted in an earlier message in the thread, I believe 
the goals of the browsers (to be faster in page load) line up well with the 
goals of web authors (to reduce the amount of bounce traffic because of slow 
loading sites, especially on mobile).

Not all web authors care about performance (often they just care about bells 
&amp; whistles). But there's a recent undeniable trend, and huge uptick, toward 
more awareness of web performance optimization issues and specifically on 
improving initial page-load experience.

Consider the Google algorithm change where they take page-load speed as a 
factor in ranking. Clearly, more and more web authors (and the businesses 
that drive their decision making) are seeing the benefits of 
performance-savvy websites, so I believe we'll see even more alignment of 
goals as we move forward.


&gt;<i> Should a browser be prohibited from pursuing that goal even if it makes 
</I>&gt;<i> some particular sites somewhat slower to load initially (which is a big 
</I>&gt;<i> &quot;if&quot;, btw).
</I>
A browser should have some strong warnings against acting in a way that is 
counter to the expressed intent of a web author. If a web author is taking 
steps to more actively control the pipeline of resource loading and 
page-load performance, the browser should not try to second-guess that 
author and thwart their efforts.

Again, this should be a cooperative thing, not an adversarial tug-of-war.


&gt;<i> I think you're assuming a uniformity to browser implementations that's 
</I>&gt;<i> simply not there.
</I>
No, I'm relying on the growing trend of more and more web authors being:
1) aware of performance issues, especially initial page-load performance
2) able to use more tools to measure these issues, and test them across a 
broader range of user-agents
3) able to leverage more functionality that the spec and browsers give to 
them, to have better optimization of their pages


&gt;&gt;<i> As for telling if the browser were deferring parsing to a useful degree,
</I>&gt;&gt;<i> I'm sure that the only way to actually determine that would be test a
</I>&gt;&gt;<i> site with a particularly long script file (length being a rough
</I>&gt;&gt;<i> approximation for parsing time), and see just when (between load and
</I>&gt;&gt;<i> execution) the big parsing delay (as observed previously) was happening.
</I>&gt;<i>
</I>&gt;<i> Assuming the browser does the parsing on the main thread, yes?  What if it 
</I>&gt;<i> doesn't?
</I>
Regardless of what thread the processing is on, if the parsing happens 
during the critical few moments of page-load, and the device's CPU/hardware 
is overwhelmed, it's going to be obvious that there's a slowdown or freeze.


&gt;<i>
</I>&gt;<i> I can live with that.
</I>&gt;<i>
</I>&gt;&gt;<i> Do you see how what I'm asking for is not direct forcible control over
</I>&gt;&gt;<i> parsing but some way to strongly encourage the browser to defer both
</I>&gt;&gt;<i> parsing and execution until later, when *I* say I want it to?
</I>&gt;<i>
</I>&gt;<i> That wasn't what the initial proposal sounded like, but ok.  If that's 
</I>&gt;<i> what you're looking for, that sounds fine.
</I>
I'm glad we can see some hope of finding agreements. :)

The major problem in the mobile-performance part of the use-case is around 
parsing. Noone is suggesting here that the web author should have a .parse() 
function where they deterministically control it and handcuff the browser. 
What we're suggesting is that we be able to directly control execution, and 
in so doing, make an indirect hint to the browser that it should also 
strongly consider deferring the parsing. The spirit of that effort is to 
have less script parsing happening during the critical moments of initial 
page-load, for pages where that's an issue and for which they take steps to 
address that issue.


--Kyle

 

</PRE>




























<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030340.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
	<LI>Next message: <A HREF="030345.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30343">[ date ]</a>
              <a href="thread.html#30343">[ thread ]</a>
              <a href="subject.html#30343">[ subject ]</a>
              <a href="author.html#30343">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
