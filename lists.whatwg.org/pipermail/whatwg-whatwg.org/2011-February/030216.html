<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] HTML-to-plaintext conversion (innerText and	Selection.toString())
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML-to-plaintext%20conversion%20%28innerText%20and%0A%09Selection.toString%28%29%29&In-Reply-To=%3CAANLkTi%3DR_WaHhqcpyj2U3Vz4dYe3-%3DBVZO9sdcsTeDpz%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030210.html">
   <LINK REL="Next"  HREF="030232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] HTML-to-plaintext conversion (innerText and	Selection.toString())</H1>
<!--htdig_noindex-->
    <B>Tim Down</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20HTML-to-plaintext%20conversion%20%28innerText%20and%0A%09Selection.toString%28%29%29&In-Reply-To=%3CAANLkTi%3DR_WaHhqcpyj2U3Vz4dYe3-%3DBVZO9sdcsTeDpz%40mail.gmail.com%3E"
       TITLE="[whatwg] HTML-to-plaintext conversion (innerText and	Selection.toString())">timdown at gmail.com
       </A><BR>
    <I>Fri Feb  4 02:22:38 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="030210.html">[whatwg] HTML-to-plaintext conversion (innerText and	Selection.toString())
</A></li>
        <LI>Next message: <A HREF="030232.html">[whatwg] HTML-to-plaintext conversion (innerText and	Selection.toString())
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30216">[ date ]</a>
              <a href="thread.html#30216">[ thread ]</a>
              <a href="subject.html#30216">[ subject ]</a>
              <a href="author.html#30216">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 4 February 2011 01:25, Aryeh Gregor &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Simetrical+w3c at gmail.com</A>&gt; wrote:
&gt;<i> On Thu, Feb 3, 2011 at 4:41 PM, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at mit.edu</A>&gt; wrote:
</I>&gt;&gt;<i> And all I'm saying is that there are at least three pieces of data here:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1) &#160;innerText return value
</I>&gt;&gt;<i> 2) &#160;Selection.toString() return value
</I>&gt;&gt;<i> 3) &#160;What the browser actually copies
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> My point is that browsers must be free to modify #3 as desired. Dictating it
</I>&gt;&gt;<i> in a web spec, is not acceptable, imo.
</I>&gt;<i>
</I>&gt;<i> Sure.
</I>&gt;<i>
</I>&gt;&gt;<i> Agreed, I think; but should that be Selection.toString() or some other API?
</I>&gt;&gt;<i> &#160;That is are we hijacking Selection.toString() because it's convenient, or
</I>&gt;&gt;<i> because it's the right way to expose such an algorithm?
</I>&gt;<i>
</I>&gt;<i> innerText seems like a reasonable place to put such an API, if only
</I>&gt;<i> because WebKit already does it. &#160;It's not ideal a priori, but by the
</I>&gt;<i> consistency standards of the web platform it's not noticeably bad. &#160;I
</I>&gt;<i> should particularly point out that your typical author is not going to
</I>&gt;<i> have the foggiest notion of separation of DOM and CSS and so on -- it
</I>&gt;<i> will make intuitive sense to authors to have it at innerText as much
</I>&gt;<i> as anywhere.
</I>&gt;<i>
</I>&gt;<i> I did actually find a couple of sites that defined functions that
</I>&gt;<i> accepted an HTML string, created a div, assigned the HTML to the div's
</I>&gt;<i> innerHTML, and returned the innerText (or textContent if innerText is
</I>&gt;<i> unavailable):
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://api.opencast.naver.com/CS888/23">http://api.opencast.naver.com/CS888/23</A>
</I>&gt;<i> <A HREF="http://bbs.ptbus.com/thread-22143-1-1.html">http://bbs.ptbus.com/thread-22143-1-1.html</A>
</I>&gt;<i>
</I>&gt;<i> I didn't find what they were actually used for, though. &#160;Note that
</I>&gt;<i> this breaks if innerText doesn't work correctly for non-displayed
</I>&gt;<i> elements, so basically it will only do any prettification in IE.
</I>&gt;<i>
</I>&gt;&gt;<i> Depending on your definition of &quot;okay&quot;, yes. &#160;I mean... we have an &quot;okay&quot;
</I>&gt;&gt;<i> way that's interoperable now (I hope): Range.toString. &#160;Except you don't
</I>&gt;&gt;<i> think it does an okay job, clearly. &#160;I agree on that; I don't necessarily
</I>&gt;&gt;<i> agree that current browser Selection.toString does an &quot;okay&quot; job.
</I>&gt;<i>
</I>&gt;<i> Actually, if browsers are willing to converge on making innerText work
</I>&gt;<i> like textContent and Selection.toString() work like Range.toString(),
</I>&gt;<i> I'd be okay with that. &#160;There are use-cases for a standardized
</I>&gt;<i> plaintext conversion API, but at this point I think they're too
</I>&gt;<i> marginal to be worth the effort of actually specifying and
</I>&gt;<i> implementing. &#160;Such an API is inherently going to be either not very
</I>&gt;<i> good or unreasonably complicated. &#160;There's no reason at all that you
</I>&gt;<i> couldn't implement such an API in a JavaScript library -- I don't see
</I>&gt;<i> why it has to be part of the web platform.
</I>&gt;<i>
</I>&gt;<i> I've been told Opera doesn't care about this and will implement
</I>&gt;<i> whatever is specced as long as it's web-compatible and not too
</I>&gt;<i> complicated to be worth the effort. &#160;Gecko (at least that portion that
</I>&gt;<i> I'm talking to :) ) seems to be skeptical of implementing anything
</I>&gt;<i> very complicated here either. &#160;But Maciej has told me that WebKit
</I>&gt;<i> doesn't want to scrap its elaborate plaintext-conversion APIs (which
</I>&gt;<i> have by far the best fidelity of any browser's from what I see).
</I>&gt;<i>
</I>&gt;<i> So as I see it, the easiest solution would be for WebKit to agree to
</I>&gt;<i> move its APIs to prefixed versions if it wants to keep them, and
</I>&gt;<i> change behavior of the unprefixed ones to something like textContent.
</I>&gt;<i> (Possibly with minimal differences for web-compat -- Opera's behave
</I>&gt;<i> slightly differently, and IIRC I was told it's for web-compat
</I>&gt;<i> reasons.)
</I>&gt;<i>
</I>&gt;<i> On the other hand, if WebKit is unwilling to accept anything other
</I>&gt;<i> than a complicated plaintext conversion algorithm here, I don't think
</I>&gt;<i> we're going to have interop in the foreseeable future no matter what.
</I>&gt;<i> Even if it gets specced, no one will want to implement it. &#160;I'm not
</I>&gt;<i> clear on whether WebKit would be willing to implement a standardized
</I>&gt;<i> algorithm either, given the nonexistent web-compat issues. &#160;So in that
</I>&gt;<i> case I'd try to ask Microsoft, and unless they side with WebKit, we
</I>&gt;<i> can at least have everyone but WebKit converge on
</I>&gt;<i> innerText/Selection.toString() behaving as similarly to
</I>&gt;<i> textContent/Range.toString() as possible.
</I>&gt;<i>
</I>&gt;<i> How does that sound to everyone?
</I>
It sounds less than ideal to me. From the perspective of web
developer, that removes useful functionality. I'm not too bothered
about innerText, but it's not hard to come up with use cases for an
implementation of Selection.toString that returns the text that is
visually selected on the screen rather than the trivial concatenation
of calling toString on its Ranges. For example, a bookmarklet to
search the web for the text the user has selected in the current page,
or a tooltip that show content relating to the current selected text.
I don't think it's necessary to have perfect interoperability for this
to be useful: the current situation is not that bad, although IE9
worsens it since it implements the Range-toString-concatenation
approach that is in the current spec and is now being suggested again.
I also suspect that use of Selection.toString is fairly widespread and
browsers changing their implementation to this could break a lot of
pages.

Tim
</PRE>


























































































































































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030210.html">[whatwg] HTML-to-plaintext conversion (innerText and	Selection.toString())
</A></li>
	<LI>Next message: <A HREF="030232.html">[whatwg] HTML-to-plaintext conversion (innerText and	Selection.toString())
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30216">[ date ]</a>
              <a href="thread.html#30216">[ thread ]</a>
              <a href="subject.html#30216">[ subject ]</a>
              <a href="author.html#30216">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
