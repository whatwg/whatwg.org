<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] clarification for data-uris in window.open and SOP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20clarification%20for%20data-uris%20in%20window.open%20and%20SOP&In-Reply-To=%3CAANLkTi%3DGR_p1wf1M5juyWcGMob79PCbkBhqT2H1hB2Yb%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="030316.html">
   <LINK REL="Next"  HREF="072591.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] clarification for data-uris in window.open and SOP</H1>
<!--htdig_noindex-->
    <B>Diego Perini</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20clarification%20for%20data-uris%20in%20window.open%20and%20SOP&In-Reply-To=%3CAANLkTi%3DGR_p1wf1M5juyWcGMob79PCbkBhqT2H1hB2Yb%40mail.gmail.com%3E"
       TITLE="[whatwg] clarification for data-uris in window.open and SOP">diego.perini at gmail.com
       </A><BR>
    <I>Tue Feb  8 14:49:34 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="030316.html">[whatwg] clarification for data-uris in window.open and SOP
</A></li>
        <LI>Next message: <A HREF="072591.html">[whatwg] clarification for data-uris in window.open and SOP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#72590">[ date ]</a>
              <a href="thread.html#72590">[ thread ]</a>
              <a href="subject.html#72590">[ subject ]</a>
              <a href="author.html#72590">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, Feb 8, 2011 at 10:38 PM, Andreas G&#246;bel
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">andreas.goebel at typeofnan.com</A>&gt; wrote:
&gt;<i> Recently I needed to have some base64 encoded images to show in a new window. My first attempt was, to just pass the data:image/png;base64,&lt;data&gt; string as first argument from window.open().
</I>&gt;<i>
</I>&gt;<i> This works in all browsers that support data-uris, but it is terribly slowing down the browser when passing in images with a &quot;big&quot; filesize. My idea was to do something like this:
</I>&gt;<i>
</I>&gt;<i> var largeprev = window.open('data:text/html;charset=utf-8,' + escape('&lt;div/&gt;'), 'large'),
</I>&gt;<i> &#160; &#160;that &#160; &#160; &#160;= this;
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;largeprev.addEventListener('DOMContentLoaded', function(e) {
</I>&gt;<i> &#160; &#160; &#160; &#160;largeprev.alert('loaded');
</I>&gt;<i> &#160; &#160; &#160; &#160;largeprev.document.querySelectorAll('div')[0].appendChild(that);
</I>&gt;<i> &#160; &#160;}, false);
</I>&gt;<i> this works great in Firefox (3.6.x), but Chrome and Safari treat the returned DOMWindow object like it represents a foreign domain. Technically, it is not the same domain obviously since I'm passing in a data:text/html data-uri, but I would be shocked if the Same Origin Policy would deny an attempt like this ?
</I>&gt;<i>
</I>&gt;<i> What should be the correct behavior for this ?
</I>&gt;<i>
</I>&gt;<i> --Andy
</I>&gt;<i>
</I>&gt;<i>
</I>

If I recall correctly &quot;data:&quot; and &quot;javascript:&quot; resources should
inherit the &quot;document.domain&quot; from the environment in which they were
encountered. So there should be no SOP blocking in accessing these
resources.

I have had bad experience with Chrome too with the &quot;data:&quot; URI. You
can try to start the Chrome application using the
&quot;--allow-file-access-from-files&quot; command line switch and see if this
solves your problem.

Some of the things that can be done in all other browsers need that
special startup switch to enable the same behavior in Chrome.

--
Diego

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="030316.html">[whatwg] clarification for data-uris in window.open and SOP
</A></li>
	<LI>Next message: <A HREF="072591.html">[whatwg] clarification for data-uris in window.open and SOP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#72590">[ date ]</a>
              <a href="thread.html#72590">[ thread ]</a>
              <a href="subject.html#72590">[ subject ]</a>
              <a href="author.html#72590">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
