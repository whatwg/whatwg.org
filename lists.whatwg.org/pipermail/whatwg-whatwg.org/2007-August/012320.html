<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] The cross-document messaging APIs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=%5Bwhatwg%5D%20The%20cross-document%20messaging%20APIs&In-Reply-To=200707242036.08190.giecrilj%40stegny.2a.pl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012319.html">
   <LINK REL="Next"  HREF="012329.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] The cross-document messaging APIs</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=%5Bwhatwg%5D%20The%20cross-document%20messaging%20APIs&In-Reply-To=200707242036.08190.giecrilj%40stegny.2a.pl"
       TITLE="[whatwg] The cross-document messaging APIs">ian at hixie.ch
       </A><BR>
    <I>Wed Aug  8 17:51:36 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="012319.html">[whatwg] Cross-domain components
</A></li>
        <LI>Next message: <A HREF="012329.html">[whatwg] several messages about pushState() and related ideas
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12320">[ date ]</a>
              <a href="thread.html#12320">[ thread ]</a>
              <a href="subject.html#12320">[ subject ]</a>
              <a href="author.html#12320">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
I've moved the cross-document messaging API postMessage() to Window 
instead of Document. I haven't otherwise changed it. I know it's not what 
everyone wanted, but the various requests were somewhat incompatible so 
someone had to not get what they wanted. :-) In particular, I haven't 
change postMessage() to be on the source Window instead of the target 
Window, since we had implementation feedback in both directions.


On Tue, 10 Jul 2007, Jeff Walden wrote:
&gt;<i> 
</I>&gt;<i> First, on a less substantial note: I agree with the spec note that this 
</I>&gt;<i> API should be on Window (and change source's type to Window as well).  
</I>&gt;<i> There can be multiple documents associated with a Window, but the 
</I>&gt;<i> principal is the same for the entire bundle -- it's tied to the window, 
</I>&gt;<i> not to the document.
</I>
Done.


&gt;<i> Also, in my skim of Mozilla's Window implementation, it seems to contain 
</I>&gt;<i> far more of the methods with security considerations, whereas the 
</I>&gt;<i> HTMLDocument implementation contains fewer; I think concentrating the 
</I>&gt;<i> security-conscious methods in fewer locations and greater quantities is 
</I>&gt;<i> a good idea.
</I>
Agreed.


&gt;<i> (It would be nice if the XSS concern mentioned in the note were 
</I>&gt;<i> explained, because I'm not sure to what it refers, and it might 
</I>&gt;<i> conceivably affect my opinion here.)
</I>
I'm not sure what you're referring to here.


&gt;<i> Second: as currently specified, postMessage (section 6.4, cross-domain 
</I>&gt;<i> messaging), requires that an implementation &quot;punch&quot; a hole through its 
</I>&gt;<i> security specifically for calls to postMessage on windows (assuming it 
</I>&gt;<i> were moved to Window), as well as possibly for enumerating a window's 
</I>&gt;<i> properties, doing |&quot;postMessage&quot; in win| checks, and ensuring that 
</I>&gt;<i> |win.postMessage| doesn't refer to a function that |win| might have 
</I>&gt;<i> defined in a cu