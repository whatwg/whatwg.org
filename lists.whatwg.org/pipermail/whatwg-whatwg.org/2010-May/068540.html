<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] getElementById
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20getElementById&In-Reply-To=%3CDAD1B86B-E7FC-42AC-8F52-9CC58BABCA82%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="068538.html">
   <LINK REL="Next"  HREF="068541.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] getElementById</H1>
<!--htdig_noindex-->
    <B>Perry Smith</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20getElementById&In-Reply-To=%3CDAD1B86B-E7FC-42AC-8F52-9CC58BABCA82%40gmail.com%3E"
       TITLE="[whatwg] getElementById">pedzsan at gmail.com
       </A><BR>
    <I>Mon May 10 20:28:13 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="068538.html">[whatwg] getElementById
</A></li>
        <LI>Next message: <A HREF="068541.html">[whatwg] getElementById
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#68540">[ date ]</a>
              <a href="thread.html#68540">[ thread ]</a>
              <a href="subject.html#68540">[ subject ]</a>
              <a href="author.html#68540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On May 10, 2010, at 7:04 PM, Garrett Smith wrote:

&gt;<i> On Mon, May 10, 2010 at 4:55 PM, Perry Smith &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">pedzsan at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On May 10, 2010, at 5:12 PM, Garrett Smith wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On Mon, May 10, 2010 at 2:27 PM, Perry Smith &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">pedzsan at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> On May 10, 2010, at 3:06 PM, timeless wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> On Mon, May 10, 2010 at 9:10 PM, Perry Smith &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">pedzsan at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> I see places that explicitly state that the same object is returned on some operations.  For example, the element.style has that clause.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> I have not found in either html5 or the DOM documentation that is referenced an explicit statement to this effect for getElementById.
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> if someone changes the id value on the node you used to think about
</I>&gt;&gt;&gt;&gt;&gt;<i> and assigns it to another node then it most certainly will not return
</I>&gt;&gt;&gt;&gt;&gt;<i> the same node.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Yea, that is an interesting point.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> I wonder also if I change the id for the node to 'dog' and then do getElementById('dog') if it will give me back the same javascript object with newAttr set.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Careful, it might actually not be a native ECMAScript object that you
</I>&gt;&gt;&gt;<i> get back. A host object could be implemented as a native ECMAScript
</I>&gt;&gt;&gt;<i> object, as seen in many implementations, but, as seen in recent
</I>&gt;&gt;&gt;<i> discussions, MSIE &lt;= 8 has host objects that are not native objects
</I>&gt;&gt;&gt;<i> and that do throw errors.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> That is what I'm asking.  I can't find where that is allowed (in the spec) or not allowed in a conforming UA.
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Any DOM object is a host object in ECMAScript parlance and host
</I>&gt;<i> objects have great liberty.
</I>&gt;<i> 
</I>&gt;<i> Look how IE's shoddy catchall implementation of the styleSheets &quot;dhtml
</I>&gt;<i> collection&quot; blows up on numeric [[Get]] access:
</I>&gt;<i> 
</I>&gt;<i> alert(document.styleSheets[99999]); // Boom.
</I>&gt;<i> javascript: alert(document.styleSheets['a']); // OK
</I>&gt;<i> 
</I>&gt;<i> More indications on host objects in IE will show that they are not
</I>&gt;<i> native ECMAScript objects.
</I>&gt;<i> 
</I>&gt;<i> javascript: alert(document.body.valueOf); // undefined.
</I>&gt;<i> 
</I>&gt;<i> javascript: alert([].slice.call(document.childNodes)); // Boom.
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> I am not sure if I am making myself clear.  The question(s) boils down to, are these objects going to behave consistently as javascript objects.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> There are different ways the browser could implement the mapping from DOM elements to javascript objects.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> For example, the following code could fail and not give the alert box:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> foo = getElementById('foo');
</I>&gt;&gt;&gt;&gt;<i> foo.newAttr = 1;
</I>&gt;&gt;&gt;&gt;<i> if (foo.newAttr)
</I>&gt;&gt;&gt;&gt;<i>  alert(&quot;hi&quot;);
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> The setting of newAttr could simply not work at all.  The browser could throw it away.  There is nothing I see that says that it must work.  I say this because there are particular methods and attributes defined.  No mention is made of other attributes.  They could do anything including throw an exception, silently fail, or randomly do something else.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> The code attempts to assign a property, not an attribute.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Setting a property such as newAttr is not specified. If it throws an
</I>&gt;&gt;&gt;<i> error or does nothing, it is your fault.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Ok.  (Sorry for the incorrect use of terms.)  If setting a property is not specified, that means that a conforming UA can disallow setting properties.  Or it could silently ignore the attempt to set a property.  Is that what was intended?
</I>&gt;&gt;<i> 
</I>&gt;<i> Yes. An implementation can also throw errors with that. Nothing in
</I>&gt;<i> HTML 5 prevents that. Nothing in ECMAScript prevents that, for host
</I>&gt;<i> objects.
</I>&gt;<i> 
</I>&gt;<i> The browser can do whatever it wants with that property. Take a look
</I>&gt;<i> at MSIE document.expando.
</I>
Wow.  I happened to pull down the ECMAScript 5 doc this past weekend to understand exactly how an event handler is called.  html5 refers to functions defined in the ECMAScript doc.  But I've never heard of &quot;host objects&quot;.  The first hit in the EMCAScript 5 doc for host object tells all.  These guys did not learn from the mistakes of Pascal.  An utterly hopeless feeling came over me.

So, how about this?

As part of HTMLElement, have a defined bucket, maybe call it elementObject which is defined to be a native ECMAScript object.  If X denotes a particular DOM element, then X.elementObject is defined to return the same native ECMAScript object each time.  More details could be added perhaps to define how the object is created (i.e. which prototype to use, etc).  I'm thinking making it the same as {}.




</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="068538.html">[whatwg] getElementById
</A></li>
	<LI>Next message: <A HREF="068541.html">[whatwg] getElementById
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#68540">[ date ]</a>
              <a href="thread.html#68540">[ thread ]</a>
              <a href="subject.html#68540">[ subject ]</a>
              <a href="author.html#68540">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
