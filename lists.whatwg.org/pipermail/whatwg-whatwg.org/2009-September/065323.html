<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] LocalStorage in workers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20LocalStorage%20in%20workers&In-Reply-To=%3C5dd9e5c50909161536g20bd89a7k46dd5ac5a3a6947%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="065322.html">
   <LINK REL="Next"  HREF="065324.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] LocalStorage in workers</H1>
<!--htdig_noindex-->
    <B>Jeremy Orlow</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20LocalStorage%20in%20workers&In-Reply-To=%3C5dd9e5c50909161536g20bd89a7k46dd5ac5a3a6947%40mail.gmail.com%3E"
       TITLE="[whatwg] LocalStorage in workers">jorlow at chromium.org
       </A><BR>
    <I>Wed Sep 16 15:36:53 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="065322.html">[whatwg] LocalStorage in workers
</A></li>
        <LI>Next message: <A HREF="065324.html">[whatwg] LocalStorage in workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65323">[ date ]</a>
              <a href="thread.html#65323">[ thread ]</a>
              <a href="subject.html#65323">[ subject ]</a>
              <a href="author.html#65323">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Sep 16, 2009 at 3:32 PM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:

&gt;<i> On Wed, Sep 16, 2009 at 3:21 PM, Robert O'Callahan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; On Thu, Sep 17, 2009 at 9:56 AM, Jeremy Orlow &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jorlow at chromium.org</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; 1) Create a LocalStorage like API that can only be accessed in an async
</I>&gt;<i> &gt;&gt; way via pages (kind of like WebDatabase).
</I>&gt;<i> &gt;&gt; 2) Remove any
</I>&gt;<i> &gt;&gt; atomicity/consistency guarantees from synchronous LocalStorage access
</I>&gt;<i> within
</I>&gt;<i> &gt;&gt; pages (like IE8 currently does) and add an async interface for when
</I>&gt;<i> pages do
</I>&gt;<i> &gt;&gt; need atomicity/consistency.
</I>&gt;<i> &gt;&gt; 3) Come up with a completely different storage API that all the browser
</I>&gt;<i> &gt;&gt; vendors are willing to implement that only allows Async access from
</I>&gt;<i> within
</I>&gt;<i> &gt;&gt; pages.  WebSimpleDatabase might be a good starting point for this.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 4) Create WorkerStorage so that shared workers have exclusive,
</I>&gt;<i> synchronous
</I>&gt;<i> &gt; access to their own persistent storage via an API compatible with
</I>&gt;<i> &gt; LocalStorage.
</I>&gt;<i>
</I>&gt;<i> I think some of the use cases require that code running in Window
</I>&gt;<i> objects can access the same storage area though. Consider for example
</I>&gt;<i> an email web app that uses a WorkerStorage area for to store email
</I>&gt;<i> data locally (for performance and for offline support), and then uses
</I>&gt;<i> a worker to synchronize that with the server.
</I>&gt;<i>
</I>&gt;<i> Here the code running in the Window wants to access the storage in
</I>&gt;<i> order to render the emails in the page, and the worker wants to access
</I>&gt;<i> it to synchronize with the server.
</I>&gt;<i>
</I>&gt;<i> See my email earlier in this thread. If we change the name from
</I>&gt;<i> 'clientStorage' to 'workerStorage', while still allowing the main
</I>&gt;<i> window to asynchronously get a reference to the storage, then I think
</I>&gt;<i> that about matches what you're proposing (and what item 1 is
</I>&gt;<i> proposing).
</I>&gt;<i>
</I>
Code wise, what Robert suggested is MUCH simpler.  Almost for free in
WebKit.  Creating an asynchronous access method and exposing this in the
page is much more complex.  It also defeats the main purpose of LocalStorage
(which is to be a simple, light weight way to store data).

I certainly agree that having some shared memory format between workers and
pages would be good, and there's some use cases which would
certainly benefit, but most of the developers I've talked to so far were
mostly concerned about having _some_ form of storage and the shared memory
aspects were more nice to have.

J
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090916/57cf0fbd/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090916/57cf0fbd/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="065322.html">[whatwg] LocalStorage in workers
</A></li>
	<LI>Next message: <A HREF="065324.html">[whatwg] LocalStorage in workers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65323">[ date ]</a>
              <a href="thread.html#65323">[ thread ]</a>
              <a href="subject.html#65323">[ subject ]</a>
              <a href="author.html#65323">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
