<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Application defined &quot;locks&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Application%20defined%20%22locks%22&In-Reply-To=%3Cbd8f24d20909092154j6d451c9bq5d7088972febde65%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="065105.html">
   <LINK REL="Next"  HREF="065094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Application defined &quot;locks&quot;</H1>
<!--htdig_noindex-->
    <B>Darin Fisher</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Application%20defined%20%22locks%22&In-Reply-To=%3Cbd8f24d20909092154j6d451c9bq5d7088972febde65%40mail.gmail.com%3E"
       TITLE="[whatwg] Application defined &quot;locks&quot;">darin at chromium.org
       </A><BR>
    <I>Wed Sep  9 21:54:49 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="065105.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
        <LI>Next message: <A HREF="065094.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65109">[ date ]</a>
              <a href="thread.html#65109">[ thread ]</a>
              <a href="subject.html#65109">[ subject ]</a>
              <a href="author.html#65109">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Sep 9, 2009 at 9:28 PM, Robert O'Callahan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt;wrote:

&gt;<i> On Thu, Sep 10, 2009 at 4:11 PM, Darin Fisher &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">darin at chromium.org</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Wed, Sep 9, 2009 at 9:07 PM, Robert O'Callahan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A>&gt;wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Thu, Sep 10, 2009 at 3:53 PM, Darin Fisher &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">darin at chromium.org</A>&gt;wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> What concerns me are the cases where synchronous events (e.g., resizing
</I>&gt;&gt;&gt;&gt;<i> an iframe) can cause script to execute in another domain.  As spec'd, there
</I>&gt;&gt;&gt;&gt;<i> is a potential dead lock with the storage mutex.  We must carefully unlock
</I>&gt;&gt;&gt;&gt;<i> in situations like this.  However, such unlocking will appear quite
</I>&gt;&gt;&gt;&gt;<i> mysterious to users, so much so that I question the value of the implicit
</I>&gt;&gt;&gt;&gt;<i> storage mutex.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Right now I'm not sure how big a problem this actually is. The resize
</I>&gt;&gt;&gt;<i> event for a document in a frame can surely be dispatched asynchronously so
</I>&gt;&gt;&gt;<i> no unlocking is required. I would like to have a much better idea of how
</I>&gt;&gt;&gt;<i> many places absolutely must release the storage mutex before deciding that
</I>&gt;&gt;&gt;<i> approach is unworkable.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Rob
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What about navigating an iframe to a reference fragment, which could
</I>&gt;&gt;<i> trigger a scroll event?  The scrolling has to be done synchronously for
</I>&gt;&gt;<i> compat with the web.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The scrolling itself may have to be synchronous, at least as far as
</I>&gt;<i> updating scrollLeft/scrollTop if not visually ... but in this case the
</I>&gt;<i> script execution in the frame would be an onscroll event handler, right?
</I>&gt;<i> That's asynchronous in Gecko.
</I>&gt;<i>
</I>
Interesting.  Gecko seems to be the odd man out there.  Both MSHTML and
WebKit dispatch the onscroll event handler synchronously.  Maybe my
assertion about that being important for web compat was overreaching.

At any rate, this should at least give us pause.  There could be other ways
in which script execution across domains could be nested :-/

-Darin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090909/5085a94c/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090909/5085a94c/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="065105.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
	<LI>Next message: <A HREF="065094.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65109">[ date ]</a>
              <a href="thread.html#65109">[ thread ]</a>
              <a href="subject.html#65109">[ subject ]</a>
              <a href="author.html#65109">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
