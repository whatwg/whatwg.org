<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Web%20Storage%3A%20structured%20clones%20lead%20to%20ambiguity%20in%0A%09detecting%20if%20a%20key%20is%20set%20w/%20getItem%28%29&In-Reply-To=%3Cbbaeab100909231119q1ab7a793v55f7f396da4a2b2d%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023147.html">
   <LINK REL="Next"  HREF="023150.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()</H1>
<!--htdig_noindex-->
    <B>Brett Cannon</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Web%20Storage%3A%20structured%20clones%20lead%20to%20ambiguity%20in%0A%09detecting%20if%20a%20key%20is%20set%20w/%20getItem%28%29&In-Reply-To=%3Cbbaeab100909231119q1ab7a793v55f7f396da4a2b2d%40mail.gmail.com%3E"
       TITLE="[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()">brett at python.org
       </A><BR>
    <I>Wed Sep 23 11:19:43 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="023147.html">[whatwg] Fwd: [gears-users] Version in manifest is not enough
</A></li>
        <LI>Next message: <A HREF="023150.html">[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23149">[ date ]</a>
              <a href="thread.html#23149">[ thread ]</a>
              <a href="subject.html#23149">[ subject ]</a>
              <a href="author.html#23149">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Before the move to structured clones one could tell if a key was set
by calling getItem() and seeing if it returned null (had to use === as
someone could have called setItem() w/ null, but that would be coerced
to a string for storage). But with the latest draft's switch to
structured clones that test no longer clearly differentiates between
whether the value returned by getItem() signifies that the key was not
set, or the key was set with the value null.

As written right now the only way to detect if a key was truly set is
to iterate through all of them with 'length' and key(). Perhaps a
contains() function that returns true/false based on whether the key
is set is warranted? Otherwise you could do something like Python's
get() method on dicts where an optional second argument is provided to
getItem() which is returned only if the key is not set, allowing a
user-provided object represent a key not existing w/ ===.

And since I just subscribed to the mailing list, I was wondering if
the whole workers/localStorage discussion ended or not, as I can
provide a (potentially minor) real-world use-case for sharing access
between the page and worker if people want to hear it (in a new email
of course).

-Brett
</PRE>






















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023147.html">[whatwg] Fwd: [gears-users] Version in manifest is not enough
</A></li>
	<LI>Next message: <A HREF="023150.html">[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23149">[ date ]</a>
              <a href="thread.html#23149">[ thread ]</a>
              <a href="subject.html#23149">[ subject ]</a>
              <a href="author.html#23149">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
