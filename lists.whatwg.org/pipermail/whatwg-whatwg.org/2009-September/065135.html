<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Application defined &quot;locks&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Application%20defined%20%22locks%22&In-Reply-To=%3CB39DB07D-F79F-4793-A7FA-1BBE44F2F1D2%40apple.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="065134.html">
   <LINK REL="Next"  HREF="065138.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Application defined &quot;locks&quot;</H1>
<!--htdig_noindex-->
    <B>Oliver Hunt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Application%20defined%20%22locks%22&In-Reply-To=%3CB39DB07D-F79F-4793-A7FA-1BBE44F2F1D2%40apple.com%3E"
       TITLE="[whatwg] Application defined &quot;locks&quot;">oliver at apple.com
       </A><BR>
    <I>Thu Sep 10 13:08:25 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="065134.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
        <LI>Next message: <A HREF="065138.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65135">[ date ]</a>
              <a href="thread.html#65135">[ thread ]</a>
              <a href="subject.html#65135">[ subject ]</a>
              <a href="author.html#65135">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On Sep 10, 2009, at 12:55 PM, Darin Fisher wrote:

&gt;<i> On Thu, Sep 10, 2009 at 12:32 PM, Maciej Stachowiak &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">mjs at apple.com</A>&gt;  
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> On Sep 10, 2009, at 11:22 AM, Michael Nordman wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, Sep 9, 2009 at 7:55 PM, Robert O'Callahan &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">robert at ocallahan.org</A> 
</I>&gt;&gt;<i> &gt; wrote:
</I>&gt;&gt;<i> On Thu, Sep 10, 2009 at 2:38 PM, Michael Nordman  
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">michaeln at google.com</A>&gt; wrote:
</I>&gt;&gt;<i> If this feature existed, we likely would have used it for offline  
</I>&gt;&gt;<i> Gmail to coordinate which instance of the app (page with gmail in  
</I>&gt;&gt;<i> it) should be responsible for sync'ing the local database with the  
</I>&gt;&gt;<i> mail service. In the absence of a feature like this, instead we  
</I>&gt;&gt;<i> used the local database itself to register which page was the  
</I>&gt;&gt;<i> 'syncagent'. This involved periodically updating the db by the  
</I>&gt;&gt;<i> syncagent, and periodic polling by the would be syncagents waiting  
</I>&gt;&gt;<i> to possibly take over. Much ugliness.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> var isSyncAgent = false;
</I>&gt;&gt;<i> window.acquireFlag(&quot;syncAgency&quot;, function() { isSyncAgent = true; });
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Much nicer.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> How do you deal with the user closing the syncagent while other app  
</I>&gt;&gt;<i> instances remain open?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In our db polling world... that was why the syncagent periodically  
</I>&gt;&gt;<i> updated the db... to say &quot;still alive&quot;... on close it would say  
</I>&gt;&gt;<i> &quot;i'm gone&quot; and on ugly exit, the others would notice the lack of  
</I>&gt;&gt;<i> &quot;still alives&quot; and fight about who was it next. A silly bunch of  
</I>&gt;&gt;<i> complexity for something so simple.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In the acquireFlag world... wouldn't the page going away simply  
</I>&gt;&gt;<i> relinquish the flag?
</I>&gt;<i>
</I>&gt;<i> How would the pages that failed to acquire it before know that they  
</I>&gt;<i> should try to acquire it again? Presumably they would still have to  
</I>&gt;<i> poll (assuming the &quot;tryLock&quot; model).
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Maciej
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> In my proposed interace, you can wait asynchronously for the lock.   
</I>&gt;<i> Just call acquireLock with a second parameter, a closure that runs  
</I>&gt;<i> once you get the lock.
</I>
What if you don't want to wait asynchronously?  My reading of this is  
that you need two copies of the code, one that works synchronously,  
but you still need to keep the asynchronous model to deal with an  
inability to synchronously acquire the lock.  What am I missing?

&gt;<i> -Darin
</I>
--Oliver

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090910/77f0f99d/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090910/77f0f99d/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="065134.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
	<LI>Next message: <A HREF="065138.html">[whatwg] Application defined &quot;locks&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65135">[ date ]</a>
              <a href="thread.html#65135">[ thread ]</a>
              <a href="subject.html#65135">[ subject ]</a>
              <a href="author.html#65135">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
