<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Storage mutex and cookies can lead to browser deadlock
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Storage%20mutex%20and%20cookies%20can%20lead%20to%20browser%20deadlock&In-Reply-To=%3C11e306600909011848u1e5c2770p9723b06bf1a94952%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="064815.html">
   <LINK REL="Next"  HREF="064826.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Storage mutex and cookies can lead to browser deadlock</H1>
<!--htdig_noindex-->
    <B>Robert O'Callahan</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Storage%20mutex%20and%20cookies%20can%20lead%20to%20browser%20deadlock&In-Reply-To=%3C11e306600909011848u1e5c2770p9723b06bf1a94952%40mail.gmail.com%3E"
       TITLE="[whatwg] Storage mutex and cookies can lead to browser deadlock">robert at ocallahan.org
       </A><BR>
    <I>Tue Sep  1 18:48:11 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="064815.html">[whatwg] Storage mutex and cookies can lead to browser deadlock
</A></li>
        <LI>Next message: <A HREF="064826.html">[whatwg] Storage mutex and cookies can lead to browser deadlock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64822">[ date ]</a>
              <a href="thread.html#64822">[ thread ]</a>
              <a href="subject.html#64822">[ subject ]</a>
              <a href="author.html#64822">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Sep 2, 2009 at 11:31 AM, Jeremy Orlow &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jorlow at chromium.org</A>&gt; wrote:

&gt;<i> Does the silence mean that no one has any intention of implementing this?
</I>&gt;<i>
</I>
I'm silent because I'm not currently working on this stuff so I can't say
what our plans are. But I'll be upset if I find out our plans are to break
the single-threaded model.

Alternatively, we could make it so that each statement is atomic, but that
&gt;<i> you have to use such a mechanism for anything more complicated. For example:
</I>&gt;<i>
</I>&gt;<i> localStorage.accountBalance = localStorage.accountBalance + accountDelta;
</I>&gt;<i>  // It's atomic, so no worries!
</I>&gt;<i> var balance = localStorage.accountBalance;  /* Oh no!!!!  This isn't safe
</I>&gt;<i> since it's implemented via multiple statements... */
</I>&gt;<i> localStorage.accountBalance = balance + accountDelta;  /* ....we should
</I>&gt;<i> have used localStorage.executeAtomic! */
</I>&gt;<i>
</I>&gt;<i> Such ideas would definitely lighten lock contention and possibly eliminate
</I>&gt;<i> the need for yieldForStorageUpdates (formerly getStorageUpdates).  Another
</I>&gt;<i> major bonus is that it'd allow us to expose localStorage to workers again,
</I>&gt;<i> which is one of the top complaints I've gotten when talking to web
</I>&gt;<i> developers about localStorage.
</I>&gt;<i>
</I>&gt;<i>
</I>Making what should be (and always have been) meaning-preserving
transformations like splitting one JS statement into two no longer
meaning-preserving --- and in a non-testable way, to boot --- seems like a
pretty bad idea to me.


I know this is radical stuff, but the way things are speced currently just
&gt;<i> are not practical.
</I>&gt;<i>
</I>
I think that expecting Web developers to reason about concurrency and race
conditions is not practical.

Rob
-- 
&quot;He was pierced for our transgressions, he was crushed for our iniquities;
the punishment that brought us peace was upon him, and by his wounds we are
healed. We all, like sheep, have gone astray, each of us has turned to his
own way; and the LORD has laid on him the iniquity of us all.&quot; [Isaiah
53:5-6]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090902/045e3f6d/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090902/045e3f6d/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="064815.html">[whatwg] Storage mutex and cookies can lead to browser deadlock
</A></li>
	<LI>Next message: <A HREF="064826.html">[whatwg] Storage mutex and cookies can lead to browser deadlock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#64822">[ date ]</a>
              <a href="thread.html#64822">[ thread ]</a>
              <a href="subject.html#64822">[ subject ]</a>
              <a href="author.html#64822">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
