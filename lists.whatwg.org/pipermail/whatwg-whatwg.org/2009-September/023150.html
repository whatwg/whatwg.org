<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Web%20Storage%3A%20structured%20clones%20lead%20to%20ambiguity%20in%0A%09detecting%20if%20a%20key%20is%20set%20w/%20getItem%28%29&In-Reply-To=%3Cdd0fbad0909231130h5d9409bdo3ce90c7b1b013c88%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023149.html">
   <LINK REL="Next"  HREF="023152.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()</H1>
<!--htdig_noindex-->
    <B>Tab Atkins Jr.</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Web%20Storage%3A%20structured%20clones%20lead%20to%20ambiguity%20in%0A%09detecting%20if%20a%20key%20is%20set%20w/%20getItem%28%29&In-Reply-To=%3Cdd0fbad0909231130h5d9409bdo3ce90c7b1b013c88%40mail.gmail.com%3E"
       TITLE="[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()">jackalmage at gmail.com
       </A><BR>
    <I>Wed Sep 23 11:30:43 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="023149.html">[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
</A></li>
        <LI>Next message: <A HREF="023152.html">[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23150">[ date ]</a>
              <a href="thread.html#23150">[ thread ]</a>
              <a href="subject.html#23150">[ subject ]</a>
              <a href="author.html#23150">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Sep 23, 2009 at 1:19 PM, Brett Cannon &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">brett at python.org</A>&gt; wrote:
&gt;<i> Before the move to structured clones one could tell if a key was set
</I>&gt;<i> by calling getItem() and seeing if it returned null (had to use === as
</I>&gt;<i> someone could have called setItem() w/ null, but that would be coerced
</I>&gt;<i> to a string for storage). But with the latest draft's switch to
</I>&gt;<i> structured clones that test no longer clearly differentiates between
</I>&gt;<i> whether the value returned by getItem() signifies that the key was not
</I>&gt;<i> set, or the key was set with the value null.
</I>&gt;<i>
</I>&gt;<i> As written right now the only way to detect if a key was truly set is
</I>&gt;<i> to iterate through all of them with 'length' and key(). Perhaps a
</I>&gt;<i> contains() function that returns true/false based on whether the key
</I>&gt;<i> is set is warranted? Otherwise you could do something like Python's
</I>&gt;<i> get() method on dicts where an optional second argument is provided to
</I>&gt;<i> getItem() which is returned only if the key is not set, allowing a
</I>&gt;<i> user-provided object represent a key not existing w/ ===.
</I>&gt;<i>
</I>&gt;<i> And since I just subscribed to the mailing list, I was wondering if
</I>&gt;<i> the whole workers/localStorage discussion ended or not, as I can
</I>&gt;<i> provide a (potentially minor) real-world use-case for sharing access
</I>&gt;<i> between the page and worker if people want to hear it (in a new email
</I>&gt;<i> of course).
</I>
The second method (optional second argument) is definitely the correct
one.  Common Lisp deals with similar issues by *returning* a second
value which is a boolean reflecting whether the key was in the hash
(and was simply set to the default value) or was missing (and thus the
default value was returned).  However, multiple return values isn't a
pattern used by most languages, so a second argument that switches the
function into returning the was-it-there bool is correct.

~TJ
</PRE>






















<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023149.html">[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
</A></li>
	<LI>Next message: <A HREF="023152.html">[whatwg] Web Storage: structured clones lead to ambiguity in	detecting if a key is set w/ getItem()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23150">[ date ]</a>
              <a href="thread.html#23150">[ thread ]</a>
              <a href="subject.html#23150">[ subject ]</a>
              <a href="author.html#23150">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
