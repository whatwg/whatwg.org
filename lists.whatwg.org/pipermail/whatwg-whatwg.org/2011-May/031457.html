<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal to remove a paragraph from canvas spec
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20to%20remove%20a%20paragraph%20from%20canvas%20spec&In-Reply-To=%3CD2E08C12-27F2-499A-B32D-B8F7AB767FCB%40apple.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="073794.html">
   <LINK REL="Next"  HREF="073732.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal to remove a paragraph from canvas spec</H1>
<!--htdig_noindex-->
    <B>Matthew Delaney</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20to%20remove%20a%20paragraph%20from%20canvas%20spec&In-Reply-To=%3CD2E08C12-27F2-499A-B32D-B8F7AB767FCB%40apple.com%3E"
       TITLE="[whatwg] Proposal to remove a paragraph from canvas spec">mdelaney at apple.com
       </A><BR>
    <I>Tue May  3 19:08:24 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="073794.html">[whatwg] Control over selection direction
</A></li>
        <LI>Next message: <A HREF="073732.html">[whatwg] Proposal to remove a paragraph from canvas spec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31457">[ date ]</a>
              <a href="thread.html#31457">[ thread ]</a>
              <a href="subject.html#31457">[ subject ]</a>
              <a href="author.html#31457">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>The paragraph in the canvas spec that reads...
&quot;Shadows are only drawn if the opacity component of the alpha component of the color of shadowColor is non-zero and either the shadowBlur is non-zero, or the shadowOffsetX is non-zero, or the shadowOffsetY is non-zero.&quot;
&#8230;I've found must have been modeled after a bug originally from CoreGraphics. As you can see in this simple animation of a shadow blur being reduced from 20 down to 0, this &quot;edge case&quot; outlined in the above paragraph produces undesirable behavior at the end of the animation: <A HREF="http://webstuff.nfshost.com/shadowblur.html">http://webstuff.nfshost.com/shadowblur.html</A>

This outlined edge case really only affects a particular case of when the composite operation is set to destination-atop, which should result in the shadow landing &quot;on top of&quot; its source, and both the offsets and blur are of course 0. In the animation sample linked above, this case is the end state of the animation (the rect turning all blue all of a sudden).

Since:
1) This behavior is obviously not ideal (see the linked animation above) and is really just a bug
2) I can't imagine this particular edge case popping up all that often (think: using destination-atop and having both the shadow offsets and the blur 0 so that the shadow would otherwise be totally eclipsed by the source?)
3) The only major browsers I've found to support this edge case are Firefox4 (but not versions less than 4) and CG/Skia ports of WebKit browsers (because this is where the bug originated)
...I'm proposing this:
1) Strip out this edge case paragraph in the spec (yay, cleaner spec!)
2) Notify Firefox team that they should strip out this hack in their code for the edge case.
3) Quickly fix WebKit ports
4) File a bug against CG on this faulty behavior (just did that) and hope that it can be fixed in future releases.
5) Ask philip/W3C nicely to update his/the test at <A HREF="http://philip.html5.org/tests/canvas/suite/tests/2d.shadow.enable.off.2.html">http://philip.html5.org/tests/canvas/suite/tests/2d.shadow.enable.off.2.html</A> / <A HREF="http://w3c-test.org/html/tests/approved/canvas/2d.shadow.enable.off.2.html">http://w3c-test.org/html/tests/approved/canvas/2d.shadow.enable.off.2.html</A>

I also posted more info here: <A HREF="https://bugs.webkit.org/show_bug.cgi?id=60091">https://bugs.webkit.org/show_bug.cgi?id=60091</A>

I realize this is somewhat nit-picky, but it's clearly a bug (unless I'm missing something obvious) that I think we can all quickly rectify. Additionally, I've found a handful of other similar things in the canvas spec that I will write about shortly, but wanted to test the waters of emailing this list first to see how hard it is to push this &quot;easier&quot; issue. ;-)

--Matt Delaney
</PRE>


















































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="073794.html">[whatwg] Control over selection direction
</A></li>
	<LI>Next message: <A HREF="073732.html">[whatwg] Proposal to remove a paragraph from canvas spec
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31457">[ date ]</a>
              <a href="thread.html#31457">[ thread ]</a>
              <a href="subject.html#31457">[ subject ]</a>
              <a href="author.html#31457">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
