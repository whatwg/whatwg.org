<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] &lt;video&gt; ... &lt;script&gt; race condition
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Cvideo%3E%20...%20%3Cscript%3E%20race%20condition&In-Reply-To=%3Cop.vvkb0hacidj3kv%40device-56497e%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031651.html">
   <LINK REL="Next"  HREF="031660.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] &lt;video&gt; ... &lt;script&gt; race condition</H1>
<!--htdig_noindex-->
    <B>Simon Pieters</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Cvideo%3E%20...%20%3Cscript%3E%20race%20condition&In-Reply-To=%3Cop.vvkb0hacidj3kv%40device-56497e%3E"
       TITLE="[whatwg] &lt;video&gt; ... &lt;script&gt; race condition">simonp at opera.com
       </A><BR>
    <I>Mon May 16 00:20:31 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="031651.html">[whatwg] &lt;video&gt; ... &lt;script&gt; race condition
</A></li>
        <LI>Next message: <A HREF="031660.html">[whatwg] &lt;video&gt; ... &lt;script&gt; race condition
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31652">[ date ]</a>
              <a href="thread.html#31652">[ thread ]</a>
              <a href="subject.html#31652">[ subject ]</a>
              <a href="author.html#31652">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Sun, 15 May 2011 19:11:09 +0200, Glenn Maynard &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">glenn at zewt.org</A>&gt; wrote:

&gt;<i> On Sat, May 14, 2011 at 11:49 AM, Eric Carlson  
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">eric.carlson at apple.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>  It seems to me that the right way to &quot;fix&quot; the problem is let people  
</I>&gt;&gt;<i> know
</I>&gt;&gt;<i> it is sloppy code, not to figure out a way to work around it.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The basic problem is that it isn't sloppy code: it's correct for almost  
</I>&gt;<i> all
</I>&gt;<i> events.  It's just wrong for events that are fired as part of loading,  
</I>&gt;<i> which
</I>&gt;<i> is what makes it so easy to get wrong.  It also means that these events
</I>&gt;<i> don't work well with deferred scripts.
</I>&gt;<i>
</I>&gt;<i> For the simple cases I'd probably do:
</I>&gt;<i>
</I>&gt;<i> video.addEventListener(&quot;canplay&quot;, func, false);
</I>&gt;<i> if(video.readyState &gt;= HAVE_FUTURE_DATA)
</I>&gt;<i>     func.apply(video); // missed the first one
</I>
The state can have changed before the event has actually fired, since  
state changes are sync but the events are queued. So if the script happens  
to run in between then func is run twice. See  
<A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=12267">http://www.w3.org/Bugs/Public/show_bug.cgi?id=12267</A>

-- 
Simon Pieters
Opera Software
</PRE>














































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031651.html">[whatwg] &lt;video&gt; ... &lt;script&gt; race condition
</A></li>
	<LI>Next message: <A HREF="031660.html">[whatwg] &lt;video&gt; ... &lt;script&gt; race condition
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31652">[ date ]</a>
              <a href="thread.html#31652">[ thread ]</a>
              <a href="subject.html#31652">[ subject ]</a>
              <a href="author.html#31652">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
