<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposal for separating script downloads and execution
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20separating%20script%20downloads%20and%20execution&In-Reply-To=%3CBANLkTi%3D1Wsm8LdZrmzg6j-ze-P_5G19C-Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031833.html">
   <LINK REL="Next"  HREF="031839.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposal for separating script downloads and execution</H1>
<!--htdig_noindex-->
    <B>James Robinson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposal%20for%20separating%20script%20downloads%20and%20execution&In-Reply-To=%3CBANLkTi%3D1Wsm8LdZrmzg6j-ze-P_5G19C-Q%40mail.gmail.com%3E"
       TITLE="[whatwg] Proposal for separating script downloads and execution">jamesr at google.com
       </A><BR>
    <I>Thu May 26 16:04:05 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="031833.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
        <LI>Next message: <A HREF="031839.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31834">[ date ]</a>
              <a href="thread.html#31834">[ thread ]</a>
              <a href="subject.html#31834">[ subject ]</a>
              <a href="author.html#31834">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, May 26, 2011 at 3:49 PM, Aryeh Gregor &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Simetrical+w3c at gmail.com</A>&gt;wrote:

&gt;<i> On Thu, May 26, 2011 at 11:56 AM, Nicholas Zakas &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">nzakas at yahoo-inc.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; I'm a little surprised that this conversation has swooped back around to
</I>&gt;<i> performance and whether or not there's a valid use case here. In addition to
</I>&gt;<i> standalone solutions like Steve's ControlJS and Kyle's LABjs, the Mozilla
</I>&gt;<i> and Chrome teams were also trying to come up with solutions to enable
</I>&gt;<i> preloading of JavaScript. What I was hoping for was a consolidation of the
</I>&gt;<i> efforts rather than a discussion as to whether or not such efforts should
</I>&gt;<i> continue.
</I>&gt;<i>
</I>&gt;<i> The question isn't whether or not such efforts should continue, it's
</I>&gt;<i> whether any features need to be added to web standards to help the
</I>&gt;<i> efforts continue.  This is a web standards discussion list, after all,
</I>&gt;<i> not a list about user JavaScript library development, or browser
</I>&gt;<i> implementation.  If it turns out that the libraries can be developed
</I>&gt;<i> just fine with existing standard features, like perhaps if browsers
</I>&gt;<i> improve &lt;script async&gt; handling, then no further discussion is needed
</I>&gt;<i> here.
</I>&gt;<i>
</I>&gt;<i> &gt; Moving parts of the JavaScript download/execution process doesn't allow
</I>&gt;<i> me to control when that script will be executed, which as I mentioned in a
</I>&gt;<i> previous email, is really the crux of the issue.
</I>&gt;<i>
</I>&gt;<i> So now we're back to the question of, why can't you just wrap all the
</I>&gt;<i> code in a function, put the function in a &lt;script async&gt;, and not
</I>&gt;<i> execute the function until you want the code to execute?  This is
</I>&gt;<i> assuming that future browsers parse/preprocess/whatever &lt;script async&gt;
</I>&gt;<i> on a background thread.
</I>&gt;<i>
</I>
This isn't practical if the contents of the &lt;script&gt; are not under the
author's direct control.  For example, an author that wanted to use jquery
would create a &lt;script&gt; tag with the src set to one of the popular jquery
mirrors (to maximize the chance of the resource being cached), but then have
no control over when the script actually evaluated.  It's easy to imagine a
case where the author wants to initiate the network load as soon as possible
but might not need to actually start using the code until some point further
along in the loading sequence, possibly after a simple form of the page is
made visible to the user.

For this use case I think it would be handy to have a way to express &quot;please
download this script but do not start evaluating it until I'm ready&quot;.  As a
straw man, what about using the disable attribute?  When the load completes,
if the disabled attribute is set then the script is not evaluated until the
disabled attribute is unset.  After the script evaluates it goes into a
state where the disabled attribute is ignored.  Browsers that ignored this
behavior would evaluate the script sooner than the author might expect, but
it's usually every easy to detect when this is happening and react
appropriately.

- James
</PRE>








<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031833.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
	<LI>Next message: <A HREF="031839.html">[whatwg] Proposal for separating script downloads and execution
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31834">[ date ]</a>
              <a href="thread.html#31834">[ thread ]</a>
              <a href="subject.html#31834">[ subject ]</a>
              <a href="author.html#31834">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
