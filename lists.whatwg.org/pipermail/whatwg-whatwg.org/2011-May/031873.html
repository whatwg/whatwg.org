<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] websocket onerror Re: [html5] r6156 - [giow] (0) Update all the WebSocket terminology to match the next WSP draft.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20websocket%20onerror%20Re%3A%20%5Bhtml5%5D%20r6156%20-%20%5Bgiow%5D%20%280%29%20Update%0A%20all%20the%20WebSocket%20terminology%20to%20match%20the%20next%20WSP%20draft.&In-Reply-To=%3Cop.vwc94bn5idj3kv%40simon-pieterss-macbook.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031869.html">
   <LINK REL="Next"  HREF="074147.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] websocket onerror Re: [html5] r6156 - [giow] (0) Update all the WebSocket terminology to match the next WSP draft.</H1>
<!--htdig_noindex-->
    <B>Simon Pieters</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20websocket%20onerror%20Re%3A%20%5Bhtml5%5D%20r6156%20-%20%5Bgiow%5D%20%280%29%20Update%0A%20all%20the%20WebSocket%20terminology%20to%20match%20the%20next%20WSP%20draft.&In-Reply-To=%3Cop.vwc94bn5idj3kv%40simon-pieterss-macbook.local%3E"
       TITLE="[whatwg] websocket onerror Re: [html5] r6156 - [giow] (0) Update all the WebSocket terminology to match the next WSP draft.">simonp at opera.com
       </A><BR>
    <I>Tue May 31 15:30:01 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="031869.html">[whatwg] Improving the Application Cache
</A></li>
        <LI>Next message: <A HREF="074147.html">[whatwg] websocket onerror Re: [html5] r6156 - [giow] (0) Update all the WebSocket terminology to match the next WSP draft.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31873">[ date ]</a>
              <a href="thread.html#31873">[ thread ]</a>
              <a href="subject.html#31873">[ subject ]</a>
              <a href="author.html#31873">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Sat, 28 May 2011 01:31:53 +0200, &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A>&gt; wrote:

&gt;<i> Author: ianh
</I>&gt;<i> Date: 2011-05-27 16:31:52 -0700 (Fri, 27 May 2011)
</I>&gt;<i> New Revision: 6156
</I>&gt;<i>
</I>&gt;<i> Modified:
</I>&gt;<i>    complete.html
</I>&gt;<i>    index
</I>&gt;<i>    source
</I>&gt;<i> Log:
</I>&gt;<i> [giow] (0) Update all the WebSocket terminology to match the next WSP  
</I>&gt;<i> draft.
</I>

&gt;<i> Modified: source
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- source	2011-05-27 21:52:47 UTC (rev 6155)
</I>&gt;<i> +++ source	2011-05-27 23:31:52 UTC (rev 6156)
</I>&gt;<i> @@ -2500,11 +2500,25 @@
</I>&gt;<i>    &lt;/dd&gt;
</I>&gt;<i> +   &lt;dt&gt;Cookies&lt;/dt&gt;
</I>&gt;<i> +
</I>&gt;<i> +   &lt;dd&gt;
</I>&gt;<i> +
</I>&gt;<i> +    &lt;p&gt;The following term is defined in the Cookie specification: &lt;a
</I>&gt;<i> +    href=&quot;#refsCOOKIES&quot;&gt;[COOKIES]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> +
</I>&gt;<i> +    &lt;ul class=&quot;brief&quot;&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;Receives a set-cookie-string&lt;/dfn&gt;
</I>&gt;<i> +    &lt;/ul&gt;
</I>&gt;<i> +
</I>&gt;<i> +   &lt;/dd&gt;
</I>&gt;<i> +
</I>&gt;<i>     &lt;dt&gt;CORS&lt;/dt&gt;
</I>&gt;<i>    &lt;dd&gt;
</I>&gt;<i> -    &lt;p&gt;The following terms are defined in the CORS specification:&lt;/p&gt;
</I>&gt;<i> +    &lt;p&gt;The following terms are defined in the CORS specification: &lt;a
</I>&gt;<i> +    href=&quot;#refsCORS&quot;&gt;[CORS]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i>     &lt;ul class=&quot;brief&quot;&gt;
</I>&gt;<i>       &lt;li&gt;&lt;dfn&gt;cross-origin request&lt;/dfn&gt;
</I>&gt;<i> @@ -2545,6 +2559,42 @@
</I>&gt;<i>    &lt;/dd&gt;
</I>&gt;<i> +&lt;!--END html--&gt;&lt;!--END dev-html--&gt;&lt;!--END w3c-html--&gt;
</I>&gt;<i> +
</I>&gt;<i> +   &lt;dt&gt;The WebSocket protocol&lt;/dt&gt;
</I>&gt;<i> +
</I>&gt;<i> +   &lt;dd&gt;
</I>&gt;<i> +
</I>&gt;<i> +    &lt;div data-component=&quot;WebSocket API (editor: Ian  
</I>&gt;<i> Hickson)&quot;&gt;&lt;!--websocket-api--&gt;
</I>&gt;<i> +
</I>&gt;<i> +    &lt;p&gt;The following terms are defined in the WebSocket protocol
</I>&gt;<i> +    specification: &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> +
</I>&gt;<i> +    &lt;ul class=&quot;brief&quot;&gt;
</I>&gt;<i> +
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;parse a WebSocket URL's components&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;establish a WebSocket connection&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;the WebSocket connection is established&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;validate the server's response&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;subprotocol in use&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;cookies set during the server's opening handshake&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;a WebSocket message has been received&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;fail the WebSocket connection&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;close the WebSocket connection&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;start the WebSocket closing handshake&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;the WebSocket closing handshake is started&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;the WebSocket connection is closed&lt;/dfn&gt; (possibly &lt;i  
</I>&gt;<i> title=&quot;&quot;&gt;cleanly&lt;/i&gt;)
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;the WebSocket connection close code&lt;/dfn&gt;
</I>&gt;<i> +     &lt;li&gt;&lt;dfn&gt;the WebSocket connection close reason&lt;/dfn&gt;
</I>&gt;<i> +
</I>&gt;<i> +    &lt;/ul&gt;
</I>&gt;<i> +
</I>&gt;<i> +    &lt;/div&gt;&lt;!--data-component--&gt;
</I>&gt;<i> +
</I>&gt;<i> +   &lt;/dd&gt;
</I>&gt;<i> +
</I>&gt;<i> +&lt;!--START html--&gt;&lt;!--START dev-html--&gt;&lt;!--START w3c-html--&gt;
</I>&gt;<i> +
</I>&gt;<i>    &lt;/dl&gt;
</I>&gt;<i>   &lt;p&gt;This specification does not &lt;em&gt;require&lt;/em&gt; support of any
</I>&gt;<i> @@ -89482,8 +89532,8 @@
</I>&gt;<i>   // networking
</I>&gt;<i>             attribute &lt;span&gt;Function&lt;/span&gt; &lt;span  
</I>&gt;<i> title=&quot;handler-WebSocket-onopen&quot;&gt;onopen&lt;/span&gt;;
</I>&gt;<i> -           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span  
</I>&gt;<i> title=&quot;handler-WebSocket-onerror&quot;&gt;onerror&lt;/span&gt;;
</I>&gt;<i> -           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span  
</I>&gt;<i> title=&quot;handler-WebSocket-onclose&quot;&gt;onclose&lt;/span&gt;;
</I>&gt;<i> +&lt;!--           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span  
</I>&gt;<i> title=&quot;handler-WebSocket-onerror&quot;&gt;onerror&lt;/span&gt;;
</I>&gt;<i> +--&gt;           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span
</I>
Why is onerror commented out?


&gt;<i> title=&quot;handler-WebSocket-onclose&quot;&gt;onclose&lt;/span&gt;;
</I>&gt;<i>    readonly attribute DOMString &lt;span  
</I>&gt;<i> title=&quot;dom-WebSocket-protocol&quot;&gt;protocol&lt;/span&gt;;
</I>&gt;<i>    void &lt;span title=&quot;dom-WebSocket-close&quot;&gt;close&lt;/span&gt;(in optional  
</I>&gt;<i> unsigned short code, in optional DOMString reason);
</I>&gt;<i> @@ -89515,12 +89565,12 @@
</I>&gt;<i>   &lt;ol&gt;
</I>&gt;<i> -   &lt;li&gt;&lt;p&gt;&lt;span&gt;Parse a WebSocket URL's components&lt;/span&gt; from the
</I>&gt;<i> -   &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; argument, to obtain &lt;var
</I>&gt;<i> -   title=&quot;&quot;&gt;host&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;port&lt;/var&gt;, &lt;var
</I>&gt;<i> -   title=&quot;&quot;&gt;resource name&lt;/var&gt;, and &lt;var title=&quot;&quot;&gt;secure&lt;/var&gt;. If
</I>&gt;<i> -   this fails, throw a &lt;code&gt;SYNTAX_ERR&lt;/code&gt; exception and abort
</I>&gt;<i> -   these steps. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
</I>&gt;<i> +   &lt;li&gt;&lt;p&gt;&lt;i&gt;Parse a WebSocket URL's components&lt;/i&gt; from the &lt;var
</I>&gt;<i> +   title=&quot;&quot;&gt;url&lt;/var&gt; argument, to obtain &lt;var title=&quot;&quot;&gt;host&lt;/var&gt;,
</I>&gt;<i> +   &lt;var title=&quot;&quot;&gt;port&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;resource name&lt;/var&gt;, and
</I>&gt;<i> +   &lt;var title=&quot;&quot;&gt;secure&lt;/var&gt;. If this fails, throw a
</I>&gt;<i> +   &lt;code&gt;SYNTAX_ERR&lt;/code&gt; exception and abort these steps. &lt;a
</I>&gt;<i> +   href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
</I>&gt;<i>    &lt;li&gt;
</I>&gt;<i> @@ -89567,20 +89617,18 @@
</I>&gt;<i>    &lt;li&gt;
</I>&gt;<i> -    &lt;p&gt;&lt;span&gt;Establish a WebSocket connection&lt;/span&gt; to a host &lt;var
</I>&gt;<i> -    title=&quot;&quot;&gt;host&lt;/var&gt;, on port &lt;var title=&quot;&quot;&gt;port&lt;/var&gt; (if one was
</I>&gt;<i> -    specified), from &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, with the flag &lt;var
</I>&gt;<i> -    title=&quot;&quot;&gt;secure&lt;/var&gt;, with &lt;var title=&quot;&quot;&gt;resource name&lt;/var&gt; as
</I>&gt;<i> -    the resource name, with &lt;var title=&quot;&quot;&gt;protocols&lt;/var&gt; as the
</I>&gt;<i> -    (possibly empty) list of protocols, and with the &lt;var
</I>&gt;<i> -    title=&quot;&quot;&gt;defer cookies&lt;/var&gt; flag set. &lt;a
</I>&gt;<i> +    &lt;p&gt;&lt;i&gt;Establish a WebSocket connection&lt;/i&gt; given the set (&lt;var
</I>&gt;<i> +    title=&quot;&quot;&gt;host&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;port&lt;/var&gt;, &lt;var
</I>&gt;<i> +    title=&quot;&quot;&gt;resource name&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;secure&lt;/var&gt;), along
</I>&gt;<i> +    with the &lt;var title=&quot;&quot;&gt;protocols&lt;/var&gt; list and an empty list for
</I>&gt;<i> +    the extensions, and &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;. &lt;a
</I>&gt;<i>      href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> -    &lt;p&gt;When the user agent &lt;i&gt;validates the server's response&lt;/i&gt; during
</I>&gt;<i> -    the &quot;&lt;span&gt;establish a WebSocket connection&lt;/span&gt;&quot; algorithm, if
</I>&gt;<i> -    the status code received from the server is not 101 (e.g. it is a
</I>&gt;<i> -    redirect), the user agent must &lt;span&gt;fail the websocket
</I>&gt;<i> -    connection&lt;/span&gt;.&lt;/p&gt;
</I>&gt;<i> +    &lt;p&gt;When the user agent &lt;i title=&quot;validate the server's
</I>&gt;<i> +    response&quot;&gt;validates the server's response&lt;/i&gt; during the
</I>&gt;<i> +    &quot;&lt;i&gt;establish a WebSocket connection&lt;/i&gt;&quot; algorithm, if the status
</I>&gt;<i> +    code received from the server is not 101 (e.g. it is a redirect),
</I>&gt;<i> +    the user agent must &lt;i&gt;fail the websocket connection&lt;/i&gt;.&lt;/p&gt;
</I>&gt;<i>     &lt;p class=&quot;warning&quot;&gt;Following HTTP procedures here could introduce
</I>&gt;<i>      serious security problems in a Web browser context. For example,
</I>&gt;<i> @@ -89591,12 +89639,11 @@
</I>&gt;<i>      even if the script checks that the URL has the right hostname.&lt;/p&gt;
</I>&gt;<i>      &lt;!--  
</I>&gt;<i> <A HREF="http://www.ietf.org/mail-archive/web/hybi/current/msg06951.html">http://www.ietf.org/mail-archive/web/hybi/current/msg06951.html</A> --&gt;
</I>&gt;<i> -    &lt;p class=&quot;note&quot;&gt;If the &quot;&lt;span&gt;establish a WebSocket
</I>&gt;<i> -    connection&lt;/span&gt;&quot; algorithm fails, it triggers the &quot;&lt;span&gt;fail
</I>&gt;<i> -    the WebSocket connection&lt;/span&gt;&quot; algorithm, which then invokes
</I>&gt;<i> -    the &quot;&lt;span&gt;close the WebSocket connection&lt;/span&gt;&quot; algorithm,
</I>&gt;<i> -    which then establishes that the &quot;&lt;span&gt;WebSocket connection is
</I>&gt;<i> -    closed&lt;/span&gt;&quot;, which fires the &lt;code
</I>&gt;<i> +    &lt;p class=&quot;note&quot;&gt;If the &lt;i&gt;establish a WebSocket connection&lt;/i&gt;
</I>&gt;<i> +    algorithm fails, it triggers the &lt;i&gt;fail the WebSocket
</I>&gt;<i> +    connection&lt;/i&gt; algorithm, which then invokes the &lt;i&gt;close the
</I>&gt;<i> +    WebSocket connection&lt;/i&gt; algorithm, which then establishes that
</I>&gt;<i> +    &lt;i&gt;the WebSocket connection is closed&lt;/i&gt;, which fires the &lt;code
</I>&gt;<i>      title=&quot;event-close&quot;&gt;close&lt;/code&gt; event &lt;a
</I>&gt;<i>      href=&quot;#closeWebSocket&quot;&gt;as described below&lt;/a&gt;.&lt;/p&gt;
</I>&gt;<i> @@ -89629,7 +89676,7 @@
</I>&gt;<i>    &lt;dt&gt;&lt;dfn title=&quot;dom-WebSocket-OPEN&quot;&gt;&lt;code&gt;OPEN&lt;/code&gt;&lt;/dfn&gt; (numeric  
</I>&gt;<i> value 1)&lt;/dt&gt;
</I>&gt;<i> -   &lt;dd&gt;The &lt;span&gt;WebSocket connection is established&lt;/span&gt; and  
</I>&gt;<i> communication is possible.&lt;/dd&gt;
</I>&gt;<i> +   &lt;dd&gt;&lt;i&gt;The WebSocket connection is established&lt;/i&gt; and communication  
</I>&gt;<i> is possible.&lt;/dd&gt;
</I>&gt;<i>    &lt;dt&gt;&lt;dfn title=&quot;dom-WebSocket-CLOSING&quot;&gt;&lt;code&gt;CLOSING&lt;/code&gt;&lt;/dfn&gt;  
</I>&gt;<i> (numeric value 2)&lt;/dt&gt;
</I>&gt;<i> @@ -89647,8 +89694,8 @@
</I>&gt;<i>   &lt;p&gt;The &lt;dfn
</I>&gt;<i>    title=&quot;dom-WebSocket-protocol&quot;&gt;&lt;code&gt;protocol&lt;/code&gt;&lt;/dfn&gt; attribute
</I>&gt;<i> -  must initially return the empty string. After the &lt;span&gt;WebSocket
</I>&gt;<i> -  connection is established&lt;/span&gt;, its value might change, as defined
</I>&gt;<i> +  must initially return the empty string. After &lt;i&gt;the WebSocket
</I>&gt;<i> +  connection is established&lt;/i&gt;, its value might change, as defined
</I>&gt;<i>    below.&lt;/p&gt;
</I>&gt;<i>   &lt;p class=&quot;note&quot;&gt;The &lt;code
</I>&gt;<i> @@ -89688,34 +89735,34 @@
</I>&gt;<i>       &lt;/dd&gt;
</I>&gt;<i> -     &lt;dt&gt;If the WebSocket connection is not yet &lt;span title=&quot;WebSocket
</I>&gt;<i> -     connection is established&quot;&gt;established&lt;/span&gt; &lt;a
</I>&gt;<i> +     &lt;dt&gt;If the WebSocket connection is not yet &lt;i title=&quot;the
</I>&gt;<i> +     WebSocket connection is established&quot;&gt;established&lt;/i&gt; &lt;a
</I>&gt;<i>       href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/dt&gt;
</I>&gt;<i>      &lt;dd&gt;
</I>&gt;<i> -      &lt;p&gt;&lt;span&gt;Fail the WebSocket connection&lt;/span&gt; and set the &lt;code
</I>&gt;<i> +      &lt;p&gt;&lt;i&gt;Fail the WebSocket connection&lt;/i&gt; and set the &lt;code
</I>&gt;<i>        title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt; attribute's
</I>&gt;<i>        value to &lt;code title=&quot;dom-WebSocket-CLOSING&quot;&gt;CLOSING&lt;/code&gt; (2).
</I>&gt;<i>        &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> -      &lt;p class=&quot;note&quot;&gt;The &quot;&lt;span&gt;fail the WebSocket connection&lt;/span&gt;&quot;
</I>&gt;<i> -      algorithm invokes the &quot;&lt;span&gt;close the WebSocket
</I>&gt;<i> -      connection&lt;/span&gt;&quot; algorithm, which then establishes that the
</I>&gt;<i> -      &quot;&lt;span&gt;WebSocket connection is closed&lt;/span&gt;&quot;, which fires the
</I>&gt;<i> +      &lt;p class=&quot;note&quot;&gt;The &lt;i&gt;fail the WebSocket connection&lt;/i&gt;
</I>&gt;<i> +      algorithm invokes the &lt;i&gt;close the WebSocket
</I>&gt;<i> +      connection&lt;/i&gt; algorithm, which then establishes that
</I>&gt;<i> +      &lt;i&gt;the WebSocket connection is closed&lt;/i&gt;, which fires the
</I>&gt;<i>        &lt;code title=&quot;event-close&quot;&gt;close&lt;/code&gt; event &lt;a
</I>&gt;<i>        href=&quot;#closeWebSocket&quot;&gt;as described below&lt;/a&gt;.&lt;/p&gt;
</I>&gt;<i>      &lt;/dd&gt;
</I>&gt;<i> -     &lt;dt&gt;If the WebSocket closing handshake has not yet been &lt;span
</I>&gt;<i> -     title=&quot;the WebSocket closing handshake has
</I>&gt;<i> -     started&quot;&gt;started&lt;/span&gt; &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/dt&gt;
</I>&gt;<i> +     &lt;dt&gt;If the WebSocket closing handshake has not yet been &lt;i
</I>&gt;<i> +     title=&quot;the WebSocket closing handshake is
</I>&gt;<i> +     started&quot;&gt;started&lt;/i&gt; &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/dt&gt;
</I>&gt;<i>      &lt;dd&gt;
</I>&gt;<i> -      &lt;p&gt;&lt;span&gt;Start the WebSocket closing handshake&lt;/span&gt; and set the
</I>&gt;<i> +      &lt;p&gt;&lt;i&gt;Start the WebSocket closing handshake&lt;/i&gt; and set the
</I>&gt;<i>        &lt;code title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt;
</I>&gt;<i>        attribute's value to &lt;code
</I>&gt;<i>        title=&quot;dom-WebSocket-CLOSING&quot;&gt;CLOSING&lt;/code&gt; (2). &lt;a
</I>&gt;<i> @@ -89728,13 +89775,14 @@
</I>&gt;<i>       &lt;p&gt;If the second argument is also present, then it must be
</I>&gt;<i>        encoded as UTF-8 and provided in the Close message after the
</I>&gt;<i> -      status code&lt;!--CLOSE CODE--&gt;. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> +      status code&lt;!--CLOSE CODE--&gt;. &lt;a
</I>&gt;<i> +      href=&quot;#refsRFC3629&quot;&gt;[RFC3629]&lt;/a&gt; &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> -      &lt;p class=&quot;note&quot;&gt;The &quot;&lt;span&gt;start the WebSocket closing
</I>&gt;<i> -      handshake&lt;/span&gt;&quot; algorithm eventually invokes the &quot;&lt;span&gt;close
</I>&gt;<i> -      the WebSocket connection&lt;/span&gt;&quot; algorithm, which then establishes
</I>&gt;<i> -      that the &quot;&lt;span&gt;WebSocket connection is closed&lt;/span&gt;&quot;, which
</I>&gt;<i> -      fires the &lt;code title=&quot;event-close&quot;&gt;close&lt;/code&gt; event &lt;a
</I>&gt;<i> +      &lt;p class=&quot;note&quot;&gt;The &lt;i&gt;start the WebSocket closing handshake&lt;/i&gt;
</I>&gt;<i> +      algorithm eventually invokes the &lt;i&gt;close the WebSocket
</I>&gt;<i> +      connection&lt;/i&gt; algorithm, which then establishes that &lt;i&gt;the
</I>&gt;<i> +      WebSocket connection is closed&lt;/i&gt;, which fires the &lt;code
</I>&gt;<i> +      title=&quot;event-close&quot;&gt;close&lt;/code&gt; event &lt;a
</I>&gt;<i>        href=&quot;#closeWebSocket&quot;&gt;as described below&lt;/a&gt;.&lt;/p&gt;
</I>&gt;<i>      &lt;/dd&gt;
</I>&gt;<i> @@ -89749,11 +89797,11 @@
</I>&gt;<i>        value to &lt;code title=&quot;dom-WebSocket-CLOSING&quot;&gt;CLOSING&lt;/code&gt;
</I>&gt;<i>        (2).&lt;/p&gt;
</I>&gt;<i> -      &lt;p class=&quot;note&quot;&gt;&lt;span&gt;The WebSocket closing handshake has
</I>&gt;<i> -      started&lt;/span&gt;, and will eventually invokethe &quot;&lt;span&gt;close the
</I>&gt;<i> -      WebSocket connection&lt;/span&gt;&quot; algorithm, which will establish that
</I>&gt;<i> -      the &quot;&lt;span&gt;WebSocket connection is closed&lt;/span&gt;&quot;, and thus the
</I>&gt;<i> -      &lt;code title=&quot;event-close&quot;&gt;close&lt;/code&gt; event will fire, &lt;a
</I>&gt;<i> +      &lt;p class=&quot;note&quot;&gt;&lt;i&gt;The WebSocket closing handshake is
</I>&gt;<i> +      started&lt;/i&gt;, and will eventually invoke the &lt;i&gt;close the
</I>&gt;<i> +      WebSocket connection&lt;/i&gt; algorithm, which will establish that
</I>&gt;<i> +      &lt;i&gt;the WebSocket connection is closed&lt;/i&gt;, and thus the &lt;code
</I>&gt;<i> +      title=&quot;event-close&quot;&gt;close&lt;/code&gt; event will fire, &lt;a
</I>&gt;<i>        href=&quot;#closeWebSocket&quot;&gt;as described below&lt;/a&gt;.&lt;/p&gt;
</I>&gt;<i>      &lt;/dd&gt;
</I>&gt;<i> @@ -89768,19 +89816,19 @@
</I>&gt;<i>   &lt;p&gt;The &lt;dfn
</I>&gt;<i>    title=&quot;dom-WebSocket-bufferedAmount&quot;&gt;&lt;code&gt;bufferedAmount&lt;/code&gt;&lt;/dfn&gt;
</I>&gt;<i> -  attribute must return the number of bytes of UTF-8 text that have
</I>&gt;<i> -  been queued using &lt;code title=&quot;dom-WebSocket-send&quot;&gt;send()&lt;/code&gt; but
</I>&gt;<i> -  that, as of the last time the &lt;span&gt;event loop&lt;/span&gt; started
</I>&gt;<i> -  executing a &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt;, had not yet been
</I>&gt;<i> -  transmitted to the network. (This thus includes any text sent during
</I>&gt;<i> -  the execution of the current task, regardless of whether the user
</I>&gt;<i> -  agent is able to transmit text asynchronously with script
</I>&gt;<i> -  execution.) This does not include framing overhead incurred by the
</I>&gt;<i> -  protocol, or buffering done by the operating system or network
</I>&gt;<i> -  hardware. If the connection is closed, this attribute's value will
</I>&gt;<i> -  only increase with each call to the &lt;code
</I>&gt;<i> -  title=&quot;dom-WebSocket-send&quot;&gt;send()&lt;/code&gt; method (the number does not
</I>&gt;<i> -  reset to zero once the connection closes).&lt;/p&gt;
</I>&gt;<i> +  attribute must return the number of bytes of application data (UTF-8
</I>&gt;<i> +  text and binary data) that have been queued using &lt;code
</I>&gt;<i> +  title=&quot;dom-WebSocket-send&quot;&gt;send()&lt;/code&gt; but that, as of the last
</I>&gt;<i> +  time the &lt;span&gt;event loop&lt;/span&gt; started executing a &lt;span
</I>&gt;<i> +  title=&quot;concept-task&quot;&gt;task&lt;/span&gt;, had not yet been transmitted to
</I>&gt;<i> +  the network. (This thus includes any text sent during the execution
</I>&gt;<i> +  of the current task, regardless of whether the user agent is able to
</I>&gt;<i> +  transmit text asynchronously with script execution.) This does not
</I>&gt;<i> +  include framing overhead incurred by the protocol, or buffering done
</I>&gt;<i> +  by the operating system or network hardware. If the connection is
</I>&gt;<i> +  closed, this attribute's value will only increase with each call to
</I>&gt;<i> +  the &lt;code title=&quot;dom-WebSocket-send&quot;&gt;send()&lt;/code&gt; method (the
</I>&gt;<i> +  number does not reset to zero once the connection closes).&lt;/p&gt;
</I>&gt;<i>   &lt;div class=&quot;example&quot;&gt;
</I>&gt;<i> @@ -89857,19 +89905,20 @@
</I>&gt;<i>     &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; argument has any unpaired
</I>&gt;<i>      surrogates, then raise an &lt;code&gt;SYNTAX_ERR&lt;/code&gt; exception. If
</I>&gt;<i> -    the connection is established, and the string has no unpaired
</I>&gt;<i> -    surrogates, and &lt;span title=&quot;the WebSocket closing handshake has
</I>&gt;<i> -    started&quot;&gt;the WebSocket closing handshake has not yet
</I>&gt;<i> -    started&lt;/span&gt;, then the user agent must &lt;span&gt;send &lt;var
</I>&gt;<i> -    title=&quot;&quot;&gt;data&lt;/var&gt; using the WebSocket&lt;/span&gt; using a text frame
</I>&gt;<i> -    opcode; if the data cannot be sent, e.g. because it would need to
</I>&gt;<i> -    be buffered but the buffer is full, the user agent must
</I>&gt;<i> -    &lt;span&gt;close the WebSocket connection&lt;/span&gt;. Any invokation of
</I>&gt;<i> -    this method with a string argument that does not raise an
</I>&gt;<i> -    exception must increase the &lt;code
</I>&gt;<i> +    &lt;i&gt;the WebSocket connection is established&lt;/i&gt;, and the
</I>&gt;<i> +    string has no unpaired surrogates, and &lt;i title=&quot;the WebSocket
</I>&gt;<i> +    closing handshake is started&quot;&gt;the WebSocket closing handshake has
</I>&gt;<i> +    not yet started&lt;/i&gt;, then the user agent must &lt;i&gt;send a WebSocket
</I>&gt;<i> +    Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a text
</I>&gt;<i> +    frame opcode; if the data cannot be sent, e.g. because it would
</I>&gt;<i> +    need to be buffered but the buffer is full, the user agent must
</I>&gt;<i> +    &lt;i&gt;close the WebSocket connection&lt;/i&gt;. Any invokation of this
</I>&gt;<i> +    method with a string argument that does not raise an exception
</I>&gt;<i> +    must increase the &lt;code
</I>&gt;<i>      title=&quot;dom-WebSocket-bufferedAmount&quot;&gt;bufferedAmount&lt;/code&gt;
</I>&gt;<i>      attribute by the number of bytes needed to express the argument as
</I>&gt;<i> -    UTF-8. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> +    UTF-8. &lt;a href=&quot;#refsRFC3629&quot;&gt;[RFC3629]&lt;/a&gt; &lt;a
</I>&gt;<i> +    href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i>    &lt;/dd&gt;
</I>&gt;<i> @@ -89878,18 +89927,18 @@
</I>&gt;<i>    &lt;dd&gt;
</I>&gt;<i> -    &lt;p&gt;If the connection is established, and &lt;span title=&quot;The
</I>&gt;<i> -    WebSocket Closing Handshake is Started&quot;&gt;the WebSocket closing
</I>&gt;<i> -    handshake has not yet started&lt;/span&gt;, then the user agent must
</I>&gt;<i> -    &lt;span&gt;send &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using the WebSocket&lt;/span&gt;
</I>&gt;<i> -    using a binary frame opcode; if the data cannot be sent, e.g.
</I>&gt;<i> -    because it would need to be buffered but the buffer is full, the
</I>&gt;<i> -    user agent must &lt;span&gt;close the WebSocket connection&lt;/span&gt;. The
</I>&gt;<i> -    data to be sent is the raw data represented by the
</I>&gt;<i> -    &lt;code&gt;Blob&lt;/code&gt; object. &lt;!-- that sentence is meant to invoke
</I>&gt;<i> -    &quot;This interface represents immutable raw data.&quot; --&gt; Any invokation
</I>&gt;<i> -    of this method with a &lt;code&gt;Blob&lt;/code&gt; argument that does not
</I>&gt;<i> -    raise an exception must increase the &lt;code
</I>&gt;<i> +    &lt;p&gt;If &lt;i&gt;the WebSocket connection is established&lt;/i&gt;, and &lt;i
</I>&gt;<i> +    title=&quot;the WebSocket closing handshake is started&quot;&gt;the WebSocket
</I>&gt;<i> +    closing handshake has not yet started&lt;/i&gt;, then the user agent
</I>&gt;<i> +    must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var
</I>&gt;<i> +    title=&quot;&quot;&gt;data&lt;/var&gt; using a binary frame opcode; if the data
</I>&gt;<i> +    cannot be sent, e.g. because it would need to be buffered but the
</I>&gt;<i> +    buffer is full, the user agent must &lt;i&gt;close the WebSocket
</I>&gt;<i> +    connection&lt;/i&gt;. The data to be sent is the raw data represented by
</I>&gt;<i> +    the &lt;code&gt;Blob&lt;/code&gt; object. &lt;!-- that sentence is meant to
</I>&gt;<i> +    invoke &quot;This interface represents immutable raw data.&quot; --&gt; Any
</I>&gt;<i> +    invokation of this method with a &lt;code&gt;Blob&lt;/code&gt; argument that
</I>&gt;<i> +    does not raise an exception must increase the &lt;code
</I>&gt;<i>      title=&quot;dom-WebSocket-bufferedAmount&quot;&gt;bufferedAmount&lt;/code&gt;
</I>&gt;<i>      attribute by the size of the &lt;code&gt;Blob&lt;/code&gt; object's raw data,
</I>&gt;<i>      in bytes. &lt;!-- that sentence is meant to invoke the same as
</I>&gt;<i> @@ -89903,19 +89952,20 @@
</I>&gt;<i>    &lt;dd&gt;
</I>&gt;<i> -    &lt;p&gt;If the connection is established, and &lt;span title=&quot;The
</I>&gt;<i> -    WebSocket Closing Handshake is Started&quot;&gt;the WebSocket closing
</I>&gt;<i> -    handshake has not yet started&lt;/span&gt;, then the user agent must
</I>&gt;<i> -    &lt;span&gt;send &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using the WebSocket&lt;/span&gt;
</I>&gt;<i> -    using a binary frame opcode; if the data cannot be sent, e.g.
</I>&gt;<i> -    because it would need to be buffered but the buffer is full, the
</I>&gt;<i> -    user agent must &lt;span&gt;close the WebSocket connection&lt;/span&gt;. The
</I>&gt;<i> -    data to be sent is the data stored in the buffer described by the
</I>&gt;<i> -    &lt;code&gt;ArrayBuffer&lt;/code&gt; object. &lt;!-- that sentence is meant to
</I>&gt;<i> -    invoke &quot;The ArrayBuffer type describes a buffer used to store data
</I>&gt;<i> -    for the array buffer views.&quot; at the top of the Typed Array spec
</I>&gt;<i> -    --&gt; Any invokation of this method with an &lt;code&gt;ArrayBuffer&lt;/code&gt;
</I>&gt;<i> -    argument that does not raise an exception must increase the &lt;code
</I>&gt;<i> +    &lt;p&gt;If &lt;i&gt;the WebSocket connection is established&lt;/i&gt;, and &lt;i
</I>&gt;<i> +    title=&quot;the WebSocket closing handshake is started&quot;&gt;the WebSocket
</I>&gt;<i> +    closing handshake has not yet started&lt;/i&gt;, then the user agent
</I>&gt;<i> +    must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var
</I>&gt;<i> +    title=&quot;&quot;&gt;data&lt;/var&gt; using a binary frame opcode; if the data
</I>&gt;<i> +    cannot be sent, e.g. because it would need to be buffered but the
</I>&gt;<i> +    buffer is full, the user agent must &lt;i&gt;close the WebSocket
</I>&gt;<i> +    connection&lt;/i&gt;. The data to be sent is the data stored in the
</I>&gt;<i> +    buffer described by the &lt;code&gt;ArrayBuffer&lt;/code&gt; object. &lt;!-- that
</I>&gt;<i> +    sentence is meant to invoke &quot;The ArrayBuffer type describes a
</I>&gt;<i> +    buffer used to store data for the array buffer views.&quot; at the top
</I>&gt;<i> +    of the Typed Array spec --&gt; Any invokation of this method with an
</I>&gt;<i> +    &lt;code&gt;ArrayBuffer&lt;/code&gt; argument that does not raise an exception
</I>&gt;<i> +    must increase the &lt;code
</I>&gt;<i>      title=&quot;dom-WebSocket-bufferedAmount&quot;&gt;bufferedAmount&lt;/code&gt;
</I>&gt;<i>      attribute by the length of the &lt;code&gt;ArrayBuffer&lt;/code&gt; in bytes.
</I>&gt;<i>      &lt;!-- that sentence is meant to invoke the same as
</I>&gt;<i> @@ -89938,7 +89988,7 @@
</I>&gt;<i>     &lt;tbody&gt;
</I>&gt;<i>      &lt;tr&gt;&lt;td&gt;&lt;dfn  
</I>&gt;<i> title=&quot;handler-WebSocket-onopen&quot;&gt;&lt;code&gt;onopen&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code  
</I>&gt;<i> title=&quot;event-open&quot;&gt;open&lt;/code&gt;
</I>&gt;<i>      &lt;tr&gt;&lt;td&gt;&lt;dfn  
</I>&gt;<i> title=&quot;handler-WebSocket-onmessage&quot;&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt;  
</I>&gt;<i> &lt;code title=&quot;event-message&quot;&gt;message&lt;/code&gt;
</I>&gt;<i> -    &lt;tr&gt;&lt;td&gt;&lt;dfn  
</I>&gt;<i> title=&quot;handler-WebSocket-onerror&quot;&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code  
</I>&gt;<i> title=&quot;event-error&quot;&gt;error&lt;/code&gt;
</I>&gt;<i> +&lt;!--    &lt;tr&gt;&lt;td&gt;&lt;dfn  
</I>&gt;<i> title=&quot;handler-WebSocket-onerror&quot;&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code  
</I>&gt;<i> title=&quot;event-error&quot;&gt;error&lt;/code&gt;--&gt;
</I>&gt;<i>      &lt;tr&gt;&lt;td&gt;&lt;dfn  
</I>&gt;<i> title=&quot;handler-WebSocket-onclose&quot;&gt;&lt;code&gt;onclose&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code  
</I>&gt;<i> title=&quot;event-close&quot;&gt;close&lt;/code&gt;
</I>&gt;<i>    &lt;/table&gt;
</I>&gt;<i> @@ -89946,32 +89996,36 @@
</I>&gt;<i>   &lt;h4&gt;Feedback from the protocol&lt;/h4&gt;
</I>&gt;<i> -  &lt;p&gt;When the &lt;i&gt;WebSocket connection is established&lt;/i&gt;, the user
</I>&gt;<i> -  agent must &lt;span&gt;queue a task&lt;/span&gt; to first change the &lt;code
</I>&gt;<i> -  title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt; attribute's value
</I>&gt;<i> -  to &lt;code title=&quot;dom-WebSocket-OPEN&quot;&gt;OPEN&lt;/code&gt; (1); &lt;span&gt;apply the
</I>&gt;<i> -  cookies&lt;/span&gt;
</I>&gt;<i> -&lt;!--
</I>&gt;<i> -Once we have the cookies back:
</I>&gt;<i> +  &lt;p&gt;When &lt;i&gt;the WebSocket connection is established&lt;/i&gt;, the user
</I>&gt;<i> +  agent must &lt;span&gt;queue a task&lt;/span&gt; to run these steps:&lt;/p&gt;
</I>&gt;<i> -     &lt;li&gt;&lt;p&gt;Act as if &lt;span title=&quot;receives a
</I>&gt;<i> -     set-cookie-string&quot;&gt;receiving a set-cookie-string&lt;/span&gt; for
</I>&gt;<i> -     &lt;span&gt;the document's address&lt;/span&gt;,
</I>&gt;<i> -     consisting of the value of the element's &lt;code
</I>&gt;<i> -     title=&quot;attr-meta-content&quot;&gt;content&lt;/code&gt; attribute encoded as
</I>&gt;<i> -     UTF-8. &lt;a href=&quot;#refsCOOKIES&quot;&gt;[COOKIES]&lt;/a&gt; &lt;a
</I>&gt;<i> -     href=&quot;#refsRFC3629&quot;&gt;[RFC3629]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
</I>&gt;<i> +  &lt;ol&gt;
</I>&gt;<i> ---&gt;
</I>&gt;<i> -  that were collected in the &lt;var title=&quot;&quot;&gt;list of
</I>&gt;<i> -  cookies&lt;/var&gt; when the &lt;span title=&quot;WebSocket connection is
</I>&gt;<i> -  established&quot;&gt;connection was established&lt;/span&gt;; change the &lt;code
</I>&gt;<i> -  title=&quot;dom-WebSocket-protocol&quot;&gt;protocol&lt;/code&gt; attribute's value to
</I>&gt;<i> -  the &lt;span&gt;selected WebSocket subprotocol&lt;/span&gt;, if there is one;
</I>&gt;<i> -  and then &lt;span&gt;fire a simple event&lt;/span&gt; named &lt;code
</I>&gt;<i> -  title=&quot;event-open&quot;&gt;open&lt;/code&gt; at the &lt;code&gt;WebSocket&lt;/code&gt; object.
</I>&gt;<i> -  &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> +   &lt;li&gt;&lt;p&gt;Change the &lt;code
</I>&gt;<i> +   title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt; attribute's
</I>&gt;<i> +   value to &lt;code title=&quot;dom-WebSocket-OPEN&quot;&gt;OPEN&lt;/code&gt; (1).&lt;/p&gt;&lt;/li&gt;
</I>&gt;<i> +   &lt;li&gt;&lt;p&gt;Change the &lt;code
</I>&gt;<i> +   title=&quot;dom-WebSocket-protocol&quot;&gt;protocol&lt;/code&gt; attribute's value to
</I>&gt;<i> +   the &lt;i&gt;subprotocol in use&lt;/i&gt;, if is not the null value. &lt;a
</I>&gt;<i> +   href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
</I>&gt;<i> +
</I>&gt;<i> +   &lt;li&gt;&lt;p&gt;Act as if the user agent had &lt;span title=&quot;receives a
</I>&gt;<i> +   set-cookie-string&quot;&gt;received a set-cookie-string&lt;/span&gt; for
</I>&gt;<i> +   &lt;span&gt;the document's address&lt;/span&gt;, consisting of the &lt;i&gt;cookies
</I>&gt;<i> +   set during the server's opening handshake&lt;/i&gt;. &lt;a
</I>&gt;<i> +   href=&quot;#refsCOOKIES&quot;&gt;[COOKIES]&lt;/a&gt; &lt;a
</I>&gt;<i> +   href=&quot;#refsRFC3629&quot;&gt;[RFC3629]&lt;/a&gt; &lt;a
</I>&gt;<i> +   href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
</I>&gt;<i> +
</I>&gt;<i> +   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fire a simple event&lt;/span&gt; named &lt;code
</I>&gt;<i> +   title=&quot;event-open&quot;&gt;open&lt;/code&gt; at the &lt;code&gt;WebSocket&lt;/code&gt;
</I>&gt;<i> +   object.&lt;/p&gt;
</I>&gt;<i> +
</I>&gt;<i> +  &lt;/ol&gt;
</I>&gt;<i> +
</I>&gt;<i> +  &lt;hr&gt;
</I>&gt;<i> +
</I>&gt;<i>    &lt;p&gt;When &lt;i&gt;a WebSocket message has been received&lt;/i&gt; with type &lt;var
</I>&gt;<i>    title=&quot;&quot;&gt;type&lt;/var&gt; and data &lt;var title=&quot;&quot;&gt;data&lt;/var&gt;, the user
</I>&gt;<i>    agent must &lt;span&gt;queue a task&lt;/span&gt; to follow these steps: &lt;a
</I>&gt;<i> @@ -90047,6 +90101,8 @@
</I>&gt;<i>    title=&quot;concept-task&quot;&gt;task&lt;/span&gt; so as to avoid stalling the main
</I>&gt;<i>    thread while it created the &lt;code&gt;ArrayBuffer&lt;/code&gt; object.&lt;/p&gt;
</I>&gt;<i> +  &lt;hr&gt;
</I>&gt;<i> +&lt;!--
</I>&gt;<i>    &lt;p&gt;When &lt;i&gt;a WebSocket error has been detected&lt;/i&gt;, the user agent
</I>&gt;<i>    must &lt;span&gt;queue a task&lt;/span&gt; to check to see if the &lt;code
</I>&gt;<i>    title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt; attribute's value
</I>&gt;<i> @@ -90055,8 +90111,8 @@
</I>&gt;<i>    &lt;span&gt;fire a simple event&lt;/span&gt; named &lt;code
</I>&gt;<i>    title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the &lt;code&gt;WebSocket&lt;/code&gt;
</I>&gt;<i>    object. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> -
</I>&gt;<i> -  &lt;p&gt;When &lt;i&gt;the WebSocket closing handshake has started&lt;/i&gt;, the user
</I>&gt;<i> +--&gt;
</I>&gt;<i> +  &lt;p&gt;When &lt;i&gt;the WebSocket closing handshake is started&lt;/i&gt;, the user
</I>&gt;<i>    agent must &lt;span&gt;queue a task&lt;/span&gt; to change the &lt;code
</I>&gt;<i>    title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt; attribute's value
</I>&gt;<i>    to &lt;code title=&quot;dom-WebSocket-CLOSING&quot;&gt;CLOSING&lt;/code&gt; (2). (If the
</I>&gt;<i> @@ -90066,7 +90122,7 @@
</I>&gt;<i>    title=&quot;dom-WebSocket-CLOSING&quot;&gt;CLOSING&lt;/code&gt; (2) when this task
</I>&gt;<i>    runs.) &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i> -  &lt;p id=&quot;closeWebSocket&quot;&gt;When the &lt;i&gt;WebSocket connection is
</I>&gt;<i> +  &lt;p id=&quot;closeWebSocket&quot;&gt;When &lt;i&gt;the WebSocket connection is
</I>&gt;<i>    closed&lt;/i&gt;, possibly &lt;i title=&quot;&quot;&gt;cleanly&lt;/i&gt;, the user agent must
</I>&gt;<i>    create an event that uses the &lt;code&gt;CloseEvent&lt;/code&gt; interface,
</I>&gt;<i>    with the event name &lt;code title=&quot;event-close&quot;&gt;close&lt;/code&gt;, which
</I>&gt;<i> @@ -90074,9 +90130,9 @@
</I>&gt;<i>    &lt;code title=&quot;dom-CloseEvent-wasClean&quot;&gt;wasClean&lt;/code&gt; attribute is
</I>&gt;<i>    set to true if the connection closed &lt;i title=&quot;&quot;&gt;cleanly&lt;/i&gt; and
</I>&gt;<i>    false otherwise, whose &lt;code title=&quot;dom-CloseEvent-code&quot;&gt;code&lt;/code&gt;
</I>&gt;<i> -  attribute is set to the &lt;i&gt;WebSocket connection close code&lt;/i&gt;, and
</I>&gt;<i> +  attribute is set to &lt;i&gt;the WebSocket connection close code&lt;/i&gt;, and
</I>&gt;<i>    whose &lt;code title=&quot;dom-CloseEvent-reason&quot;&gt;reason&lt;/code&gt; attribute is
</I>&gt;<i> -  set to the &lt;i&gt;WebSocket connection close reason&lt;/i&gt;; and &lt;span&gt;queue
</I>&gt;<i> +  set to &lt;i&gt;the WebSocket connection close reason&lt;/i&gt;; and &lt;span&gt;queue
</I>&gt;<i>    a task&lt;/span&gt; to first change the &lt;code
</I>&gt;<i>    title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt; attribute's value
</I>&gt;<i>    to &lt;code title=&quot;dom-WebSocket-CLOSED&quot;&gt;CLOSED&lt;/code&gt; (3), and then
</I>&gt;<i> @@ -90129,8 +90185,8 @@
</I>&gt;<i>    executing a &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; must not be
</I>&gt;<i>    garbage collected if there are any event listeners registered for
</I>&gt;<i>    &lt;code title=&quot;event-open&quot;&gt;open&lt;/code&gt; events, &lt;code
</I>&gt;<i> -  title=&quot;event-message&quot;&gt;message&lt;/code&gt; events, &lt;code
</I>&gt;<i> -  title=&quot;event-error&quot;&gt;error&lt;/code&gt; events, or &lt;code
</I>&gt;<i> +  title=&quot;event-message&quot;&gt;message&lt;/code&gt; events&lt;!--, &lt;code
</I>&gt;<i> +  title=&quot;event-error&quot;&gt;error&lt;/code&gt; events--&gt;, or &lt;code
</I>&gt;<i>    title=&quot;event-close&quot;&gt;close&lt;/code&gt; events.&lt;/p&gt;
</I>&gt;<i>   &lt;p&gt;A &lt;code&gt;WebSocket&lt;/code&gt; object whose &lt;code
</I>&gt;<i> @@ -90140,18 +90196,18 @@
</I>&gt;<i>    the &lt;span&gt;event loop&lt;/span&gt; started executing a &lt;span
</I>&gt;<i>    title=&quot;concept-task&quot;&gt;task&lt;/span&gt; must not be garbage collected if
</I>&gt;<i>    there are any event listeners registered for &lt;code
</I>&gt;<i> -  title=&quot;event-message&quot;&gt;message&lt;/code&gt; events, &lt;code
</I>&gt;<i> -  title=&quot;event-error&quot;&gt;error&lt;/code&gt; events, or &lt;code
</I>&gt;<i> +  title=&quot;event-message&quot;&gt;message&lt;/code&gt; events&lt;!--, &lt;code
</I>&gt;<i> +  title=&quot;event-error&quot;&gt;error&lt;/code&gt; events--&gt;, or &lt;code
</I>&gt;<i>    title=&quot;event-close&quot;&gt;close&lt;/code&gt; events.&lt;/p&gt;
</I>&gt;<i> -  &lt;p&gt;A &lt;code&gt;WebSocket&lt;/code&gt; object with &lt;span title=&quot;WebSocket
</I>&gt;<i> -  connection is established&quot;&gt;an established connection&lt;/span&gt; that has
</I>&gt;<i> +  &lt;p&gt;A &lt;code&gt;WebSocket&lt;/code&gt; object with &lt;i title=&quot;the WebSocket
</I>&gt;<i> +  connection is established&quot;&gt;an established connection&lt;/i&gt; that has
</I>&gt;<i>    data queued to be transmitted to the network must not be garbage
</I>&gt;<i>    collected. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i>   &lt;p&gt;If a &lt;code&gt;WebSocket&lt;/code&gt; object is garbage collected while its
</I>&gt;<i> -  connection is still open, the user agent must &lt;span&gt;start the
</I>&gt;<i> -  WebSocket closing handshake&lt;/span&gt;, with no status code&lt;!--CLOSE
</I>&gt;<i> +  connection is still open, the user agent must &lt;i&gt;start the
</I>&gt;<i> +  WebSocket closing handshake&lt;/i&gt;, with no status code&lt;!--CLOSE
</I>&gt;<i>    CODE--&gt; for the Close message. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i>   &lt;hr&gt;
</I>&gt;<i> @@ -90163,25 +90219,25 @@
</I>&gt;<i>   &lt;dl class=&quot;switch&quot;&gt;
</I>&gt;<i> -   &lt;dt&gt;If the WebSocket connection is not yet &lt;span title=&quot;WebSocket
</I>&gt;<i> -   connection is established&quot;&gt;established&lt;/span&gt; &lt;a
</I>&gt;<i> +   &lt;dt&gt;If the WebSocket connection is not yet &lt;i title=&quot;the WebSocket
</I>&gt;<i> +   connection is established&quot;&gt;established&lt;/i&gt; &lt;a
</I>&gt;<i>     href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/dt&gt;
</I>&gt;<i>    &lt;dd&gt;
</I>&gt;<i> -    &lt;p&gt;&lt;span&gt;Fail the WebSocket connection&lt;/span&gt;. &lt;a
</I>&gt;<i> +    &lt;p&gt;&lt;i&gt;Fail the WebSocket connection&lt;/i&gt;. &lt;a
</I>&gt;<i>      href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i>    &lt;/dd&gt;
</I>&gt;<i> -   &lt;dt&gt;If the WebSocket closing handshake has not yet been &lt;span
</I>&gt;<i> -   title=&quot;the WebSocket closing handshake has started&quot;&gt;started&lt;/span&gt;
</I>&gt;<i> +   &lt;dt&gt;If the WebSocket closing handshake has not yet been &lt;i
</I>&gt;<i> +   title=&quot;the WebSocket closing handshake is started&quot;&gt;started&lt;/i&gt;
</I>&gt;<i>     &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/dt&gt;
</I>&gt;<i>    &lt;dd&gt;
</I>&gt;<i> -    &lt;p&gt;&lt;span&gt;Start the WebSocket closing handshake&lt;/span&gt;, with the
</I>&gt;<i> +    &lt;p&gt;&lt;i&gt;Start the WebSocket closing handshake&lt;/i&gt;, with the
</I>&gt;<i>      status code&lt;!--CLOSE CODE--&gt; to use in the WebSocket Close message
</I>&gt;<i>      being 1001. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Commit-Watchers mailing list
</I>&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">Commit-Watchers at lists.whatwg.org</A>
</I>&gt;<i> <A HREF="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org</A>
</I>

-- 
Simon Pieters
Opera Software
</PRE>







<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031869.html">[whatwg] Improving the Application Cache
</A></li>
	<LI>Next message: <A HREF="074147.html">[whatwg] websocket onerror Re: [html5] r6156 - [giow] (0) Update all the WebSocket terminology to match the next WSP draft.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31873">[ date ]</a>
              <a href="thread.html#31873">[ thread ]</a>
              <a href="subject.html#31873">[ subject ]</a>
              <a href="author.html#31873">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
