<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Overriding functions in DOM Storage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Overriding%20functions%20in%20DOM%20Storage&In-Reply-To=%3C278fd46c0905262007k7663318cr7cc8d4555a2312bf%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062228.html">
   <LINK REL="Next"  HREF="062230.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Overriding functions in DOM Storage</H1>
<!--htdig_noindex-->
    <B>Aaron Boodman</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Overriding%20functions%20in%20DOM%20Storage&In-Reply-To=%3C278fd46c0905262007k7663318cr7cc8d4555a2312bf%40mail.gmail.com%3E"
       TITLE="[whatwg] Overriding functions in DOM Storage">aa at google.com
       </A><BR>
    <I>Tue May 26 20:07:53 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="062228.html">[whatwg] Overriding functions in DOM Storage
</A></li>
        <LI>Next message: <A HREF="062230.html">[whatwg] Overriding functions in DOM Storage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62229">[ date ]</a>
              <a href="thread.html#62229">[ thread ]</a>
              <a href="subject.html#62229">[ subject ]</a>
              <a href="author.html#62229">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>This isn't a localstorage specific question, this is a general
question about overriding methods on any host object.

The comments about shooting yourself in the foot are good points, but
the same exact thing is possible on every single API in the entire
environment. It doesn't make sense to worry about them wrt local
storage, specifically.

FWIW, I think that Safari's behavior is &quot;correct&quot; (a bit weird, but
correct). But this is an area where there isn't good interop right now
across the board.

- a

On Tue, May 26, 2009 at 7:44 PM, Jeremy Orlow &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jorlow at google.com</A>&gt; wrote:
&gt;<i> No one else (especially from Mozilla or Microsoft)?&#160; I was hoping to get a
</I>&gt;<i> consensus here (and maybe even things spelled out more clearly in the spec),
</I>&gt;<i> so that all the implementations could be headed in the same direction.&#160; :-)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, May 22, 2009 at 8:03 PM, Maciej Stachowiak &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">mjs at apple.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On May 22, 2009, at 5:41 PM, Jeremy Orlow wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> What is the behavior of the following supposed to be?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> window.sessionStorage.removeItem = function(x) { alert(&quot;Wait, this
</I>&gt;&gt;&gt;<i> works?&quot;); };
</I>&gt;&gt;&gt;<i> window.sessionStorage.removeItem('blah');
</I>&gt;&gt;&gt;<i> alert(typeof window.sessionStorage.removeItem);
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Safari shows 2 alerts, and the second one says 'function'.
</I>&gt;&gt;&gt;<i> IE8 says &quot;object doesn't support this property or method&quot; if line 2 isn't
</I>&gt;&gt;&gt;<i> commented out. &#160;It returns type string when it is.
</I>&gt;&gt;&gt;<i> Mozilla also won't run if line 2 is there, but it returns type object for
</I>&gt;&gt;&gt;<i> line 3.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It seems to me that if IE8's behavior is correct, those parameters should
</I>&gt;&gt;&gt;<i> be marked as read-only since overriding them could only be used to shoot
</I>&gt;&gt;&gt;<i> yourself in the foot.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If Safari's implementation is correct (and it's good for the
</I>&gt;&gt;&gt;<i> implementations to be overridable), then I believe there needs to be some
</I>&gt;&gt;&gt;<i> safe way to make .clear() usable again. &#160;(Otherwise, once you override
</I>&gt;&gt;&gt;<i> removeItem() and clear(), there's not really any way to recover.) &#160;The spec
</I>&gt;&gt;&gt;<i> would also need to make it clear that removeItem, setItem, etc are special
</I>&gt;&gt;&gt;<i> and should not be serialized to disk.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Apologies if this is clear in the spec and I somehow missed it. &#160;But, if
</I>&gt;&gt;&gt;<i> not, I think a clarification might be necessary.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> DOM methods are normally overridable. That would make the Safari behavior
</I>&gt;&gt;<i> correct. If we want the behavior to be different in this case, then the spec
</I>&gt;&gt;<i> should spell that out. Perhaps part of the issue here is that the definition
</I>&gt;&gt;<i> of the [NameSetter] extended attribute in Web IDL doesn't make clear whether
</I>&gt;&gt;<i> or not name setter behavior takes precedence over setting existing
</I>&gt;&gt;<i> predefined attributes or methods.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i> Maciej
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062228.html">[whatwg] Overriding functions in DOM Storage
</A></li>
	<LI>Next message: <A HREF="062230.html">[whatwg] Overriding functions in DOM Storage
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62229">[ date ]</a>
              <a href="thread.html#62229">[ thread ]</a>
              <a href="subject.html#62229">[ subject ]</a>
              <a href="author.html#62229">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
