<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Workers and URL origin check
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Workers%20and%20URL%20origin%20check&In-Reply-To=%3C63df84f0905281241n1ab28b7ck26796b83a7412c1d%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062262.html">
   <LINK REL="Next"  HREF="062242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Workers and URL origin check</H1>
<!--htdig_noindex-->
    <B>Jonas Sicking</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Workers%20and%20URL%20origin%20check&In-Reply-To=%3C63df84f0905281241n1ab28b7ck26796b83a7412c1d%40mail.gmail.com%3E"
       TITLE="[whatwg] Workers and URL origin check">jonas at sicking.cc
       </A><BR>
    <I>Thu May 28 12:41:34 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="062262.html">[whatwg] Workers and URL origin check
</A></li>
        <LI>Next message: <A HREF="062242.html">[whatwg] Workers and URL origin check
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62251">[ date ]</a>
              <a href="thread.html#62251">[ thread ]</a>
              <a href="subject.html#62251">[ subject ]</a>
              <a href="author.html#62251">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, May 28, 2009 at 9:50 AM, Drew Wilson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">atwilson at google.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, May 28, 2009 at 1:11 AM, Jonas Sicking &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jonas at sicking.cc</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, May 27, 2009 at 6:15 PM, Drew Wilson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">atwilson at google.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt; Along the same lines, I'm wondering why we require a same-domain check
</I>&gt;&gt;<i> &gt; for
</I>&gt;&gt;<i> &gt; initial worker URLs, but not for script imported via importScripts().
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is because workers run in a security context of the initial
</I>&gt;&gt;<i> worker URL. So this is the origin that is used for security checks
</I>&gt;&gt;<i> whenever the worker does something, like load data using
</I>&gt;&gt;<i> XMLHttpRequest.
</I>&gt;<i>
</I>&gt;<i> I'm not quite sure why importScripts() should behave more like a &lt;script&gt;
</I>&gt;<i> tag than the Worker constructor itself. There's no reason why I shouldn't be
</I>&gt;<i> able to do Worker(&quot;<A HREF="http://foo.com/worker.js">http://foo.com/worker.js</A>&quot;) if I can do
</I>&gt;<i> importScript(&quot;<A HREF="http://foo.com/worker.js">http://foo.com/worker.js</A>&quot;).
</I>
importScripts() have to behave like &lt;script&gt; since both import script
into an existing security context.

So the question is if the Worker construct should create a new
security context or not.

&gt;&gt;<i> importScripts() however behave more like &lt;script&gt; in that they run the
</I>&gt;&gt;<i> loaded script in the security context of the worked that loaded them.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Seems
</I>&gt;&gt;<i> &gt; like we ought to have workers inherit the origin of the script context
</I>&gt;&gt;<i> &gt; that
</I>&gt;&gt;<i> &gt; invoked the Worker constructor, but allow the script URL passed to the
</I>&gt;&gt;<i> &gt; constructor to point at any domain.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That would be another solution to this problem, however some people
</I>&gt;&gt;<i> preferred the solution that is currently in the spec.
</I>&gt;<i>
</I>&gt;<i> Can anyone explain the motivation? A search of the archives isn't yielding
</I>&gt;<i> anything particularly useful - the earliest mention I could find was someone
</I>&gt;<i> from August of last year saying that essentially the same thing: &quot;some
</I>&gt;<i> people thought it was not safe&quot; with no details.
</I>
Personally I don't have a strong opinion either way for dedicated workers.

But I do note that shared workers more or less have to create a new
security context since they can be used by several different windows
and thus it wouldn't make sense for them to use the same security
context as any one of those windows.

/ Jonas

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062262.html">[whatwg] Workers and URL origin check
</A></li>
	<LI>Next message: <A HREF="062242.html">[whatwg] Workers and URL origin check
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62251">[ date ]</a>
              <a href="thread.html#62251">[ thread ]</a>
              <a href="subject.html#62251">[ subject ]</a>
              <a href="author.html#62251">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
