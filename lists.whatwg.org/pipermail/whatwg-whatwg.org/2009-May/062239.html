<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Workers and URL origin check
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Workers%20and%20URL%20origin%20check&In-Reply-To=%3Cf965ae410905271815s77e8e84di53370f0da6035076%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062238.html">
   <LINK REL="Next"  HREF="062243.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Workers and URL origin check</H1>
<!--htdig_noindex-->
    <B>Drew Wilson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Workers%20and%20URL%20origin%20check&In-Reply-To=%3Cf965ae410905271815s77e8e84di53370f0da6035076%40mail.gmail.com%3E"
       TITLE="[whatwg] Workers and URL origin check">atwilson at google.com
       </A><BR>
    <I>Wed May 27 18:15:17 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="062238.html">[whatwg] Workers and URL origin check
</A></li>
        <LI>Next message: <A HREF="062243.html">[whatwg] Workers and URL origin check
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62239">[ date ]</a>
              <a href="thread.html#62239">[ thread ]</a>
              <a href="subject.html#62239">[ subject ]</a>
              <a href="author.html#62239">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Along the same lines, I'm wondering why we require a same-domain check for
initial worker URLs, but not for script imported via importScripts(). Seems
like we ought to have workers inherit the origin of the script context that
invoked the Worker constructor, but allow the script URL passed to the
constructor to point at any domain.

Is there a motivating security concern for this language from section
4.8.2?:

&gt;<i> If the origin of the resulting absolute URL is not the same as the origin
</I>&gt;<i> of the script that invoked the constructor, then throw a security
</I>&gt;<i> exception.
</I>&gt;<i>
</I>It seems like it makes it harder for people to share script across domains
without actually providing any security.

-atw

On Wed, May 27, 2009 at 5:13 PM, Dmitry Titov &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">dimich at chromium.org</A>&gt; wrote:

&gt;<i> Hi WHATWG!
</I>&gt;<i> I have a question about URL origin check for Workers: the spec, in 4.8.2,
</I>&gt;<i> mandates a check for the Worker URL to be the 'same origin' with the parent
</I>&gt;<i> document's URL. At the same time, 4.2 says the origin of the worker is
</I>&gt;<i> derived later from the URL represented by the 'location' object of the
</I>&gt;<i> worker context.
</I>&gt;<i>
</I>&gt;<i> However, the spec doesn't say how redirects should be processed. If a
</I>&gt;<i> browser gets 30x redirect request, the final URL of a worker can be
</I>&gt;<i> different from the original one which has passed the check before loading.
</I>&gt;<i> Current spec ignores the fact that origin can be changed via redirect. If
</I>&gt;<i> the origin of the loaded worker is based on the final (potentially
</I>&gt;<i> redirected) URL that 'location' object represents, then subsequent XHR
</I>&gt;<i> requests, nested workers and importScripts() will work in the origin of that
</I>&gt;<i> final URL. As specified, in case of redirect the page from &quot;
</I>&gt;<i> <A HREF="http://applicationInternals.com">http://applicationInternals.com</A>&quot; can use a worker from &quot;
</I>&gt;<i> <A HREF="http://application.com">http://application.com</A>&quot; (via redirect) to access APIs of application.comthat were not necessarily intended for such consumption.
</I>&gt;<i>
</I>&gt;<i> Should the spec simply require the redirected, final URLs to be checked
</I>&gt;<i> against parent's and reject the script if redirection results in a different
</I>&gt;<i> origin?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Dmitry
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090527/c087e932/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20090527/c087e932/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062238.html">[whatwg] Workers and URL origin check
</A></li>
	<LI>Next message: <A HREF="062243.html">[whatwg] Workers and URL origin check
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62239">[ date ]</a>
              <a href="thread.html#62239">[ thread ]</a>
              <a href="subject.html#62239">[ subject ]</a>
              <a href="author.html#62239">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
