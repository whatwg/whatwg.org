<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] [WA1] Specifying Character Encoding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BWA1%5D%20Specifying%20Character%20Encoding&In-Reply-To=%3CB67DA1B9-207A-404C-9A0D-B3E83B5B7FB6%40iki.fi%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="051997.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] [WA1] Specifying Character Encoding</H1>
<!--htdig_noindex-->
    <B>Henri Sivonen</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%5BWA1%5D%20Specifying%20Character%20Encoding&In-Reply-To=%3CB67DA1B9-207A-404C-9A0D-B3E83B5B7FB6%40iki.fi%3E"
       TITLE="[whatwg] [WA1] Specifying Character Encoding">hsivonen at iki.fi
       </A><BR>
    <I>Thu Mar  1 01:12:28 PST 2007</I>
    <P><UL>
        
        <LI>Next message: <A HREF="051997.html">[whatwg] &lt;video&gt; element proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51996">[ date ]</a>
              <a href="thread.html#51996">[ thread ]</a>
              <a href="subject.html#51996">[ subject ]</a>
              <a href="author.html#51996">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mar 1, 2007, at 03:58, Ian Hickson wrote:
&gt;<i> On Sat, 9 Apr 2005, Lachlan Hunt wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In the current draft, for specifying the character encoding [1],  
</I>&gt;&gt;<i> it is
</I>&gt;&gt;<i> stated:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> | In XHTML, the XML declaration should be used for inline character
</I>&gt;&gt;<i> | encoding information.
</I>&gt;&gt;<i> |
</I>&gt;&gt;<i> | Authors should avoid including inline character encoding  
</I>&gt;&gt;<i> information.
</I>&gt;&gt;<i> | Character encoding information should instead be included at the
</I>&gt;&gt;<i> | transport level (e.g. using the HTTP Content-Type header).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The second paragraph should only apply to HTML using the meta  
</I>&gt;&gt;<i> element,
</I>&gt;&gt;<i> not XHTML using the XML declaration.
</I>&gt;<i>
</I>&gt;<i> I don't understand why it would be ok for one and not the other.
</I>...
&gt;<i> I could see an argument for removing the advice from the HTML5 spec  
</I>&gt;<i> altogether, though. What do you think?
</I>
I think that encoding information should be included in the HTTP  
payload. In my opinion, the spec should not advice against this.  
Preferably, it would encourage putting the encoding information in  
the payload. (The BOM or, in the case of XML, the UTF-8 defaulting of  
the XML sniffing algorithm are fine.)

Rationale:
  1) Ruby's Postulate.
  2) It just uncool that I have to add the charset meta to the WA 1.0  
spec if I download it to disk and typeset it for printing using  
Prince which does not see the original HTTP headers. Real documents  
do get detached from HTTP.

For application/xml and application/xhtml+xml, HTTP-level charset is  
harmful, because the internal info is reliable and efficiently  
sniffed, so the HTTP-level stuff is either redundant or wrong.

For text/html, also providing HTTP-level charset makes sense, because  
internal encoding info sniffing is inefficient.

The text/xml type is considered harmful.

I think it should be a conformance requirement that the HTTP-level  
encoding info and the internal payload info agree if both are supplied.

On Mar 1, 2007, at 09:13, Julian Reschke wrote:

&gt;<i> If a proxy transcodes xhtml today, and does not modify the XML  
</I>&gt;<i> declaration (when present), it will break the content, right?
</I>
  * A transcoding proxy that does not modify the XML declaration and  
tampers with application/* is broken.
  * Before basing advice on conjecture about transcoding proxies, it  
should be shown that transcoding proxies exist, are deployed (and for  
a good reason) and their true nature should be researched. (For now,  
I am treating non-reverse transcoding proxies as an urban legend.)
  * Distributed UAs (where the proxy and the client are more tightly  
coupled than in an HTTP client/proxy case, such as Opera Mini) do not  
count.
  * Russian Apache is not a trancoding proxy. It is a transcoding  
origin server.
  * Reverse proxies (e.g. <A HREF="http://apache.webthing.com/mod_proxy_html/">http://apache.webthing.com/mod_proxy_html/</A>)  
are origin servers as far as browsers are concerned. Whatever reverse  
proxies break is within the control of the reverse proxy operator.
  * When pages follow the best practice of being encoded as UTF-8,  
there is no legitimate reason to transcode.
  * Browsers have supported all the relevant Cyrillic and Japanese  
encodings for years, so the argumentation about Russian and Japanese  
transcoding proxy needs falls flat today.

-- 
Henri Sivonen
<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">hsivonen at iki.fi</A>
<A HREF="http://hsivonen.iki.fi/">http://hsivonen.iki.fi/</A>



</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="051997.html">[whatwg] &lt;video&gt; element proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51996">[ date ]</a>
              <a href="thread.html#51996">[ thread ]</a>
              <a href="subject.html#51996">[ subject ]</a>
              <a href="author.html#51996">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
