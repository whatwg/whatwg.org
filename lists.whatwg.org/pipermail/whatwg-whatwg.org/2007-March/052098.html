<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Distinguishing XML and HTML by content sniffing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Distinguishing%20XML%20and%20HTML%20by%20content%20sniffing&In-Reply-To=%3C45ECA6E4.5080306%40yeslogic.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="052061.html">
   <LINK REL="Next"  HREF="052074.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Distinguishing XML and HTML by content sniffing</H1>
<!--htdig_noindex-->
    <B>Michael Day</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Distinguishing%20XML%20and%20HTML%20by%20content%20sniffing&In-Reply-To=%3C45ECA6E4.5080306%40yeslogic.com%3E"
       TITLE="[whatwg] Distinguishing XML and HTML by content sniffing">mikeday at yeslogic.com
       </A><BR>
    <I>Mon Mar  5 15:25:24 PST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="052061.html">[whatwg] Distinguishing XML and HTML by content sniffing
</A></li>
        <LI>Next message: <A HREF="052074.html">[whatwg] Alternativeness of multiple &lt;dd&gt;s
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52098">[ date ]</a>
              <a href="thread.html#52098">[ thread ]</a>
              <a href="subject.html#52098">[ subject ]</a>
              <a href="author.html#52098">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Simon,

&gt;<i> If you load a file from disk, then use any meta information the OS can 
</I>&gt;<i> provide. (I think Linux can store Content-Type information for files.) 
</I>&gt;<i> If the OS relies on file extensions (like Windows does) then use that.
</I>
Some Linux file systems might potentially be capable of storing extra
metadata in extended attributes, but in practice I haven't seen any
Linux distributions actually use this functionality for storing the
content type of files. This basically leaves us with file extensions,
just like Windows.

&gt;<i> .htm and .html are HTML. I know of lots of HTML documents that start 
</I>&gt;<i> with an &quot;XML declaration&quot; but are not well-formed if parsed as XML. (For 
</I>&gt;<i> starters, some version of DreamWeaver emitted XML declarations for 
</I>&gt;<i> documents, but did not ensure well-formedness and the result is often 
</I>&gt;<i> not well-formed.) Even if it was well-formed, it probably wasn't tested 
</I>&gt;<i> under XML conditions so it's likely that style sheets and scripts only 
</I>&gt;<i> work correctly under HTML conditions.
</I>
Given that Prince serves a different niche than most user agents, our 
users tend to be more likely to use XML with embedded SVG etc., and less 
likely to run Prince on documents created by DreamWeaver. When Prince is 
run on a document retrieved over HTTP it obeys the Content-Type header, 
so that documents on the web will be parsed as HTML.

However, it is true that if a document that appears to be XML but 
actually isn't is downloaded and saved as a file then Prince will try to 
load it as XML rather than HTML after sniffing the content in the 
absence of a Content-Type header. The user will then receive error 
messages if the document is not well-formed. In practice, this case does 
not seem to arise very often, but if it encourages people to either fix 
their XML and make it well-formed or stop pretending that their HTML is 
XML then that doesn't sound like such a bad thing :)

&gt;<i> If an author authored a document and testing it with Prince, finding 
</I>&gt;<i> that XML-only features work even with a .html file extension, then it is 
</I>&gt;<i> likely that that document would break in browsers (because XML-only 
</I>&gt;<i> features don't work in HTML).
</I>
This comes back to the thorny issue of how MathML is supposed to work on 
the web. It seems to require that content be served up as XHTML, which 
no one does, or that HTML documents contain &quot;XML islands&quot;, which is not 
well specified at all. It would be nice if HTML5 could tackle this in a 
way that makes sense.

&gt;<i> HTML5 has specified content-sniffing rules, FWIW: 
</I>&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/#content-type-sniffing">http://www.whatwg.org/specs/web-apps/current-work/#content-type-sniffing</A>
</I>
Yes, these rules never seem to identify a document as being XML, though.

&gt;<i> See also: <A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=1500">http://www.w3.org/Bugs/Public/show_bug.cgi?id=1500</A>
</I>
Prince always respects the Content-Type header, and only sniffs document 
content when no such metadata is available.

Best regards,

Michael

-- 
Print XML with Prince!
<A HREF="http://www.princexml.com">http://www.princexml.com</A>

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="052061.html">[whatwg] Distinguishing XML and HTML by content sniffing
</A></li>
	<LI>Next message: <A HREF="052074.html">[whatwg] Alternativeness of multiple &lt;dd&gt;s
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#52098">[ date ]</a>
              <a href="thread.html#52098">[ thread ]</a>
              <a href="subject.html#52098">[ subject ]</a>
              <a href="author.html#52098">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
