<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] XMLHttpRequest.responseXML and invalid XML documents
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20XMLHttpRequest.responseXML%20and%20invalid%20XML%20documents&In-Reply-To=%3C43DF7584.4992.38730380%40hallvord.hallvord.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005603.html">
   <LINK REL="Next"  HREF="005687.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] XMLHttpRequest.responseXML and invalid XML documents</H1>
<!--htdig_noindex-->
    <B>Hallvord Reiar Michaelsen Steen</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20XMLHttpRequest.responseXML%20and%20invalid%20XML%20documents&In-Reply-To=%3C43DF7584.4992.38730380%40hallvord.hallvord.com%3E"
       TITLE="[whatwg] XMLHttpRequest.responseXML and invalid XML documents">hallvord at hallvord.com
       </A><BR>
    <I>Mon Jan 30 21:34:44 PST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="005603.html">[whatwg] XMLHttpRequest.responseXML and invalid XML documents
</A></li>
        <LI>Next message: <A HREF="005687.html">[whatwg] XMLHttpRequest.responseXML and invalid XML documents
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5680">[ date ]</a>
              <a href="thread.html#5680">[ thread ]</a>
              <a href="subject.html#5680">[ subject ]</a>
              <a href="author.html#5680">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 25 Jan 2006 at 20:54, Hallvord Reiar Michaelsen Ste wrote:

&gt;<i> &gt; Spec says about responseXML : 
</I>&gt;<i> &gt; &gt; If the document was not an XML document, or if the document could
</I>&gt;<i> &gt; &gt; not be parsed (due to an XML well-formedness error or unsupported
</I>&gt;<i> &gt; &gt; character encoding, for instance), returns null.
</I>
All UAs I test in ignore an unknown character encoding value and 
parses the document anyway. I'm not sure if the sentence above is 
meant to distinguish between charset=&quot;bogus-charset&quot; and charset=&quot;utf-
64&quot; (in other words, a charset the UA might be aware that it doesn't 
support - as opposed to a completely uknown one).

Suggest removing the unsupported character encoding statement from 
this sentence. The spec should say that when an unknown character 
encoding is used the UA should assume UTF-8 and move on with parsing.

This is what Opera and FireFox do (consistently) and what IE does but 
only for responseText. IE creates an empty responseXML document if 
charset is unknown.

Currently the spec says only text/xml, application/xml or content-
types ending with +xml will cause the UA to create a responseXML 
document. I suggest this should also apply to text/html if the 
document is wellformed. This is implemented in Opera.

Proposed new text:

   &lt;dd&gt;If the &lt;code title=&quot;XMLHttpRequest.readyState&quot;&gt;&lt;a
    href=&quot;#readystate&quot;&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute has a value other than
    4 (Loaded), returns null. Otherwise, if the &lt;code&gt;Content-Type&lt;/code&gt;
    header is either &lt;code&gt;text/html&lt;/code&gt;, &lt;code&gt;text/xml&lt;/code&gt;, 
    &lt;code&gt;application/xml&lt;/code&gt;, or ends in &lt;code&gt;+xml&lt;/code&gt;,
    returns an object that implements the Document interface
    representing the parsed document. If the document was not an
    XML document, or if the document could not be parsed (due to an XML
    well-formedness error, for instance), returns an empty document.&lt;/dd&gt;

-- 
Hallvord Reiar Michaelsen Steen
<A HREF="http://www.hallvord.com/">http://www.hallvord.com/</A>



</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005603.html">[whatwg] XMLHttpRequest.responseXML and invalid XML documents
</A></li>
	<LI>Next message: <A HREF="005687.html">[whatwg] XMLHttpRequest.responseXML and invalid XML documents
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5680">[ date ]</a>
              <a href="thread.html#5680">[ thread ]</a>
              <a href="subject.html#5680">[ subject ]</a>
              <a href="author.html#5680">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
