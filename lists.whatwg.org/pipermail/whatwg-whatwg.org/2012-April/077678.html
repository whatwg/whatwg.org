<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Fixing two security vulnerabilities in	registerProtocolHandler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Fixing%20two%20security%20vulnerabilities%20in%0A%09registerProtocolHandler&In-Reply-To=%3CCAKvcKK%3DsbH_ziZU_%3D04gjOCaYiN6QVdUf9LLGVLaASm0gjm0Ww%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077677.html">
   <LINK REL="Next"  HREF="077679.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Fixing two security vulnerabilities in	registerProtocolHandler</H1>
<!--htdig_noindex-->
    <B>Tyler Close</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Fixing%20two%20security%20vulnerabilities%20in%0A%09registerProtocolHandler&In-Reply-To=%3CCAKvcKK%3DsbH_ziZU_%3D04gjOCaYiN6QVdUf9LLGVLaASm0gjm0Ww%40mail.gmail.com%3E"
       TITLE="[whatwg] Fixing two security vulnerabilities in	registerProtocolHandler">tyler.close at gmail.com
       </A><BR>
    <I>Mon Apr  9 17:11:53 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077677.html">[whatwg] Fixing two security vulnerabilities in	registerProtocolHandler
</A></li>
        <LI>Next message: <A HREF="077679.html">[whatwg] Fixing two security vulnerabilities in	registerProtocolHandler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77678">[ date ]</a>
              <a href="thread.html#77678">[ thread ]</a>
              <a href="subject.html#77678">[ subject ]</a>
              <a href="author.html#77678">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Apr 9, 2012 at 4:48 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
&gt;<i> On Mon, 9 Apr 2012, Tyler Close wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The RPH handler doesn't need to know which is the legit site. The RPH
</I>&gt;&gt;<i> handler just needs to know that it's getting the RPH data from the site
</I>&gt;&gt;<i> that the user was interacting with, not some other unseen site running
</I>&gt;&gt;<i> in the browser.
</I>&gt;<i>
</I>&gt;<i> Nothing we have discussed so far would provide such a guarantee.
</I>
Yes, what I am proposing provides that guarantee. When an iframe is
initially navigated to a mailto URL, the browser starts its RPH
dispatch logic. In Firefox, this means a Picker dialog is shown and
the user selects an RPH handler. The browser then navigates the iframe
to the RPH handler URL and, under my proposal, would populate a DOM
field containing the mailto URL. If at any point in this sequence an
attacker navigates the iframe to a different, non-RPH URL, that page
loads and the browser does not populate the RPH DOM field (since it's
not an RPH navigation). If the attacker navigates the iframe to
another RPH URL, then Firefox will show another Picker dialog, making
the attack visible. Alternatively, the browser could refuse to do
repeated RPH navigation of the same iframe.

&gt;&gt;<i> The vulnerability is that window.location can be overwritten by other
</I>&gt;&gt;<i> code running in the browser.
</I>&gt;<i>
</I>&gt;<i> Then we should fix _that_.
</I>
I was under the impression that the descendant policy on frame
navigation was baked into the Web at this point and could not be
changed. We also want RPH dispatch to be secure in cases where the
client is an iframe, not a top level page. For example, a widget
running on a social networking page should be able to securely send
data to a user selected RPH handler.

--Tyler

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077677.html">[whatwg] Fixing two security vulnerabilities in	registerProtocolHandler
</A></li>
	<LI>Next message: <A HREF="077679.html">[whatwg] Fixing two security vulnerabilities in	registerProtocolHandler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77678">[ date ]</a>
              <a href="thread.html#77678">[ thread ]</a>
              <a href="subject.html#77678">[ subject ]</a>
              <a href="author.html#77678">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
