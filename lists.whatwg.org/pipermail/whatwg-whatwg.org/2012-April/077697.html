<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Encoding: big5 and big5-hkscs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Encoding%3A%20big5%20and%20big5-hkscs&In-Reply-To=%3Cop.wcm5m1t5sr6mfa%40kirk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077662.html">
   <LINK REL="Next"  HREF="077698.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Encoding: big5 and big5-hkscs</H1>
<!--htdig_noindex-->
    <B>Philip J&#228;genstedt</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Encoding%3A%20big5%20and%20big5-hkscs&In-Reply-To=%3Cop.wcm5m1t5sr6mfa%40kirk%3E"
       TITLE="[whatwg] Encoding: big5 and big5-hkscs">philipj at opera.com
       </A><BR>
    <I>Thu Apr 12 00:26:51 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077662.html">[whatwg] Encoding: big5 and big5-hkscs
</A></li>
        <LI>Next message: <A HREF="077698.html">[whatwg] Encoding: big5 and big5-hkscs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77697">[ date ]</a>
              <a href="thread.html#77697">[ thread ]</a>
              <a href="subject.html#77697">[ subject ]</a>
              <a href="author.html#77697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, 09 Apr 2012 03:08:20 +0200, &#216;istein E. Andersen &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">liszt at coq.no</A>&gt;  
wrote:

&gt;<i> On 8 Apr 2012, at 18:03, Philip J&#228;genstedt wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Sat, 07 Apr 2012 16:04:55 +0200, &#216;istein E. Andersen &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">liszt at coq.no</A>&gt;  
</I>&gt;&gt;<i> wrote:
</I>
&gt;&gt;&gt;<i> Suggested change:  map C6CD to U+5E7A.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> These are the existing mappings:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> C6CD =&gt;
</I>&gt;&gt;<i> opera-hk: U+2F33 &#12083;
</I>&gt;&gt;<i> firefox: U+5E7A &#24186;
</I>&gt;&gt;<i> chrome: U+F6DD &#63197;
</I>&gt;&gt;<i> firefox-hk: U+5E7A &#24186;
</I>&gt;&gt;<i> opera: U+2F33 &#12083;
</I>&gt;&gt;<i> chrome-hk: U+2F33 &#12083;
</I>&gt;&gt;<i> internetexplorer: U+F6DD &#63197;
</I>&gt;&gt;<i> hkscs-2008: &lt;U+2F33&gt; &#12083;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> At least on the Web, this isn't a question of HK vs non-HK mappings.  
</I>&gt;&gt;<i> Other than Firefox, which (de-facto) specs or implementations use  
</I>&gt;&gt;<i> U+5E7A?
</I>&gt;<i>
</I>&gt;<i> I have now had a closer look at my notes  
</I>&gt;<i> (&lt;<A HREF="http://coq.no/character-tables/chinese-traditional/en">http://coq.no/character-tables/chinese-traditional/en</A>&gt;). My argument  
</I>&gt;<i> for U+5E7A goes as follows:
</I>&gt;<i>
</I>&gt;<i> Of the 214 Kangxi radicals, 186 appear (as normal Han character) in CNS  
</I>&gt;<i> 11643 Planes 1 or 2, whereas 25 appear in Plane 3 and 3 are missing  
</I>&gt;<i> altogether.  Big5 only covers Planes 1 and 2, which means that 28 Kangxi  
</I>&gt;<i> radicals (which may be rare in running text, but are nevertheless  
</I>&gt;<i> important) are missing.  The E-Ten 1 extension encodes 25 of the missing  
</I>&gt;<i> radicals in the range C6BF--C6D7.  Unlike CNS 11643 and Unicode, Big5  
</I>&gt;<i> does not encode radicals twice (as radicals and normal characters).   
</I>&gt;<i> This means that Big5 with the E-Ten 1 extension contains 211 of the 214  
</I>&gt;<i> Kangxi radicals, all mapped to normal Han characters, and no codepoints  
</I>&gt;<i> mapped to Unicode Kangxi Radicals in the range U+2F00--U+2FD5.
</I>&gt;<i>
</I>&gt;<i> In summary:  although E-Ten 1 was not defined in terms of Unicode, it is  
</I>&gt;<i> clear that the 25 radicals were all meant to map to normal Han  
</I>&gt;<i> characters, not to the special radical characters found in CNS 11643 and  
</I>&gt;<i> Unicode.
</I>&gt;<i>
</I>&gt;<i> Enter HKSCS.  20 of the E-Ten 1 Kangxi radical mappings (along with the  
</I>&gt;<i> rest of E-Ten 1 and E-Ten 2, or almost) are adopted, but the remaining 5  
</I>&gt;<i> are instead given new codepoints elsewhere.  Whatever the reason be, 4  
</I>&gt;<i> of the 5 unused E-Ten positions are simply left undefined in the HKSCS  
</I>&gt;<i> standard, which is not much of a problem for a unified HK/non-HK Big5  
</I>&gt;<i> encoding.  Unfortunately, the position C6CD was not left undefined, but  
</I>&gt;<i> instead mapped to U+2F33 (&#12083;), the Unicode Kangxi Radical version of  
</I>&gt;<i> U+5E7A (&#24186;), thus introducing not only the only Unicode Kangxi Radical  
</I>&gt;<i> into the HKSCS standard, but also a Unicode mapping that is incompatible  
</I>&gt;<i> with previous Big5 versions.  I wish I knew why.
</I>&gt;<i>
</I>&gt;&gt;<i> Possibly, one could argue that U+2F33 normalizes (NFKC) to U+5E7A, but  
</I>&gt;&gt;<i> it's not the only hanzi in HKSCS-2008 that normalizes into something  
</I>&gt;&gt;<i> else:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 8BC3 =&gt; &lt;U+2F878&gt; &#194680; =&gt; &lt;U+5C6E&gt; &#23662;
</I>&gt;&gt;<i> 8BF8 =&gt; &lt;U+F907&gt; &#63751; =&gt; &lt;U+9F9C&gt; &#40860;
</I>&gt;&gt;<i> 8EFD =&gt; &lt;U+2F994&gt; &#194964; =&gt; &lt;U+82B3&gt; &#33459;
</I>&gt;&gt;<i> 8FA8 =&gt; &lt;U+2F9B2&gt; &#194994; =&gt; &lt;U+456B&gt; &#17771;
</I>&gt;&gt;<i> 8FF0 =&gt; &lt;U+2F9D4&gt; &#195028; =&gt; &lt;U+8CAB&gt; &#36011;
</I>&gt;&gt;<i> C6CD =&gt; &lt;U+2F33&gt; &#12083; =&gt; &lt;U+5E7A&gt; &#24186;
</I>&gt;&gt;<i> 957A =&gt; &lt;U+2F9BC&gt; &#195004; =&gt; &lt;U+8728&gt; &#34600;
</I>&gt;&gt;<i> 9874 =&gt; &lt;U+2F825&gt; &#194597; =&gt; &lt;U+52C7&gt; &#21191;
</I>&gt;&gt;<i> 9AC8 =&gt; &lt;U+2F83B&gt; &#194619; =&gt; &lt;U+5406&gt; &#21510;
</I>&gt;&gt;<i> 9C52 =&gt; &lt;U+2F8CD&gt; &#194765; =&gt; &lt;U+6649&gt; &#26185;
</I>&gt;&gt;<i> A047 =&gt; &lt;U+2F840&gt; &#194624; =&gt; &lt;U+54A2&gt; &#21666;
</I>&gt;&gt;<i> FC48 =&gt; &lt;U+2F894&gt; &#194708; =&gt; &lt;U+5F22&gt; &#24354;
</I>&gt;&gt;<i> FC77 =&gt; &lt;U+2F8A6&gt; &#194726; =&gt; &lt;U+6148&gt; &#24904;
</I>&gt;<i>
</I>&gt;<i> The other pairs all contain characters that look slightly different,  
</I>&gt;<i> whereas U+5E7A and U+2F33 look the same (and, I believe, are supposed to  
</I>&gt;<i> look the same), the only difference being that the former is a normal  
</I>&gt;<i> Han character whereas the latter carries the additional semantics of  
</I>&gt;<i> being a Kangxi radical.
</I>
That the characters in the above list look slightly different is really a  
font issue, they are canonically equivalent in Unicode and therefore the  
same, AFAICT.

&gt;&gt;<i> I'm not sure what the conclusion is...
</I>&gt;<i>
</I>&gt;<i> I am not entirely sure either.  It seems clear that the mapping from  
</I>&gt;<i> C6CD to U+2F33 makes no sense for non-HKSCS Big5 (which does not encode  
</I>&gt;<i> U+5E7A anywhere else), but it does not seem to make much sense for  
</I>&gt;<i> Big5-HKSCS either, which suggests that I might be missing something.
</I>
U+2F33 is indeed the only Kangxi Radical (2F00-2FDF) mapped by HKSCS-2008  
and I agree that it's weird. However, unless U+2F33 causes problems on  
real-world pages, I'm not really comfortable with fixing bugs in  
HKSCS-2008, at least not based only on agreement by two Northern Europeans  
like us... If users or implementors from Hong Kong or Taiwan also speak up  
for U+5E7A, then I will not object. I posted  
&lt;<A HREF="http://lists.w3.org/Archives/Public/public-html-ig-zh/2012Apr/0001.html">http://lists.w3.org/Archives/Public/public-html-ig-zh/2012Apr/0001.html</A>&gt;  
a few days ago seeking such feedback, but so far no one has commented on  
this specific issue.

&gt;&gt;&gt;<i> On Fri Apr 6 06:42:26 PDT 2012, Philip J&#228;genstedt &lt;philipj at  
</I>&gt;&gt;&gt;<i> opera.com&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Also, a single mapping fails the Big5-contra[di]ction test:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> F9FE =&gt;
</I>&gt;&gt;&gt;&gt;<i> opera-hk: U+FFED &#65517;
</I>&gt;&gt;&gt;&gt;<i> firefox: U+2593 &#9619;
</I>&gt;&gt;&gt;&gt;<i> chrome: U+2593 &#9619;
</I>&gt;&gt;&gt;&gt;<i> firefox-hk: U+2593 &#9619;
</I>&gt;&gt;&gt;&gt;<i> opera: U+2593 &#9619;
</I>&gt;&gt;&gt;&gt;<i> chrome-hk: U+FFED &#65517;
</I>&gt;&gt;&gt;&gt;<i> internetexplorer: U+2593 &#9619;
</I>&gt;&gt;&gt;&gt;<i> hkscs-2008: &lt;U+FFED&gt; &#65517;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I'd say that we should go with U+FFED here, since that's what the  
</I>&gt;&gt;&gt;&gt;<i> [HKSCS-2008] spec
</I>&gt;&gt;&gt;&gt;<i> says and it's visually close anyway.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Given that the goal is to define a unified Big5 (non-HK) and  
</I>&gt;&gt;&gt;<i> Big5-HKSCS encoding and that this seems to be a case of the HK  
</I>&gt;&gt;&gt;<i> standard going against everything and everyone else, perhaps more  
</I>&gt;&gt;&gt;<i> weight should be given to existing specifications and  
</I>&gt;&gt;&gt;<i> (non-HK-specific) implementations.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Suggested change:  map F9FE to U+2593
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is the only mapping where IE maps something other than PUA or &quot;?&quot;  
</I>&gt;&gt;<i> that my mapping doesn't agree on, so I don't object to changing it.  
</I>&gt;&gt;<i> Still, it would be very interesting to know why HKSCS-2008 changed it,  
</I>&gt;&gt;<i> do you know?
</I>&gt;<i>
</I>&gt;<i> No, I am afraid not.  I have been wondering as well, but I have not been  
</I>&gt;<i> able to find an explanation.
</I>&gt;<i>
</I>&gt;<i> Lunde (if I remember correctly, 1st Edn) and Kano's 'Developing  
</I>&gt;<i> International Software' (1st Edn, 1995) both show something like U+2593,  
</I>&gt;<i> but it could of course be that popular non-Unicode (HK) Big5 fonts had  
</I>&gt;<i> glyphs more like U+FFED, which would make the HKSCS-2008 mapping less  
</I>&gt;<i> surprising.  Do let me know if you discover any information on this.
</I>
On 8 Apr 2012, at 18:03, Philip J&#228;genstedt wrote:

&gt;<i> I was misremembering:  Lunde actually shows a solid black square, so it  
</I>&gt;<i> looks like Microsoft may have changed this in its CP950 and HKSCS-2008  
</I>&gt;<i> restored the original meaning.  [U+FFED does not seem quite right  
</I>&gt;<i> (half-width looks implausible), but let us not start discussing all the  
</I>&gt;<i> different black solid squares in Unicode.]
</I>&gt;<i>
</I>&gt;<i> Given the above, following HKSCS-2008 appears to be the best solution,  
</I>&gt;<i> which brings the number of problematic forward mappings down to one.
</I>
U+FFED decomposes to U+25A0 which could perhaps be more appropriate, but I  
suggest sticking with U+FFED and recommending people to use UTF-8 if they  
want some particular square shape.

&gt;&gt;&gt;<i> Duplicates and reverse mappings:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> [...]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [...] it clearly needs to be defined what to do for these 100 code  
</I>&gt;&gt;<i> points that have multiple mappings to Big5. I extended my Python script  
</I>&gt;&gt;<i> to find these 100 duplicates and to check what Python did for 'big5',  
</I>&gt;&gt;<i> falling back to 'big5-hkscs'. This is what it produced:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [...]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> These are the ones where you (&#216;istein) disagree:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> C6CF &lt;= U+5EF4
</I>&gt;&gt;&gt;<i> C6D3 &lt;= U+65E0
</I>&gt;&gt;&gt;<i> C6D5 &lt;= U+7676
</I>&gt;&gt;&gt;<i> C6D7 &lt;= U+96B6
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> AFAICT this has nothing to do with compatibility mappings, so what's  
</I>&gt;&gt;<i> the reason for this?
</I>&gt;<i>
</I>&gt;<i> As I wrote, '[o]nly these mappings will work for non-HK Big5  
</I>&gt;<i> implementations.'  My reasoning was that a random Big5 implementation  
</I>&gt;<i> would be more likely to include the E-Ten 1 extension than the HKSCS  
</I>&gt;<i> extension.  On the other hand, these codepoints could be less than ideal  
</I>&gt;<i> if major Big5-HKSCS implementations follow the standard strictly and map  
</I>&gt;<i> to nothing.
</I>

&gt;&gt;&gt;<i> F9E9 &lt;= U+255E
</I>&gt;&gt;&gt;<i> F9EA &lt;= U+256A
</I>&gt;&gt;&gt;<i> F9EB &lt;= U+2561
</I>&gt;&gt;&gt;<i> F9F9 &lt;= U+2550
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Python's big5-hkscs agrees, but Python's big5 does this instead:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> A2A5 &lt;= U+255E
</I>&gt;&gt;<i> A2A6 &lt;= U+256A
</I>&gt;&gt;<i> A2A7 &lt;= U+2561
</I>&gt;&gt;<i> A2A4 &lt;= U+2550
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It seems safer to go with the big5 mappings, but checking what browsers  
</I>&gt;&gt;<i> do would be helpful.
</I>&gt;<i>
</I>&gt;<i> Does this imply that Python's big5 (non-HK) implementation does not  
</I>&gt;<i> include the corresponding E-Ten 2 (forward) mappings for decoding either?
</I>
So says python3:

&gt;&gt;&gt;<i> b'\xf9\xe9'.decode('big5')
</I>Traceback (most recent call last):
   File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
UnicodeDecodeError: 'big5' codec can't decode bytes in position 0-1:  
illegal multibyte sequence
&gt;&gt;&gt;<i> b'\xf9\xe9'.decode('big5-hkscs')
</I>'&#9566;'

A2A4-A2A7 are fine in both big5 and big5-hkscs, however.

On Tue, 10 Apr 2012 17:00:03 +0200, &#216;istein E. Andersen &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">liszt at coq.no</A>&gt;  
wrote:

&gt;<i> Getting the double-stroked circle segments at F9FB..F9FD added to  
</I>&gt;<i> Unicode would make it possible to provide Unicode mappings in accordance  
</I>&gt;<i> with the original intent and remove four duplicate mappings.  This might  
</I>&gt;<i> be worthwhile if the characters have not been proposed and rejected  
</I>&gt;<i> already.
</I>
Are there any sites that use these line drawing characters that would be  
fixed by this? If not, I'm quite willing to accept the historical  
accidents and move on :)

-- 
Philip J&#228;genstedt
Core Developer
Opera Software

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077662.html">[whatwg] Encoding: big5 and big5-hkscs
</A></li>
	<LI>Next message: <A HREF="077698.html">[whatwg] Encoding: big5 and big5-hkscs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77697">[ date ]</a>
              <a href="thread.html#77697">[ thread ]</a>
              <a href="subject.html#77697">[ subject ]</a>
              <a href="author.html#77697">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
