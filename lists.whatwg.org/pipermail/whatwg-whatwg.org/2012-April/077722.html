<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Adding blending to the canvas API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Adding%20blending%20to%20the%20canvas%20API&In-Reply-To=%3C000901cd19de%24dc57fb40%249507f1c0%24%40net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077721.html">
   <LINK REL="Next"  HREF="077723.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Adding blending to the canvas API</H1>
<!--htdig_noindex-->
    <B>David Dailey</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Adding%20blending%20to%20the%20canvas%20API&In-Reply-To=%3C000901cd19de%24dc57fb40%249507f1c0%24%40net%3E"
       TITLE="[whatwg] Adding blending to the canvas API">ddailey at zoominternet.net
       </A><BR>
    <I>Fri Apr 13 18:35:23 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077721.html">[whatwg] Adding blending to the canvas API
</A></li>
        <LI>Next message: <A HREF="077723.html">[whatwg] Adding blending to the canvas API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77722">[ date ]</a>
              <a href="thread.html#77722">[ thread ]</a>
              <a href="subject.html#77722">[ subject ]</a>
              <a href="author.html#77722">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Perhaps if some of the browsers start to implement blend modes for
disposable graphics they'll finally start to do it properly for SVG as well.

I've had a devil of a time figuring out if Opera or IE/ASV properly handles
some of the effects at <A HREF="http://cs.sru.edu/~ddailey/svg/V9.svg">http://cs.sru.edu/~ddailey/svg/V9.svg</A> since none of
the other browsers are brave enough to try it. The first two diagrams should
display, respectively, additive and subtractive color, while some of the
others experiment with more intuitive color models using feImage to find
region intersections and or simple opacity. Humans, without training tend
not to thing R+G=Y (additive) or even that B+Y=G (subtractive), in part
because tetrachromacy in the visual cortex seems to override whatever
trichromacy we have at the retinal level (varies by gender, btw).

Also methodologies that estimate color differences on the basis of JND's
(such as the CIE work in Rochester in the 1930') may not generalize well to
distances that are further across the perceptual space, methinks.

Cheers
David

-----Original Message-----
From: <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg-bounces at lists.whatwg.org</A>
[mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg-bounces at lists.whatwg.org</A>] On Behalf Of Rik Cabanier
Sent: Friday, April 13, 2012 1:49 PM
To: David Geary
Cc: Jeremy Apthorp; Ashley Gullen; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A>
Subject: Re: [whatwg] Adding blending to the canvas API

On Fri, Apr 13, 2012 at 10:36 AM, David Geary
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">david.mark.geary at gmail.com</A>&gt;wrote:

&gt;<i> On Fri, Apr 13, 2012 at 11:16 AM, Rik Cabanier &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cabanier at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> On Fri, Apr 13, 2012 at 2:17 AM, Ashley Gullen &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ashley at scirra.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; This looks very handy for games as well!  Things like 'screen' work 
</I>&gt;&gt;<i> &gt; very nicely for some effects, especially explosions.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, these effects are very commonly used in games, animation and
</I>artwork.
&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> And presumably having them implemented by browser vendors will be more 
</I>&gt;<i> efficient than doing it by hand.
</I>&gt;<i>
</I>
Correct. I've found a case where someone implemented this themselves and it
is very slow so it's not useful if you want to create an animation or a
game.


&gt;<i>
</I>&gt;<i> &gt; Surely you'd want to extend the existing list of 
</I>&gt;<i> &gt; globalCompositeOperation
</I>&gt;&gt;<i> &gt; though?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That seemed the easiest way to go.
</I>&gt;&gt;<i> I can see some edge cases that you wouldn't be able to implement easy 
</I>&gt;&gt;<i> (ie do a src-out with a screen). I think it would still be possible 
</I>&gt;&gt;<i> to do but it would take an extra step.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> And presumably the extra step will be less efficient than if the 
</I>&gt;<i> browser did it. Also, the developer must implement the extra step. It 
</I>&gt;<i> seems to me that the extra step may also require an additional offscreen
</I>bitmap.
&gt;<i>
</I>
Correct. The question is if you want to extend the API if the feature is not
that common.


&gt;<i>
</I>&gt;<i> &gt;  Otherwise you'd have to define how globalCompositeOperation and
</I>&gt;<i>
</I>&gt;<i>  &gt; globalBlendOperation interact.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> &gt; My spec is trying to define how they interact. Basically, blending 
</I>&gt;&gt;<i> &gt; is
</I>&gt;&gt;<i> done
</I>&gt;&gt;<i> first and replaces the original source. This new source is then 
</I>&gt;&gt;<i> composited.
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Sorry, I'm confused. If that's how they interact, then musn't blending 
</I>&gt;<i> and compositing be separate things? If you extend the list of 
</I>&gt;<i> globalCompositeOperation valid values to include blends, then you can 
</I>&gt;<i> do either a blend or a composite, but not both.
</I>&gt;<i>
</I>
Specifying a blend mode would imply doing a src-over with the result of the
blend. Every authoring application (not just Adobe's) that I know of,
implements it that way.


&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks for the feedback!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Rik
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On 12 April 2012 00:39, Rik Cabanier &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cabanier at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;&gt; :-)
</I>&gt;&gt;<i> &gt;&gt; They are definitely more familiar to designers but they both have 
</I>&gt;&gt;<i> &gt;&gt; their place.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; On Wed, Apr 11, 2012 at 4:30 PM, Jeremy Apthorp 
</I>&gt;&gt;<i> &gt;&gt; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jeremya at chromium.org</A>
</I>&gt;&gt;<i> &gt;&gt; &gt;wrote:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; On Wed, Apr 11, 2012 at 4:05 PM, Rik Cabanier 
</I>&gt;&gt;<i> &gt;&gt; &gt; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cabanier at gmail.com</A>&gt;
</I>&gt;&gt;<i> &gt;&gt; wrote:
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; All,
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; I'm working on a spec to add blending and compositing through 
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; simple
</I>&gt;&gt;<i> &gt;&gt; CSS
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; keywords. It is trying to define a generic model that is not
</I>&gt;&gt;<i> specific
</I>&gt;&gt;<i> &gt;&gt; to
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Canvas, HTML or SVG and then lists how the model could be
</I>&gt;&gt;<i> implemented.
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; We've gotten some comments that this feature would be useful in
</I>&gt;&gt;<i> Canvas
</I>&gt;&gt;<i> &gt;&gt; as
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; well so I was wondering if it made sense to add it to the 
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; canvas
</I>&gt;&gt;<i> API.
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; I can see 2 ways of adding this:
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; 1. extend the list of compositing operators (
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canva">http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canva</A>
</I>&gt;&gt;<i> s-element.html#compositing
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; )
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; with blending. This is what is currently in the draft spec (
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> <A HREF="https://dvcs.w3.org/hg/FXTF/rawfile/tip/compositing/index.htmlchapter">https://dvcs.w3.org/hg/FXTF/rawfile/tip/compositing/index.htmlchapter</A> 
</I>&gt;&gt;<i> 7)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; 2. create a new attribute on the context called
</I>&gt;&gt;<i> 'globalBlendOperation'
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; that
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; takes the same list of blend operations as css (
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> <A HREF="https://dvcs.w3.org/hg/FXTF/rawfile/tip/compositing/index.html#blend-">https://dvcs.w3.org/hg/FXTF/rawfile/tip/compositing/index.html#blend-</A>
</I>&gt;&gt;<i> mode
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; )
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Any thoughts?
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; This seems much more useful than the existing composite 
</I>&gt;&gt;<i> &gt;&gt; &gt; operations :)
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>



</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077721.html">[whatwg] Adding blending to the canvas API
</A></li>
	<LI>Next message: <A HREF="077723.html">[whatwg] Adding blending to the canvas API
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77722">[ date ]</a>
              <a href="thread.html#77722">[ thread ]</a>
              <a href="subject.html#77722">[ subject ]</a>
              <a href="author.html#77722">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
