<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Security restriction allows content thievery
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Security%20restriction%20allows%20content%20thievery&In-Reply-To=%3CCAAcXor6EeP_-Ea%3D26F%3DCxFvRdoHJhr%3DRTBe7dBGZpNje48V_Mg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="078907.html">
   <LINK REL="Next"  HREF="078897.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Security restriction allows content thievery</H1>
<!--htdig_noindex-->
    <B>Robert Eisele</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Security%20restriction%20allows%20content%20thievery&In-Reply-To=%3CCAAcXor6EeP_-Ea%3D26F%3DCxFvRdoHJhr%3DRTBe7dBGZpNje48V_Mg%40mail.gmail.com%3E"
       TITLE="[whatwg] Security restriction allows content thievery">robert at xarg.org
       </A><BR>
    <I>Sun Jul 15 15:22:20 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="078907.html">[whatwg] Allow author's data either in header and footer
</A></li>
        <LI>Next message: <A HREF="078897.html">[whatwg] Security restriction allows content thievery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36623">[ date ]</a>
              <a href="thread.html#36623">[ thread ]</a>
              <a href="subject.html#36623">[ subject ]</a>
              <a href="author.html#36623">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Browsers are very restrictive when one tries to access the contents of
different domains (including the scheme), embedded via framesets. This is
normally a good practice, but I'd suggest to weaken this restriction for
the data: URI schema.

I'm currently building an analysis system like Google Analytics, which gets
embedded into a website via a small JavaScript snippet. When I analyzed the
data, I came across a very interesting trick because I got a lot of
requests (with the data from location.href) where the entire website was
embedded into a data:text/html URI - except that all ads of the page were
replaced. Fortunately, my tracking code has been left without
modifications.

But the scary thing is that this way you can monetize foreign content by
simply embedding it somewhere you can direct traffic to. That's pretty
clever, because the original site owner doesn't notice this abuse due to
the fact that top.location.href isn't readable. Or even worse, he would
never notice it at all when he doesn't sniff the URI with JavaScript,
because image files would have no referrer.

My final approach to convict the abuser is based on the fact, that the
JavaScript was dynamically loaded from my server and that I can write to
location.href. So I added this piece of code:

if (top.location.protocol === 'data:') {
    top.location.href = '<A HREF="http://example.com/trap/">http://example.com/trap/</A>';
}

But even then the referrer will not be passed to the server. So my proposal
is that the data URI schema gets an exception on this security behavior.



Kind Regards

Robert Eisele
<A HREF="http://www.xarg.org/">http://www.xarg.org/</A>
</PRE>






























<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="078907.html">[whatwg] Allow author's data either in header and footer
</A></li>
	<LI>Next message: <A HREF="078897.html">[whatwg] Security restriction allows content thievery
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36623">[ date ]</a>
              <a href="thread.html#36623">[ thread ]</a>
              <a href="subject.html#36623">[ subject ]</a>
              <a href="author.html#36623">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
