<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Comments about the track element
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Comments%20about%20the%20track%20element&In-Reply-To=%3C500FF896.3000301%40telecom-paristech.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="078991.html">
   <LINK REL="Next"  HREF="078990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Comments about the track element</H1>
<!--htdig_noindex-->
    <B>Cyril Concolato</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Comments%20about%20the%20track%20element&In-Reply-To=%3C500FF896.3000301%40telecom-paristech.fr%3E"
       TITLE="[whatwg] Comments about the track element">cyril.concolato at telecom-paristech.fr
       </A><BR>
    <I>Wed Jul 25 06:45:58 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="078991.html">[whatwg] Comments about the track element
</A></li>
        <LI>Next message: <A HREF="078990.html">[whatwg] Comments about the track element
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78968">[ date ]</a>
              <a href="thread.html#78968">[ thread ]</a>
              <a href="subject.html#78968">[ subject ]</a>
              <a href="author.html#78968">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Silvia,

Le 7/25/2012 4:24 AM, Silvia Pfeiffer a &#233;crit :
&gt;<i> Expanding a bit on what Anne said...
</I>&gt;<i>
</I>&gt;<i> On Tue, Jul 24, 2012 at 11:18 PM, Cyril Concolato
</I>&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cyril.concolato at telecom-paristech.fr</A>&gt;  wrote:
</I>&gt;&gt;<i> Dear WhatWG,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> During the ongoing SVG F2F meeting, the SVG WG discussed the use case of
</I>&gt;&gt;<i> displaying SVG graphics on top of a video, in a synchronous manner.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The SVG WG believes that for such use case, it is necessary to indicate to
</I>&gt;&gt;<i> the browser that the SVG and video content should stay synchronized (no
</I>&gt;&gt;<i> matter what happens to the video playback), and to let the browser handle
</I>&gt;&gt;<i> the synchronization internally. The SVG WG resolved to include such
</I>&gt;&gt;<i> indication as part of the Web Animation specification, for instance using
</I>&gt;&gt;<i> the HTML mediagroup attribute or the MediaController API.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> However, the SVG WG thinks it would also be interesting to leverage the
</I>&gt;&gt;<i> native UI controls of the video element to select (or deactivate) the
</I>&gt;&gt;<i> display of the SVG content on top of the video, in a similar manner to a
</I>&gt;&gt;<i> subtitle track. Obviously, the HTML 5 track element would be a suitable
</I>&gt;&gt;<i> option for that. However, currently it only allows text tracks. So, the SVG
</I>&gt;&gt;<i> WG would like HTML to allow the track element's URL to identify an SVG
</I>&gt;&gt;<i> resource, and in that case the track kind would be 'graphics'. There would
</I>&gt;&gt;<i> be a need to define how the graphics are displayed on top of the video,
</I>&gt;<i> Right now it is fully defined how data in a TextTrack (of the defined
</I>&gt;<i> kinds) is displayed on top of the video. As this is as yet unclear for
</I>&gt;<i> SVG resources,
</I>I wouldn't say it's unclear, I'd say it needs to be specified ;) meaning 
that it probably doesn't require much specification. I was thinking that 
we could use the CSS box of the video element to position the SVG, as if 
the SVG was put in a div.
&gt;<i> I would suggest using the @metadata tack kind for now
</I>&gt;<i> and providing the SVG as markup in a TextTrackCue (either from WebVTT
</I>&gt;<i> cues
</I>I've tried this option but I'm facing several problems (Tested with 
Chrome Version 22.0.1216.0 canary).

The first problem is how to embed SVG in a cue? Should the '&lt;', '&gt;' and 
other characters be escaped or not? According to Anne's validator, they 
should be. But if I use them, then the parsing of the escaped string 
returns 'empty document' 
(<A HREF="http://perso.telecom-paristech.fr/~concolat/html5_tests/getcueasSVG-escaped.html">http://perso.telecom-paristech.fr/~concolat/html5_tests/getcueasSVG-escaped.html</A> 
&lt;<A HREF="http://perso.telecom-paristech.fr/%7Econcolat/html5_tests/getcueasSVG-escaped.html">http://perso.telecom-paristech.fr/%7Econcolat/html5_tests/getcueasSVG-escaped.html</A>&gt;). 
However, if I don't escape them, the parsing doesn't fail and returns an 
SVG document 
(<A HREF="http://perso.telecom-paristech.fr/~concolat/html5_tests/getcueasSVG.html">http://perso.telecom-paristech.fr/~concolat/html5_tests/getcueasSVG.html</A> &lt;<A HREF="http://perso.telecom-paristech.fr/%7Econcolat/html5_tests/getcueasSVG.html">http://perso.telecom-paristech.fr/%7Econcolat/html5_tests/getcueasSVG.html</A>&gt;). 
In any case, I think embedding the SVG in WEBVTT does not really make 
sense.

An other problem is in terms of design. SVG has a timing model (similar 
to TTML), WebVTT another. For instance, SVG can express things like 
repetitions of animations that WebVTT cannot. Are you saying that TTML 
should be carried in a WebVTT file?
Similarly, in terms of design, embedding SVG in cues requires repeating 
a lot of SVG content at each cue (see 
<A HREF="http://perso.telecom-paristech.fr/~concolat/html5_tests/svg.vtt">http://perso.telecom-paristech.fr/~concolat/html5_tests/svg.vtt</A> 
&lt;<A HREF="http://perso.telecom-paristech.fr/%7Econcolat/html5_tests/svg.vtt">http://perso.telecom-paristech.fr/%7Econcolat/html5_tests/svg.vtt</A>&gt;), as 
this approach requires parsing an entire document at each cue. You could 
probably envisage overlapping cues but that would require a lot of 
overhead. Leveraging the progressive loading of SVG cannot be done this 
way either.
In general, I think it would make sense to leverage the browsers' 
support for SVG and not stack different technologies.

Another problem is that I don't know if it's possible to display the SVG 
content in a layer between the video and the UI controls. Currently, I 
display the SVG on top of the video element, therefore the UI controls 
are not accessible for clicks. Having to embed my own UI controls for 
that is a bit of a pain. And, semantically, when reading the spec, 
'metadata' tracks say &quot; Not displayed by the user agent. &quot; so I think 
this might be a bit confusing for users/authors.

The third problem is performance-wise. In my example, the blue line (in 
SVG), when synchronized with the video, should be aligned with the 
moving (white-gray) edge of the pie. As you can see, this is not the 
case. Only 4-5 cuechange events seems to be processed properly. I 
noticed the same problem with 'timeupdate' events. Also, I've noticed 
that even though my WebVTT file is designed to have only one active cue 
at a time, for some cuechange events, there are 2. This might be an 
implementation issue but this might be a problem of reentrant code (the 
cuechange callback being called while it's not finished), but in 
general, I'm not sure it's a good idea to go through the Javascript 
engine to do that, for the processing overhead.

&gt;<i> or from JavaScript calls to addTextTrack()).
</I>Can you elaborate on this one? However, I suspect it'll have the same 
processing overhead.

&gt;<i> The
</I>&gt;<i> timing/synchronization is provided by the TextTrackCue, which seems to
</I>&gt;<i> be all you are asking for right now. The rendering is then done by
</I>&gt;<i> JavaScript, which seems the most flexible approach. You can even use
</I>&gt;<i> getCueAsHTML() to simply hand the SVG to HTML for rendering.
</I>&gt;<i>
</I>&gt;<i> @metadata tracks can be part of the native video controls and the
</I>&gt;<i> @label on the text track would provide a description of what it is,
</I>&gt;<i> e.g. &quot;Graphic overlays&quot;.
</I>&gt;<i>
</I>&gt;&gt;<i> for
</I>&gt;&gt;<i> instance reusing the viewport/viewbox negotiation phase. There would also be
</I>&gt;&gt;<i> a need to make a more generic Track API or to replace the TextTrack API by
</I>&gt;&gt;<i> the SVG API when the track is of kind 'graphics'.
</I>&gt;<i> I don't understand this requirement. What API needs are there aside
</I>&gt;<i> from the synchronization? Trying to replicate SVG APIs through the
</I>&gt;<i> TextTrack API seems like a repetition of the API and thus fragile.
</I>Sorry for the confusion here. I didn't mean to replicate the SVG APIs 
here but I just meant that the TextTrack API is very specific to 'pure' 
text tracks (and even to WebVTT text tracks). You might want to expose 
the SVG API when SVG content is used for the overlay to control it.

Regards,
Cyril

-- 
Cyril Concolato
Ma&#238;tre de Conf&#233;rences/Associate Professor
Groupe Multimedia/Multimedia Group
Telecom ParisTech
46 rue Barrault
75 013 Paris, France
<A HREF="http://concolato.wp.mines-telecom.fr/">http://concolato.wp.mines-telecom.fr/</A>


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="078991.html">[whatwg] Comments about the track element
</A></li>
	<LI>Next message: <A HREF="078990.html">[whatwg] Comments about the track element
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78968">[ date ]</a>
              <a href="thread.html#78968">[ thread ]</a>
              <a href="subject.html#78968">[ subject ]</a>
              <a href="author.html#78968">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
