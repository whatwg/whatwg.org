<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] isPointInPath v. set of pixels in canvas hit regions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20isPointInPath%20v.%20set%20of%20pixels%20in%20canvas%20hit%20regions&In-Reply-To=%3CAB041A73-C3F1-49EE-B340-36F7D9AB1E6A%40apple.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="078840.html">
   <LINK REL="Next"  HREF="078843.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] isPointInPath v. set of pixels in canvas hit regions</H1>
<!--htdig_noindex-->
    <B>Dean Jackson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20isPointInPath%20v.%20set%20of%20pixels%20in%20canvas%20hit%20regions&In-Reply-To=%3CAB041A73-C3F1-49EE-B340-36F7D9AB1E6A%40apple.com%3E"
       TITLE="[whatwg] isPointInPath v. set of pixels in canvas hit regions">dino at apple.com
       </A><BR>
    <I>Fri Jul  6 17:40:36 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="078840.html">[whatwg] isPointInPath v. set of pixels in canvas hit regions
</A></li>
        <LI>Next message: <A HREF="078843.html">[whatwg] isPointInPath v. set of pixels in canvas hit regions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78841">[ date ]</a>
              <a href="thread.html#78841">[ thread ]</a>
              <a href="subject.html#78841">[ subject ]</a>
              <a href="author.html#78841">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On 07/07/2012, at 10:11 AM, Charles Pritchard &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">chuck at jumis.com</A>&gt; wrote:

&gt;&gt;<i> On Thu, Jul 5, 2012 at 1:05 PM, Edward O'Connor &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">eoconnor at apple.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> As things currently stand in the spec, implementations basically need to
</I>&gt;&gt;&gt;<i> keep N+1 bitmaps per canvas, where N is the number of hit regions. I
</I>&gt;&gt;&gt;<i> doubt any implementors would be enthusiastic to implement hit regions
</I>&gt;&gt;&gt;<i> like this. From a WebKit perspective, we'd much prefer keeping a Path
</I>&gt;&gt;&gt;<i> for each hit region, and then simply using isPointInPath for hit
</I>&gt;&gt;&gt;<i> testing. This also implies that the current piggybacking of &quot;Clear
</I>&gt;&gt;&gt;<i> regions that cover the pixels&quot; in clearRect() could go away. Yay! :)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Bog-standard hit-testing algorithms apply.  Keep a single extra canvas
</I>&gt;&gt;<i> around, draw each region into it with a different color.  When you're
</I>&gt;&gt;<i> hit-testing, just see what color that pixel is, and look up which
</I>&gt;&gt;<i> region is associated with it.  This is extremely fast and simple to
</I>&gt;&gt;<i> implement, and has all the right properties - the &quot;topmost&quot; region for
</I>&gt;&gt;<i> a given pixel is the one returned.
</I>
We're aware of this technique, but it has a couple of obvious issues:

1. It requires us to create a duplicate canvas, possibly using many MB of RAM. It's generally going to be less memory to keep a list of geometric regions. And performance won't be terrible if you implement some spatial hashing, etc.

2. It doesn't allow for sub pixel testing. In your algorithm above, only one region can be at a pixel (which also means it isn't our standard drawing code with anti-aliasing). Consider a zoomed canvas, where we might want more accurate hit testing.

Dean


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="078840.html">[whatwg] isPointInPath v. set of pixels in canvas hit regions
</A></li>
	<LI>Next message: <A HREF="078843.html">[whatwg] isPointInPath v. set of pixels in canvas hit regions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#78841">[ date ]</a>
              <a href="thread.html#78841">[ thread ]</a>
              <a href="subject.html#78841">[ subject ]</a>
              <a href="author.html#78841">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
