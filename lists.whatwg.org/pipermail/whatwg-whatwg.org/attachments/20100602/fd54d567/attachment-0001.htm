<tt>
On&nbsp;Wed,&nbsp;Jun&nbsp;2,&nbsp;2010&nbsp;at&nbsp;10:48&nbsp;AM,&nbsp;Philip&nbsp;Taylor&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:excors%2Bwhatwg@gmail.com&quot;&gt;excors+whatwg@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;br&gt;<br>
I&#39;m&nbsp;trying&nbsp;to&nbsp;think&nbsp;of&nbsp;them&nbsp;mainly&nbsp;as&nbsp;indirect&nbsp;examples&nbsp;of&nbsp;use&nbsp;cases,&lt;br&gt;<br>
rather&nbsp;than&nbsp;as&nbsp;direct&nbsp;examples&nbsp;of&nbsp;interfaces.&nbsp;Under&nbsp;the&nbsp;assumption&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;This&nbsp;is&nbsp;a&nbsp;very&nbsp;valid&nbsp;approach.&nbsp;(Note&nbsp;that&nbsp;most&nbsp;serious&nbsp;games&nbsp;do&nbsp;not&nbsp;use&nbsp;DirectPlay&nbsp;and&nbsp;it&nbsp;has&nbsp;not&nbsp;been&nbsp;updated&nbsp;by&nbsp;Microsoft&nbsp;in&nbsp;a&nbsp;while,&nbsp;so&nbsp;don&#39;t&nbsp;burn&nbsp;a&nbsp;lot&nbsp;of&nbsp;braincells&nbsp;on&nbsp;it.)&lt;br&gt;<br>
<br>
&lt;br&gt;Games&nbsp;always&nbsp;do&nbsp;weird&nbsp;stuff,&nbsp;focus&nbsp;on&nbsp;what&nbsp;will&nbsp;enable&nbsp;the&nbsp;80%&nbsp;case&nbsp;and&nbsp;not&nbsp;break&nbsp;the&nbsp;web!&nbsp;:)&lt;br&gt; &lt;br&gt;Some&nbsp;thoughts&nbsp;point&nbsp;by&nbsp;point:&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
So&nbsp;they&nbsp;seem&nbsp;to&nbsp;suggest&nbsp;things&nbsp;like:&lt;br&gt;<br>
-&nbsp;many&nbsp;games&nbsp;need&nbsp;a&nbsp;combination&nbsp;of&nbsp;reliable&nbsp;and&nbsp;unreliable-ordered&nbsp;and&lt;br&gt;<br>
unreliable-unordered&nbsp;messages.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes.&nbsp;But&nbsp;if&nbsp;you&nbsp;unreliable-unordered&nbsp;you&nbsp;can&nbsp;build&nbsp;the&nbsp;rest&nbsp;pretty&nbsp;easily.&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
-&nbsp;many&nbsp;games&nbsp;need&nbsp;to&nbsp;send&nbsp;large&nbsp;messages&nbsp;(so&nbsp;the&nbsp;libraries&nbsp;do&lt;br&gt;<br>
automatic&nbsp;fragmentation).&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yes.&nbsp;But&nbsp;many&nbsp;engines&nbsp;do&nbsp;fragmentation&nbsp;more&nbsp;explicitly,&nbsp;since&nbsp;they&nbsp;don&#39;t&nbsp;spend&nbsp;a&nbsp;lot&nbsp;of&nbsp;time&nbsp;dealing&nbsp;with&nbsp;TCP&nbsp;streams.&nbsp;(The&nbsp;usual&nbsp;case&nbsp;is&nbsp;transfer&nbsp;of&nbsp;asset&nbsp;files&nbsp;over&nbsp;the&nbsp;network&nbsp;connection,&nbsp;for&nbsp;instance,&nbsp;if&nbsp;a&nbsp;client&nbsp;doesn&#39;t&nbsp;have&nbsp;a&nbsp;texture.&nbsp;I&nbsp;suspect&nbsp;for&nbsp;a&nbsp;JS&nbsp;app&nbsp;using&nbsp;UDP&nbsp;this&nbsp;would&nbsp;not&nbsp;be&nbsp;an&nbsp;issue,&nbsp;they&nbsp;could&nbsp;just&nbsp;ask&nbsp;the&nbsp;web&nbsp;server.)&lt;br&gt;<br>
<br>
 &lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
-&nbsp;many&nbsp;games&nbsp;need&nbsp;to&nbsp;efficiently&nbsp;send&nbsp;tiny&nbsp;messages&nbsp;(so&nbsp;the&nbsp;libraries&lt;br&gt;<br>
do&nbsp;automatic&nbsp;aggregation).&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Sort&nbsp;of.&nbsp;The&nbsp;common&nbsp;cases&nbsp;are&nbsp;most-recent&nbsp;state&nbsp;and&nbsp;message&nbsp;queues.&nbsp;Mostly&nbsp;they&nbsp;define&nbsp;a&nbsp;packet&nbsp;format&nbsp;and&nbsp;have&nbsp;smart&nbsp;logic&nbsp;for&nbsp;incrementally&nbsp;sending&nbsp;the&nbsp;most&nbsp;relevant&nbsp;state&nbsp;in&nbsp;each&nbsp;packet.&lt;br&gt;<br>
<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
-&nbsp;many&nbsp;games&nbsp;need&nbsp;some&nbsp;kind&nbsp;of&nbsp;security&nbsp;(I&nbsp;have&nbsp;no&nbsp;idea&nbsp;exactly&nbsp;what,&lt;br&gt;<br>
or&nbsp;how&nbsp;much&nbsp;is&nbsp;still&nbsp;relevant&nbsp;when&nbsp;the&nbsp;client&nbsp;is&nbsp;JavaScript&nbsp;and&lt;br&gt;<br>
trivial&nbsp;to&nbsp;tamper&nbsp;with).&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;What&nbsp;is&nbsp;relevant&nbsp;for&nbsp;this&nbsp;discussion&nbsp;is&nbsp;to&nbsp;prevent&nbsp;man&nbsp;in&nbsp;the&nbsp;middle&nbsp;and&nbsp;DoS&nbsp;activities.&nbsp;(Smart)&nbsp;game&nbsp;devs&nbsp;always&nbsp;assume&nbsp;the&nbsp;client&nbsp;is&nbsp;compromised&nbsp;-&nbsp;same&nbsp;as&nbsp;smart&nbsp;web&nbsp;devs.&nbsp;:)&lt;br&gt;<br>
<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
-&nbsp;many&nbsp;games&nbsp;need&nbsp;to&nbsp;prioritise&nbsp;certain&nbsp;messages&nbsp;when&nbsp;bandwidth&nbsp;is&nbsp;limited.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;See&nbsp;the&nbsp;aggregation&nbsp;comment.&nbsp;Also,&nbsp;games&nbsp;typically&nbsp;assume&nbsp;bandwidth&nbsp;is&nbsp;limited&nbsp;-&nbsp;they&nbsp;will&nbsp;target&nbsp;and&nbsp;operate&nbsp;within&nbsp;a&nbsp;fixed&nbsp;bandwidth&nbsp;budget&nbsp;and&nbsp;often&nbsp;a&nbsp;fixed&nbsp;packet&nbsp;rate.&nbsp;Say,&nbsp;10&nbsp;500&nbsp;byte&nbsp;packets&nbsp;per&nbsp;second.&nbsp;This&nbsp;is&nbsp;beneficial&nbsp;for&nbsp;many&nbsp;reasons,&nbsp;but&nbsp;primarily&nbsp;it&nbsp;is&nbsp;good&nbsp;because&nbsp;it&nbsp;optimizes&nbsp;for&nbsp;realtime&nbsp;interaction.&nbsp;For&nbsp;some&nbsp;situations&nbsp;you&nbsp;will&nbsp;want&nbsp;fixed&nbsp;rate,&nbsp;for&nbsp;others&nbsp;you&nbsp;want&nbsp;to&nbsp;have&nbsp;adaptive&nbsp;rate.&nbsp;(For&nbsp;instance,&nbsp;talking&nbsp;to&nbsp;a&nbsp;game&nbsp;server&nbsp;in&nbsp;Counterstrike&nbsp;vs.&nbsp;playing&nbsp;an&nbsp;MMO.)&lt;br&gt;<br>
<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
-&nbsp;most&nbsp;games&nbsp;don&#39;t&nbsp;need&nbsp;low-level&nbsp;control&nbsp;over&nbsp;individual&nbsp;datagrams&lt;br&gt;<br>
and&nbsp;precise&nbsp;packet&nbsp;loss&nbsp;feedback,&nbsp;they&#39;re&nbsp;okay&nbsp;with&nbsp;the&nbsp;socket&nbsp;details&lt;br&gt;<br>
being&nbsp;abstracted&nbsp;away.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Disagree,&nbsp;for&nbsp;good&nbsp;networking&nbsp;you&nbsp;need&nbsp;to&nbsp;know&nbsp;about&nbsp;packet&nbsp;delivery&nbsp;state&nbsp;at&nbsp;quite&nbsp;high&nbsp;levels&nbsp;of&nbsp;the&nbsp;game&nbsp;simulation.&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
-&nbsp;...&nbsp;probably&nbsp;lots&nbsp;more&nbsp;(and/or&nbsp;less);&nbsp;I&#39;m&nbsp;not&nbsp;very&nbsp;familiar&nbsp;with&nbsp;the&lt;br&gt;<br>
details&nbsp;of&nbsp;the&nbsp;libraries&nbsp;so&nbsp;this&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;be&nbsp;an&nbsp;accurate&nbsp;list,&lt;br&gt;<br>
but&nbsp;I&nbsp;think&nbsp;it&nbsp;may&nbsp;be&nbsp;a&nbsp;useful&nbsp;way&nbsp;to&nbsp;analyse&nbsp;the&nbsp;requirements.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;think&nbsp;you&nbsp;got&nbsp;the&nbsp;major&nbsp;points.&nbsp;(Even&nbsp;though&nbsp;I&nbsp;don&#39;t&nbsp;necessarily&nbsp;agree&nbsp;with&nbsp;all&nbsp;of&nbsp;your&nbsp;conclusions.&nbsp;:))&lt;br&gt; &lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
&lt;br&gt;<br>
(The&nbsp;solution&nbsp;suggested&nbsp;in&nbsp;your&nbsp;initial&nbsp;post&lt;br&gt;<br>
(socket.send(data_smaller_than_mtu)&nbsp;going&nbsp;over&nbsp;UDP)&nbsp;seems&nbsp;to&nbsp;be&nbsp;one&lt;br&gt;<br>
extreme,&nbsp;which&nbsp;combines&nbsp;with&nbsp;higher-level&nbsp;JS&nbsp;libraries&nbsp;to&nbsp;satisfy&lt;br&gt;<br>
these&nbsp;needs.&nbsp;I&nbsp;think&nbsp;I&nbsp;initially&nbsp;suggested&nbsp;the&nbsp;other&nbsp;extreme&nbsp;of&lt;br&gt;<br>
encoding&nbsp;all&nbsp;the&nbsp;features&nbsp;into&nbsp;the&nbsp;browser&nbsp;API.&nbsp;I&nbsp;guess&nbsp;the&nbsp;best&lt;br&gt;<br>
tradeoff&nbsp;depends&nbsp;largely&nbsp;on&nbsp;what&nbsp;non-game&nbsp;use&nbsp;cases&nbsp;exist&nbsp;that&nbsp;should&lt;br&gt;<br>
be&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;same&nbsp;solution.)&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;think&nbsp;the&nbsp;best&nbsp;layer&nbsp;to&nbsp;provide&nbsp;is&nbsp;a&nbsp;notify&nbsp;protocol.&nbsp;That&nbsp;is,&nbsp;provide&nbsp;a&nbsp;way&nbsp;to&nbsp;send&nbsp;lossy,&nbsp;smaller-than-MTU&nbsp;messages&nbsp;over&nbsp;a&nbsp;connection&nbsp;in&nbsp;realtime,&nbsp;and&nbsp;notify&nbsp;the&nbsp;dev&nbsp;when&nbsp;a&nbsp;packet&nbsp;has&nbsp;made&nbsp;it&nbsp;(or&nbsp;hasn&#39;t).&nbsp;This&nbsp;way&nbsp;the&nbsp;browser&nbsp;can&nbsp;provide&nbsp;a&nbsp;connection&nbsp;abstraction,&nbsp;which&nbsp;deals&nbsp;with&nbsp;the&nbsp;DoS/security/origin&nbsp;issues.&nbsp;(For&nbsp;instance,&nbsp;two&nbsp;obvious&nbsp;pieces&nbsp;are&nbsp;connection&nbsp;puzzles&nbsp;to&nbsp;prevent&nbsp;DoS,&nbsp;and&nbsp;PKI&nbsp;signing&nbsp;to&nbsp;prevent&nbsp;tampering&nbsp;with&nbsp;data.&nbsp;The&nbsp;browser&nbsp;can&nbsp;also&nbsp;support&nbsp;arranged&nbsp;connections&nbsp;for&nbsp;the&nbsp;p2p&nbsp;case.)&lt;br&gt;<br>
<br>
&lt;br&gt;It&nbsp;also&nbsp;keeps&nbsp;the&nbsp;interoperability&nbsp;manageable.&nbsp;Servers&nbsp;have&nbsp;a&nbsp;specific,&nbsp;fairly&nbsp;small&nbsp;protocol&nbsp;to&nbsp;implement,&nbsp;and&nbsp;can&nbsp;provide&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;a&nbsp;small&nbsp;set&nbsp;of&nbsp;features.&nbsp;(For&nbsp;instance,&nbsp;caps&nbsp;might&nbsp;be:&nbsp;basic&nbsp;protocol&nbsp;support,&nbsp;secure&nbsp;connections,&nbsp;arranged&nbsp;connections.)&nbsp;Beyond&nbsp;that&nbsp;it&nbsp;is&nbsp;application&nbsp;specific&nbsp;blobs&nbsp;of&nbsp;small&nbsp;size&nbsp;(under&nbsp;a&nbsp;few&nbsp;kb).&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;br&gt;All&nbsp;that&nbsp;said,&nbsp;I&nbsp;think&nbsp;looking&nbsp;at&nbsp;the&nbsp;notify&nbsp;protocol&nbsp;in&nbsp;TNL&nbsp;is&nbsp;a&nbsp;good&nbsp;baseline.&nbsp;On&nbsp;that&nbsp;you&nbsp;can&nbsp;pretty&nbsp;easily&nbsp;implement&nbsp;every&nbsp;game&nbsp;scenario&nbsp;I&nbsp;can&nbsp;think&nbsp;of.&nbsp;You&nbsp;can&nbsp;reuse&nbsp;a&nbsp;lot&nbsp;of&nbsp;the&nbsp;TCP&nbsp;connection&nbsp;security&nbsp;semantics,&nbsp;too,&nbsp;since&nbsp;it&nbsp;is&nbsp;a&nbsp;connection&nbsp;-&nbsp;just&nbsp;one&nbsp;with&nbsp;lossy&nbsp;delivery.&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;Ben&lt;br&gt;<br>

</tt>
