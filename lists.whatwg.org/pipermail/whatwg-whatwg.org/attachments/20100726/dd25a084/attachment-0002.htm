<tt>
On&nbsp;Mon,&nbsp;Jul&nbsp;26,&nbsp;2010&nbsp;at&nbsp;7:49&nbsp;PM,&nbsp;Philip&nbsp;Jägenstedt&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:philipj@opera.com&quot;&gt;philipj@opera.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;Mon,&nbsp;26&nbsp;Jul&nbsp;2010&nbsp;02:58:07&nbsp;+0200,&nbsp;Silvia&nbsp;Pfeiffer&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:silviapfeiffer1@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;silviapfeiffer1@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
On&nbsp;Sun,&nbsp;Jul&nbsp;25,&nbsp;2010&nbsp;at&nbsp;3:31&nbsp;PM,&nbsp;Maciej&nbsp;Stachowiak&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:mjs@apple.com&quot;&nbsp;target=&quot;_blank&quot;&gt;mjs@apple.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
On&nbsp;Jul&nbsp;23,&nbsp;2010,&nbsp;at&nbsp;7:16&nbsp;AM,&nbsp;Philip&nbsp;Jägenstedt&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
Silvia&nbsp;made&nbsp;we&nbsp;aware&nbsp;of&nbsp;discrepancy&nbsp;in&nbsp;how&nbsp;browsers&nbsp;implement&nbsp;the&nbsp;resource&lt;br&gt;<br>
selection&nbsp;algorithm,&nbsp;see&nbsp;forwarded&nbsp;message.&nbsp;It&#39;s&nbsp;my&nbsp;assessment&nbsp;that&nbsp;Opera&nbsp;is&lt;br&gt;<br>
the&nbsp;only&nbsp;browser&nbsp;following&nbsp;the&nbsp;spec.&nbsp;I&#39;ve&nbsp;filed&nbsp;this&nbsp;bug&nbsp;with&nbsp;Mozilla:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=581355&quot;&nbsp;target=&quot;_blank&quot;&gt;https://bugzilla.mozilla.org/show_bug.cgi?id=581355&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
I&#39;ve&nbsp;also&nbsp;reported&nbsp;bugs&nbsp;in&nbsp;Chrome&nbsp;and&nbsp;Safari,&nbsp;but&nbsp;can&#39;t&nbsp;see&nbsp;where&nbsp;they&lt;br&gt;<br>
ended&nbsp;up.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;reason&nbsp;I&#39;m&nbsp;writing&nbsp;this&nbsp;email&nbsp;is&nbsp;that&nbsp;apparently&nbsp;everyone&nbsp;but&nbsp;myself&lt;br&gt;<br>
has&nbsp;a&nbsp;different&nbsp;interpretation&nbsp;of&nbsp;the&nbsp;spec,&nbsp;so&nbsp;perhaps&nbsp;this&nbsp;is&nbsp;something&nbsp;we&lt;br&gt;<br>
need&nbsp;to&nbsp;discuss.&nbsp;Does&nbsp;any&nbsp;other&nbsp;browser&nbsp;ever&nbsp;set&nbsp;the&nbsp;state&nbsp;NETWORK_NO_SOURCE&lt;br&gt;<br>
at&nbsp;all?&nbsp;I&nbsp;speculated&nbsp;that&nbsp;perhaps&nbsp;other&nbsp;browsers&nbsp;aren&#39;t&nbsp;very&nbsp;strict&nbsp;about&lt;br&gt;<br>
which&nbsp;parts&nbsp;of&nbsp;the&nbsp;algorithm&nbsp;are&nbsp;run&nbsp;synchronously&nbsp;and&nbsp;not,&nbsp;but&nbsp;even&lt;br&gt;<br>
checking&nbsp;the&nbsp;networkState&nbsp;after&nbsp;a&nbsp;setTimeout&nbsp;it&nbsp;still&nbsp;isn&#39;t&lt;br&gt;<br>
NETWORK_NO_SOURCE.&lt;br&gt;<br>
&lt;br&gt;<br>
Test&nbsp;case:&nbsp;&lt;a&nbsp;href=&quot;http://people.opera.com/philipj/2010/07/23/networkState.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://people.opera.com/philipj/2010/07/23/networkState.html&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;fix&nbsp;implementation&nbsp;or&nbsp;spec&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
1)&nbsp;Which&nbsp;behavior&nbsp;is&nbsp;more&nbsp;useful?&lt;br&gt;<br>
2)&nbsp;Sylvia&#39;s&nbsp;original&nbsp;issue&nbsp;was&nbsp;with&nbsp;play()&nbsp;-&nbsp;should&nbsp;we&nbsp;ensure&nbsp;that&nbsp;any&nbsp;time&lt;br&gt;<br>
you&nbsp;call&nbsp;play(),&nbsp;it&nbsp;will&nbsp;cause&nbsp;the&nbsp;media&nbsp;resource&nbsp;to&nbsp;start&nbsp;playing&nbsp;once&lt;br&gt;<br>
loaded?&nbsp;That&nbsp;seems&nbsp;like&nbsp;the&nbsp;real&nbsp;spec&nbsp;bug.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
The&nbsp;problem&nbsp;there&nbsp;with&nbsp;play&nbsp;in&nbsp;Opera&nbsp;was&nbsp;that&nbsp;the&nbsp;@src&nbsp;was&nbsp;changed,&nbsp;but&lt;br&gt;<br>
Opera&nbsp;doesn&#39;t&nbsp;run&nbsp;the&nbsp;resource&nbsp;selection&nbsp;algorithm&nbsp;to&nbsp;load&nbsp;it&nbsp;for&nbsp;play(),&lt;br&gt;<br>
but&nbsp;instead&nbsp;expects&nbsp;to&nbsp;run&nbsp;load()&nbsp;first.&nbsp;The&nbsp;description&nbsp;of&nbsp;play()&nbsp;however&lt;br&gt;<br>
clearly&nbsp;states&nbsp;as&nbsp;a&nbsp;first&nbsp;step:&lt;br&gt;<br>
1.&nbsp;If&nbsp;the&nbsp;media&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
element&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&lt;/a&gt;&gt;&#39;s&lt;br&gt;<br>
<br>
<br>
networkState&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-networkstate&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-networkstate&lt;/a&gt;&gt;attribute&lt;br&gt;<br>
<br>
<br>
has&nbsp;the&nbsp;value&lt;br&gt;<br>
NETWORK_EMPTY&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-network_empty&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-network_empty&lt;/a&gt;&gt;,&lt;br&gt;<br>
<br>
<br>
invoke&nbsp;the&nbsp;media&lt;br&gt;<br>
element&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&lt;/a&gt;&gt;&#39;s&lt;br&gt;<br>
<br>
<br>
resource&nbsp;selection&lt;br&gt;<br>
algorithm&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#concept-media-load-algorithm&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#concept-media-load-algorithm&lt;/a&gt;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
.&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;why&nbsp;we&nbsp;are&nbsp;discussing&nbsp;whether&nbsp;the&nbsp;networkState&nbsp;needs&nbsp;to&nbsp;be&lt;br&gt;<br>
NETWORK_EMPTY&nbsp;or&nbsp;NETWORK_NO_SOURCE&nbsp;after&nbsp;initialisation&nbsp;of&nbsp;a&nbsp;media&nbsp;element.&lt;br&gt;<br>
&lt;br&gt;<br>
Incidentally,&nbsp;that&nbsp;has&nbsp;effects&nbsp;on&nbsp;other&nbsp;elements,&nbsp;too,&nbsp;such&nbsp;as&nbsp;for&nbsp;&lt;source&gt;&lt;br&gt;<br>
it&nbsp;is&nbsp;stated:&lt;br&gt;&lt;/div&gt;<br>
If&nbsp;a&nbsp;source&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#the-source-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#the-source-element&lt;/a&gt;&gt;element&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
is&nbsp;inserted&nbsp;as&nbsp;a&nbsp;child&nbsp;of&nbsp;a&nbsp;media&lt;br&gt;&lt;/div&gt;<br>
element&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&lt;/a&gt;&gt;that&lt;br&gt;<br>
<br>
<br>
has&nbsp;no&lt;br&gt;<br>
src&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#attr-media-src&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#attr-media-src&lt;/a&gt;&gt;attribute&lt;br&gt;<br>
<br>
<br>
and&nbsp;whose&lt;br&gt;<br>
networkState&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-networkstate&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-networkstate&lt;/a&gt;&gt;has&lt;br&gt;<br>
<br>
<br>
the&nbsp;value&lt;br&gt;<br>
NETWORK_EMPTY&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-network_empty&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#dom-media-network_empty&lt;/a&gt;&gt;,&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
the&nbsp;user&nbsp;agent&nbsp;must&nbsp;invoke&nbsp;the&nbsp;media&lt;br&gt;&lt;/div&gt;<br>
element&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&lt;/a&gt;&gt;&#39;s&lt;br&gt;<br>
<br>
<br>
resource&nbsp;selection&lt;br&gt;<br>
algorithm&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#concept-media-load-algorithm&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#concept-media-load-algorithm&lt;/a&gt;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
.&lt;br&gt;<br>
&lt;br&gt;<br>
And&nbsp;for&nbsp;@src&nbsp;it&nbsp;is&nbsp;said:&lt;br&gt;&lt;/div&gt;<br>
If&nbsp;a&nbsp;src&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#attr-media-src&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#attr-media-src&lt;/a&gt;&gt;attribute&lt;br&gt;<br>
<br>
<br>
of&nbsp;a&nbsp;media&lt;br&gt;<br>
element&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&lt;/a&gt;&gt;is&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
set&nbsp;or&nbsp;changed,&nbsp;the&nbsp;user&nbsp;agent&nbsp;must&nbsp;invoke&nbsp;the&nbsp;media&lt;br&gt;&lt;/div&gt;<br>
element&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element&lt;/a&gt;&gt;&#39;s&lt;br&gt;<br>
<br>
<br>
media&nbsp;element&nbsp;load&lt;br&gt;<br>
algorithm&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element-load-algorithm&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#media-element-load-algorithm&lt;/a&gt;&gt;.&lt;br&gt;<br>
<br>
<br>
(*Removing*&nbsp;the&lt;br&gt;<br>
src&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#attr-media-src&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#attr-media-src&lt;/a&gt;&gt;attribute&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
does&nbsp;not&nbsp;do&nbsp;this,&nbsp;even&nbsp;if&nbsp;there&nbsp;are&lt;br&gt;&lt;/div&gt;<br>
source&lt;&lt;a&nbsp;href=&quot;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#the-source-element&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.whatwg.org/specs/web-apps/current-work/complete/video.html#the-source-element&lt;/a&gt;&gt;elements&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
present.)&lt;br&gt;<br>
&lt;br&gt;<br>
That&nbsp;is&nbsp;kinda&nbsp;strange,&nbsp;too,&nbsp;because&nbsp;really&nbsp;when&nbsp;@src&nbsp;is&nbsp;changed,&nbsp;resource&lt;br&gt;<br>
selection&nbsp;has&nbsp;to&nbsp;be&nbsp;run&nbsp;first&nbsp;rather&nbsp;than&nbsp;media&nbsp;element&nbsp;load.&lt;br&gt;<br>
&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
The&nbsp;load&nbsp;algorithm&nbsp;is&nbsp;just&nbsp;a&nbsp;wrapper&nbsp;for&nbsp;the&nbsp;resource&nbsp;selection&nbsp;algorithm&nbsp;that&nbsp;makes&nbsp;sure&nbsp;that&nbsp;a&nbsp;previously&nbsp;running&nbsp;resource&nbsp;selection&nbsp;algorithm&nbsp;is&nbsp;aborted&nbsp;in&nbsp;an&nbsp;orderly&nbsp;fashion&nbsp;and&nbsp;that&nbsp;the&nbsp;state&nbsp;is&nbsp;reset.&nbsp;What&#39;s&nbsp;strange?&lt;br&gt;<br>
<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;misread&nbsp;that,&nbsp;too.&nbsp;I&nbsp;thought&nbsp;it&nbsp;was&nbsp;pointing&nbsp;to&nbsp;the&nbsp;resource&nbsp;fetch&nbsp;algorithm&nbsp;and&nbsp;not&nbsp;the&nbsp;media&nbsp;element&nbsp;load&nbsp;algorithm.&nbsp;You&#39;re&nbsp;right&nbsp;-&nbsp;this&nbsp;part&nbsp;is&nbsp;fine.&lt;br&gt;&lt;br&gt;&lt;br&gt;Incidentally,&nbsp;your&nbsp;test&nbsp;isn&#39;t&nbsp;complete.&nbsp;In&nbsp;my&nbsp;test&nbsp;file,&nbsp;I&nbsp;was&nbsp;actually&nbsp;setting&nbsp;the&nbsp;@src&nbsp;values&nbsp;of&nbsp;the&nbsp;&lt;source&gt;&nbsp;elements&nbsp;to&nbsp;resources&nbsp;that&nbsp;existed&nbsp;and&nbsp;then&nbsp;called&nbsp;the&nbsp;play()&nbsp;function.&nbsp;That&nbsp;activity&nbsp;should,&nbsp;IMO,&nbsp;work.&nbsp;All&nbsp;browser&nbsp;accept&nbsp;it,&nbsp;except&nbsp;for&nbsp;Opera,&nbsp;which&nbsp;never&nbsp;leaves&nbsp;step&nbsp;21&nbsp;because&nbsp;play()&nbsp;doesn&#39;t&nbsp;accept&nbsp;NETWORK_NO_SOURCE&nbsp;for&nbsp;re-running&nbsp;the&nbsp;resource&nbsp;selection&nbsp;algorithm.&nbsp;That&nbsp;was&nbsp;really&nbsp;my&nbsp;original&nbsp;problem.&lt;br&gt;<br>
<br>
&lt;br&gt;Cheers,&lt;br&gt;Silvia.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
