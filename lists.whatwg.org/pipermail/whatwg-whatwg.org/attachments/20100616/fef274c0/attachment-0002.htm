<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.26.3&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
On&nbsp;Wed,&nbsp;2010-06-16&nbsp;at&nbsp;13:33&nbsp;+0200,&nbsp;gabmeyer@westweb.at&nbsp;wrote:<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
On&nbsp;6/15/10&nbsp;6:19&nbsp;PM,&nbsp;&lt;A&nbsp;HREF=&quot;mailto:gabmeyer@westweb.at&quot;&gt;gabmeyer@westweb.at&lt;/A&gt;&nbsp;wrote:<br>
&nbsp;Hello,<br>
<br>
&nbsp;I&nbsp;had&nbsp;just&nbsp;this&nbsp;idea&nbsp;after&nbsp;reading&nbsp;so&nbsp;much&nbsp;about&nbsp;xss&nbsp;and&nbsp;code&nbsp;injection.<br>
<br>
&nbsp;I&nbsp;think&nbsp;there&nbsp;is&nbsp;a&nbsp;simple&nbsp;solution:<br>
<br>
&nbsp;1.)<br>
&nbsp;I&nbsp;now&nbsp;invent&nbsp;an&nbsp;attribute&nbsp;called&nbsp;strlen=&quot;&quot;<br>
<br>
&nbsp;I&nbsp;append&nbsp;this&nbsp;to&nbsp;ahtmlcode&nbsp;with&nbsp;strlen&nbsp;of&nbsp;94843&nbsp;bytes&nbsp;including&nbsp;whitespace<br>
<br>
&nbsp;The&nbsp;browser&nbsp;know&nbsp;knows&nbsp;the&nbsp;exact&nbsp;position&nbsp;where&nbsp;the&nbsp;divtag&nbsp;must&nbsp;end.<br>
<br>
&nbsp;You&nbsp;cannot&nbsp;inject&nbsp;some&nbsp;code&nbsp;that&nbsp;closes&nbsp;the&nbsp;tag&nbsp;before.<br>
<br>
&nbsp;2.)<br>
&nbsp;you&nbsp;can&nbsp;now&nbsp;control&nbsp;the&nbsp;code&nbsp;inside&nbsp;the&nbsp;div.<br>
&nbsp;you&nbsp;can&nbsp;also&nbsp;append&nbsp;a&nbsp;second&nbsp;attribute&nbsp;called&nbsp;&quot;secure&quot;&nbsp;that&nbsp;prevents&nbsp;any&nbsp;scriptcode&nbsp;to&nbsp;run&nbsp;from&nbsp;inside&nbsp;the&nbsp;div.<br>
<br>
<br>
&nbsp;Maybe&nbsp;this&nbsp;idea&nbsp;is&nbsp;not&nbsp;new,&nbsp;or&nbsp;does&nbsp;not&nbsp;work.<br>
<br>
&nbsp;Please&nbsp;let&nbsp;me&nbsp;know&nbsp;what&nbsp;you&nbsp;think&nbsp;about&nbsp;this&nbsp;idea.<br>
<br>
&nbsp;Christian&nbsp;Gabmeyer<br>
<br>
On&nbsp;2010-06-16&nbsp;03:29:50&nbsp;&lt;A&nbsp;HREF=&quot;mailto:arun@mozilla.com&quot;&gt;arun@mozilla.com&lt;/A&gt;&nbsp;wrote:&nbsp;&nbsp;&nbsp;&nbsp;<br>
<br>
I&nbsp;think&nbsp;one&nbsp;approach&nbsp;that&nbsp;we're&nbsp;interested&nbsp;in&nbsp;pursuing&nbsp;at&nbsp;Mozilla&nbsp;is&nbsp;the&nbsp;<br>
Content&nbsp;Security&nbsp;Policy&nbsp;approach:<br>
<br>
&lt;A&nbsp;HREF=&quot;https://wiki.mozilla.org/Security/CSP/Specification&quot;&gt;https://wiki.mozilla.org/Security/CSP/Specification&lt;/A&gt;<br>
<br>
In&nbsp;particular,&nbsp;restrictions&nbsp;on&nbsp;inline&nbsp;scripts,&nbsp;or&nbsp;at&nbsp;least&nbsp;on&nbsp;'eval'&nbsp;<br>
might&nbsp;be&nbsp;useful&nbsp;here,&nbsp;along&nbsp;with&nbsp;other&nbsp;mitigation&nbsp;on&nbsp;loading&nbsp;cross-site&nbsp;<br>
content.<br>
<br>
We'd&nbsp;like&nbsp;this&nbsp;in&nbsp;the&nbsp;Firefox&nbsp;4&nbsp;timeframe.<br>
<br>
--&nbsp;A*<br>
<br>
<br>
Hello&nbsp;Arun<br>
CSP:&nbsp;This&nbsp;seams&nbsp;to&nbsp;affect&nbsp;only&nbsp;the&nbsp;whole&nbsp;document,&nbsp;because&nbsp;it&nbsp;uses&nbsp;a&nbsp;header&nbsp;to&nbsp;switch&nbsp;browser&nbsp;into&nbsp;secure&nbsp;mode.&nbsp;but&nbsp;from&nbsp;a&nbsp;htmlcoder&nbsp;&nbsp;point&nbsp;this&nbsp;is&nbsp;not&nbsp;the&nbsp;place&nbsp;where&nbsp;i&nbsp;work.&nbsp;everybody&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;write&nbsp;secure&nbsp;code&nbsp;not&nbsp;only&nbsp;the&nbsp;developer,&nbsp;i&nbsp;think.<br>
<br>
my&nbsp;aproach&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;define&nbsp;a&nbsp;strlen&nbsp;attribute&nbsp;gives&nbsp;the&nbsp;browser&nbsp;the&nbsp;ability&nbsp;to&nbsp;check&nbsp;for&nbsp;broken/closing&nbsp;tags,&nbsp;and&nbsp;in&nbsp;case&nbsp;of&nbsp;an&nbsp;injection&nbsp;inside&nbsp;the&nbsp;string&nbsp;it&nbsp;must&nbsp;ignore&nbsp;the&nbsp;foreign&nbsp;closing&nbsp;tag&nbsp;.<br>
If&nbsp;i&nbsp;put&nbsp;all&nbsp;unsecure&nbsp;code&nbsp;into&nbsp;sections&nbsp;of&nbsp;&lt;div&nbsp;unsecure=&quot;strlen&nbsp;in&nbsp;bytes&quot;&gt;&lt;/div&gt;&nbsp;it&nbsp;is&nbsp;posible&nbsp;for&nbsp;the&nbsp;browser&nbsp;to&nbsp;render&nbsp;the&nbsp;page&nbsp;correctly&nbsp;and&nbsp;than&nbsp;apply&nbsp;CSP&nbsp;to&nbsp;it.<br>
on&nbsp;the&nbsp;server&nbsp;side&nbsp;the&nbsp;developer&nbsp;must&nbsp;not&nbsp;know&nbsp;the&nbsp;content&nbsp;or&nbsp;even&nbsp;inspect&nbsp;it&nbsp;the&nbsp;only&nbsp;thing&nbsp;todo&nbsp;is&nbsp;run&nbsp;strlen()&nbsp;around&nbsp;it&nbsp;and&nbsp;create&nbsp;the&nbsp;tag&nbsp;surrounding&nbsp;the&nbsp;content.<br>
<br>
--&nbsp;C*<br>
<br>
<br>
<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;BR&gt;<br>
You're&nbsp;still&nbsp;missing&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;way&nbsp;most&nbsp;attacks&nbsp;happen&nbsp;is&nbsp;because&nbsp;the&nbsp;user-entered&nbsp;data&nbsp;is&nbsp;accepted&nbsp;by&nbsp;the&nbsp;server,&nbsp;and&nbsp;then&nbsp;output&nbsp;by&nbsp;the&nbsp;server.&nbsp;From&nbsp;where&nbsp;is&nbsp;it&nbsp;expected&nbsp;to&nbsp;make&nbsp;a&nbsp;correct&nbsp;strlen()&nbsp;calculation?!&nbsp;XSS&nbsp;attacks&nbsp;aren't&nbsp;just&nbsp;loads&nbsp;of&nbsp;code&nbsp;entered&nbsp;at&nbsp;the&nbsp;client-side&nbsp;of&nbsp;things.&nbsp;It's&nbsp;an&nbsp;attack&nbsp;on&nbsp;a&nbsp;system&nbsp;to&nbsp;exploit&nbsp;the&nbsp;browser,&nbsp;but&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;day,&nbsp;the&nbsp;onus&nbsp;is&nbsp;on&nbsp;the&nbsp;server&nbsp;to&nbsp;resolve&nbsp;the&nbsp;issue,&nbsp;as&nbsp;the&nbsp;browser&nbsp;isn't&nbsp;going&nbsp;to&nbsp;always&nbsp;make&nbsp;the&nbsp;best&nbsp;judgement&nbsp;call&nbsp;to&nbsp;fail&nbsp;something&nbsp;gracefully.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TABLE&nbsp;CELLSPACING=&quot;0&quot;&nbsp;CELLPADDING=&quot;0&quot;&nbsp;WIDTH=&quot;100%&quot;&gt;<br>
&lt;TR&gt;<br>
&lt;TD&gt;<br>
Thanks,&lt;BR&gt;<br>
Ash&lt;BR&gt;<br>
&lt;A&nbsp;HREF=&quot;http://www.ashleysheridan.co.uk&quot;&gt;http://www.ashleysheridan.co.uk&lt;/A&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;/TD&gt;<br>
&lt;/TR&gt;<br>
&lt;/TABLE&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
