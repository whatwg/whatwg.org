<tt>
I&#39;m&nbsp;not&nbsp;certain&nbsp;what&nbsp;a&nbsp;&quot;deep&nbsp;copy&quot;&nbsp;of&nbsp;the&nbsp;function&nbsp;means&nbsp;-&nbsp;would&nbsp;you&nbsp;need&nbsp;to&nbsp;copy&nbsp;the&nbsp;entire&nbsp;lexical&nbsp;scope&nbsp;of&nbsp;the&nbsp;function?&nbsp;For&nbsp;example,&nbsp;let&#39;s&nbsp;say&nbsp;you&nbsp;do&nbsp;this:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;var&nbsp;foo&nbsp;=&nbsp;1;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;function&nbsp;setFoo(val)&nbsp;{&nbsp;foo&nbsp;=&nbsp;val;&nbsp;}&lt;/div&gt;&lt;div&gt;function&nbsp;getFoo()&nbsp;{&nbsp;return&nbsp;foo;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;worker.postMessage(setFoo);&lt;/div&gt;&lt;div&gt;worker.postMessage(getFoo);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;foo&nbsp;=&nbsp;2;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;Then,&nbsp;from&nbsp;worker&nbsp;code,&nbsp;I&nbsp;call&nbsp;the&nbsp;copy&nbsp;of&nbsp;getFoo()&nbsp;-&nbsp;what&nbsp;should&nbsp;it&nbsp;return&nbsp;(undefined?&nbsp;Does&nbsp;it&nbsp;pull&nbsp;over&nbsp;a&nbsp;copy&nbsp;of&nbsp;foo&nbsp;from&nbsp;the&nbsp;original&nbsp;lexical&nbsp;scope,&nbsp;in&nbsp;which&nbsp;case&nbsp;it&#39;s&nbsp;1)?&nbsp;What&nbsp;if&nbsp;foo&nbsp;is&nbsp;defined&nbsp;in&nbsp;a&nbsp;lexical&nbsp;closure&nbsp;that&nbsp;is&nbsp;shared&nbsp;by&nbsp;both&nbsp;setFoo()&nbsp;and&nbsp;getFoo()&nbsp;-&nbsp;it&nbsp;seems&nbsp;like&nbsp;the&nbsp;separate&nbsp;copies&nbsp;of&nbsp;setFoo()&nbsp;and&nbsp;getFoo()&nbsp;passed&nbsp;to&nbsp;the&nbsp;worker&nbsp;would&nbsp;need&nbsp;to&nbsp;reconstruct&nbsp;a&nbsp;shared&nbsp;closure&nbsp;on&nbsp;the&nbsp;worker&nbsp;side,&nbsp;which&nbsp;seems&nbsp;difficult&nbsp;if&nbsp;not&nbsp;impossible.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;that&nbsp;some&nbsp;variant&nbsp;of&nbsp;data&nbsp;URLs&nbsp;and/or&nbsp;eval()&nbsp;gets&nbsp;you&nbsp;most&nbsp;of&nbsp;what&nbsp;you&nbsp;really&nbsp;need&nbsp;here&nbsp;without&nbsp;requiring&nbsp;extensive&nbsp;JS&nbsp;VM&nbsp;gymnastics.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-atw&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;Wed,&nbsp;Dec&nbsp;16,&nbsp;2009&nbsp;at&nbsp;9:23&nbsp;AM,&nbsp;Jan&nbsp;Fabry&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:jan.fabry@monkeyman.be&quot;&gt;jan.fabry@monkeyman.be&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
Hello,&lt;br&gt;<br>
&lt;br&gt;<br>
Has&nbsp;it&nbsp;been&nbsp;considered&nbsp;to&nbsp;pass&nbsp;more&nbsp;than&nbsp;JSON&nbsp;data&nbsp;to&nbsp;workers?&nbsp;I&nbsp;could&nbsp;not&nbsp;find&nbsp;a&nbsp;rationale&nbsp;behind&nbsp;this&nbsp;in&nbsp;the&nbsp;FAQ,&nbsp;or&nbsp;in&nbsp;other&nbsp;places&nbsp;I&nbsp;looked.&nbsp;I&nbsp;understand&nbsp;the&nbsp;need&nbsp;for&nbsp;separation&nbsp;because&nbsp;of&nbsp;concurrency&nbsp;issues,&nbsp;but&nbsp;aren&#39;t&nbsp;there&nbsp;other&nbsp;ways&nbsp;to&nbsp;accomplish&nbsp;this?&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
(The&nbsp;following&nbsp;text&nbsp;was&nbsp;already&nbsp;posted&nbsp;to&nbsp;the&nbsp;forum,&nbsp;but&nbsp;&quot;zcorpan&quot;&nbsp;suggested&nbsp;I&nbsp;also&nbsp;post&nbsp;it&nbsp;here)&lt;br&gt;<br>
[&nbsp;&lt;a&nbsp;href=&quot;http://forums.whatwg.org/viewtopic.php?t=4185&quot;&nbsp;target=&quot;_blank&quot;&gt;http://forums.whatwg.org/viewtopic.php?t=4185&lt;/a&gt;&nbsp;]&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;not&nbsp;a&nbsp;Javascript&nbsp;VM&nbsp;developer,&nbsp;so&nbsp;if&nbsp;the&nbsp;following&nbsp;does&nbsp;not&nbsp;make&nbsp;sense,&nbsp;please&nbsp;don&#39;t&nbsp;be&nbsp;too&nbsp;hard&nbsp;on&nbsp;me.&nbsp;A&nbsp;reply&nbsp;of&nbsp;&quot;Sorry,&nbsp;we&nbsp;thought&nbsp;about&nbsp;this&nbsp;longer&nbsp;than&nbsp;you&nbsp;did,&nbsp;and&nbsp;there&nbsp;are&nbsp;still&nbsp;cases&nbsp;where&nbsp;this&nbsp;is&nbsp;impossible&quot;&nbsp;is&nbsp;perfectly&nbsp;valid,&nbsp;but&nbsp;the&nbsp;more&nbsp;I&nbsp;can&nbsp;learn&nbsp;from&nbsp;this&nbsp;conversation,&nbsp;the&nbsp;better.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Would&nbsp;it&nbsp;be&nbsp;possible&nbsp;to&nbsp;do&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;function&nbsp;(object)&nbsp;you&nbsp;pass&nbsp;to&nbsp;the&nbsp;the&nbsp;constructor?&nbsp;So&nbsp;copy&nbsp;everything&nbsp;(or&nbsp;mark&nbsp;it&nbsp;for&nbsp;copy-on-write),&nbsp;but&nbsp;remove&nbsp;references&nbsp;to&nbsp;DOM&nbsp;elements&nbsp;if&nbsp;they&nbsp;exist.&nbsp;This&nbsp;way,&nbsp;I&nbsp;think&nbsp;you&nbsp;can&nbsp;create&nbsp;a&nbsp;parallel&nbsp;data&nbsp;structure,&nbsp;so&nbsp;the&nbsp;original&nbsp;one&nbsp;remains&nbsp;untouched&nbsp;(avoiding&nbsp;concurrency&nbsp;issues).&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
The&nbsp;important&nbsp;difference&nbsp;between&nbsp;this&nbsp;and&nbsp;the&nbsp;usual&nbsp;JSON-serializing&nbsp;of&nbsp;objects&nbsp;that&nbsp;the&nbsp;examples&nbsp;talk&nbsp;about,&nbsp;is&nbsp;that&nbsp;functions&nbsp;can&nbsp;be&nbsp;passed&nbsp;through&nbsp;too&nbsp;in&nbsp;an&nbsp;easy&nbsp;manner.&nbsp;If&nbsp;you&nbsp;have&nbsp;to&nbsp;simulate&nbsp;this&nbsp;using&nbsp;only&nbsp;Javascript,&nbsp;you&nbsp;have&nbsp;to&nbsp;somehow&nbsp;bind&nbsp;the&nbsp;free&nbsp;variables,&nbsp;which&nbsp;requires&nbsp;some&nbsp;introspection,&nbsp;and&nbsp;thus&nbsp;is&nbsp;not&nbsp;easy&nbsp;(if&nbsp;even&nbsp;possible?)&nbsp;to&nbsp;simulate&nbsp;in&nbsp;&quot;user&nbsp;space&quot;.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
The&nbsp;Google&nbsp;Gears&nbsp;API&nbsp;seems&nbsp;to&nbsp;provide&nbsp;both&nbsp;createWorker(scriptText)&nbsp;and&nbsp;createWorkerFromUrl(scriptUrl).&nbsp;Why&nbsp;was&nbsp;only&nbsp;the&nbsp;URL&nbsp;variant&nbsp;retained&nbsp;in&nbsp;the&nbsp;Web&nbsp;Workers&nbsp;spec?&nbsp;With&nbsp;the&nbsp;script&nbsp;variant,&nbsp;there&nbsp;would&nbsp;have&nbsp;been&nbsp;at&nbsp;least&nbsp;a&nbsp;little&nbsp;basis&nbsp;for&nbsp;more&nbsp;dynamic&nbsp;programming.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Greetings,&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
Jan&nbsp;Fabry&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
