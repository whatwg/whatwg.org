<tt>
&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;Arial;&nbsp;&quot;&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;Forums,&nbsp;bug&nbsp;trackers,&nbsp;mail&nbsp;programs,&nbsp;photo&nbsp;apps,&nbsp;etc.&nbsp;all&nbsp;have&nbsp;allow&nbsp;users&nbsp;to&nbsp;download&nbsp;attachments&nbsp;or&nbsp;view&nbsp;them&nbsp;inline&nbsp;in&nbsp;the&nbsp;browser.&nbsp; An&nbsp;offline-capable&nbsp;app&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;sync&nbsp;attachments&nbsp;down&nbsp;to&nbsp;the&nbsp;browser,&nbsp;as&nbsp;data.&nbsp; There&nbsp;may&nbsp;be&nbsp;thousands&nbsp;of&nbsp;such&nbsp;resources&nbsp;for&nbsp;one&nbsp;app,&nbsp;added&nbsp;and&nbsp;removed&nbsp;constantly,&nbsp;as&nbsp;part&nbsp;of&nbsp;data&nbsp;synchronization.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;text-align:&nbsp;right;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;Here&amp;#39;s&nbsp;one&nbsp;way&nbsp;to&nbsp;sync&nbsp;a&nbsp;single&nbsp;attachment&nbsp;down&nbsp;to&nbsp;an&nbsp;offline-capable&nbsp;client,&nbsp;by&nbsp;abusing&nbsp;the&nbsp;app&nbsp;cache:&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;1)&nbsp;Client&nbsp;creates&nbsp;a&nbsp;hidden&nbsp;iframe&nbsp;with&nbsp;the&nbsp;URL&nbsp;/manifestwrapper/&amp;lt;attachmentID&amp;gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;2)&nbsp;Server&nbsp;responds&nbsp;with&nbsp;a&nbsp;tiny&nbsp;HTML&nbsp;page&nbsp;whose&nbsp;sole&nbsp;purpose&nbsp;is&nbsp;to&nbsp;deliver&nbsp;a&nbsp;manifest&nbsp;attribute,&nbsp;pointing&nbsp;to&nbsp;/manifest/&amp;lt;attachmentID&amp;gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;3)&nbsp;The&nbsp;client&nbsp;requests&nbsp;the&nbsp;manifest,&nbsp;which&nbsp;has&nbsp;one&nbsp;URL&nbsp;in&nbsp;it:&nbsp;/attachment/&amp;lt;attachmentID&amp;gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;4)&nbsp;Finally,&nbsp;the&nbsp;client&nbsp;requests&nbsp;the&nbsp;attachment&nbsp;and&nbsp;stored&nbsp;it&nbsp;locally.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;This&nbsp;isn&amp;#39;t&nbsp;great,&nbsp;for&nbsp;a&nbsp;lot&nbsp;of&nbsp;reasons:&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;-&nbsp;It&nbsp;makes&nbsp;it&nbsp;hard&nbsp;to&nbsp;uninstall&nbsp;an&nbsp;offline&nbsp;client,&nbsp;because&nbsp;there&nbsp;are&nbsp;potentially&nbsp;thousands&nbsp;of&nbsp;teeny&nbsp;manifests.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;-&nbsp;It&amp;#39;s&nbsp;unlikely&nbsp;to&nbsp;scale&nbsp;well,&nbsp;since&nbsp;it&amp;#39;s&nbsp;kind&nbsp;of&nbsp;abusing&nbsp;the&nbsp;browser.&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;-&nbsp;It&nbsp;takes&nbsp;3&nbsp;server&nbsp;round&nbsp;trips&nbsp;to&nbsp;sync&nbsp;one&nbsp;attachment.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;-&nbsp;It&nbsp;can&amp;#39;t&nbsp;be&nbsp;done&nbsp;from&nbsp;a&nbsp;worker&nbsp;thread,&nbsp;since&nbsp;an&nbsp;HTML&nbsp;page&nbsp;is&nbsp;needed&nbsp;to&nbsp;provide&nbsp;a&nbsp;manifest&nbsp;attribute.&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;It&amp;#39;d&nbsp;be&nbsp;a&nbsp;lot&nbsp;better&nbsp;to&nbsp;have&nbsp;a&nbsp;JS&nbsp;API&nbsp;to&nbsp;capture&nbsp;new&nbsp;URLs.&nbsp; Since&nbsp;they&amp;#39;re&nbsp;web&nbsp;resources,&nbsp;it&amp;#39;s&nbsp;tempting&nbsp;to&nbsp;associate&nbsp;this&nbsp;with&nbsp;the&nbsp;app&nbsp;cache.&nbsp; But&nbsp;the&nbsp;update&nbsp;strategy&nbsp;is&nbsp;totally&nbsp;different&nbsp;from&nbsp;the&nbsp;app&nbsp;cache&amp;#39;s,&nbsp;so&nbsp;a&nbsp;more&nbsp;data-centric&nbsp;object&nbsp;might&nbsp;be&nbsp;more&nbsp;appropriate.&nbsp; And&nbsp;if&nbsp;it&nbsp;could&nbsp;be&nbsp;pure&nbsp;JS,&nbsp;callable&nbsp;from&nbsp;a&nbsp;worker,&nbsp;even&nbsp;better.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;Gears&nbsp;has&nbsp;something&nbsp;just&nbsp;like&nbsp;this: &lt;a&nbsp;href=&quot;http://code.google.com/apis/gears/api_localserver.html#ResourceStore&quot;&nbsp;style=&quot;color:&nbsp;rgb(85,&nbsp;26,&nbsp;139);&nbsp;&quot;&gt;http://code.google.com/apis/gears/api_localserver.html#ResourceStore&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;<br>

</tt>
