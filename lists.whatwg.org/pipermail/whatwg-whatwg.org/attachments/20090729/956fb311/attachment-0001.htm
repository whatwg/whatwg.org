<tt>
On&nbsp;Wed,&nbsp;Jul&nbsp;29,&nbsp;2009&nbsp;at&nbsp;8:40&nbsp;AM,&nbsp;Ian&nbsp;Hickson&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ian@hixie.ch&quot;&gt;ian@hixie.ch&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;Tue,&nbsp;14&nbsp;Jul&nbsp;2009,&nbsp;Jeremy&nbsp;Orlow&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;I&nbsp;think&nbsp;&amp;#39;readyState&amp;#39;&nbsp;should&nbsp;just&nbsp;go&nbsp;away&nbsp;since&nbsp;an&nbsp;application&nbsp;will&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;have&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;state&nbsp;updates&nbsp;through&nbsp;the&nbsp;fired&nbsp;events&nbsp;and&nbsp;use&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;&amp;gt;&nbsp;try/catch&nbsp;blocks&nbsp;around&nbsp;all&nbsp;API&nbsp;calls&nbsp;anyway.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;The&nbsp;attribute&nbsp;is&nbsp;mostly&nbsp;present&nbsp;for&nbsp;debugging&nbsp;purposes.&nbsp;I&nbsp;wouldn&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;expect&nbsp;anyone&nbsp;to&nbsp;actually&nbsp;use&nbsp;it&nbsp;for&nbsp;production&nbsp;work.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Is&nbsp;there&nbsp;precedent&nbsp;for&nbsp;other&nbsp;portions&nbsp;of&nbsp;the&nbsp;API&nbsp;that&nbsp;are&nbsp;mostly&nbsp;for&lt;br&gt;<br>
&amp;gt;&nbsp;debugging&nbsp;purposes?&nbsp; (I&nbsp;can&amp;#39;t&nbsp;think&nbsp;of&nbsp;anything&nbsp;off&nbsp;the&nbsp;top&nbsp;of&nbsp;my&nbsp;head.)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;readyState&nbsp;on&nbsp;Document&nbsp;and&nbsp;&amp;lt;video&amp;gt;&nbsp;aren&amp;#39;t&nbsp;realy&nbsp;useful&nbsp;for&nbsp;anything&nbsp;but&lt;br&gt;<br>
debugging&nbsp;either,&nbsp;as&nbsp;far&nbsp;as&nbsp;I&nbsp;can&nbsp;tell.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;Also,&nbsp;maybe&nbsp;it&nbsp;should&nbsp;be&nbsp;noted&nbsp;as&nbsp;such&nbsp;in&nbsp;the&nbsp;spec?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;don&amp;#39;t&nbsp;really&nbsp;see&nbsp;much&nbsp;benefit&nbsp;to&nbsp;including&nbsp;such&nbsp;a&nbsp;statement;&nbsp;if&nbsp;someone&lt;br&gt;<br>
wants&nbsp;to&nbsp;use&nbsp;it&nbsp;for&nbsp;a&nbsp;non-debugging&nbsp;reason,&nbsp;why&nbsp;not&nbsp;do&nbsp;so?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;it&amp;#39;s&nbsp;only&nbsp;for&nbsp;debugging&nbsp;purposes,&nbsp;maybe&nbsp;a&nbsp;cleaner&nbsp;way&nbsp;to&nbsp;define&nbsp;it&nbsp;is&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;simply&nbsp;be&nbsp;the&nbsp;last&nbsp;event&nbsp;fired&nbsp;on&nbsp;a&nbsp;given&nbsp;WebSocket?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;don&amp;#39;t&nbsp;really&nbsp;understand&nbsp;what&nbsp;problem&nbsp;we&nbsp;would&nbsp;be&nbsp;trying&nbsp;to&nbsp;solve&nbsp;by&lt;br&gt;<br>
changing&nbsp;that.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;One&nbsp;other&nbsp;random&nbsp;question:&nbsp; in&nbsp;the&nbsp;IDL&nbsp;for&nbsp;WebSockets,&nbsp;the&nbsp;three&lt;br&gt;<br>
&amp;gt;&nbsp;constants&nbsp;for&nbsp;ready&nbsp;state&nbsp;are&nbsp;all&nbsp;defined&nbsp;as&nbsp;shorts&nbsp;but&nbsp;the&nbsp;value&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;ready&nbsp;state&nbsp;is&nbsp;a&nbsp;long.&nbsp; Is&nbsp;this&nbsp;an&nbsp;oversight?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Fixed.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Alexey&nbsp;Proskuryakov&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;agree&nbsp;with&nbsp;Michael&nbsp;that&nbsp;send()&nbsp;should&nbsp;not&nbsp;silently&nbsp;drop&nbsp;data&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;could&nbsp;not&nbsp;be&nbsp;sent.&nbsp;It&nbsp;is&nbsp;very&nbsp;easy&nbsp;to&nbsp;fill&nbsp;send&nbsp;buffers,&nbsp;and&nbsp;if&nbsp;bytes&lt;br&gt;<br>
&amp;gt;&nbsp;get&nbsp;silently&nbsp;dropped,&nbsp;implementing&nbsp;app-level&nbsp;acks&nbsp;becomes&nbsp;quite&lt;br&gt;<br>
&amp;gt;&nbsp;difficult.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&amp;#39;ve&nbsp;made&nbsp;it&nbsp;clear&nbsp;that&nbsp;if&nbsp;bytes&nbsp;can&amp;#39;t&nbsp;be&nbsp;sent,&nbsp;the&nbsp;connection&nbsp;must&nbsp;be&lt;br&gt;<br>
closed.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&amp;#39;m&nbsp;wondering&nbsp;why&nbsp;send()&nbsp;doesn&amp;#39;t&nbsp;raise&nbsp;INVALID_STATE_ERR&nbsp;exception&nbsp;when<br>
readyState&nbsp;is&nbsp;CLOSED&nbsp;and&nbsp;is&nbsp;required&nbsp;to&nbsp;queue&nbsp;up&nbsp;the&nbsp;data&nbsp;after<br>
closed. &nbsp;What&nbsp;is&nbsp;the&nbsp;reason&nbsp;for&nbsp;this&nbsp;behavior?&lt;br&gt;<br>
&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;However,&nbsp;I&nbsp;do&nbsp;not&nbsp;think&nbsp;that&nbsp;raising&nbsp;an&nbsp;exception&nbsp;is&nbsp;an&nbsp;appropriate&lt;br&gt;<br>
&amp;gt;&nbsp;answer.&nbsp;Often,&nbsp;the&nbsp;TCP&nbsp;implementation&nbsp;takes&nbsp;a&nbsp;part&nbsp;of&nbsp;data&nbsp;given&nbsp;to&nbsp;it,&lt;br&gt;<br>
&amp;gt;&nbsp;and&nbsp;asks&nbsp;to&nbsp;resubmit&nbsp;the&nbsp;rest&nbsp;later.&nbsp;So,&nbsp;just&nbsp;returning&nbsp;an&nbsp;integer&lt;br&gt;<br>
&amp;gt;&nbsp;result&nbsp;from&nbsp;send()&nbsp;would&nbsp;be&nbsp;best&nbsp;in&nbsp;my&nbsp;opinion.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;think&nbsp;we&nbsp;are&nbsp;best&nbsp;off&nbsp;abstracting&nbsp;away&nbsp;this&nbsp;level&nbsp;of&nbsp;complexity&nbsp;from&lt;br&gt;<br>
authors,&nbsp;especially&nbsp;since&nbsp;we&amp;#39;d&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;data&nbsp;was&nbsp;not&nbsp;sent&lt;br&gt;<br>
half-way&nbsp;through&nbsp;a&nbsp;UTF-8&nbsp;sequence,&nbsp;and&nbsp;since&nbsp;the&nbsp;framing&nbsp;is&nbsp;under&nbsp;the&lt;br&gt;<br>
control&nbsp;of&nbsp;the&nbsp;UA,&nbsp;not&nbsp;the&nbsp;application.&nbsp;There&amp;#39;s&nbsp;no&nbsp;way&nbsp;to&nbsp;retry&nbsp;a&lt;br&gt;<br>
partially-successful&nbsp;send()&nbsp;from&nbsp;the&nbsp;API&nbsp;here.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;1)&nbsp;Web&nbsp;Sockets&nbsp;is&nbsp;specified&nbsp;to&nbsp;send&nbsp;whatever&nbsp;authentication&nbsp;credentials&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;client&nbsp;has&nbsp;for&nbsp;the&nbsp;resource.&nbsp;However,&nbsp;there&nbsp;is&nbsp;no&nbsp;challenge-response&lt;br&gt;<br>
&amp;gt;&nbsp;sequence&nbsp;specified,&nbsp;which&nbsp;seems&nbsp;to&nbsp;prevent&nbsp;using&nbsp;common&nbsp;auth&nbsp;schemes.&lt;br&gt;<br>
&amp;gt;&nbsp;HTTP&nbsp;Basic&nbsp;needs&nbsp;to&nbsp;know&nbsp;an&nbsp;authentication&nbsp;realm&nbsp;for&nbsp;the&nbsp;credentials,&lt;br&gt;<br>
&amp;gt;&nbsp;and&nbsp;other&nbsp;schemes&nbsp;need&nbsp;a&nbsp;cryptographic&nbsp;challenge&nbsp;(e.g.&nbsp;nonce&nbsp;for&nbsp;Digest&lt;br&gt;<br>
&amp;gt;&nbsp;auth).&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;expect&nbsp;to&nbsp;address&nbsp;this&nbsp;in&nbsp;more&nbsp;detail&nbsp;in&nbsp;a&nbsp;future&nbsp;version.&nbsp;For&nbsp;now,&nbsp;use&lt;br&gt;<br>
in-band&nbsp;authentication&nbsp;in&nbsp;the&nbsp;WebSocket&nbsp;once&nbsp;you&nbsp;are&nbsp;connected.&nbsp;We&nbsp;may&lt;br&gt;<br>
find&nbsp;that&nbsp;that&nbsp;is&nbsp;actually&nbsp;enough.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;2)&nbsp;It&nbsp;is&nbsp;not&nbsp;specified&nbsp;what&nbsp;the&nbsp;server&nbsp;does&nbsp;when&nbsp;credentials&nbsp;are&lt;br&gt;<br>
&amp;gt;&nbsp;incorrect,&nbsp;so&nbsp;I&nbsp;assume&nbsp;that&nbsp;the&nbsp;intended&nbsp;behavior&nbsp;is&nbsp;to&nbsp;close&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;connection.&nbsp;Unlike&nbsp;HTTP&nbsp;401&nbsp;response,&nbsp;this&nbsp;doesn&amp;#39;t&nbsp;give&nbsp;the&nbsp;client&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;chance&nbsp;to&nbsp;ask&nbsp;the&nbsp;user&nbsp;again.&nbsp;Also,&nbsp;if&nbsp;the&nbsp;server&nbsp;is&nbsp;on&nbsp;a&nbsp;different&lt;br&gt;<br>
&amp;gt;&nbsp;host,&nbsp;especially&nbsp;one&nbsp;that&amp;#39;s&nbsp;not&nbsp;shared&nbsp;with&nbsp;an&nbsp;HTTP&nbsp;server,&nbsp;there&nbsp;isn&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;a&nbsp;way&nbsp;to&nbsp;obtain&nbsp;credentials,&nbsp;in&nbsp;the&nbsp;first&nbsp;place.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;How&nbsp;we&nbsp;address&nbsp;this&nbsp;will&nbsp;likely&nbsp;depend&nbsp;on&nbsp;how&nbsp;we&nbsp;address&nbsp;the&nbsp;earlier&lt;br&gt;<br>
point.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;3)&nbsp;A&nbsp;Web&nbsp;Sockets&nbsp;server&nbsp;cannot&nbsp;respond&nbsp;with&nbsp;a&nbsp;redirect&nbsp;to&nbsp;another&nbsp;URL.&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;if&nbsp;the&nbsp;intention&nbsp;is&nbsp;to&nbsp;leave&nbsp;this&nbsp;to&nbsp;implementations,&nbsp;or&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;add&nbsp;in&nbsp;Web&nbsp;Sockets&nbsp;v2,&nbsp;but&nbsp;it&nbsp;definitely&nbsp;looks&nbsp;like&nbsp;an&nbsp;important&nbsp;feature&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;me,&nbsp;maybe&nbsp;something&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;in&nbsp;v1.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;What&amp;#39;s&nbsp;the&nbsp;use&nbsp;case?&nbsp;Why&nbsp;does&nbsp;this&nbsp;need&nbsp;to&nbsp;be&nbsp;at&nbsp;the&nbsp;connection&nbsp;layer&lt;br&gt;<br>
rather&nbsp;than&nbsp;the&nbsp;application&nbsp;layer?&nbsp;(Why&nbsp;would&nbsp;we&nbsp;need&nbsp;this,&nbsp;when&nbsp;TCP&lt;br&gt;<br>
doesn&amp;#39;t&nbsp;have&nbsp;it?&nbsp;Would&nbsp;you&nbsp;also&nbsp;need&nbsp;&amp;quot;redirect&amp;quot;-like&nbsp;functonality&nbsp;in&nbsp;IRC,&lt;br&gt;<br>
IMAP,&nbsp;SSH,&nbsp;and&nbsp;other&nbsp;such&nbsp;protocols?)&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;4)&nbsp;&amp;quot;If&nbsp;the&nbsp;user&nbsp;agent&nbsp;already&nbsp;has&nbsp;a&nbsp;Web&nbsp;Socket&nbsp;connection&nbsp;to&nbsp;the&nbsp;remote&lt;br&gt;<br>
&amp;gt;&nbsp;host&nbsp;identified&nbsp;by&nbsp;/host/&nbsp;(even&nbsp;if&nbsp;known&nbsp;by&nbsp;another&nbsp;name),&nbsp;wait&nbsp;until&lt;br&gt;<br>
&amp;gt;&nbsp;that&nbsp;connection&nbsp;has&nbsp;been&nbsp;established&nbsp;or&nbsp;for&nbsp;that&nbsp;connection&nbsp;to&nbsp;have&lt;br&gt;<br>
&amp;gt;&nbsp;failed.&amp;quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;doesn&amp;#39;t&nbsp;look&nbsp;like&nbsp;&amp;quot;host&nbsp;identified&nbsp;by&nbsp;/host/&amp;quot;&nbsp;is&nbsp;defined&nbsp;anywhere.&lt;br&gt;<br>
&amp;gt;&nbsp;Does&nbsp;this&nbsp;requirement&nbsp;say&nbsp;that&nbsp;IP&nbsp;addresses&nbsp;should&nbsp;be&nbsp;compared,&nbsp;instead&lt;br&gt;<br>
&amp;gt;&nbsp;of&nbsp;host&nbsp;names?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Right.&nbsp;I&amp;#39;ve&nbsp;tried&nbsp;to&nbsp;clarify&nbsp;this.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;if&nbsp;this&nbsp;is&nbsp;significant&nbsp;for&nbsp;preventing&nbsp;DoS&nbsp;attacks,&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;anyway,&nbsp;the&nbsp;IP&nbsp;address&nbsp;may&nbsp;not&nbsp;be&nbsp;known&nbsp;before&nbsp;a&nbsp;request&nbsp;is&nbsp;sent.&nbsp;This&lt;br&gt;<br>
&amp;gt;&nbsp;puts&nbsp;an&nbsp;unusual&nbsp;burden&nbsp;on&nbsp;the&nbsp;implementation.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Without&nbsp;this&nbsp;requirement,&nbsp;you&nbsp;can&nbsp;just&nbsp;have&nbsp;a&nbsp;DNS&nbsp;server&nbsp;return&nbsp;the&nbsp;victim&lt;br&gt;<br>
IP&nbsp;for&nbsp;a&nbsp;wildcard&nbsp;DNS&nbsp;entry,&nbsp;and&nbsp;then&nbsp;just&nbsp;have&nbsp;attackers&nbsp;open&nbsp;connections&lt;br&gt;<br>
to&nbsp;thousands&nbsp;of&nbsp;&amp;quot;hosts&amp;quot;.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;5)&nbsp;We&nbsp;probably&nbsp;need&nbsp;to&nbsp;specify&nbsp;a&nbsp;keep-alive&nbsp;feature&nbsp;to&nbsp;avoid&nbsp;proxy&lt;br&gt;<br>
&amp;gt;&nbsp;connection&nbsp;timeout.&nbsp;I&nbsp;do&nbsp;not&nbsp;have&nbsp;factual&nbsp;data&nbsp;on&nbsp;whether&nbsp;common&nbsp;proxies&lt;br&gt;<br>
&amp;gt;&nbsp;implement&nbsp;connection&nbsp;timeout,&nbsp;but&nbsp;I&amp;#39;d&nbsp;expect&nbsp;them&nbsp;to&nbsp;often&nbsp;do.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;This&nbsp;seems&nbsp;like&nbsp;something&nbsp;that&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;deal&nbsp;with&nbsp;at&nbsp;the&lt;br&gt;<br>
application&nbsp;layer,&nbsp;if&nbsp;desired.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;6)&nbsp;The&nbsp;spec&nbsp;should&nbsp;probably&nbsp;explicitly&nbsp;permit&nbsp;blocking&nbsp;some&nbsp;ports&nbsp;from&lt;br&gt;<br>
&amp;gt;&nbsp;use&nbsp;with&nbsp;Web&nbsp;Sockets&nbsp;at&nbsp;UA&amp;#39;s&nbsp;discretion.&nbsp;In&nbsp;practice,&nbsp;the&nbsp;list&nbsp;would&lt;br&gt;<br>
&amp;gt;&nbsp;likely&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;for&nbsp;HTTP,&nbsp;see&nbsp;e.g.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;http://www.mozilla.org/projects/netlib/PortBanning.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.mozilla.org/projects/netlib/PortBanning.html&lt;/a&gt;&amp;gt;.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Done.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;7)&nbsp;&amp;quot;use&nbsp;a&nbsp;SOCKS&nbsp;proxy&nbsp;for&nbsp;WebSocket&nbsp;connections,&nbsp;if&nbsp;available,&nbsp;or&nbsp;failing&lt;br&gt;<br>
&amp;gt;&nbsp;that,&nbsp;to&nbsp;prefer&nbsp;an&nbsp;HTTPS&nbsp;proxy&nbsp;over&nbsp;an&nbsp;HTTP&nbsp;proxy&amp;quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;is&nbsp;not&nbsp;clear&nbsp;what&nbsp;definition&nbsp;of&nbsp;proxy&nbsp;types&nbsp;is&nbsp;used&nbsp;here.&nbsp;To&nbsp;me,&nbsp;an&nbsp;HTTPS&lt;br&gt;<br>
&amp;gt;&nbsp;proxy&nbsp;is&nbsp;one&nbsp;that&nbsp;supports&nbsp;CONNECT&nbsp;to&nbsp;port&nbsp;443,&nbsp;and&nbsp;an&nbsp;HTTP&nbsp;proxy&nbsp;(if&nbsp;we&amp;#39;re&lt;br&gt;<br>
&amp;gt;&nbsp;making&nbsp;a&nbsp;distinction&nbsp;from&nbsp;HTTPS)&nbsp;is&nbsp;one&nbsp;that&nbsp;intercepts&nbsp;and&nbsp;forwards&nbsp;GET&lt;br&gt;<br>
&amp;gt;&nbsp;requests.&nbsp;However,&nbsp;this&nbsp;understanding&nbsp;contradicts&nbsp;an&nbsp;example&nbsp;in&nbsp;paragraph&lt;br&gt;<br>
&amp;gt;&nbsp;3.1.3,&nbsp;and&nbsp;also,&nbsp;it&amp;#39;s&nbsp;not&nbsp;clear&nbsp;how&nbsp;a&nbsp;GET&nbsp;proxy&nbsp;could&nbsp;be&nbsp;used&nbsp;for&nbsp;Web&nbsp;Sockets.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Clarified,&nbsp;I&nbsp;hope.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;8)&nbsp;Many&nbsp;HTTPS&nbsp;proxies&nbsp;only&nbsp;allow&nbsp;connecting&nbsp;to&nbsp;port&nbsp;443.&nbsp;Do&nbsp;you&nbsp;have&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;data&nbsp;on&nbsp;whether&nbsp;relying&nbsp;on&nbsp;existing&nbsp;proxies&nbsp;to&nbsp;establish&nbsp;connections&nbsp;to&lt;br&gt;<br>
&amp;gt;&nbsp;arbitrary&nbsp;ports&nbsp;is&nbsp;practical?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;do&nbsp;not.&nbsp;I&nbsp;expect&nbsp;most&nbsp;people&nbsp;to&nbsp;use&nbsp;direct&nbsp;connections&nbsp;over&nbsp;port&nbsp;81&nbsp;or&lt;br&gt;<br>
TLS&nbsp;over&nbsp;port&nbsp;443,&nbsp;as&nbsp;discussed&nbsp;in&nbsp;the&nbsp;introduction.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt; You&nbsp;mean&nbsp;TLS&nbsp;over&nbsp;port&nbsp;815&nbsp;here,&nbsp;although&nbsp;TLS&nbsp;over&nbsp;port&nbsp;443&nbsp;would&nbsp;be&nbsp;practical&nbsp;because&nbsp;of&nbsp;common&nbsp;firewall&nbsp;configuration?&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;9)&nbsp;&amp;quot;There&nbsp;is&nbsp;no&nbsp;limit&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;established&nbsp;Web&nbsp;Socket&lt;br&gt;<br>
&amp;gt;&nbsp;connections&nbsp;a&nbsp;user&nbsp;agent&nbsp;can&nbsp;have&nbsp;with&nbsp;a&nbsp;single&nbsp;remote&nbsp;host&amp;quot;.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Does&nbsp;this&nbsp;mean&nbsp;that&nbsp;Web&nbsp;Socket&nbsp;connections&nbsp;are&nbsp;exempt&nbsp;from&nbsp;the&nbsp;normal&lt;br&gt;<br>
&amp;gt;&nbsp;4-connection&nbsp;(or&nbsp;so)&nbsp;limit?&nbsp;Why&nbsp;is&nbsp;it&nbsp;OK?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;That&nbsp;limit&nbsp;is&nbsp;an&nbsp;HTTP&nbsp;limit.&nbsp;WebSocket&nbsp;is&nbsp;not&nbsp;an&nbsp;HTTP&nbsp;protocol,&nbsp;so&nbsp;the&lt;br&gt;<br>
limit&nbsp;has&nbsp;no&nbsp;bearing&nbsp;on&nbsp;WebSocket.&lt;br&gt;<br>
&lt;br&gt;<br>
As&nbsp;I&nbsp;understand&nbsp;it,&nbsp;the&nbsp;limit&nbsp;in&nbsp;HTTP&nbsp;is&nbsp;intended&nbsp;to&nbsp;deal&nbsp;with&nbsp;the&nbsp;problem&lt;br&gt;<br>
of&nbsp;multiple&nbsp;short-lived&nbsp;connections&nbsp;being&nbsp;needed&nbsp;to&nbsp;render&nbsp;a&nbsp;page,&nbsp;e.g.&lt;br&gt;<br>
going&nbsp;to&nbsp;a&nbsp;Web&nbsp;page&nbsp;with&nbsp;thousands&nbsp;of&nbsp;&amp;lt;img&amp;gt;s.&nbsp;There&nbsp;would&nbsp;be&nbsp;no&nbsp;way&nbsp;for&lt;br&gt;<br>
the&nbsp;author&nbsp;to&nbsp;ensure&nbsp;the&nbsp;page&nbsp;didn&amp;#39;t&nbsp;DOS&nbsp;the&nbsp;server&nbsp;in&nbsp;such&nbsp;a&nbsp;case.&nbsp;This&lt;br&gt;<br>
is&nbsp;not&nbsp;a&nbsp;concern&nbsp;with&nbsp;WebSocket,&nbsp;where&nbsp;the&nbsp;author&nbsp;controls&nbsp;when&nbsp;the&lt;br&gt;<br>
connections&nbsp;are&nbsp;made.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;10)&nbsp;Web&nbsp;Socket&nbsp;handshake&nbsp;uses&nbsp;CRLF&nbsp;line&nbsp;endings&nbsp;strictly.&nbsp;Does&nbsp;this&nbsp;add&lt;br&gt;<br>
&amp;gt;&nbsp;much&nbsp;to&nbsp;security?&nbsp;It&nbsp;prevents&nbsp;using&nbsp;telnet/netcat&nbsp;for&nbsp;debugging,&nbsp;which&lt;br&gt;<br>
&amp;gt;&nbsp;is&nbsp;something&nbsp;I&nbsp;personally&nbsp;use&nbsp;often&nbsp;when&nbsp;working&nbsp;on&nbsp;networking&nbsp;issues.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;practical&nbsp;reason&nbsp;for&nbsp;this,&nbsp;I&amp;#39;d&nbsp;suggest&nbsp;relaxing&nbsp;this&lt;br&gt;<br>
&amp;gt;&nbsp;aspect&nbsp;of&nbsp;parsing.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Do&nbsp;you&nbsp;mean&nbsp;client-&amp;gt;server&nbsp;or&nbsp;server-&amp;gt;client?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;11)&nbsp;There&nbsp;is&nbsp;no&nbsp;way&nbsp;for&nbsp;the&nbsp;client&nbsp;to&nbsp;know&nbsp;that&nbsp;the&nbsp;connection&nbsp;has&nbsp;been&lt;br&gt;<br>
&amp;gt;&nbsp;closed.&nbsp;For&nbsp;example:&lt;br&gt;<br>
&amp;gt;&nbsp;-&nbsp;socket.close()&nbsp;is&nbsp;called&nbsp;from&nbsp;JavaScript;&lt;br&gt;<br>
&amp;gt;&nbsp;-&nbsp;onclose&nbsp;handler&nbsp;is&nbsp;invoked;&lt;br&gt;<br>
&amp;gt;&nbsp;-&nbsp;more&nbsp;data&nbsp;arrives&nbsp;from&nbsp;the&nbsp;server,&nbsp;and&nbsp;onmessage&nbsp;is&nbsp;dispatched&nbsp;(which&nbsp;I&lt;br&gt;<br>
&amp;gt;&nbsp;think&nbsp;is&nbsp;correct,&nbsp;and&nbsp;it&nbsp;matches&nbsp;what&nbsp;TCP&nbsp;does);&lt;br&gt;<br>
&amp;gt;&nbsp;-&nbsp;finally,&nbsp;a&nbsp;TCP&nbsp;FIN&nbsp;arrives,&nbsp;indicating&nbsp;that&nbsp;there&nbsp;will&nbsp;be&nbsp;no&nbsp;more&nbsp;data&nbsp;from&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;server&nbsp;(the&nbsp;underlying&nbsp;TCP&nbsp;connection&nbsp;is&nbsp;in&nbsp;TIME_WAIT&nbsp;state&nbsp;after&nbsp;that);&lt;br&gt;<br>
&amp;gt;&nbsp;-&nbsp;the&nbsp;client&nbsp;never&nbsp;learns&nbsp;that&nbsp;the&nbsp;server&nbsp;is&nbsp;done&nbsp;sending&nbsp;data.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;The&nbsp;onclose&nbsp;only&nbsp;fires&nbsp;once&nbsp;the&nbsp;connection&nbsp;has&nbsp;closed,&nbsp;which&nbsp;is&nbsp;after&nbsp;the&lt;br&gt;<br>
TCP&nbsp;FIN,&nbsp;so&nbsp;it&nbsp;happens&nbsp;after&nbsp;the&nbsp;last&nbsp;&amp;#39;message&amp;#39;&nbsp;event.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt; so,&nbsp;it&nbsp;means&nbsp;we&nbsp;might&nbsp;receive&nbsp;message&nbsp;events&nbsp;even&nbsp;after&nbsp;we&nbsp;call&nbsp;websocket.close(),&nbsp;until&nbsp;we&nbsp;get&nbsp;close&nbsp;event?&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;As&nbsp;Web&nbsp;Sockets&nbsp;are&nbsp;basically&nbsp;at&nbsp;the&nbsp;same&nbsp;level&nbsp;as&nbsp;TCP,&nbsp;and&nbsp;TCP&nbsp;provides&lt;br&gt;<br>
&amp;gt;&nbsp;complete&nbsp;info&nbsp;about&nbsp;socket&nbsp;state,&nbsp;I&nbsp;don&amp;#39;t&nbsp;think&nbsp;that&nbsp;delegating&lt;br&gt;<br>
&amp;gt;&nbsp;connection&nbsp;closing&nbsp;to&nbsp;app-level&nbsp;protocols&nbsp;would&nbsp;be&nbsp;appropriate.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&amp;#39;m&nbsp;not&nbsp;sure&nbsp;what&nbsp;you&nbsp;mean.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Maciej&nbsp;Stachowiak&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;With&nbsp;WebSocket,&nbsp;another&nbsp;possibility&nbsp;is&nbsp;for&nbsp;the&nbsp;implementation&nbsp;to&nbsp;buffer&lt;br&gt;<br>
&amp;gt;&nbsp;pending&nbsp;data&nbsp;that&nbsp;could&nbsp;not&nbsp;yet&nbsp;be&nbsp;sent&nbsp;to&nbsp;the&nbsp;TCP&nbsp;layer,&nbsp;so&nbsp;that&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;client&nbsp;of&nbsp;WebSocket&nbsp;doesn&amp;#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;exposed&nbsp;to&nbsp;system&nbsp;limitations.&nbsp;At&lt;br&gt;<br>
&amp;gt;&nbsp;that&nbsp;point,&nbsp;an&nbsp;exception&nbsp;is&nbsp;only&nbsp;needed&nbsp;if&nbsp;the&nbsp;implementation&nbsp;runs&nbsp;out&lt;br&gt;<br>
&amp;gt;&nbsp;of&nbsp;memory&nbsp;for&nbsp;buffering.&nbsp;With&nbsp;a&nbsp;system&nbsp;TCP&nbsp;implementation,&nbsp;the&nbsp;buffering&lt;br&gt;<br>
&amp;gt;&nbsp;would&nbsp;be&nbsp;in&nbsp;kernel&nbsp;space,&nbsp;which&nbsp;is&nbsp;a&nbsp;scarce&nbsp;resource,&nbsp;but&nbsp;user&nbsp;space&lt;br&gt;<br>
&amp;gt;&nbsp;memory&nbsp;inside&nbsp;the&nbsp;implementation&nbsp;is&nbsp;no&nbsp;more&nbsp;scarce&nbsp;than&nbsp;user&nbsp;space&lt;br&gt;<br>
&amp;gt;&nbsp;memory&nbsp;held&nbsp;by&nbsp;the&nbsp;Web&nbsp;application&nbsp;waiting&nbsp;to&nbsp;send&nbsp;to&nbsp;the&nbsp;WebSocket.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Indeed.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Alexey&nbsp;Proskuryakov&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;agree&nbsp;that&nbsp;this&nbsp;will&nbsp;help&nbsp;if&nbsp;the&nbsp;application&nbsp;sends&nbsp;data&nbsp;in&nbsp;burst&nbsp;mode,&lt;br&gt;<br>
&amp;gt;&nbsp;but&nbsp;what&nbsp;if&nbsp;it&nbsp;just&nbsp;constantly&nbsp;sends&nbsp;more&nbsp;than&nbsp;the&nbsp;network&nbsp;can&nbsp;transmit?&lt;br&gt;<br>
&amp;gt;&nbsp;It&nbsp;will&nbsp;never&nbsp;learn&nbsp;that&nbsp;it&amp;#39;s&nbsp;misbehaving,&nbsp;and&nbsp;will&nbsp;just&nbsp;take&nbsp;more&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;more&nbsp;memory.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&amp;#39;ve&nbsp;added&nbsp;an&nbsp;attribute&nbsp;that&nbsp;says&nbsp;how&nbsp;much&nbsp;data&nbsp;has&nbsp;been&nbsp;buffered,&nbsp;so&nbsp;an&lt;br&gt;<br>
application&nbsp;can&nbsp;tell&nbsp;if&nbsp;this&nbsp;number&nbsp;is&nbsp;rising&nbsp;unexpectedly.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;An&nbsp;example&nbsp;where&nbsp;adapting&nbsp;to&nbsp;network&nbsp;bandwidth&nbsp;is&nbsp;needed&nbsp;is&nbsp;of&nbsp;course&lt;br&gt;<br>
&amp;gt;&nbsp;file&nbsp;uploading,&nbsp;but&nbsp;even&nbsp;if&nbsp;we&nbsp;dismiss&nbsp;it&nbsp;as&nbsp;a&nbsp;special&nbsp;case&nbsp;that&nbsp;can&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;served&nbsp;with&nbsp;custom&nbsp;code,&nbsp;there&amp;#39;s&nbsp;also&nbsp;e.g.&nbsp;captured&nbsp;video&nbsp;or&nbsp;audio&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;can&nbsp;be&nbsp;downgraded&nbsp;in&nbsp;quality&nbsp;for&nbsp;slow&nbsp;connections.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;We&nbsp;may&nbsp;have&nbsp;to&nbsp;do&nbsp;more&nbsp;complex&nbsp;things&nbsp;when&nbsp;we&nbsp;introduce&nbsp;files&nbsp;and&nbsp;streams,&lt;br&gt;<br>
but&nbsp;in&nbsp;practice&nbsp;I&nbsp;expect&nbsp;those&nbsp;to&nbsp;be&nbsp;a&nbsp;non-issue&nbsp;since&nbsp;the&nbsp;UA&nbsp;would&nbsp;take&lt;br&gt;<br>
care&nbsp;of&nbsp;them&nbsp;completely&nbsp;with&nbsp;just&nbsp;one&nbsp;send()&nbsp;call.&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;function&nbsp;upload(file)&nbsp;{&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp;websocket.send(file);&lt;br&gt;<br>
&nbsp; &nbsp;}&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp;websocket.startSendingStream(camera.stream);&lt;br&gt;<br>
&nbsp; &nbsp;...&lt;br&gt;<br>
&nbsp; &nbsp;websocket.stopSendingStream(camera.stream);&lt;br&gt;<br>
&lt;br&gt;<br>
...or&nbsp;something.&nbsp;Those&nbsp;are&nbsp;in&nbsp;fact&nbsp;far&nbsp;easier&nbsp;to&nbsp;deal&nbsp;with&nbsp;than&nbsp;just&lt;br&gt;<br>
continuous&nbsp;updates&nbsp;of&nbsp;the&nbsp;user&amp;#39;s&nbsp;progress&nbsp;in&nbsp;a&nbsp;game&nbsp;or&nbsp;some&nbsp;such.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Jeremy&nbsp;Orlow&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Maybe&nbsp;the&nbsp;right&nbsp;behavior&nbsp;is&nbsp;to&nbsp;buffer&nbsp;in&nbsp;user-space&nbsp;(like&nbsp;Maciej&lt;br&gt;<br>
&amp;gt;&nbsp;explained)&nbsp;up&nbsp;until&nbsp;a&nbsp;limit&nbsp;(left&nbsp;up&nbsp;to&nbsp;the&nbsp;UA)&nbsp;and&nbsp;then&nbsp;anything&nbsp;beyond&lt;br&gt;<br>
&amp;gt;&nbsp;that&nbsp;results&nbsp;in&nbsp;an&nbsp;exception.&nbsp; This&nbsp;seems&nbsp;like&nbsp;it&amp;#39;d&nbsp;handle&nbsp;bursty&lt;br&gt;<br>
&amp;gt;&nbsp;communication&nbsp;and&nbsp;would&nbsp;keep&nbsp;the&nbsp;failure&nbsp;model&nbsp;simple.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Running&nbsp;out&nbsp;of&nbsp;space&nbsp;is&nbsp;hitting&nbsp;a&nbsp;hardware&nbsp;limitation,&nbsp;at&nbsp;which&nbsp;point&nbsp;you&lt;br&gt;<br>
can&nbsp;do&nbsp;whatever&nbsp;you&nbsp;like&nbsp;(the&nbsp;spec&nbsp;doesn&amp;#39;t&nbsp;require&nbsp;any&nbsp;particular&lt;br&gt;<br>
behaviour&nbsp;in&nbsp;such&nbsp;scenarios,&nbsp;since&nbsp;what&nbsp;is&nbsp;possible&nbsp;depends&nbsp;on&nbsp;the&nbsp;UA).&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have,&nbsp;however,&nbsp;made&nbsp;the&nbsp;spec&nbsp;clear&nbsp;that&nbsp;if&nbsp;the&nbsp;send()&nbsp;fails&nbsp;somehow,&nbsp;the&lt;br&gt;<br>
connection&nbsp;must&nbsp;be&nbsp;closed.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Alexey&nbsp;Proskuryakov&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Having&nbsp;a&nbsp;send()&nbsp;that&nbsp;doesn&amp;#39;t&nbsp;return&nbsp;anything&nbsp;and&nbsp;doesn&amp;#39;t&nbsp;raise&lt;br&gt;<br>
&amp;gt;&nbsp;exceptions&nbsp;would&nbsp;be&nbsp;a&nbsp;clear&nbsp;signal&nbsp;that&nbsp;send()&nbsp;just&nbsp;blocks&nbsp;until&nbsp;it&amp;#39;s&lt;br&gt;<br>
&amp;gt;&nbsp;possible&nbsp;to&nbsp;send&nbsp;data&nbsp;to&nbsp;me,&nbsp;and&nbsp;I&amp;#39;m&nbsp;sure&nbsp;to&nbsp;many&nbsp;others,&nbsp;as&nbsp;well.&nbsp;There&lt;br&gt;<br>
&amp;gt;&nbsp;is&nbsp;no&nbsp;reason&nbsp;to&nbsp;silently&nbsp;drop&nbsp;data&nbsp;sent&nbsp;over&nbsp;a&nbsp;TCP&nbsp;connection&nbsp;-&nbsp;after&lt;br&gt;<br>
&amp;gt;&nbsp;all,&nbsp;we&nbsp;could&nbsp;as&nbsp;well&nbsp;base&nbsp;the&nbsp;protocol&nbsp;on&nbsp;UDP&nbsp;if&nbsp;we&nbsp;did,&nbsp;and&nbsp;lose&lt;br&gt;<br>
&amp;gt;&nbsp;nothing.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;think&nbsp;returning&nbsp;a&nbsp;boolean&nbsp;is&nbsp;more&nbsp;or&nbsp;less&nbsp;the&nbsp;same&nbsp;as&nbsp;&amp;quot;silently&lt;br&gt;<br>
dropping&amp;quot;&nbsp;in&nbsp;practice.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Drew&nbsp;Wilson&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;There&amp;#39;s&nbsp;another&nbsp;option&nbsp;besides&nbsp;blocking,&nbsp;raising&nbsp;an&nbsp;exception,&nbsp;and&lt;br&gt;<br>
&amp;gt;&nbsp;dropping&nbsp;data:&nbsp;unlimited&nbsp;buffering&nbsp;in&nbsp;user&nbsp;space.&nbsp;So&nbsp;I&amp;#39;m&nbsp;saying&nbsp;we&lt;br&gt;<br>
&amp;gt;&nbsp;should&nbsp;not&nbsp;put&nbsp;any&nbsp;limits&nbsp;on&nbsp;the&nbsp;amount&nbsp;of&nbsp;user-space&nbsp;buffering&nbsp;we&amp;#39;re&lt;br&gt;<br>
&amp;gt;&nbsp;willing&nbsp;to&nbsp;do,&nbsp;any&nbsp;more&nbsp;than&nbsp;we&nbsp;put&nbsp;any&nbsp;limits&nbsp;on&nbsp;the&nbsp;amount&nbsp;of&nbsp;other&lt;br&gt;<br>
&amp;gt;&nbsp;types&nbsp;of&nbsp;user-space&nbsp;memory&nbsp;allocation&nbsp;a&nbsp;page&nbsp;can&nbsp;perform.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Agreed.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Jeremy&nbsp;Orlow&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;agree&nbsp;with&nbsp;Alexey&nbsp;that&nbsp;applications&nbsp;need&nbsp;feedback&nbsp;when&nbsp;they&amp;#39;re&lt;br&gt;<br>
&amp;gt;&nbsp;consistentiently&nbsp;exceeding&nbsp;what&nbsp;your&nbsp;net&nbsp;connection&nbsp;can&nbsp;handle.&nbsp; I&nbsp;think&lt;br&gt;<br>
&amp;gt;&nbsp;an&nbsp;application&nbsp;getting&nbsp;an&nbsp;exception&nbsp;rather&nbsp;than&nbsp;filling&nbsp;up&nbsp;its&nbsp;buffer&lt;br&gt;<br>
&amp;gt;&nbsp;until&nbsp;it&nbsp;OOMs&nbsp;is&nbsp;a&nbsp;much&nbsp;better&nbsp;experience&nbsp;for&nbsp;the&nbsp;user&nbsp;and&nbsp;the&nbsp;web&lt;br&gt;<br>
&amp;gt;&nbsp;developer.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;True.&nbsp;the&nbsp;.bufferedAmount&nbsp;attribute&nbsp;will&nbsp;now&nbsp;allow&nbsp;this.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;you&nbsp;have&nbsp;application&nbsp;level&nbsp;ACKs&nbsp;(which&nbsp;you&nbsp;probably&lt;br&gt;<br>
&amp;gt;&nbsp;should--especially&nbsp;in&nbsp;high-throughput&nbsp;uses),&nbsp;you&nbsp;really&nbsp;shouldn&amp;#39;t&nbsp;even&lt;br&gt;<br>
&amp;gt;&nbsp;hit&nbsp;the&nbsp;buffer&nbsp;limits&nbsp;that&nbsp;a&nbsp;UA&nbsp;might&nbsp;have&nbsp;in&nbsp;place.&nbsp; I&nbsp;don&amp;#39;t&nbsp;really&lt;br&gt;<br>
&amp;gt;&nbsp;think&nbsp;that&nbsp;having&nbsp;a&nbsp;limit&nbsp;on&nbsp;the&nbsp;buffer&nbsp;size&nbsp;is&nbsp;a&nbsp;problem&nbsp;and&nbsp;that,&nbsp;if&lt;br&gt;<br>
&amp;gt;&nbsp;anything,&nbsp;it&amp;#39;ll&nbsp;promote&nbsp;better&nbsp;application&nbsp;level&nbsp;flow&nbsp;control.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Probably&nbsp;true&nbsp;also.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Drew&nbsp;Wilson&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;assuming&nbsp;that&nbsp;no&nbsp;actual&nbsp;limits&nbsp;would&nbsp;be&nbsp;specified&nbsp;in&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;specification,&nbsp;so&nbsp;it&nbsp;would&nbsp;be&nbsp;entirely&nbsp;up&nbsp;to&nbsp;a&nbsp;given&nbsp;UserAgent&nbsp;to&nbsp;decide&lt;br&gt;<br>
&amp;gt;&nbsp;how&nbsp;much&nbsp;buffering&nbsp;it&nbsp;is&nbsp;willing&nbsp;to&nbsp;provide.&nbsp;Doesn&amp;#39;t&nbsp;that&nbsp;imply&nbsp;that&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;well-behaved&nbsp;web&nbsp;application&nbsp;would&nbsp;be&nbsp;forced&nbsp;to&nbsp;check&nbsp;for&nbsp;exceptions&lt;br&gt;<br>
&amp;gt;&nbsp;from&nbsp;all&nbsp;send()&nbsp;invocations,&nbsp;since&nbsp;there&amp;#39;s&nbsp;no&nbsp;way&nbsp;to&nbsp;know&nbsp;a&nbsp;priori&lt;br&gt;<br>
&amp;gt;&nbsp;whether&nbsp;limits&nbsp;imposed&nbsp;by&nbsp;an&nbsp;application&nbsp;via&nbsp;its&nbsp;app-level&nbsp;protocol&lt;br&gt;<br>
&amp;gt;&nbsp;would&nbsp;be&nbsp;sufficient&nbsp;to&nbsp;stay&nbsp;under&nbsp;a&nbsp;given&nbsp;user-agent&amp;#39;s&nbsp;internal&nbsp;limits?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Without&nbsp;the&nbsp;recent&nbsp;changes,&nbsp;yes.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;Even&nbsp;worse,&nbsp;to&nbsp;be&nbsp;broadly&nbsp;deployable&nbsp;the&nbsp;app-level&nbsp;protocol&nbsp;would&nbsp;have&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;enforce&nbsp;the&nbsp;lowest-common-denominator&nbsp;buffering&nbsp;limit,&nbsp;which&nbsp;would&lt;br&gt;<br>
&amp;gt;&nbsp;inhibit&nbsp;throughput&nbsp;on&nbsp;platforms&nbsp;that&nbsp;support&nbsp;higher&nbsp;buffers.&nbsp;In&lt;br&gt;<br>
&amp;gt;&nbsp;practice,&nbsp;I&nbsp;suspect&nbsp;most&nbsp;implementations&nbsp;would&nbsp;adopt&nbsp;a&nbsp;&amp;quot;just&nbsp;blast&nbsp;out&lt;br&gt;<br>
&amp;gt;&nbsp;as&nbsp;much&nbsp;data&nbsp;as&nbsp;possible&nbsp;until&nbsp;the&nbsp;system&nbsp;throws&nbsp;an&nbsp;exception,&nbsp;then&nbsp;set&lt;br&gt;<br>
&amp;gt;&nbsp;a&nbsp;timer&nbsp;to&nbsp;retry&nbsp;the&nbsp;send&nbsp;in&nbsp;100ms&amp;quot;&nbsp;approach.&nbsp;But&nbsp;perhaps&nbsp;that&amp;#39;s&nbsp;your&lt;br&gt;<br>
&amp;gt;&nbsp;intention?&nbsp;If&nbsp;so,&nbsp;then&nbsp;I&amp;#39;d&nbsp;suggest&nbsp;changing&nbsp;the&nbsp;API&nbsp;to&nbsp;just&nbsp;have&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;quot;canWrite&amp;quot;&nbsp;notification&nbsp;like&nbsp;other&nbsp;async&nbsp;socket&nbsp;APIs&nbsp;provide&nbsp;(or&lt;br&gt;<br>
&amp;gt;&nbsp;something&nbsp;similar)&nbsp;to&nbsp;avoid&nbsp;the&nbsp;clunky&nbsp;catch-and-retry&nbsp;idiom.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;The&nbsp;attribute&nbsp;now&nbsp;lets&nbsp;you&nbsp;just&nbsp;wait&nbsp;until&nbsp;the&nbsp;buffer&nbsp;is&nbsp;empty,&nbsp;which&nbsp;is&lt;br&gt;<br>
more&nbsp;or&nbsp;less&nbsp;equivalent,&nbsp;I&nbsp;think.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Do&nbsp;we&nbsp;need&nbsp;to&nbsp;check&nbsp;bufferedAmount&nbsp;periodically&nbsp;by&nbsp;setTimeout?&lt;br&gt;<br>
How&nbsp;about&nbsp;firing&nbsp;some&nbsp;event&nbsp;when&nbsp;buffer&nbsp;is&nbsp;empty?&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Maciej&nbsp;Stachowiak&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;think&nbsp;even&nbsp;unlimited&nbsp;buffering&nbsp;needs&nbsp;to&nbsp;be&nbsp;combined&nbsp;with&nbsp;at&nbsp;least&nbsp;a&lt;br&gt;<br>
&amp;gt;&nbsp;hint&nbsp;to&nbsp;the&nbsp;WebSocket&nbsp;client&nbsp;to&nbsp;back&nbsp;off&nbsp;the&nbsp;send&nbsp;rate,&nbsp;because&nbsp;it&amp;#39;s&lt;br&gt;<br>
&amp;gt;&nbsp;possible&nbsp;to&nbsp;send&nbsp;so&nbsp;much&nbsp;data&nbsp;that&nbsp;it&nbsp;exceeds&nbsp;the&nbsp;available&nbsp;address&lt;br&gt;<br>
&amp;gt;&nbsp;space,&nbsp;for&nbsp;example&nbsp;when&nbsp;uploading&nbsp;a&nbsp;very&nbsp;large&nbsp;file&nbsp;piece&nbsp;by&nbsp;piece,&nbsp;or&lt;br&gt;<br>
&amp;gt;&nbsp;when&nbsp;sending&nbsp;a&nbsp;live&nbsp;media&nbsp;stream&nbsp;that&nbsp;requires&nbsp;more&nbsp;bandwidth&nbsp;than&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;connection&nbsp;can&nbsp;deliver.&nbsp;In&nbsp;the&nbsp;first&nbsp;case,&nbsp;it&nbsp;is&nbsp;possible,&nbsp;though&nbsp;highly&lt;br&gt;<br>
&amp;gt;&nbsp;undesirable,&nbsp;to&nbsp;spool&nbsp;the&nbsp;data&nbsp;to&nbsp;be&nbsp;sent&nbsp;to&nbsp;disk;&nbsp;in&nbsp;the&nbsp;latter&nbsp;case,&lt;br&gt;<br>
&amp;gt;&nbsp;doing&nbsp;that&nbsp;would&nbsp;just&nbsp;inevitably&nbsp;fill&nbsp;the&nbsp;disk.&nbsp;Obviously&nbsp;we&nbsp;need&nbsp;more&lt;br&gt;<br>
&amp;gt;&nbsp;web&nbsp;platform&nbsp;capabilities&nbsp;to&nbsp;make&nbsp;such&nbsp;use&nbsp;cases&nbsp;a&nbsp;reality,&nbsp;but&nbsp;they&nbsp;are&lt;br&gt;<br>
&amp;gt;&nbsp;foreseeable&nbsp;and&nbsp;we&nbsp;should&nbsp;deal&nbsp;with&nbsp;them&nbsp;in&nbsp;some&nbsp;reasonable&nbsp;way.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Both&nbsp;the&nbsp;lice&nbsp;stream&nbsp;and&nbsp;the&nbsp;file&nbsp;case&nbsp;are&nbsp;actually&nbsp;far&nbsp;easier&nbsp;for&nbsp;us&nbsp;to&lt;br&gt;<br>
deal&nbsp;with,&nbsp;as&nbsp;noted&nbsp;above,&nbsp;than&nbsp;just&nbsp;lots&nbsp;of&nbsp;generated&nbsp;text&nbsp;data.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Tue,&nbsp;28&nbsp;Jul&nbsp;2009,&nbsp;Robert&nbsp;O&amp;#39;Callahan&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Why&nbsp;not&nbsp;just&nbsp;allow&nbsp;unlimited&nbsp;buffering,&nbsp;but&nbsp;also&nbsp;provide&nbsp;an&nbsp;API&nbsp;to&nbsp;query&lt;br&gt;<br>
&amp;gt;&nbsp;how&nbsp;much&nbsp;data&nbsp;is&nbsp;currently&nbsp;buffered&nbsp;(approximate&nbsp;only,&nbsp;so&nbsp;it&nbsp;would&nbsp;be&nbsp;OK&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;just&nbsp;return&nbsp;the&nbsp;size&nbsp;of&nbsp;data&nbsp;buffered&nbsp;in&nbsp;user&nbsp;space)?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Then&nbsp;applications&nbsp;that&nbsp;care&nbsp;and&nbsp;can&nbsp;adapt&nbsp;can&nbsp;do&nbsp;so.&nbsp;But&nbsp;most&lt;br&gt;<br>
&amp;gt;&nbsp;applications&nbsp;will&nbsp;not&nbsp;need&nbsp;to.&nbsp;The&nbsp;problem&nbsp;of&nbsp;partial&nbsp;writes&nbsp;being&lt;br&gt;<br>
&amp;gt;&nbsp;incorrectly&nbsp;handled&nbsp;is&nbsp;pernicious&nbsp;and&nbsp;I&nbsp;definitely&nbsp;think&nbsp;partial&nbsp;writes&lt;br&gt;<br>
&amp;gt;&nbsp;should&nbsp;not&nbsp;be&nbsp;exposed&nbsp;to&nbsp;applications.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;That&amp;#39;s&nbsp;what&nbsp;I&amp;#39;ve&nbsp;done.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Michael&nbsp;Nordman&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;proposed&nbsp;websocket&nbsp;interface&nbsp;is&nbsp;too&nbsp;dumbed&nbsp;down.&nbsp;The&nbsp;caller&nbsp;doesn&amp;#39;t&lt;br&gt;<br>
&amp;gt;&nbsp;know&nbsp;what&nbsp;the&nbsp;impl&nbsp;is&nbsp;doing,&nbsp;and&nbsp;the&nbsp;impl&nbsp;doesn&amp;#39;t&nbsp;know&nbsp;what&nbsp;the&nbsp;caller&lt;br&gt;<br>
&amp;gt;&nbsp;is&nbsp;trying&nbsp;to&nbsp;do.&nbsp;As&nbsp;a&nbsp;consequence,&nbsp;there&nbsp;is&nbsp;no&nbsp;&amp;quot;reasonable&amp;quot;&nbsp;action&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;either&nbsp;can&nbsp;take&nbsp;when&nbsp;buffers&nbsp;start&nbsp;overflowing.&nbsp;Typically,&nbsp;the&nbsp;network&lt;br&gt;<br>
&amp;gt;&nbsp;layer&nbsp;provides&nbsp;sufficient&nbsp;status&nbsp;info&nbsp;to&nbsp;its&nbsp;caller&nbsp;that,&nbsp;allowing&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;higher&nbsp;level&nbsp;code&nbsp;to&nbsp;do&nbsp;something&nbsp;reasonable&nbsp;in&nbsp;light&nbsp;of&nbsp;how&nbsp;the&nbsp;network&lt;br&gt;<br>
&amp;gt;&nbsp;layer&nbsp;is&nbsp;performing.&nbsp;That&nbsp;kind&nbsp;of&nbsp;status&nbsp;info&nbsp;is&nbsp;simply&nbsp;missing&nbsp;from&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;websocket&nbsp;interface.&nbsp;I&nbsp;think&nbsp;its&nbsp;possible&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;interface&lt;br&gt;<br>
&amp;gt;&nbsp;features&nbsp;that&nbsp;would&nbsp;facilitate&nbsp;more&nbsp;demanding&nbsp;uses&nbsp;cases&nbsp;without&lt;br&gt;<br>
&amp;gt;&nbsp;complicating&nbsp;the&nbsp;simple&nbsp;use&nbsp;cases.&nbsp;I&nbsp;think&nbsp;that&nbsp;would&nbsp;be&nbsp;an&nbsp;excellent&lt;br&gt;<br>
&amp;gt;&nbsp;goal&nbsp;for&nbsp;this&nbsp;API.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Do&nbsp;the&nbsp;minimal&nbsp;new&nbsp;additions&nbsp;address&nbsp;this&nbsp;to&nbsp;your&nbsp;satisfaction?&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;27&nbsp;Jul&nbsp;2009,&nbsp;Drew&nbsp;Wilson&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;would&nbsp;suggest&nbsp;that&nbsp;the&nbsp;solution&nbsp;to&nbsp;this&nbsp;situation&nbsp;is&nbsp;an&nbsp;appropriate&lt;br&gt;<br>
&amp;gt;&nbsp;application-level&nbsp;protocol&nbsp;(i.e.&nbsp;acks)&nbsp;to&nbsp;allow&nbsp;the&nbsp;application&nbsp;to&nbsp;have&lt;br&gt;<br>
&amp;gt;&nbsp;no&nbsp;more&nbsp;than&nbsp;(say)&nbsp;1MB&nbsp;of&nbsp;data&nbsp;outstanding.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;just&nbsp;afraid&nbsp;that&nbsp;we&amp;#39;re&nbsp;burdening&nbsp;the&nbsp;API&nbsp;to&nbsp;handle&nbsp;degenerative&lt;br&gt;<br>
&amp;gt;&nbsp;cases&nbsp;that&nbsp;the&nbsp;vast&nbsp;majority&nbsp;of&nbsp;users&nbsp;won&amp;#39;t&nbsp;encounter.&nbsp;Specifying&nbsp;in&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;API&nbsp;that&nbsp;any&nbsp;arbitrary&nbsp;send()&nbsp;invocation&nbsp;could&nbsp;throw&nbsp;some&nbsp;kind&nbsp;of&nbsp;&amp;quot;retry&lt;br&gt;<br>
&amp;gt;&nbsp;exception&amp;quot;&nbsp;or&nbsp;return&nbsp;some&nbsp;kind&nbsp;of&nbsp;error&nbsp;code&nbsp;is&nbsp;really&nbsp;really&lt;br&gt;<br>
&amp;gt;&nbsp;cumbersome.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;agree&nbsp;that&nbsp;we&nbsp;aren&amp;#39;t&nbsp;talking&nbsp;about&nbsp;a&nbsp;particularly&nbsp;common&nbsp;case.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
&lt;/font&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;Ian&nbsp;Hickson&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;U+1047E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )\._.,--....,&amp;#39;``.&nbsp; &nbsp; fL&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://ln.hixie.ch/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://ln.hixie.ch/&lt;/a&gt;&nbsp; &nbsp; &nbsp; &nbsp;U+263A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /,&nbsp; &nbsp;_..&nbsp;\&nbsp; &nbsp;_\&nbsp; ;`._&nbsp;,.&lt;br&gt;<br>
Things&nbsp;that&nbsp;are&nbsp;impossible&nbsp;just&nbsp;take&nbsp;longer.&nbsp; &nbsp;`._.-(,_..&amp;#39;--(,_..&amp;#39;`-.;.&amp;#39;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
