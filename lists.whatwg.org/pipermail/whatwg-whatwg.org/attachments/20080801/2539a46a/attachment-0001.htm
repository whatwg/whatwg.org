<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;an&nbsp;implementor&nbsp;of&nbsp;BOSH&nbsp;and&nbsp;interested&nbsp;in&nbsp;WebSockets&nbsp;as&nbsp;future&nbsp;option&nbsp;for&nbsp;browser&nbsp;based&nbsp;XMPP&nbsp;connections.&nbsp;I&nbsp;think&nbsp;a&nbsp;useful&nbsp;feature&nbsp;of&nbsp;BOSH&nbsp;is&nbsp;the&nbsp;ability&nbsp;to&nbsp;send&nbsp;a&nbsp;pause&nbsp;request&nbsp;to&nbsp;the&nbsp;server,&nbsp;which&nbsp;effectively&nbsp;increases&nbsp;the&nbsp;amount&nbsp;of&nbsp;time&nbsp;that&nbsp;can&nbsp;elapse&nbsp;before&nbsp;it&nbsp;considers&nbsp;a&nbsp;client&nbsp;timed&nbsp;out;&nbsp;a&nbsp;client&nbsp;then&nbsp;resumes&nbsp;by&nbsp;making&nbsp;a&nbsp;normal&nbsp;request&nbsp;with&nbsp;the&nbsp;same&nbsp;session&nbsp;ID&nbsp;and&nbsp;the&nbsp;request&nbsp;ID&nbsp;incremented&nbsp;as&nbsp;usual.&nbsp;This&nbsp;is&nbsp;useful/needed&nbsp;because&nbsp;BOSH&nbsp;is&nbsp;a&nbsp;sequenced&nbsp;protocol.&nbsp;Importantly,&nbsp;it&nbsp;enables&nbsp;a&nbsp;use&nbsp;case&nbsp;of&nbsp;maintaining&nbsp;a&nbsp;&#39;persistent&#39;&nbsp;connection&nbsp;between&nbsp;page&nbsp;loads.&lt;br&gt;<br>
&lt;br&gt;Is&nbsp;there&nbsp;any&nbsp;equivalent&nbsp;mechanism&nbsp;in&nbsp;WebSockets&nbsp;to&nbsp;produce&nbsp;a&nbsp;&#39;persistent&#39;&nbsp;connection&nbsp;between&nbsp;page&nbsp;loads?&nbsp;Combined&nbsp;with&nbsp;sessionStorage&nbsp;this&nbsp;would&nbsp;be&nbsp;very&nbsp;useful&nbsp;for&nbsp;an&nbsp;application&nbsp;such&nbsp;as&nbsp;Facebook&nbsp;Chat.&lt;br&gt;&lt;br&gt;<br>
My&nbsp;thought&nbsp;is&nbsp;something&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;margin-left:&nbsp;40px;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;window.addEventListener(&nbsp;&quot;load&quot;,&nbsp;function()&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&nbsp;&nbsp;if(&nbsp;sessionStorage.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;resumeToken&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;!=&nbsp;undefined&nbsp;)&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;this&nbsp;part&nbsp;is&nbsp;sketchy...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;con&nbsp;=&nbsp;new&nbsp;WebSocket(&nbsp;sessionStorage.resumeToken&nbsp;);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch(e)&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;too&nbsp;much&nbsp;time&nbsp;elapsed,&nbsp;invalid&nbsp;token&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;con&nbsp;=&nbsp;new&nbsp;WebSocket(&nbsp;&quot;ws://...&quot;&nbsp;);&lt;/span&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;&nbsp;}&nbsp;else&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;con&nbsp;=&nbsp;new&nbsp;WebSocket(&nbsp;&quot;ws://...&quot;&nbsp;);&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;&nbsp;}&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
},&nbsp;false&nbsp;);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;window.addEventListener(&nbsp;&quot;unload&quot;,&nbsp;function()&nbsp;{&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;//&nbsp;timeout&nbsp;could&nbsp;be&nbsp;defined&nbsp;by&nbsp;UA,&nbsp;and&nbsp;connection&nbsp;closes&nbsp;after&nbsp;that&nbsp;time&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;&nbsp;sessionStorage.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;resumeToken&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&nbsp;=&nbsp;con.pause();&nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;},&nbsp;false&nbsp;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;Personally&nbsp;I&#39;m&nbsp;not&nbsp;a&nbsp;fan&nbsp;of&nbsp;the&nbsp;WebSocket&nbsp;constructor&nbsp;initiating&nbsp;the&nbsp;connection&nbsp;immediately,&nbsp;but&nbsp;I&#39;m&nbsp;sure&nbsp;there&nbsp;are&nbsp;reasons&nbsp;for&nbsp;it&nbsp;being&nbsp;like&nbsp;that.&nbsp;My&nbsp;preference&nbsp;would&nbsp;be&nbsp;to&nbsp;have&nbsp;connect&nbsp;and&nbsp;resume&nbsp;methods&nbsp;to&nbsp;complement&nbsp;disconnect&nbsp;and&nbsp;pause,&nbsp;respectively.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;haven&#39;t&nbsp;thought&nbsp;through&nbsp;security&nbsp;implications&nbsp;of&nbsp;this&nbsp;sort&nbsp;of&nbsp;mechanism,&nbsp;but&nbsp;at&nbsp;the&nbsp;very&nbsp;least&nbsp;it&nbsp;seems&nbsp;safe&nbsp;if&nbsp;tokens&nbsp;can&nbsp;only&nbsp;be&nbsp;used&nbsp;within&nbsp;the&nbsp;same&nbsp;origin.&lt;br&gt;&lt;br&gt;Best,&lt;br&gt;&lt;br&gt;Harlan&lt;br&gt;&lt;/div&gt;<br>

</tt>
