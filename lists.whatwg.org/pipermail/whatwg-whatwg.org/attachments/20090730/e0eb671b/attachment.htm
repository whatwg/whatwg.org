<tt>
&lt;html&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;Sebastian,&lt;div&gt;The&nbsp;same-origin&nbsp;is&nbsp;pretty&nbsp;clearly&nbsp;specified,&nbsp;I've&nbsp;included&nbsp;the&nbsp;excerpt&nbsp;from&nbsp;the&nbsp;spec&nbsp;below.&nbsp;Your&nbsp;suggestion&nbsp;for&nbsp;clarity&nbsp;on&nbsp;updating&nbsp;Location&nbsp;fields&nbsp;in&nbsp;the&nbsp;the&nbsp;UI&nbsp;would&nbsp;be&nbsp;a&nbsp;part&nbsp;of&nbsp;step&nbsp;five&nbsp;in&nbsp;the&nbsp;description&nbsp;of&nbsp;pushState&nbsp;in&nbsp;section&nbsp;6.10.2&nbsp;is&nbsp;a&nbsp;good&nbsp;one.&amp;nbsp;Ian,&nbsp;I&nbsp;feel&nbsp;like&nbsp;this&nbsp;counts&nbsp;as&nbsp;a&nbsp;possible&nbsp;action&nbsp;item.&lt;/div&gt;&lt;div&gt;Nathan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;***&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Possible&nbsp;Action&nbsp;Items&lt;/div&gt;&lt;div&gt;1.&nbsp;Clarify&nbsp;how&nbsp;the&nbsp;user&nbsp;agent&nbsp;uses&nbsp;the&nbsp;calculated&nbsp;location&nbsp;value&nbsp;from&nbsp;the&nbsp;pushState&nbsp;description&nbsp;step&nbsp;2&nbsp;in&nbsp;section&nbsp;6.10.2&nbsp;in&nbsp;terms&nbsp;of&nbsp;being&nbsp;reflected&nbsp;in&nbsp;the&nbsp;Location&nbsp;object.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;is&nbsp;my&nbsp;opinion&nbsp;that&nbsp;this&nbsp;URL&nbsp;should&nbsp;be&nbsp;reflected&nbsp;in&nbsp;the&nbsp;Location&nbsp;value.&nbsp;This&nbsp;would&nbsp;imply&nbsp;that&nbsp;it&nbsp;would&nbsp;be&nbsp;reflected&nbsp;in&nbsp;the&nbsp;location&nbsp;bar&nbsp;of&nbsp;user&nbsp;agents&nbsp;that&nbsp;have&nbsp;this&nbsp;as&nbsp;part&nbsp;of&nbsp;their&nbsp;UI.&nbsp;It&nbsp;seems&nbsp;that&nbsp;the&nbsp;place&nbsp;to&nbsp;include&nbsp;this&nbsp;clarification&nbsp;would&nbsp;be&amp;nbsp;the&nbsp;pushState&nbsp;description&nbsp;step&nbsp;5&nbsp;in&nbsp;section&nbsp;6.10.2&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2.&nbsp;Clarify&nbsp;that&nbsp;pushState()&nbsp;does&nbsp;not&nbsp;cause&nbsp;navigation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;read&nbsp;the&nbsp;spec&nbsp;quite&nbsp;a&nbsp;few&nbsp;times&nbsp;and&nbsp;still&nbsp;got&nbsp;this&nbsp;wrong,&nbsp;apparently.&nbsp;Making&nbsp;this&nbsp;completely&nbsp;clear&nbsp;would&nbsp;not&nbsp;hurt.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;***&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;a&nbsp;third&nbsp;argument&nbsp;is&nbsp;specified,&nbsp;run&nbsp;these&nbsp;substeps:&lt;/div&gt;&lt;div&gt;&lt;div&gt;&nbsp;&lt;div&gt;1.&nbsp;Resolve&nbsp;the&nbsp;value&nbsp;of&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;third&nbsp;argument,&nbsp;relative&nbsp;to&nbsp;the&nbsp;first&nbsp;script's&nbsp;base&nbsp;URL.&lt;/div&gt;&nbsp;&lt;div&gt;2.&nbsp;If&nbsp;that&nbsp;fails,&nbsp;raise&nbsp;a&nbsp;SECURITY_ERR&nbsp;exception&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abort&nbsp;the&nbsp;pushState()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;steps.&lt;/div&gt;&nbsp;&lt;div&gt;3.&nbsp;Compare&nbsp;the&nbsp;resulting&nbsp;absolute&nbsp;URL&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document's&nbsp;address.&nbsp;If&nbsp;any&nbsp;part&nbsp;of&nbsp;these&nbsp;two&nbsp;URLs&nbsp;differ&nbsp;other&nbsp;than&nbsp;the&nbsp;&amp;lt;path&gt;,&nbsp;&amp;lt;query&gt;,&nbsp;and&nbsp;&amp;lt;fragment&gt;&nbsp;components,&nbsp;then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;a&nbsp;SECURITY_ERR&nbsp;exception&nbsp;and&nbsp;abort&nbsp;the&nbsp;pushState()&nbsp;steps.&lt;/div&gt;&lt;p&nbsp;align=&quot;&quot;&gt;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;the&nbsp;comparison&nbsp;in&nbsp;the&nbsp;above&nbsp;substeps,&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;path&gt;&nbsp;and&nbsp;&amp;lt;query&gt;&nbsp;components&nbsp;can&nbsp;only&nbsp;be&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;same&nbsp;if&nbsp;the&nbsp;URLs&nbsp;use&nbsp;a&nbsp;hierarchical&nbsp;&amp;lt;scheme&gt;.&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Jul&nbsp;30,&nbsp;2009,&nbsp;at&nbsp;10:27&nbsp;AM,&nbsp;Sebastian&nbsp;Markbåge&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;Jonas,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;is&nbsp;my&nbsp;interpretation&nbsp;too.&nbsp;But&nbsp;I&nbsp;think&nbsp;it's&nbsp;a&nbsp;little&nbsp;unclear&nbsp;whether&nbsp;that&nbsp;means&nbsp;that&nbsp;the&nbsp;UA&nbsp;should&nbsp;update&nbsp;any&nbsp;Location&nbsp;fields&nbsp;in&nbsp;the&nbsp;UI.&nbsp;I&nbsp;understand&nbsp;that&nbsp;this&nbsp;may&nbsp;be&nbsp;optional&nbsp;or&nbsp;outside&nbsp;the&nbsp;scope,&nbsp;but&nbsp;I&nbsp;think&nbsp;that&nbsp;it&nbsp;should&nbsp;still&nbsp;be&nbsp;mentioned.&lt;/div&gt;&nbsp;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now&nbsp;if&nbsp;the&nbsp;UA&nbsp;is&nbsp;suppose&nbsp;to&nbsp;update&nbsp;the&nbsp;Location&nbsp;field,&nbsp;shouldn't&nbsp;push&nbsp;state&nbsp;URL&nbsp;be&nbsp;subject&nbsp;to&nbsp;same-domain&nbsp;policies?&nbsp;Is&nbsp;that&nbsp;defined&nbsp;clearly?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Otherwise,&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;during&nbsp;phishing&nbsp;attacks.&lt;/div&gt;&nbsp;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sebastian&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Jul&nbsp;30,&nbsp;2009&nbsp;at&nbsp;4:13&nbsp;PM,&nbsp;Nathan&nbsp;Hammond&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:nathan@nathanhammond.com&quot;&gt;nathan@nathanhammond.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&nbsp;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;Hey&nbsp;Jonas&nbsp;et&nbsp;al.:&lt;br&gt;&nbsp;Thanks&nbsp;for&nbsp;the&nbsp;reply,&nbsp;forgive&nbsp;my&nbsp;disbelief&nbsp;on&nbsp;Clarification&nbsp;1.&nbsp;:)&nbsp;If&nbsp;I'm&nbsp;completely&nbsp;with&nbsp;you,&nbsp;that&nbsp;is&nbsp;entirely&nbsp;unexpected&nbsp;on&nbsp;my&nbsp;part&nbsp;(and&nbsp;I've&nbsp;read&nbsp;this&nbsp;part&nbsp;of&nbsp;the&nbsp;spec&nbsp;a&nbsp;few&nbsp;times).&nbsp;Is&nbsp;this&nbsp;to&nbsp;imply&nbsp;that,&nbsp;no&nbsp;matter&nbsp;what&nbsp;the&nbsp;arguments&nbsp;to&nbsp;pushState(),&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;URL&nbsp;there&nbsp;will&nbsp;be&nbsp;no&nbsp;request&nbsp;for&nbsp;a&nbsp;new&nbsp;document&nbsp;and&nbsp;no&nbsp;user-agent&nbsp;initiated&nbsp;network&nbsp;activity?&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;This&nbsp;is&nbsp;a&nbsp;behavior&nbsp;I'm&nbsp;fine&nbsp;with&nbsp;and&nbsp;will&nbsp;meet&nbsp;my&nbsp;needs&nbsp;just&nbsp;as&nbsp;well,&nbsp;I&nbsp;was&nbsp;simply&nbsp;expecting&nbsp;to&nbsp;have&nbsp;to&nbsp;use&nbsp;the&nbsp;approach&nbsp;from&nbsp;Clarification&nbsp;2&nbsp;in&nbsp;order&nbsp;to&nbsp;retain&nbsp;my&nbsp;document&nbsp;object.&nbsp;It&nbsp;does&nbsp;however&nbsp;lend&nbsp;itself&nbsp;to&nbsp;some&nbsp;confusion&nbsp;when&nbsp;paired&nbsp;with&nbsp;user&nbsp;agents&nbsp;that&nbsp;don't&nbsp;yet&nbsp;support&nbsp;the&nbsp;history&nbsp;portions&nbsp;of&nbsp;the&nbsp;spec&nbsp;as&nbsp;they&nbsp;will&nbsp;have&nbsp;to&nbsp;be&nbsp;handled&nbsp;with&nbsp;hash-based&nbsp;addressing&nbsp;while&nbsp;those&nbsp;that&nbsp;support&nbsp;pushState()&nbsp;will&nbsp;have&nbsp;more&nbsp;sane&nbsp;URLs--but&nbsp;that&nbsp;is&nbsp;no&nbsp;matter&nbsp;in&nbsp;the&nbsp;grand&nbsp;scheme&nbsp;of&nbsp;things.&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;Also,&nbsp;that&nbsp;would&nbsp;imply&nbsp;that&nbsp;the&nbsp;popstate&nbsp;only&nbsp;fires&nbsp;when&nbsp;you're&nbsp;navigating&nbsp;through&nbsp;history.&nbsp;Is&nbsp;that&nbsp;correct?&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;Thanks!&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&nbsp;Nathan&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;On&nbsp;Jul&nbsp;30,&nbsp;2009,&nbsp;at&nbsp;4:42&nbsp;AM,&nbsp;Jonas&nbsp;Sicking&nbsp;wrote:&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&nbsp;On&nbsp;Wed,&nbsp;Jul&nbsp;29,&nbsp;2009&nbsp;at&nbsp;7:38&nbsp;PM,&nbsp;Nathan&nbsp;Hammond&amp;lt;&lt;a&nbsp;href=&quot;mailto:nathan@nathanhammond.com&quot;&nbsp;target=&quot;_blank&quot;&gt;nathan@nathanhammond.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&nbsp;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&nbsp;Clarifications&lt;br&gt;&nbsp;1.&nbsp;window.history.pushState({},&nbsp;&quot;Title&quot;,&lt;br&gt;&nbsp;&quot;/path/to/new/file.html?s=newvalue#newhash&quot;)&nbsp;replaces&nbsp;the&nbsp;current&nbsp;document&lt;br&gt;&nbsp;object&nbsp;with&nbsp;the&nbsp;one&nbsp;specified&nbsp;by&nbsp;the&nbsp;new&nbsp;URL.&nbsp;It&nbsp;then&nbsp;causes&nbsp;the&nbsp;event&lt;br&gt;&nbsp;popstate&nbsp;to&nbsp;fire&nbsp;immediately&nbsp;after&nbsp;the&nbsp;load&nbsp;event,&nbsp;correct?&lt;br&gt;&nbsp;&lt;/blockquote&gt;&nbsp;&lt;br&gt;&nbsp;No.&nbsp;The&nbsp;above&nbsp;line&nbsp;with&nbsp;change&nbsp;the&nbsp;uri&nbsp;of&nbsp;the&nbsp;existing&nbsp;document&nbsp;to&nbsp;be&lt;br&gt;&nbsp;&quot;&lt;a&nbsp;href=&quot;http://example.com/path/to/new/file.html?s=newvalue#newhash&quot;&nbsp;target=&quot;_blank&quot;&gt;http://example.com/path/to/new/file.html?s=newvalue#newhash&lt;/a&gt;&quot;&nbsp;(with&lt;br&gt;&nbsp;the&nbsp;part&nbsp;before&nbsp;'path'&nbsp;obviously&nbsp;depending&nbsp;on&nbsp;where&nbsp;the&nbsp;original&nbsp;page&lt;br&gt;&nbsp;lives).&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;So&nbsp;no&nbsp;network&nbsp;activity&nbsp;takes&nbsp;place&nbsp;and&nbsp;the&nbsp;Document&nbsp;node&nbsp;remains&nbsp;the&lt;br&gt;&nbsp;same.&nbsp;Also&nbsp;no&nbsp;popstate&nbsp;event&nbsp;is&nbsp;fired.&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&nbsp;2.&nbsp;window.history.pushState({},&nbsp;&quot;Title&quot;,&nbsp;&quot;#newhash&quot;)&nbsp;creates&nbsp;a&nbsp;new&nbsp;history&lt;br&gt;&nbsp;state&nbsp;object&nbsp;with&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,&nbsp;the&nbsp;specified&nbsp;title,&nbsp;the&nbsp;same&lt;br&gt;&nbsp;document&nbsp;object,&nbsp;and&nbsp;a&nbsp;location&nbsp;object&nbsp;that&nbsp;replaces&nbsp;the&nbsp;existing&nbsp;hash&nbsp;with&lt;br&gt;&nbsp;&quot;#newhash&quot;,&nbsp;correct?&lt;br&gt;&nbsp;&lt;/blockquote&gt;&nbsp;&lt;br&gt;&nbsp;Yes.&lt;br&gt;&nbsp;&lt;br&gt;&nbsp;/&nbsp;Jonas&lt;br&gt;&nbsp;&lt;/blockquote&gt;&nbsp;&lt;br&gt;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
