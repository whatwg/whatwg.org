<tt>
Sorry,&nbsp;same&nbsp;domain&nbsp;policy&nbsp;is&nbsp;clearly&nbsp;defined.&nbsp;I&nbsp;just&nbsp;missed&nbsp;it.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0.8ex;&nbsp;border-left-width:&nbsp;1px;&nbsp;border-left-color:&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;border-left-style:&nbsp;solid;&nbsp;padding-left:&nbsp;1ex;&nbsp;&quot;&gt;<br>
Compare&nbsp;the&nbsp;resulting&nbsp;absolute&nbsp;URL&nbsp;to&nbsp;the&nbsp;document&amp;#39;s&nbsp;address.&nbsp;If&nbsp;any&nbsp;part&nbsp;of&nbsp;these&nbsp;two&nbsp;URLs&nbsp;differ&nbsp;other&nbsp;than&nbsp;the&nbsp;&amp;lt;path&amp;gt;,&nbsp;&amp;lt;query&amp;gt;,&nbsp;and&nbsp;&amp;lt;fragment&amp;gt;&nbsp;components,&nbsp;then&nbsp;raise&nbsp;a&nbsp;SECURITY_ERR&nbsp;exception&nbsp;and&nbsp;abort&nbsp;the&nbsp;pushState()&nbsp;steps.&lt;/blockquote&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Jul&nbsp;30,&nbsp;2009&nbsp;at&nbsp;4:27&nbsp;PM,&nbsp;Sebastian&nbsp;Markbåge&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;sebastian@calyptus.eu&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;div&gt;Jonas,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;is&nbsp;my&nbsp;interpretation&nbsp;too.&nbsp;But&nbsp;I&nbsp;think&nbsp;it&amp;#39;s&nbsp;a&nbsp;little&nbsp;unclear&nbsp;whether&nbsp;that&nbsp;means&nbsp;that&nbsp;the&nbsp;UA&nbsp;should&nbsp;update&nbsp;any&nbsp;Location&nbsp;fields&nbsp;in&nbsp;the&nbsp;UI.&nbsp;I&nbsp;understand&nbsp;that&nbsp;this&nbsp;may&nbsp;be&nbsp;optional&nbsp;or&nbsp;outside&nbsp;the&nbsp;scope,&nbsp;but&nbsp;I&nbsp;think&nbsp;that&nbsp;it&nbsp;should&nbsp;still&nbsp;be&nbsp;mentioned.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Now&nbsp;if&nbsp;the&nbsp;UA&nbsp;is&nbsp;suppose&nbsp;to&nbsp;update&nbsp;the&nbsp;Location&nbsp;field,&nbsp;shouldn&amp;#39;t&nbsp;push&nbsp;state&nbsp;URL&nbsp;be&nbsp;subject&nbsp;to&nbsp;same-domain&nbsp;policies?&nbsp;Is&nbsp;that&nbsp;defined&nbsp;clearly?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Otherwise,&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;during&nbsp;phishing&nbsp;attacks.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;div&gt;Sebastian&lt;/div&gt;&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Jul&nbsp;30,&nbsp;2009&nbsp;at&nbsp;4:13&nbsp;PM,&nbsp;Nathan&nbsp;Hammond&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:nathan@nathanhammond.com&quot;&nbsp;target=&quot;_blank&quot;&gt;nathan@nathanhammond.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hey&nbsp;Jonas&nbsp;et&nbsp;al.:&lt;br&gt;<br>
Thanks&nbsp;for&nbsp;the&nbsp;reply,&nbsp;forgive&nbsp;my&nbsp;disbelief&nbsp;on&nbsp;Clarification&nbsp;1.&nbsp;:)&nbsp;If&nbsp;I&amp;#39;m&nbsp;completely&nbsp;with&nbsp;you,&nbsp;that&nbsp;is&nbsp;entirely&nbsp;unexpected&nbsp;on&nbsp;my&nbsp;part&nbsp;(and&nbsp;I&amp;#39;ve&nbsp;read&nbsp;this&nbsp;part&nbsp;of&nbsp;the&nbsp;spec&nbsp;a&nbsp;few&nbsp;times).&nbsp;Is&nbsp;this&nbsp;to&nbsp;imply&nbsp;that,&nbsp;no&nbsp;matter&nbsp;what&nbsp;the&nbsp;arguments&nbsp;to&nbsp;pushState(),&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;URL&nbsp;there&nbsp;will&nbsp;be&nbsp;no&nbsp;request&nbsp;for&nbsp;a&nbsp;new&nbsp;document&nbsp;and&nbsp;no&nbsp;user-agent&nbsp;initiated&nbsp;network&nbsp;activity?&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;a&nbsp;behavior&nbsp;I&amp;#39;m&nbsp;fine&nbsp;with&nbsp;and&nbsp;will&nbsp;meet&nbsp;my&nbsp;needs&nbsp;just&nbsp;as&nbsp;well,&nbsp;I&nbsp;was&nbsp;simply&nbsp;expecting&nbsp;to&nbsp;have&nbsp;to&nbsp;use&nbsp;the&nbsp;approach&nbsp;from&nbsp;Clarification&nbsp;2&nbsp;in&nbsp;order&nbsp;to&nbsp;retain&nbsp;my&nbsp;document&nbsp;object.&nbsp;It&nbsp;does&nbsp;however&nbsp;lend&nbsp;itself&nbsp;to&nbsp;some&nbsp;confusion&nbsp;when&nbsp;paired&nbsp;with&nbsp;user&nbsp;agents&nbsp;that&nbsp;don&amp;#39;t&nbsp;yet&nbsp;support&nbsp;the&nbsp;history&nbsp;portions&nbsp;of&nbsp;the&nbsp;spec&nbsp;as&nbsp;they&nbsp;will&nbsp;have&nbsp;to&nbsp;be&nbsp;handled&nbsp;with&nbsp;hash-based&nbsp;addressing&nbsp;while&nbsp;those&nbsp;that&nbsp;support&nbsp;pushState()&nbsp;will&nbsp;have&nbsp;more&nbsp;sane&nbsp;URLs--but&nbsp;that&nbsp;is&nbsp;no&nbsp;matter&nbsp;in&nbsp;the&nbsp;grand&nbsp;scheme&nbsp;of&nbsp;things.&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
Also,&nbsp;that&nbsp;would&nbsp;imply&nbsp;that&nbsp;the&nbsp;popstate&nbsp;only&nbsp;fires&nbsp;when&nbsp;you&amp;#39;re&nbsp;navigating&nbsp;through&nbsp;history.&nbsp;Is&nbsp;that&nbsp;correct?&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks!&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
Nathan&lt;/font&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Jul&nbsp;30,&nbsp;2009,&nbsp;at&nbsp;4:42&nbsp;AM,&nbsp;Jonas&nbsp;Sicking&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
On&nbsp;Wed,&nbsp;Jul&nbsp;29,&nbsp;2009&nbsp;at&nbsp;7:38&nbsp;PM,&nbsp;Nathan&nbsp;Hammond&amp;lt;&lt;a&nbsp;href=&quot;mailto:nathan@nathanhammond.com&quot;&nbsp;target=&quot;_blank&quot;&gt;nathan@nathanhammond.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Clarifications&lt;br&gt;<br>
1.&nbsp;window.history.pushState({},&nbsp;&amp;quot;Title&amp;quot;,&lt;br&gt;<br>
&amp;quot;/path/to/new/file.html?s=newvalue#newhash&amp;quot;)&nbsp;replaces&nbsp;the&nbsp;current&nbsp;document&lt;br&gt;<br>
object&nbsp;with&nbsp;the&nbsp;one&nbsp;specified&nbsp;by&nbsp;the&nbsp;new&nbsp;URL.&nbsp;It&nbsp;then&nbsp;causes&nbsp;the&nbsp;event&lt;br&gt;<br>
popstate&nbsp;to&nbsp;fire&nbsp;immediately&nbsp;after&nbsp;the&nbsp;load&nbsp;event,&nbsp;correct?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
No.&nbsp;The&nbsp;above&nbsp;line&nbsp;with&nbsp;change&nbsp;the&nbsp;uri&nbsp;of&nbsp;the&nbsp;existing&nbsp;document&nbsp;to&nbsp;be&lt;br&gt;<br>
&amp;quot;&lt;a&nbsp;href=&quot;http://example.com/path/to/new/file.html?s=newvalue#newhash&quot;&nbsp;target=&quot;_blank&quot;&gt;http://example.com/path/to/new/file.html?s=newvalue#newhash&lt;/a&gt;&amp;quot;&nbsp;(with&lt;br&gt;<br>
the&nbsp;part&nbsp;before&nbsp;&amp;#39;path&amp;#39;&nbsp;obviously&nbsp;depending&nbsp;on&nbsp;where&nbsp;the&nbsp;original&nbsp;page&lt;br&gt;<br>
lives).&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;no&nbsp;network&nbsp;activity&nbsp;takes&nbsp;place&nbsp;and&nbsp;the&nbsp;Document&nbsp;node&nbsp;remains&nbsp;the&lt;br&gt;<br>
same.&nbsp;Also&nbsp;no&nbsp;popstate&nbsp;event&nbsp;is&nbsp;fired.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
2.&nbsp;window.history.pushState({},&nbsp;&amp;quot;Title&amp;quot;,&nbsp;&amp;quot;#newhash&amp;quot;)&nbsp;creates&nbsp;a&nbsp;new&nbsp;history&lt;br&gt;<br>
state&nbsp;object&nbsp;with&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,&nbsp;the&nbsp;specified&nbsp;title,&nbsp;the&nbsp;same&lt;br&gt;<br>
document&nbsp;object,&nbsp;and&nbsp;a&nbsp;location&nbsp;object&nbsp;that&nbsp;replaces&nbsp;the&nbsp;existing&nbsp;hash&nbsp;with&lt;br&gt;<br>
&amp;quot;#newhash&amp;quot;,&nbsp;correct?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
Yes.&lt;br&gt;<br>
&lt;br&gt;<br>
/&nbsp;Jonas&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
