<tt>
&lt;div&gt;Hi,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;a&nbsp;couple&nbsp;of&nbsp;questions&nbsp;about&nbsp;Web&nbsp;Workers&nbsp;and&nbsp;text&nbsp;encoding&nbsp;of&nbsp;URLs.&nbsp;Usually,&nbsp;&#39;server&#39;&nbsp;and&nbsp;&#39;path&#39;&nbsp;portions&nbsp;of&nbsp;URLs&nbsp;are&nbsp;always&nbsp;sent&nbsp;in&nbsp;UTRF-8,&nbsp;the&nbsp;&#39;query&#39;&nbsp;portion&nbsp;may&nbsp;be&nbsp;sent&nbsp;encoded&nbsp;if&nbsp;it&nbsp;contains&nbsp;non-ascii&nbsp;characters.&nbsp;I&#39;m&nbsp;looking&nbsp;at&nbsp;what&nbsp;should&nbsp;be&nbsp;an&nbsp;encoding&nbsp;used&nbsp;for&nbsp;this. &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Lets&nbsp;say&nbsp;we&nbsp;have&nbsp;the&nbsp;Page&nbsp;that&nbsp;creates&nbsp;a&nbsp;Worker&nbsp;which&nbsp;uses&nbsp;includeScripts&nbsp;to&nbsp;load&nbsp;the&nbsp;NestedScript.&lt;/div&gt;&lt;div&gt;Lets&nbsp;say&nbsp;the&nbsp;Page&nbsp;has&nbsp;some&nbsp;text&nbsp;encoding&nbsp;(from&nbsp;http&nbsp;header,&nbsp;meta&nbsp;tag&nbsp;or&nbsp;otherwise).&nbsp;For&nbsp;example,&nbsp;in&nbsp;latest&nbsp;FF&nbsp;nightly&nbsp;(Minefield)&nbsp;the&nbsp;following&nbsp;behaviors&nbsp;can&nbsp;be&nbsp;observed:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;XmlHttpRequest&nbsp;created&nbsp;on&nbsp;the&nbsp;Page&nbsp;would&nbsp;send&nbsp;its&nbsp;URL&nbsp;to&nbsp;server&nbsp;encoded&nbsp;using&nbsp;UTF8,&nbsp;irrespective&nbsp;to&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Page.&nbsp;However,&nbsp;a&nbsp;XmlHttpRequest&nbsp;created&nbsp;in&nbsp;the&nbsp;Worker&nbsp;would&nbsp;send&nbsp;the&nbsp;URL&nbsp;encoded&nbsp;using&nbsp;Page&#39;s&nbsp;encoding.&nbsp;It&nbsp;seems&nbsp;that&nbsp;either&nbsp;XHR&nbsp;on&nbsp;the&nbsp;Page&nbsp;should&nbsp;also&nbsp;use&nbsp;Page&#39;s&nbsp;encoding,&nbsp;or&nbsp;XHR&nbsp;in&nbsp;the&nbsp;Worker&nbsp;should&nbsp;use&nbsp;UTF-8.&nbsp;Bug?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;When&nbsp;a&nbsp;script&nbsp;of&nbsp;the&nbsp;Worker&nbsp;is&nbsp;decoded,&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Page&nbsp;is&nbsp;used,&nbsp;unless&nbsp;Worker&#39;s&nbsp;script&nbsp;comes&nbsp;with&nbsp;http&nbsp;header&nbsp;overriding&nbsp;the&nbsp;ecncoding.&nbsp;That&nbsp;sounds&nbsp;right.&nbsp;However,&nbsp;if&nbsp;the&nbsp;Worker&nbsp;in&nbsp;turn&nbsp;creates&nbsp;a&nbsp;nested&nbsp;Worker,&nbsp;uses&nbsp;an&nbsp;XHR&nbsp;or&nbsp;importScripts(url),&nbsp;the&nbsp;URL&nbsp;encoding&nbsp;defaults&nbsp;back&nbsp;to&nbsp;the&nbsp;Page&#39;s,&nbsp;even&nbsp;if&nbsp;there&nbsp;was&nbsp;overriding&nbsp;http&nbsp;header.&nbsp;It&nbsp;might&nbsp;be&nbsp;ok&nbsp;but&nbsp;seems&nbsp;a&nbsp;bit&nbsp;illogical&nbsp;-&nbsp;the&nbsp;nested&nbsp;worker&nbsp;or&nbsp;imported&nbsp;scripts&nbsp;are&nbsp;&#39;sub&nbsp;resources&#39;,&nbsp;their&nbsp;relative&nbsp;url&nbsp;is&nbsp;resolved&nbsp;against&nbsp;the&nbsp;Worker&#39;s&nbsp;base&nbsp;url,&nbsp;so&nbsp;it&nbsp;feels&nbsp;that&nbsp;their&nbsp;default&nbsp;encoding&nbsp;should&nbsp;be&nbsp;inherited&nbsp;from&nbsp;Worker.&nbsp;Is&nbsp;it&nbsp;a&nbsp;bug? &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Dmitry&lt;/div&gt;<br>

</tt>
