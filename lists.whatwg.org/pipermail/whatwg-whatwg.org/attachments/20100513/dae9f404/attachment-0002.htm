<tt>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;May&nbsp;13,&nbsp;2010&nbsp;at&nbsp;9:56&nbsp;AM,&nbsp;Markus&nbsp;Ernst&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:derernst@gmx.ch&quot;&gt;derernst@gmx.ch&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
I&nbsp;am&nbsp;a&nbsp;web&nbsp;author&nbsp;with&nbsp;limited&nbsp;scripting&nbsp;knowledge,&nbsp;so&nbsp;I&nbsp;apologize&nbsp;I&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;qualified&nbsp;feedback&nbsp;to&nbsp;your&nbsp;proposal&nbsp;in&nbsp;detail.&lt;br&gt;<br>
&lt;br&gt;<br>
Generally&nbsp;I&nbsp;consider&nbsp;client&nbsp;side&nbsp;image&nbsp;resizing&nbsp;a&nbsp;very&nbsp;good&nbsp;idea;&nbsp;currently&nbsp;I&nbsp;use&nbsp;a&nbsp;Java&nbsp;applet&nbsp;for&nbsp;this&nbsp;purpose,&nbsp;and&nbsp;of&nbsp;course&nbsp;it&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;have&nbsp;this&nbsp;functionality&nbsp;natively&nbsp;in&nbsp;browsers.&nbsp;Anyway,&nbsp;for&nbsp;submitting&nbsp;the&nbsp;image&nbsp;in&nbsp;a&nbsp;form&nbsp;(which&nbsp;both&nbsp;your&nbsp;use&nbsp;cases&nbsp;are&nbsp;about),&nbsp;I&nbsp;would&nbsp;not&nbsp;primarily&nbsp;expect&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;blob,&nbsp;but&nbsp;rather&nbsp;one&nbsp;that&nbsp;modifies&nbsp;the&nbsp;image&nbsp;data.&nbsp;E.g.:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
function&nbsp;resize(mimeType,&nbsp;width,&nbsp;height,&nbsp;keepAspectRatio,&nbsp;qualityLevel)&lt;br&gt;<br>
&lt;br&gt;<br>
For&nbsp;the&nbsp;image&nbsp;upload&nbsp;use&nbsp;case,&nbsp;calling&nbsp;the&nbsp;function&nbsp;via&nbsp;event-handler&nbsp;in&nbsp;the&nbsp;file&nbsp;input&nbsp;control&nbsp;affects&nbsp;the&nbsp;image&nbsp;data&nbsp;in&nbsp;the&nbsp;form&nbsp;data:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;input&nbsp;type=&quot;file&quot;&nbsp;onSubmit=&quot;resize(&#39;image/jpeg&#39;,&nbsp;300,&nbsp;350,&nbsp;true)&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt; &lt;/div&gt;&lt;div&gt;Thanks&nbsp;Markus&nbsp;for&nbsp;the&nbsp;feedback.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;A&nbsp;few&nbsp;things&nbsp;that&nbsp;may&nbsp;not&nbsp;have&nbsp;been&nbsp;made&nbsp;clear&nbsp;in&nbsp;the&nbsp;proposal:&lt;/div&gt;<br>
&lt;div&gt;1.&nbsp;It&nbsp;important&nbsp;that&nbsp;the&nbsp;method&nbsp;be&nbsp;asynchronous&nbsp;to&nbsp;avoid&nbsp;the&nbsp;web&nbsp;page&nbsp;hanging&nbsp;while&nbsp;waiting&nbsp;for&nbsp;a&nbsp;result.&nbsp;(If&nbsp;you&nbsp;wanted&nbsp;a&nbsp;sync&nbsp;resize,&nbsp;you&nbsp;could&nbsp;use&nbsp;canvas&nbsp;for&nbsp;example.)&lt;/div&gt;&lt;div&gt;2.&nbsp;The&nbsp;use&nbsp;cases&nbsp;didn&#39;t&nbsp;touch&nbsp;on&nbsp;the&nbsp;desire&nbsp;to&nbsp;display&nbsp;the&nbsp;image&nbsp;being&nbsp;uploaded&nbsp;(especially&nbsp;useful&nbsp;for&nbsp;use&nbsp;case&nbsp;#2,&nbsp;limiting&nbsp;the&nbsp;size&nbsp;of&nbsp;an&nbsp;uploaded&nbsp;image).&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;I&nbsp;read&nbsp;this&nbsp;line &lt;input&nbsp;type=&quot;file&quot;&nbsp;onSubmit=&quot;resize(&#39;image/jpeg&#39;,&nbsp;300,&nbsp;350,&nbsp;true)&quot;&gt;, you&#39;ve&nbsp;suggesting&nbsp;adding&nbsp;a&nbsp;resize&nbsp;method&nbsp;on&nbsp;the&nbsp;file&nbsp;object&nbsp;that&nbsp;modifies&nbsp;the&nbsp;file&nbsp;in&nbsp;memory.&nbsp;I&#39;m&nbsp;not&nbsp;sure&nbsp;how&nbsp;that&nbsp;would&nbsp;work&nbsp;because&nbsp;Files&nbsp;are&nbsp;immutable&nbsp;in&nbsp;memory.&nbsp;In&nbsp;addition,&nbsp;we&#39;d&nbsp;need&nbsp;to&nbsp;add&nbsp;a&nbsp;resize&nbsp;method&nbsp;to&nbsp;image&nbsp;which&nbsp;modifies&nbsp;it&nbsp;in&nbsp;memory&nbsp;and&nbsp;a&nbsp;getBlob()&nbsp;method.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;like&nbsp;the&nbsp;fact&nbsp;that&nbsp;your&nbsp;proposal&nbsp;results&nbsp;in&nbsp;much&nbsp;simpler&nbsp;code&nbsp;overall,&nbsp;but&nbsp;it&nbsp;seems&nbsp;like&nbsp;there&nbsp;may&nbsp;be&nbsp;a&nbsp;number&nbsp;of&nbsp;problems&nbsp;with&nbsp;this&nbsp;approach.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;fwiw,&nbsp;here&#39;s&nbsp;a&nbsp;more&nbsp;complete&nbsp;sample&nbsp;(using&nbsp;the&nbsp;img.getBlob&nbsp;method)&nbsp;which&nbsp;gives&nbsp;a&nbsp;preview&nbsp;of&nbsp;the&nbsp;upload,&nbsp;does&nbsp;the&nbsp;upload&nbsp;to&nbsp;the&nbsp;server,&nbsp;or&nbsp;shows&nbsp;an&nbsp;error&nbsp;if&nbsp;appropriate.&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-family:&nbsp;sans-serif;&nbsp;font-size:&nbsp;medium;&nbsp;line-height:&nbsp;20px;&nbsp;&quot;&gt;&lt;pre&nbsp;class=&quot;code&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;overflow-x:&nbsp;auto;&nbsp;overflow-y:&nbsp;auto;&nbsp;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;1em;&nbsp;margin-left:&nbsp;0px;&nbsp;font-family:&nbsp;monospace;&nbsp;padding-top:&nbsp;0px;&nbsp;padding-right:&nbsp;1em;&nbsp;padding-bottom:&nbsp;0px;&nbsp;padding-left:&nbsp;1em;&nbsp;&quot;&gt;<br>
&lt;code&nbsp;class=&quot;es-code&quot;&nbsp;style=&quot;font-size:&nbsp;14px&nbsp;!important;&nbsp;background-image:&nbsp;initial;&nbsp;background-attachment:&nbsp;initial;&nbsp;background-origin:&nbsp;initial;&nbsp;background-clip:&nbsp;initial;&nbsp;background-color:&nbsp;rgb(217,&nbsp;232,&nbsp;255);&nbsp;font-family:&nbsp;monospace;&nbsp;background:&nbsp;inherit;&nbsp;background-position:&nbsp;initial&nbsp;initial;&nbsp;background-repeat:&nbsp;initial&nbsp;initial;&nbsp;&quot;&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;arial&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;line-height:&nbsp;normal;&nbsp;white-space:&nbsp;normal;&nbsp;font-size:&nbsp;small;&quot;&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;var&nbsp;upload&nbsp;=&nbsp;function&nbsp;(newBlob)&nbsp;{&lt;/div&gt;&lt;div&gt;  //&nbsp;Show&nbsp;a&nbsp;preview&nbsp;of&nbsp;the&nbsp;image.&lt;/div&gt;&lt;div&gt;  document.getElementById(&quot;uploadPreview&quot;).src&nbsp;=&nbsp;newBlob.url;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;  //&nbsp;Upload&nbsp;it&nbsp;to&nbsp;our&nbsp;server.&lt;/div&gt;<br>
&lt;div&gt;  var&nbsp;formData&nbsp;=&nbsp;new&nbsp;FormData();&lt;/div&gt;&lt;div&gt;  formData.append(newBlob);&lt;/div&gt;&lt;div&gt;  var&nbsp;xhr&nbsp;=&nbsp;new&nbsp;XMLHttpRequest();&lt;/div&gt;&lt;div&gt;  xhr.open(&quot;POST&quot;,&nbsp;&quot;&lt;a&nbsp;href=&quot;http://example.com/&quot;&gt;http://example.com/&lt;/a&gt;&quot;);&lt;/div&gt;<br>
&lt;div&gt;  xhr.send(formData);&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;var&nbsp;resizeFailed&nbsp;=&nbsp;function&nbsp;(newBlob)&nbsp;{&lt;/div&gt;&lt;div&gt;  document.getElementById(&quot;status&quot;).innerText&nbsp;=&nbsp;&quot;Oops.&nbsp;Unable&nbsp;to...&quot;;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Image&nbsp;i&nbsp;=&nbsp;new&nbsp;Image();&lt;/div&gt;&lt;div&gt;var&nbsp;file&nbsp;=&nbsp;document.forms[&#39;uploadData&#39;][&#39;fileChooser&#39;].files[0];&lt;/div&gt;&lt;div&gt;i.src&nbsp;=&nbsp;file.url;&lt;/div&gt;&lt;div&gt;i.getBlob(&#39;image/png&#39;,&nbsp;300,&nbsp;350,&nbsp;upload,&nbsp;resizeFailed,&nbsp;.55);&lt;/div&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;Thanks,&nbsp;dave&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
