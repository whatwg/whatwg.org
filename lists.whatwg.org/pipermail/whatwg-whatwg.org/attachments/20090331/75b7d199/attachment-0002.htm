<tt>
Hi&nbsp;WHATWG,&lt;br&gt;&lt;br&gt;There&nbsp;have&nbsp;been&nbsp;discussions&nbsp;in&nbsp;the&nbsp;past&nbsp;about&nbsp;building&nbsp;notifications&nbsp;(&quot;toasts&quot;)&nbsp;as&nbsp;a&nbsp;way&nbsp;for&nbsp;workers,&nbsp;especially&nbsp;persistent&nbsp;workers,&nbsp;to&nbsp;have&nbsp;a&nbsp;form&nbsp;of&nbsp;UI. &nbsp;It&#39;s&nbsp;not&nbsp;spec&#39;d&nbsp;in&nbsp;HTML5&nbsp;at&nbsp;the&nbsp;moment,&nbsp;but&nbsp;I&#39;m&nbsp;currently&nbsp;working&nbsp;on&nbsp;an&nbsp;implementation&nbsp;in&nbsp;Chromium&nbsp;and&nbsp;wanted&nbsp;to&nbsp;get&nbsp;broader&nbsp;feedback&nbsp;on&nbsp;the&nbsp;design&nbsp;we&#39;re&nbsp;working&nbsp;from. &nbsp;Here&#39;s&nbsp;our&nbsp;design&nbsp;doc. &nbsp;Thoughts?&lt;br&gt;<br>
<br>
&lt;br&gt;Thanks,&nbsp;&lt;br&gt; &nbsp;-John&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;u&gt;&lt;b&gt;Notifications&nbsp;for&nbsp;Persistent&nbsp;Workers&lt;/b&gt;&lt;/u&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;Background&lt;/b&gt;&lt;br&gt;&lt;br&gt;Persistent&nbsp;workers&nbsp;run&nbsp;scripts&nbsp;in&nbsp;the&nbsp;background,&nbsp;potentially&nbsp;in&nbsp;the&nbsp;absence&nbsp;of&nbsp;open&nbsp;tabs&nbsp;connected&nbsp;to&nbsp;that&nbsp;worker&nbsp;script. &nbsp;This&nbsp;document&nbsp;describes&nbsp;a&nbsp;way&nbsp;for&nbsp;these&nbsp;scripts&nbsp;to&nbsp;interact&nbsp;with&nbsp;the&nbsp;user&nbsp;through&nbsp;notifications:&nbsp;&quot;toasts&quot;&nbsp;which&nbsp;appear&nbsp;on&nbsp;the&nbsp;user&#39;s&nbsp;desktop,&nbsp;outside&nbsp;of&nbsp;any&nbsp;tab.&lt;br&gt;<br>
&lt;br&gt;QUESTION:&nbsp;Dedicated&nbsp;and&nbsp;shared&nbsp;workers,&nbsp;though&nbsp;able&nbsp;to&nbsp;interact&nbsp;with&nbsp;the&nbsp;user&nbsp;through&nbsp;open&nbsp;tabs,&nbsp;also&nbsp;have&nbsp;compelling&nbsp;use&nbsp;cases&nbsp;where&nbsp;desktop&nbsp;UI&nbsp;serves&nbsp;better&nbsp;than&nbsp;in-tab&nbsp;UI&nbsp;(e.g.,&nbsp;Calendar&nbsp;alerts&nbsp;and&nbsp;&quot;New&nbsp;Email&quot;&nbsp;notifications).&nbsp;Should&nbsp;this&nbsp;be&nbsp;extended&nbsp;to&nbsp;all&nbsp;such&nbsp;contexts? &nbsp;There&nbsp;are&nbsp;implementation&nbsp;benefits&nbsp;to&nbsp;limiting&nbsp;notifications&nbsp;to&nbsp;shared&nbsp;workers&nbsp;(avoiding&nbsp;duplication&nbsp;of&nbsp;notifications,&nbsp;etc.),&nbsp;but&nbsp;this&nbsp;may&nbsp;present&nbsp;a&nbsp;burden&nbsp;to&nbsp;developers&nbsp;who&nbsp;wish&nbsp;to&nbsp;incorporate&nbsp;notifications&nbsp;in&nbsp;a&nbsp;webapp&nbsp;with&nbsp;minimal&nbsp;effort. &nbsp;This&nbsp;document&nbsp;will&nbsp;limit&nbsp;itself&nbsp;to&nbsp;the&nbsp;application&nbsp;in&nbsp;shared&nbsp;&amp;&nbsp;persistent&nbsp;workers.&lt;br&gt;<br>
&lt;br&gt;&lt;b&gt;Capabilities&lt;/b&gt;&lt;br&gt;&lt;br&gt;User-agents&nbsp;may&nbsp;implement&nbsp;desktop&nbsp;notifications&nbsp;in&nbsp;different&nbsp;ways. &nbsp;The&nbsp;strongest&nbsp;form&nbsp;provides&nbsp;full&nbsp;HTML&nbsp;display,&nbsp;where&nbsp;a&nbsp;URL&nbsp;is&nbsp;loaded&nbsp;and&nbsp;presented&nbsp;in&nbsp;a&nbsp;small&nbsp;desktop&nbsp;balloon.&nbsp;In&nbsp;some&nbsp;environments&nbsp;structured&nbsp;notifications&nbsp;(icon,&nbsp;title,&nbsp;text)&nbsp;are&nbsp;more&nbsp;canonical,&nbsp;e.g.,&nbsp;Ubuntu&#39;s&nbsp;libnotify&nbsp;and&nbsp;Growl. &nbsp;&lt;br&gt;<br>
&lt;br&gt;In&nbsp;addition,&nbsp;HTML5&nbsp;browsers&nbsp;which&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;&quot;desktop&quot;&nbsp;in&nbsp;the&nbsp;traditional&nbsp;sense,&nbsp;such&nbsp;as&nbsp;those&nbsp;on&nbsp;a&nbsp;mobile&nbsp;device,&nbsp;may&nbsp;wish&nbsp;to&nbsp;implement&nbsp;notifications&nbsp;using&nbsp;text-only,&nbsp;text-plus-icon,&nbsp;or&nbsp;other&nbsp;structured&nbsp;notifications. &nbsp;For&nbsp;example,&nbsp;Palm&nbsp;OS&nbsp;offers&nbsp;structured&nbsp;notifications&nbsp;on&nbsp;mobile&nbsp;devices,&nbsp;but&nbsp;not&nbsp;full&nbsp;HTML. &nbsp;For&nbsp;greatest&nbsp;compatibility,&nbsp;the&nbsp;spec&nbsp;should&nbsp;provide&nbsp;alternatives&nbsp;for&nbsp;these&nbsp;different&nbsp;environments.&lt;br&gt;<br>
&lt;br&gt;When&nbsp;HTML&nbsp;notifications&nbsp;are&nbsp;used,&nbsp;they&nbsp;should&nbsp;act&nbsp;like&nbsp;normal&nbsp;browser&nbsp;windows,&nbsp;including&nbsp;stylesheets&nbsp;and&nbsp;script&nbsp;functionality,&nbsp;with&nbsp;the&nbsp;exception&nbsp;that&nbsp;links&nbsp;causing&nbsp;a&nbsp;location&nbsp;change&nbsp;should&nbsp;always&nbsp;open&nbsp;in&nbsp;a&nbsp;new&nbsp;tab. &nbsp;&lt;br&gt;<br>
&lt;br&gt;&lt;b&gt;Proposed&nbsp;Specification&lt;/b&gt;&lt;br&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;SharedWorkerGlobalScope&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; ...&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; readonly&nbsp;attribute&nbsp;Notifications&nbsp;notifications;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;};&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;interface&nbsp;Notifications&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; NotificationObject&nbsp;createHTMLNotification(URL&nbsp;url);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; NotificationObject&nbsp;createNotification(StructuredNotification&nbsp;n);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; /*&nbsp;see&nbsp;&quot;Permissions&quot;&nbsp;below&nbsp;*/&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; readonly&nbsp;attribute&nbsp;boolean&nbsp;trusted;  &nbsp;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; void&nbsp;requestTrust();&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;br&gt;In&nbsp;the&nbsp;Notifications&nbsp;interface,&nbsp;user&nbsp;agents&nbsp;may&nbsp;leave&nbsp;undefined&nbsp;createHTMLNotification()&nbsp;if&nbsp;they&nbsp;do&nbsp;not&nbsp;support&nbsp;HTML&nbsp;notifications.&lt;br&gt;<br>
&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;[nointerface]&nbsp;interface&nbsp;StructuredNotification&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; DOMString&nbsp;title;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; DOMString&nbsp;/*&nbsp;URL&nbsp;*/&nbsp;icon;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; DOMString&nbsp;body;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; /*&nbsp;...&nbsp;perhaps&nbsp;other&nbsp;fields&nbsp;can&nbsp;be&nbsp;optional&nbsp;...&nbsp;*/&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;};&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;interface&nbsp;NotificationObject&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; boolean&nbsp;show(); &nbsp;/*&nbsp;show&nbsp;(queue&nbsp;for&nbsp;display)&nbsp;the&nbsp;notification.&nbsp;throws&nbsp;on&nbsp;repeat&nbsp;calls.&nbsp;*/&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; boolean&nbsp;cancel(); &nbsp;/*&nbsp;close&nbsp;the&nbsp;notification&nbsp;if&nbsp;displayed;&nbsp;cancel&nbsp;it&nbsp;if&nbsp;not&nbsp;yet&nbsp;*/&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; attribute&nbsp;boolean&nbsp;sticky;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; attribute&nbsp;EventListener&nbsp;ondisplay;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; attribute&nbsp;EventListener&nbsp;onerror;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; attribute&nbsp;EventListener&nbsp;onclose;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; /*&nbsp;...&nbsp;perhaps&nbsp;other&nbsp;events&nbsp;...&nbsp;*/&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;Applications&#39;&nbsp;worker&nbsp;scripts&nbsp;can&nbsp;use&nbsp;standard&nbsp;normal&nbsp;capabilities-checking&nbsp;techniques&nbsp;to&nbsp;choose&nbsp;which&nbsp;function&nbsp;to&nbsp;call,&nbsp;HTML&nbsp;or&nbsp;structured.&lt;br&gt;&lt;br&gt;Notifications&nbsp;may&nbsp;be&nbsp;&#39;sticky&#39;,&nbsp;meaning&nbsp;the&nbsp;toast&nbsp;is&nbsp;shown&nbsp;until&nbsp;dismissed&nbsp;by&nbsp;the&nbsp;user,&nbsp;but&nbsp;by&nbsp;default&nbsp;they&nbsp;are&nbsp;not&nbsp;sticky,&nbsp;and&nbsp;will&nbsp;be&nbsp;removed&nbsp;after&nbsp;a&nbsp;period&nbsp;of&nbsp;time&nbsp;which&nbsp;is&nbsp;controlled&nbsp;by&nbsp;the&nbsp;user-agent&nbsp;and&nbsp;underlying&nbsp;desktop&nbsp;based&nbsp;on&nbsp;its&nbsp;own&nbsp;display&nbsp;properties. &nbsp;A&nbsp;worker&nbsp;script&nbsp;may&nbsp;attempt&nbsp;to&nbsp;change&nbsp;the&nbsp;stickiness&nbsp;before&nbsp;showing,&nbsp;although&nbsp;this&nbsp;change&nbsp;may&nbsp;not&nbsp;be&nbsp;successful&nbsp;if&nbsp;not&nbsp;allowed&nbsp;by&nbsp;the&nbsp;environment&nbsp;(e.g.,&nbsp;Ubuntu&#39;s&nbsp;libnotify&nbsp;does&nbsp;not&nbsp;support&nbsp;sticky&nbsp;notifications&nbsp;at&nbsp;all).&nbsp;&lt;br&gt;<br>
&lt;br&gt;Before&nbsp;showing&nbsp;a&nbsp;notification,&nbsp;the&nbsp;worker&nbsp;script&nbsp;can&nbsp;register&nbsp;for&nbsp;event&nbsp;callbacks&nbsp;defined&nbsp;above.&nbsp;All&nbsp;callbacks&nbsp;are&nbsp;asynchronous.&lt;br&gt;&lt;ul&gt;&lt;li&gt;&quot;ondisplay&quot;:&nbsp;when&nbsp;the&nbsp;notification&nbsp;is&nbsp;actually&nbsp;shown&nbsp;to&nbsp;the&nbsp;user. &nbsp;If&nbsp;it&nbsp;is&nbsp;queued&nbsp;for&nbsp;UI&nbsp;space&nbsp;limitations,&nbsp;this&nbsp;may&nbsp;be&nbsp;deferred. &nbsp;This&nbsp;event&nbsp;allows&nbsp;scripts&nbsp;to&nbsp;control&nbsp;notification&nbsp;display&nbsp;intervals&nbsp;more&nbsp;precisely&nbsp;if&nbsp;desired.&lt;br&gt;<br>
&lt;/li&gt;&lt;li&gt;&quot;onerror&quot;:&nbsp;if&nbsp;the&nbsp;notification&nbsp;cannot&nbsp;be&nbsp;shown&nbsp;for&nbsp;some&nbsp;reason,&nbsp;for&nbsp;example&nbsp;if&nbsp;the&nbsp;URL&nbsp;provided&nbsp;generates&nbsp;an&nbsp;error&nbsp;response.&nbsp;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&quot;onclose&quot;:&nbsp;when&nbsp;the&nbsp;notification&nbsp;is&nbsp;closed&nbsp;by&nbsp;the&nbsp;user&nbsp;or&nbsp;by&nbsp;the&nbsp;notification&nbsp;provider. &nbsp;Non-sticky&nbsp;notifications&nbsp;may&nbsp;close&nbsp;themselves&nbsp;automatically,&nbsp;thus&nbsp;the&nbsp;&#39;onclose&#39;&nbsp;event&nbsp;should&nbsp;include&nbsp;an&nbsp;&quot;explicit&quot;&nbsp;attribute&nbsp;which&nbsp;indicates&nbsp;if&nbsp;the&nbsp;user&nbsp;took&nbsp;an&nbsp;action&nbsp;to&nbsp;dismiss&nbsp;the&nbsp;notification.&lt;/li&gt;<br>
&lt;/ul&gt;&lt;br&gt;&lt;b&gt;Example&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;if&nbsp;(notifications)&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &nbsp;var&nbsp;n;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &nbsp;if&nbsp;(typeof(notifications.createHTMLNotification)&nbsp;!=&nbsp;&quot;undefined&quot;)&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;   &nbsp;n&nbsp;=&nbsp;notifications.createHTMLNotification(&quot;/ui/event_starting?id=31415&amp;title=Team+Meeting&amp;location=Room+1200&amp;time=1700&quot;);&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &nbsp;}&nbsp;else&nbsp;{&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;   &nbsp;n&nbsp;=&nbsp;notifications.createNotification({icon:&nbsp;&quot;/images/event.png&quot;,&nbsp;title:&nbsp;&quot;Team&nbsp;Meeting&quot;,&nbsp;body&nbsp;:&nbsp;&quot;Room&nbsp;1200,&nbsp;5:00pm&quot;});&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &nbsp;}&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &nbsp;n.sticky&nbsp;=&nbsp;true;&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &nbsp;n.onclose&nbsp;=&nbsp;function(e)&nbsp;{&nbsp;if&nbsp;(e.explicit)&nbsp;{&nbsp;/*&nbsp;ping&nbsp;server,&nbsp;mark&nbsp;event&nbsp;acknowledged&nbsp;*/&nbsp;}&nbsp;};&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt; &nbsp;n.show();&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-family:&nbsp;courier&nbsp;new,monospace;&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;Permissions&lt;/b&gt;&lt;br&gt;&lt;br&gt;As&nbsp;with&nbsp;any&nbsp;UI&nbsp;elements,&nbsp;the&nbsp;potential&nbsp;exists&nbsp;to&nbsp;annoy&nbsp;users&nbsp;by&nbsp;misuse&nbsp;of&nbsp;the&nbsp;feature.&nbsp;If&nbsp;notifications&nbsp;are&nbsp;available&nbsp;to&nbsp;non-persistent&nbsp;workers&nbsp;or&nbsp;pages,&nbsp;it&nbsp;can&nbsp;be&nbsp;mitigated&nbsp;by&nbsp;separating&nbsp;applications&nbsp;into&nbsp;trust&nbsp;zones&nbsp;defined&nbsp;by&nbsp;the&nbsp;user-agent,&nbsp;where&nbsp;trust&nbsp;is&nbsp;granted&nbsp;by&nbsp;the&nbsp;user.&nbsp;Since&nbsp;persistent&nbsp;workers&nbsp;require&nbsp;installation&nbsp;permission,&nbsp;user&nbsp;agents&nbsp;might&nbsp;combine&nbsp;notification&nbsp;permission&nbsp;with&nbsp;install&nbsp;permission.&lt;br&gt;<br>
&lt;br&gt;Desktop&nbsp;placement&nbsp;is&nbsp;limited&nbsp;to&nbsp;trusted&nbsp;origins;&nbsp;untrusted&nbsp;origins&#39;&nbsp;notifications&nbsp;can&nbsp;be&nbsp;shown&nbsp;within&nbsp;a&nbsp;browser&nbsp;tab&nbsp;rather&nbsp;than&nbsp;on&nbsp;the&nbsp;desktop&nbsp;(like&nbsp;a&nbsp;non-modal&nbsp;alert&nbsp;dialog,&nbsp;with&nbsp;the&nbsp;queueing&nbsp;benefits&nbsp;of&nbsp;the&nbsp;notifications&nbsp;system). &nbsp;&lt;br&gt;<br>
&lt;br&gt;Scripts&nbsp;can&nbsp;determine&nbsp;if&nbsp;they&nbsp;are&nbsp;trusted&nbsp;by&nbsp;checking&nbsp;the&nbsp;notifications.trusted&nbsp;attribute&nbsp;and&nbsp;can&nbsp;use&nbsp;notifications.requestTrust()&nbsp;to&nbsp;request&nbsp;permission&nbsp;from&nbsp;the&nbsp;user&nbsp;to&nbsp;become&nbsp;trusted,&nbsp;through&nbsp;an&nbsp;info-bar&nbsp;or&nbsp;other&nbsp;conventional&nbsp;permissions&nbsp;flow&nbsp;at&nbsp;the&nbsp;discretion&nbsp;of&nbsp;the&nbsp;user&nbsp;agent.&lt;br&gt;<br>
&lt;br&gt;&lt;b&gt;Security/Phishing&lt;/b&gt;&lt;br&gt;&lt;br&gt;When&nbsp;the&nbsp;notification&nbsp;bubbles&nbsp;are&nbsp;shown&nbsp;outside&nbsp;the&nbsp;browser&nbsp;window,&nbsp;and&nbsp;contain&nbsp;fully&nbsp;interactive&nbsp;HTML,&nbsp;there&nbsp;is&nbsp;a&nbsp;potential&nbsp;concern&nbsp;that&nbsp;a&nbsp;compromised&nbsp;or&nbsp;misbehaving&nbsp;worker&nbsp;script&nbsp;might&nbsp;create&nbsp;a&nbsp;phishing&nbsp;opportunity&nbsp;by&nbsp;requesting&nbsp;user&nbsp;input&nbsp;in&nbsp;a&nbsp;notification&nbsp;bubble. &nbsp;&lt;br&gt;<br>
&lt;br&gt;It&nbsp;is&nbsp;recommended&nbsp;that&nbsp;HTML&nbsp;notification&nbsp;bubbles&nbsp;always&nbsp;contain&nbsp;a&nbsp;recognizable&nbsp;browser&nbsp;frame,&nbsp;which&nbsp;displays&nbsp;the&nbsp;origin&nbsp;source&nbsp;of&nbsp;the&nbsp;bubble&nbsp;and&nbsp;identifies&nbsp;HTTPS&nbsp;and&nbsp;other&nbsp;security&nbsp;elements&nbsp;in&nbsp;a&nbsp;standard&nbsp;way. &nbsp;&lt;br&gt;&lt;b&gt;&lt;br&gt;<br>
Offline&nbsp;Use/Application&nbsp;Cache&lt;/b&gt;&lt;br&gt;&lt;br&gt;Some&nbsp;notifications&nbsp;have&nbsp;a&nbsp;strong&nbsp;offline&nbsp;use&nbsp;case,&nbsp;such&nbsp;as&nbsp;calendar&nbsp;reminders. &nbsp;To&nbsp;make&nbsp;the&nbsp;necessary&nbsp;icon&nbsp;images&nbsp;and&nbsp;HTML&nbsp;notification&nbsp;templates&nbsp;available&nbsp;offline,&nbsp;HTML&nbsp;notification&nbsp;windows&nbsp;should&nbsp;have&nbsp;access&nbsp;to&nbsp;the&nbsp;same&nbsp;application&nbsp;cache&nbsp;as&nbsp;the&nbsp;worker&nbsp;which&nbsp;created&nbsp;them,&nbsp;if&nbsp;present,&nbsp;or&nbsp;follow&nbsp;the&nbsp;normal&nbsp;application&nbsp;cache&nbsp;selection&nbsp;algorithm&nbsp;for&nbsp;new&nbsp;windows.&lt;br&gt;<br>
<br>

</tt>
