<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Mar&nbsp;3,&nbsp;2010&nbsp;at&nbsp;6:44&nbsp;PM,&nbsp;Boris&nbsp;Zbarsky&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:bzbarsky@mit.edu&quot;&gt;bzbarsky@mit.edu&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;So&nbsp;I&nbsp;have&nbsp;to&nbsp;ask...&nbsp;Why&nbsp;are&nbsp;events&nbsp;_before_&nbsp;the&nbsp;edit&nbsp;needed?&lt;/div&gt;<br>
&lt;br&gt;<br>
If&nbsp;we&nbsp;add&nbsp;these,&nbsp;then&nbsp;you&nbsp;have&nbsp;to&nbsp;define&nbsp;what&nbsp;happens&nbsp;when&nbsp;those&nbsp;event&nbsp;handlers&nbsp;modify&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;DOM&nbsp;in&nbsp;arbitrary&nbsp;ways,&nbsp;including&nbsp;carrying&nbsp;out&nbsp;operations&nbsp;that&nbsp;spin&nbsp;the&nbsp;event&nbsp;loop,&nbsp;operations&nbsp;that&nbsp;make&nbsp;the&nbsp;edit&nbsp;that&amp;#39;s&nbsp;about&nbsp;to&nbsp;happen&nbsp;nonsensical,&nbsp;and&nbsp;so&nbsp;forth.&nbsp; It&amp;#39;s&nbsp;a&nbsp;huge&nbsp;chunk&nbsp;of&nbsp;spec&nbsp;and&nbsp;implementation&nbsp;complexity.&nbsp; So&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;see&nbsp;some&nbsp;very&nbsp;compelling&nbsp;use&nbsp;cases&nbsp;to&nbsp;even&nbsp;consider&nbsp;it.&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&amp;#39;s&nbsp;a&nbsp;couple&nbsp;use-cases&nbsp;off&nbsp;the&nbsp;top&nbsp;of&nbsp;my&nbsp;head:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Google&nbsp;Wave:&lt;br&gt;&lt;div&gt;They&nbsp;keep&nbsp;a&nbsp;model&nbsp;of&nbsp;the&nbsp;content&nbsp;separate&nbsp;from&nbsp;the&nbsp;html&nbsp;contents&nbsp;of&nbsp;the&nbsp;contentEditable&nbsp;region.&nbsp;In&nbsp;order&nbsp;to&nbsp;make&nbsp;that&nbsp;work,&nbsp;for&nbsp;every&nbsp;user-action,&nbsp;they&nbsp;need&nbsp;to&nbsp;either&nbsp;mimic&nbsp;what&nbsp;the&nbsp;browser&nbsp;did&nbsp;or&nbsp;cancel&nbsp;the&nbsp;default&nbsp;browser&nbsp;behavior&nbsp;and&nbsp;perform&nbsp;that&nbsp;action&nbsp;themselves.&nbsp;In&nbsp;both&nbsp;cases,&nbsp;having&nbsp;a&nbsp;beforeinput&nbsp;event&nbsp;makes&nbsp;the&nbsp;code&nbsp;much&nbsp;more&nbsp;sane,&nbsp;less&nbsp;brittle&nbsp;and&nbsp;often&nbsp;more&nbsp;performant.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;case&nbsp;where&nbsp;they&nbsp;want&nbsp;to&nbsp;cancel&nbsp;the&nbsp;default&nbsp;browser&nbsp;behavior&nbsp;(e.g.&nbsp;undo/redo),&nbsp;they&nbsp;get&nbsp;the&nbsp;beforeinput&nbsp;event,&nbsp;cancel&nbsp;it&nbsp;and&nbsp;then&nbsp;do&nbsp;their&nbsp;thing.&nbsp;Without&nbsp;beforeinput,&nbsp;they&nbsp;need&nbsp;to&nbsp;wait&nbsp;for&nbsp;the&nbsp;action&nbsp;to&nbsp;happen&nbsp;and&nbsp;then&nbsp;either&nbsp;make&nbsp;sense&nbsp;of&nbsp;the&nbsp;changes&nbsp;to&nbsp;the&nbsp;DOM,&nbsp;or&nbsp;undo&nbsp;the&nbsp;changes&nbsp;and&nbsp;reapply&nbsp;their&nbsp;own&nbsp;changes.&nbsp;Those&nbsp;both&nbsp;lead&nbsp;to&nbsp;brittle&nbsp;and,&nbsp;in&nbsp;some&nbsp;cases,&nbsp;expensive&nbsp;code.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;case&nbsp;where&nbsp;they&nbsp;want&nbsp;to&nbsp;let&nbsp;the&nbsp;browser&nbsp;perform&nbsp;it&amp;#39;s&nbsp;default&nbsp;action,&nbsp;having&nbsp;the&nbsp;beforeinput&nbsp;event&nbsp;allows&nbsp;them&nbsp;to&nbsp;properly&nbsp;bookend&nbsp;a&nbsp;user-action&nbsp;and&nbsp;know&nbsp;with&nbsp;confidence&nbsp;that&nbsp;they&amp;#39;ve&nbsp;correctly&nbsp;handled&nbsp;it.&nbsp;Instead,&nbsp;they&nbsp;currently&nbsp;have&nbsp;very&nbsp;complex&nbsp;and&nbsp;brittle&nbsp;logic&nbsp;listening&nbsp;to&nbsp;every&nbsp;event&nbsp;under&nbsp;the&nbsp;sun&nbsp;in&nbsp;order&nbsp;to&nbsp;make&nbsp;sure&nbsp;they&nbsp;catch&nbsp;every&nbsp;possible&nbsp;user-action.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Typing&nbsp;at&nbsp;the&nbsp;beginning/end&nbsp;of&nbsp;links:&lt;/div&gt;&lt;div&gt;Another&nbsp;more&nbsp;general&nbsp;use-case&nbsp;is&nbsp;needing&nbsp;to&nbsp;modify&nbsp;the&nbsp;DOM&nbsp;before&nbsp;the&nbsp;user-action&nbsp;occurs.&nbsp;This&nbsp;comes&nbsp;up&nbsp;often&nbsp;when&nbsp;typing&nbsp;at&nbsp;the&nbsp;beginning/end&nbsp;of&nbsp;a&nbsp;link&nbsp;(or&nbsp;otherwise&nbsp;special&nbsp;inline&nbsp;element).&nbsp;Different&nbsp;apps&nbsp;want&nbsp;different&nbsp;behavior&nbsp;(e.g.&nbsp;should&nbsp;the&nbsp;text&nbsp;inserted&nbsp;go&nbsp;inside&nbsp;the&nbsp;link&nbsp;or&nbsp;after&nbsp;it).&nbsp;Currently,&nbsp;controlling&nbsp;that&nbsp;behavior&nbsp;is&nbsp;really&nbsp;difficult.&nbsp;You&nbsp;need&nbsp;to&nbsp;capture&nbsp;every&nbsp;time&nbsp;the&nbsp;selection&nbsp;changes&nbsp;and&nbsp;mess&nbsp;with&nbsp;the&nbsp;DOM/selection&nbsp;appropriately&nbsp;to&nbsp;get&nbsp;the&nbsp;text&nbsp;inserted&nbsp;in&nbsp;the&nbsp;right&nbsp;place.&nbsp;In&nbsp;theory,&nbsp;you&nbsp;*could*&nbsp;do&nbsp;this&nbsp;with&nbsp;just&nbsp;the&nbsp;input&nbsp;event,&nbsp;but&nbsp;that&nbsp;would&nbsp;get&nbsp;you&nbsp;back&nbsp;into&nbsp;reverse&nbsp;engineering&nbsp;whatever&nbsp;the&nbsp;user-action&nbsp;was,&nbsp;which&nbsp;is&nbsp;again&nbsp;brittle&nbsp;and&nbsp;difficult&nbsp;to&nbsp;get&nbsp;right.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;that&nbsp;a&nbsp;bit&nbsp;more&nbsp;convincing&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;need&nbsp;for&nbsp;a&nbsp;beforeinput&nbsp;event? beforeinput&nbsp;aside,&nbsp;are&nbsp;you&nbsp;in&nbsp;support&nbsp;of&nbsp;extending&nbsp;the&nbsp;input&nbsp;event&nbsp;to&nbsp;contentEditable&nbsp;elements&nbsp;and&nbsp;adding&nbsp;the&nbsp;data/action&nbsp;attributes?&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Any&nbsp;thoughts&nbsp;from&nbsp;Opera&nbsp;developers?&nbsp;Anne,&nbsp;your&nbsp;previous&nbsp;comments&nbsp;on&nbsp;this&nbsp;thread&nbsp;make&nbsp;it&nbsp;sound&nbsp;like&nbsp;you&nbsp;support&nbsp;this&nbsp;and&nbsp;would&nbsp;consider&nbsp;adding&nbsp;it&nbsp;to&nbsp;Opera?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ojan&lt;/div&gt;<br>

</tt>
