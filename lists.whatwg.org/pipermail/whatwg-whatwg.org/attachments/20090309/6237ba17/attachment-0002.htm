<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;No,&nbsp;this&nbsp;is&nbsp;a&nbsp;synchronous&nbsp;API&nbsp;which&nbsp;is&nbsp;not&nbsp;acceptible&nbsp;since&nbsp;it&nbsp;creates&lt;br&gt;<br>
a&nbsp;multithreaded&nbsp;environment&nbsp;for&nbsp;web&nbsp;developers.&nbsp;You&nbsp;need&nbsp;to&nbsp;use&nbsp;a&lt;br&gt;<br>
callback&nbsp;function.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;/font&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Hmmm,&nbsp;I&nbsp;must&#39;ve&nbsp;misinterpreted&nbsp;your&nbsp;previous&nbsp;statement:&lt;br&gt;&lt;br&gt;&gt;&gt;&gt;&nbsp;It&nbsp;seems&nbsp;like&nbsp;it&nbsp;should&nbsp;fine&nbsp;to&nbsp;allow&nbsp;reading&nbsp;cookies&nbsp;in&nbsp;dedicated&lt;br&gt;<br>
&gt;&gt;&gt;&nbsp;workers&nbsp;though.&lt;br&gt;&lt;br&gt;I&#39;m&nbsp;sure&nbsp;I&#39;m&nbsp;being&nbsp;obtuse,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;understand&nbsp;what&nbsp;you&nbsp;are&nbsp;saying&nbsp;here.&lt;br&gt;&lt;br&gt;Let&#39;s&nbsp;imagine&nbsp;that&nbsp;I&nbsp;have&nbsp;a&nbsp;synchronous&nbsp;API&nbsp;-&nbsp;you&nbsp;are&nbsp;saying&nbsp;that&nbsp;this&nbsp;is&nbsp;bad,&nbsp;because&nbsp;when&nbsp;I&nbsp;do&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;var&nbsp;cookies&nbsp;=&nbsp;self.getAllCookies();&lt;br&gt;doSomethingWithCookies(cookies);&lt;br&gt;&lt;br&gt;The&nbsp;value&nbsp;of&nbsp;&quot;cookies&quot;&nbsp;may&nbsp;be&nbsp;out&nbsp;of&nbsp;date,&nbsp;so&nbsp;whatever&nbsp;doSomethingWithCookies()&nbsp;is&nbsp;doing&nbsp;(like&nbsp;invoking&nbsp;an&nbsp;XHR&nbsp;request)&nbsp;may&nbsp;fail&nbsp;because&nbsp;the&nbsp;cookies&nbsp;aren&#39;t&nbsp;accurate.&lt;br&gt;<br>
&lt;br&gt;So,&nbsp;let&#39;s&nbsp;assume&nbsp;instead&nbsp;that&nbsp;we&nbsp;allow&nbsp;passing&nbsp;a&nbsp;callback&nbsp;to&nbsp;getAllCookies():&lt;br&gt;&lt;br&gt;self.getAllCookies(&nbsp;function(cookies)&nbsp;{&nbsp;doSomethingWithCookies(cookies);&nbsp;})&lt;br&gt;&lt;br&gt;When&nbsp;doSomethingWithCookies()&nbsp;is&nbsp;invoked,&nbsp;whatever&nbsp;operation&nbsp;it&nbsp;is&nbsp;performing&nbsp;may&nbsp;fail,&nbsp;because&nbsp;the&nbsp;passed-in&nbsp;value&nbsp;of&nbsp;cookies&nbsp;may&nbsp;still&nbsp;be&nbsp;out&nbsp;of&nbsp;date.&lt;br&gt;<br>
&lt;br&gt;Making&nbsp;getAllCookies()&nbsp;asynchronous&nbsp;means&nbsp;that&nbsp;the&nbsp;trivial&nbsp;fail&nbsp;case:&lt;br&gt;&lt;br&gt;var&nbsp;a&nbsp;=&nbsp;getAllCookies();&lt;br&gt;var&nbsp;b&nbsp;=&nbsp;getAllCookies();&lt;br&gt;assert(a&nbsp;===&nbsp;b);&lt;br&gt;&lt;br&gt;...can&nbsp;no&nbsp;longer&nbsp;fail&nbsp;because&nbsp;there&#39;s&nbsp;no&nbsp;return&nbsp;value.&nbsp;But&nbsp;fundamentally&nbsp;the&nbsp;underlying&nbsp;problem&nbsp;continues&nbsp;to&nbsp;exist&nbsp;-&nbsp;the&nbsp;cookies&nbsp;may&nbsp;have&nbsp;changed&nbsp;behind&nbsp;the&nbsp;scene,&nbsp;so&nbsp;whatever&nbsp;snapshot&nbsp;you&nbsp;have&nbsp;(either&nbsp;delivered&nbsp;synchronously&nbsp;or&nbsp;asynchronously)&nbsp;may&nbsp;be&nbsp;out-of-date.&nbsp;So&nbsp;making&nbsp;getAllCookies()&nbsp;asynchronous&nbsp;does&nbsp;not&nbsp;buy&nbsp;you&nbsp;anything,&nbsp;and&nbsp;additionally&nbsp;makes&nbsp;this&nbsp;API&nbsp;painful&nbsp;to&nbsp;use.&lt;br&gt;<br>
&lt;br&gt;I&nbsp;think&nbsp;it&#39;s&nbsp;a&nbsp;laudable&nbsp;goal&nbsp;to&nbsp;try&nbsp;to&nbsp;shield&nbsp;developers&nbsp;from&nbsp;the&nbsp;intricacies&nbsp;of&nbsp;accessing&nbsp;mutable&nbsp;global&nbsp;state,&nbsp;but&nbsp;I&#39;m&nbsp;not&nbsp;sure&nbsp;that&#39;s&nbsp;possible&nbsp;given&nbsp;that&nbsp;mutable&nbsp;global&nbsp;state&nbsp;exists&nbsp;and&nbsp;we&nbsp;want&nbsp;to&nbsp;allow&nbsp;applications&nbsp;to&nbsp;access&nbsp;it&nbsp;from&nbsp;multiple&nbsp;threads.&nbsp;&lt;br&gt;<br>
&lt;br&gt;As&nbsp;an&nbsp;aside,&nbsp;I&nbsp;wonder&nbsp;how&nbsp;a&nbsp;multi-process&nbsp;browser&nbsp;like&nbsp;Chrome&nbsp;handles&nbsp;cookies&nbsp;even&nbsp;in&nbsp;the&nbsp;absence&nbsp;of&nbsp;workers&nbsp;-&nbsp;if&nbsp;I&nbsp;open&nbsp;two&nbsp;windows&nbsp;(separate&nbsp;processes)&nbsp;under&nbsp;the&nbsp;same&nbsp;domain&nbsp;and&nbsp;set&nbsp;cookies&nbsp;in&nbsp;both,&nbsp;it&nbsp;seems&nbsp;like&nbsp;there&#39;s&nbsp;an&nbsp;existing&nbsp;race&nbsp;condition.&lt;br&gt;<br>
&lt;br&gt;-atw&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
