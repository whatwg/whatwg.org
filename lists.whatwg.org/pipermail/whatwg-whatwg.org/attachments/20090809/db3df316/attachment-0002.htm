<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;DIV&nbsp;dir=ltr&nbsp;id=idOWAReplyText93336&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;As&nbsp;an&nbsp;aside&nbsp;to&nbsp;Chris&nbsp;McCormick's&nbsp;comments,&nbsp;I&nbsp;wonder&nbsp;if&nbsp;it&nbsp;might&nbsp;also&nbsp;be&nbsp;useful/possible/appropriate&nbsp;(or&nbsp;not)&nbsp;to&nbsp;provide&nbsp;access&nbsp;to&nbsp;media&nbsp;data&nbsp;in&nbsp;the&nbsp;way&nbsp;that&nbsp;the&nbsp;ActionScript&nbsp;computeSpectrum&nbsp;function&nbsp;does:&nbsp;&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;A&nbsp;href=&quot;http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/media/SoundMixer.html#computeSpectrum%28%29&quot;&nbsp;target=_blank&gt;&lt;FONT&nbsp;size=2&gt;http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/media/SoundMixer.html#computeSpectrum%28%29&lt;/FONT&gt;&lt;/A&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;Sample&nbsp;visualization&nbsp;using&nbsp;Canvas&nbsp;with&nbsp;computeSpectrum:&nbsp;&lt;/FONT&gt;&lt;A&nbsp;href=&quot;http://www2.nihilogic.dk/labs/canvas_music_visualization/&quot;&nbsp;target=_blank&gt;&lt;FONT&nbsp;size=2&gt;http://www2.nihilogic.dk/labs/canvas_music_visualization/&lt;/FONT&gt;&lt;/A&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;Sam&nbsp;Dutton&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;size=2&gt;----------------------------------------------------------------------&lt;BR&gt;&lt;BR&gt;Message:&nbsp;1&lt;BR&gt;Date:&nbsp;Sun,&nbsp;9&nbsp;Aug&nbsp;2009&nbsp;11:16:01&nbsp;+1000&lt;BR&gt;From:&nbsp;Silvia&nbsp;Pfeiffer&nbsp;&lt;silviapfeiffer1@gmail.com&gt;&lt;BR&gt;Subject:&nbsp;Re:&nbsp;[whatwg]&nbsp;Codecs&nbsp;for&nbsp;&lt;audio&gt;&nbsp;and&nbsp;&lt;video&gt;&lt;BR&gt;To:&nbsp;Chris&nbsp;McCormick&nbsp;&lt;chris@mccormick.cx&gt;&lt;BR&gt;Cc:&nbsp;whatwg@lists.whatwg.org&lt;BR&gt;Message-ID:&lt;BR&gt;&lt;2c0e02830908081816v74711d64ya72c8cc11550baa4@mail.gmail.com&gt;&lt;BR&gt;Content-Type:&nbsp;text/plain;&nbsp;charset=ISO-8859-1&lt;BR&gt;&lt;BR&gt;On&nbsp;Sun,&nbsp;Aug&nbsp;9,&nbsp;2009&nbsp;at&nbsp;3:15&nbsp;AM,&nbsp;Chris&nbsp;McCormick&lt;chris@mccormick.cx&gt;&nbsp;wrote:&lt;BR&gt;&gt;&nbsp;On&nbsp;Wed,&nbsp;Jul&nbsp;08,&nbsp;2009&nbsp;at&nbsp;09:24:42AM&nbsp;-0700,&nbsp;Charles&nbsp;Pritchard&nbsp;wrote:&lt;BR&gt;&gt;&gt;&nbsp;There&nbsp;are&nbsp;two&nbsp;use&nbsp;cases&nbsp;that&nbsp;I&nbsp;think&nbsp;are&nbsp;important:&nbsp;a&nbsp;codec&lt;BR&gt;&gt;&gt;&nbsp;implementation&nbsp;(let's&nbsp;use&nbsp;Vorbis),&lt;BR&gt;&gt;&gt;&nbsp;and&nbsp;an&nbsp;accessibility&nbsp;implementation,&nbsp;working&nbsp;with&nbsp;a&nbsp;&lt;canvas&gt;&nbsp;element.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;Here&nbsp;are&nbsp;a&nbsp;few&nbsp;more&nbsp;use-cases&nbsp;that&nbsp;many&nbsp;people&nbsp;would&nbsp;consider&nbsp;just&nbsp;as&lt;BR&gt;&gt;&nbsp;important:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;*&nbsp;Browser&nbsp;based&nbsp;music&nbsp;software&nbsp;and&nbsp;synthesis&nbsp;toys.&lt;BR&gt;&gt;&nbsp;*&nbsp;New&nbsp;types&nbsp;of&nbsp;'algorithmic'&nbsp;music&nbsp;like&nbsp;that&nbsp;pioneered&nbsp;by&nbsp;Brian&nbsp;Eno.&lt;BR&gt;&gt;&nbsp;*&nbsp;Browser&nbsp;based&nbsp;games&nbsp;which&nbsp;want&nbsp;to&nbsp;use&nbsp;procedural&nbsp;audio&nbsp;instead&nbsp;of&lt;BR&gt;&gt;&nbsp;pre-rendered&nbsp;sound&nbsp;effects.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;I'd&nbsp;like&nbsp;to&nbsp;reiterate&nbsp;the&nbsp;previously&nbsp;expressed&nbsp;sentiment&nbsp;that&nbsp;only&nbsp;implementing&lt;BR&gt;&gt;&nbsp;pre-rendered&nbsp;audio&nbsp;playback&nbsp;is&nbsp;like&nbsp;having&nbsp;a&nbsp;browser&nbsp;that&nbsp;only&nbsp;supports&nbsp;static&lt;BR&gt;&gt;&nbsp;images&nbsp;loaded&nbsp;from&nbsp;the&nbsp;server&nbsp;instead&nbsp;of&nbsp;animations&nbsp;and&nbsp;&lt;canvas&gt;&nbsp;tags.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;What&nbsp;is&nbsp;really&nbsp;needed&nbsp;is&nbsp;a&nbsp;DSP&nbsp;vector&nbsp;processor&nbsp;which&nbsp;runs&nbsp;outside&nbsp;of&nbsp;ECMA&lt;BR&gt;&gt;&nbsp;script,&nbsp;but&nbsp;with&nbsp;a&nbsp;good&nbsp;API&nbsp;so&nbsp;that&nbsp;the&nbsp;ECMAscripts&nbsp;can&nbsp;talk&nbsp;to&nbsp;it&nbsp;directly.&lt;BR&gt;&gt;&nbsp;Examples&nbsp;of&nbsp;reference&nbsp;software,&nbsp;mostly&nbsp;open&nbsp;source,&nbsp;which&nbsp;do&nbsp;this&nbsp;type&nbsp;of&nbsp;thing&lt;BR&gt;&gt;&nbsp;follow:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;*&nbsp;Csound&lt;BR&gt;&gt;&nbsp;*&nbsp;Supercollider&lt;BR&gt;&gt;&nbsp;*&nbsp;Pure&nbsp;Data&lt;BR&gt;&gt;&nbsp;*&nbsp;Nyquist&lt;BR&gt;&gt;&nbsp;*&nbsp;Chuck&lt;BR&gt;&gt;&nbsp;*&nbsp;Steinberg&nbsp;VSTs&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;I&nbsp;am&nbsp;going&nbsp;to&nbsp;use&nbsp;the&nbsp;terms&nbsp;&quot;signal&nbsp;vector&quot;,&nbsp;&quot;audio&nbsp;buffer&quot;,&nbsp;and&nbsp;&quot;array&quot;&lt;BR&gt;&gt;&nbsp;interchangeably&nbsp;below.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;Four&nbsp;major&nbsp;types&nbsp;of&nbsp;synthesis&nbsp;would&nbsp;be&nbsp;useful,&nbsp;but&nbsp;they&nbsp;are&nbsp;pretty&nbsp;much&lt;BR&gt;&gt;&nbsp;isomorphic,&nbsp;so&nbsp;any&nbsp;one&nbsp;of&nbsp;them&nbsp;could&nbsp;be&nbsp;implemented&nbsp;as&nbsp;a&nbsp;base-line:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;*&nbsp;Wavetable&nbsp;(implement&nbsp;vector&nbsp;write/read/lookup&nbsp;operators)&lt;BR&gt;&gt;&nbsp;*&nbsp;FM&nbsp;&amp;&nbsp;AM&nbsp;(implement&nbsp;vector&nbsp;+&nbsp;and&nbsp;*&nbsp;operators)&lt;BR&gt;&gt;&nbsp;*&nbsp;Subtractive&nbsp;(implement&nbsp;unit&nbsp;delay&nbsp;from&nbsp;which&nbsp;you&nbsp;can&nbsp;build&nbsp;filters)&lt;BR&gt;&gt;&nbsp;*&nbsp;Frequency&nbsp;domain&nbsp;(implemnt&nbsp;FFT&nbsp;and&nbsp;back&nbsp;again)&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;Of&nbsp;these,&nbsp;I&nbsp;feel&nbsp;that&nbsp;wavetable&nbsp;synthesis&nbsp;should&nbsp;be&nbsp;the&nbsp;first&nbsp;type&nbsp;of&nbsp;synthesis&lt;BR&gt;&gt;&nbsp;to&nbsp;be&nbsp;implemented,&nbsp;since&nbsp;most&nbsp;of&nbsp;the&nbsp;code&nbsp;for&nbsp;manipulating&nbsp;audio&nbsp;buffers&nbsp;is&lt;BR&gt;&gt;&nbsp;already&nbsp;going&nbsp;to&nbsp;be&nbsp;in&nbsp;the&nbsp;browsers&nbsp;and&nbsp;exposing&nbsp;those&nbsp;buffers&nbsp;shouldn't&nbsp;be&lt;BR&gt;&gt;&nbsp;hugely&nbsp;difficult.&nbsp;Basically&nbsp;what&nbsp;this&nbsp;would&nbsp;take&nbsp;is&nbsp;ensuring&nbsp;some&nbsp;things&nbsp;about&lt;BR&gt;&gt;&nbsp;the&nbsp;audio&nbsp;tag:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;*&nbsp;Supports&nbsp;playback&nbsp;of&nbsp;arbitrarily&nbsp;small&nbsp;buffers.&lt;BR&gt;&gt;&nbsp;*&nbsp;Seamlessly&nbsp;loops&nbsp;those&nbsp;small&nbsp;buffers.&lt;BR&gt;&gt;&nbsp;*&nbsp;Allows&nbsp;read/write&nbsp;access&nbsp;to&nbsp;those&nbsp;buffers&nbsp;from&nbsp;ECMAscript.&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;Given&nbsp;the&nbsp;above,&nbsp;the&nbsp;other&nbsp;types&nbsp;of&nbsp;synthesis&nbsp;are&nbsp;possible,&nbsp;albeit&nbsp;slowly.&nbsp;For&lt;BR&gt;&gt;&nbsp;example,&nbsp;FM&nbsp;&amp;&nbsp;AM&nbsp;synthesis&nbsp;are&nbsp;possible&nbsp;by&nbsp;adding&nbsp;adding/multiplying&nbsp;vectors&nbsp;of&lt;BR&gt;&gt;&nbsp;sine&nbsp;data&nbsp;together&nbsp;into&nbsp;a&nbsp;currently&nbsp;looping&nbsp;audio&nbsp;buffer.&nbsp;Subtractive&nbsp;synthesis&lt;BR&gt;&gt;&nbsp;is&nbsp;possible&nbsp;by&nbsp;adding&nbsp;delayed&nbsp;versions&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;the&nbsp;buffer&nbsp;to&nbsp;itself.&lt;BR&gt;&gt;&nbsp;Frequency&nbsp;domain&nbsp;synthesis&nbsp;is&nbsp;possible&nbsp;by&nbsp;analysing&nbsp;the&nbsp;data&nbsp;in&nbsp;the&nbsp;buffer&nbsp;with&lt;BR&gt;&gt;&nbsp;FFT&nbsp;(and&nbsp;reverse&nbsp;FFT)&nbsp;and&nbsp;writing&nbsp;back&nbsp;new&nbsp;data.&nbsp;I&nbsp;see&nbsp;this&nbsp;API&nbsp;as&nbsp;working&nbsp;as&lt;BR&gt;&gt;&nbsp;previously&nbsp;posted,&nbsp;by&nbsp;Charles&nbsp;Prichard,&nbsp;but&nbsp;with&nbsp;the&nbsp;following&nbsp;extra&lt;BR&gt;&gt;&nbsp;possibility:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;&lt;audio&nbsp;id='mybuffer'&gt;&lt;BR&gt;&gt;&nbsp;buffer&nbsp;=&nbsp;document.getElementById(&quot;mybuffer&quot;);&lt;BR&gt;&gt;&nbsp;//&nbsp;here&nbsp;myfunc&nbsp;is&nbsp;a&nbsp;function&nbsp;which&nbsp;will&nbsp;change&lt;BR&gt;&gt;&nbsp;//&nbsp;the&nbsp;audio&nbsp;buffer&nbsp;each&nbsp;time&nbsp;the&nbsp;buffer&nbsp;loops&lt;BR&gt;&gt;&nbsp;buffer.loopCallback&nbsp;=&nbsp;myfunc;&lt;BR&gt;&gt;&nbsp;buffer.loop&nbsp;=&nbsp;True;&lt;BR&gt;&gt;&nbsp;buffer.play();&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;Of&nbsp;course,&nbsp;the&nbsp;ECMA&nbsp;script&nbsp;is&nbsp;probably&nbsp;going&nbsp;to&nbsp;be&nbsp;too&nbsp;slow&nbsp;in&nbsp;the&nbsp;short&nbsp;term,&lt;BR&gt;&gt;&nbsp;so&nbsp;moving&nbsp;forward&nbsp;it&nbsp;would&nbsp;be&nbsp;great&nbsp;if&nbsp;there&nbsp;was&nbsp;a&nbsp;library/API&nbsp;which&nbsp;can&nbsp;do&nbsp;the&lt;BR&gt;&gt;&nbsp;following&nbsp;vector&nbsp;operations&nbsp;in&nbsp;the&nbsp;background&nbsp;at&nbsp;a&nbsp;speed&nbsp;faster&nbsp;than&nbsp;doing&nbsp;them&lt;BR&gt;&gt;&nbsp;directly,&nbsp;element&nbsp;by&nbsp;element&nbsp;inside&nbsp;ECMAscript&nbsp;(a&nbsp;bit&nbsp;like&nbsp;Python's&nbsp;Numeric&lt;BR&gt;&gt;&nbsp;module).&nbsp;All&nbsp;inputs&nbsp;and&nbsp;outputs&nbsp;are&nbsp;signal&nbsp;vectors/audio&nbsp;tag&nbsp;buffers:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;*&nbsp;+&nbsp;-&nbsp;add&nbsp;two&nbsp;signal&nbsp;vectors&nbsp;(2&nbsp;input,&nbsp;1&nbsp;output)&lt;BR&gt;&gt;&nbsp;*&nbsp;*&nbsp;-&nbsp;multiply&nbsp;two&nbsp;signal&nbsp;vectors&nbsp;(2&nbsp;input,&nbsp;1&nbsp;output)&lt;BR&gt;&gt;&nbsp;*&nbsp;z&nbsp;-&nbsp;delay&nbsp;a&nbsp;signal&nbsp;vector&nbsp;with&nbsp;customisable&nbsp;sample&nbsp;length&nbsp;(2&nbsp;input,&nbsp;1&nbsp;output)&lt;BR&gt;&gt;&nbsp;*&nbsp;read&nbsp;-&nbsp;do&nbsp;a&nbsp;table&nbsp;lookup&nbsp;(1&nbsp;input,&nbsp;1&nbsp;output)&lt;BR&gt;&gt;&nbsp;*&nbsp;write&nbsp;-&nbsp;do&nbsp;a&nbsp;table&nbsp;write&nbsp;(2&nbsp;input,&nbsp;1&nbsp;output)&lt;BR&gt;&gt;&nbsp;*&nbsp;copy&nbsp;-&nbsp;memcpy&nbsp;a&nbsp;signal&nbsp;vector&nbsp;(1&nbsp;input,&nbsp;1&nbsp;output)&lt;BR&gt;&gt;&nbsp;*&nbsp;fft&nbsp;do&nbsp;a&nbsp;fast&nbsp;fourier&nbsp;transform&nbsp;-&nbsp;(1&nbsp;input,&nbsp;2&nbsp;output)&lt;BR&gt;&gt;&nbsp;*&nbsp;rfft&nbsp;do&nbsp;a&nbsp;reverse&nbsp;fast&nbsp;fourier&nbsp;transform&nbsp;-&nbsp;(2&nbsp;inputs,&nbsp;1&nbsp;output)&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;It&nbsp;would&nbsp;be&nbsp;so&nbsp;great&nbsp;if&nbsp;it&nbsp;was&nbsp;possible&nbsp;to&nbsp;unify&nbsp;the&nbsp;above&nbsp;into&nbsp;an&nbsp;API&nbsp;that&lt;BR&gt;&gt;&nbsp;looked&nbsp;and&nbsp;worked&nbsp;something&nbsp;like&nbsp;this:&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;&lt;audio&nbsp;id='mybuffer'&gt;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;outbuffer&nbsp;=&nbsp;document.getElementById(&quot;mybuffer&quot;);&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;b&nbsp;=&nbsp;new&nbsp;AudioBuffer(64)&lt;BR&gt;&gt;&nbsp;for&nbsp;(x=0;&nbsp;x&lt;64;&nbsp;x++)&lt;BR&gt;&gt;&nbsp;?&nbsp;?&nbsp;?&nbsp;?b[x]&nbsp;=&nbsp;Math.sin(x&nbsp;/&nbsp;64&nbsp;*&nbsp;Math.PI)a;&lt;BR&gt;&gt;&lt;BR&gt;&gt;&nbsp;//&nbsp;inside&nbsp;the&nbsp;loopCallback&nbsp;do&nbsp;a&nbsp;vector&nbsp;multiplication&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;our&nbsp;buffer&lt;BR&gt;&gt;&nbsp;//&nbsp;with&nbsp;a&nbsp;sine&nbsp;wave&nbsp;we&nbsp;created&nbsp;earlier.&lt;BR&gt;&gt;&nbsp;outbuffer.multiply(b);&lt;BR&gt;&gt;&lt;BR&gt;&lt;BR&gt;Why&nbsp;don't&nbsp;you&nbsp;just&nbsp;implement&nbsp;an&nbsp;example&nbsp;in&nbsp;javascript&nbsp;to&nbsp;show&nbsp;off&nbsp;what&lt;BR&gt;you're&nbsp;talking&nbsp;about&nbsp;and&nbsp;make&nbsp;a&nbsp;use&nbsp;case&nbsp;for&nbsp;having&nbsp;it&nbsp;implemented&lt;BR&gt;inside&nbsp;the&nbsp;browsers?&lt;BR&gt;&lt;BR&gt;Cheers,&lt;BR&gt;Silvia,&lt;BR&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;br/&gt;&lt;font&nbsp;face=&quot;Times&nbsp;New&nbsp;Roman&quot;&nbsp;size=&quot;3&quot;&gt;&lt;a&nbsp;href=&quot;http://www.bbc.co.uk&quot;&gt;http://www.bbc.co.uk&lt;/a&gt;&lt;br/&gt;This&nbsp;e-mail&nbsp;(and&nbsp;any&nbsp;attachments)&nbsp;is&nbsp;confidential&nbsp;and&nbsp;may&nbsp;contain&nbsp;personal&nbsp;views&nbsp;which&nbsp;are&nbsp;not&nbsp;the&nbsp;views&nbsp;of&nbsp;the&nbsp;BBC&nbsp;unless&nbsp;specifically&nbsp;stated.&lt;br/&gt;If&nbsp;you&nbsp;have&nbsp;received&nbsp;it&nbsp;in&nbsp;error,&nbsp;please&nbsp;delete&nbsp;it&nbsp;from&nbsp;your&nbsp;system.&lt;br/&gt;Do&nbsp;not&nbsp;use,&nbsp;copy&nbsp;or&nbsp;disclose&nbsp;the&nbsp;information&nbsp;in&nbsp;any&nbsp;way&nbsp;nor&nbsp;act&nbsp;in&nbsp;reliance&nbsp;on&nbsp;it&nbsp;and&nbsp;notify&nbsp;the&nbsp;sender&nbsp;immediately.&lt;br/&gt;Please&nbsp;note&nbsp;that&nbsp;the&nbsp;BBC&nbsp;monitors&nbsp;e-mails&nbsp;sent&nbsp;or&nbsp;received.&lt;br/&gt;Further&nbsp;communication&nbsp;will&nbsp;signify&nbsp;your&nbsp;consent&nbsp;to&nbsp;this.&lt;/font&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>
<br>

</tt>
