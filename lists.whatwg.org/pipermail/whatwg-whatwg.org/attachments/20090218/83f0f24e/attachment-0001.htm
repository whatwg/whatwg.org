<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Ian&nbsp;Hickson&nbsp;wrote,&nbsp;On&nbsp;18/02/2009&nbsp;12.43:<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;3)&nbsp;Add&nbsp;an&nbsp;on-by-default&nbsp;mechanism&nbsp;that&nbsp;prevents&nbsp;UI&nbsp;actions&nbsp;to&nbsp;be&nbsp;taken<br>
&nbsp;&nbsp;&nbsp;when&nbsp;a&nbsp;document&nbsp;tries&nbsp;to&nbsp;obstruct&nbsp;portions&nbsp;of&nbsp;a&nbsp;non-same-origin&nbsp;frame.<br>
&nbsp;&nbsp;&nbsp;By&nbsp;carefully&nbsp;designing&nbsp;the&nbsp;mechanism,&nbsp;we&nbsp;can&nbsp;prevent&nbsp;legitimate&nbsp;uses<br>
&nbsp;&nbsp;&nbsp;(such&nbsp;as&nbsp;dynamic&nbsp;menus&nbsp;that&nbsp;overlap&nbsp;with&nbsp;advertisements,&nbsp;gadgets,&nbsp;etc)<br>
&nbsp;&nbsp;&nbsp;from&nbsp;being&nbsp;affected,&nbsp;yet&nbsp;achieve&nbsp;a&nbsp;high&nbsp;reliability&nbsp;in&nbsp;stopping<br>
&nbsp;&nbsp;&nbsp;attacks.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;seems&nbsp;difficult&nbsp;to&nbsp;get&nbsp;right&nbsp;in&nbsp;practice,&nbsp;and&nbsp;browser&nbsp;vendors&nbsp;seem&nbsp;<br>
reluctant&nbsp;to&nbsp;go&nbsp;down&nbsp;this&nbsp;road.&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
Incidentally,&nbsp;NoScript's&nbsp;ClearClick&nbsp;is&nbsp;a&nbsp;working&nbsp;implementation&nbsp;of&nbsp;this<br>
&quot;difficult&quot;&nbsp;approach,&nbsp;effective&nbsp;also&nbsp;with&nbsp;same-origin&nbsp;plugin&nbsp;content<br>
(like&nbsp;in&nbsp;the&nbsp;original&nbsp;Clickjacking&nbsp;PoC&nbsp;by&nbsp;RSnake&nbsp;&amp;&nbsp;Grossman).&lt;br&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://noscript.net/faq#clearclick&quot;&gt;http://noscript.net/faq#clearclick&lt;/a&gt;&lt;br&gt;<br>
--&nbsp;G&lt;br&gt;<br>
&lt;br&gt;<br>
Ian&nbsp;Hickson&nbsp;wrote,&nbsp;On&nbsp;18/02/2009&nbsp;12.43:<br>
&lt;blockquote<br>
&nbsp;cite=&quot;mid:Pine.LNX.4.62.0902180538490.6209@hixie.dreamhostps.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;On&nbsp;Thu,&nbsp;25&nbsp;Sep&nbsp;2008,&nbsp;Michal&nbsp;Zalewski&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Problem&nbsp;definition:&nbsp;a&nbsp;malicious&nbsp;page&nbsp;in&nbsp;domain&nbsp;A&nbsp;may&nbsp;create&nbsp;an&nbsp;IFRAME&nbsp;<br>
pointing&nbsp;to&nbsp;an&nbsp;application&nbsp;in&nbsp;domain&nbsp;B,&nbsp;to&nbsp;which&nbsp;the&nbsp;user&nbsp;is&nbsp;currently&nbsp;<br>
authenticated&nbsp;with&nbsp;cookies.&nbsp;The&nbsp;top-level&nbsp;page&nbsp;may&nbsp;then&nbsp;cover&nbsp;portions&nbsp;<br>
of&nbsp;the&nbsp;IFRAME&nbsp;with&nbsp;other&nbsp;visual&nbsp;elements&nbsp;to&nbsp;seamlessly&nbsp;hide&nbsp;everything&nbsp;<br>
but&nbsp;a&nbsp;single&nbsp;UI&nbsp;button&nbsp;in&nbsp;domain&nbsp;B,&nbsp;such&nbsp;as&nbsp;&quot;delete&nbsp;all&nbsp;items&quot;,&nbsp;&quot;click&nbsp;<br>
to&nbsp;add&nbsp;Bob&nbsp;as&nbsp;a&nbsp;friend&quot;,&nbsp;etc.&nbsp;It&nbsp;may&nbsp;then&nbsp;provide&nbsp;own,&nbsp;misleading&nbsp;UI&nbsp;<br>
that&nbsp;implies&nbsp;that&nbsp;the&nbsp;button&nbsp;serves&nbsp;a&nbsp;different&nbsp;purpose&nbsp;and&nbsp;is&nbsp;a&nbsp;part&nbsp;of&nbsp;<br>
site&nbsp;A,&nbsp;inviting&nbsp;the&nbsp;user&nbsp;to&nbsp;click&nbsp;it.&nbsp;Although&nbsp;the&nbsp;examples&nbsp;above&nbsp;are&nbsp;<br>
naive,&nbsp;this&nbsp;is&nbsp;clearly&nbsp;a&nbsp;problem&nbsp;for&nbsp;a&nbsp;good&nbsp;number&nbsp;of&nbsp;modern,&nbsp;complex&nbsp;<br>
web&nbsp;applications.<br>
<br>
Proposed&nbsp;fixes:<br>
<br>
1)&nbsp;Create&nbsp;a&nbsp;HTTP-level&nbsp;(or&nbsp;HTTP-EQUIV)&nbsp;mechanism&nbsp;along&nbsp;the&nbsp;lines&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&quot;X-I-Do-Not-Want-To-Be-Framed-Across-Domains:&nbsp;yes&quot;&nbsp;that&nbsp;permits&nbsp;a&nbsp;web<br>
&nbsp;&nbsp;&nbsp;page&nbsp;to&nbsp;inhibit&nbsp;frame&nbsp;rendering&nbsp;in&nbsp;potentially&nbsp;dangerous&nbsp;situations.<br>
<br>
&nbsp;&nbsp;&nbsp;Pros:<br>
<br>
&nbsp;&nbsp;&nbsp;-&nbsp;Super-simple<br>
<br>
&nbsp;&nbsp;&nbsp;Cons:<br>
<br>
&nbsp;&nbsp;&nbsp;-&nbsp;&quot;Opt-in&quot;,&nbsp;i.e.&nbsp;currently&nbsp;vulnerable&nbsp;sites&nbsp;remain&nbsp;vulnerable&nbsp;unless<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;action&nbsp;is&nbsp;taken<br>
<br>
&nbsp;&nbsp;&nbsp;-&nbsp;Can't&nbsp;be&nbsp;used&nbsp;for&nbsp;cases&nbsp;where&nbsp;IFRAME&nbsp;content&nbsp;mixing&nbsp;has&nbsp;a&nbsp;legitimate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purpose&nbsp;(for&nbsp;example,&nbsp;cross-domain&nbsp;gadgets,&nbsp;certain&nbsp;types&nbsp;of&nbsp;mashups)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
In&nbsp;particular,&nbsp;this&nbsp;breaks&nbsp;Image&nbsp;Search&nbsp;tools&nbsp;from&nbsp;various&nbsp;vendors&nbsp;as&nbsp;well&nbsp;<br>
as&nbsp;navigation&nbsp;aids&nbsp;like&nbsp;the&nbsp;Reddit&nbsp;toolbar.<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;-&nbsp;Adds&nbsp;yet&nbsp;another&nbsp;security&nbsp;measure&nbsp;(along&nbsp;with&nbsp;cross-domain&nbsp;XHR,&nbsp;MSIE8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSS&nbsp;filters,&nbsp;MSIE&nbsp;P3P&nbsp;cookie&nbsp;behavior,&nbsp;Mozilla&nbsp;security&nbsp;policies)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;employed&nbsp;correctly&nbsp;everywhere&nbsp;to&nbsp;work&nbsp;-&nbsp;which&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;very&nbsp;unlikely&nbsp;to&nbsp;consistently&nbsp;happen&nbsp;in&nbsp;practice<br>
<br>
&nbsp;&nbsp;&nbsp;-&nbsp;Along&nbsp;with&nbsp;the&nbsp;aforementioned&nbsp;security&nbsp;features,&nbsp;threatens&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;in&nbsp;HTTP&nbsp;header&nbsp;or&nbsp;HTML&nbsp;HTTP-EQUIV&nbsp;size&nbsp;bloat&nbsp;that&nbsp;some&nbsp;sites<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;care&nbsp;about.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;solution&nbsp;is&nbsp;what&nbsp;IE8&nbsp;has&nbsp;apparently&nbsp;chosen&nbsp;to&nbsp;use.<br>
<br>
Specifically,&nbsp;IE8&nbsp;will&nbsp;recognise&nbsp;an&nbsp;HTTP&nbsp;header&nbsp;or&nbsp;&lt;meta&gt;&nbsp;pragma&nbsp;directive&nbsp;<br>
with&nbsp;the&nbsp;name&nbsp;&quot;X-Frame-Options&quot;,&nbsp;and&nbsp;will&nbsp;process&nbsp;it&nbsp;as&nbsp;follows:<br>
<br>
&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;value&nbsp;is&nbsp;a&nbsp;case-insensitive&nbsp;match&nbsp;for&nbsp;&quot;deny&quot;&nbsp;and&nbsp;the&nbsp;browsing&nbsp;<br>
&nbsp;&nbsp;&nbsp;context&nbsp;being&nbsp;navigated&nbsp;is&nbsp;not&nbsp;a&nbsp;top-level&nbsp;browsing&nbsp;context,&nbsp;replace&nbsp;<br>
&nbsp;&nbsp;&nbsp;the&nbsp;document&nbsp;with&nbsp;a&nbsp;UA-defined&nbsp;error&nbsp;message.<br>
<br>
&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;value&nbsp;is&nbsp;a&nbsp;case-insensitive&nbsp;match&nbsp;for&nbsp;&quot;sameorigin&quot;&nbsp;and&nbsp;the<br>
&nbsp;&nbsp;&nbsp;browsing&nbsp;context&nbsp;being&nbsp;navigated&nbsp;is&nbsp;not&nbsp;a&nbsp;top-level&nbsp;browsing&nbsp;context&nbsp;<br>
&nbsp;&nbsp;&nbsp;and&nbsp;the&nbsp;origin&nbsp;of&nbsp;the&nbsp;top-level&nbsp;browsing&nbsp;context&nbsp;is&nbsp;not&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;<br>
&nbsp;&nbsp;&nbsp;origin&nbsp;of&nbsp;the&nbsp;document&nbsp;in&nbsp;question,&nbsp;replace&nbsp;the&nbsp;document&nbsp;with&nbsp;a&nbsp;<br>
&nbsp;&nbsp;&nbsp;UA-defined&nbsp;error&nbsp;message.<br>
<br>
(The&nbsp;&quot;sameorigin&quot;&nbsp;rule&nbsp;seems&nbsp;like&nbsp;it&nbsp;should&nbsp;check&nbsp;all&nbsp;ancestor&nbsp;browsing&nbsp;<br>
contexts,&nbsp;not&nbsp;just&nbsp;the&nbsp;top-level&nbsp;one,&nbsp;because&nbsp;otherwise&nbsp;a&nbsp;site&nbsp;X,&nbsp;e.g.&nbsp;<br>
images.google.com,&nbsp;showing&nbsp;a&nbsp;frame&nbsp;with&nbsp;a&nbsp;document&nbsp;on&nbsp;site&nbsp;Y,&nbsp;e.g.&nbsp;<br>
hostile.example.com&nbsp;--&nbsp;which&nbsp;might&nbsp;happen&nbsp;e.g.&nbsp;on&nbsp;something&nbsp;like&nbsp;Google&nbsp;<br>
Image&nbsp;Search&nbsp;--&nbsp;would&nbsp;be&nbsp;able&nbsp;to&nbsp;embed&nbsp;another&nbsp;page&nbsp;from&nbsp;site&nbsp;X,&nbsp;e.g.&nbsp;your&nbsp;<br>
image&nbsp;search&nbsp;preferences,&nbsp;and&nbsp;do&nbsp;clickjacking&nbsp;on&nbsp;it.)<br>
<br>
This&nbsp;feature&nbsp;could&nbsp;also&nbsp;be&nbsp;extended&nbsp;to&nbsp;apply&nbsp;to&nbsp;other&nbsp;resources,&nbsp;e.g.&nbsp;<br>
scripts,&nbsp;images,&nbsp;style&nbsp;sheets,&nbsp;fonts,&nbsp;to&nbsp;prevent&nbsp;them&nbsp;from&nbsp;being&nbsp;used&nbsp;<br>
cross-origin.&nbsp;This&nbsp;would&nbsp;help,&nbsp;e.g.,&nbsp;with&nbsp;securing&nbsp;scripts&nbsp;that&nbsp;contain&nbsp;<br>
private&nbsp;data.<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;2)&nbsp;Add&nbsp;a&nbsp;document-level&nbsp;mechanism&nbsp;to&nbsp;make&nbsp;&quot;if&nbsp;nested&nbsp;&lt;show&nbsp;this&gt;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;&lt;show&nbsp;that&gt;&quot;&nbsp;conditionals&nbsp;possible&nbsp;without&nbsp;Javascript.&nbsp;One&nbsp;proposal&nbsp;is<br>
&nbsp;&nbsp;&nbsp;to&nbsp;do&nbsp;this&nbsp;on&nbsp;the&nbsp;level&nbsp;of&nbsp;CSS&nbsp;(by&nbsp;using&nbsp;either&nbsp;the&nbsp;media-dependency<br>
&nbsp;&nbsp;&nbsp;features&nbsp;of&nbsp;CSS&nbsp;or&nbsp;special&nbsp;classes);&nbsp;another&nbsp;is&nbsp;to&nbsp;introduce&nbsp;new&nbsp;HTML<br>
&nbsp;&nbsp;&nbsp;tags.&nbsp;This&nbsp;would&nbsp;make&nbsp;it&nbsp;possible&nbsp;for&nbsp;pages&nbsp;to&nbsp;defend&nbsp;themselves&nbsp;even<br>
&nbsp;&nbsp;&nbsp;in&nbsp;environments&nbsp;where&nbsp;Javascript&nbsp;is&nbsp;disabled&nbsp;or&nbsp;limited.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;is&nbsp;an&nbsp;interesting&nbsp;idea,&nbsp;though&nbsp;it&nbsp;would&nbsp;be&nbsp;subsumed&nbsp;by&nbsp;Hallvord's&nbsp;<br>
suggestion&nbsp;with&nbsp;Origin&nbsp;given&nbsp;below,&nbsp;in&nbsp;conjunction&nbsp;with&nbsp;idea&nbsp;1&nbsp;above&nbsp;in&nbsp;<br>
the&nbsp;absence&nbsp;of&nbsp;Origin&nbsp;information.<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;3)&nbsp;Add&nbsp;an&nbsp;on-by-default&nbsp;mechanism&nbsp;that&nbsp;prevents&nbsp;UI&nbsp;actions&nbsp;to&nbsp;be&nbsp;taken<br>
&nbsp;&nbsp;&nbsp;when&nbsp;a&nbsp;document&nbsp;tries&nbsp;to&nbsp;obstruct&nbsp;portions&nbsp;of&nbsp;a&nbsp;non-same-origin&nbsp;frame.<br>
&nbsp;&nbsp;&nbsp;By&nbsp;carefully&nbsp;designing&nbsp;the&nbsp;mechanism,&nbsp;we&nbsp;can&nbsp;prevent&nbsp;legitimate&nbsp;uses<br>
&nbsp;&nbsp;&nbsp;(such&nbsp;as&nbsp;dynamic&nbsp;menus&nbsp;that&nbsp;overlap&nbsp;with&nbsp;advertisements,&nbsp;gadgets,&nbsp;etc)<br>
&nbsp;&nbsp;&nbsp;from&nbsp;being&nbsp;affected,&nbsp;yet&nbsp;achieve&nbsp;a&nbsp;high&nbsp;reliability&nbsp;in&nbsp;stopping<br>
&nbsp;&nbsp;&nbsp;attacks.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;seems&nbsp;difficult&nbsp;to&nbsp;get&nbsp;right&nbsp;in&nbsp;practice,&nbsp;and&nbsp;browser&nbsp;vendors&nbsp;seem&nbsp;<br>
reluctant&nbsp;to&nbsp;go&nbsp;down&nbsp;this&nbsp;road.<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;4)&nbsp;Enforce&nbsp;a&nbsp;click-to-work&nbsp;mechanism&nbsp;(resembling&nbsp;the&nbsp;Eolas&nbsp;patent<br>
&nbsp;&nbsp;&nbsp;workaround)&nbsp;for&nbsp;all&nbsp;cross-domain&nbsp;IFRAMEs.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Experience&nbsp;with&nbsp;the&nbsp;Eolas&nbsp;patent&nbsp;workaround&nbsp;suggests&nbsp;this&nbsp;wouldn't&nbsp;be&nbsp;<br>
popular,&nbsp;to&nbsp;put&nbsp;in&nbsp;mildly.<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;5)&nbsp;Rework&nbsp;everything&nbsp;we&nbsp;know&nbsp;about&nbsp;HTML&nbsp;/&nbsp;browser&nbsp;security&nbsp;models&nbsp;to<br>
&nbsp;&nbsp;&nbsp;make&nbsp;it&nbsp;possible&nbsp;for&nbsp;domains&nbsp;and&nbsp;pages&nbsp;to&nbsp;specify&nbsp;very&nbsp;specific&nbsp;opt-in<br>
&nbsp;&nbsp;&nbsp;/&nbsp;opt-out&nbsp;policies&nbsp;for&nbsp;all&nbsp;types&nbsp;of&nbsp;linking,&nbsp;referencing,&nbsp;such&nbsp;that<br>
&nbsp;&nbsp;&nbsp;countering&nbsp;UI&nbsp;redress&nbsp;attacks&nbsp;would&nbsp;be&nbsp;just&nbsp;one&nbsp;of&nbsp;the&nbsp;cases&nbsp;controlled<br>
&nbsp;&nbsp;&nbsp;by&nbsp;this&nbsp;mechanism.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;seems&nbsp;like&nbsp;it&nbsp;would&nbsp;still&nbsp;basically&nbsp;need&nbsp;one&nbsp;of&nbsp;the&nbsp;other&nbsp;mechanisms&nbsp;<br>
as&nbsp;well.&nbsp;Without&nbsp;a&nbsp;more&nbsp;concrete&nbsp;proposal&nbsp;here&nbsp;it's&nbsp;hard&nbsp;to&nbsp;tell&nbsp;what&nbsp;<br>
exactly&nbsp;this&nbsp;would&nbsp;be.<br>
<br>
<br>
On&nbsp;Thu,&nbsp;25&nbsp;Sep&nbsp;2008,&nbsp;Collin&nbsp;Jackson&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;6)&nbsp;New&nbsp;cookie&nbsp;attribute:&nbsp;The&nbsp;&quot;httpOnly&quot;&nbsp;cookie&nbsp;flag&nbsp;allows&nbsp;sites&nbsp;to&nbsp;put&nbsp;<br>
restrictions&nbsp;on&nbsp;how&nbsp;a&nbsp;cookie&nbsp;can&nbsp;be&nbsp;accessed.&nbsp;We&nbsp;could&nbsp;allow&nbsp;a&nbsp;new&nbsp;flag&nbsp;<br>
to&nbsp;be&nbsp;specified&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;that&nbsp;is&nbsp;designed&nbsp;to&nbsp;prevent&nbsp;<br>
CSRF&nbsp;and&nbsp;&quot;UI&nbsp;redress&quot;&nbsp;attacks.&nbsp;If&nbsp;a&nbsp;cookie&nbsp;is&nbsp;set&nbsp;with&nbsp;a&nbsp;&quot;sameOrigin&quot;&nbsp;<br>
flag,&nbsp;we&nbsp;could&nbsp;prevent&nbsp;that&nbsp;cookie&nbsp;from&nbsp;being&nbsp;sent&nbsp;on&nbsp;HTTP&nbsp;requests&nbsp;that&nbsp;<br>
are&nbsp;initiated&nbsp;by&nbsp;other&nbsp;origins,&nbsp;or&nbsp;were&nbsp;made&nbsp;by&nbsp;frames&nbsp;with&nbsp;ancestors&nbsp;of&nbsp;<br>
other&nbsp;origins.&nbsp;In&nbsp;a&nbsp;CSRF&nbsp;or&nbsp;&quot;UI&nbsp;redress&quot;&nbsp;attack&nbsp;scenario,&nbsp;it&nbsp;will&nbsp;appear&nbsp;<br>
as&nbsp;though&nbsp;the&nbsp;user&nbsp;is&nbsp;not&nbsp;logged&nbsp;in,&nbsp;and&nbsp;thus&nbsp;the&nbsp;HTTP&nbsp;request&nbsp;will&nbsp;be&nbsp;<br>
unable&nbsp;to&nbsp;affect&nbsp;the&nbsp;user's&nbsp;account.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;is&nbsp;an&nbsp;interesting&nbsp;idea,&nbsp;though&nbsp;it&nbsp;only&nbsp;works&nbsp;for&nbsp;Cookie-&nbsp;<br>
authenticated&nbsp;content&nbsp;(admittedly&nbsp;that&nbsp;is&nbsp;most&nbsp;content).&nbsp;I&nbsp;recommend&nbsp;<br>
suggesting&nbsp;this&nbsp;to&nbsp;the&nbsp;group&nbsp;currently&nbsp;speccing&nbsp;httpOnly.&nbsp;It&nbsp;seems&nbsp;out&nbsp;of&nbsp;<br>
scope&nbsp;for&nbsp;HTML5.<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;7)&nbsp;New&nbsp;HTTP&nbsp;request&nbsp;header:&nbsp;Browser&nbsp;vendors&nbsp;seem&nbsp;to&nbsp;be&nbsp;moving&nbsp;away<br>
from&nbsp;&quot;same&nbsp;origin&nbsp;restrictions&quot;&nbsp;towards&nbsp;&quot;verifiable&nbsp;origin&nbsp;labels&quot;<br>
that&nbsp;let&nbsp;the&nbsp;site&nbsp;decide&nbsp;whether&nbsp;two&nbsp;security&nbsp;origins&nbsp;trust&nbsp;each<br>
other.&nbsp;&nbsp;Recent&nbsp;examples&nbsp;of&nbsp;this&nbsp;are&nbsp;MessageEvent's&nbsp;&quot;origin&quot;&nbsp;property<br>
[1],&nbsp;postMessage's&nbsp;&quot;targetOrigin&quot;&nbsp;argument&nbsp;[2],&nbsp;and&nbsp;the&nbsp;HTTP&nbsp;&quot;Origin&quot;<br>
header&nbsp;[3]&nbsp;[4]&nbsp;[5].&nbsp;We&nbsp;can&nbsp;adjust&nbsp;proposal&nbsp;(1)&nbsp;to&nbsp;conform&nbsp;to&nbsp;this<br>
philosophy:&nbsp;instead&nbsp;of&nbsp;making&nbsp;it&nbsp;an<br>
&quot;X-I-Do-Not-Want-To-Be-Framed-Across-Domains:&nbsp;yes&quot;&nbsp;HTTP&nbsp;response<br>
header,&nbsp;make&nbsp;it&nbsp;an&nbsp;&quot;X-Ancestor-Frame-Origin:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.evil.com&quot;&gt;http://www.evil.com&lt;/a&gt;&quot;&nbsp;HTTP<br>
request&nbsp;header.&nbsp;This&nbsp;header&nbsp;could&nbsp;be&nbsp;a&nbsp;list&nbsp;of&nbsp;all&nbsp;the&nbsp;origins&nbsp;that<br>
are&nbsp;ancestors&nbsp;of&nbsp;the&nbsp;frame&nbsp;that&nbsp;triggered&nbsp;the&nbsp;request.&nbsp;If&nbsp;the&nbsp;site<br>
decides&nbsp;it&nbsp;does&nbsp;not&nbsp;like&nbsp;the&nbsp;ancestor&nbsp;frame&nbsp;origin&nbsp;it&nbsp;could&nbsp;reject&nbsp;the<br>
request.&nbsp;This&nbsp;could&nbsp;be&nbsp;added&nbsp;as&nbsp;a&nbsp;property&nbsp;of&nbsp;MessageEvent&nbsp;as&nbsp;well&nbsp;to<br>
detect&nbsp;client-side-only&nbsp;UI&nbsp;redress&nbsp;attacks.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;could&nbsp;be&nbsp;considered&nbsp;an&nbsp;extension&nbsp;to&nbsp;suggestion&nbsp;1.<br>
<br>
<br>
On&nbsp;Mon,&nbsp;29&nbsp;Sep&nbsp;2008,&nbsp;Hallvord&nbsp;R&nbsp;M&nbsp;Steen&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Sites&nbsp;may&nbsp;want&nbsp;to&nbsp;use&nbsp;any&nbsp;of&nbsp;several&nbsp;policies&nbsp;in&nbsp;a&nbsp;&quot;somebody&nbsp;framed&nbsp;me&quot;&nbsp;<br>
situation.&nbsp;For&nbsp;example,&nbsp;these&nbsp;are&nbsp;all&nbsp;policies&nbsp;a&nbsp;site&nbsp;may&nbsp;want&nbsp;to&nbsp;<br>
deploy:<br>
<br>
1.&nbsp;nobody&nbsp;may&nbsp;frame&nbsp;my&nbsp;content<br>
2.&nbsp;selected&nbsp;sites&nbsp;only&nbsp;may&nbsp;frame&nbsp;my&nbsp;content<br>
3.&nbsp;anyone&nbsp;may&nbsp;frame&nbsp;my&nbsp;content&nbsp;but&nbsp;not&nbsp;re-use&nbsp;an&nbsp;existing&nbsp;session<br>
4.&nbsp;anyone&nbsp;may&nbsp;frame&nbsp;my&nbsp;content<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Also&nbsp;noted&nbsp;in&nbsp;other&nbsp;e-mails&nbsp;was:<br>
<br>
&nbsp;&nbsp;5.&nbsp;anyone&nbsp;may&nbsp;frame&nbsp;my&nbsp;content,&nbsp;but&nbsp;I&nbsp;want&nbsp;my&nbsp;UI&nbsp;not&nbsp;to&nbsp;get&nbsp;clobbered<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Giving&nbsp;the&nbsp;site&nbsp;an&nbsp;&quot;Origin:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.example.com&quot;&gt;http://www.example.com&lt;/a&gt;&quot;&nbsp;HTTP&nbsp;header&nbsp;in&nbsp;the&nbsp;<br>
intial&nbsp;request&nbsp;lets&nbsp;the&nbsp;backend&nbsp;implement&nbsp;any&nbsp;of&nbsp;these&nbsp;policies.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
(Except&nbsp;5.)<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Instead&nbsp;of&nbsp;responding&nbsp;with&nbsp;a&nbsp;payload&nbsp;that&nbsp;always&nbsp;includes&nbsp;some&nbsp;variant&nbsp;<br>
of&nbsp;the&nbsp;proposed&nbsp;&quot;X-I-Do-Not-Want-To-Be-Framed-Across-Domains:&nbsp;yes&quot;&nbsp;<br>
header,&nbsp;the&nbsp;site&nbsp;can&nbsp;send&nbsp;or&nbsp;redirect&nbsp;to&nbsp;a&nbsp;framebreaking&nbsp;&quot;embedding&nbsp;<br>
forbidden&quot;&nbsp;page&nbsp;for&nbsp;policy&nbsp;#1.&nbsp;It&nbsp;can&nbsp;do&nbsp;so&nbsp;selectively&nbsp;based&nbsp;on&nbsp;origin&nbsp;<br>
site&nbsp;and/or&nbsp;requested&nbsp;content&nbsp;for&nbsp;policy&nbsp;#2.&nbsp;It&nbsp;can&nbsp;kill&nbsp;existing&nbsp;<br>
cookies,&nbsp;void&nbsp;session&nbsp;and&nbsp;set&nbsp;new&nbsp;origin-specific&nbsp;cookies&nbsp;for&nbsp;policy&nbsp;<br>
#3.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
This&nbsp;is&nbsp;a&nbsp;good&nbsp;point.&nbsp;Maybe&nbsp;Adam's&nbsp;Origin&nbsp;draft&nbsp;can&nbsp;help&nbsp;with&nbsp;this?&nbsp;Adam?<br>
<br>
This&nbsp;wouldn't&nbsp;reduce&nbsp;the&nbsp;need&nbsp;for&nbsp;the&nbsp;other&nbsp;proposals,&nbsp;though,&nbsp;so&nbsp;that&nbsp;we&nbsp;<br>
had&nbsp;defense&nbsp;in&nbsp;depth&nbsp;(e.g.&nbsp;for&nbsp;the&nbsp;cases&nbsp;where&nbsp;Origin&nbsp;was&nbsp;stripped,&nbsp;or&nbsp;for&nbsp;<br>
servers&nbsp;that&nbsp;don't&nbsp;want&nbsp;to&nbsp;do&nbsp;dynamic&nbsp;work&nbsp;like&nbsp;this).<br>
<br>
<br>
On&nbsp;Mon,&nbsp;29&nbsp;Sep&nbsp;2008,&nbsp;Michal&nbsp;Zalewski&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;It&nbsp;still&nbsp;completely&nbsp;ignores&nbsp;the&nbsp;question&nbsp;of&nbsp;how&nbsp;we&nbsp;protect&nbsp;gadgets&nbsp;/&nbsp;<br>
mashups&nbsp;/&nbsp;whatever&nbsp;that&nbsp;are&nbsp;*designed*&nbsp;to&nbsp;be&nbsp;embedded&nbsp;on&nbsp;potentially&nbsp;<br>
untrusted&nbsp;sites,&nbsp;but&nbsp;depend&nbsp;on&nbsp;having&nbsp;the&nbsp;integrity&nbsp;of&nbsp;their&nbsp;UIs&nbsp;<br>
preserved,&nbsp;so&nbsp;I&nbsp;think&nbsp;we&nbsp;need&nbsp;-&nbsp;or&nbsp;well,&nbsp;should&nbsp;-&nbsp;tackle&nbsp;this&nbsp;aspect&nbsp;<br>
separately&nbsp;if&nbsp;this&nbsp;is&nbsp;the&nbsp;consensus&nbsp;for&nbsp;now.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
I&nbsp;have&nbsp;unfortunately&nbsp;not&nbsp;seen&nbsp;any&nbsp;workable&nbsp;solutions&nbsp;suggested&nbsp;for&nbsp;how&nbsp;to&nbsp;<br>
solve&nbsp;this,&nbsp;and&nbsp;have&nbsp;no&nbsp;ideas&nbsp;myself.<br>
<br>
<br>
[snip&nbsp;a&nbsp;very&nbsp;long&nbsp;thread&nbsp;--&nbsp;I&nbsp;did&nbsp;read&nbsp;every&nbsp;e-mail&nbsp;on&nbsp;this&nbsp;thread,&nbsp;and&nbsp;<br>
these&nbsp;e-mails&nbsp;informed&nbsp;my&nbsp;comments&nbsp;in&nbsp;this&nbsp;e-mail]<br>
<br>
<br>
It&nbsp;seems&nbsp;like&nbsp;the&nbsp;most&nbsp;obvious&nbsp;course&nbsp;of&nbsp;action&nbsp;is&nbsp;to&nbsp;embrace&nbsp;Microsoft's&nbsp;<br>
X-Frame-Options&nbsp;header,&nbsp;and&nbsp;consider&nbsp;extensions&nbsp;to&nbsp;make&nbsp;it&nbsp;apply&nbsp;to&nbsp;all&nbsp;<br>
content&nbsp;and/or&nbsp;to&nbsp;make&nbsp;it&nbsp;support&nbsp;CORS&nbsp;headers&nbsp;also&nbsp;in&nbsp;the&nbsp;future.<br>
<br>
I&nbsp;would&nbsp;be&nbsp;interested&nbsp;in&nbsp;feedback&nbsp;from&nbsp;browser&nbsp;vendors&nbsp;about&nbsp;the&nbsp;<br>
feasibility&nbsp;of&nbsp;such&nbsp;an&nbsp;approach.<br>
<br>
Is&nbsp;this&nbsp;something&nbsp;we&nbsp;should&nbsp;add&nbsp;to&nbsp;HTML5?<br>
<br>
I&nbsp;am&nbsp;interested&nbsp;also&nbsp;in&nbsp;suggestions&nbsp;on&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;&lt;meta&nbsp;http-equiv&gt;&nbsp;<br>
pragma&nbsp;case,&nbsp;where&nbsp;the&nbsp;header&nbsp;can&nbsp;come&nbsp;megabytes&nbsp;into&nbsp;the&nbsp;file.&nbsp;Is&nbsp;it&nbsp;<br>
acceptable&nbsp;to&nbsp;replace&nbsp;the&nbsp;document&nbsp;in-place&nbsp;once&nbsp;the&nbsp;pragma&nbsp;is&nbsp;seen&nbsp;and&nbsp;<br>
found&nbsp;to&nbsp;deny&nbsp;embedding?<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
