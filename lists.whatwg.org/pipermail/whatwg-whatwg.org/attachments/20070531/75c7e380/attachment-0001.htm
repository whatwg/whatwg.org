<tt>
On&nbsp;5/31/07,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Maciej&nbsp;Stachowiak&lt;/b&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:mjs@apple.com&quot;&gt;mjs@apple.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;&quot;&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;q&quot;&gt;&lt;div&gt;On&nbsp;May&nbsp;30,&nbsp;2007,&nbsp;at&nbsp;8:32&nbsp;PM,&nbsp;Robert&nbsp;O&#39;Callahan&nbsp;wrote:&lt;/div&gt;&lt;/span&gt;&lt;span&nbsp;class=&quot;q&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;On&nbsp;the&nbsp;plus&nbsp;side,&nbsp;JAR&nbsp;files&nbsp;make&nbsp;versioning&nbsp;and&nbsp;and&nbsp;consistency&nbsp;incredibly&nbsp;simple.&nbsp;It&#39;s&nbsp;not&nbsp;clear&nbsp;what&nbsp;the&nbsp;Gears&nbsp;ManagedStore&nbsp;does&nbsp;if&nbsp;it&nbsp;gets&nbsp;a&nbsp;404&nbsp;or&nbsp;some&nbsp;other&nbsp;error&nbsp;during&nbsp;an&nbsp;update.<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;I&nbsp;believe&nbsp;the&nbsp;update&nbsp;is&nbsp;made&nbsp;atomic&nbsp;to&nbsp;the&nbsp;web&nbsp;app:&lt;/div&gt;&lt;/span&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;&lt;a&nbsp;href=&quot;http://code.google.com/apis/gears/api_localserver.html#ManagedResourceStore&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;<br>
http://code.google.com/apis/gears/api_localserver.html#ManagedResourceStore&lt;/a&gt;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&quot;While&nbsp;an&nbsp;update&nbsp;is&nbsp;in&nbsp;progress,&nbsp;resources&nbsp;from&nbsp;the&nbsp;previous&nbsp;version&nbsp;(if&nbsp;any)&nbsp;will&nbsp;continue&nbsp;to&nbsp;be&nbsp;served&nbsp;locally.&nbsp;After&nbsp;all&nbsp;resources&nbsp;have&nbsp;been&nbsp;downloaded,&nbsp;the&nbsp;currentVersion&nbsp;property&nbsp;will&nbsp;be&nbsp;updated&nbsp;to&nbsp;indicate&nbsp;that&nbsp;the&nbsp;new&nbsp;set&nbsp;of&nbsp;a&nbsp;resources&nbsp;are&nbsp;now&nbsp;being&nbsp;served&nbsp;locally&nbsp;and&nbsp;the&nbsp;previous&nbsp;version&nbsp;has&nbsp;been&nbsp;removed.&quot;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Yeah,&nbsp;but&nbsp;that&nbsp;doesn&#39;t&nbsp;say&nbsp;what&nbsp;happens&nbsp;if&nbsp;one&nbsp;or&nbsp;more&nbsp;of&nbsp;the&nbsp;resources&nbsp;fails&nbsp;to&nbsp;load.&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;&quot;&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;q&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Other&nbsp;issues&nbsp;with&nbsp;the&nbsp;Gears&nbsp;API:&lt;br&gt;--&nbsp;The&nbsp;ManagedStore&nbsp;approach&nbsp;seems&nbsp;to&nbsp;have&nbsp;a&nbsp;problem&nbsp;in&nbsp;the&nbsp;following&nbsp;situation:&nbsp;Suppose&nbsp;an&nbsp;app&nbsp;is&nbsp;updated&nbsp;on&nbsp;the&nbsp;server&nbsp;overnight&nbsp;and&nbsp;I&nbsp;visit&nbsp;the&nbsp;main&nbsp;page&nbsp;in&nbsp;the&nbsp;morning.&nbsp;It&nbsp;starts&nbsp;loading&nbsp;other&nbsp;resources.&nbsp;&nbsp;ManagedStore&nbsp;is&nbsp;going&nbsp;to&nbsp;check&nbsp;the&nbsp;manifest,&nbsp;find&nbsp;that&nbsp;the&nbsp;app&nbsp;needs&nbsp;to&nbsp;be&nbsp;updated,&nbsp;pull&nbsp;down&nbsp;the&nbsp;new&nbsp;resources,&nbsp;and&nbsp;flip&nbsp;to&nbsp;the&nbsp;new&nbsp;version&nbsp;---&nbsp;more&nbsp;than&nbsp;likely&nbsp;while&nbsp;the&nbsp;app&nbsp;is&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;loading.&nbsp;Sure,&nbsp;this&nbsp;could&nbsp;happen&nbsp;normally&nbsp;if&nbsp;I&nbsp;hit&nbsp;the&nbsp;site&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;the&nbsp;night&nbsp;at&nbsp;the&nbsp;switchover,&nbsp;but&nbsp;ManagedStore&nbsp;makes&nbsp;this&nbsp;uncommon&nbsp;case&nbsp;common.&nbsp;(This&nbsp;is&nbsp;Dave&nbsp;Camp&#39;s&nbsp;example.)&nbsp;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/span&gt;&lt;div&gt;We&#39;ve&nbsp;brought&nbsp;up&nbsp;the&nbsp;same&nbsp;problem.&nbsp;I&nbsp;thought&nbsp;more&nbsp;about&nbsp;this&nbsp;though&nbsp;-&nbsp;the&nbsp;update&nbsp;can&nbsp;only&nbsp;happen&nbsp;while&nbsp;you&#39;re&nbsp;online,&nbsp;in&nbsp;which&nbsp;case&nbsp;you&nbsp;could&nbsp;do&nbsp;all&nbsp;loads&nbsp;directly&nbsp;from&nbsp;the&nbsp;net&nbsp;(or&nbsp;at&nbsp;least&nbsp;revalidating&nbsp;per&nbsp;normal&nbsp;cache&nbsp;policy)&nbsp;while&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;checking&nbsp;for&nbsp;an&nbsp;update.<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Then&nbsp;if&nbsp;you&nbsp;go&nbsp;offline&nbsp;while&nbsp;the&nbsp;app&nbsp;is&nbsp;running,&nbsp;you&#39;re&nbsp;in&nbsp;bad&nbsp;shape.&nbsp;(I&nbsp;think&nbsp;brief&nbsp;periods&nbsp;of&nbsp;connectivity&nbsp;are&nbsp;a&nbsp;common&nbsp;scenario...)&nbsp;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;&quot;&gt;&lt;div&gt;&lt;div&gt;&nbsp;Or&nbsp;else&nbsp;the&nbsp;manifest&nbsp;could&nbsp;be&nbsp;checked&nbsp;before&nbsp;serving&nbsp;from&nbsp;the&nbsp;local&nbsp;store&nbsp;and&nbsp;if&nbsp;the&nbsp;version&nbsp;changed&nbsp;in&nbsp;that&nbsp;case&nbsp;let&nbsp;the&nbsp;page&nbsp;load&nbsp;live&nbsp;and&nbsp;cache&nbsp;those&nbsp;copies.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;<br>
&lt;br&gt;That&nbsp;could&nbsp;work.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;style=&quot;&quot;&gt;&lt;div&gt;&lt;div&gt;The&nbsp;transparency&nbsp;of&nbsp;the&nbsp;cache&nbsp;from&nbsp;the&nbsp;URI&nbsp;point&nbsp;of&nbsp;view&nbsp;actually&nbsp;helps&nbsp;with&nbsp;solving&nbsp;this,&nbsp;I&nbsp;think.&nbsp;I&nbsp;don&#39;t&nbsp;think&nbsp;this&nbsp;problem&nbsp;is&nbsp;fundamental.<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Neither&nbsp;do&nbsp;I,&nbsp;but&nbsp;it&#39;s&nbsp;something&nbsp;to&nbsp;think&nbsp;about.&nbsp;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;&quot;&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;q&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;--&nbsp;I&nbsp;think&nbsp;making&nbsp;ResourceStore&nbsp;writable&nbsp;by&nbsp;clients&nbsp;is&nbsp;unnecessary&nbsp;complexity.&nbsp;It&#39;s&nbsp;much&nbsp;simpler&nbsp;to&nbsp;maintain&nbsp;the&nbsp;model&nbsp;that&nbsp;the&nbsp;LocalServer/offline&nbsp;cache&nbsp;is&nbsp;really&nbsp;just&nbsp;a&nbsp;cache&nbsp;of&nbsp;the&nbsp;Web.&nbsp;Then&nbsp;there&nbsp;are&nbsp;no&nbsp;issues&nbsp;with&nbsp;enabling/disablings&nbsp;stores,&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;add&nbsp;domain&nbsp;restrictions&nbsp;or&nbsp;requiredCookie&nbsp;(&nbsp;<br>
i.e.&nbsp;potential&nbsp;security&nbsp;holes)&nbsp;so&nbsp;that&nbsp;different&nbsp;apps&nbsp;can&#39;t&nbsp;tread&nbsp;on&nbsp;each&nbsp;other&#39;s&nbsp;resources.&nbsp;(So&nbsp;apps&nbsp;that&nbsp;want&nbsp;to&nbsp;refer&nbsp;to&nbsp;a&nbsp;canonical&nbsp;source&nbsp;for&nbsp;JS&nbsp;library&nbsp;files&nbsp;or&nbsp;whatever&nbsp;can&nbsp;still&nbsp;work.)&nbsp;For&nbsp;file&nbsp;uploads,&nbsp;I&nbsp;think&nbsp;we&nbsp;should&nbsp;just&nbsp;have&nbsp;a&nbsp;DOM&nbsp;API&nbsp;on&nbsp;form&nbsp;control&nbsp;elements&nbsp;that&nbsp;reads&nbsp;the&nbsp;file&nbsp;data&nbsp;into&nbsp;a&nbsp;binary&nbsp;blob&nbsp;of&nbsp;some&nbsp;sort&nbsp;which&nbsp;can&nbsp;then&nbsp;be&nbsp;stored&nbsp;in&nbsp;Storage&nbsp;or&nbsp;SQL.&nbsp;<br>
&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;/blockquote&gt;&lt;/span&gt;&lt;div&gt;I&nbsp;don&#39;t&nbsp;think&nbsp;requiredCookie&nbsp;feature&nbsp;is&nbsp;there&nbsp;solely&nbsp;for&nbsp;writeability&nbsp;reasons,&nbsp;but&nbsp;rather&nbsp;to&nbsp;make&nbsp;the&nbsp;LocalServer&nbsp;cache&nbsp;work&nbsp;even&nbsp;when&nbsp;in&nbsp;normal&nbsp;use&nbsp;they&nbsp;might&nbsp;get&nbsp;different&nbsp;versions&nbsp;of&nbsp;a&nbsp;resource&nbsp;from&nbsp;the&nbsp;server&nbsp;at&nbsp;different&nbsp;times.&nbsp;For&nbsp;example,&nbsp;suppose&nbsp;you&nbsp;have&nbsp;two&nbsp;different&nbsp;gmail&nbsp;accounts&nbsp;with&nbsp;preferences&nbsp;set&nbsp;to&nbsp;different&nbsp;languages.<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;That&nbsp;could&nbsp;be&nbsp;handled&nbsp;other&nbsp;ways,&nbsp;perhaps&nbsp;by&nbsp;restructuring&nbsp;the&nbsp;app&nbsp;to&nbsp;use&nbsp;URI&nbsp;query&nbsp;parameters.&nbsp;I&nbsp;think&nbsp;requiredCookie&nbsp;is&nbsp;an&nbsp;example&nbsp;of&nbsp;something&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;in&nbsp;an&nbsp;initial&nbsp;spec.&nbsp;(BTW&nbsp;the&nbsp;Gears&nbsp;docs&nbsp;don&#39;t&nbsp;say&nbsp;what&nbsp;happens&nbsp;when&nbsp;a&nbsp;load&nbsp;matches&nbsp;in&nbsp;multiple&nbsp;stores,&nbsp;possibly&nbsp;by&nbsp;having&nbsp;multiple&nbsp;cookies...)<br>
&lt;br&gt;&lt;/div&gt;&lt;br&gt;There&nbsp;is&nbsp;one&nbsp;related&nbsp;feature&nbsp;that&nbsp;Gears&nbsp;is&nbsp;missing&nbsp;that&nbsp;we&nbsp;thought&nbsp;app&nbsp;writers&nbsp;might&nbsp;need.&nbsp;Web&nbsp;pages&nbsp;can&nbsp;load&nbsp;other&nbsp;pages&nbsp;and&nbsp;pass&nbsp;parameters&nbsp;to&nbsp;them&nbsp;via&nbsp;URI&nbsp;query&nbsp;params&nbsp;or&nbsp;POST.&nbsp;When&nbsp;you&#39;re&nbsp;offline&nbsp;that&nbsp;won&#39;t&nbsp;work.&nbsp;Our&nbsp;solution&nbsp;to&nbsp;this&nbsp;is&nbsp;that&nbsp;query&nbsp;parameters&nbsp;in&nbsp;JAR&nbsp;URIs&nbsp;are&nbsp;ignored,&nbsp;so&nbsp;jar:<br>
&lt;a&nbsp;href=&quot;http://foo.com/foo.jar!/query.html?bar=baz&quot;&gt;http://foo.com/foo.jar!/query.html?bar=baz&lt;/a&gt;&nbsp;just&nbsp;loads&nbsp;jar:&lt;a&nbsp;href=&quot;http://foo.com/foo.jar!/query.html&quot;&gt;http://foo.com/foo.jar!/query.html&lt;/a&gt;,&nbsp;but&nbsp;script&nbsp;in&nbsp;query.html<br>
&nbsp;can&nbsp;access&nbsp;the&nbsp;query&nbsp;parameters&nbsp;via&nbsp;document.location,&nbsp;and&nbsp;dynamically&nbsp;generate&nbsp;content&nbsp;that&nbsp;the&nbsp;server&nbsp;would&nbsp;otherwise&nbsp;have&nbsp;provided.&nbsp;I&nbsp;think&nbsp;an&nbsp;WHATWG&nbsp;solution&nbsp;should&nbsp;cover&nbsp;this&nbsp;case&nbsp;somehow.&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;&quot;&gt;&lt;div&gt;&lt;div&gt;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;what&nbsp;you&nbsp;mean&nbsp;by&nbsp;the&nbsp;resource&nbsp;store&nbsp;being&nbsp;writeable.&nbsp;It&nbsp;lets&nbsp;you&nbsp;tweak&nbsp;the&nbsp;set&nbsp;of&nbsp;items&nbsp;stored,&nbsp;but&nbsp;you&nbsp;can&#39;t&nbsp;construct&nbsp;an&nbsp;item&nbsp;with&nbsp;headers&nbsp;and&nbsp;data&nbsp;and&nbsp;all&nbsp;by&nbsp;hand.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;You&nbsp;can&nbsp;copy,&nbsp;delete&nbsp;and&nbsp;rename&nbsp;items&nbsp;in&nbsp;the&nbsp;cache.&nbsp;I&nbsp;guess&nbsp;I&nbsp;should&nbsp;have&nbsp;said&nbsp;&quot;mutable&quot;&nbsp;instead&nbsp;of&nbsp;&quot;writable&quot;.&nbsp;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;&quot;&gt;&lt;div&gt;&lt;div&gt;&nbsp;It&nbsp;does&nbsp;overload&nbsp;file&nbsp;insertion&nbsp;into&nbsp;the&nbsp;local&nbsp;store,&nbsp;which&nbsp;is&nbsp;perhaps&nbsp;needlessly&nbsp;complex,&nbsp;but&nbsp;you&nbsp;do&nbsp;want&nbsp;a&nbsp;way&nbsp;to&nbsp;access&nbsp;a&nbsp;file&nbsp;picked&nbsp;by&nbsp;an&nbsp;HTMLInputElement&nbsp;without&nbsp;having&nbsp;to&nbsp;round-trip&nbsp;it&nbsp;to&nbsp;the&nbsp;server.&nbsp;Perhaps&nbsp;that&nbsp;feature&nbsp;would&nbsp;be&nbsp;better&nbsp;served&nbsp;by&nbsp;API&nbsp;on&nbsp;HTMLInputElement&nbsp;instead.<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Agreed.&nbsp;That&nbsp;would&nbsp;be&nbsp;very&nbsp;useful&nbsp;for&nbsp;regular&nbsp;Web&nbsp;apps&nbsp;as&nbsp;well.&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;Rob&lt;br&gt;&lt;/div&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&quot;Two&nbsp;men&nbsp;owed&nbsp;money&nbsp;to&nbsp;a&nbsp;certain&nbsp;moneylender.&nbsp;One&nbsp;owed&nbsp;him&nbsp;five&nbsp;hundred&nbsp;denarii,&nbsp;and&nbsp;the&nbsp;other&nbsp;fifty.&nbsp;Neither&nbsp;of&nbsp;them&nbsp;had&nbsp;the&nbsp;money&nbsp;to&nbsp;pay&nbsp;him&nbsp;back,&nbsp;so&nbsp;he&nbsp;canceled&nbsp;the&nbsp;debts&nbsp;of&nbsp;both.&nbsp;Now&nbsp;which&nbsp;of&nbsp;them&nbsp;will&nbsp;love&nbsp;him&nbsp;more?&quot;&nbsp;Simon&nbsp;replied,&nbsp;&quot;I&nbsp;suppose&nbsp;the&nbsp;one&nbsp;who&nbsp;had&nbsp;the&nbsp;bigger&nbsp;debt&nbsp;canceled.&quot;&nbsp;&quot;You&nbsp;have&nbsp;judged&nbsp;correctly,&quot;&nbsp;Jesus&nbsp;said.&nbsp;[Luke&nbsp;7:41-43]<br>

</tt>
