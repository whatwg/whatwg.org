<tt>
&lt;html&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;4.11.3.&nbsp;Executing&nbsp;SQL&nbsp;statements&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/div&gt;&lt;div&gt;[…]&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/div&gt;&lt;div&gt;1.&nbsp;If&nbsp;the&nbsp;syntax&nbsp;of&nbsp;sqlStatement&nbsp;is&nbsp;not&nbsp;valid&nbsp;(except&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;?&nbsp;characters&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;literals),&nbsp;or&nbsp;the&nbsp;statement&nbsp;uses&nbsp;features&nbsp;that&nbsp;are&nbsp;not&nbsp;supported&nbsp;(e.g.&nbsp;due&nbsp;to&nbsp;security&nbsp;reasons),&nbsp;then&nbsp;the&nbsp;the&nbsp;method&nbsp;must&nbsp;raise&nbsp;a&nbsp;SYNTAX_ERR&nbsp;exception&nbsp;and&nbsp;abort&nbsp;these&nbsp;steps.&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;I&nbsp;think&nbsp;step&nbsp;one&nbsp;needs&nbsp;more&nbsp;clarification&nbsp;on&nbsp;what&nbsp;an&nbsp;invalid&nbsp;statement&nbsp;is.&nbsp;In&nbsp;the&nbsp;current&nbsp;WebKit&nbsp;implementation&nbsp;a&nbsp;SYNTAX_ERR&nbsp;is&nbsp;being&nbsp;thrown&nbsp;for&nbsp;all&nbsp;queries&nbsp;that&nbsp;&lt;/span&gt;&lt;/font&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&nbsp;&quot;&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;background-color:&nbsp;transparent;&quot;&gt;sqlite3_prepare&nbsp;doesn't&nbsp;return&nbsp;SQLITE_OK.&nbsp;This&nbsp;means&nbsp;queries&nbsp;against&nbsp;tables&nbsp;that&nbsp;don't&nbsp;exist&nbsp;will&nbsp;throw&nbsp;a&nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;normal;&nbsp;&quot;&gt;SYNTAX_ERR,&nbsp;among&nbsp;other&nbsp;things&nbsp;that&nbsp;are&nbsp;perfectly&nbsp;well-formed&nbsp;statements.&lt;/span&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;Take&nbsp;this&nbsp;example&nbsp;and&nbsp;assume&nbsp;WebKitNotes&nbsp;doesn't&nbsp;exist:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;db.executeSql(&quot;CREATE&nbsp;TABLE&nbsp;WebKitNotes&nbsp;(note&nbsp;TEXT,&nbsp;timestamp&nbsp;REAL)&quot;,&nbsp;[],&nbsp;function(result)&nbsp;{});<br>
db.executeSql(&quot;INSERT&nbsp;INTO&nbsp;WebKitNotes&nbsp;VALUES&nbsp;(?,&nbsp;?)&quot;,&nbsp;[note,&nbsp;timestamp],&nbsp;function(result)&nbsp;{});&lt;/span&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;<br>
&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;The&nbsp;first&nbsp;query&nbsp;will&nbsp;be&nbsp;queued&nbsp;for&nbsp;execution.&nbsp;It&nbsp;is&nbsp;a&nbsp;valid&nbsp;statement.&nbsp;The&nbsp;second&nbsp;query&nbsp;can&nbsp;come&nbsp;in&nbsp;before&nbsp;the&nbsp;first&nbsp;has&nbsp;been&nbsp;executed.&nbsp;Since&nbsp;the&nbsp;table&nbsp;hasn't&nbsp;been&nbsp;created&nbsp;yet,&nbsp;executeSql&nbsp;will&nbsp;throw&nbsp;a&nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;normal;&nbsp;&quot;&gt;SYNTAX_ERR&nbsp;because&nbsp;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&nbsp;&quot;&gt;sqlite3_prepare&nbsp;fails&nbsp;to&nbsp;find&nbsp;the&nbsp;table&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;white-space:&nbsp;normal;&nbsp;&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/div&gt;&lt;div&gt;Now,&nbsp;run&nbsp;the&nbsp;code&nbsp;again&nbsp;and&nbsp;the&nbsp;create&nbsp;table&nbsp;will&nbsp;throw&nbsp;SYNTAX_ERR&nbsp;because&nbsp;the&nbsp;table&nbsp;already&nbsp;exists.&nbsp;Users&nbsp;could&nbsp;use&nbsp;CREATE&nbsp;TABLE&nbsp;IF&nbsp;NOT&nbsp;EXISTS,&nbsp;but&nbsp;SQLite&nbsp;has&nbsp;not&nbsp;always&nbsp;had&nbsp;this&nbsp;(for&nbsp;instance,&nbsp;the&nbsp;version&nbsp;shipped&nbsp;on&nbsp;Mac&nbsp;OS&nbsp;10.4.)&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;a&nbsp;developer&nbsp;needs&nbsp;to&nbsp;write&nbsp;their&nbsp;code&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;try&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;db.executeSql(&quot;CREATE&nbsp;TABLE&nbsp;WebKitNotes&nbsp;(note&nbsp;TEXT,&nbsp;timestamp&nbsp;REAL)&quot;,&nbsp;[],&nbsp;function(result)&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;db.executeSql(&quot;INSERT&nbsp;INTO&nbsp;WebKitNotes&nbsp;VALUES&nbsp;(?,&nbsp;?)&quot;,&nbsp;[note,&nbsp;timestamp],&nbsp;function(result)&nbsp;{});&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;});&lt;/div&gt;&lt;div&gt;}&nbsp;catch(e)&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;db.executeSql(&quot;INSERT&nbsp;INTO&nbsp;WebKitNotes&nbsp;VALUES&nbsp;(?,&nbsp;?)&quot;,&nbsp;[note,&nbsp;timestamp],&nbsp;function(result)&nbsp;{});&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&nbsp;class=&quot;webkit-block-placeholder&quot;&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;SYNTAX_ERR&nbsp;should&nbsp;only&nbsp;be&nbsp;thrown&nbsp;for&nbsp;non&nbsp;well-formed&nbsp;queries&nbsp;(missing&nbsp;quotes,&nbsp;clauses,&nbsp;etc.),&nbsp;and&nbsp;if&nbsp;a&nbsp;table&nbsp;doesn't&nbsp;exist&nbsp;it&nbsp;should&nbsp;not&nbsp;throw.&nbsp;Once&nbsp;the&nbsp;whole&nbsp;queue&nbsp;is&nbsp;executed,&nbsp;that&nbsp;table&nbsp;might&nbsp;exist.&nbsp;If&nbsp;the&nbsp;table&nbsp;still&nbsp;doesn't&nbsp;exist&nbsp;the&nbsp;developer&nbsp;will&nbsp;have&nbsp;an&nbsp;errorCode&nbsp;and&nbsp;a&nbsp;meaningful&nbsp;error&nbsp;string&nbsp;instead&nbsp;of&nbsp;a&nbsp;generic&nbsp;SYNTAX_ERR&nbsp;with&nbsp;no&nbsp;context.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;10px;&nbsp;&quot;&gt;—&nbsp;Timothy&nbsp;Hatcher&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;apple-content-edited=&quot;true&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;separate;&nbsp;border-spacing:&nbsp;0px&nbsp;0px;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Verdana;&nbsp;font-size:&nbsp;11px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;text-align:&nbsp;auto;&nbsp;-khtml-text-decorations-in-effect:&nbsp;none;&nbsp;text-indent:&nbsp;0px;&nbsp;-apple-text-size-adjust:&nbsp;auto;&nbsp;text-transform:&nbsp;none;&nbsp;orphans:&nbsp;2;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;&quot;&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;/span&gt;&nbsp;&lt;/div&gt;&lt;br&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
