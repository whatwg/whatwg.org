<tt>
&lt;meta&nbsp;charset=&quot;utf-8&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;Thu,&nbsp;Sep&nbsp;17,&nbsp;2009&nbsp;at&nbsp;1:32&nbsp;AM,&nbsp;Ian&nbsp;Hickson &lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ian@hixie.ch&quot;&nbsp;target=&quot;_blank&quot;&gt;ian@hixie.ch&lt;/a&gt;&amp;gt;&lt;/span&gt; wrote:&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
<br>
&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;margin-right:&nbsp;0px;&nbsp;margin-bottom:&nbsp;0px;&nbsp;margin-left:&nbsp;0.8ex;&nbsp;border-left-width:&nbsp;1px;&nbsp;border-left-color:&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;border-left-style:&nbsp;solid;&nbsp;padding-left:&nbsp;1ex;&nbsp;&quot;&gt;<br>
<br>
On&nbsp;Tue,&nbsp;15&nbsp;Sep&nbsp;2009,&nbsp;Jonas&nbsp;Sicking&nbsp;wrote:&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;First&nbsp;off,&nbsp;I&nbsp;agree&nbsp;that&nbsp;not&nbsp;having&nbsp;localStorage&nbsp;in&nbsp;workers&nbsp;is&nbsp;a&nbsp;big&lt;br&gt;&amp;gt;&nbsp;problem&nbsp;that&nbsp;we&nbsp;need&nbsp;to&nbsp;address.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;If&nbsp;I&nbsp;were&nbsp;designing&nbsp;the&nbsp;localStorage&nbsp;interface&nbsp;today&nbsp;I&nbsp;would&nbsp;use&nbsp;the&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;above&nbsp;interface&nbsp;that&nbsp;you&nbsp;suggest.&nbsp;Grabbing&nbsp;localStorage&nbsp;can&nbsp;only&nbsp;be&nbsp;done&lt;br&gt;&amp;gt;&nbsp;asynchronously,&nbsp;and&nbsp;while&nbsp;you&amp;#39;re&nbsp;using&nbsp;it,&nbsp;no&nbsp;one&nbsp;else&nbsp;can&nbsp;get&nbsp;a&lt;br&gt;&amp;gt;&nbsp;reference&nbsp;to&nbsp;it.&nbsp;This&nbsp;way&nbsp;there&nbsp;are&nbsp;no&nbsp;race&nbsp;conditions,&nbsp;but&nbsp;also&nbsp;no&nbsp;way&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;for&nbsp;anyone&nbsp;to&nbsp;have&nbsp;to&nbsp;lock.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;So&nbsp;one&nbsp;solution&nbsp;is&nbsp;to&nbsp;do&nbsp;that&nbsp;in&nbsp;parallel&nbsp;to&nbsp;the&nbsp;current&nbsp;localStorage&lt;br&gt;&amp;gt;&nbsp;interface.&nbsp;Let&amp;#39;s&nbsp;say&nbsp;we&nbsp;introduce&nbsp;a&nbsp;&amp;#39;clientStorage&amp;#39;&nbsp;object.&nbsp;You&nbsp;can&nbsp;only&lt;br&gt;&amp;gt;&nbsp;get&nbsp;a&nbsp;reference&nbsp;to&nbsp;it&nbsp;using&nbsp;a&nbsp;&amp;#39;getClientStorage&amp;#39;&nbsp;function.&nbsp;This&nbsp;function&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;is&nbsp;available&nbsp;both&nbsp;to&nbsp;workers&nbsp;and&nbsp;windows.&nbsp;The&nbsp;storage&nbsp;is&nbsp;separate&nbsp;from&lt;br&gt;&amp;gt;&nbsp;localStorage&nbsp;so&nbsp;no&nbsp;need&nbsp;to&nbsp;worry&nbsp;about&nbsp;the&nbsp;&amp;#39;storage&nbsp;mutex&amp;#39;.&lt;br&gt;&lt;br&gt;I&nbsp;think&nbsp;we&nbsp;should&nbsp;be&nbsp;very&nbsp;careful&nbsp;before&nbsp;introducing&nbsp;a&nbsp;fourth&nbsp;storage&lt;br&gt;<br>
<br>
mechanism&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;whatever&nbsp;we&nbsp;introduce&nbsp;really&nbsp;is&nbsp;something&lt;br&gt;that&amp;#39;s&nbsp;going&nbsp;to&nbsp;be&nbsp;very&nbsp;useful&nbsp;and&nbsp;really&nbsp;solve&nbsp;problems.&nbsp;I&amp;#39;d&nbsp;really&lt;br&gt;rather&nbsp;not&nbsp;rush&nbsp;into&nbsp;adding&nbsp;yet&nbsp;another&nbsp;mechanism&nbsp;at&nbsp;this&nbsp;point.&lt;br&gt;<br>
<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Sure.&nbsp; But&nbsp;what&nbsp;about&nbsp;the&nbsp;other&nbsp;idea&nbsp;Robert&nbsp;and&nbsp;Drew&nbsp;had&nbsp;(in&nbsp;the&nbsp;workers&nbsp;+&nbsp;local&nbsp;storage&nbsp;thread)&nbsp;about&nbsp;just&nbsp;having&nbsp;a&nbsp;WorkerLocalStorage&nbsp;mechanism?&nbsp; Only&nbsp;workers&nbsp;would&nbsp;be&nbsp;able&nbsp;to&nbsp;access&nbsp;it&nbsp;and&nbsp;the&nbsp;interface&nbsp;would&nbsp;be&nbsp;exactly&nbsp;the&nbsp;same&nbsp;as&nbsp;LocalStorage.&nbsp; The&nbsp;only&nbsp;difference&nbsp;is&nbsp;that&nbsp;the&nbsp;data&nbsp;is&nbsp;in&nbsp;a separate area&nbsp;(and&nbsp;pages/workers&nbsp;cannot&nbsp;share&nbsp;data).&nbsp; (Though&nbsp;we&nbsp;could,&nbsp;in&nbsp;the&nbsp;future,&nbsp;add&nbsp;such&nbsp;an&nbsp;async&nbsp;interface&nbsp;if&nbsp;we&nbsp;wanted&nbsp;to&nbsp;allow&nbsp;pages&nbsp;to&nbsp;access&nbsp;it.)&nbsp; I&nbsp;know&nbsp;the&nbsp;burden&nbsp;for&nbsp;implementation&nbsp;in&nbsp;WebKit&nbsp;is&nbsp;low,&nbsp;and&nbsp;I&nbsp;imagine&nbsp;(though&nbsp;don&amp;#39;t&nbsp;know&nbsp;for&nbsp;sure)&nbsp;that&nbsp;the&nbsp;burden&nbsp;would&nbsp;be&nbsp;low&nbsp;in&nbsp;other&nbsp;browsers&nbsp;as&nbsp;well.&lt;/div&gt;<br>
<br>
&lt;/div&gt;<br>

</tt>
