<tt>
We&amp;#39;re&nbsp;using&nbsp;SSE&nbsp;as&nbsp;a&nbsp;reliable&nbsp;Server&nbsp;-&amp;gt;&nbsp;Browser&nbsp;streaming&nbsp;mechanism&nbsp;where&nbsp;the&nbsp;server&nbsp;maintains&nbsp;a&nbsp;message&nbsp;queue&nbsp;per&nbsp;user&nbsp;connection.&nbsp;The&nbsp;server&nbsp;needs&nbsp;to&nbsp;buffer&nbsp;all&nbsp;messages&nbsp;until&nbsp;it&nbsp;receives&nbsp;an&nbsp;acknowledgment&nbsp;for&nbsp;a&nbsp;given&nbsp;message&nbsp;(ACK).&nbsp;The&nbsp;server&nbsp;sometimes&nbsp;needs&nbsp;to&nbsp;indicate&nbsp;to&nbsp;the&nbsp;Browser&nbsp;that&nbsp;the&nbsp;message&nbsp;queue&nbsp;has&nbsp;become&nbsp;too&nbsp;large&nbsp;and&nbsp;the&nbsp;browser&nbsp;should&nbsp;send&nbsp;an&nbsp;ACK&nbsp;as&nbsp;soon&nbsp;as&nbsp;possible.&nbsp;One&nbsp;way&nbsp;the&nbsp;server&nbsp;can&nbsp;indicate&nbsp;that&nbsp;it&nbsp;needs&nbsp;an&nbsp;ACK&nbsp;is&nbsp;to&nbsp;end&nbsp;the&nbsp;HTTP&nbsp;Response&nbsp;causing&nbsp;the&nbsp;event-source&nbsp;stream&nbsp;to&nbsp;automatically&nbsp;reconnect&nbsp;with&nbsp;the&nbsp;&amp;quot;Last-Event-ID&amp;quot;&nbsp;header.&nbsp;We&nbsp;call&nbsp;this&nbsp;an&nbsp;&amp;quot;in-band&nbsp;ACK&amp;quot;,&nbsp;where&nbsp;the&nbsp;server&nbsp;sends&nbsp;a&nbsp;&amp;quot;request&nbsp;for&nbsp;ACK&amp;quot;&nbsp;by&nbsp;ending&nbsp;the&nbsp;HTTP&nbsp;response&nbsp;(using&nbsp;transfer-encoding&nbsp;chunked&nbsp;and&nbsp;sending&nbsp;the&nbsp;0&nbsp;chunk,&nbsp;for&nbsp;instance.)&lt;br&gt;<br>
&lt;br&gt;Normally,&nbsp;a&nbsp;message&amp;#39;s&nbsp;latency&nbsp;is&amp;nbsp;&nbsp;the&nbsp;time&nbsp;it&nbsp;takes&nbsp;to&nbsp;travel&nbsp;from&nbsp;the&nbsp;server&nbsp;to&nbsp;the&nbsp;browser,&nbsp;or&nbsp;one&nbsp;leg.&nbsp;For&nbsp;in&nbsp;band&nbsp;ACKing,&nbsp;it&nbsp;takes&nbsp;3&nbsp;legs&nbsp;to&nbsp;deliver&nbsp;the&nbsp;next&nbsp;message&nbsp;after&nbsp;an&nbsp;ACK&nbsp;request:&nbsp;1)&nbsp;Server&nbsp;-&amp;gt;&nbsp;Browser&nbsp;(end&nbsp;of&nbsp;response),&nbsp;2)&nbsp;Browser&nbsp;-&amp;gt;&nbsp;Server&nbsp;(new&nbsp;request),&nbsp;3)&nbsp;Server&nbsp;-&amp;gt;&nbsp;Browser&nbsp;(next&nbsp;message).&nbsp;A&nbsp;solution&nbsp;to&nbsp;this&nbsp;problem&nbsp;is&nbsp;to&nbsp;make&nbsp;a&nbsp;second&nbsp;concurrent&nbsp;http&nbsp;request&nbsp;that&nbsp;represents&nbsp;the&nbsp;ACK;&nbsp;this&nbsp;we&nbsp;call&nbsp;an&nbsp;&amp;quot;out-of-band&nbsp;ACK&amp;quot;.&nbsp;&lt;br&gt;<br>
&lt;br&gt;Unfortunately,&nbsp;the&nbsp;current&nbsp;Server-sent&nbsp;Events&nbsp;specification&nbsp;provides&nbsp;no&nbsp;way&nbsp;for&nbsp;a&nbsp;user&nbsp;of&nbsp;the&nbsp;event-source&nbsp;API&nbsp;to&nbsp;know&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;lastEventId,&amp;nbsp;&nbsp;thus&nbsp;making&nbsp;it&nbsp;impossible&nbsp;to&nbsp;send&nbsp;an&nbsp;ACK&nbsp;out-of-band.&nbsp;We&nbsp;have&nbsp;two&nbsp;proposals,&nbsp;either&nbsp;of&nbsp;which&nbsp;can&nbsp;solve&nbsp;this&nbsp;problem.&lt;br&gt;<br>
&lt;br&gt;1)&nbsp;Expose&nbsp;the&nbsp;id&nbsp;attribute&nbsp;on&nbsp;each&nbsp;dispatched&nbsp;event.&nbsp;This&nbsp;allows&nbsp;us&nbsp;to&nbsp;send&nbsp;out-of-band&nbsp;ACKs&nbsp;as&nbsp;required.&nbsp;The&nbsp;downside&nbsp;is&nbsp;that&nbsp;we&nbsp;would&nbsp;need&nbsp;to&nbsp;extend&nbsp;the&nbsp;MessageEvent&nbsp;interface.&nbsp;&lt;br&gt;&lt;br&gt;2)&nbsp;Expose&nbsp;an&nbsp;add/remove&nbsp;EventListener&nbsp;on&nbsp;the&nbsp;event-source&nbsp;dom&nbsp;element&nbsp;that&nbsp;dispatches&nbsp;whenever&nbsp;the&nbsp;last&nbsp;event&nbsp;id&nbsp;for&nbsp;an&nbsp;event&nbsp;source&nbsp;is&nbsp;changed.&nbsp;The&nbsp;event&nbsp;generated&nbsp;by&nbsp;a&nbsp;change&nbsp;in&nbsp;the&nbsp;last&nbsp;event&nbsp;id&nbsp;would&nbsp;have&nbsp;that&nbsp;id&nbsp;value&nbsp;as&nbsp;an&nbsp;attribute,&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;href&nbsp;for&nbsp;the&nbsp;event&nbsp;source&nbsp;associated&nbsp;with&nbsp;the&nbsp;id.&nbsp;&lt;br&gt;<br>
&lt;br&gt;We&nbsp;prefer&nbsp;the&nbsp;first&nbsp;solution,&nbsp;but&nbsp;any&nbsp;solution&nbsp;would&nbsp;be&nbsp;good.&nbsp;Any&nbsp;suggestions&nbsp;for&nbsp;a&nbsp;better&nbsp;solution?&lt;br&gt;&lt;br&gt;&lt;br&gt;-Michael&nbsp;Carter&lt;br&gt;<br>

</tt>
