<tt>
Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;noticed&nbsp;that&nbsp;WebSocket&nbsp;spec&nbsp;updated&nbsp;to&nbsp;not&nbsp;inlcude&nbsp;framing&nbsp;overhead&nbsp;in&nbsp;bufferedAmount. &lt;a&nbsp;href=&quot;http://lists.whatwg.org/pipermail/commit-watchers-whatwg.org/2010/003971.html&quot;&gt;http://lists.whatwg.org/pipermail/commit-watchers-whatwg.org/2010/003971.html&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;tried&nbsp;to&nbsp;implement&nbsp;it&nbsp;in&nbsp;WebKit,&nbsp;but&nbsp;found&nbsp;it&nbsp;make&nbsp;hard&nbsp;to&nbsp;implement&nbsp;correctly. &lt;a&nbsp;href=&quot;https://bugs.webkit.org/show_bug.cgi?id=35571&quot;&gt;https://bugs.webkit.org/show_bug.cgi?id=35571&lt;/a&gt;&lt;/div&gt;&lt;div&gt;It&#39;s&nbsp;easy&nbsp;after&nbsp;WebSocket&nbsp;is&nbsp;closed&nbsp;(just&nbsp;add&nbsp;length&nbsp;of&nbsp;message),&nbsp;but&nbsp;while&nbsp;it&#39;s&nbsp;open,&nbsp;we&#39;ll&nbsp;manage&nbsp;buffer&nbsp;including&nbsp;frame&nbsp;bytes&nbsp;and&nbsp;underlying&nbsp;socket&nbsp;will&nbsp;write&nbsp;arbitrary&nbsp;length&nbsp;of&nbsp;the&nbsp;buffer&nbsp;(may&nbsp;not&nbsp;be&nbsp;on&nbsp;frame&nbsp;boundary)&lt;/div&gt;<br>
<br>
&lt;div&gt;To&nbsp;get&nbsp;bufferdAmount&nbsp;correctly&nbsp;without&nbsp;framing&nbsp;overhead,&nbsp;we&nbsp;need&nbsp;to&nbsp;parse&nbsp;the&nbsp;buffer&nbsp;again.&nbsp; It&#39;s&nbsp;not&nbsp;light&nbsp;operation&nbsp;and&nbsp;it&#39;s&nbsp;challenge&nbsp;to&nbsp;make&nbsp;it&nbsp;effective.&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;including&nbsp;frame&nbsp;overhead&nbsp;is&nbsp;much&nbsp;easier.&lt;/div&gt;<br>
<br>
&lt;div&gt;Could&nbsp;you&nbsp;revert&nbsp;it?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-- &lt;/div&gt;&lt;div&gt;Fumitoshi&nbsp;Ukai&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
