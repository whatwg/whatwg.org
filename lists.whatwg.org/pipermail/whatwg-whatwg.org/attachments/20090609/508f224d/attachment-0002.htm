<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;This&nbsp;is&nbsp;the&nbsp;solution&nbsp;that&nbsp;Firefox&nbsp;3.5&nbsp;uses.&nbsp;We&nbsp;use&nbsp;a&nbsp;pool&nbsp;of&lt;br&gt;<br>
relatively&nbsp;few&nbsp;OS&nbsp;threads&nbsp;(5&nbsp;or&nbsp;so&nbsp;iirc).&nbsp;This&nbsp;pool&nbsp;is&nbsp;then&nbsp;scheduled&lt;br&gt;<br>
to&nbsp;run&nbsp;worker&nbsp;tasks&nbsp;as&nbsp;they&nbsp;are&nbsp;scheduled.&nbsp;So&nbsp;for&nbsp;example&nbsp;if&nbsp;you&lt;br&gt;<br>
create&nbsp;1000&nbsp;worker&nbsp;objects,&nbsp;those&nbsp;5&nbsp;threads&nbsp;will&nbsp;take&nbsp;turns&nbsp;to&nbsp;execute&lt;br&gt;<br>
the&nbsp;initial&nbsp;scripts&nbsp;one&nbsp;at&nbsp;a&nbsp;time.&nbsp;If&nbsp;you&nbsp;then&nbsp;send&nbsp;a&nbsp;message&nbsp;using&lt;br&gt;<br>
postMessage&nbsp;to&nbsp;500&nbsp;of&nbsp;those&nbsp;workers,&nbsp;and&nbsp;the&nbsp;other&nbsp;500&nbsp;calls&lt;br&gt;<br>
setTimeout&nbsp;in&nbsp;their&nbsp;initial&nbsp;script,&nbsp;the&nbsp;same&nbsp;threads&nbsp;will&nbsp;take&nbsp;turns&lt;br&gt;<br>
to&nbsp;run&nbsp;those&nbsp;1000&nbsp;tasks&nbsp;(500&nbsp;message&nbsp;events,&nbsp;and&nbsp;500&nbsp;timer&nbsp;callbacks).&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;somewhat&nbsp;simplified,&nbsp;and&nbsp;things&nbsp;are&nbsp;a&nbsp;little&nbsp;more&nbsp;complicated&lt;br&gt;<br>
due&nbsp;to&nbsp;how&nbsp;we&nbsp;handle&nbsp;synchronous&nbsp;network&nbsp;loads&nbsp;(during&nbsp;which&nbsp;we&nbsp;freeze&lt;br&gt;<br>
and&nbsp;OS&nbsp;thread&nbsp;and&nbsp;remove&nbsp;it&nbsp;from&nbsp;the&nbsp;pool),&nbsp;but&nbsp;the&nbsp;above&nbsp;is&nbsp;the&nbsp;basic&lt;br&gt;<br>
idea.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
/&nbsp;Jonas&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thats&nbsp;a&nbsp;really&nbsp;good&nbsp;model.&nbsp;Scalable&nbsp;and&nbsp;degrades&nbsp;nicely.&nbsp;The&nbsp;only&nbsp;problem&nbsp;is&nbsp;with&nbsp;very&nbsp;long&nbsp;running&nbsp;operations&nbsp;where&nbsp;a&nbsp;worker&nbsp;script&nbsp;doesn&#39;t&nbsp;return&nbsp;in&nbsp;a&nbsp;timely&nbsp;fashion.&nbsp;If&nbsp;enough&nbsp;of&nbsp;them&nbsp;do&nbsp;that,&nbsp;all&nbsp;others&nbsp;starve.&nbsp;What&nbsp;does&nbsp;FF&nbsp;do&nbsp;about&nbsp;that,&nbsp;or&nbsp;in&nbsp;practice&nbsp;do&nbsp;you&nbsp;anticipate&nbsp;that&nbsp;not&nbsp;being&nbsp;an&nbsp;issue?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Webkit&nbsp;dedicates&nbsp;an&nbsp;OS&nbsp;thread&nbsp;per&nbsp;worker.&nbsp;Chrome&nbsp;goes&nbsp;even&nbsp;further&nbsp;(for&nbsp;now&nbsp;at&nbsp;least)&nbsp;with&nbsp;a&nbsp;process&nbsp;per&nbsp;worker.&nbsp;The&nbsp;1:1&nbsp;mapping&nbsp;is&nbsp;probably&nbsp;overkill&nbsp;as&nbsp;most&nbsp;workers&nbsp;will&nbsp;probably&nbsp;spend&nbsp;most&nbsp;of&nbsp;their&nbsp;life&nbsp;asleep&nbsp;just&nbsp;waiting&nbsp;for&nbsp;a&nbsp;message.&lt;/div&gt;<br>

</tt>
