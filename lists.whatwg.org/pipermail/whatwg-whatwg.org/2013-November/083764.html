<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] &lt;imgset&gt; responsive imgs proposition (Re: The src-N proposal)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Cimgset%3E%20responsive%20imgs%20proposition%20%28Re%3A%20The%20src-N%0A%20proposal%29&In-Reply-To=%3CCEABEDE4.7ADF2%25bruno%40hexanet.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="083763.html">
   <LINK REL="Next"  HREF="083765.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] &lt;imgset&gt; responsive imgs proposition (Re: The src-N proposal)</H1>
<!--htdig_noindex-->
    <B>Bruno Racineux</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20%3Cimgset%3E%20responsive%20imgs%20proposition%20%28Re%3A%20The%20src-N%0A%20proposal%29&In-Reply-To=%3CCEABEDE4.7ADF2%25bruno%40hexanet.net%3E"
       TITLE="[whatwg] &lt;imgset&gt; responsive imgs proposition (Re: The src-N proposal)">bruno at hexanet.net
       </A><BR>
    <I>Fri Nov 15 18:26:03 PST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="083763.html">[whatwg] &lt;imgset&gt; responsive imgs proposition (Re: The src-N	proposal)
</A></li>
        <LI>Next message: <A HREF="083765.html">[whatwg] &lt;imgset&gt; responsive imgs proposition (Re: The src-N proposal)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83764">[ date ]</a>
              <a href="thread.html#83764">[ thread ]</a>
              <a href="subject.html#83764">[ subject ]</a>
              <a href="author.html#83764">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>
On 11/15/13 3:23 PM, &quot;Tab Atkins Jr.&quot; &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jackalmage at gmail.com</A>&gt; wrote:

&gt;<i>I don't understand.  You don't &quot;repeat&quot; any sources, you specify them
</I>&gt;<i>once.  There's just a batch of sources per image.  Can't make this
</I>&gt;<i>more compact.
</I>
What I mean is that with src-N you will have to repeat the paths AND the
full batch for every image that share the same source+breakpoint pattern
unless you use a template or regex model.

Assuming your RespImg EXAMPLE 5 (from the draft):

&lt;img src-1=&quot;100% (30em) 50% (50em) calc(33% - 100px);
             pic100.png 100, pic200.png 200, pic400.png 400,
             pic800.png 800, pic1600.png 1600, pic3200.png 3200&quot;&gt;


In the real world with clouds, this is your average prospect size of it
with just 4 imgs:

&lt;img src=&quot;<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698601_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698601_m.jpg</A>&quot;
src-1=&quot;100% (30em) 50% (50em) calc(33% - 100px);
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698601_s.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698601_s.jpg</A> 100,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698601_t.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698601_t.jpg</A> 200,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698601_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698601_m.jpg</A> 400,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698601_l.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698601_l.jpg</A> 800,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698601_xl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698601_xl.jpg</A> 1600,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698601_xxl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698601_xxl.jpg</A> 3200&quot;&gt;
&lt;img src=&quot;<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698602_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698602_m.jpg</A>&quot;
src-1=&quot;100% (30em) 50% (50em) calc(33% - 100px);
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698602_s.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698602_s.jpg</A> 100,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698602_t.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698602_t.jpg</A> 200,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698602_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698602_m.jpg</A> 400,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698602_l.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698602_l.jpg</A> 800,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698602_xl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698602_xl.jpg</A> 1600,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698602_xxl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698602_xxl.jpg</A> 3200&quot;&gt;
&lt;img src=&quot;<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698603_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698603_m.jpg</A>&quot;
src-1=&quot;100% (30em) 50% (50em) calc(33% - 100px);
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698603_s.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698603_s.jpg</A> 100,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698603_t.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698603_t.jpg</A> 200,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698603_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698603_m.jpg</A> 400,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698603_l.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698603_l.jpg</A> 800,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698603_xl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698603_xl.jpg</A> 1600,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698603_xxl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698603_xxl.jpg</A> 3200&quot;&gt;
&lt;img src=&quot;<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698604_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698604_m.jpg</A>&quot;
src-1=&quot;100% (30em) 50% (50em) calc(33% - 100px);
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698604_s.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698604_s.jpg</A> 100,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698604_t.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698604_t.jpg</A> 200,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698604_m.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698604_m.jpg</A> 400,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698604_l.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698604_l.jpg</A> 800,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698604_xl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698604_xl.jpg</A> 1600,
<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698604_xxl.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698604_xxl.jpg</A> 3200&quot;&gt;

Now imagine 20 images... Or an additional src-N to each of them...
While gzip size will generally compact those fairly well, that affects the
overall size of your page (especially if images sizes are identified by
folder instead of img suffix, where the compression will not be as good)
It is also making the source difficult to read for debugging purpose
because of the length.  This what I mean by bloat.

While that doesn't seem to be of everyone's concern, the raw byte size of
pages will quadruple instantly with image galleries. That's not DRY,
and more memory consumption for mobiles.

&gt;<i>The repetition is in the MQs, and that's solveable quite directly and
</I>&gt;<i>generically with custom MQs.
</I>
It's in the src-path(s) too as explained above.

My imgset template model only gives you this per image instead:

&lt;img src=&quot;<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698606_t.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698606_t.jpg</A>&quot;
     imgset=&quot;flick 100% (30em) 50% (50em) calc(33% - 100px);&quot;&gt;

Or even less if that 'variable sized' MQ language is also tokenized at the
head level (which you currently seem to working on):

&lt;img src=&quot;<A HREF="http://farm8.staticflickr.com/7325/10858537575_e6af698606_t.jpg">http://farm8.staticflickr.com/7325/10858537575_e6af698606_t.jpg</A>&quot;
     imgset=&quot;flick@('flexsize');&quot;&gt;

&gt;<i>
</I>&gt;&gt;<i> Here is an update along my initial model with John's example, and
</I>&gt;&gt;<i> custom media-vars (with the syntax we discussed on the w3cstyle list):
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;head&gt;
</I>&gt;&gt;<i> &lt;style&gt;
</I>&gt;&gt;<i>  @media-var 'smallicon' (max-width: 19.99em);
</I>&gt;&gt;<i>  @media-var 'flexwidth' (min-width: 20em);
</I>&gt;&gt;<i>  @imgset 'set-1' (64 64 1x, 128 128 1x, 256 256 1x 128 2x 64 3x),
</I>&gt;&gt;<i>regexp();
</I>&gt;&gt;<i>  @imgset 'set-2' (160 160, 320 320, 640 640, 1280 1280), regexp();
</I>&gt;&gt;<i> &lt;/style&gt;
</I>&gt;&gt;<i> &lt;/head&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;img src=&quot;fallback.jpg&quot;
</I>&gt;&gt;<i>      imgset=&quot;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">set-1 at media</A>('smallicon') 128px;
</I>&gt;&gt;<i>              <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">set-2 at media</A>('flexwidth') 100% (30em) 50% (50em) 33%&quot;&gt;
</I>&gt;<i>
</I>&gt;<i>Where are the source urls?  Are they supposed to be those numbers in
</I>&gt;<i>@imgset?  What does regexp() mean?  I don't understand your use of
</I>&gt;<i>commas in @imgset.
</I>
There is no need for other src urls other than the base src template.
All you have to do is replace the suffix, folder, or other pattern from
that path (as defined by the framework which resizes your images), using
either the regex pattern or a template model, to load the right image.

I am not aware of the css specs grammar restrictions enough to define
perfectly applicable syntax, so please indulge my syntax errors.
It's more of your specialty.

I just figured I'd use something similar to @media or @document to
have a syntax close to @media that doesn&#185;t require a full css parser for
the other syntax, and separate the @imgset language from that of the css
presentational syntax. (as you expressed against including in the head,
which I think I agree would be possibly conflicting)

&gt;<i>
</I>&gt;&gt;<i> It does not require the preloader to have full css parser. It only has
</I>&gt;&gt;<i>to
</I>&gt;&gt;<i> parse @media and the new @imgset CSS subset language, using a similar
</I>&gt;&gt;<i> syntax to @media. And I believe if offer an easy way to polyfill this.
</I>&gt;<i>
</I>&gt;<i>This isn't as terrible for polyfilling, since it's easier to spot
</I>&gt;<i>things and extract them with a regex.  I find it less understandable,
</I>&gt;<i>though this might be because you haven't explained most of your syntax
</I>&gt;<i>and possibly have some syntax errors.
</I>
Fair enough, my initial email was badly cut with automatic line-breaks...

I'll expand:

&lt;style&gt;

@media-var 'smallicon' (max-width: 19.99em);
@media-var 'flexwidth' (min-width: 20em);

Here, as we discussed on w3style you tokenize MQs with custom-vars using
string keywords to centralize them and avoid the MQ repeats.

@imgset 'set-1' (64 64 1x, 128 128 1x, 256 256 1x 128 2x 64 3x), regexp();
@imgset 'set-2' (160 160, 320 320, 640 640, 1280 1280), regexp();

Above, the new @imgset 'css subset' grammar define reusable imgset classes
'set-1' and 'set-2'.

They list the set of images with their respective width and resolutions
just like you list the images in src-N, expect that we only specify a
token (instead of the full src). The full path is determined by the
browser with a replace() using the regexp() pattern.

Generally this is the suffix of the images like the flickr example. I just
didn't put a regex because in John's example he had named the img with the
actual width, (hence the 'width with' repeats where the first word is the
actual token) and like I said, I suck at regex.

For more clarity, take this updated initial example (from the beginning of
the thread):

@imgset 'set-1' (small 150 1x, medium 200 1x, large 300 1x 150 2x),
		regexp(&quot;/(?&lt;=\-)(.*)(?=\.)/s&quot;);


And finally here, we define the two imget &quot;classes&quot; applicable to that
Image using the tokens we defined in the head, as well as possible mix and
match with other token or standard MQs.

&lt;img src=&quot;fallback.jpg&quot;
     imgset=&quot;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">set-1 at media</A>('smallicon') 128px;
             <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">set-2 at media</A>('flexwidth') 100% (30em) 50% (50em) 33%&quot;&gt;

The Imgset attributes allows for multiple classes, set in css style
fashion, with a slightly new shortcut syntax being:
<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">imgsetclass at media</A>('mycustomMQvarstring')

With a template or regex src replacement, we can make the fairly
Reasonable assumption that most images sizes can be replaced using a
single token
like '/my-image-{size-token}.jpg'

The exception to this, is the syntax used by other platforms like
Worpdress 
where the image template for different sizes is not a token, but the width
and height given as 'image-name-WidthxHeight.jpg'.

This case could be handled by not providing any regex rule for the @imgset
like: @imgset 'set-1' (1080, 1024, 960, 900, 854, 840, 800, 720, 640, 600);

In which case all the browser has to do is to automatically find the
height from the original ratio implied by the image element itself:
&lt;img width=&quot;600&quot; height=&quot;300&quot;

Which would make 'image-name-WidthxHeight.ext' the default, and
an even less verbose @imgset, since there is no need for image
replacement tokens. The browser can do this math automatically for
resolution etc.. 

The @imgset grammar is fairly simple and it only adds one attribute to the
DOM.






</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="083763.html">[whatwg] &lt;imgset&gt; responsive imgs proposition (Re: The src-N	proposal)
</A></li>
	<LI>Next message: <A HREF="083765.html">[whatwg] &lt;imgset&gt; responsive imgs proposition (Re: The src-N proposal)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#83764">[ date ]</a>
              <a href="thread.html#83764">[ thread ]</a>
              <a href="subject.html#83764">[ subject ]</a>
              <a href="author.html#83764">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
