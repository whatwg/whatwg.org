<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Supporting more address levels in autocomplete
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Supporting%20more%20address%20levels%20in%20autocomplete&In-Reply-To=%3CCAO4XGS88fwsB97UG-8FQwBnmBTeW%3Dc7c%2BvyCa1zQCmBkyv3HUQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="084395.html">
   <LINK REL="Next"  HREF="084399.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Supporting more address levels in autocomplete</H1>
<!--htdig_noindex-->
    <B>Evan Stade</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Supporting%20more%20address%20levels%20in%20autocomplete&In-Reply-To=%3CCAO4XGS88fwsB97UG-8FQwBnmBTeW%3Dc7c%2BvyCa1zQCmBkyv3HUQ%40mail.gmail.com%3E"
       TITLE="[whatwg] Supporting more address levels in autocomplete">estade at chromium.org
       </A><BR>
    <I>Mon Mar  3 14:53:24 PST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="084395.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
        <LI>Next message: <A HREF="084399.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84396">[ date ]</a>
              <a href="thread.html#84396">[ thread ]</a>
              <a href="subject.html#84396">[ subject ]</a>
              <a href="author.html#84396">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, Mar 3, 2014 at 2:18 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:

&gt;<i> On Mon, 3 Mar 2014, Evan Stade wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm still confused. The site author has entered bad markup. Is your
</I>&gt;<i> &gt; concern that site authors will be unable to write good markup?
</I>&gt;<i>
</I>&gt;<i> Some will write good markup, I'm sure.
</I>&gt;<i>
</I>&gt;<i> Our job as language designers is to maximise the number of authors doing a
</I>&gt;<i> good job, and minimise the number of authors who make unintentional
</I>&gt;<i> mistakes.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; There's no point us allowing address-level881. It will never be
</I>&gt;<i> &gt; &gt; useful.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Is there a point in disallowing it?
</I>&gt;<i>
</I>&gt;<i> Yeah. It simplifies the language, means there's less to test so it
</I>&gt;<i> simplifies testing, it simplifies authoring, it reduces tutorial
</I>&gt;<i> complexity, it makes answering questions like &quot;how many should I include&quot;
</I>&gt;<i> easy to answer, and so on.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Ultimately it doesn't matter too much, but I would think it's a goal to
</I>&gt;<i> &gt; avoid spec churn.
</I>&gt;<i>
</I>&gt;<i> Adding features isn't such a big deal, especially when they're in response
</I>&gt;<i> to changing political conditions.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; If we're going to set some limit, let's say 4.
</I>&gt;<i>
</I>&gt;<i> Ok.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; Well if for some reason you want to exclude non-US customers, sure.
</I>&gt;<i> &gt; &gt; But suppose you do want to include all customers, but you're a
</I>&gt;<i> &gt; &gt; mom-and-pop store who is just going to put what you put in the form
</I>&gt;<i> &gt; &gt; onto the envelope, and who doesn't know the intricacies of each
</I>&gt;<i> &gt; &gt; country's postal standards.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; How many fields should you list?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In this case, address-level-n doesn't help you. In order to be able to
</I>&gt;<i> &gt; write an address onto an envelope, you want an address blob, not
</I>&gt;<i> &gt; tokenized bits. This address blob was proposed further up the thread,
</I>&gt;<i> &gt; and I think it's a good idea, but distinct from the current topic, which
</I>&gt;<i> &gt; is how to get tokenized bits for places like China.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Of course, tokenized bits can be used to create an address blob, but it
</I>&gt;<i> &gt; requires some sophistication to do so.
</I>&gt;<i>
</I>&gt;<i> If you take the fields from the spec today and those proposed in this
</I>&gt;<i> thread, and concatenate them one-to-a-line in the following order:
</I>&gt;<i>
</I>&gt;<i>    &quot;organization&quot;
</I>&gt;<i>    &quot;address-line1&quot;
</I>&gt;<i>    &quot;address-line2&quot;
</I>&gt;<i>    &quot;address-line3&quot;
</I>&gt;<i>    &quot;address-level4&quot;
</I>&gt;<i>    &quot;address-level3&quot;
</I>&gt;<i>    &quot;address-level2&quot;
</I>&gt;<i>    &quot;address-level1&quot;
</I>&gt;<i>    &quot;country-name&quot;
</I>&gt;<i>    &quot;postal-code&quot;
</I>&gt;<i>
</I>&gt;<i> ...the mail is going to get where you want it to get, right?
</I>

&gt;<i> So for the mom-and-pop store, this seems like it would be sufficient.
</I>&gt;<i>
</I>&gt;<i> Even if they render it as:
</I>&gt;<i>
</I>&gt;<i>    &quot;organization&quot;
</I>&gt;<i>    &quot;address-line1&quot;
</I>&gt;<i>    &quot;address-line2&quot;
</I>&gt;<i>    &quot;address-line3&quot;
</I>&gt;<i>    &quot;address-level4&quot;, &quot;address-level3&quot; &quot;postal-code&quot;
</I>&gt;<i>    &quot;address-level2&quot; &quot;address-level1&quot;
</I>&gt;<i>    &quot;country-name&quot;
</I>&gt;<i>
</I>&gt;<i> ...so that it's optimised for the US, it would still work everywhere,
</I>&gt;<i> you'd just have some slightly annoyed postal staff in some countries.
</I>&gt;<i>
</I>
Or some automatic mail-sorting machines which reject your mail completely.
I think you have more confidence in the post office than I do. But again,
this is something to be addressed separately with a &quot;display-address&quot; token
(or whatever you want to call it).


&gt;<i>
</I>&gt;<i> So I don't think it's right to say that address-level* doesn't help you
</I>&gt;<i> in the mom-and-pop store case. It does.
</I>&gt;<i>
</I>
In some sense, you could put all the components of the address in a
completely random order and if you're lucky, they'll be unambiguous enough
for some human to figure it out. I don't think we should recommend people
do that though.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; I don't think you can just write a stack of inputs that accepts input
</I>&gt;<i> &gt; for any country. The country determines:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; a) what fields make sense
</I>&gt;<i> &gt; b) what fields are required
</I>&gt;<i> &gt; c) the order of fields
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You could ignore (a) and settle for a crappy UI that shows all fields
</I>&gt;<i> &gt; that make sense anywhere in the world, but you'd still be left with
</I>&gt;<i> &gt; solving (b) and (c).
</I>&gt;<i>
</I>&gt;<i> (b) is an easy-to-solve problem: you don't make any of them required, and
</I>&gt;<i> if the customer entered insufficient fields, they're not getting their
</I>&gt;<i> package, and will have to be contacted out-of-band.
</I>&gt;<i>
</I>
I don't think the additional load that would place on customer service, the
number of missing packages, etc., would be considered an &quot;easy&quot; problem or
even an improvement over whatever they currently have in place.


&gt;<i>
</I>&gt;<i> Can you elaborate on (c)?
</I>&gt;<i>
</I>
US looks like:

Recipient
Organization
Street address
City, State ZIP

Japan looks like:

&#12306; ZIP
State City
Street address
Organization
Recipient

Using the US format for a Japanese address would be fantastically bad.
Users in Japan would probably just enter their address in the way they
think of as &quot;forwards&quot; but your website thinks of as &quot;backwards&quot; meaning
you get the exact problem you pointed out earlier.


&gt;<i>
</I>&gt;<i> If this is something that's required to make user of these autofill
</I>&gt;<i> fields, then we should explain to authors what they need to do.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; Alternatively, if &quot;region&quot; is always the last address-level* value,
</I>&gt;<i> then
</I>&gt;<i> &gt; &gt; we could just do the mapping backwards:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;    address-line1
</I>&gt;<i> &gt; &gt;    address-line2
</I>&gt;<i> &gt; &gt;    address-line3
</I>&gt;<i> &gt; &gt;    address-levelN
</I>&gt;<i> &gt; &gt;    ...
</I>&gt;<i> &gt; &gt;    address-level3
</I>&gt;<i> &gt; &gt;    address-level2 = locality
</I>&gt;<i> &gt; &gt;    address-level1 = region
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This isn't backwards, this is what we're proposing.
</I>&gt;<i>
</I>&gt;<i> Then why would UAE be missing address-level1? I'm confused.
</I>&gt;<i>
</I>&gt;<i> The reason I say this is backwards is that it is the reverse of the
</I>&gt;<i> &quot;address-line*&quot; fields. This could be confusing.
</I>&gt;<i>
</I>
It's only reversed if you're talking about US display order. It's not
reversed in the sense that address-line-2 only makes sense if
address-line-1 has a value. It's the same: address-level-3 only makes sense
if address-level-2 has a value.


&gt;<i>
</I>&gt;<i> One question is whether the current &quot;locality&quot;, which is defined as
</I>&gt;<i> &quot;City, town, village, post town, or other locality within which the
</I>&gt;<i> relevant street address is found&quot;, should map to 4 or 2. If it maps to 2,
</I>&gt;<i> we'll probably have to change the way we define this to be more generic.
</I>&gt;<i>
</I>
Yes, that's why I'm suggesting we stop trying to create tokens which are
defined by real-world corollaries. If you ask my mom, Beijing is a city,
but technically it's a province-level city, so it's currently a &quot;region&quot;
rather than a &quot;locality&quot; despite the description of locality. So it's
easier to just say &quot;address-level-1&quot; which winds up being either a province
or a province-level city, or a state in the US, or whatever elsewhere in
the world.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; But maybe we can do better, and just have dedicated names. What
</I>&gt;<i> &gt; &gt; countries need more than two, today? How many do they each need? What
</I>&gt;<i> &gt; &gt; are they? If we had hard data here it might be easier to design a
</I>&gt;<i> &gt; &gt; better solution; do you happen to have that data?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; At least Korea, China, and Thailand need the third level. I think China
</I>&gt;<i> &gt; will need a 4th soon. Here's a rundown for Chinese administrative levels:
</I>&gt;<i> &gt; <A HREF="http://en.wikipedia.org/wiki/Administrative_divisions_of_China">http://en.wikipedia.org/wiki/Administrative_divisions_of_China</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The three that make it onto the envelope currently are:
</I>&gt;<i> &gt; &quot;Provincial level&quot;
</I>&gt;<i> &gt; &quot;Prefectural level&quot;
</I>&gt;<i> &gt; &quot;County level&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You can click through on the wikipedia link for explanations of the
</I>&gt;<i> &gt; various forms these levels take.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't think dedicated names are advisable given the wide variety of
</I>&gt;<i> &gt; names for each address level (even within a single country, much less
</I>&gt;<i> &gt; across all countries). For example, &quot;region&quot; is already super generic
</I>&gt;<i> &gt; and unhelpful.
</I>&gt;<i>
</I>&gt;<i> Being generic is kind of the point, since as you point out, different
</I>&gt;<i> countries have different levels.
</I>&gt;<i>
</I>
It's generic in the wrong way. As far as the English language is concerned,
a city is a region, a state is a region, a county is a region, etc.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; Is there a name for these fields that you think would be less confusing
</I>&gt;<i> &gt; to the authors?
</I>&gt;<i>
</I>&gt;<i> It sounds like we could have country-name, region, locality, province, but
</I>&gt;<i> I agree that at the end of the day it's just confusing to have four words
</I>&gt;<i> that are so vague that you can't tell what order they go in.
</I>&gt;<i>
</I>&gt;<i> Still, having 1,2,3,4,3,2,1 is kinda weird.
</I>&gt;<i>
</I>&gt;<i> Here's some dumb ideas. We could extend &quot;address-line&quot;, as follows:
</I>&gt;<i>
</I>&gt;<i>    &quot;address-line1&quot; |
</I>&gt;<i>    &quot;address-line2&quot; |- &quot;street-address&quot;
</I>&gt;<i>    &quot;address-line3&quot; |
</I>&gt;<i>    &quot;address-line5&quot;
</I>&gt;<i>    &quot;address-line6&quot;
</I>&gt;<i>    &quot;address-line7&quot; / &quot;locality&quot;
</I>&gt;<i>    &quot;address-line8&quot; / &quot;region&quot;
</I>&gt;<i>    &quot;address-line9&quot; / &quot;country-name&quot;
</I>&gt;<i>
</I>&gt;<i> This leaves one unused number in the middle (4), in case we need to add to
</I>&gt;<i> the street address side or the locality side.
</I>&gt;<i>
</I>&gt;<i> Or we could do:
</I>&gt;<i>
</I>&gt;<i>    &quot;address-line1&quot; |
</I>&gt;<i>    &quot;address-line2&quot; |- &quot;street-address&quot;
</I>&gt;<i>    &quot;address-line3&quot; |
</I>&gt;<i>    &quot;subsublocality&quot;
</I>&gt;<i>    &quot;sublocality&quot;
</I>&gt;<i>    &quot;locality&quot;
</I>&gt;<i>    &quot;region&quot;
</I>&gt;<i>    &quot;country-name&quot;
</I>&gt;<i>
</I>&gt;<i> ...or, similar, but extending region instead of locality:
</I>&gt;<i>
</I>&gt;<i>    &quot;address-line1&quot; |
</I>&gt;<i>    &quot;address-line2&quot; |- &quot;street-address&quot;
</I>&gt;<i>    &quot;address-line3&quot; |
</I>&gt;<i>    &quot;locality&quot;
</I>&gt;<i>    &quot;subsubregion&quot;
</I>&gt;<i>    &quot;subregion&quot;
</I>&gt;<i>    &quot;region&quot;
</I>&gt;<i>    &quot;country-name&quot;
</I>&gt;<i>
</I>&gt;<i> We could make &quot;region&quot; into a multi-line field like &quot;street-address&quot;:
</I>&gt;<i>
</I>&gt;<i>    &quot;address-line1&quot; |
</I>&gt;<i>    &quot;address-line2&quot; |- &quot;street-address&quot;
</I>&gt;<i>    &quot;address-line3&quot; |
</I>&gt;<i>    &quot;locality&quot;
</I>&gt;<i>    &quot;region-line1&quot; |
</I>&gt;<i>    &quot;region-line2&quot; |- &quot;region&quot;
</I>&gt;<i>    &quot;region-line3&quot; |
</I>&gt;<i>    &quot;country-name&quot;
</I>&gt;<i>
</I>
the problem with this one is that address-lineN is defined as the &quot;Nth line
of the street address&quot;, whereas the different levels of region are not
necessarily split onto different lines (depending on the country of
course). So it's a false analogy to think of these different indexed things
as the same. In the US case, region-line1 would be &quot;Los Angeles, CA&quot; but in
reality almost all sites want this tokenized into &quot;Los Angeles&quot; and &quot;CA&quot;.


&gt;<i>
</I>&gt;<i> Or alternatively:
</I>&gt;<i>
</I>&gt;<i>    &quot;address-line1&quot; |
</I>&gt;<i>    &quot;address-line2&quot; |- &quot;street-address&quot;
</I>&gt;<i>    &quot;address-line3&quot; |
</I>&gt;<i>    &quot;region-level5&quot;
</I>&gt;<i>    &quot;region-level4&quot;
</I>&gt;<i>    &quot;region-level3&quot; / &quot;locality&quot;
</I>&gt;<i>    &quot;region-level2&quot; / &quot;region&quot;
</I>&gt;<i>    &quot;region-level1&quot; / &quot;country-name&quot;
</I>&gt;<i>
</I>&gt;<i> Compared to those, the main proposal here doesn't seem that much better
</I>&gt;<i> necessarily:
</I>&gt;<i>
</I>&gt;<i>    &quot;address-line1&quot; |
</I>&gt;<i>    &quot;address-line2&quot; |- &quot;street-address&quot;
</I>&gt;<i>    &quot;address-line3&quot; |
</I>&gt;<i>    &quot;address-level4&quot;
</I>&gt;<i>    &quot;address-level3&quot;
</I>&gt;<i>    &quot;address-level2&quot; / &quot;locality&quot;
</I>&gt;<i>    &quot;address-level1&quot; / &quot;region&quot;
</I>&gt;<i>    &quot;country-name&quot;
</I>&gt;<i>
</I>&gt;<i> I dunno. Anyone else want to try to pick a colour for this bikeshed?
</I>

Again, you really can't just put a stack of input fields and have it make
sense anywhere. If you are presenting a UI to enter addresses, there's no
way you can escape actually knowing how addresses are formatted around the
world. (Well, there's requestAutocomplete.) So looking at the naming scheme
in the context of wanting to just stack up a bunch of &lt;input&gt;s is not
informative.

I'm not married to the address-levelN name. [something-that-makes-sense]N
is fine. The reason we went with proposing address-levelN is because
region-levelN implies that all political regions are captured, when they
aren't. There's no field for US county because county is never part of an
address. So it's only for regions that actually make it onto an envelope.


&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; &gt; &gt; Are we going to have a list in the spec giving how many levels
</I>&gt;<i> &gt; &gt; &gt; &gt; should be given for each country?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; No. That is up to the site's ability to handle the data. For
</I>&gt;<i> &gt; &gt; &gt; example, if I'm soliciting *just* US addresses, I wouldn't know what
</I>&gt;<i> &gt; &gt; &gt; to do with address-level3, hence I won't ask for it.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Ok. What do you do if you're soliciting addresses from any country?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I put all the fields my database or payments backend or w/e can handle.
</I>&gt;<i> &gt; If there's no column for address-level-4 in my database, I don't put a
</I>&gt;<i> &gt; field for address-level-4 in my webpage.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Then I hide them all and invoke requestAutocomplete. Or I write
</I>&gt;<i> &gt; complicated JS to manipulate my markup to show the user what they expect
</I>&gt;<i> &gt; to see based on which country they're entering info for (hide the fields
</I>&gt;<i> &gt; that don't make sense, mark &quot;required&quot; for the ones that are necessary,
</I>&gt;<i> &gt; etc.)
</I>&gt;<i>
</I>&gt;<i> requestAutocomplete() is a proprietary Chrome thing right now, so we
</I>&gt;<i> shouldn't be recommending that people use it. (I'd love for other browsers
</I>&gt;<i> to pick it up, since I agree that it makes things like this WAY better.
</I>&gt;<i> But that's academic until they do.)
</I>&gt;<i>
</I>&gt;<i> Similarly, I think requiring &quot;complicated JS&quot; is a too-high barrier for
</I>&gt;<i> many authors, at least if we don't give explicit advice as to what this JS
</I>&gt;<i> should do.
</I>&gt;<i>
</I>&gt;<i> Hence the question, what should authors do if they're soliciting addresses
</I>&gt;<i> from any country, if we don't tell them what this &quot;complicated JS&quot; is to
</I>&gt;<i> do?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ian Hickson               U+1047E                )\._.,--....,'``.    fL
</I>&gt;<i> <A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
</I>&gt;<i> Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="084395.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
	<LI>Next message: <A HREF="084399.html">[whatwg] Supporting more address levels in autocomplete
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84396">[ date ]</a>
              <a href="thread.html#84396">[ thread ]</a>
              <a href="subject.html#84396">[ subject ]</a>
              <a href="author.html#84396">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
