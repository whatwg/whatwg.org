<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Document's base URI should use the document's *current* address
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Document%27s%20base%20URI%20should%20use%20the%20document%27s%0A%20%2Acurrent%2A%20address&In-Reply-To=%3C4F42EE7B.7030302%40westnet.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="077179.html">
   <LINK REL="Next"  HREF="077204.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Document's base URI should use the document's *current* address</H1>
<!--htdig_noindex-->
    <B>Sean Hogan</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Document%27s%20base%20URI%20should%20use%20the%20document%27s%0A%20%2Acurrent%2A%20address&In-Reply-To=%3C4F42EE7B.7030302%40westnet.com.au%3E"
       TITLE="[whatwg] Document's base URI should use the document's *current* address">shogun70 at westnet.com.au
       </A><BR>
    <I>Mon Feb 20 17:08:11 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="077179.html">[whatwg] Document's base URI should use the document's *current* address
</A></li>
        <LI>Next message: <A HREF="077204.html">[whatwg] Document's base URI should use the document's	*current* address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77183">[ date ]</a>
              <a href="thread.html#77183">[ thread ]</a>
              <a href="subject.html#77183">[ subject ]</a>
              <a href="author.html#77183">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 20/02/12 2:35 PM, Sean Hogan wrote:
&gt;<i> On 16/02/12 5:03 PM, Justin Lebar wrote:
</I>&gt;&gt;<i> On Wed, Feb 15, 2012 at 5:31 PM, Ian Hickson&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt;  wrote:
</I>&gt;&gt;&gt;<i> On Wed, 15 Feb 2012, Justin Lebar wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>   - It sets &quot;the document's current address&quot; to &quot;.../page.html#foo&quot;.
</I>&gt;&gt;&gt;&gt;<i> Well, this is pretty bad.  document.location is the document's current
</I>&gt;&gt;&gt;&gt;<i> address [1].  So clicking #foo changed document.location from 
</I>&gt;&gt;&gt;&gt;<i> page2.html
</I>&gt;&gt;&gt;&gt;<i> to page.html#foo, which I certainly wouldn't expect (and does not 
</I>&gt;&gt;&gt;&gt;<i> match
</I>&gt;&gt;&gt;&gt;<i> implementations).
</I>&gt;&gt;&gt;<i> Seems to me we should change the implementations then. There isn't any
</I>&gt;&gt;&gt;<i> fundamental difference between linking to #foo and linking to
</I>&gt;&gt;&gt;<i> page.html#foo if the base URL is page.html, as far as I can tell.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If the implementations can't change, then I'll change the spec, but it
</I>&gt;&gt;&gt;<i> really seems bad to me that relative URLs will break depending on when
</I>&gt;&gt;&gt;<i> they are resolved relative to pushState() changes.
</I>&gt;&gt;<i> When I implemented pushState, I explicitly didn't want authors to have
</I>&gt;&gt;<i> to rewrite all their anchor links after they changed the document's
</I>&gt;&gt;<i> current URI.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; From an author's point of view, there's no such thing as the
</I>&gt;&gt;<i> document's original URI and, unless you're a nerd, you've never heard
</I>&gt;&gt;<i> of the base URI.  There's just the document's URI, modified by
</I>&gt;&gt;<i> pushState.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; From this point of view, I'd say it's less surprising that relative
</I>&gt;&gt;<i> URIs would break when you change directories (hey, you *asked* for it)
</I>&gt;&gt;<i> than that anchor refs would update the browser's address bar and
</I>&gt;&gt;<i> document.location relative to the old URI.
</I>&gt;<i>
</I>&gt;<i> I share your perspective, Justin (if I'm interpreting it correctly).
</I>&gt;<i>
</I>
&lt;snip&gt;
&gt;<i> By the way, this doesn't quite match what is currently implemented in 
</I>&gt;<i> Firefox and Webkit. According to my testing, although the baseURI 
</I>&gt;<i> after pushState() is the same as the documentURI (so far I've tested 
</I>&gt;<i> &lt;img&gt;, &lt;link&gt; and &lt;a&gt; elts) the actual images and stylesheets used for 
</I>&gt;<i> rendering aren't updated by the pushState() - they should be updated 
</I>&gt;<i> if @src, @href is a rel path. If they were updated then the ones 
</I>&gt;<i> relying on rel paths would often break, which I consider a good 
</I>&gt;<i> behavior - an obvious visual cue to the page author, etc that 
</I>&gt;<i> something was implemented wrongly.
</I>&gt;<i>
</I>&gt;<i> Sean
</I>&gt;<i>
</I>&gt;<i>
</I>
I've just realized that Firefox's behavior matches the spec for dynamic 
changes to base URLs,
<A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#dynamic-changes-to-base-urls">http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#dynamic-changes-to-base-urls</A>

Personally I think that facilitates broken behavior, but it's not 
significant as the issue of this thread.

Sean


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="077179.html">[whatwg] Document's base URI should use the document's *current* address
</A></li>
	<LI>Next message: <A HREF="077204.html">[whatwg] Document's base URI should use the document's	*current* address
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#77183">[ date ]</a>
              <a href="thread.html#77183">[ thread ]</a>
              <a href="subject.html#77183">[ subject ]</a>
              <a href="author.html#77183">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
