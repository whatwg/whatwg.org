<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] First or last Content-Type header?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20First%20or%20last%20Content-Type%20header%3F&In-Reply-To=%3C4A25753A.4080006%40corry.biz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020050.html">
   <LINK REL="Next"  HREF="020057.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] First or last Content-Type header?</H1>
<!--htdig_noindex-->
    <B>Bil Corry</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20First%20or%20last%20Content-Type%20header%3F&In-Reply-To=%3C4A25753A.4080006%40corry.biz%3E"
       TITLE="[whatwg] First or last Content-Type header?">bil at corry.biz
       </A><BR>
    <I>Tue Jun  2 11:53:46 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020050.html">[whatwg] First or last Content-Type header?
</A></li>
        <LI>Next message: <A HREF="020057.html">[whatwg] First or last Content-Type header?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20053">[ date ]</a>
              <a href="thread.html#20053">[ thread ]</a>
              <a href="subject.html#20053">[ subject ]</a>
              <a href="author.html#20053">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Adam Barth wrote on 6/2/2009 11:47 AM: 
&gt;<i> On Tue, Jun 2, 2009 at 9:25 AM, Bil Corry &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bil at corry.biz</A>&gt; wrote:
</I>&gt;&gt;<i> It's less likely to occur legitimately, but more likely to occur under a header injection scenario.
</I>&gt;<i> 
</I>&gt;<i> As I wrote before in this thread, if the attacker can inject headers,
</I>&gt;<i> there are far more severe attacks than changing the type of an HTTP
</I>&gt;<i> response.
</I>
That may be true, but changing the content-type is a very serious issue, as you yourself point out in the draft we're discussing:

   When a user agent uses different
   heuristics for media type detection than the server expects, security
   problems can occur.  For example, if a server believes that the
   client will treat a contributed file as an image (and thus treat it
   as benign), but a user agent believes the content to be HTML (and
   thus privileged to execute any scripts contained therein), an
   attacker might be able to steal the user's authentication credentials
   and mount other cross-site scripting attacks.

   from: <A HREF="http://www.ietf.org/internet-drafts/draft-abarth-mime-sniff-01.txt">http://www.ietf.org/internet-drafts/draft-abarth-mime-sniff-01.txt</A>


Perhaps the better choice would be to toss out the multiple content-headers entirely and rely exclusively on content-sniffing.  Without the content-header, Firefox 3 correctly shows the image, and Internet Explorer incorrectly delivers the payload -- but your draft, if adopted, should fix that problem, correct?


- Bil

</PRE>









<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020050.html">[whatwg] First or last Content-Type header?
</A></li>
	<LI>Next message: <A HREF="020057.html">[whatwg] First or last Content-Type header?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20053">[ date ]</a>
              <a href="thread.html#20053">[ thread ]</a>
              <a href="subject.html#20053">[ subject ]</a>
              <a href="author.html#20053">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
