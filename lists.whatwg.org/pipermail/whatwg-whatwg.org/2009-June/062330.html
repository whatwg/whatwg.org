<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] First or last Content-Type header?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20First%20or%20last%20Content-Type%20header%3F&In-Reply-To=%3C4A259773.4000703%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="062326.html">
   <LINK REL="Next"  HREF="062331.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] First or last Content-Type header?</H1>
<!--htdig_noindex-->
    <B>Den.Molib</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20First%20or%20last%20Content-Type%20header%3F&In-Reply-To=%3C4A259773.4000703%40gmail.com%3E"
       TITLE="[whatwg] First or last Content-Type header?">den.molib at gmail.com
       </A><BR>
    <I>Tue Jun  2 14:19:47 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="062326.html">[whatwg] First or last Content-Type header?
</A></li>
        <LI>Next message: <A HREF="062331.html">[whatwg] First or last Content-Type header?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62330">[ date ]</a>
              <a href="thread.html#62330">[ thread ]</a>
              <a href="subject.html#62330">[ subject ]</a>
              <a href="author.html#62330">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Bil Corry wrote:
&gt;<i> It's less likely to occur legitimately, but more likely to occur under a header injection scenario.  For example, here's a page that simulates serving an image from an untrusted user[1], with the correct content-type of image/x-ms-bmp, then a second (injected) content-type of text/html:
</I>&gt;<i>
</I>&gt;<i> 	<A HREF="http://www.corry.biz:40100/">http://www.corry.biz:40100/</A>
</I>&gt;<i>
</I>&gt;<i> In Firefox 3, the page renders as HTML and delivers its hidden JavaScript payload, but in Internet Explorer 8, the page renders as a BMP image with no payload being delivered.  It seems to me that IE has the correct behavior, or at least the more desirable behavior in this case.
</I>&gt;<i>   
</I>
1. The server or the script language you used to inject the payload may
be replacing the header when you add the second header.
2. Browsers in widespread use take into account the last header.

Thus, presending a header is not a method to protect the app.



&gt;<i> Perhaps the better choice would be to toss out the multiple content-headers entirely and rely exclusively on content-sniffing.  Without the content-header, Firefox 3 correctly shows the image, and Internet Explorer incorrectly delivers the payload -- but your draft, if adopted, should fix that problem, correct?
</I>&gt;<i>
</I>&gt;<i> - Bil
</I>&gt;<i>   
</I>How do you send as plain text html content (eg. samples of malicious
javascript) if using just heuristics?

Or simply send a html-howto in plain text.


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="062326.html">[whatwg] First or last Content-Type header?
</A></li>
	<LI>Next message: <A HREF="062331.html">[whatwg] First or last Content-Type header?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#62330">[ date ]</a>
              <a href="thread.html#62330">[ thread ]</a>
              <a href="subject.html#62330">[ subject ]</a>
              <a href="author.html#62330">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
