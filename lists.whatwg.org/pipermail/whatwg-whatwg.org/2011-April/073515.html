<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Proposing &lt;canvas&gt;.toBlob(contentType)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposing%20%3Ccanvas%3E.toBlob%28contentType%29&In-Reply-To=%3CBANLkTin17%2BNrWzsD__bDBPCSveSf3YQ%2BeA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="031241.html">
   <LINK REL="Next"  HREF="073516.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Proposing &lt;canvas&gt;.toBlob(contentType)</H1>
<!--htdig_noindex-->
    <B>Glenn Maynard</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Proposing%20%3Ccanvas%3E.toBlob%28contentType%29&In-Reply-To=%3CBANLkTin17%2BNrWzsD__bDBPCSveSf3YQ%2BeA%40mail.gmail.com%3E"
       TITLE="[whatwg] Proposing &lt;canvas&gt;.toBlob(contentType)">glenn at zewt.org
       </A><BR>
    <I>Wed Apr 13 15:36:05 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="031241.html">[whatwg] Proposing &lt;canvas&gt;.toBlob(contentType)
</A></li>
        <LI>Next message: <A HREF="073516.html">[whatwg] Proposing &lt;canvas&gt;.toBlob(contentType)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73515">[ date ]</a>
              <a href="thread.html#73515">[ thread ]</a>
              <a href="subject.html#73515">[ subject ]</a>
              <a href="author.html#73515">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, Apr 13, 2011 at 6:02 PM, Kyle Huey &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">me at kylehuey.com</A>&gt; wrote:
&gt;<i> Gecko 2.0 ships with a non-standard method on &lt;canvas&gt; named
</I>&gt;<i> mozGetAsFile(contentType, fileName). &#160;We added this for internal use in our
</I>&gt;<i> UI. &#160;It retrieves the contents of the canvas as a File object (at the time
</I>&gt;<i> Gecko did not supports Blobs) encoded in the contentType according to the
</I>&gt;<i> same rules toDataURL uses.
</I>&gt;<i>
</I>&gt;<i> I propose adding a toBlob(contentType) method to the canvas element in the
</I>&gt;<i> style of toDataURL. &#160;This would greatly increase the options available to
</I>&gt;<i> developers for extracting data from a canvas element (a Blob can be saved to
</I>&gt;<i> disk, XHRed, etc.)
</I>
FYI: <A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2010-December/029517.html">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2010-December/029517.html</A>

As I mentioned there, I strongly recommend this be an asynchronous
call.  Compressing images can take time, and even a small image that
only takes 300ms is enough to cause a hitch in the browser's UI.  For
example,

r = canvas.getReader();
r.onload = function(blob) { blob = r.result; }
r.readBlob();

following the pattern of FileReader (and probably borrowing from its
spec, after it stabilizes).

This allows browsers to optionally thread compression or (more likely)
run it in slices, and this API would allow Progress Events
(onprogress) to be supported later on, useful when compressing large
images (which may take several seconds).

-- 
Glenn Maynard

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="031241.html">[whatwg] Proposing &lt;canvas&gt;.toBlob(contentType)
</A></li>
	<LI>Next message: <A HREF="073516.html">[whatwg] Proposing &lt;canvas&gt;.toBlob(contentType)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73515">[ date ]</a>
              <a href="thread.html#73515">[ thread ]</a>
              <a href="subject.html#73515">[ subject ]</a>
              <a href="author.html#73515">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
