<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Charset sniffing from XML prolog
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Charset%20sniffing%20from%20XML%20prolog&In-Reply-To=%3CPine.LNX.4.62.0910162141430.25383%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="065642.html">
   <LINK REL="Next"  HREF="065645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Charset sniffing from XML prolog</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Charset%20sniffing%20from%20XML%20prolog&In-Reply-To=%3CPine.LNX.4.62.0910162141430.25383%40hixie.dreamhostps.com%3E"
       TITLE="[whatwg] Charset sniffing from XML prolog">ian at hixie.ch
       </A><BR>
    <I>Fri Oct 16 14:46:16 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="065642.html">[whatwg] Charset sniffing from XML prolog
</A></li>
        <LI>Next message: <A HREF="065645.html">[whatwg] Charset sniffing from XML prolog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65943">[ date ]</a>
              <a href="thread.html#65943">[ thread ]</a>
              <a href="subject.html#65943">[ subject ]</a>
              <a href="author.html#65943">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, 7 Oct 2009, Kartikaya Gupta wrote:
&gt;<i>
</I>&gt;<i> If a document is served as text/html, but contains an XML prolog with an 
</I>&gt;<i> encoding attribute, it seems that all Firefox, Opera, and Chrome all 
</I>&gt;<i> pick up the encoding from the prolog and use it when parsing the rest of 
</I>&gt;<i> the document. (IE6 does not). The HTML5 spec doesn't seem to include 
</I>&gt;<i> XML-prolog checking in its encoding sniffing algorithm, should it?
</I>&gt;<i> 
</I>&gt;<i> &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</I>&gt;<i> &lt;html&gt;insert utf-8 content here, or alert(document.inputEncoding) for browsers that support it&lt;/html&gt;
</I>
On Thu, 8 Oct 2009, Kartikaya Gupta wrote:
&gt;<i> 
</I>&gt;<i> So then is this behavior getting axed or specced? The site in question 
</I>&gt;<i> that relies on this behavior is <A HREF="http://bell.mobi/primary">http://bell.mobi/primary</A> - it's not as 
</I>&gt;<i> noticeable in the english-locale version but if you switch to a french 
</I>&gt;<i> locale you get a bunch of french encoded as utf-8. Browsers with the 
</I>&gt;<i> prolog sniffing will render it fine but others will show garbage.
</I>&gt;<i> 
</I>&gt;<i> I'd be happier with not having to change my code to deal with this 
</I>&gt;<i> website, since it will occasionally show garbage even in utf-8.
</I>
UTF-8 is detectable, so if there's no other encoding declarations, and if 
this is the only site we know of, I'd rather encourage you to add fallback 
UTF-8 detection (as allowed by the spec) rather than add this.

Since IE apprently doesn't do this, I'd also rather not add yet more 
features like this.

So in the absence of more compelling reasons to add this, I'd rather get 
Opera and WebKit to remove the support for this, than add more. (As I 
understand it, Mozilla's new HTML5 parser already removes support for this 
particular &quot;feature&quot;.)

-- 
Ian Hickson               U+1047E                )\._.,--....,'``.    fL
<A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="065642.html">[whatwg] Charset sniffing from XML prolog
</A></li>
	<LI>Next message: <A HREF="065645.html">[whatwg] Charset sniffing from XML prolog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65943">[ date ]</a>
              <a href="thread.html#65943">[ thread ]</a>
              <a href="subject.html#65943">[ subject ]</a>
              <a href="author.html#65943">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
