<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] focus change inside keypress event handler
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20focus%20change%20inside%20keypress%20event%20handler&In-Reply-To=%3Cop.u2mymgzq1ejg13%40sandra-svwliu01%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="066144.html">
   <LINK REL="Next"  HREF="066131.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] focus change inside keypress event handler</H1>
<!--htdig_noindex-->
    <B>Michael A. Puls II</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20focus%20change%20inside%20keypress%20event%20handler&In-Reply-To=%3Cop.u2mymgzq1ejg13%40sandra-svwliu01%3E"
       TITLE="[whatwg] focus change inside keypress event handler">shadow2531 at gmail.com
       </A><BR>
    <I>Fri Oct 30 16:09:42 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="066144.html">[whatwg] focus change inside keypress event handler
</A></li>
        <LI>Next message: <A HREF="066131.html">[whatwg] style sheet blocking scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66172">[ date ]</a>
              <a href="thread.html#66172">[ thread ]</a>
              <a href="subject.html#66172">[ subject ]</a>
              <a href="author.html#66172">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Fri, 30 Oct 2009 00:34:14 -0400, Doug Schepers &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">schepers at w3.org</A>&gt; wrote:

&gt;<i> Hi, Folks-
</I>&gt;<i>
</I>&gt;<i> Scott Gonz&#225;lez wrote (on 10/29/09 11:03 AM):
</I>&gt;&gt;<i> On Thu, Oct 29, 2009 at 9:20 AM, Michael A. Puls II
</I>&gt;&gt;<i> &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">shadow2531 at gmail.com</A> &lt;mailto:<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">shadow2531 at gmail.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     Safari and Firefox will allow focus() inside the handler to decide
</I>&gt;&gt;<i>     where the character gets inserted, but only with &quot;keydown&quot;. With
</I>&gt;&gt;<i>     &quot;keypress&quot; (and textInput in webkit) in Firefox and Safari, it
</I>&gt;&gt;<i>     appears that the char was already inserted right after keydown, so a
</I>&gt;&gt;<i>     focus() change is already too late. Despite that though,
</I>&gt;&gt;<i>     preventDefault() still works in Firefox and Safari inside a
</I>&gt;&gt;<i>     &quot;keypress&quot; handler to prevent the char from being inserted. So, I'm
</I>&gt;&gt;<i>     not exactly sure what's they're doing behind the scenes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> DOM Level 3 Events says &quot;The default action of the keypress event
</I>&gt;&gt;<i> depends upon the key and the context: if the key is associated with a
</I>&gt;&gt;<i> character, and if there currently focused element in the document can
</I>&gt;&gt;<i> receive text (such as a form input or an editable text block), the
</I>&gt;&gt;<i> default action is to dispatch a textInput event with the character as
</I>&gt;&gt;<i> the value of the TextEvent.data attribute&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The default action of a keypress is not to insert a character in the
</I>&gt;&gt;<i> element that has focus, but to insert a character on the element that
</I>&gt;&gt;<i> represents the context of the keypress. In the given example, the
</I>&gt;&gt;<i> keypress's context is the first field, not the second.
</I>&gt;<i>
</I>&gt;<i> Correct.
</I>
So, you're saying that changing the focus() to another field inside the  
'keydown' handler (or keypress handler in the case of Opera and IE) MUST  
NOT change the insertion context (the field in this case that the text  
gets inserted into)?

If so, that would seem to contradict what browsers do when the focus  
changes inside  a 'keydown' handler and contradicts Opera and IE for focus  
changes inside a 'keypress' handler.

Not allowing that would break chase.com's SSI entry for example. (It uses  
3 fields and moves to the next field after you've entered 3 numbers, then  
2, then 4.

I've noticed lots of sites that change focus as you're typing to move the  
rest of the text to the next field. I'm not sure how many do the focus  
change inside a handler instead of after/before though.

-- 
Michael

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="066144.html">[whatwg] focus change inside keypress event handler
</A></li>
	<LI>Next message: <A HREF="066131.html">[whatwg] style sheet blocking scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66172">[ date ]</a>
              <a href="thread.html#66172">[ thread ]</a>
              <a href="subject.html#66172">[ subject ]</a>
              <a href="author.html#66172">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
