<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Superset encodings [Re: ISO-8859-* and the C1 control	range]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Superset%20encodings%20%5BRe%3A%20ISO-8859-%2A%20and%20the%20C1%20control%0A%09range%5D&In-Reply-To=%3CC8CE96F6-5C19-4D97-B20A-B0F1B642D978%40coq.no%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="066085.html">
   <LINK REL="Next"  HREF="066093.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Superset encodings [Re: ISO-8859-* and the C1 control	range]</H1>
<!--htdig_noindex-->
    <B>&#216;istein E. Andersen</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Superset%20encodings%20%5BRe%3A%20ISO-8859-%2A%20and%20the%20C1%20control%0A%09range%5D&In-Reply-To=%3CC8CE96F6-5C19-4D97-B20A-B0F1B642D978%40coq.no%3E"
       TITLE="[whatwg] Superset encodings [Re: ISO-8859-* and the C1 control	range]">liszt at coq.no
       </A><BR>
    <I>Fri Oct 23 13:21:07 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="066085.html">[whatwg] Superset encodings [Re: ISO-8859-* and the C1 control range]
</A></li>
        <LI>Next message: <A HREF="066093.html">[whatwg] Superset encodings [Re: ISO-8859-* and the C1 control range]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66090">[ date ]</a>
              <a href="thread.html#66090">[ thread ]</a>
              <a href="subject.html#66090">[ subject ]</a>
              <a href="author.html#66090">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On 23 Oct 2009, at 04:20, Ian Hickson wrote:

&gt;<i> On Wed, 21 Oct 2009, &#216;istein E. Andersen wrote:
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> ASCII-compatibility:
</I>&gt;&gt;<i> The note in &#145;2.1.5 Character encodings&#146; seems to say that [...]
</I>&gt;&gt;<i> ISO-2022&#146;[-*] are ASCII-compatible, whereas HZ-GB-2312 is not, and  
</I>&gt;&gt;<i> I cannot
</I>&gt;&gt;<i> find anything in Section 2.1.5 that would explain this difference.
</I>&gt;<i>
</I>&gt;<i> HZ-GB-2312 uses the byte ASCII uses for &quot;~&quot; as the escape character.
</I>&gt;<i> ISO-2022-* uses the control codes. That's the difference.
</I>
'~'/0x7E is not (and should not be, as far as I can tell) relevant for  
HTML5's concept of ASCII compatibility.

&gt;&gt;<i> Discouraged encodings: [...]
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Authors should not use JIS-X-0208 (JIS_C6226-1983), JIS-X-0212
</I>&gt;&gt;&gt;<i> (JIS_X0212-1990), [...]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It is not clear what this means [...]
</I>&gt;<i>
</I>&gt;<i> This is talking about character encodings, not character sets.
</I>&gt;<i> &quot;JIS_C6226-1983&quot; is a registered character encoding in the IANA  
</I>&gt;<i> registry.
</I>
(This is less confusing now since HTML5 only deals with character  
encodings and the strings match those in the the IANA registry as  
suggested by Yui Naruse.)

&gt;&gt;<i> the list of discouraged encodings seems conspicuously short if it is
</I>&gt;&gt;<i> supposed to be complete; and the lack of rationale makes it  
</I>&gt;&gt;<i> difficult to
</I>&gt;&gt;<i> understand why these encodings are considered particularly harmful
</I>&gt;&gt;<i> (JIS_C6226-1983 v. JIS_C6226-1978 or ISO-2022 v. HZ, to mention but  
</I>&gt;&gt;<i> two
</I>&gt;&gt;<i> at least initially puzzling cases).
</I>&gt;<i>
</I>&gt;<i> The reason for including these is to discourage encodings known to  
</I>&gt;<i> have
</I>&gt;<i> security issues. I've added HZ-GB-2312, which can be used in a  
</I>&gt;<i> similarly
</I>&gt;<i> dangerous fashion. (Basically the danger for user agents is in an  
</I>&gt;<i> attacker
</I>&gt;<i> using an encoding that a user agent could autodetect, while a site
</I>&gt;<i> interprets the bytes safely; that would allow those encodings to be  
</I>&gt;<i> used
</I>&gt;<i> to smuggle &lt;script&gt; elements in a way that a naive whitelisting filter
</I>&gt;<i> would think is safe.)
</I>&gt;<i>
</I>&gt;&gt;<i> It might be better to say *why* particular encodings are better  
</I>&gt;&gt;<i> avoided,
</I>&gt;&gt;<i> whether or not the list of discouraged encodings be presented as
</I>&gt;&gt;<i> definitive.
</I>&gt;<i>
</I>&gt;<i> I've added a note.
</I>&gt;<i>
</I>&gt;<i> [...]
</I>&gt;<i>
</I>&gt;<i> On Thu, 22 Oct 2009, Philip Taylor wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The string &quot;[&#49677;&#35338;&#26161;&#31359;]&quot; encoded as ISO-2022-KR is the bytes 0e  
</I>&gt;&gt;<i> 3c 73
</I>&gt;&gt;<i> 63 72 69 70 74 3e. A UA that doesn't support ISO-2022-KR (e.g.  
</I>&gt;&gt;<i> Chrome,
</I>&gt;&gt;<i> when I last checked) will decode it as Windows-1252 and get the  
</I>&gt;&gt;<i> string
</I>&gt;&gt;<i> &quot;&lt;script&gt;&quot;, which is bad. So a site that uses ISO-2022-KR is very  
</I>&gt;&gt;<i> likely
</I>&gt;&gt;<i> to expose some users to XSS attacks, which seems like a good reason  
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> discourage that encoding. The same applies to other ISO-2022  
</I>&gt;&gt;<i> encodings.
</I>&gt;<i>
</I>&gt;<i> [...]
</I>&gt;<i>
</I>&gt;<i> On Thu, 22 Oct 2009, &#216;istein E. Andersen wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If that is the reason, at least HZ encoding would seem to be  
</I>&gt;&gt;<i> affected as
</I>&gt;&gt;<i> well. Explicitly discouraging a more or less random subset of the
</I>&gt;&gt;<i> problematic encdodings without providing rationale makes it  
</I>&gt;&gt;<i> difficult to
</I>&gt;&gt;<i> assess whether or not other, somewhat similar, encodings should be
</I>&gt;&gt;<i> avoided as well, which was the main issue I wanted to raise.
</I>&gt;<i>
</I>&gt;<i> Hopefully this is somewhat addressed now.
</I>

The added note certainly helps, but it is vague (does &quot;[m]ost of these  
encodings&quot; mean &quot;all the encodings mentioned above apart from  
UTF-32&quot;?) and inaccurate (Philip Taylor's example does not rely on  
&quot;bugs&quot;).

Given that the set of encodings is open-ended, I still think it would  
be preferable to make the rationale (a definition of what makes an  
encoding problematic) primary and mention actual encodings as  
examples. This could give something like the following: &quot;Encodings in  
which a series of bytes in the range 0x20..0x7E may encode characters  
other than the corresponding characters in the range U+20..U+7E  
represent a potential security vulnerability since a browser that does  
not support the encoding (or does not support the label used to  
declare the encoding, or does not use the same mechanism to detect the  
encoding of unlabelled content) might end up interpreting technically  
benign plain text content as HTML tags and JavaScript.  In particular,  
this applies to encodings in which the bytes corresponding to  
'&lt;script&gt;' in ASCII may encode a different string. Authors should not  
use such encodings, which are known to include....  In addition,  
authors should not use UTF-32 ....&quot; Alternatively, fixing the current  
note would help and might be sufficient, albeit not ideal.

I think one has to realise that a comprehensive list of problematic  
encodings is an elusive goal and act accordingly.

-- 
&#216;istein E. Andersen


PS: The following sentence makes little sense without (curly) quotes  
and apostrophes. In case they disappeared before you read it, please  
find it repeated below with (ASCII) quotes and apostrophes:

&gt;&gt;<i> It should probably be &#145;&quot;advise against authors'&#146; using legacy  
</I>&gt;&gt;<i> encodings&quot;
</I>&gt;&gt;<i> or better &quot;&#145;advise authors against using legacy encodings&quot;&#146;.
</I>
(The current text in the spec is fine.)
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="066085.html">[whatwg] Superset encodings [Re: ISO-8859-* and the C1 control range]
</A></li>
	<LI>Next message: <A HREF="066093.html">[whatwg] Superset encodings [Re: ISO-8859-* and the C1 control range]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66090">[ date ]</a>
              <a href="thread.html#66090">[ thread ]</a>
              <a href="subject.html#66090">[ subject ]</a>
              <a href="author.html#66090">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
