<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Charset sniffing from XML prolog
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Charset%20sniffing%20from%20XML%20prolog&In-Reply-To=%3C20091007235104.666BB14DADD%40looneymail-mx2.g.dreamhost.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="065629.html">
   <LINK REL="Next"  HREF="065631.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Charset sniffing from XML prolog</H1>
<!--htdig_noindex-->
    <B>Kartikaya Gupta</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Charset%20sniffing%20from%20XML%20prolog&In-Reply-To=%3C20091007235104.666BB14DADD%40looneymail-mx2.g.dreamhost.com%3E"
       TITLE="[whatwg] Charset sniffing from XML prolog">lists.whatwg at stakface.com
       </A><BR>
    <I>Wed Oct  7 16:51:03 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="065629.html">[whatwg] Charset sniffing from XML prolog
</A></li>
        <LI>Next message: <A HREF="065631.html">[whatwg] Charset sniffing from XML prolog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65630">[ date ]</a>
              <a href="thread.html#65630">[ thread ]</a>
              <a href="subject.html#65630">[ subject ]</a>
              <a href="author.html#65630">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Wed, 07 Oct 2009 19:34:18 -0400, Boris Zbarsky &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bzbarsky at MIT.EDU</A>&gt; wrote:
&gt;<i> On 10/7/09 7:12 PM, Kartikaya Gupta wrote:
</I>&gt;<i> &gt; If a document is served as text/html, but contains an XML prolog with an encoding attribute, it seems that all Firefox, Opera, and Chrome all pick up the encoding from the prolog and use it when parsing the rest of the document. (IE6 does not). The HTML5 spec doesn't seem to include XML-prolog checking in its encoding sniffing algorithm, should it?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</I>&gt;<i> &gt; &lt;html&gt;insert utf-8 content here, or alert(document.inputEncoding) for browsers that support it&lt;/html&gt;
</I>&gt;<i> 
</I>&gt;<i> data:text/html,&lt;?xml version=&quot;1.0&quot; 
</I>&gt;<i> encoding=&quot;utf-8&quot;?&gt;&lt;html&gt;&lt;script&gt;alert(document.inputEncoding)&lt;/script&gt;&lt;/html&gt;
</I>&gt;<i> 
</I>&gt;<i> Shows ISO-8859-1 for me in Firefox over here.
</I>&gt;<i> 
</I>
Strange. I got &quot;UTF-8&quot; when I pasted that into the address bar. For reference, the version of FF I'm using is:

Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3

I tried it again in Chrome and if I paste the above in the address bar I get US-ASCII. But if I save it to a file and then load it I get UTF-8. I checked the headers being sent from Apache and they don't include any sneaky encoding hints, just Content-Type: text/html.

kats

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="065629.html">[whatwg] Charset sniffing from XML prolog
</A></li>
	<LI>Next message: <A HREF="065631.html">[whatwg] Charset sniffing from XML prolog
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65630">[ date ]</a>
              <a href="thread.html#65630">[ thread ]</a>
              <a href="subject.html#65630">[ subject ]</a>
              <a href="author.html#65630">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
