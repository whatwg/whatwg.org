<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Navigation events generated during unload
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Navigation%20events%20generated%20during%20unload&In-Reply-To=%3CPine.LNX.4.62.0910131052580.25383%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="065798.html">
   <LINK REL="Next"  HREF="065829.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Navigation events generated during unload</H1>
<!--htdig_noindex-->
    <B>Ian Hickson</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Navigation%20events%20generated%20during%20unload&In-Reply-To=%3CPine.LNX.4.62.0910131052580.25383%40hixie.dreamhostps.com%3E"
       TITLE="[whatwg] Navigation events generated during unload">ian at hixie.ch
       </A><BR>
    <I>Tue Oct 13 04:00:13 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="065798.html">[whatwg] Navigation events generated during unload
</A></li>
        <LI>Next message: <A HREF="065829.html">[whatwg] Navigation events generated during unload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65819">[ date ]</a>
              <a href="thread.html#65819">[ thread ]</a>
              <a href="subject.html#65819">[ subject ]</a>
              <a href="author.html#65819">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Mon, 12 Oct 2009, Boris Zbarsky wrote:
&gt;<i> On 10/12/09 1:55 AM, Ian Hickson wrote:
</I>&gt;<i> &gt; Why is the form.submit() ignored? It's not ignored in, e.g.:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;     <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/unload/same-origin/004.html">http://www.hixie.ch/tests/adhoc/html/navigation/unload/same-origin/004.html</A>
</I>&gt;<i> 
</I>&gt;<i> But in this case the form action is same-origin with the load that's
</I>&gt;<i> happening....
</I>
As it is on the other one:

   <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/unload/cross-origin/004.html">http://www.hixie.ch/tests/adhoc/html/navigation/unload/cross-origin/004.html</A>


&gt;<i> &gt; &gt; Also, I'm not quite sure what the part about unloading that comes 
</I>&gt;<i> &gt; &gt; after the algorithm you pointed me to means.  Does it mean that once 
</I>&gt;<i> &gt; &gt; you get the response and start parsing the new document you queue a 
</I>&gt;<i> &gt; &gt; task to unload the old one?  That doesn't seem at all right to me, 
</I>&gt;<i> &gt; &gt; since at this point the new document can be running scripts that 
</I>&gt;<i> &gt; &gt; touch the WindowProxy they share...
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Not sure what you mean here. I've tried to clarify that the new page 
</I>&gt;<i> &gt; must be active before any scripts run.
</I>&gt;<i> 
</I>&gt;<i> Looking at the algorithm steps when I made my last comment, it sounded 
</I>&gt;<i> like the new data starts coming in, the UA starts processing it, and 
</I>&gt;<i> queues a task to unload the old document.  Gecko at the moment, for 
</I>&gt;<i> example, unloads the old document immediately after firing unload on it, 
</I>&gt;<i> and before parsing any of the new document.  Is that the behavior the 
</I>&gt;<i> spec calls for?
</I>
The navigation algorithm goes through an asynchronous phase (waiting on 
the network, doing some sniffing in the background), but once it goes back 
to the synchronous stage where unload is fired, everything else happens in 
one go; there's no spinning of the event loop between the old page 
getting unload, the page being unloaded, and the new page being put into 
the session history and brought up.

-- 
Ian Hickson               U+1047E                )\._.,--....,'``.    fL
<A HREF="http://ln.hixie.ch/">http://ln.hixie.ch/</A>       U+263A                /,   _.. \   _\  ;`._ ,.
Things that are impossible just take longer.   `._.-(,_..'--(,_..'`-.;.'

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="065798.html">[whatwg] Navigation events generated during unload
</A></li>
	<LI>Next message: <A HREF="065829.html">[whatwg] Navigation events generated during unload
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65819">[ date ]</a>
              <a href="thread.html#65819">[ thread ]</a>
              <a href="subject.html#65819">[ subject ]</a>
              <a href="author.html#65819">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
