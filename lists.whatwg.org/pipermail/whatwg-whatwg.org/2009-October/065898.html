<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] window.setInterval if visible.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20window.setInterval%20if%20visible.&In-Reply-To=%3Cde4bd3190910151235g784cc5a3laceefaed0702ce7d%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="065989.html">
   <LINK REL="Next"  HREF="065900.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] window.setInterval if visible.</H1>
<!--htdig_noindex-->
    <B>Gregg Tavares</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20window.setInterval%20if%20visible.&In-Reply-To=%3Cde4bd3190910151235g784cc5a3laceefaed0702ce7d%40mail.gmail.com%3E"
       TITLE="[whatwg] window.setInterval if visible.">gman at google.com
       </A><BR>
    <I>Thu Oct 15 12:35:03 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="065989.html">[whatwg] document.documentURI
</A></li>
        <LI>Next message: <A HREF="065900.html">[whatwg] window.setInterval if visible.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65898">[ date ]</a>
              <a href="thread.html#65898">[ thread ]</a>
              <a href="subject.html#65898">[ subject ]</a>
              <a href="author.html#65898">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>I was wondering if there as been a proposal for either an optional argument
to setInterval that makes it only callback if the window is visible OR maybe
a window.setRenderInterval.

Here's the issue that seems like it needs to be solved.

Currently, AFAIK, the only way to do animation in HTML5 + JavaScript is
using setInterval. That's great but it has the problem that even when the
window is minimized or the page is not the front tab, JavaScript has no way
to know to stop animating.  So, for a CPU heavy animation using canvas 2d or
canvas 3d, even a hidden tab uses lots of CPU. Of course the browser does
not copy the bits from the canvas to the window but JavaScript is still
drawing hundreds of thousands of pixels to the canvas's internal image
buffer through canvas commands.

To see an example run this sample in any browser

<A HREF="http://mrdoob.com/projects/chromeexperiments/depth_of_field/">http://mrdoob.com/projects/chromeexperiments/depth_of_field/</A>

Minimize the window or switch to another tab and notice that it's still
taking up a bunch of CPU time.

Conversely, look at this flash page.

<A HREF="http://www.alissadean.com/">http://www.alissadean.com/</A>

While it might look simple there is actually a lot of CPU based pixel work
required to composite the buttons with alpha over the scrolling clouds with
alpha over the background.

Minimize that window or switch to another tab and unlike HTML5 + JavaScript,
flash has no problem knowning that it no longer needs to render.

There are probably other possible solutions to this problem but it seems
like the easiest would be either

*) adding an option to window.setInterval or only callback if the window is
visible

*) adding window.setIntervalIfVisible (same as the previous option really)

A possibly better solution would be

*) element.setIntervalIfVisible

Which would only call the callback if that particular element is visible.

It seems like this will be come an issue as more and more HMTL5 pages start
using canvas to do stuff they would have been doing in flash like ads or
games. Without a solution those ads and games will continue to eat CPU even
when not visible which will make the user experience very poor.

Am I making an sense?

-gregg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20091015/673ba4ba/attachment-0002.htm">http://lists.whatwg.org/pipermail/whatwg-whatwg.org/attachments/20091015/673ba4ba/attachment-0002.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="065989.html">[whatwg] document.documentURI
</A></li>
	<LI>Next message: <A HREF="065900.html">[whatwg] window.setInterval if visible.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#65898">[ date ]</a>
              <a href="thread.html#65898">[ thread ]</a>
              <a href="subject.html#65898">[ subject ]</a>
              <a href="author.html#65898">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
