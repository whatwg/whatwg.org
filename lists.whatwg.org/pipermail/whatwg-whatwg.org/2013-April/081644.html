<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Background audio channels
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Background%20audio%20channels&In-Reply-To=%3C1957343967.4042626.1365621240974.JavaMail.root%40mozilla.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="081643.html">
   <LINK REL="Next"  HREF="081645.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Background audio channels</H1>
<!--htdig_noindex-->
    <B>Wesley Johnston</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Background%20audio%20channels&In-Reply-To=%3C1957343967.4042626.1365621240974.JavaMail.root%40mozilla.com%3E"
       TITLE="[whatwg] Background audio channels">wjohnston at mozilla.com
       </A><BR>
    <I>Wed Apr 10 12:14:00 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="081643.html">[whatwg] Background audio channels
</A></li>
        <LI>Next message: <A HREF="081645.html">[whatwg] Background audio channels
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81644">[ date ]</a>
              <a href="thread.html#81644">[ thread ]</a>
              <a href="subject.html#81644">[ subject ]</a>
              <a href="author.html#81644">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>&gt;<i> No, plugins are not a bikeshed at all.  They are part of the problem - in fact, I wouldn't be surprised if they're half the problem.
</I>
Yes, but I don't think they're solvable here, and its not worth holding up the entire idea trying to fix them. The best solution I know of for plugins is click-to-play, which fixes a very different problem, but helps prevent this one. It sounds, from your comments, like WebAudio needs a good definition of &quot;pause&quot; that happens in a reasonable amount of time. I don't know that spec at all, so feedback is appreciated. Is it an impossible problem to solve?

&gt;<i> The first browser that tried to &quot;upgrade&quot; their support by disabling Pandora* playing in a background tab, because Pandora hasn't added an attribute to their &lt;audio&gt;/plugins, is going to have to deal with a lot of user backlash. 
</I>
Yes. Like many web breaking changes, UA's would need to do this on a gradual roll out, perhaps defaulting it to background for some period, but monitoring/evangelizing sites to work with the new spec. If that evangelism occurs across multiple browsers/vendors, it would have stronger support. But given the response/fear here, I also won't be surprised if one vendor had to take the first steps. I would also imagine that mobile is a good starting point, since there are even fewer mobile sites that expect to work in the background than desktop. In fact, until about a month ago, Chrome on mobile already did this (and users came to us asking us to match their behavior, which I fought until sites had some way to opt out of being paused). Since Chrome already shipped this behavior, maybe you have some indication of how many sites are depending on being able to play HTML5 audio in the background?

I would guess that number is miniscule, and will quickly be dwarfed by html5 gaming frameworks (that should mute in the background). I also expect we'll see a lot more garage developers there. Again, I'd say while not ideal, its as good a time as we'll ever have to try and fix this.

&gt;<i> Finally, apps can already solve this problem today - they know when they go into the background (for different permutations of &quot;background&quot;, as Jer mentioned), and they can pretty trivially mute or pause their playing audio. Most of them don't. 
</I>
Yes.... err... isn't this my point? Most of them (that I've encountered) aren't not muting themselves because they think what they're playing is so important that it shouldn't be stopped. Most of them are used to expecting the platform to do the right thing for them.

I'd love to hear better solutions. Although I've fought for it before, I don't really consider &quot;Sites can mute themselves&quot; a solution at this point (they won't). Neither do I think we want users to have to manually manage this. I've thrown around some ideas about events with people before, but I think this solution is much simpler for devs to implement.

Again, IMO 1.) The EVENTUAL default behavior here has to be to mute tabs in the background. History and the current situation show devs haven't/won't bother to do this on their own. Forcing them to opt in puts users back in control. 2.) I don't believe there's any need for a separation between installed/non-installed webapps here.

- Wes


On Wed, Apr 10, 2013 at 10:07 AM, Wesley Johnston &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">wjohnston at mozilla.com</A> &gt; wrote: 


Plugins are a bit of a bikeshed argument here and beyond any spec I know of? (UAs are moving towards disabling entirely or requiring click to play for plugins anyway) WebAudio is doable and should be addressed. But yes, my proposal is that we &quot;break&quot; all current audio elements and force the to add an attribute if they want to play in the background. Alternatively, we could default the attribute to background, but that doesn't really solve the problem. We could let the UA choose its own default (i.e. if desktop browsers want to default to &quot;background&quot; and mobile to &quot;normal&quot;). I imagine we'd roll this out on Mobile first. 

My opinion: the fact that browsers are starting to implement UI so that users can manually fix this problem indicates there is a problem, and its better to take action to fix it sooner rather than later. Manually expecting users to pause audio is a bad solution. Expecting sites to shut down audio on visibility changes is reasonable, but so far they haven't. We're approaching a situation similar to the one we formerly had with popup ads. 

Showing a permissions prompt is optional. I agree it could be annoying. 

- Wes 



----- Original Message ----- 
From: &quot;Chris Wilson&quot; &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">cwilso at google.com</A> &gt; 
To: &quot;Andrew Herrington&quot; &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">a.d.herrington at gmail.com</A> &gt; 
Cc: &quot;BRYAN L SULLIVAN&quot; &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bs3131 at att.com</A> &gt;, &quot;Paul Bakaus&quot; &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">pbakaus at zynga.com</A> &gt;, &quot;Wesley Johnston&quot; &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">wjohnston at mozilla.com</A> &gt;, <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">public-html at w3.org</A> , <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A> 
Sent: Wednesday, April 10, 2013 9:37:11 AM 
Subject: Re: [whatwg] Background audio channels 


Browsers can already implement this - Chrome did, in fact. I don't think it would be part of the spec. 


Changing the default behavior of media elements today seems problematic; all current &lt;audio&gt; elements, under this proposal, would start pausing when you switched away from the tab. Additionally, this isn't just media elements - it needs to also affect Web Audio, as well as any plugins. That becomes a lot more problematic as well. 



On Wed, Apr 10, 2013 at 12:55 AM, Andrew Herrington &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">a.d.herrington at gmail.com</A> &gt; wrote: 


If permission does not have to be requested, could we have an indicator as to what tab / browser is making the sound? It is frustrating to have to close tabs / windows until you find the one that is making the irritating noise. Or would this be beyond a spec? 


Kind regards, 

Andrew 




On 10 Apr 2013, at 02:11, &quot;SULLIVAN, BRYAN L&quot; &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">bs3131 at att.com</A> &gt; wrote: 

&gt;<i> I also support this proposal. There are other use cases (e.g. a web-based tutorial or help system, intended to guide the user in using other apps or device features) which will need background audio capability. The audio API will be used for many purposes, and I'm sure it will not be hard to find common use cases that need background audio capability. 
</I>&gt;<i> 
</I>&gt;<i> I'm not sure about the permissions based approach though. The number of things that the user has to explicitly allow and manage seems to be steadily increasing. Audio seems a fairly innocuous thing that I think should be able to run in the background without any special permission. The user always has the choice to not use the app if it doesn't offer (or act upon) app-based controls on background audio use. 
</I>&gt;<i> 
</I>&gt;<i> Thanks, 
</I>&gt;<i> Bryan Sullivan 
</I>&gt;<i> 
</I>&gt;<i> -----Original Message----- 
</I>&gt;<i> From: Paul Bakaus [mailto: <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">pbakaus at zynga.com</A> ] 
</I>&gt;<i> Sent: Tuesday, April 09, 2013 4:56 AM 
</I>&gt;<i> To: Wesley Johnston; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">public-html at w3.org</A> ; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">whatwg at whatwg.org</A> 
</I>&gt;<i> Subject: Re: [whatwg] Background audio channels 
</I>&gt;<i> 
</I>&gt;<i> I support this proposal makes total sense to me. We (Zynga) promise 
</I>&gt;<i> we'll not misuse the priority channels :) 
</I>&gt;<i> 
</I>&gt;<i> On 15.03.13 18:57, &quot;Wesley Johnston&quot; &lt; <A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">wjohnston at mozilla.com</A> &gt; wrote: 
</I>&gt;<i> 
</I>&gt;&gt;<i> In most situations, when the user puts a webpage in the background, any 
</I>&gt;&gt;<i> media being played by the page should be paused. Any attempts to play 
</I>&gt;&gt;<i> audio by a background page should also be prevented. However, for some 
</I>&gt;&gt;<i> sites (music or radio apps) the user would like to continue to hear the 
</I>&gt;&gt;<i> app while they do something else. These pages should be able to designate 
</I>&gt;&gt;<i> their audio as a type that should keep playing while in the background. 
</I>&gt;&gt;<i> The useragent should also attempt to avoid having the stream killed by 
</I>&gt;&gt;<i> the operating system if possible. This is especially true on mobile 
</I>&gt;&gt;<i> devices, but the problem is also already prevalent on desktop. 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I think semantically we need a way to describe to the useragent how to 
</I>&gt;&gt;<i> play a particular track. I'd suggest we add an optional attribute to 
</I>&gt;&gt;<i> media elements, &quot;audiochannel&quot;, designating the output and priority of 
</I>&gt;&gt;<i> this audio. The channel attribute can potentially take on three different 
</I>&gt;&gt;<i> values. &quot;normal&quot;, &quot;background&quot;, and &quot;telephony&quot;. 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> &quot;normal&quot; channels are the default for all media elements. Using them 
</I>&gt;&gt;<i> doesn't require any special permissions. Audio playing with these 
</I>&gt;&gt;<i> channels is paused when the web page moves into the background. In 
</I>&gt;&gt;<i> addition, calling play on an media element with this channel while in the 
</I>&gt;&gt;<i> background will put the element into the paused for user interaction 
</I>&gt;&gt;<i> state (i.e. playback won't start until the webapp is brought to the 
</I>&gt;&gt;<i> foreground)? 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> &quot;background&quot; channels will continue to play when the page is put into the 
</I>&gt;&gt;<i> background. Trying to play a background channel while in the background 
</I>&gt;&gt;<i> should also work. The ability to play audio on this channel may require 
</I>&gt;&gt;<i> requesting permission from the UA first (i.e. possibly a prompt when the 
</I>&gt;&gt;<i> audio is first played or when moving to the background). If the user 
</I>&gt;&gt;<i> doesn't grant permission, these should throw a MediaError 
</I>&gt;&gt;<i> (MEDIA_ERR_CHANNEL_PERMISSION_NOT_GRANTED?) so that the page can know 
</I>&gt;&gt;<i> what has happened and do something appropriate. 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> &quot;telephony&quot; channels are similar to &quot;background&quot; channels and can play 
</I>&gt;&gt;<i> even if the page is in the background. Playing audio on a telephony 
</I>&gt;&gt;<i> channel may cause any audio playing on &quot;normal&quot; or &quot;background&quot; channels 
</I>&gt;&gt;<i> to be paused or have their volume severely decreased. They also, on 
</I>&gt;&gt;<i> devices where its supported, will likely play over handset speakers 
</I>&gt;&gt;<i> rather than normal speakers. Similar to &quot;background&quot;, these may require 
</I>&gt;&gt;<i> permission from the UA. 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Note: This is all based rather loosely on the AudioChannels 
</I>&gt;&gt;<i> implementation written for B2G recently [1]. It includes a few other 
</I>&gt;&gt;<i> use-cases on its wiki page, along with definitions of additional channels 
</I>&gt;&gt;<i> to accomadate them. I've been trying to simplify it down to handle the 
</I>&gt;&gt;<i> most common use cases. Finding the correct terminology here is difficult 
</I>&gt;&gt;<i> though. For instance, it seems likely that games will see the background 
</I>&gt;&gt;<i> channel and think its an appropriate place to play game background music, 
</I>&gt;&gt;<i> the exact type of audio you'd like to have paused when you leave the 
</I>&gt;&gt;<i> game. Ideas for better ways to describe it are welcome. 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> [1] <A HREF="https://wiki.mozilla.org/WebAPI/AudioChannels">https://wiki.mozilla.org/WebAPI/AudioChannels</A> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>





</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="081643.html">[whatwg] Background audio channels
</A></li>
	<LI>Next message: <A HREF="081645.html">[whatwg] Background audio channels
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#81644">[ date ]</a>
              <a href="thread.html#81644">[ thread ]</a>
              <a href="subject.html#81644">[ subject ]</a>
              <a href="author.html#81644">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
