<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Handling of illegal byte-sequences (typically in UTF-8)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Handling%20of%20illegal%20byte-sequences%20%28typically%20in%20UTF-8%29&In-Reply-To=%3CC39A44DB-15F2-4333-A643-79685B5DAE53%40iki.fi%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007989.html">
   <LINK REL="Next"  HREF="007993.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Handling of illegal byte-sequences (typically in UTF-8)</H1>
<!--htdig_noindex-->
    <B>Henri Sivonen</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Handling%20of%20illegal%20byte-sequences%20%28typically%20in%20UTF-8%29&In-Reply-To=%3CC39A44DB-15F2-4333-A643-79685B5DAE53%40iki.fi%3E"
       TITLE="[whatwg] Handling of illegal byte-sequences (typically in UTF-8)">hsivonen at iki.fi
       </A><BR>
    <I>Fri Nov 24 02:33:22 PST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="007989.html">[whatwg] Handling of illegal byte-sequences (typically in UTF-8)
</A></li>
        <LI>Next message: <A HREF="007993.html">[whatwg] Handling of illegal byte-sequences (typically in UTF-8)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7991">[ date ]</a>
              <a href="thread.html#7991">[ thread ]</a>
              <a href="subject.html#7991">[ subject ]</a>
              <a href="author.html#7991">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Nov 24, 2006, at 04:11, &#216;istein E. Andersen wrote:

&gt;<i> Section 8.1.4:
</I>&gt;&gt;<i> Bytes that are not valid UTF-8 sequences must be interpreted as  
</I>&gt;&gt;<i> [...] U+FFFD
</I>&gt;<i>
</I>&gt;<i> Section 9.2.2:
</I>&gt;&gt;<i> Bytes or sequences of bytes [...] that could not be converted to  
</I>&gt;&gt;<i> Unicode characters
</I>&gt;&gt;<i> must be converted to U+FFFD
</I>&gt;<i>
</I>&gt;<i> If I read this correctly, section 8.1.4 requires that an illegal  
</I>&gt;<i> UTF-8 sequence like
</I>&gt;<i> F2 BF BF (the three first bytes of a four-byte sequence, obviously  
</I>&gt;<i> not followed by
</I>&gt;<i> a continuation byte) be converted into exactly three U+FFFD  
</I>&gt;<i> characters (one
</I>&gt;<i> for each byte), whereas section 9.2.2 also allows one single  
</I>&gt;<i> replacement character (and possibly even two) in this case (and  
</I>&gt;<i> permits an arbitrary number n of repetitions
</I>&gt;<i> of the three-byte sequence to be replaced by any number of U+FFFD  
</I>&gt;<i> characters
</I>&gt;<i> between 1 and 3n).
</I>
I'm inclined to think that interop in error situations doesn't need  
to go as deep as defining how many replacement characters (in the  
range 1...number of bytes in a faulty sequence) a character decoder  
has to emit. Apps may want to delegate character decoding to an  
outside library whose authors don't care about the details of HTML5.  
(For example, it appears that Safari is leaving this stuff to ICU.)  
Chances are that there's more value in being able to use a library  
than in getting a specific number of replacement characters on error.

-- 
Henri Sivonen
<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">hsivonen at iki.fi</A>
<A HREF="http://hsivonen.iki.fi/">http://hsivonen.iki.fi/</A>



</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007989.html">[whatwg] Handling of illegal byte-sequences (typically in UTF-8)
</A></li>
	<LI>Next message: <A HREF="007993.html">[whatwg] Handling of illegal byte-sequences (typically in UTF-8)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7991">[ date ]</a>
              <a href="thread.html#7991">[ thread ]</a>
              <a href="subject.html#7991">[ subject ]</a>
              <a href="author.html#7991">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
