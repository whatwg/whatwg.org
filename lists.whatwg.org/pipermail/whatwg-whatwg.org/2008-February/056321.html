<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] CSRF and Access-Control-Origin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20CSRF%20and%20Access-Control-Origin&In-Reply-To=%3C7789133a0802261602s28dabbf5xe0d4bff4d2ff3222%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="056320.html">
   <LINK REL="Next"  HREF="056322.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] CSRF and Access-Control-Origin</H1>
<!--htdig_noindex-->
    <B>Adam Barth</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20CSRF%20and%20Access-Control-Origin&In-Reply-To=%3C7789133a0802261602s28dabbf5xe0d4bff4d2ff3222%40mail.gmail.com%3E"
       TITLE="[whatwg] CSRF and Access-Control-Origin">hk9565 at gmail.com
       </A><BR>
    <I>Tue Feb 26 16:02:06 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="056320.html">[whatwg] several messages about &lt;ol&gt;, &lt;ul&gt;, &lt;dl&gt;,	and related subjects
</A></li>
        <LI>Next message: <A HREF="056322.html">[whatwg] Proposal for a link attribute to replace &lt;a href&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56321">[ date ]</a>
              <a href="thread.html#56321">[ thread ]</a>
              <a href="subject.html#56321">[ subject ]</a>
              <a href="author.html#56321">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Cross-site XMLHttpRequests include an Access-Control-Origin HTTP
header that indicates the principal who initiated the request:

<A HREF="http://www.w3.org/TR/access-control/#access-control-origin0">http://www.w3.org/TR/access-control/#access-control-origin0</A>

If browsers attached this header to POST requests, servers could more
easily defend themselves against cross-site request forgery (CSRF)
attacks.

Currently, browsers send the Referer header, which indicates the URL
of the page that initiated the request.  The Referer header is
unreliable because many users and corporate installations suppress the
header due to privacy concerns.  For example, suppose a company hosted
a page on its Intranet with the following URL:

<A HREF="http://wiki/Competitive_Analysis_for_Secret_Project_XYZ">http://wiki/Competitive_Analysis_for_Secret_Project_XYZ</A>

which linked to competitors for Secret Project XYZ.  The Referer
header would leak the existence of the secret project to its
competitors.  Many proxies strip the Referer header as a matter of
course.

For these reasons, sites that attempt to use the Referer header to
block CSRF attacks permit cross-site requests that omit the Referer
header.  Unfortunately, attackers can easily suppress the Referer
header in all major browsers, for example by initiating the request
from an FTP page or by first navigating to a javascript:&quot;...&quot; URL, and
can mount CSRF attacks against these sites.

Attaching the Access-Control-Origin header to POST requests provides
better privacy/security trade-off than attaching the Referer header to
every request:

1) The Access-Control-Origin header contains only the information
required to make a CSRF security decision and not extraneous data,
such as the path and query parameters, that can contain sensitive
information.

2) Attaching the header only to POST requests reduces the information
leakage from simply clicking hyperlinks.  Secret web pages are
unlikely to POST to untrusted web sites (although they often hyperlink
to them).

Adam

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="056320.html">[whatwg] several messages about &lt;ol&gt;, &lt;ul&gt;, &lt;dl&gt;,	and related subjects
</A></li>
	<LI>Next message: <A HREF="056322.html">[whatwg] Proposal for a link attribute to replace &lt;a href&gt;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56321">[ date ]</a>
              <a href="thread.html#56321">[ thread ]</a>
              <a href="subject.html#56321">[ subject ]</a>
              <a href="author.html#56321">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
