<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] postMessage and serialization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%20and%20serialization&In-Reply-To=%3C278fd46c0802140954j7747f3f3nbdabd0e194a679bd%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013951.html">
   <LINK REL="Next"  HREF="013941.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] postMessage and serialization</H1>
<!--htdig_noindex-->
    <B>Aaron Boodman</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%20and%20serialization&In-Reply-To=%3C278fd46c0802140954j7747f3f3nbdabd0e194a679bd%40mail.gmail.com%3E"
       TITLE="[whatwg] postMessage and serialization">aa at google.com
       </A><BR>
    <I>Thu Feb 14 09:54:32 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="013951.html">[whatwg] postMessage and serialization
</A></li>
        <LI>Next message: <A HREF="013941.html">[whatwg] Fwd:  HTML 5 vs. XHTML 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13968">[ date ]</a>
              <a href="thread.html#13968">[ thread ]</a>
              <a href="subject.html#13968">[ subject ]</a>
              <a href="author.html#13968">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Tue, Feb 12, 2008 at 4:57 PM, Ian Hickson &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">ian at hixie.ch</A>&gt; wrote:
&gt;<i>  This was originally how the DOM Storage API worked, but there was
</I>&gt;<i>  significant pushback on this, resulting in the current string-only
</I>&gt;<i>  approach. When I came to writing the postMessage API, I considered that
</I>&gt;<i>  feedback and decided not to bother even trying.
</I>
I see. One difference between DOM Storage and postMessage is that with
DOM Storage at least you had name and value separated out. For
postMessage you just get a single value field.

&gt;<i>  Passing booleans, numbers and strings is trivial using the current API.
</I>&gt;<i>  Passing arrays of booleans and numbers is trivial too.
</I>&gt;<i>
</I>&gt;<i>  Passing objects, or arrays of strings, arrays, or objects, is more
</I>&gt;<i>  complex, but as you point out, it can be done using JSON libraries. Since
</I>&gt;<i>  it is likely that JSON will be supported natively by UAs in due course, it
</I>&gt;<i>  seems better to wait for that support rather than adding type support to
</I>&gt;<i>  postMessage().
</I>
I've seen performance problems using JS-based JSON libraries with
Gears workers. In those cases, the developer had to revert to hacky
custom message formats where what he really wanted was to pass an
object.

Someday, all browsers will have fast JSON support built in, but that
will be awhile for IE. Gears could implement postMessage today, but
we've looked into implementing fast JSON support and it seems
difficult to do much better than you can do with script without access
to the script engine internals.

&gt;<i>  It seems that most messages will consist either of simple strings, or of
</I>&gt;<i>  complex data structures (objects). Reconstructing JS objects is not a
</I>&gt;<i>  trivial operation; you have to worry about references into other parts of
</I>&gt;<i>  the structure, getters and setters that hang or throw or return infinite
</I>&gt;<i>  arrays, functions, members that aren't enumerable, etc. I'd rather not go
</I>&gt;<i>  down that rat hole with v1.
</I>
You'll have these problems with JSON too though, right? Whatever the
rules are, we'll have to figure them out eventually.

- a

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013951.html">[whatwg] postMessage and serialization
</A></li>
	<LI>Next message: <A HREF="013941.html">[whatwg] Fwd:  HTML 5 vs. XHTML 2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13968">[ date ]</a>
              <a href="thread.html#13968">[ thread ]</a>
              <a href="subject.html#13968">[ subject ]</a>
              <a href="author.html#13968">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
