<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] reply() extension to postMessage()
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20reply%28%29%20extension%20to%20postMessage%28%29&In-Reply-To=%3Cop.t6ixe9i564w2qv%40annevk-t60.oslo.opera.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="056236.html">
   <LINK REL="Next"  HREF="056238.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] reply() extension to postMessage()</H1>
<!--htdig_noindex-->
    <B>Anne van Kesteren</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20reply%28%29%20extension%20to%20postMessage%28%29&In-Reply-To=%3Cop.t6ixe9i564w2qv%40annevk-t60.oslo.opera.com%3E"
       TITLE="[whatwg] reply() extension to postMessage()">annevk at opera.com
       </A><BR>
    <I>Thu Feb 14 08:58:11 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="056236.html">[whatwg] reply() extension to postMessage()
</A></li>
        <LI>Next message: <A HREF="056238.html">[whatwg] reply() extension to postMessage()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56237">[ date ]</a>
              <a href="thread.html#56237">[ thread ]</a>
              <a href="subject.html#56237">[ subject ]</a>
              <a href="author.html#56237">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Thu, 14 Feb 2008 17:30:15 +0100, Aaron Boodman &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">aa at google.com</A>&gt; wrote:
&gt;<i> If we're going to add reply, I would like to easily be able to get
</I>&gt;<i> replies to a specific message. So extend postMessage to accept a
</I>&gt;<i> callback, and then either have reply() call this callback. Like this:
</I>&gt;<i>
</I>&gt;<i> // sender:
</I>&gt;<i> someWindow.postMessage(&quot;hello!&quot;, function(response) {
</I>&gt;<i>   alert(&quot;got response: &quot; + response);
</I>&gt;<i> });
</I>&gt;<i>
</I>&gt;<i> // receiver
</I>&gt;<i> window.addEventListener(&quot;message&quot;, function(e) {
</I>&gt;<i>   alert(&quot;got message: &quot; + e.message);
</I>&gt;<i>   e.reply(&quot;good day&quot;);
</I>&gt;<i> });
</I>
You really want reply() to have that callback too (for longer  
conversations) and at that point it starts getting icky.

I came up with another idea to address the issue you mention. We let  
postMessage() return a UUID and give MessageEvent an &quot;id&quot; attribute. When  
postMessage() is invoked a UUID is generated and returned. This same UUID  
is set on the event that is dispatched. When reply is invoked on that  
event object it creates an event that again has the same UUID. Both  
parties can have multiple conversations that way by checking the UUID of  
the message.


-- 
Anne van Kesteren
&lt;<A HREF="http://annevankesteren.nl/">http://annevankesteren.nl/</A>&gt;
&lt;<A HREF="http://www.opera.com/">http://www.opera.com/</A>&gt;

</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="056236.html">[whatwg] reply() extension to postMessage()
</A></li>
	<LI>Next message: <A HREF="056238.html">[whatwg] reply() extension to postMessage()
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#56237">[ date ]</a>
              <a href="thread.html#56237">[ thread ]</a>
              <a href="subject.html#56237">[ subject ]</a>
              <a href="author.html#56237">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
