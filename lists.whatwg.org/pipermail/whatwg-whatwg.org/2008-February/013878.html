<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] postMessage: event.source allows navigation of sender
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%3A%20event.source%20allows%20navigation%20of%20sender&In-Reply-To=%3Ca9699fd20802070145v34b2995cr28a801b157ff616d%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013877.html">
   <LINK REL="Next"  HREF="013879.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] postMessage: event.source allows navigation of sender</H1>
<!--htdig_noindex-->
    <B>Thomas Broyer</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20postMessage%3A%20event.source%20allows%20navigation%20of%20sender&In-Reply-To=%3Ca9699fd20802070145v34b2995cr28a801b157ff616d%40mail.gmail.com%3E"
       TITLE="[whatwg] postMessage: event.source allows navigation of sender">t.broyer at gmail.com
       </A><BR>
    <I>Thu Feb  7 01:45:53 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="013877.html">[whatwg] postMessage: event.source allows navigation of sender
</A></li>
        <LI>Next message: <A HREF="013879.html">[whatwg] postMessage: event.source allows navigation of sender
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13878">[ date ]</a>
              <a href="thread.html#13878">[ thread ]</a>
              <a href="subject.html#13878">[ subject ]</a>
              <a href="author.html#13878">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>On Feb 7, 2008 10:24 AM, Hallvord R M Steen wrote:
&gt;<i> Adam Barth and Collin Jackson pointed out to me that while
</I>&gt;<i> investigating frame navigation policies they found that a recipient of
</I>&gt;<i> a postMessage in Opera can set event.source.location, thus navigate
</I>&gt;<i> the sender window/document. I think this is a bug in the API itself.
</I>
If what you say is true (see below) I'd rather say it's a bug in
Opera's implementation.

&gt;<i> This seems to violate the API's promise of safe cross-domain
</I>&gt;<i> communication even with untrusted documents. One can imagine use cases
</I>&gt;<i> where a script in document A has a reference to window B and thus can
</I>&gt;<i> post messages, but window B does not have any to A and would not under
</I>&gt;<i> normal circumstances be able to change A's address.
</I>
Shouldn't event.source.location be read-only? Isn't that a direct
application of the same-origin policy?

The current draft contains the following note:
&quot;Implementors are urged to take extra care in the implementation of
this feature. It allows authors to transmit information from one
domain to another domain, which is normally disallowed for security
reasons. It also requires that UAs be careful to allow access to
certain properties but not others.&quot;

See also <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/section-history.html#security5">http://www.whatwg.org/specs/web-apps/current-work/multipage/section-history.html#security5</A>

And setting the event.source (Window object)'s location property is
covered by the following paragraph:
&quot;In the ECMAScript DOM binding, the location members of the
HTMLDocument and Window interfaces behave as if they had a setter:
user agents must treats attempts to set these location attribute as
attempts at setting the href attribute of the relevant Location object
instead.&quot;
&#8212; source: <A HREF="http://www.whatwg.org/specs/web-apps/current-work/multipage/section-history.html#location0">http://www.whatwg.org/specs/web-apps/current-work/multipage/section-history.html#location0</A>

which &quot;invokes&quot; the #security5 above.

-- 
Thomas Broyer
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013877.html">[whatwg] postMessage: event.source allows navigation of sender
</A></li>
	<LI>Next message: <A HREF="013879.html">[whatwg] postMessage: event.source allows navigation of sender
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13878">[ date ]</a>
              <a href="thread.html#13878">[ thread ]</a>
              <a href="subject.html#13878">[ subject ]</a>
              <a href="author.html#13878">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
