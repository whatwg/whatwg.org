<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [whatwg] Suggested changes to Web Forms 2.0, 2004-07-01 working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Suggested%20changes%20to%20Web%20Forms%202.0%2C%202004-07-01%20working&In-Reply-To=%3C8aXBKMQKNb9AFwE9%40lund.co.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043571.html">
   <LINK REL="Next"  HREF="043566.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[whatwg] Suggested changes to Web Forms 2.0, 2004-07-01 working</H1>
<!--htdig_noindex-->
    <B>George Lund</B> 
    <A HREF="mailto:whatwg%40lists.whatwg.org?Subject=Re%3A%20%5Bwhatwg%5D%20Suggested%20changes%20to%20Web%20Forms%202.0%2C%202004-07-01%20working&In-Reply-To=%3C8aXBKMQKNb9AFwE9%40lund.co.uk%3E"
       TITLE="[whatwg] Suggested changes to Web Forms 2.0, 2004-07-01 working">george at lund.co.uk
       </A><BR>
    <I>Wed Jul 14 15:27:22 PDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="043571.html">[whatwg] Suggested changes to Web Forms 2.0, 2004-07-01 working
</A></li>
        <LI>Next message: <A HREF="043566.html">[whatwg] Suggested changes to Web Forms 2.0, 2004-07-01 working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43564">[ date ]</a>
              <a href="thread.html#43564">[ thread ]</a>
              <a href="subject.html#43564">[ subject ]</a>
              <a href="author.html#43564">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>In message &lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">851c8d3104070906174ce4bfb0 at mail.gmail.com</A>&gt;, Jim Ley
&lt;<A HREF="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">jim.ley at gmail.com</A>&gt; writes
&gt;<i>And because of regional
</I>&gt;<i>differences in how dates are entered, it means it's not even safe to
</I>&gt;<i>parse a date from a string, unless you know the format entered.
</I>
Help can be given to IE users that have scripting enabled, which
constitutes the majority of the 'problem' situations we are talking
about.

For example, the following VBScript code will reformat the date the user
types into ISO format, taking into account the local standard format. So
if a US user types '1/10/1980', the input box will change to read
'1980-01-10' ... but if a UK user types that then the input box will
read '1980-10-01'.

Sub convertDate
    Dim the_date
    Dim user_locale

    If Not IsDate(myform.mydatetime.value) Then Exit Sub

    ' convert the date using the user's current locale
    the_date = CDate(myform.mydatetime.value)
    user_locale = GetLocale

    SetLocale(&quot;sv-se&quot;)
    ' display the date using Sweden's locale
    myform.mydatetime.value = FormatDateTime(the_date, vbShortDate)

    SetLocale(user_locale)
End Sub

(The locale 'sv-se' is indeed Sweden but fortunately Microsoft says
Sweden uses ISO date formatting.)

One could call this code from the form's &quot;OnSubmit&quot; event and/or from
the &quot;OnFocusOut&quot; event of the relevant input control.  All without
having any effect on a browser that doesn't understand VBScript.

Don't know if that contributes to the current debate, but it certainly
might make things more friendly for users of IE.  They could type the
date format in whatever way makes sense to them, and (assuming scripting
is enabled) the right thing will get sent to the server.

Needless to say it doesn't do away with the need for server-side
validation.  And I'm not claiming that my code above is pretty :-)

Reference: &lt;URL:<A HREF="http://msdn.microsoft.com/library/en-us/script56/html/vs">http://msdn.microsoft.com/library/en-us/script56/html/vs</A>
fctSetLocale.asp&gt;
-- 
George Lund


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043571.html">[whatwg] Suggested changes to Web Forms 2.0, 2004-07-01 working
</A></li>
	<LI>Next message: <A HREF="043566.html">[whatwg] Suggested changes to Web Forms 2.0, 2004-07-01 working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43564">[ date ]</a>
              <a href="thread.html#43564">[ thread ]</a>
              <a href="subject.html#43564">[ subject ]</a>
              <a href="author.html#43564">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/whatwg-whatwg.org">More information about the whatwg
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
