<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r6162 - [giow] (0) Remove pointless events from the	PeerConnection object. Add an event [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r6162%20-%20%5Bgiow%5D%20%280%29%20Remove%20pointless%20events%20from%20the%0A%09PeerConnection%20object.%20Add%20an%20event%20%5B...%5D&In-Reply-To=%3C20110531223717.C885011C7C00C%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013028.html">
   <LINK REL="Next"  HREF="013030.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r6162 - [giow] (0) Remove pointless events from the	PeerConnection object. Add an event [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r6162%20-%20%5Bgiow%5D%20%280%29%20Remove%20pointless%20events%20from%20the%0A%09PeerConnection%20object.%20Add%20an%20event%20%5B...%5D&In-Reply-To=%3C20110531223717.C885011C7C00C%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r6162 - [giow] (0) Remove pointless events from the	PeerConnection object. Add an event [...]">whatwg at whatwg.org
       </A><BR>
    <I>Tue May 31 15:37:17 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="013028.html">[html5] r6161 - [giow] (0) Make it so that taking out all the	streams temporarily doesn't kill a [...]
</A></li>
        <LI>Next message: <A HREF="013030.html">[html5] r6163 - [giow] (0) Avoid salvaging documents that have	active PeerConnections. (Maybe we [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13029">[ date ]</a>
              <a href="thread.html#13029">[ thread ]</a>
              <a href="subject.html#13029">[ subject ]</a>
              <a href="author.html#13029">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2011-05-31 15:37:16 -0700 (Tue, 31 May 2011)
New Revision: 6162

Modified:
   complete.html
   index
   source
Log:
[giow] (0) Remove pointless events from the PeerConnection object. Add an event summary. Fix fallout from recent changes.

Modified: complete.html
===================================================================
--- complete.html	2011-05-31 22:12:44 UTC (rev 6161)
+++ complete.html	2011-05-31 22:37:16 UTC (rev 6162)
@@ -64626,6 +64626,8 @@
   &lt;p&gt;&lt;a href=&quot;<A HREF="http://www.whatwg.org/demos/offline/clock/clock2.html">http://www.whatwg.org/demos/offline/clock/clock2.html</A>&quot;&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
 --&gt;
 
+
+
   &lt;h5 id=appcacheevents&gt;&lt;span class=secno&gt;6.6.1.1 &lt;/span&gt;Event summary&lt;/h5&gt;
 
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
@@ -74409,7 +74411,7 @@
   set to &lt;code title=dom-stream-LIVE&gt;&lt;a href=#dom-stream-live&gt;LIVE&lt;/a&gt;&lt;/code&gt; (1).&lt;/p&gt;
 
   &lt;p&gt;When a &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object ends for any reason other than
-  the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method being invoke
+  the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method being invoked
   (e.g. because the user rescinds the permission for the page to use
   the local camera, or because the data comes from a finite file and
   the file's end has been reached and the user has not requested that
@@ -74426,7 +74428,7 @@
 
    &lt;li&gt;&lt;p&gt;Set the object's &lt;code title=dom-stream-readyState&gt;&lt;a href=#dom-stream-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute to &lt;code title=dom-stream-ENDED&gt;&lt;a href=#dom-stream-ended&gt;ENDED&lt;/a&gt;&lt;/code&gt; (2).&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;ended&lt;/code&gt; at the object.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;&lt;a href=#event-stream-ended&gt;ended&lt;/a&gt;&lt;/code&gt; at the object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;If the end of the stream was reached due to a user request, the
   &lt;a href=#task-source&gt;task source&lt;/a&gt; for this &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; is the &lt;a href=#user-interaction-task-source&gt;user interaction task
@@ -74474,7 +74476,7 @@
 
    &lt;li&gt;&lt;p&gt;Set the object's &lt;code title=dom-stream-readyState&gt;&lt;a href=#dom-stream-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute to &lt;code title=dom-stream-ENDED&gt;&lt;a href=#dom-stream-ended&gt;ENDED&lt;/a&gt;&lt;/code&gt; (2).&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;ended&lt;/code&gt; at the object.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;&lt;a href=#event-stream-ended&gt;ended&lt;/a&gt;&lt;/code&gt; at the object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;The &lt;a href=#task-source&gt;task source&lt;/a&gt; for the &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; queued for the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method is the &lt;a href=#dom-manipulation-task-source&gt;DOM
   manipulation task source&lt;/a&gt;.&lt;/p&gt;
@@ -74523,7 +74525,7 @@
   all objects implementing the &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; interface:&lt;/p&gt;
 
   &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;Event handler&lt;/a&gt; &lt;th&gt;&lt;a href=#event-handler-event-type&gt;Event handler event type&lt;/a&gt;
-   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-stream-onended title=handler-stream-onended&gt;&lt;code&gt;onended&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-ended&gt;ended&lt;/code&gt;
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-stream-onended title=handler-stream-onended&gt;&lt;code&gt;onended&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-ended&gt;&lt;a href=#event-stream-ended&gt;ended&lt;/a&gt;&lt;/code&gt;
   &lt;/table&gt;&lt;/div&gt;
 
   &lt;div class=example&gt;
@@ -74726,14 +74728,14 @@
     video.src = URL.getObjectURL(stream);
     video.onerror = function () {
       stream.stop();
-      noStream();
-    }
+    };
+    stream.onended = noStream;
     video.onloadedmetadata = function () {
       canvas.width = video.videoWidth;
       canvas.height = video.videoHeight;
       document.getElementById('splash').hidden = true;
       document.getElementById('app').hidden = false;
-    }
+    };
   }
   function noStream() {
     document.getElementById('errorMessage').textContent = 'No camera available.';
@@ -74770,9 +74772,9 @@
 
   // &lt;span class=XXX&gt;connection quality information&lt;/span&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onconnecting title=handler-PeerConnection-onconnecting&gt;onconnecting&lt;/a&gt;;
-           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;onopen&lt;/a&gt;;
-           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onerror title=handler-PeerConnection-onerror&gt;onerror&lt;/a&gt;;
-           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onclose title=handler-PeerConnection-onclose&gt;onclose&lt;/a&gt;;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;onopen&lt;/a&gt;;&lt;!--
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onerror&quot;&gt;onerror&lt;/span&gt;;
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onclose&quot;&gt;onclose&lt;/span&gt;;--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onmessage title=handler-PeerConnection-onmessage&gt;onmessage&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onaddstream title=handler-PeerConnection-onaddstream&gt;onaddstream&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onremovestream title=handler-PeerConnection-onremovestream&gt;onremovestream&lt;/a&gt;;
@@ -74882,7 +74884,7 @@
     every message will be received.&lt;/p&gt;
 
     &lt;p&gt;When a message sent in this manner from the other peer is
-    received, a &lt;code title=event-stream-message&gt;message&lt;/code&gt;
+    received, a &lt;code title=event-stream-message&gt;&lt;a href=#event-stream-message&gt;message&lt;/a&gt;&lt;/code&gt;
     event is dispatched at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
     &lt;p&gt;The maximum length of &lt;var title=&quot;&quot;&gt;text&lt;/var&gt; is 504 bytes
@@ -74900,7 +74902,7 @@
     peer.&lt;/p&gt;
 
     &lt;p&gt;When the other peer starts sending a stream in this manner, an
-    &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt;
+    &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt;
     event is dispatched at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
    &lt;/dd&gt;
@@ -74912,7 +74914,7 @@
     &lt;p&gt;Steps sending the given stream to the remote peer.&lt;/p&gt;
 
     &lt;p&gt;When the other peer stops sending a stream in this manner, a
-    &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt;
+    &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt;
     event is dispatched at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
    &lt;/dd&gt;
@@ -74934,7 +74936,7 @@
     &lt;p&gt;Returns a live array containing the streams that the user agent
     is currently receiving from the remote peer.&lt;/p&gt;
 
-    &lt;p&gt;This array is updated when &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt; and &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt;
+    &lt;p&gt;This array is updated when &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt; and &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt;
     events are fired.&lt;/p&gt;
 
    &lt;/dd&gt;
@@ -75113,7 +75115,7 @@
    &lt;code title=dom-PeerConnection-NEW&gt;&lt;a href=#dom-peerconnection-new&gt;NEW&lt;/a&gt;&lt;/code&gt; (0), then
    &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that sets it to &lt;code title=dom-PeerConnection-NEGOTIATING&gt;&lt;a href=#dom-peerconnection-negotiating&gt;NEGOTIATING&lt;/a&gt;&lt;/code&gt; (1) and
    then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt;
-   named &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt; at the
+   named &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt; at the
    &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt; is
@@ -75182,7 +75184,7 @@
 
    &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to add the newly created
    &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object to the end of &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;'s &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt;
-   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt; with the newly
+   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt; with the newly
    created &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object at the &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt; object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt; finds
@@ -75199,7 +75201,7 @@
    there isn't one, then abort these steps.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to remove &lt;var title=&quot;&quot;&gt;stream&lt;/var&gt; from &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;'s &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt;
-   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt; with &lt;var title=&quot;&quot;&gt;stream&lt;/var&gt; at the &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;
+   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt; with &lt;var title=&quot;&quot;&gt;stream&lt;/var&gt; at the &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;
    object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;When the &lt;dfn id=dom-peerconnection-signalingmessage title=dom-PeerConnection-signalingMessage&gt;&lt;code title=&quot;&quot;&gt;signalingMessage()&lt;/code&gt;&lt;/dfn&gt; method is invoked, the
@@ -75265,15 +75267,15 @@
    &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; that sets &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;'s &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt;
    readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-NEGOTIATING&gt;&lt;a href=#dom-peerconnection-negotiating&gt;NEGOTIATING&lt;/a&gt;&lt;/code&gt; (1) and
    then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt;
-   named &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt; at the
+   named &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt; at the
    &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt;
-  completes ICE processing with any active media streams, the user
-  agent must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that sets the
+  completes ICE processing (even if there are no active streams), the
+  user agent must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that sets the
   &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object's
-  &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-ACTIVE&gt;&lt;a href=#dom-peerconnection-active&gt;ACTIVE&lt;/a&gt;&lt;/code&gt; (2) and then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt; named &lt;code title=event-stream-open&gt;open&lt;/code&gt; at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt;
-  object.&lt;/p&gt;
+  &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-ACTIVE&gt;&lt;a href=#dom-peerconnection-active&gt;ACTIVE&lt;/a&gt;&lt;/code&gt; (2) and then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt; named &lt;code title=event-stream-open&gt;&lt;a href=#event-stream-open&gt;open&lt;/a&gt;&lt;/code&gt; at the
+  &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
   &lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt;
   restarts ICE processing for any reason (e.g. because a peer is
@@ -75281,7 +75283,7 @@
   task&lt;/a&gt; that sets the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object's
   &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-NEGOTIATING&gt;&lt;a href=#dom-peerconnection-negotiating&gt;NEGOTIATING&lt;/a&gt;&lt;/code&gt; (1) and
   then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt;
-  named &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt; at the
+  named &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt; at the
   &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
                                    
   &lt;p&gt;The &lt;dfn id=dom-peerconnection-readystate title=dom-PeerConnection-readyState&gt;&lt;code title=&quot;&quot;&gt;readyState&lt;/code&gt;&lt;/dfn&gt; attribute must return the numeric
@@ -75398,11 +75400,11 @@
 
    &lt;li&gt;&lt;p&gt;Set the object's &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness
    state&lt;/a&gt; to &lt;code title=dom-PeerConnection-CLOSED&gt;&lt;a href=#dom-peerconnection-closed&gt;CLOSED&lt;/a&gt;&lt;/code&gt; (3).&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
-   event&lt;/a&gt; named &lt;code title=event-stream-close&gt;close&lt;/code&gt; at the
-   &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/li&gt;
-
+&lt;!--
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
+   event&lt;/span&gt; named &lt;code title=&quot;event-stream-close&quot;&gt;close&lt;/code&gt; at the
+   &lt;code&gt;PeerConnection&lt;/code&gt; object.&lt;/p&gt;&lt;/li&gt;
+--&gt;
   &lt;/ol&gt;&lt;p class=note&gt;The &lt;code title=dom-PeerConnection-localStreams&gt;&lt;a href=#dom-peerconnection-localstreams&gt;localStreams&lt;/a&gt;&lt;/code&gt; and
   &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt;
   objects remain in the state they were in when the object was
@@ -75415,13 +75417,13 @@
   interface:&lt;/p&gt;
 
   &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;Event handler&lt;/a&gt; &lt;th&gt;&lt;a href=#event-handler-event-type&gt;Event handler event type&lt;/a&gt;
-   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onconnecting title=handler-PeerConnection-onconnecting&gt;&lt;code&gt;onconnecting&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;&lt;code&gt;onopen&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-open&gt;open&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onerror title=handler-PeerConnection-onerror&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-error&gt;error&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onclose title=handler-PeerConnection-onclose&gt;&lt;code&gt;onclose&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-close&gt;close&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onmessage title=handler-PeerConnection-onmessage&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-message&gt;message&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onaddstream title=handler-PeerConnection-onaddstream&gt;&lt;code&gt;onaddstream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onremovestream title=handler-PeerConnection-onremovestream&gt;&lt;code&gt;onremovestream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt;
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onconnecting title=handler-PeerConnection-onconnecting&gt;&lt;code&gt;onconnecting&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;&lt;code&gt;onopen&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-open&gt;&lt;a href=#event-stream-open&gt;open&lt;/a&gt;&lt;/code&gt;
+&lt;!--    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onerror&quot;&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-error&quot;&gt;error&lt;/code&gt;--&gt;
+&lt;!--    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onclose&quot;&gt;&lt;code&gt;onclose&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-close&quot;&gt;close&lt;/code&gt;--&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onmessage title=handler-PeerConnection-onmessage&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-message&gt;&lt;a href=#event-stream-message&gt;message&lt;/a&gt;&lt;/code&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onaddstream title=handler-PeerConnection-onaddstream&gt;&lt;code&gt;onaddstream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onremovestream title=handler-PeerConnection-onremovestream&gt;&lt;code&gt;onremovestream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt;
   &lt;/table&gt;&lt;hr&gt;&lt;p&gt;The &lt;a href=#task-source&gt;task source&lt;/a&gt; for the &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; listed in this section is the
   &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt;.&lt;/p&gt;
 
@@ -75735,8 +75737,8 @@
 
   &lt;h3 id=event-definitions-0&gt;&lt;span class=secno&gt;9.7 &lt;/span&gt;Event definitions&lt;/h3&gt;
 
-  &lt;p&gt;The &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt; and
-  &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt; events
+  &lt;p&gt;The &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt; and
+  &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt; events
   use the &lt;code&gt;&lt;a href=#streamevent&gt;StreamEvent&lt;/a&gt;&lt;/code&gt; interface:&lt;/p&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=streamevent&gt;StreamEvent&lt;/dfn&gt; : &lt;a href=#event&gt;Event&lt;/a&gt; {
@@ -75763,10 +75765,58 @@
 
   &lt;h3 id=event-summary&gt;&lt;span class=secno&gt;9.8 &lt;/span&gt;Event Summary&lt;/h3&gt;
 
-  &lt;p class=XXX&gt;...will add event summary for streams here...&lt;/p&gt;
+  &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
 
-&lt;/div&gt;
+  &lt;p&gt;The following event fires on &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; objects:&lt;/p&gt;
 
+  &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Event name
+     &lt;th&gt;Interface
+     &lt;th&gt;Dispatched when...
+
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-ended title=event-stream-ended&gt;&lt;code&gt;ended&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#event&gt;Event&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;The &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object will no longer stream any data, either because the user revoked the permissions, or because the source device has been ejected, or because the remote peer stopped sending data, or because the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method was invoked.
+
+  &lt;/table&gt;&lt;p&gt;The following events fire on &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; objects:&lt;/p&gt;
+
+  &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Event name
+     &lt;th&gt;Interface
+     &lt;th&gt;Dispatched when...
+
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-connecting title=event-stream-connecting&gt;&lt;code&gt;connecting&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#event&gt;Event&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;The ICE Agent has begun negotiating with the peer. This can happen multiple times during the lifetime of the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-open title=event-stream-open&gt;&lt;code&gt;open&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#event&gt;Event&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;The ICE Agent has finished negotiating with the peer.
+
+&lt;!--
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-error&quot;&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-close&quot;&gt;&lt;code&gt;close&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;The &lt;code title=&quot;dom-PeerConnection-close&quot;&gt;close()&lt;/code&gt; method was called.
+--&gt;
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-message title=event-stream-message&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#messageevent&gt;MessageEvent&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;A &lt;a href=#data-udp-media-stream&gt;data UDP media stream&lt;/a&gt; message was received.
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-addstream title=event-stream-addstream&gt;&lt;code&gt;addstream&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#streamevent&gt;StreamEvent&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;A new stream has been added to the &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt; array.
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-removestream title=event-stream-removestream&gt;&lt;code&gt;removestream&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#streamevent&gt;StreamEvent&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;A stream has been removed from the &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt; array.
+
+  &lt;/table&gt;&lt;/div&gt;
+
 &lt;!--PEERCONNECTION--&gt;
 
 

Modified: index
===================================================================
--- index	2011-05-31 22:12:44 UTC (rev 6161)
+++ index	2011-05-31 22:37:16 UTC (rev 6162)
@@ -64618,6 +64618,8 @@
   &lt;p&gt;&lt;a href=&quot;<A HREF="http://www.whatwg.org/demos/offline/clock/clock2.html">http://www.whatwg.org/demos/offline/clock/clock2.html</A>&quot;&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
 --&gt;
 
+
+
   &lt;h5 id=appcacheevents&gt;&lt;span class=secno&gt;6.6.1.1 &lt;/span&gt;Event summary&lt;/h5&gt;
 
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
@@ -74424,7 +74426,7 @@
   set to &lt;code title=dom-stream-LIVE&gt;&lt;a href=#dom-stream-live&gt;LIVE&lt;/a&gt;&lt;/code&gt; (1).&lt;/p&gt;
 
   &lt;p&gt;When a &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object ends for any reason other than
-  the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method being invoke
+  the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method being invoked
   (e.g. because the user rescinds the permission for the page to use
   the local camera, or because the data comes from a finite file and
   the file's end has been reached and the user has not requested that
@@ -74441,7 +74443,7 @@
 
    &lt;li&gt;&lt;p&gt;Set the object's &lt;code title=dom-stream-readyState&gt;&lt;a href=#dom-stream-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute to &lt;code title=dom-stream-ENDED&gt;&lt;a href=#dom-stream-ended&gt;ENDED&lt;/a&gt;&lt;/code&gt; (2).&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;ended&lt;/code&gt; at the object.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;&lt;a href=#event-stream-ended&gt;ended&lt;/a&gt;&lt;/code&gt; at the object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;If the end of the stream was reached due to a user request, the
   &lt;a href=#task-source&gt;task source&lt;/a&gt; for this &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; is the &lt;a href=#user-interaction-task-source&gt;user interaction task
@@ -74489,7 +74491,7 @@
 
    &lt;li&gt;&lt;p&gt;Set the object's &lt;code title=dom-stream-readyState&gt;&lt;a href=#dom-stream-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute to &lt;code title=dom-stream-ENDED&gt;&lt;a href=#dom-stream-ended&gt;ENDED&lt;/a&gt;&lt;/code&gt; (2).&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;ended&lt;/code&gt; at the object.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; named &lt;code title=event-stream-ended&gt;&lt;a href=#event-stream-ended&gt;ended&lt;/a&gt;&lt;/code&gt; at the object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;The &lt;a href=#task-source&gt;task source&lt;/a&gt; for the &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; queued for the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method is the &lt;a href=#dom-manipulation-task-source&gt;DOM
   manipulation task source&lt;/a&gt;.&lt;/p&gt;
@@ -74538,7 +74540,7 @@
   all objects implementing the &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; interface:&lt;/p&gt;
 
   &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;Event handler&lt;/a&gt; &lt;th&gt;&lt;a href=#event-handler-event-type&gt;Event handler event type&lt;/a&gt;
-   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-stream-onended title=handler-stream-onended&gt;&lt;code&gt;onended&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-ended&gt;ended&lt;/code&gt;
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-stream-onended title=handler-stream-onended&gt;&lt;code&gt;onended&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-ended&gt;&lt;a href=#event-stream-ended&gt;ended&lt;/a&gt;&lt;/code&gt;
   &lt;/table&gt;&lt;/div&gt;
 
   &lt;div class=example&gt;
@@ -74741,14 +74743,14 @@
     video.src = URL.getObjectURL(stream);
     video.onerror = function () {
       stream.stop();
-      noStream();
-    }
+    };
+    stream.onended = noStream;
     video.onloadedmetadata = function () {
       canvas.width = video.videoWidth;
       canvas.height = video.videoHeight;
       document.getElementById('splash').hidden = true;
       document.getElementById('app').hidden = false;
-    }
+    };
   }
   function noStream() {
     document.getElementById('errorMessage').textContent = 'No camera available.';
@@ -74785,9 +74787,9 @@
 
   // &lt;span class=XXX&gt;connection quality information&lt;/span&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onconnecting title=handler-PeerConnection-onconnecting&gt;onconnecting&lt;/a&gt;;
-           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;onopen&lt;/a&gt;;
-           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onerror title=handler-PeerConnection-onerror&gt;onerror&lt;/a&gt;;
-           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onclose title=handler-PeerConnection-onclose&gt;onclose&lt;/a&gt;;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;onopen&lt;/a&gt;;&lt;!--
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onerror&quot;&gt;onerror&lt;/span&gt;;
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onclose&quot;&gt;onclose&lt;/span&gt;;--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onmessage title=handler-PeerConnection-onmessage&gt;onmessage&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onaddstream title=handler-PeerConnection-onaddstream&gt;onaddstream&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-peerconnection-onremovestream title=handler-PeerConnection-onremovestream&gt;onremovestream&lt;/a&gt;;
@@ -74897,7 +74899,7 @@
     every message will be received.&lt;/p&gt;
 
     &lt;p&gt;When a message sent in this manner from the other peer is
-    received, a &lt;code title=event-stream-message&gt;message&lt;/code&gt;
+    received, a &lt;code title=event-stream-message&gt;&lt;a href=#event-stream-message&gt;message&lt;/a&gt;&lt;/code&gt;
     event is dispatched at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
     &lt;p&gt;The maximum length of &lt;var title=&quot;&quot;&gt;text&lt;/var&gt; is 504 bytes
@@ -74915,7 +74917,7 @@
     peer.&lt;/p&gt;
 
     &lt;p&gt;When the other peer starts sending a stream in this manner, an
-    &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt;
+    &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt;
     event is dispatched at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
    &lt;/dd&gt;
@@ -74927,7 +74929,7 @@
     &lt;p&gt;Steps sending the given stream to the remote peer.&lt;/p&gt;
 
     &lt;p&gt;When the other peer stops sending a stream in this manner, a
-    &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt;
+    &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt;
     event is dispatched at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
    &lt;/dd&gt;
@@ -74949,7 +74951,7 @@
     &lt;p&gt;Returns a live array containing the streams that the user agent
     is currently receiving from the remote peer.&lt;/p&gt;
 
-    &lt;p&gt;This array is updated when &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt; and &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt;
+    &lt;p&gt;This array is updated when &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt; and &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt;
     events are fired.&lt;/p&gt;
 
    &lt;/dd&gt;
@@ -75128,7 +75130,7 @@
    &lt;code title=dom-PeerConnection-NEW&gt;&lt;a href=#dom-peerconnection-new&gt;NEW&lt;/a&gt;&lt;/code&gt; (0), then
    &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that sets it to &lt;code title=dom-PeerConnection-NEGOTIATING&gt;&lt;a href=#dom-peerconnection-negotiating&gt;NEGOTIATING&lt;/a&gt;&lt;/code&gt; (1) and
    then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt;
-   named &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt; at the
+   named &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt; at the
    &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt; is
@@ -75197,7 +75199,7 @@
 
    &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to add the newly created
    &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object to the end of &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;'s &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt;
-   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt; with the newly
+   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt; with the newly
    created &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object at the &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt; object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt; finds
@@ -75214,7 +75216,7 @@
    there isn't one, then abort these steps.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to remove &lt;var title=&quot;&quot;&gt;stream&lt;/var&gt; from &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;'s &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt;
-   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt; with &lt;var title=&quot;&quot;&gt;stream&lt;/var&gt; at the &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;
+   array, then &lt;a href=#fire-a-stream-event&gt;fire a stream event&lt;/a&gt; named &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt; with &lt;var title=&quot;&quot;&gt;stream&lt;/var&gt; at the &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;
    object.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;When the &lt;dfn id=dom-peerconnection-signalingmessage title=dom-PeerConnection-signalingMessage&gt;&lt;code title=&quot;&quot;&gt;signalingMessage()&lt;/code&gt;&lt;/dfn&gt; method is invoked, the
@@ -75280,15 +75282,15 @@
    &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; that sets &lt;var title=&quot;&quot;&gt;connection&lt;/var&gt;'s &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt;
    readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-NEGOTIATING&gt;&lt;a href=#dom-peerconnection-negotiating&gt;NEGOTIATING&lt;/a&gt;&lt;/code&gt; (1) and
    then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt;
-   named &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt; at the
+   named &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt; at the
    &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt;
-  completes ICE processing with any active media streams, the user
-  agent must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that sets the
+  completes ICE processing (even if there are no active streams), the
+  user agent must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that sets the
   &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object's
-  &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-ACTIVE&gt;&lt;a href=#dom-peerconnection-active&gt;ACTIVE&lt;/a&gt;&lt;/code&gt; (2) and then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt; named &lt;code title=event-stream-open&gt;open&lt;/code&gt; at the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt;
-  object.&lt;/p&gt;
+  &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-ACTIVE&gt;&lt;a href=#dom-peerconnection-active&gt;ACTIVE&lt;/a&gt;&lt;/code&gt; (2) and then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt; named &lt;code title=event-stream-open&gt;&lt;a href=#event-stream-open&gt;open&lt;/a&gt;&lt;/code&gt; at the
+  &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
   &lt;p&gt;When a &lt;a href=#peerconnection-ice-agent&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/a&gt;
   restarts ICE processing for any reason (e.g. because a peer is
@@ -75296,7 +75298,7 @@
   task&lt;/a&gt; that sets the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object's
   &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness state&lt;/a&gt; to &lt;code title=dom-PeerConnection-NEGOTIATING&gt;&lt;a href=#dom-peerconnection-negotiating&gt;NEGOTIATING&lt;/a&gt;&lt;/code&gt; (1) and
   then &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/a&gt;
-  named &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt; at the
+  named &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt; at the
   &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
                                    
   &lt;p&gt;The &lt;dfn id=dom-peerconnection-readystate title=dom-PeerConnection-readyState&gt;&lt;code title=&quot;&quot;&gt;readyState&lt;/code&gt;&lt;/dfn&gt; attribute must return the numeric
@@ -75413,11 +75415,11 @@
 
    &lt;li&gt;&lt;p&gt;Set the object's &lt;a href=#peerconnection-readiness-state&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness
    state&lt;/a&gt; to &lt;code title=dom-PeerConnection-CLOSED&gt;&lt;a href=#dom-peerconnection-closed&gt;CLOSED&lt;/a&gt;&lt;/code&gt; (3).&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
-   event&lt;/a&gt; named &lt;code title=event-stream-close&gt;close&lt;/code&gt; at the
-   &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.&lt;/li&gt;
-
+&lt;!--
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
+   event&lt;/span&gt; named &lt;code title=&quot;event-stream-close&quot;&gt;close&lt;/code&gt; at the
+   &lt;code&gt;PeerConnection&lt;/code&gt; object.&lt;/p&gt;&lt;/li&gt;
+--&gt;
   &lt;/ol&gt;&lt;p class=note&gt;The &lt;code title=dom-PeerConnection-localStreams&gt;&lt;a href=#dom-peerconnection-localstreams&gt;localStreams&lt;/a&gt;&lt;/code&gt; and
   &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt;
   objects remain in the state they were in when the object was
@@ -75430,13 +75432,13 @@
   interface:&lt;/p&gt;
 
   &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;Event handler&lt;/a&gt; &lt;th&gt;&lt;a href=#event-handler-event-type&gt;Event handler event type&lt;/a&gt;
-   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onconnecting title=handler-PeerConnection-onconnecting&gt;&lt;code&gt;onconnecting&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-connecting&gt;connecting&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;&lt;code&gt;onopen&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-open&gt;open&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onerror title=handler-PeerConnection-onerror&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-error&gt;error&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onclose title=handler-PeerConnection-onclose&gt;&lt;code&gt;onclose&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-close&gt;close&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onmessage title=handler-PeerConnection-onmessage&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-message&gt;message&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onaddstream title=handler-PeerConnection-onaddstream&gt;&lt;code&gt;onaddstream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onremovestream title=handler-PeerConnection-onremovestream&gt;&lt;code&gt;onremovestream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt;
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onconnecting title=handler-PeerConnection-onconnecting&gt;&lt;code&gt;onconnecting&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-connecting&gt;&lt;a href=#event-stream-connecting&gt;connecting&lt;/a&gt;&lt;/code&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onopen title=handler-PeerConnection-onopen&gt;&lt;code&gt;onopen&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-open&gt;&lt;a href=#event-stream-open&gt;open&lt;/a&gt;&lt;/code&gt;
+&lt;!--    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onerror&quot;&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-error&quot;&gt;error&lt;/code&gt;--&gt;
+&lt;!--    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onclose&quot;&gt;&lt;code&gt;onclose&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-close&quot;&gt;close&lt;/code&gt;--&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onmessage title=handler-PeerConnection-onmessage&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-message&gt;&lt;a href=#event-stream-message&gt;message&lt;/a&gt;&lt;/code&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onaddstream title=handler-PeerConnection-onaddstream&gt;&lt;code&gt;onaddstream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-peerconnection-onremovestream title=handler-PeerConnection-onremovestream&gt;&lt;code&gt;onremovestream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt;
   &lt;/table&gt;&lt;hr&gt;&lt;p&gt;The &lt;a href=#task-source&gt;task source&lt;/a&gt; for the &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; listed in this section is the
   &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt;.&lt;/p&gt;
 
@@ -75750,8 +75752,8 @@
 
   &lt;h3 id=event-definitions-0&gt;&lt;span class=secno&gt;9.7 &lt;/span&gt;Event definitions&lt;/h3&gt;
 
-  &lt;p&gt;The &lt;code title=event-stream-addstream&gt;addstream&lt;/code&gt; and
-  &lt;code title=event-stream-removestream&gt;removestream&lt;/code&gt; events
+  &lt;p&gt;The &lt;code title=event-stream-addstream&gt;&lt;a href=#event-stream-addstream&gt;addstream&lt;/a&gt;&lt;/code&gt; and
+  &lt;code title=event-stream-removestream&gt;&lt;a href=#event-stream-removestream&gt;removestream&lt;/a&gt;&lt;/code&gt; events
   use the &lt;code&gt;&lt;a href=#streamevent&gt;StreamEvent&lt;/a&gt;&lt;/code&gt; interface:&lt;/p&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=streamevent&gt;StreamEvent&lt;/dfn&gt; : &lt;a href=#event&gt;Event&lt;/a&gt; {
@@ -75778,10 +75780,58 @@
 
   &lt;h3 id=event-summary&gt;&lt;span class=secno&gt;9.8 &lt;/span&gt;Event Summary&lt;/h3&gt;
 
-  &lt;p class=XXX&gt;...will add event summary for streams here...&lt;/p&gt;
+  &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
 
-&lt;/div&gt;
+  &lt;p&gt;The following event fires on &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; objects:&lt;/p&gt;
 
+  &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Event name
+     &lt;th&gt;Interface
+     &lt;th&gt;Dispatched when...
+
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-ended title=event-stream-ended&gt;&lt;code&gt;ended&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#event&gt;Event&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;The &lt;code&gt;&lt;a href=#stream&gt;Stream&lt;/a&gt;&lt;/code&gt; object will no longer stream any data, either because the user revoked the permissions, or because the source device has been ejected, or because the remote peer stopped sending data, or because the &lt;code title=dom-stream-stop&gt;&lt;a href=#dom-stream-stop&gt;stop()&lt;/a&gt;&lt;/code&gt; method was invoked.
+
+  &lt;/table&gt;&lt;p&gt;The following events fire on &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; objects:&lt;/p&gt;
+
+  &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Event name
+     &lt;th&gt;Interface
+     &lt;th&gt;Dispatched when...
+
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-connecting title=event-stream-connecting&gt;&lt;code&gt;connecting&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#event&gt;Event&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;The ICE Agent has begun negotiating with the peer. This can happen multiple times during the lifetime of the &lt;code&gt;&lt;a href=#peerconnection&gt;PeerConnection&lt;/a&gt;&lt;/code&gt; object.
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-open title=event-stream-open&gt;&lt;code&gt;open&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#event&gt;Event&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;The ICE Agent has finished negotiating with the peer.
+
+&lt;!--
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-error&quot;&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-close&quot;&gt;&lt;code&gt;close&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;The &lt;code title=&quot;dom-PeerConnection-close&quot;&gt;close()&lt;/code&gt; method was called.
+--&gt;
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-message title=event-stream-message&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#messageevent&gt;MessageEvent&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;A &lt;a href=#data-udp-media-stream&gt;data UDP media stream&lt;/a&gt; message was received.
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-addstream title=event-stream-addstream&gt;&lt;code&gt;addstream&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#streamevent&gt;StreamEvent&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;A new stream has been added to the &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt; array.
+
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stream-removestream title=event-stream-removestream&gt;&lt;code&gt;removestream&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;&lt;a href=#streamevent&gt;StreamEvent&lt;/a&gt;&lt;/code&gt;
+     &lt;td&gt;A stream has been removed from the &lt;code title=dom-PeerConnection-remoteStreams&gt;&lt;a href=#dom-peerconnection-remotestreams&gt;remoteStreams&lt;/a&gt;&lt;/code&gt; array.
+
+  &lt;/table&gt;&lt;/div&gt;
+
 &lt;!--PEERCONNECTION--&gt;
 &lt;!--POSTMSG--&gt;
 

Modified: source
===================================================================
--- source	2011-05-31 22:12:44 UTC (rev 6161)
+++ source	2011-05-31 22:37:16 UTC (rev 6162)
@@ -37498,6 +37498,8 @@
      &lt;td&gt;Either the &lt;code title=&quot;dom-MediaController-volume&quot;&gt;volume&lt;/code&gt; attribute or the &lt;code title=&quot;dom-MediaController-muted&quot;&gt;muted&lt;/code&gt; attribute has just been updated.
   &lt;/table&gt;
 
+
+
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;h5&gt;Security and privacy considerations&lt;/h5&gt;
@@ -73629,6 +73631,8 @@
   &lt;p&gt;&lt;a href=&quot;<A HREF="http://www.whatwg.org/demos/offline/clock/clock2.html">http://www.whatwg.org/demos/offline/clock/clock2.html</A>&quot;&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
 --&gt;
 
+
+
   &lt;h5 id=&quot;appcacheevents&quot;&gt;Event summary&lt;/h5&gt;
 
   &lt;!--END dev-html--&gt;&lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;&lt;!--START dev-html--&gt;
@@ -85089,7 +85093,7 @@
   set to &lt;code title=&quot;dom-stream-LIVE&quot;&gt;LIVE&lt;/code&gt; (1).&lt;/p&gt;
 
   &lt;p&gt;When a &lt;code&gt;Stream&lt;/code&gt; object ends for any reason other than
-  the &lt;code title=&quot;dom-stream-stop&quot;&gt;stop()&lt;/code&gt; method being invoke
+  the &lt;code title=&quot;dom-stream-stop&quot;&gt;stop()&lt;/code&gt; method being invoked
   (e.g. because the user rescinds the permission for the page to use
   the local camera, or because the data comes from a finite file and
   the file's end has been reached and the user has not requested that
@@ -85465,14 +85469,14 @@
     video.src = URL.getObjectURL(stream);
     video.onerror = function () {
       stream.stop();
-      noStream();
-    }
+    };
+    stream.onended = noStream;
     video.onloadedmetadata = function () {
       canvas.width = video.videoWidth;
       canvas.height = video.videoHeight;
       document.getElementById('splash').hidden = true;
       document.getElementById('app').hidden = false;
-    }
+    };
   }
   function noStream() {
     document.getElementById('errorMessage').textContent = 'No camera available.';
@@ -85509,9 +85513,9 @@
 
   // &lt;span class=&quot;XXX&quot;&gt;connection quality information&lt;/span&gt;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onconnecting&quot;&gt;onconnecting&lt;/span&gt;;
-           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onopen&quot;&gt;onopen&lt;/span&gt;;
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onopen&quot;&gt;onopen&lt;/span&gt;;&lt;!--
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onerror&quot;&gt;onerror&lt;/span&gt;;
-           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onclose&quot;&gt;onclose&lt;/span&gt;;
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onclose&quot;&gt;onclose&lt;/span&gt;;--&gt;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onmessage&quot;&gt;onmessage&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onaddstream&quot;&gt;onaddstream&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-PeerConnection-onremovestream&quot;&gt;onremovestream&lt;/span&gt;;
@@ -86098,14 +86102,14 @@
   &lt;/ol&gt;
 
   &lt;p&gt;When a &lt;span&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/span&gt;
-  completes ICE processing with any active media streams, the user
-  agent must &lt;span&gt;queue a task&lt;/span&gt; that sets the
+  completes ICE processing (even if there are no active streams), the
+  user agent must &lt;span&gt;queue a task&lt;/span&gt; that sets the
   &lt;code&gt;PeerConnection&lt;/code&gt; object's
   &lt;span&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness state&lt;/span&gt; to &lt;code
   title=&quot;dom-PeerConnection-ACTIVE&quot;&gt;ACTIVE&lt;/code&gt; (2) and then &lt;span
   title=&quot;fire a simple event&quot;&gt;fires a simple event&lt;/span&gt; named &lt;code
-  title=&quot;event-stream-open&quot;&gt;open&lt;/code&gt; at the &lt;code&gt;PeerConnection&lt;/code&gt;
-  object.&lt;/p&gt;
+  title=&quot;event-stream-open&quot;&gt;open&lt;/code&gt; at the
+  &lt;code&gt;PeerConnection&lt;/code&gt; object.&lt;/p&gt;
 
   &lt;p&gt;When a &lt;span&gt;&lt;code&gt;PeerConnection&lt;/code&gt; ICE Agent&lt;/span&gt;
   restarts ICE processing for any reason (e.g. because a peer is
@@ -86263,11 +86267,11 @@
    &lt;li&gt;&lt;p&gt;Set the object's &lt;span&gt;&lt;code&gt;PeerConnection&lt;/code&gt; readiness
    state&lt;/span&gt; to &lt;code
    title=&quot;dom-PeerConnection-CLOSED&quot;&gt;CLOSED&lt;/code&gt; (3).&lt;/p&gt;&lt;/li&gt;
-
+&lt;!--
    &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
    event&lt;/span&gt; named &lt;code title=&quot;event-stream-close&quot;&gt;close&lt;/code&gt; at the
    &lt;code&gt;PeerConnection&lt;/code&gt; object.&lt;/p&gt;&lt;/li&gt;
-
+--&gt;
   &lt;/ol&gt;
 
   &lt;p class=&quot;note&quot;&gt;The &lt;code
@@ -86290,8 +86294,8 @@
    &lt;tbody&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onconnecting&quot;&gt;&lt;code&gt;onconnecting&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-connecting&quot;&gt;connecting&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onopen&quot;&gt;&lt;code&gt;onopen&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-open&quot;&gt;open&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onerror&quot;&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-error&quot;&gt;error&lt;/code&gt;
-    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onclose&quot;&gt;&lt;code&gt;onclose&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-close&quot;&gt;close&lt;/code&gt;
+&lt;!--    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onerror&quot;&gt;&lt;code&gt;onerror&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-error&quot;&gt;error&lt;/code&gt;--&gt;
+&lt;!--    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onclose&quot;&gt;&lt;code&gt;onclose&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-close&quot;&gt;close&lt;/code&gt;--&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onmessage&quot;&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-message&quot;&gt;message&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onaddstream&quot;&gt;&lt;code&gt;onaddstream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-addstream&quot;&gt;addstream&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-PeerConnection-onremovestream&quot;&gt;&lt;code&gt;onremovestream&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-stream-removestream&quot;&gt;removestream&lt;/code&gt;
@@ -86679,8 +86683,76 @@
 
   &lt;h3&gt;Event Summary&lt;/h3&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;...will add event summary for streams here...&lt;/p&gt;
+  &lt;!--END dev-html--&gt;&lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;&lt;!--START dev-html--&gt;
 
+  &lt;p&gt;The following event fires on &lt;code&gt;Stream&lt;/code&gt; objects:&lt;/p&gt;
+
+  &lt;table&gt;
+   &lt;thead&gt;
+    &lt;tr&gt;
+     &lt;th&gt;Event name
+     &lt;th&gt;Interface
+     &lt;th&gt;Dispatched when...
+
+   &lt;tbody&gt;
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-ended&quot;&gt;&lt;code&gt;ended&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;The &lt;code&gt;Stream&lt;/code&gt; object will no longer stream any data, either because the user revoked the permissions, or because the source device has been ejected, or because the remote peer stopped sending data, or because the &lt;code title=&quot;dom-stream-stop&quot;&gt;stop()&lt;/code&gt; method was invoked.
+
+  &lt;/table&gt;
+
+
+  &lt;p&gt;The following events fire on &lt;code&gt;PeerConnection&lt;/code&gt; objects:&lt;/p&gt;
+
+  &lt;table&gt;
+   &lt;thead&gt;
+    &lt;tr&gt;
+     &lt;th&gt;Event name
+     &lt;th&gt;Interface
+     &lt;th&gt;Dispatched when...
+
+   &lt;tbody&gt;
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-connecting&quot;&gt;&lt;code&gt;connecting&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;The ICE Agent has begun negotiating with the peer. This can happen multiple times during the lifetime of the &lt;code&gt;PeerConnection&lt;/code&gt; object.
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-open&quot;&gt;&lt;code&gt;open&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;The ICE Agent has finished negotiating with the peer.
+
+&lt;!--
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-error&quot;&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-close&quot;&gt;&lt;code&gt;close&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
+     &lt;td&gt;The &lt;code title=&quot;dom-PeerConnection-close&quot;&gt;close()&lt;/code&gt; method was called.
+--&gt;
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-message&quot;&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;MessageEvent&lt;/code&gt;
+     &lt;td&gt;A &lt;span&gt;data UDP media stream&lt;/span&gt; message was received.
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-addstream&quot;&gt;&lt;code&gt;addstream&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;StreamEvent&lt;/code&gt;
+     &lt;td&gt;A new stream has been added to the &lt;code title=&quot;dom-PeerConnection-remoteStreams&quot;&gt;remoteStreams&lt;/code&gt; array.
+
+    &lt;tr&gt;
+     &lt;td&gt;&lt;dfn title=&quot;event-stream-removestream&quot;&gt;&lt;code&gt;removestream&lt;/code&gt;&lt;/dfn&gt;
+     &lt;td&gt;&lt;code&gt;StreamEvent&lt;/code&gt;
+     &lt;td&gt;A stream has been removed from the &lt;code title=&quot;dom-PeerConnection-remoteStreams&quot;&gt;remoteStreams&lt;/code&gt; array.
+
+  &lt;/table&gt;
+
 &lt;/div&gt;
 
 &lt;!--END rtc--&gt;&lt;!--START w3c-html--&gt;&lt;!--PEERCONNECTION--&gt;


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013028.html">[html5] r6161 - [giow] (0) Make it so that taking out all the	streams temporarily doesn't kill a [...]
</A></li>
	<LI>Next message: <A HREF="013030.html">[html5] r6163 - [giow] (0) Avoid salvaging documents that have	active PeerConnections. (Maybe we [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13029">[ date ]</a>
              <a href="thread.html#13029">[ thread ]</a>
              <a href="subject.html#13029">[ subject ]</a>
              <a href="author.html#13029">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
