<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r5740 - [acgiow] (1) Revamp how type=email multiple='' is	specced. Fixing http://www.w3. [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5740%20-%20%5Bacgiow%5D%20%281%29%20Revamp%20how%20type%3Demail%20multiple%3D%27%27%20is%0A%09specced.%20Fixing%20http%3A//www.w3.%20%5B...%5D&In-Reply-To=%3C20110105234220.89FA1805820F%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012606.html">
   <LINK REL="Next"  HREF="012608.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r5740 - [acgiow] (1) Revamp how type=email multiple='' is	specced. Fixing http://www.w3. [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5740%20-%20%5Bacgiow%5D%20%281%29%20Revamp%20how%20type%3Demail%20multiple%3D%27%27%20is%0A%09specced.%20Fixing%20http%3A//www.w3.%20%5B...%5D&In-Reply-To=%3C20110105234220.89FA1805820F%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r5740 - [acgiow] (1) Revamp how type=email multiple='' is	specced. Fixing http://www.w3. [...]">whatwg at whatwg.org
       </A><BR>
    <I>Wed Jan  5 15:42:20 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012606.html">[html5] r5739 - [] (0) Clarify whether the APIs for the text field	selections operate on the 'va [...]
</A></li>
        <LI>Next message: <A HREF="012608.html">[html5] r5741 - [e] (0) update spec subheading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12607">[ date ]</a>
              <a href="thread.html#12607">[ thread ]</a>
              <a href="subject.html#12607">[ subject ]</a>
              <a href="author.html#12607">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2011-01-05 15:42:19 -0800 (Wed, 05 Jan 2011)
New Revision: 5740

Modified:
   complete.html
   index
   source
Log:
[acgiow] (1) Revamp how type=email multiple='' is specced.
Fixing <A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=11137">http://www.w3.org/Bugs/Public/show_bug.cgi?id=11137</A>

Modified: complete.html
===================================================================
--- complete.html	2011-01-05 00:38:49 UTC (rev 5739)
+++ complete.html	2011-01-05 23:42:19 UTC (rev 5740)
@@ -39953,7 +39953,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=yes&gt; Yes&dagger; &lt;!-- E-mail --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Password --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Date --&gt;
@@ -39977,7 +39977,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -40001,7 +40001,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -40025,7 +40025,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -40049,7 +40049,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -40166,8 +40166,13 @@
      &lt;td class=no&gt; &middot; &lt;!-- Reset Button --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Button --&gt;
 
-  &lt;/table&gt;&lt;div class=impl&gt;
+  &lt;/table&gt;&lt;p class=note&gt;&dagger; The dagger symbol (&dagger;) indicates that
+  the feature only applies when the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is not
+  specified.&lt;/p&gt;
 
+
+  &lt;div class=impl&gt;
+
   &lt;p&gt;Some states of the &lt;code title=attr-input-type&gt;&lt;a href=#attr-input-type&gt;type&lt;/a&gt;&lt;/code&gt;
   attribute define a &lt;dfn id=value-sanitization-algorithm&gt;value sanitization algorithm&lt;/dfn&gt;.&lt;/p&gt;
 
@@ -40797,67 +40802,143 @@
 
   &lt;/div&gt;
 
-  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; a control
-  for editing a list of e-mail addresses given in the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
+  &lt;p&gt;How the &lt;a href=#e-mail-state title=attr-input-type-email&gt;E-mail&lt;/a&gt; state
+  operates depends on whether the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is specified
+  or not.&lt;/p&gt;
 
-  &lt;div class=impl&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+   attribute is not specified on the element&lt;/dt&gt;
 
-  &lt;p&gt;If the element is &lt;i title=concept-input-mutable&gt;&lt;a href=#concept-input-mutable&gt;mutable&lt;/a&gt;&lt;/i&gt;,
-  the user agent should allow the user to change the e-mail addresses
-  represented by its &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. If
-  the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is
-  specified, then the user agent should allow the user to select or
-  provide multiple addresses; otherwise, the user agent should act in
-  a manner consistent with expecting the user to provide a single
-  e-mail address. User agents may allow the user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to a string that is not a
-  &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;. User agents should allow the
-  user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to the
-  empty string. User agents must not allow users to insert U+000A LINE
-  FEED (LF) or U+000D CARRIAGE RETURN (CR) characters into the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. User agents may transform the
-  &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; for display and editing
-  (e.g. converting punycode in the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to IDN in the display and vice
-  versa).&lt;/p&gt;
+   &lt;dd&gt;
 
-  &lt;/div&gt;
+    &lt;p&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; a
+    control for editing an e-mail address given in the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;If the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
-  attribute is specified on the element, then the &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if specified, must
-  have a value that is a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;;
-  otherwise, the &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt;
-  attribute, if specified, must have a value that is a single
-  &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;.&lt;/p&gt;
+    &lt;div class=impl&gt;
 
-  &lt;div class=impl&gt;
+    &lt;p&gt;If the element is &lt;i title=concept-input-mutable&gt;&lt;a href=#concept-input-mutable&gt;mutable&lt;/a&gt;&lt;/i&gt;,
+    the user agent should allow the user to change the e-mail address
+    represented by its &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.
+    User agents may allow the user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to a string that is not a
+    &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;. The user agent should act in a
+    manner consistent with expecting the user to provide a single
+    e-mail address. User agents should allow the user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to the empty string. User
+    agents must not allow users to insert U+000A LINE FEED (LF) or
+    U+000D CARRIAGE RETURN (CR) characters into the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. User agents may transform
+    the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; for display and
+    editing (e.g. converting punycode in the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to IDN in the display and
+    vice versa).&lt;/p&gt;
 
-  &lt;p&gt;&lt;strong&gt;The &lt;a href=#value-sanitization-algorithm&gt;value sanitization algorithm&lt;/a&gt; is as
-  follows&lt;/strong&gt;: &lt;a href=#strip-line-breaks&gt;Strip line breaks&lt;/a&gt; from the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
+    &lt;/div&gt;
 
-  &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: If the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is specified
-  on the element, then, while the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
-  &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, the element is
-  &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;; otherwise, while the
-  &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
-  single &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;, the element is
-  &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;The &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
+    specified, must have a value that is a single &lt;a href=#valid-e-mail-address&gt;valid e-mail
+    address&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
-  attribute is specified on the element, then, the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; are the result of
-  &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;splitting on commas&lt;/a&gt;
-  the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. (This is
-  used to define how the &lt;code title=attr-input-pattern&gt;&lt;a href=#attr-input-pattern&gt;pattern&lt;/a&gt;&lt;/code&gt; attribute applies when the
-  &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is
-  specified.)&lt;/p&gt;
+    &lt;div class=impl&gt;
 
-  &lt;/div&gt;
+    &lt;p&gt;&lt;strong&gt;The &lt;a href=#value-sanitization-algorithm&gt;value sanitization algorithm&lt;/a&gt; is as
+    follows&lt;/strong&gt;: &lt;a href=#strip-line-breaks&gt;Strip line breaks&lt;/a&gt; from the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;A &lt;dfn id=valid-e-mail-address-list&gt;valid e-mail address list&lt;/dfn&gt; is a &lt;a href=#set-of-comma-separated-tokens&gt;set of
-  comma-separated tokens&lt;/a&gt;, where each token is itself a
-  &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;. &lt;span class=impl&gt;To obtain the
-  list of tokens from a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, the
-  user agent must &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;split the
-  string on commas&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;
+    &lt;p&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+    attribute is removed, the user agent must run the &lt;a href=#value-sanitization-algorithm&gt;value
+    sanitization algorithm&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;A &lt;dfn id=valid-e-mail-address&gt;valid e-mail address&lt;/dfn&gt; is a string that matches the
+    &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: While the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
+    single &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;, the element is
+    &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+   attribute &lt;em&gt;is&lt;/em&gt; specified on the element&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;div class=impl&gt;
+
+    &lt;p&gt;The element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; are the result of
+    &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;splitting on commas&lt;/a&gt;
+    the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+    &lt;p&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; a
+    control for adding, removing, and editing the e-mail addresses
+    given in the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;div class=impl&gt;
+
+    &lt;p&gt;If the element is &lt;i title=concept-input-mutable&gt;&lt;a href=#concept-input-mutable&gt;mutable&lt;/a&gt;&lt;/i&gt;,
+    the user agent should allow the user to add, remove, and edit the
+    e-mail addresses represented by its &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;. User agents may
+    allow the user to set any individual value in the list of &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; to a string that
+    is not a &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;, but must not allow
+    users to set any individual value to a string containing U+002C
+    COMMA (,), U+000A LINE FEED (LF), or U+000D CARRIAGE RETURN (CR)
+    characters. User agents should allow the user to remove all the
+    addresses in the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;. User agents may
+    transform the &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; for display and
+    editing (e.g. converting punycode in the &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; to IDN in the
+    display and vice versa).&lt;/p&gt;
+
+    &lt;p&gt;Whenever the user changes the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;, the user agent
+    must run the following steps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;latest values&lt;/var&gt; be a copy of the
+     element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;!-- It's a copy because /values/ might include leading and
+     trailing spaces that we don't necessarily want to remove from the
+     UI but that we do want to remove before serialising. --&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;a href=#strip-leading-and-trailing-whitespace&gt;Strip leading and trailing whitespace&lt;/a&gt; from
+     each value in &lt;var title=&quot;&quot;&gt;latest values&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; be the result of
+     concatenating all the values in &lt;var title=&quot;&quot;&gt;latest
+     values&lt;/var&gt;, separating each value from the next by a single
+     U+002C COMMA character (,), maintaining the list's
+     order.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/div&gt;
+
+    &lt;p&gt;The &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
+    specified, must have a value that is a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address
+    list&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;div class=impl&gt;
+
+    &lt;p&gt;&lt;strong&gt;The &lt;a href=#value-sanitization-algorithm&gt;value sanitization algorithm&lt;/a&gt; is as
+    follows&lt;/strong&gt;:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;Split on
+     commas&lt;/a&gt; the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;, &lt;a href=#strip-leading-and-trailing-whitespace&gt;strip leading and
+     trailing whitespace&lt;/a&gt; from each resulting token, if any, and
+     let the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; be the (possibly
+     empty) resulting list of (possibly empty) tokens, maintaining the
+     original order.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; be the result of
+     concatenating the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;, separating each
+     value from the next by a single U+002C COMMA character (,),
+     maintaining the list's order.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;p&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+    attribute is set, the user agent must run the &lt;a href=#value-sanitization-algorithm&gt;value
+    sanitization algorithm&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: While the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
+    &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, the element is
+    &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p&gt;A &lt;dfn id=valid-e-mail-address&gt;valid e-mail address&lt;/dfn&gt; is a string that matches the
   ABNF production &lt;code title=&quot;&quot;&gt;1*(&nbsp;atext&nbsp;/&nbsp;&quot;.&quot;&nbsp;)&nbsp;&quot;@&quot;&nbsp;ldh-str&nbsp;1*(&nbsp;&quot;.&quot;&nbsp;ldh-str&nbsp;)&lt;/code&gt;
   where &lt;code title=&quot;&quot;&gt;atext&lt;/code&gt; is defined in RFC 5322 section
   3.2.3, and &lt;code title=&quot;&quot;&gt;ldh-str&lt;/code&gt; is defined in RFC 1034
@@ -40871,6 +40952,13 @@
   space characters, and quoted strings in manners unfamiliar to most
   users) to be of practical use here.&lt;/p&gt;
 
+  &lt;p&gt;A &lt;dfn id=valid-e-mail-address-list&gt;valid e-mail address list&lt;/dfn&gt; is a &lt;a href=#set-of-comma-separated-tokens&gt;set of
+  comma-separated tokens&lt;/a&gt;, where each token is itself a
+  &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;. &lt;span class=impl&gt;To obtain the
+  list of tokens from a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, and
+  implementation must &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;split the
+  string on commas&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;
+
   &lt;div class=bookkeeping&gt;
 
    &lt;p&gt;The following common &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element content
@@ -40884,14 +40972,15 @@
    &lt;code title=attr-input-readonly&gt;&lt;a href=#attr-input-readonly&gt;readonly&lt;/a&gt;&lt;/code&gt;,
    &lt;code title=attr-input-required&gt;&lt;a href=#attr-input-required&gt;required&lt;/a&gt;&lt;/code&gt;, and
    &lt;code title=attr-input-size&gt;&lt;a href=#attr-input-size&gt;size&lt;/a&gt;&lt;/code&gt; content attributes;
-   &lt;code title=dom-input-list&gt;&lt;a href=#dom-input-list&gt;list&lt;/a&gt;&lt;/code&gt;,
-   &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt;,
-   &lt;code title=dom-textarea/input-selectionStart&gt;&lt;a href=#dom-textarea/input-selectionstart&gt;selectionStart&lt;/a&gt;&lt;/code&gt;,
-   &lt;code title=dom-textarea/input-selectionEnd&gt;&lt;a href=#dom-textarea/input-selectionend&gt;selectionEnd&lt;/a&gt;&lt;/code&gt;, and
-   &lt;code title=dom-input-value&gt;&lt;a href=#dom-input-value&gt;value&lt;/a&gt;&lt;/code&gt; IDL attributes;
-   &lt;code title=dom-textarea/input-select&gt;&lt;a href=#dom-textarea/input-select&gt;select()&lt;/a&gt;&lt;/code&gt; and
-   &lt;code title=dom-textarea/input-setSelectionRange&gt;&lt;a href=#dom-textarea/input-setselectionrange&gt;setSelectionRange()&lt;/a&gt;&lt;/code&gt; methods.&lt;/p&gt;
+   &lt;code title=dom-input-list&gt;&lt;a href=#dom-input-list&gt;list&lt;/a&gt;&lt;/code&gt; and
+   &lt;code title=dom-input-value&gt;&lt;a href=#dom-input-value&gt;value&lt;/a&gt;&lt;/code&gt; IDL attributes.&lt;/p&gt;
 
+   &lt;p&gt;The following common &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element content
+   attributes, IDL attributes, and methods apply to the element when
+   the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is
+   not specified:
+   &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt; IDL attribute.&lt;/p&gt;
+
    &lt;p&gt;The &lt;code title=dom-input-value&gt;&lt;a href=#dom-input-value&gt;value&lt;/a&gt;&lt;/code&gt; IDL attribute is
    in mode &lt;a href=#dom-input-value-value title=dom-input-value-value&gt;value&lt;/a&gt;.&lt;/p&gt;
 
@@ -40919,8 +41008,12 @@
    element:
    &lt;code class=no-backref title=dom-input-checked&gt;&lt;a href=#dom-input-checked&gt;checked&lt;/a&gt;&lt;/code&gt;,
    &lt;code class=no-backref title=dom-input-files&gt;&lt;a href=#dom-input-files&gt;files&lt;/a&gt;&lt;/code&gt;,
+   &lt;code class=no-backref title=dom-textarea/input-selectionStart&gt;&lt;a href=#dom-textarea/input-selectionstart&gt;selectionStart&lt;/a&gt;&lt;/code&gt;,
+   &lt;code class=no-backref title=dom-textarea/input-selectionEnd&gt;&lt;a href=#dom-textarea/input-selectionend&gt;selectionEnd&lt;/a&gt;&lt;/code&gt;,
    &lt;code class=no-backref title=dom-input-valueAsDate&gt;&lt;a href=#dom-input-valueasdate&gt;valueAsDate&lt;/a&gt;&lt;/code&gt;, and
    &lt;code class=no-backref title=dom-input-valueAsNumber&gt;&lt;a href=#dom-input-valueasnumber&gt;valueAsNumber&lt;/a&gt;&lt;/code&gt; IDL attributes;
+   &lt;code class=no-backref title=dom-textarea/input-select&gt;&lt;a href=#dom-textarea/input-select&gt;select()&lt;/a&gt;&lt;/code&gt;,
+   &lt;code class=no-backref title=dom-textarea/input-setSelectionRange&gt;&lt;a href=#dom-textarea/input-setselectionrange&gt;setSelectionRange()&lt;/a&gt;&lt;/code&gt;,
    &lt;code class=no-backref title=dom-input-stepDown&gt;&lt;a href=#dom-input-stepdown&gt;stepDown()&lt;/a&gt;&lt;/code&gt; and
    &lt;code class=no-backref title=dom-input-stepUp&gt;&lt;a href=#dom-input-stepup&gt;stepUp()&lt;/a&gt;&lt;/code&gt; methods.&lt;/p&gt;
 
@@ -43472,17 +43565,20 @@
   attribute is used to identify an element that lists predefined
   options suggested to the user.&lt;/p&gt;
 
-  &lt;p&gt;If present, its value must be the &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; of a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt;
-  element in the same document.&lt;/p&gt;
+  &lt;p&gt;If present, its value must be the &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; of a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element in
+  the same document.&lt;/p&gt;
 
   &lt;div class=impl&gt;
 
   &lt;p&gt;The &lt;dfn id=concept-input-list title=concept-input-list&gt;suggestions source
   element&lt;/dfn&gt; is the first element in the document in &lt;a href=#tree-order&gt;tree
-  order&lt;/a&gt; to have an &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; equal to the value of the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute, if that element is a
-  &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element. If there is no &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute, or if there is no
-  element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt;, or if the first element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; is not a
-  &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element, then there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;.&lt;/p&gt;
+  order&lt;/a&gt; to have an &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; equal to
+  the value of the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt;
+  attribute, if that element is a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element. If
+  there is no &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute, or
+  if there is no element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt;,
+  or if the first element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt;
+  is not a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element, then there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;If there is a &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source
   element&lt;/a&gt;, then, when the user agent is allowing the user to
@@ -43490,12 +43586,43 @@
   the suggestions represented by the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt; to the
   user in a manner suitable for the type of control used. The user
   agent may use the suggestion's &lt;a href=#concept-option-label title=concept-option-label&gt;label&lt;/a&gt; to identify the suggestion
-  if appropriate. If the user selects a suggestion, then the
-  &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; must be set to the selected
-  suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, as if
-  the user had written that value himself.&lt;/p&gt;
+  if appropriate.&lt;/p&gt;
 
-  &lt;hr&gt;&lt;p&gt;If the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute does
+  &lt;p&gt;How user selections of suggestions are handled depends on whether
+  the element is a control accepting a single value only, or whether
+  it accepts multiple values:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;If the element does not have a &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute specified or
+   if the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute
+   does not apply&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;When the user selects a suggestion, the &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt;
+    element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; must be set
+    to the selected suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, as if the user had
+    written that value himself.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;If the element &lt;em&gt;does&lt;/em&gt; have a &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute specified,
+   and the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute
+   does apply&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;When the user selects a suggestion, the user agent must either
+    add a new entry to the &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;, whose value is
+    the selected suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, or change an existing
+    entry in the &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; to have the value
+    given by the selected suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, as if the user had
+    himself added an entry with that value, or edited an existing
+    entry to be that value. Which behavior is to be applied depends on
+    the user interface in a user-agent-defined manner.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;hr&gt;&lt;p&gt;If the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute does
   not apply, there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions
   source element&lt;/a&gt;.&lt;/p&gt;
 
@@ -44328,16 +44455,28 @@
   any, or null otherwise.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-input-selectedoption title=dom-input-selectedOption&gt;&lt;code&gt;selectedOption&lt;/code&gt;&lt;/dfn&gt;
-  IDL attribute must return the first &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, in
-  &lt;a href=#tree-order&gt;tree order&lt;/a&gt;, to be a child of the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt; and
-  whose &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt; matches the
-  &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;, if any. If there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;, or if
-  it contains no matching &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, then the &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt; attribute
-  must return null.&lt;/p&gt;
+  IDL attribute must return the value determined by the following
+  steps:&lt;/p&gt;
 
-  &lt;/div&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions
+   source element&lt;/a&gt; (e.g. because the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute doesn't apply or is
+   not specified), then return null and abort thee steps.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+   attribute is specified and applies, then return null and abort
+   these steps. (The &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt; IDL
+   attribute doesn't apply.)&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Return the first &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, in &lt;a href=#tree-order&gt;tree
+   order&lt;/a&gt;, to be a child of the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt; and
+   whose &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt; matches the
+   &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;, if any. If the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;
+   contains no matching &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, then return null
+   instead.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;/div&gt;
+
+
   &lt;div class=impl&gt;
 
   &lt;h5 id=common-event-behaviors&gt;&lt;span class=secno&gt;4.10.7.4 &lt;/span&gt;Common event behaviors&lt;/h5&gt;

Modified: index
===================================================================
--- index	2011-01-05 00:38:49 UTC (rev 5739)
+++ index	2011-01-05 23:42:19 UTC (rev 5740)
@@ -39935,7 +39935,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=yes&gt; Yes&dagger; &lt;!-- E-mail --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Password --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Date --&gt;
@@ -39959,7 +39959,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -39983,7 +39983,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -40007,7 +40007,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -40031,7 +40031,7 @@
      &lt;td class=yes&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=yes&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=no&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=yes&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=no&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -40148,8 +40148,13 @@
      &lt;td class=no&gt; &middot; &lt;!-- Reset Button --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Button --&gt;
 
-  &lt;/table&gt;&lt;div class=impl&gt;
+  &lt;/table&gt;&lt;p class=note&gt;&dagger; The dagger symbol (&dagger;) indicates that
+  the feature only applies when the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is not
+  specified.&lt;/p&gt;
 
+
+  &lt;div class=impl&gt;
+
   &lt;p&gt;Some states of the &lt;code title=attr-input-type&gt;&lt;a href=#attr-input-type&gt;type&lt;/a&gt;&lt;/code&gt;
   attribute define a &lt;dfn id=value-sanitization-algorithm&gt;value sanitization algorithm&lt;/dfn&gt;.&lt;/p&gt;
 
@@ -40779,67 +40784,143 @@
 
   &lt;/div&gt;
 
-  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; a control
-  for editing a list of e-mail addresses given in the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
+  &lt;p&gt;How the &lt;a href=#e-mail-state title=attr-input-type-email&gt;E-mail&lt;/a&gt; state
+  operates depends on whether the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is specified
+  or not.&lt;/p&gt;
 
-  &lt;div class=impl&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+   attribute is not specified on the element&lt;/dt&gt;
 
-  &lt;p&gt;If the element is &lt;i title=concept-input-mutable&gt;&lt;a href=#concept-input-mutable&gt;mutable&lt;/a&gt;&lt;/i&gt;,
-  the user agent should allow the user to change the e-mail addresses
-  represented by its &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. If
-  the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is
-  specified, then the user agent should allow the user to select or
-  provide multiple addresses; otherwise, the user agent should act in
-  a manner consistent with expecting the user to provide a single
-  e-mail address. User agents may allow the user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to a string that is not a
-  &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;. User agents should allow the
-  user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to the
-  empty string. User agents must not allow users to insert U+000A LINE
-  FEED (LF) or U+000D CARRIAGE RETURN (CR) characters into the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. User agents may transform the
-  &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; for display and editing
-  (e.g. converting punycode in the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to IDN in the display and vice
-  versa).&lt;/p&gt;
+   &lt;dd&gt;
 
-  &lt;/div&gt;
+    &lt;p&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; a
+    control for editing an e-mail address given in the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;If the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
-  attribute is specified on the element, then the &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if specified, must
-  have a value that is a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;;
-  otherwise, the &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt;
-  attribute, if specified, must have a value that is a single
-  &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;.&lt;/p&gt;
+    &lt;div class=impl&gt;
 
-  &lt;div class=impl&gt;
+    &lt;p&gt;If the element is &lt;i title=concept-input-mutable&gt;&lt;a href=#concept-input-mutable&gt;mutable&lt;/a&gt;&lt;/i&gt;,
+    the user agent should allow the user to change the e-mail address
+    represented by its &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.
+    User agents may allow the user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to a string that is not a
+    &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;. The user agent should act in a
+    manner consistent with expecting the user to provide a single
+    e-mail address. User agents should allow the user to set the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to the empty string. User
+    agents must not allow users to insert U+000A LINE FEED (LF) or
+    U+000D CARRIAGE RETURN (CR) characters into the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. User agents may transform
+    the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; for display and
+    editing (e.g. converting punycode in the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; to IDN in the display and
+    vice versa).&lt;/p&gt;
 
-  &lt;p&gt;&lt;strong&gt;The &lt;a href=#value-sanitization-algorithm&gt;value sanitization algorithm&lt;/a&gt; is as
-  follows&lt;/strong&gt;: &lt;a href=#strip-line-breaks&gt;Strip line breaks&lt;/a&gt; from the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
+    &lt;/div&gt;
 
-  &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: If the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is specified
-  on the element, then, while the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
-  &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, the element is
-  &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;; otherwise, while the
-  &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
-  single &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;, the element is
-  &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;The &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
+    specified, must have a value that is a single &lt;a href=#valid-e-mail-address&gt;valid e-mail
+    address&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
-  attribute is specified on the element, then, the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; are the result of
-  &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;splitting on commas&lt;/a&gt;
-  the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;. (This is
-  used to define how the &lt;code title=attr-input-pattern&gt;&lt;a href=#attr-input-pattern&gt;pattern&lt;/a&gt;&lt;/code&gt; attribute applies when the
-  &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is
-  specified.)&lt;/p&gt;
+    &lt;div class=impl&gt;
 
-  &lt;/div&gt;
+    &lt;p&gt;&lt;strong&gt;The &lt;a href=#value-sanitization-algorithm&gt;value sanitization algorithm&lt;/a&gt; is as
+    follows&lt;/strong&gt;: &lt;a href=#strip-line-breaks&gt;Strip line breaks&lt;/a&gt; from the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;A &lt;dfn id=valid-e-mail-address-list&gt;valid e-mail address list&lt;/dfn&gt; is a &lt;a href=#set-of-comma-separated-tokens&gt;set of
-  comma-separated tokens&lt;/a&gt;, where each token is itself a
-  &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;. &lt;span class=impl&gt;To obtain the
-  list of tokens from a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, the
-  user agent must &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;split the
-  string on commas&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;
+    &lt;p&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+    attribute is removed, the user agent must run the &lt;a href=#value-sanitization-algorithm&gt;value
+    sanitization algorithm&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;A &lt;dfn id=valid-e-mail-address&gt;valid e-mail address&lt;/dfn&gt; is a string that matches the
+    &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: While the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
+    single &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;, the element is
+    &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+   attribute &lt;em&gt;is&lt;/em&gt; specified on the element&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;div class=impl&gt;
+
+    &lt;p&gt;The element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; are the result of
+    &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;splitting on commas&lt;/a&gt;
+    the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+    &lt;p&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; a
+    control for adding, removing, and editing the e-mail addresses
+    given in the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;div class=impl&gt;
+
+    &lt;p&gt;If the element is &lt;i title=concept-input-mutable&gt;&lt;a href=#concept-input-mutable&gt;mutable&lt;/a&gt;&lt;/i&gt;,
+    the user agent should allow the user to add, remove, and edit the
+    e-mail addresses represented by its &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;. User agents may
+    allow the user to set any individual value in the list of &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; to a string that
+    is not a &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;, but must not allow
+    users to set any individual value to a string containing U+002C
+    COMMA (,), U+000A LINE FEED (LF), or U+000D CARRIAGE RETURN (CR)
+    characters. User agents should allow the user to remove all the
+    addresses in the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;. User agents may
+    transform the &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; for display and
+    editing (e.g. converting punycode in the &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; to IDN in the
+    display and vice versa).&lt;/p&gt;
+
+    &lt;p&gt;Whenever the user changes the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;, the user agent
+    must run the following steps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;latest values&lt;/var&gt; be a copy of the
+     element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;!-- It's a copy because /values/ might include leading and
+     trailing spaces that we don't necessarily want to remove from the
+     UI but that we do want to remove before serialising. --&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;a href=#strip-leading-and-trailing-whitespace&gt;Strip leading and trailing whitespace&lt;/a&gt; from
+     each value in &lt;var title=&quot;&quot;&gt;latest values&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; be the result of
+     concatenating all the values in &lt;var title=&quot;&quot;&gt;latest
+     values&lt;/var&gt;, separating each value from the next by a single
+     U+002C COMMA character (,), maintaining the list's
+     order.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/div&gt;
+
+    &lt;p&gt;The &lt;code title=attr-input-value&gt;&lt;a href=#attr-input-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
+    specified, must have a value that is a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address
+    list&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;div class=impl&gt;
+
+    &lt;p&gt;&lt;strong&gt;The &lt;a href=#value-sanitization-algorithm&gt;value sanitization algorithm&lt;/a&gt; is as
+    follows&lt;/strong&gt;:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;Split on
+     commas&lt;/a&gt; the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;, &lt;a href=#strip-leading-and-trailing-whitespace&gt;strip leading and
+     trailing whitespace&lt;/a&gt; from each resulting token, if any, and
+     let the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; be the (possibly
+     empty) resulting list of (possibly empty) tokens, maintaining the
+     original order.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let the element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; be the result of
+     concatenating the element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;, separating each
+     value from the next by a single U+002C COMMA character (,),
+     maintaining the list's order.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;p&gt;When the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+    attribute is set, the user agent must run the &lt;a href=#value-sanitization-algorithm&gt;value
+    sanitization algorithm&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: While the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the element is not a
+    &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, the element is
+    &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p&gt;A &lt;dfn id=valid-e-mail-address&gt;valid e-mail address&lt;/dfn&gt; is a string that matches the
   ABNF production &lt;code title=&quot;&quot;&gt;1*(&nbsp;atext&nbsp;/&nbsp;&quot;.&quot;&nbsp;)&nbsp;&quot;@&quot;&nbsp;ldh-str&nbsp;1*(&nbsp;&quot;.&quot;&nbsp;ldh-str&nbsp;)&lt;/code&gt;
   where &lt;code title=&quot;&quot;&gt;atext&lt;/code&gt; is defined in RFC 5322 section
   3.2.3, and &lt;code title=&quot;&quot;&gt;ldh-str&lt;/code&gt; is defined in RFC 1034
@@ -40853,6 +40934,13 @@
   space characters, and quoted strings in manners unfamiliar to most
   users) to be of practical use here.&lt;/p&gt;
 
+  &lt;p&gt;A &lt;dfn id=valid-e-mail-address-list&gt;valid e-mail address list&lt;/dfn&gt; is a &lt;a href=#set-of-comma-separated-tokens&gt;set of
+  comma-separated tokens&lt;/a&gt;, where each token is itself a
+  &lt;a href=#valid-e-mail-address&gt;valid e-mail address&lt;/a&gt;. &lt;span class=impl&gt;To obtain the
+  list of tokens from a &lt;a href=#valid-e-mail-address-list&gt;valid e-mail address list&lt;/a&gt;, and
+  implementation must &lt;a href=#split-a-string-on-commas title=&quot;split a string on commas&quot;&gt;split the
+  string on commas&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;
+
   &lt;div class=bookkeeping&gt;
 
    &lt;p&gt;The following common &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element content
@@ -40866,14 +40954,15 @@
    &lt;code title=attr-input-readonly&gt;&lt;a href=#attr-input-readonly&gt;readonly&lt;/a&gt;&lt;/code&gt;,
    &lt;code title=attr-input-required&gt;&lt;a href=#attr-input-required&gt;required&lt;/a&gt;&lt;/code&gt;, and
    &lt;code title=attr-input-size&gt;&lt;a href=#attr-input-size&gt;size&lt;/a&gt;&lt;/code&gt; content attributes;
-   &lt;code title=dom-input-list&gt;&lt;a href=#dom-input-list&gt;list&lt;/a&gt;&lt;/code&gt;,
-   &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt;,
-   &lt;code title=dom-textarea/input-selectionStart&gt;&lt;a href=#dom-textarea/input-selectionstart&gt;selectionStart&lt;/a&gt;&lt;/code&gt;,
-   &lt;code title=dom-textarea/input-selectionEnd&gt;&lt;a href=#dom-textarea/input-selectionend&gt;selectionEnd&lt;/a&gt;&lt;/code&gt;, and
-   &lt;code title=dom-input-value&gt;&lt;a href=#dom-input-value&gt;value&lt;/a&gt;&lt;/code&gt; IDL attributes;
-   &lt;code title=dom-textarea/input-select&gt;&lt;a href=#dom-textarea/input-select&gt;select()&lt;/a&gt;&lt;/code&gt; and
-   &lt;code title=dom-textarea/input-setSelectionRange&gt;&lt;a href=#dom-textarea/input-setselectionrange&gt;setSelectionRange()&lt;/a&gt;&lt;/code&gt; methods.&lt;/p&gt;
+   &lt;code title=dom-input-list&gt;&lt;a href=#dom-input-list&gt;list&lt;/a&gt;&lt;/code&gt; and
+   &lt;code title=dom-input-value&gt;&lt;a href=#dom-input-value&gt;value&lt;/a&gt;&lt;/code&gt; IDL attributes.&lt;/p&gt;
 
+   &lt;p&gt;The following common &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element content
+   attributes, IDL attributes, and methods apply to the element when
+   the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute is
+   not specified:
+   &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt; IDL attribute.&lt;/p&gt;
+
    &lt;p&gt;The &lt;code title=dom-input-value&gt;&lt;a href=#dom-input-value&gt;value&lt;/a&gt;&lt;/code&gt; IDL attribute is
    in mode &lt;a href=#dom-input-value-value title=dom-input-value-value&gt;value&lt;/a&gt;.&lt;/p&gt;
 
@@ -40901,8 +40990,12 @@
    element:
    &lt;code class=no-backref title=dom-input-checked&gt;&lt;a href=#dom-input-checked&gt;checked&lt;/a&gt;&lt;/code&gt;,
    &lt;code class=no-backref title=dom-input-files&gt;&lt;a href=#dom-input-files&gt;files&lt;/a&gt;&lt;/code&gt;,
+   &lt;code class=no-backref title=dom-textarea/input-selectionStart&gt;&lt;a href=#dom-textarea/input-selectionstart&gt;selectionStart&lt;/a&gt;&lt;/code&gt;,
+   &lt;code class=no-backref title=dom-textarea/input-selectionEnd&gt;&lt;a href=#dom-textarea/input-selectionend&gt;selectionEnd&lt;/a&gt;&lt;/code&gt;,
    &lt;code class=no-backref title=dom-input-valueAsDate&gt;&lt;a href=#dom-input-valueasdate&gt;valueAsDate&lt;/a&gt;&lt;/code&gt;, and
    &lt;code class=no-backref title=dom-input-valueAsNumber&gt;&lt;a href=#dom-input-valueasnumber&gt;valueAsNumber&lt;/a&gt;&lt;/code&gt; IDL attributes;
+   &lt;code class=no-backref title=dom-textarea/input-select&gt;&lt;a href=#dom-textarea/input-select&gt;select()&lt;/a&gt;&lt;/code&gt;,
+   &lt;code class=no-backref title=dom-textarea/input-setSelectionRange&gt;&lt;a href=#dom-textarea/input-setselectionrange&gt;setSelectionRange()&lt;/a&gt;&lt;/code&gt;,
    &lt;code class=no-backref title=dom-input-stepDown&gt;&lt;a href=#dom-input-stepdown&gt;stepDown()&lt;/a&gt;&lt;/code&gt; and
    &lt;code class=no-backref title=dom-input-stepUp&gt;&lt;a href=#dom-input-stepup&gt;stepUp()&lt;/a&gt;&lt;/code&gt; methods.&lt;/p&gt;
 
@@ -43454,17 +43547,20 @@
   attribute is used to identify an element that lists predefined
   options suggested to the user.&lt;/p&gt;
 
-  &lt;p&gt;If present, its value must be the &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; of a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt;
-  element in the same document.&lt;/p&gt;
+  &lt;p&gt;If present, its value must be the &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; of a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element in
+  the same document.&lt;/p&gt;
 
   &lt;div class=impl&gt;
 
   &lt;p&gt;The &lt;dfn id=concept-input-list title=concept-input-list&gt;suggestions source
   element&lt;/dfn&gt; is the first element in the document in &lt;a href=#tree-order&gt;tree
-  order&lt;/a&gt; to have an &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; equal to the value of the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute, if that element is a
-  &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element. If there is no &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute, or if there is no
-  element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt;, or if the first element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; is not a
-  &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element, then there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;.&lt;/p&gt;
+  order&lt;/a&gt; to have an &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt; equal to
+  the value of the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt;
+  attribute, if that element is a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element. If
+  there is no &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute, or
+  if there is no element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt;,
+  or if the first element with that &lt;a href=#concept-id title=concept-id&gt;ID&lt;/a&gt;
+  is not a &lt;code&gt;&lt;a href=#the-datalist-element&gt;datalist&lt;/a&gt;&lt;/code&gt; element, then there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;If there is a &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source
   element&lt;/a&gt;, then, when the user agent is allowing the user to
@@ -43472,12 +43568,43 @@
   the suggestions represented by the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt; to the
   user in a manner suitable for the type of control used. The user
   agent may use the suggestion's &lt;a href=#concept-option-label title=concept-option-label&gt;label&lt;/a&gt; to identify the suggestion
-  if appropriate. If the user selects a suggestion, then the
-  &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; must be set to the selected
-  suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, as if
-  the user had written that value himself.&lt;/p&gt;
+  if appropriate.&lt;/p&gt;
 
-  &lt;hr&gt;&lt;p&gt;If the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute does
+  &lt;p&gt;How user selections of suggestions are handled depends on whether
+  the element is a control accepting a single value only, or whether
+  it accepts multiple values:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;If the element does not have a &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute specified or
+   if the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute
+   does not apply&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;When the user selects a suggestion, the &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt;
+    element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; must be set
+    to the selected suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, as if the user had
+    written that value himself.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;If the element &lt;em&gt;does&lt;/em&gt; have a &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute specified,
+   and the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt; attribute
+   does apply&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;When the user selects a suggestion, the user agent must either
+    add a new entry to the &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt;, whose value is
+    the selected suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, or change an existing
+    entry in the &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-values title=concept-fe-values&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/a&gt; to have the value
+    given by the selected suggestion's &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt;, as if the user had
+    himself added an entry with that value, or edited an existing
+    entry to be that value. Which behavior is to be applied depends on
+    the user interface in a user-agent-defined manner.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;hr&gt;&lt;p&gt;If the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute does
   not apply, there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions
   source element&lt;/a&gt;.&lt;/p&gt;
 
@@ -44310,16 +44437,28 @@
   any, or null otherwise.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-input-selectedoption title=dom-input-selectedOption&gt;&lt;code&gt;selectedOption&lt;/code&gt;&lt;/dfn&gt;
-  IDL attribute must return the first &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, in
-  &lt;a href=#tree-order&gt;tree order&lt;/a&gt;, to be a child of the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt; and
-  whose &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt; matches the
-  &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;, if any. If there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;, or if
-  it contains no matching &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, then the &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt; attribute
-  must return null.&lt;/p&gt;
+  IDL attribute must return the value determined by the following
+  steps:&lt;/p&gt;
 
-  &lt;/div&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If there is no &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions
+   source element&lt;/a&gt; (e.g. because the &lt;code title=attr-input-list&gt;&lt;a href=#attr-input-list&gt;list&lt;/a&gt;&lt;/code&gt; attribute doesn't apply or is
+   not specified), then return null and abort thee steps.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If the &lt;code title=attr-input-multiple&gt;&lt;a href=#attr-input-multiple&gt;multiple&lt;/a&gt;&lt;/code&gt;
+   attribute is specified and applies, then return null and abort
+   these steps. (The &lt;code title=dom-input-selectedOption&gt;&lt;a href=#dom-input-selectedoption&gt;selectedOption&lt;/a&gt;&lt;/code&gt; IDL
+   attribute doesn't apply.)&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Return the first &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, in &lt;a href=#tree-order&gt;tree
+   order&lt;/a&gt;, to be a child of the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt; and
+   whose &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt; matches the
+   &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt;, if any. If the &lt;a href=#concept-input-list title=concept-input-list&gt;suggestions source element&lt;/a&gt;
+   contains no matching &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element, then return null
+   instead.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;/div&gt;
+
+
   &lt;div class=impl&gt;
 
   &lt;h5 id=common-event-behaviors&gt;&lt;span class=secno&gt;4.10.7.4 &lt;/span&gt;Common event behaviors&lt;/h5&gt;

Modified: source
===================================================================
--- source	2011-01-05 00:38:49 UTC (rev 5739)
+++ source	2011-01-05 23:42:19 UTC (rev 5740)
@@ -44496,7 +44496,7 @@
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=&quot;yes&quot;&gt; Yes&dagger; &lt;!-- E-mail --&gt;
      &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- Password --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Date --&gt;
@@ -44521,7 +44521,7 @@
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -44546,7 +44546,7 @@
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -44571,7 +44571,7 @@
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -44596,7 +44596,7 @@
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Text --&gt;
 &lt;!-- &lt;td class=&quot;yes&quot;&gt; Yes          Search --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- URL, Telephone --&gt;
-     &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- E-mail --&gt;
+     &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- E-mail --&gt;
      &lt;td class=&quot;yes&quot;&gt; Yes     &lt;!-- Password --&gt;
      &lt;td class=&quot;no&quot;&gt; &middot; &lt;!-- Date and Time --&gt;
 &lt;!-- &lt;td class=&quot;no&quot;&gt; &middot;      Date --&gt;
@@ -44721,6 +44721,12 @@
 
   &lt;/table&gt;
 
+  &lt;p class=&quot;note&quot;&gt;&dagger; The dagger symbol (&dagger;) indicates that
+  the feature only applies when the &lt;code
+  title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute is not
+  specified.&lt;/p&gt;
+
+
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;p&gt;Some states of the &lt;code title=&quot;attr-input-type&quot;&gt;type&lt;/code&gt;
@@ -45491,76 +45497,177 @@
 
   &lt;/div&gt;
 
-  &lt;p&gt;The &lt;code&gt;input&lt;/code&gt; element &lt;span&gt;represents&lt;/span&gt; a control
-  for editing a list of e-mail addresses given in the element's &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;.&lt;/p&gt;
+  &lt;p&gt;How the &lt;span title=&quot;attr-input-type-email&quot;&gt;E-mail&lt;/span&gt; state
+  operates depends on whether the &lt;code
+  title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute is specified
+  or not.&lt;/p&gt;
 
-  &lt;div class=&quot;impl&quot;&gt;
+  &lt;dl class=&quot;switch&quot;&gt;
 
-  &lt;p&gt;If the element is &lt;i title=&quot;concept-input-mutable&quot;&gt;mutable&lt;/i&gt;,
-  the user agent should allow the user to change the e-mail addresses
-  represented by its &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;. If
-  the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute is
-  specified, then the user agent should allow the user to select or
-  provide multiple addresses; otherwise, the user agent should act in
-  a manner consistent with expecting the user to provide a single
-  e-mail address. User agents may allow the user to set the &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; to a string that is not a
-  &lt;span&gt;valid e-mail address list&lt;/span&gt;. User agents should allow the
-  user to set the &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; to the
-  empty string. User agents must not allow users to insert U+000A LINE
-  FEED (LF) or U+000D CARRIAGE RETURN (CR) characters into the &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;. User agents may transform the
-  &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; for display and editing
-  (e.g. converting punycode in the &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; to IDN in the display and vice
-  versa).&lt;/p&gt;
+   &lt;dt&gt;When the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt;
+   attribute is not specified on the element&lt;/dt&gt;
 
-  &lt;/div&gt;
+   &lt;dd&gt;
 
-  &lt;p&gt;If the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt;
-  attribute is specified on the element, then the &lt;code
-  title=&quot;attr-input-value&quot;&gt;value&lt;/code&gt; attribute, if specified, must
-  have a value that is a &lt;span&gt;valid e-mail address list&lt;/span&gt;;
-  otherwise, the &lt;code title=&quot;attr-input-value&quot;&gt;value&lt;/code&gt;
-  attribute, if specified, must have a value that is a single
-  &lt;span&gt;valid e-mail address&lt;/span&gt;.&lt;/p&gt;
+    &lt;p&gt;The &lt;code&gt;input&lt;/code&gt; element &lt;span&gt;represents&lt;/span&gt; a
+    control for editing an e-mail address given in the element's &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;div class=&quot;impl&quot;&gt;
+    &lt;div class=&quot;impl&quot;&gt;
 
-  &lt;p&gt;&lt;strong&gt;The &lt;span&gt;value sanitization algorithm&lt;/span&gt; is as
-  follows&lt;/strong&gt;: &lt;span&gt;Strip line breaks&lt;/span&gt; from the &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;.&lt;/p&gt;
+    &lt;p&gt;If the element is &lt;i title=&quot;concept-input-mutable&quot;&gt;mutable&lt;/i&gt;,
+    the user agent should allow the user to change the e-mail address
+    represented by its &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;.
+    User agents may allow the user to set the &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; to a string that is not a
+    &lt;span&gt;valid e-mail address&lt;/span&gt;. The user agent should act in a
+    manner consistent with expecting the user to provide a single
+    e-mail address. User agents should allow the user to set the &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; to the empty string. User
+    agents must not allow users to insert U+000A LINE FEED (LF) or
+    U+000D CARRIAGE RETURN (CR) characters into the &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;. User agents may transform
+    the &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; for display and
+    editing (e.g. converting punycode in the &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; to IDN in the display and
+    vice versa).&lt;/p&gt;
 
-  &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: If the &lt;code
-  title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute is specified
-  on the element, then, while the &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; of the element is not a
-  &lt;span&gt;valid e-mail address list&lt;/span&gt;, the element is
-  &lt;span&gt;suffering from a type mismatch&lt;/span&gt;; otherwise, while the
-  &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; of the element is not a
-  single &lt;span&gt;valid e-mail address&lt;/span&gt;, the element is
-  &lt;span&gt;suffering from a type mismatch&lt;/span&gt;.&lt;/p&gt;
+    &lt;/div&gt;
 
-  &lt;p&gt;When the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt;
-  attribute is specified on the element, then, the element's &lt;span
-  title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt; are the result of
-  &lt;span title=&quot;split a string on commas&quot;&gt;splitting on commas&lt;/span&gt;
-  the element's &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;. (This is
-  used to define how the &lt;code
-  title=&quot;attr-input-pattern&quot;&gt;pattern&lt;/code&gt; attribute applies when the
-  &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute is
-  specified.)&lt;/p&gt;
+    &lt;p&gt;The &lt;code title=&quot;attr-input-value&quot;&gt;value&lt;/code&gt; attribute, if
+    specified, must have a value that is a single &lt;span&gt;valid e-mail
+    address&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;/div&gt;
+    &lt;div class=&quot;impl&quot;&gt;
 
-  &lt;p&gt;A &lt;dfn&gt;valid e-mail address list&lt;/dfn&gt; is a &lt;span&gt;set of
-  comma-separated tokens&lt;/span&gt;, where each token is itself a
-  &lt;span&gt;valid e-mail address&lt;/span&gt;. &lt;span class=&quot;impl&quot;&gt;To obtain the
-  list of tokens from a &lt;span&gt;valid e-mail address list&lt;/span&gt;, the
-  user agent must &lt;span title=&quot;split a string on commas&quot;&gt;split the
-  string on commas&lt;/span&gt;.&lt;/span&gt;&lt;/p&gt;
+    &lt;p&gt;&lt;strong&gt;The &lt;span&gt;value sanitization algorithm&lt;/span&gt; is as
+    follows&lt;/strong&gt;: &lt;span&gt;Strip line breaks&lt;/span&gt; from the &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;.&lt;/p&gt;
 
+    &lt;p&gt;When the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt;
+    attribute is removed, the user agent must run the &lt;span&gt;value
+    sanitization algorithm&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: While the &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; of the element is not a
+    single &lt;span&gt;valid e-mail address&lt;/span&gt;, the element is
+    &lt;span&gt;suffering from a type mismatch&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;When the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt;
+   attribute &lt;em&gt;is&lt;/em&gt; specified on the element&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;div class=&quot;impl&quot;&gt;
+
+    &lt;p&gt;The element's &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt; are the result of
+    &lt;span title=&quot;split a string on commas&quot;&gt;splitting on commas&lt;/span&gt;
+    the element's &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+    &lt;p&gt;The &lt;code&gt;input&lt;/code&gt; element &lt;span&gt;represents&lt;/span&gt; a
+    control for adding, removing, and editing the e-mail addresses
+    given in the element's &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;div class=&quot;impl&quot;&gt;
+
+    &lt;p&gt;If the element is &lt;i title=&quot;concept-input-mutable&quot;&gt;mutable&lt;/i&gt;,
+    the user agent should allow the user to add, remove, and edit the
+    e-mail addresses represented by its &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt;. User agents may
+    allow the user to set any individual value in the list of &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt; to a string that
+    is not a &lt;span&gt;valid e-mail address&lt;/span&gt;, but must not allow
+    users to set any individual value to a string containing U+002C
+    COMMA (,), U+000A LINE FEED (LF), or U+000D CARRIAGE RETURN (CR)
+    characters. User agents should allow the user to remove all the
+    addresses in the element's &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt;. User agents may
+    transform the &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt; for display and
+    editing (e.g. converting punycode in the &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt; to IDN in the
+    display and vice versa).&lt;/p&gt;
+
+    &lt;p&gt;Whenever the user changes the element's &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt;, the user agent
+    must run the following steps:&lt;/p&gt;
+
+    &lt;ol&gt;
+
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;latest values&lt;/var&gt; be a copy of the
+     element's &lt;span
+     title=&quot;concept-fe-value&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;!-- It's a copy because /values/ might include leading and
+     trailing spaces that we don't necessarily want to remove from the
+     UI but that we do want to remove before serialising. --&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;span&gt;Strip leading and trailing whitespace&lt;/span&gt; from
+     each value in &lt;var title=&quot;&quot;&gt;latest values&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let the element's &lt;span
+     title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; be the result of
+     concatenating all the values in &lt;var title=&quot;&quot;&gt;latest
+     values&lt;/var&gt;, separating each value from the next by a single
+     U+002C COMMA character (,), maintaining the list's
+     order.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;
+
+    &lt;/div&gt;
+
+    &lt;p&gt;The &lt;code title=&quot;attr-input-value&quot;&gt;value&lt;/code&gt; attribute, if
+    specified, must have a value that is a &lt;span&gt;valid e-mail address
+    list&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;div class=&quot;impl&quot;&gt;
+
+    &lt;p&gt;&lt;strong&gt;The &lt;span&gt;value sanitization algorithm&lt;/span&gt; is as
+    follows&lt;/strong&gt;:&lt;/p&gt;
+
+    &lt;ol&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;span title=&quot;split a string on commas&quot;&gt;Split on
+     commas&lt;/span&gt; the element's &lt;span
+     title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;, &lt;span&gt;strip leading and
+     trailing whitespace&lt;/span&gt; from each resulting token, if any, and
+     let the element's &lt;span
+     title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt; be the (possibly
+     empty) resulting list of (possibly empty) tokens, maintaining the
+     original order.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let the element's &lt;span
+     title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; be the result of
+     concatenating the element's &lt;span
+     title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt;, separating each
+     value from the next by a single U+002C COMMA character (,),
+     maintaining the list's order.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;
+
+    &lt;p&gt;When the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt;
+    attribute is set, the user agent must run the &lt;span&gt;value
+    sanitization algorithm&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;p&gt;&lt;strong&gt;Constraint validation&lt;/strong&gt;: While the &lt;span
+    title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; of the element is not a
+    &lt;span&gt;valid e-mail address list&lt;/span&gt;, the element is
+    &lt;span&gt;suffering from a type mismatch&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;/div&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;
+
   &lt;p&gt;A &lt;dfn&gt;valid e-mail address&lt;/dfn&gt; is a string that matches the
   ABNF production &lt;code
   title=&quot;&quot;&gt;1*(&nbsp;atext&nbsp;/&nbsp;&quot;.&quot;&nbsp;)&nbsp;&quot;@&quot;&nbsp;ldh-str&nbsp;1*(&nbsp;&quot;.&quot;&nbsp;ldh-str&nbsp;)&lt;/code&gt;
@@ -45578,6 +45685,13 @@
   space characters, and quoted strings in manners unfamiliar to most
   users) to be of practical use here.&lt;/p&gt;
 
+  &lt;p&gt;A &lt;dfn&gt;valid e-mail address list&lt;/dfn&gt; is a &lt;span&gt;set of
+  comma-separated tokens&lt;/span&gt;, where each token is itself a
+  &lt;span&gt;valid e-mail address&lt;/span&gt;. &lt;span class=&quot;impl&quot;&gt;To obtain the
+  list of tokens from a &lt;span&gt;valid e-mail address list&lt;/span&gt;, and
+  implementation must &lt;span title=&quot;split a string on commas&quot;&gt;split the
+  string on commas&lt;/span&gt;.&lt;/span&gt;&lt;/p&gt;
+
   &lt;div class=&quot;bookkeeping&quot;&gt;
 
    &lt;p&gt;The following common &lt;code&gt;input&lt;/code&gt; element content
@@ -45591,14 +45705,15 @@
    &lt;code title=&quot;attr-input-readonly&quot;&gt;readonly&lt;/code&gt;,
    &lt;code title=&quot;attr-input-required&quot;&gt;required&lt;/code&gt;, and
    &lt;code title=&quot;attr-input-size&quot;&gt;size&lt;/code&gt; content attributes;
-   &lt;code title=&quot;dom-input-list&quot;&gt;list&lt;/code&gt;,
-   &lt;code title=&quot;dom-input-selectedOption&quot;&gt;selectedOption&lt;/code&gt;,
-   &lt;code title=&quot;dom-textarea/input-selectionStart&quot;&gt;selectionStart&lt;/code&gt;,
-   &lt;code title=&quot;dom-textarea/input-selectionEnd&quot;&gt;selectionEnd&lt;/code&gt;, and
-   &lt;code title=&quot;dom-input-value&quot;&gt;value&lt;/code&gt; IDL attributes;
-   &lt;code title=&quot;dom-textarea/input-select&quot;&gt;select()&lt;/code&gt; and
-   &lt;code title=&quot;dom-textarea/input-setSelectionRange&quot;&gt;setSelectionRange()&lt;/code&gt; methods.&lt;/p&gt;
+   &lt;code title=&quot;dom-input-list&quot;&gt;list&lt;/code&gt; and
+   &lt;code title=&quot;dom-input-value&quot;&gt;value&lt;/code&gt; IDL attributes.&lt;/p&gt;
 
+   &lt;p&gt;The following common &lt;code&gt;input&lt;/code&gt; element content
+   attributes, IDL attributes, and methods apply to the element when
+   the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute is
+   not specified:
+   &lt;code title=&quot;dom-input-selectedOption&quot;&gt;selectedOption&lt;/code&gt; IDL attribute.&lt;/p&gt;
+
    &lt;p&gt;The &lt;code title=&quot;dom-input-value&quot;&gt;value&lt;/code&gt; IDL attribute is
    in mode &lt;span title=&quot;dom-input-value-value&quot;&gt;value&lt;/span&gt;.&lt;/p&gt;
 
@@ -45627,8 +45742,12 @@
    element:
    &lt;code class=&quot;no-backref&quot; title=&quot;dom-input-checked&quot;&gt;checked&lt;/code&gt;,
    &lt;code class=&quot;no-backref&quot; title=&quot;dom-input-files&quot;&gt;files&lt;/code&gt;,
+   &lt;code class=&quot;no-backref&quot; title=&quot;dom-textarea/input-selectionStart&quot;&gt;selectionStart&lt;/code&gt;,
+   &lt;code class=&quot;no-backref&quot; title=&quot;dom-textarea/input-selectionEnd&quot;&gt;selectionEnd&lt;/code&gt;,
    &lt;code class=&quot;no-backref&quot; title=&quot;dom-input-valueAsDate&quot;&gt;valueAsDate&lt;/code&gt;, and
    &lt;code class=&quot;no-backref&quot; title=&quot;dom-input-valueAsNumber&quot;&gt;valueAsNumber&lt;/code&gt; IDL attributes;
+   &lt;code class=&quot;no-backref&quot; title=&quot;dom-textarea/input-select&quot;&gt;select()&lt;/code&gt;,
+   &lt;code class=&quot;no-backref&quot; title=&quot;dom-textarea/input-setSelectionRange&quot;&gt;setSelectionRange()&lt;/code&gt;,
    &lt;code class=&quot;no-backref&quot; title=&quot;dom-input-stepDown&quot;&gt;stepDown()&lt;/code&gt; and
    &lt;code class=&quot;no-backref&quot; title=&quot;dom-input-stepUp&quot;&gt;stepUp()&lt;/code&gt; methods.&lt;/p&gt;
 
@@ -48521,19 +48640,21 @@
   attribute is used to identify an element that lists predefined
   options suggested to the user.&lt;/p&gt;
 
-  &lt;p&gt;If present, its value must be the &lt;span title=&quot;concept-id&quot;&gt;ID&lt;/span&gt; of a &lt;code&gt;datalist&lt;/code&gt;
-  element in the same document.&lt;/p&gt;
+  &lt;p&gt;If present, its value must be the &lt;span
+  title=&quot;concept-id&quot;&gt;ID&lt;/span&gt; of a &lt;code&gt;datalist&lt;/code&gt; element in
+  the same document.&lt;/p&gt;
 
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;concept-input-list&quot;&gt;suggestions source
   element&lt;/dfn&gt; is the first element in the document in &lt;span&gt;tree
-  order&lt;/span&gt; to have an &lt;span title=&quot;concept-id&quot;&gt;ID&lt;/span&gt; equal to the value of the &lt;code
-  title=&quot;attr-input-list&quot;&gt;list&lt;/code&gt; attribute, if that element is a
-  &lt;code&gt;datalist&lt;/code&gt; element. If there is no &lt;code
-  title=&quot;attr-input-list&quot;&gt;list&lt;/code&gt; attribute, or if there is no
-  element with that &lt;span title=&quot;concept-id&quot;&gt;ID&lt;/span&gt;, or if the first element with that &lt;span title=&quot;concept-id&quot;&gt;ID&lt;/span&gt; is not a
-  &lt;code&gt;datalist&lt;/code&gt; element, then there is no &lt;span
+  order&lt;/span&gt; to have an &lt;span title=&quot;concept-id&quot;&gt;ID&lt;/span&gt; equal to
+  the value of the &lt;code title=&quot;attr-input-list&quot;&gt;list&lt;/code&gt;
+  attribute, if that element is a &lt;code&gt;datalist&lt;/code&gt; element. If
+  there is no &lt;code title=&quot;attr-input-list&quot;&gt;list&lt;/code&gt; attribute, or
+  if there is no element with that &lt;span title=&quot;concept-id&quot;&gt;ID&lt;/span&gt;,
+  or if the first element with that &lt;span title=&quot;concept-id&quot;&gt;ID&lt;/span&gt;
+  is not a &lt;code&gt;datalist&lt;/code&gt; element, then there is no &lt;span
   title=&quot;concept-input-list&quot;&gt;suggestions source element&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;If there is a &lt;span title=&quot;concept-input-list&quot;&gt;suggestions source
@@ -48545,12 +48666,53 @@
   user in a manner suitable for the type of control used. The user
   agent may use the suggestion's &lt;span
   title=&quot;concept-option-label&quot;&gt;label&lt;/span&gt; to identify the suggestion
-  if appropriate. If the user selects a suggestion, then the
-  &lt;code&gt;input&lt;/code&gt; element's &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; must be set to the selected
-  suggestion's &lt;span title=&quot;concept-option-value&quot;&gt;value&lt;/span&gt;, as if
-  the user had written that value himself.&lt;/p&gt;
+  if appropriate.&lt;/p&gt;
 
+  &lt;p&gt;How user selections of suggestions are handled depends on whether
+  the element is a control accepting a single value only, or whether
+  it accepts multiple values:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;If the element does not have a &lt;code
+   title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute specified or
+   if the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute
+   does not apply&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;When the user selects a suggestion, the &lt;code&gt;input&lt;/code&gt;
+    element's &lt;span title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; must be set
+    to the selected suggestion's &lt;span
+    title=&quot;concept-option-value&quot;&gt;value&lt;/span&gt;, as if the user had
+    written that value himself.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;If the element &lt;em&gt;does&lt;/em&gt; have a &lt;code
+   title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute specified,
+   and the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt; attribute
+   does apply&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;When the user selects a suggestion, the user agent must either
+    add a new entry to the &lt;code&gt;input&lt;/code&gt; element's &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt;, whose value is
+    the selected suggestion's &lt;span
+    title=&quot;concept-option-value&quot;&gt;value&lt;/span&gt;, or change an existing
+    entry in the &lt;code&gt;input&lt;/code&gt; element's &lt;span
+    title=&quot;concept-fe-values&quot;&gt;value&lt;em&gt;s&lt;/em&gt;&lt;/span&gt; to have the value
+    given by the selected suggestion's &lt;span
+    title=&quot;concept-option-value&quot;&gt;value&lt;/span&gt;, as if the user had
+    himself added an entry with that value, or edited an existing
+    entry to be that value. Which behavior is to be applied depends on
+    the user interface in a user-agent-defined manner.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;
+
   &lt;hr&gt;
 
   &lt;p&gt;If the &lt;code title=&quot;attr-input-list&quot;&gt;list&lt;/code&gt; attribute does
@@ -49545,17 +49707,34 @@
 
   &lt;p&gt;The &lt;dfn
   title=&quot;dom-input-selectedOption&quot;&gt;&lt;code&gt;selectedOption&lt;/code&gt;&lt;/dfn&gt;
-  IDL attribute must return the first &lt;code&gt;option&lt;/code&gt; element, in
-  &lt;span&gt;tree order&lt;/span&gt;, to be a child of the &lt;span
-  title=&quot;concept-input-list&quot;&gt;suggestions source element&lt;/span&gt; and
-  whose &lt;span title=&quot;concept-option-value&quot;&gt;value&lt;/span&gt; matches the
-  &lt;code&gt;input&lt;/code&gt; element's &lt;span
-  title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;, if any. If there is no &lt;span
-  title=&quot;concept-input-list&quot;&gt;suggestions source element&lt;/span&gt;, or if
-  it contains no matching &lt;code&gt;option&lt;/code&gt; element, then the &lt;code
-  title=&quot;dom-input-selectedOption&quot;&gt;selectedOption&lt;/code&gt; attribute
-  must return null.&lt;/p&gt;
+  IDL attribute must return the value determined by the following
+  steps:&lt;/p&gt;
 
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;If there is no &lt;span title=&quot;concept-input-list&quot;&gt;suggestions
+   source element&lt;/span&gt; (e.g. because the &lt;code
+   title=&quot;attr-input-list&quot;&gt;list&lt;/code&gt; attribute doesn't apply or is
+   not specified), then return null and abort thee steps.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the &lt;code title=&quot;attr-input-multiple&quot;&gt;multiple&lt;/code&gt;
+   attribute is specified and applies, then return null and abort
+   these steps. (The &lt;code
+   title=&quot;dom-input-selectedOption&quot;&gt;selectedOption&lt;/code&gt; IDL
+   attribute doesn't apply.)&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return the first &lt;code&gt;option&lt;/code&gt; element, in &lt;span&gt;tree
+   order&lt;/span&gt;, to be a child of the &lt;span
+   title=&quot;concept-input-list&quot;&gt;suggestions source element&lt;/span&gt; and
+   whose &lt;span title=&quot;concept-option-value&quot;&gt;value&lt;/span&gt; matches the
+   &lt;code&gt;input&lt;/code&gt; element's &lt;span
+   title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt;, if any. If the &lt;span
+   title=&quot;concept-input-list&quot;&gt;suggestions source element&lt;/span&gt;
+   contains no matching &lt;code&gt;option&lt;/code&gt; element, then return null
+   instead.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
   &lt;/div&gt;
 
 


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012606.html">[html5] r5739 - [] (0) Clarify whether the APIs for the text field	selections operate on the 'va [...]
</A></li>
	<LI>Next message: <A HREF="012608.html">[html5] r5741 - [e] (0) update spec subheading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12607">[ date ]</a>
              <a href="thread.html#12607">[ thread ]</a>
              <a href="subject.html#12607">[ subject ]</a>
              <a href="author.html#12607">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
