<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r5814 - [agiow] (1) Specify window.atob() and .btoa(). (ack	Aryeh for the reverse-engine [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5814%20-%20%5Bagiow%5D%20%281%29%20Specify%20window.atob%28%29%20and%20.btoa%28%29.%20%28ack%0A%09Aryeh%20for%20the%20reverse-engine%20%5B...%5D&In-Reply-To=%3C20110201081831.AE6E78058228%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012680.html">
   <LINK REL="Next"  HREF="012682.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r5814 - [agiow] (1) Specify window.atob() and .btoa(). (ack	Aryeh for the reverse-engine [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5814%20-%20%5Bagiow%5D%20%281%29%20Specify%20window.atob%28%29%20and%20.btoa%28%29.%20%28ack%0A%09Aryeh%20for%20the%20reverse-engine%20%5B...%5D&In-Reply-To=%3C20110201081831.AE6E78058228%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r5814 - [agiow] (1) Specify window.atob() and .btoa(). (ack	Aryeh for the reverse-engine [...]">whatwg at whatwg.org
       </A><BR>
    <I>Tue Feb  1 00:18:30 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012680.html">[html5] r5813 - [e] (0) clarify that pages with a manifest=''	always get served from their cache [...]
</A></li>
        <LI>Next message: <A HREF="012682.html">[html5] r5815 - [e] (0) move note out of impl section
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12681">[ date ]</a>
              <a href="thread.html#12681">[ thread ]</a>
              <a href="subject.html#12681">[ subject ]</a>
              <a href="author.html#12681">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2011-02-01 00:18:29 -0800 (Tue, 01 Feb 2011)
New Revision: 5814

Modified:
   complete.html
   index
   source
Log:
[agiow] (1) Specify window.atob() and .btoa(). (ack Aryeh for the reverse-engineering to do this)

Modified: complete.html
===================================================================
--- complete.html	2011-02-01 01:30:07 UTC (rev 5813)
+++ complete.html	2011-02-01 08:18:29 UTC (rev 5814)
@@ -157,6 +157,24 @@
 
    .details-example img { vertical-align: top; }
 
+   #base64-table {
+     white-space: nowrap;
+     font-size: 0.6em;
+     column-width: 6em;
+     column-count: 5;
+     column-gap: 1em;
+     -moz-column-width: 6em;
+     -moz-column-count: 5;
+     -moz-column-gap: 1em;
+     -webkit-column-width: 6em;
+     -webkit-column-count: 5;
+     -webkit-column-gap: 1em;
+   }
+   #base64-table thead { display: none; }
+   #base64-table * { border: none; }
+   #base64-table tbody td:first-child:after { content: ':'; }
+   #base64-table tbody td:last-child { text-align: right; }
+
    #named-character-references-table {
      white-space: nowrap;
      font-size: 0.6em;
@@ -935,20 +953,21 @@
        &lt;li&gt;&lt;a href=#event-firing&gt;&lt;span class=secno&gt;7.1.6.3 &lt;/span&gt;Event firing&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#events-and-the-window-object&gt;&lt;span class=secno&gt;7.1.6.4 &lt;/span&gt;Events and the &lt;code&gt;Window&lt;/code&gt; object&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#runtime-script-errors&gt;&lt;span class=secno&gt;7.1.6.5 &lt;/span&gt;Runtime script errors&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
-   &lt;li&gt;&lt;a href=#timers&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Timers&lt;/a&gt;&lt;/li&gt;
-   &lt;li&gt;&lt;a href=#user-prompts&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;User prompts&lt;/a&gt;
+   &lt;li&gt;&lt;a href=#atob&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Base64 utility methods&lt;/a&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#timers&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;Timers&lt;/a&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#user-prompts&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;User prompts&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#simple-dialogs&gt;&lt;span class=secno&gt;7.3.1 &lt;/span&gt;Simple dialogs&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#printing&gt;&lt;span class=secno&gt;7.3.2 &lt;/span&gt;Printing&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.3.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-   &lt;li&gt;&lt;a href=#system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;System state and capabilities: the &lt;code&gt;Navigator&lt;/code&gt; object&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#simple-dialogs&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Simple dialogs&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#printing&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Printing&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.5 &lt;/span&gt;System state and capabilities: the &lt;code&gt;Navigator&lt;/code&gt; object&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#client-identification&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Client identification&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#custom-handlers&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Custom scheme and content handlers&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#client-identification&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Client identification&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#custom-handlers&gt;&lt;span class=secno&gt;7.5.2 &lt;/span&gt;Custom scheme and content handlers&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#security-and-privacy&gt;&lt;span class=secno&gt;7.4.2.1 &lt;/span&gt;Security and privacy&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#sample-handler-impl&gt;&lt;span class=secno&gt;7.4.2.2 &lt;/span&gt;Sample user interface&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#security-and-privacy&gt;&lt;span class=secno&gt;7.5.2.1 &lt;/span&gt;Security and privacy&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#sample-handler-impl&gt;&lt;span class=secno&gt;7.5.2.2 &lt;/span&gt;Sample user interface&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.5.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=#editing&gt;&lt;span class=secno&gt;8 &lt;/span&gt;User interaction&lt;/a&gt;
   &lt;ol&gt;
    &lt;li&gt;&lt;a href=#the-hidden-attribute&gt;&lt;span class=secno&gt;8.1 &lt;/span&gt;The &lt;code&gt;hidden&lt;/code&gt; attribute&lt;/a&gt;&lt;/li&gt;
@@ -3322,6 +3341,11 @@
     is passed an Infinity or Not-a-Number (NaN) value, a
     &lt;code&gt;&lt;a href=#not_supported_err&gt;NOT_SUPPORTED_ERR&lt;/a&gt;&lt;/code&gt; exception must be raised.&lt;/p&gt;
 
+    &lt;p&gt;Except where otherwise specified, if a method has an argument
+    of type &lt;code&gt;DOMString&lt;/code&gt;, the user agent must &lt;span title=dfn-obtain-unicode&gt;convert the &lt;code&gt;DOMString&lt;/code&gt; to a
+    sequence of Unicode characters&lt;/span&gt; when the method is invoked,
+    to obtain the string on which the method is to operate. &lt;a href=#refsWEBIDL&gt;[WEBIDL]&lt;/a&gt;&lt;/p&gt;
+
    &lt;/dd&gt;
 
    &lt;dt&gt;JavaScript&lt;/dt&gt;
@@ -64995,8 +65019,244 @@
   &lt;/dl&gt;&lt;/div&gt;
 
 
-  &lt;h3 id=timers&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Timers&lt;/h3&gt;
+  &lt;h3 id=atob&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Base64 utility methods&lt;/h3&gt;
 
+  &lt;p&gt;The &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob()&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-windowbase64-btoa&gt;&lt;a href=#dom-windowbase64-btoa&gt;btoa()&lt;/a&gt;&lt;/code&gt; methods allow authors to
+  transform content to and from the base64 encoding.&lt;/p&gt;
+
+  &lt;!-- v2: actual binary support --&gt;
+
+  &lt;pre class=idl&gt;[Supplemental, NoInterfaceObject]
+interface &lt;dfn id=windowbase64&gt;WindowBase64&lt;/dfn&gt; {
+  DOMString &lt;a href=#dom-windowbase64-btoa title=dom-windowbase64-btoa&gt;btoa&lt;/a&gt;(in DOMString btoa);
+  DOMString &lt;a href=#dom-windowbase64-atob title=dom-windowbase64-atob&gt;atob&lt;/a&gt;(in DOMString atob);
+};
+&lt;a href=#window&gt;Window&lt;/a&gt; implements &lt;a href=#windowbase64&gt;WindowBase64&lt;/a&gt;;&lt;/pre&gt;
+
+  &lt;p class=note&gt;In these APIs, for mnemonic purposes, the &quot;b&quot; can be
+  considered to stand for &quot;binary&quot;, and the &quot;a&quot; for &quot;ASCII&quot;. In
+  practice, though, for primarily historical reasons, both the input
+  and output of these functions are Unicode strings.&lt;/p&gt;
+
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-windowbase64-btoa&gt;&lt;a href=#dom-windowbase64-btoa&gt;btoa&lt;/a&gt;&lt;/code&gt;( &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; )&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Takes the input data, in the form of a Unicode string
+    containing only characters in the range U+0000 to U+00FF, each
+    representing a binary byte with values 0x00 to 0xFF respectively,
+    and converts it to its base64 representation, which it returns.&lt;/p&gt;
+
+    &lt;p&gt;Throws an &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception if the
+    input string contains any out-of-range characters.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob&lt;/a&gt;&lt;/code&gt;( &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; )&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Takes the input data, in the form of a Unicode string
+    containing base64-encoded binary data, decodes it, and returns a
+    string consisting of characters in the range U+0000 to U+00FF,
+    each representing a binary byte with values 0x00 to 0xFF
+    respectively, corresponding to that binary data.&lt;/p&gt;
+
+    &lt;p&gt;Throws an &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception if the
+    input string is not valid base64 data.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;div class=impl&gt;
+
+  &lt;p class=note&gt;The &lt;code&gt;&lt;a href=#windowbase64&gt;WindowBase64&lt;/a&gt;&lt;/code&gt; interface adds to the
+  &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; interface and the &lt;code&gt;&lt;a href=#workerutils&gt;WorkerUtils&lt;/a&gt;&lt;/code&gt;
+  interface (part of Web Workers).&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-windowbase64-btoa title=dom-windowbase64-btoa&gt;&lt;code&gt;btoa()&lt;/code&gt;&lt;/dfn&gt;
+  method must throw an &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exeption if
+  the method's first argument contains any character whose code point
+  is greater than U+00FF. Otherwise, the user agent must convert that
+  argument to a sequence of octets whose &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th octet
+  is the eight-bit representation of the code point of the &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th character of the argument, and then must apply
+  the base64 algorithm to that sequence of octets, and return the
+  result. &lt;a href=#refsRFC4648&gt;[RFC4648]&lt;/a&gt;&lt;!--base64--&gt;&lt;/p&gt;
+  &lt;!-- Aryeh says: This seems to be what all browsers do as of January
+  2011 (except IE, which doesn't support these functions at all). --&gt;
+
+
+  &lt;p&gt;The &lt;dfn id=dom-windowbase64-atob title=dom-windowbase64-atob&gt;&lt;code&gt;atob()&lt;/code&gt;&lt;/dfn&gt;
+  method must run the following steps to parse the string passed in
+  the method's first argument:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;!-- Aryeh says: Copies Firefox behavior as of January 2011
+   (4.0b8). WebKit is somewhat laxer, and Opera throws no exceptions
+   at all. gsnedders reports Opera's behavior causes site-compat
+   problems, and I figure most sites depend on Firefox if on anything,
+   so go with that. --&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; be the string being
+   parsed.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; be a pointer into &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;, initially pointing at the start of the
+   string.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the length of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; divides by 4
+   leaving no remainder, then: if &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; ends with
+   one or two U+003D EQUALS SIGN (=) characters, remove them from &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the length of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; divides by 4
+   leaving a remainder of 1, throw an
+   &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception and abort these
+   steps.&lt;/p&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; contains a character that is not
+    in the following list of characters and character ranges, throw an
+    &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception and abort these
+    steps:&lt;/p&gt;
+
+    &lt;ul class=brief&gt;&lt;li&gt;U+002B PLUS SIGN (+)
+     &lt;li&gt;U+002F SOLIDUS (/)
+     &lt;li&gt;U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9)
+     &lt;li&gt;U+0041 LATIN CAPITAL LETTER A to U+005A LATIN CAPITAL LETTER Z
+     &lt;li&gt;U+0061 LATIN SMALL LETTER A to U+007A LATIN SMALL LETTER Z
+    &lt;/ul&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;output&lt;/var&gt; be a string, initially
+   empty.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; be a buffer that can have
+   bits appended to it, initially empty.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;While &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; does not point past the end
+    of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;, run these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;
+
+      &lt;p&gt;Find the character pointed to by &lt;var title=&quot;&quot;&gt;position&lt;/var&gt;
+      in the first column of the following table. Let &lt;var title=&quot;&quot;&gt;n&lt;/var&gt; be the number given in the second cell of the
+      same row.&lt;/p&gt;
+
+      &lt;div id=base64-table&gt;
+       &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Character
+          &lt;th&gt;Number
+        &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;A&lt;td&gt;0
+         &lt;tr&gt;&lt;td&gt;B&lt;td&gt;1
+         &lt;tr&gt;&lt;td&gt;C&lt;td&gt;2
+         &lt;tr&gt;&lt;td&gt;D&lt;td&gt;3
+         &lt;tr&gt;&lt;td&gt;E&lt;td&gt;4
+         &lt;tr&gt;&lt;td&gt;F&lt;td&gt;5
+         &lt;tr&gt;&lt;td&gt;G&lt;td&gt;6
+         &lt;tr&gt;&lt;td&gt;H&lt;td&gt;7
+         &lt;tr&gt;&lt;td&gt;I&lt;td&gt;8
+         &lt;tr&gt;&lt;td&gt;J&lt;td&gt;9
+         &lt;tr&gt;&lt;td&gt;K&lt;td&gt;10
+         &lt;tr&gt;&lt;td&gt;L&lt;td&gt;11
+         &lt;tr&gt;&lt;td&gt;M&lt;td&gt;12
+         &lt;tr&gt;&lt;td&gt;N&lt;td&gt;13
+         &lt;tr&gt;&lt;td&gt;O&lt;td&gt;14
+         &lt;tr&gt;&lt;td&gt;P&lt;td&gt;15
+         &lt;tr&gt;&lt;td&gt;Q&lt;td&gt;16
+         &lt;tr&gt;&lt;td&gt;R&lt;td&gt;17
+         &lt;tr&gt;&lt;td&gt;S&lt;td&gt;18
+         &lt;tr&gt;&lt;td&gt;T&lt;td&gt;19
+         &lt;tr&gt;&lt;td&gt;U&lt;td&gt;20
+         &lt;tr&gt;&lt;td&gt;V&lt;td&gt;21
+         &lt;tr&gt;&lt;td&gt;W&lt;td&gt;22
+         &lt;tr&gt;&lt;td&gt;X&lt;td&gt;23
+         &lt;tr&gt;&lt;td&gt;Y&lt;td&gt;24
+         &lt;tr&gt;&lt;td&gt;Z&lt;td&gt;25
+         &lt;tr&gt;&lt;td&gt;a&lt;td&gt;26
+         &lt;tr&gt;&lt;td&gt;b&lt;td&gt;27
+         &lt;tr&gt;&lt;td&gt;c&lt;td&gt;28
+         &lt;tr&gt;&lt;td&gt;d&lt;td&gt;29
+         &lt;tr&gt;&lt;td&gt;e&lt;td&gt;30
+         &lt;tr&gt;&lt;td&gt;f&lt;td&gt;31
+         &lt;tr&gt;&lt;td&gt;g&lt;td&gt;32
+         &lt;tr&gt;&lt;td&gt;h&lt;td&gt;33
+         &lt;tr&gt;&lt;td&gt;i&lt;td&gt;34
+         &lt;tr&gt;&lt;td&gt;j&lt;td&gt;35
+         &lt;tr&gt;&lt;td&gt;k&lt;td&gt;36
+         &lt;tr&gt;&lt;td&gt;l&lt;td&gt;37
+         &lt;tr&gt;&lt;td&gt;m&lt;td&gt;38
+         &lt;tr&gt;&lt;td&gt;n&lt;td&gt;39
+         &lt;tr&gt;&lt;td&gt;o&lt;td&gt;40
+         &lt;tr&gt;&lt;td&gt;p&lt;td&gt;41
+         &lt;tr&gt;&lt;td&gt;q&lt;td&gt;42
+         &lt;tr&gt;&lt;td&gt;r&lt;td&gt;43
+         &lt;tr&gt;&lt;td&gt;s&lt;td&gt;44
+         &lt;tr&gt;&lt;td&gt;t&lt;td&gt;45
+         &lt;tr&gt;&lt;td&gt;u&lt;td&gt;46
+         &lt;tr&gt;&lt;td&gt;v&lt;td&gt;47
+         &lt;tr&gt;&lt;td&gt;w&lt;td&gt;48
+         &lt;tr&gt;&lt;td&gt;x&lt;td&gt;49
+         &lt;tr&gt;&lt;td&gt;y&lt;td&gt;50
+         &lt;tr&gt;&lt;td&gt;z&lt;td&gt;51
+         &lt;tr&gt;&lt;td&gt;0&lt;td&gt;52
+         &lt;tr&gt;&lt;td&gt;1&lt;td&gt;53
+         &lt;tr&gt;&lt;td&gt;2&lt;td&gt;54
+         &lt;tr&gt;&lt;td&gt;3&lt;td&gt;55
+         &lt;tr&gt;&lt;td&gt;4&lt;td&gt;56
+         &lt;tr&gt;&lt;td&gt;5&lt;td&gt;57
+         &lt;tr&gt;&lt;td&gt;6&lt;td&gt;58
+         &lt;tr&gt;&lt;td&gt;7&lt;td&gt;59
+         &lt;tr&gt;&lt;td&gt;8&lt;td&gt;60
+         &lt;tr&gt;&lt;td&gt;9&lt;td&gt;61
+         &lt;tr&gt;&lt;td&gt;+&lt;td&gt;62
+         &lt;tr&gt;&lt;td&gt;/&lt;td&gt;63
+       &lt;/table&gt;&lt;/div&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append to &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; the six bits
+     corresponding to &lt;var title=&quot;&quot;&gt;number&lt;/var&gt;, most significant bit
+     first.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; has accumulated 24 bits,
+     interpret them as three 8-bit big-endian numbers. Append the
+     three characters with code points equal to those numbers to &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;, in the same order, and then empty &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Advance &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; by one
+     character.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; is not empty, it contains either
+    12 or 18 bits. If it contains 12 bits, discard the last four and
+    interpret the remaining eight as an 8-bit big-endian number. If it
+    contains 18 bits, discard the last two and interpret the remaining
+    16 as two 8-bit big-endian numbers. Append the one or two
+    characters with code points equal to those one or two numbers to
+    &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;, in the same order.&lt;/p&gt;
+
+    &lt;p&gt;The discarded bits mean that, for instance, &lt;code title=&quot;&quot;&gt;atob(&quot;YQ&quot;)&lt;/code&gt; and &lt;code title=&quot;&quot;&gt;atob(&quot;YR&quot;)&lt;/code&gt;
+    both return &quot;&lt;code title=&quot;&quot;&gt;a&lt;/code&gt;&quot;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;!-- Note: this function is defined explicitly here because RFC4648
+  does not specify how to handle erroneous input, and no preexisting
+  browser implementation simply throws an exception on all erroneous
+  input. --&gt;&lt;p class=note&gt;Some base64 encoders add newlines or other
+  whitespace to their output. The &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob()&lt;/a&gt;&lt;/code&gt; method throws an
+  exception if its input contains characters other than those
+  described by the regular expression bracket expression &lt;code title=&quot;&quot;&gt;[+/=0-9A-Za-z]&lt;/code&gt;, so other characters need to be
+  removed before &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob()&lt;/a&gt;&lt;/code&gt; is
+  used for decoding.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+
+
+
+  &lt;h3 id=timers&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;Timers&lt;/h3&gt;
+
   &lt;p&gt;The &lt;code title=dom-windowtimers-setTimeout&gt;&lt;a href=#dom-windowtimers-settimeout&gt;setTimeout()&lt;/a&gt;&lt;/code&gt;
   and &lt;code title=dom-windowtimers-setInterval&gt;&lt;a href=#dom-windowtimers-setinterval&gt;setInterval()&lt;/a&gt;&lt;/code&gt;
   methods allow authors to schedule timer-based callbacks.&lt;/p&gt;
@@ -65315,7 +65575,7 @@
 
 
 
-  &lt;h3 id=user-prompts&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;User prompts&lt;/h3&gt;
+  &lt;h3 id=user-prompts&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;User prompts&lt;/h3&gt;
 
   &lt;!--
    v2 ideas:
@@ -65326,7 +65586,7 @@
        - with a solution for the mobile space
   --&gt;
 
-  &lt;h4 id=simple-dialogs&gt;&lt;span class=secno&gt;7.3.1 &lt;/span&gt;Simple dialogs&lt;/h4&gt;
+  &lt;h4 id=simple-dialogs&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Simple dialogs&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-alert&gt;&lt;a href=#dom-alert&gt;alert&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;)&lt;/dt&gt;
    &lt;dd&gt;
@@ -65393,7 +65653,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=printing&gt;&lt;span class=secno&gt;7.3.2 &lt;/span&gt;Printing&lt;/h4&gt;
+  &lt;h4 id=printing&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Printing&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-print&gt;&lt;a href=#dom-print&gt;print&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
 
@@ -65487,7 +65747,7 @@
   &lt;/ol&gt;&lt;/div&gt;
 
 
-  &lt;h4 id=dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.3.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/h4&gt;
+  &lt;h4 id=dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-showModalDialog&gt;&lt;a href=#dom-showmodaldialog&gt;showModalDialog&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;url&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;argument&lt;/var&gt;] )&lt;/dt&gt;
 
@@ -65706,7 +65966,7 @@
 
 
 
-  &lt;h3 id=system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;System state and capabilities: the &lt;code&gt;&lt;a href=#navigator&gt;Navigator&lt;/a&gt;&lt;/code&gt; object&lt;/h3&gt;
+  &lt;h3 id=system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.5 &lt;/span&gt;System state and capabilities: the &lt;code&gt;&lt;a href=#navigator&gt;Navigator&lt;/a&gt;&lt;/code&gt; object&lt;/h3&gt;
 
   &lt;div class=impl&gt;
 
@@ -65771,7 +66031,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=client-identification&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Client identification&lt;/h4&gt;
+  &lt;h4 id=client-identification&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Client identification&lt;/h4&gt;
 
   &lt;p&gt;In certain cases, despite the best efforts of the entire
   industry, Web browsers have bugs and limitations that Web authors
@@ -65847,7 +66107,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=custom-handlers&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Custom scheme and content handlers&lt;/h4&gt;
+  &lt;h4 id=custom-handlers&gt;&lt;span class=secno&gt;7.5.2 &lt;/span&gt;Custom scheme and content handlers&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-navigator-registerprotocolhandler title=dom-navigator-registerProtocolHandler&gt;&lt;code&gt;registerProtocolHandler()&lt;/code&gt;&lt;/dfn&gt;
   method allows Web sites to register themselves as possible handlers
@@ -66042,7 +66302,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h5 id=security-and-privacy&gt;&lt;span class=secno&gt;7.4.2.1 &lt;/span&gt;Security and privacy&lt;/h5&gt;
+  &lt;h5 id=security-and-privacy&gt;&lt;span class=secno&gt;7.5.2.1 &lt;/span&gt;Security and privacy&lt;/h5&gt;
 
   &lt;p&gt;These mechanisms can introduce a number of concerns, in
   particular privacy concerns.&lt;/p&gt;
@@ -66126,7 +66386,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h5 id=sample-handler-impl&gt;&lt;span class=secno&gt;7.4.2.2 &lt;/span&gt;Sample user interface&lt;/h5&gt;
+  &lt;h5 id=sample-handler-impl&gt;&lt;span class=secno&gt;7.5.2.2 &lt;/span&gt;Sample user interface&lt;/h5&gt;
 
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
 
@@ -66172,7 +66432,7 @@
 
 
 
-  &lt;h4 id=manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/h4&gt;
+  &lt;h4 id=manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.5.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-navigator&gt;&lt;a href=#dom-navigator&gt;navigator&lt;/a&gt;&lt;/code&gt; . &lt;code title=dom-navigator-yieldForStorageUpdates&gt;&lt;a href=#dom-navigator-yieldforstorageupdates&gt;yieldForStorageUpdates&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
 

Modified: index
===================================================================
--- index	2011-02-01 01:30:07 UTC (rev 5813)
+++ index	2011-02-01 08:18:29 UTC (rev 5814)
@@ -157,6 +157,24 @@
 
    .details-example img { vertical-align: top; }
 
+   #base64-table {
+     white-space: nowrap;
+     font-size: 0.6em;
+     column-width: 6em;
+     column-count: 5;
+     column-gap: 1em;
+     -moz-column-width: 6em;
+     -moz-column-count: 5;
+     -moz-column-gap: 1em;
+     -webkit-column-width: 6em;
+     -webkit-column-count: 5;
+     -webkit-column-gap: 1em;
+   }
+   #base64-table thead { display: none; }
+   #base64-table * { border: none; }
+   #base64-table tbody td:first-child:after { content: ':'; }
+   #base64-table tbody td:last-child { text-align: right; }
+
    #named-character-references-table {
      white-space: nowrap;
      font-size: 0.6em;
@@ -943,20 +961,21 @@
        &lt;li&gt;&lt;a href=#event-firing&gt;&lt;span class=secno&gt;7.1.6.3 &lt;/span&gt;Event firing&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#events-and-the-window-object&gt;&lt;span class=secno&gt;7.1.6.4 &lt;/span&gt;Events and the &lt;code&gt;Window&lt;/code&gt; object&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#runtime-script-errors&gt;&lt;span class=secno&gt;7.1.6.5 &lt;/span&gt;Runtime script errors&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
-   &lt;li&gt;&lt;a href=#timers&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Timers&lt;/a&gt;&lt;/li&gt;
-   &lt;li&gt;&lt;a href=#user-prompts&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;User prompts&lt;/a&gt;
+   &lt;li&gt;&lt;a href=#atob&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Base64 utility methods&lt;/a&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#timers&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;Timers&lt;/a&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#user-prompts&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;User prompts&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#simple-dialogs&gt;&lt;span class=secno&gt;7.3.1 &lt;/span&gt;Simple dialogs&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#printing&gt;&lt;span class=secno&gt;7.3.2 &lt;/span&gt;Printing&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.3.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-   &lt;li&gt;&lt;a href=#system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;System state and capabilities: the &lt;code&gt;Navigator&lt;/code&gt; object&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#simple-dialogs&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Simple dialogs&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#printing&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Printing&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.5 &lt;/span&gt;System state and capabilities: the &lt;code&gt;Navigator&lt;/code&gt; object&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#client-identification&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Client identification&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#custom-handlers&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Custom scheme and content handlers&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#client-identification&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Client identification&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#custom-handlers&gt;&lt;span class=secno&gt;7.5.2 &lt;/span&gt;Custom scheme and content handlers&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#security-and-privacy&gt;&lt;span class=secno&gt;7.4.2.1 &lt;/span&gt;Security and privacy&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#sample-handler-impl&gt;&lt;span class=secno&gt;7.4.2.2 &lt;/span&gt;Sample user interface&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#security-and-privacy&gt;&lt;span class=secno&gt;7.5.2.1 &lt;/span&gt;Security and privacy&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#sample-handler-impl&gt;&lt;span class=secno&gt;7.5.2.2 &lt;/span&gt;Sample user interface&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.5.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=#editing&gt;&lt;span class=secno&gt;8 &lt;/span&gt;User interaction&lt;/a&gt;
   &lt;ol&gt;
    &lt;li&gt;&lt;a href=#the-hidden-attribute&gt;&lt;span class=secno&gt;8.1 &lt;/span&gt;The &lt;code&gt;hidden&lt;/code&gt; attribute&lt;/a&gt;&lt;/li&gt;
@@ -3301,6 +3320,11 @@
     is passed an Infinity or Not-a-Number (NaN) value, a
     &lt;code&gt;&lt;a href=#not_supported_err&gt;NOT_SUPPORTED_ERR&lt;/a&gt;&lt;/code&gt; exception must be raised.&lt;/p&gt;
 
+    &lt;p&gt;Except where otherwise specified, if a method has an argument
+    of type &lt;code&gt;DOMString&lt;/code&gt;, the user agent must &lt;span title=dfn-obtain-unicode&gt;convert the &lt;code&gt;DOMString&lt;/code&gt; to a
+    sequence of Unicode characters&lt;/span&gt; when the method is invoked,
+    to obtain the string on which the method is to operate. &lt;a href=#refsWEBIDL&gt;[WEBIDL]&lt;/a&gt;&lt;/p&gt;
+
    &lt;/dd&gt;
 
    &lt;dt&gt;JavaScript&lt;/dt&gt;
@@ -64997,8 +65021,244 @@
   &lt;/dl&gt;&lt;/div&gt;
 
 
-  &lt;h3 id=timers&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Timers&lt;/h3&gt;
+  &lt;h3 id=atob&gt;&lt;span class=secno&gt;7.2 &lt;/span&gt;Base64 utility methods&lt;/h3&gt;
 
+  &lt;p&gt;The &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob()&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-windowbase64-btoa&gt;&lt;a href=#dom-windowbase64-btoa&gt;btoa()&lt;/a&gt;&lt;/code&gt; methods allow authors to
+  transform content to and from the base64 encoding.&lt;/p&gt;
+
+  &lt;!-- v2: actual binary support --&gt;
+
+  &lt;pre class=idl&gt;[Supplemental, NoInterfaceObject]
+interface &lt;dfn id=windowbase64&gt;WindowBase64&lt;/dfn&gt; {
+  DOMString &lt;a href=#dom-windowbase64-btoa title=dom-windowbase64-btoa&gt;btoa&lt;/a&gt;(in DOMString btoa);
+  DOMString &lt;a href=#dom-windowbase64-atob title=dom-windowbase64-atob&gt;atob&lt;/a&gt;(in DOMString atob);
+};
+&lt;a href=#window&gt;Window&lt;/a&gt; implements &lt;a href=#windowbase64&gt;WindowBase64&lt;/a&gt;;&lt;/pre&gt;
+
+  &lt;p class=note&gt;In these APIs, for mnemonic purposes, the &quot;b&quot; can be
+  considered to stand for &quot;binary&quot;, and the &quot;a&quot; for &quot;ASCII&quot;. In
+  practice, though, for primarily historical reasons, both the input
+  and output of these functions are Unicode strings.&lt;/p&gt;
+
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-windowbase64-btoa&gt;&lt;a href=#dom-windowbase64-btoa&gt;btoa&lt;/a&gt;&lt;/code&gt;( &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; )&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Takes the input data, in the form of a Unicode string
+    containing only characters in the range U+0000 to U+00FF, each
+    representing a binary byte with values 0x00 to 0xFF respectively,
+    and converts it to its base64 representation, which it returns.&lt;/p&gt;
+
+    &lt;p&gt;Throws an &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception if the
+    input string contains any out-of-range characters.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob&lt;/a&gt;&lt;/code&gt;( &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; )&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Takes the input data, in the form of a Unicode string
+    containing base64-encoded binary data, decodes it, and returns a
+    string consisting of characters in the range U+0000 to U+00FF,
+    each representing a binary byte with values 0x00 to 0xFF
+    respectively, corresponding to that binary data.&lt;/p&gt;
+
+    &lt;p&gt;Throws an &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception if the
+    input string is not valid base64 data.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;div class=impl&gt;
+
+  &lt;p class=note&gt;The &lt;code&gt;&lt;a href=#windowbase64&gt;WindowBase64&lt;/a&gt;&lt;/code&gt; interface adds to the
+  &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; interface and the &lt;code&gt;WorkerUtils&lt;/code&gt;
+  interface (part of Web Workers).&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-windowbase64-btoa title=dom-windowbase64-btoa&gt;&lt;code&gt;btoa()&lt;/code&gt;&lt;/dfn&gt;
+  method must throw an &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exeption if
+  the method's first argument contains any character whose code point
+  is greater than U+00FF. Otherwise, the user agent must convert that
+  argument to a sequence of octets whose &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th octet
+  is the eight-bit representation of the code point of the &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th character of the argument, and then must apply
+  the base64 algorithm to that sequence of octets, and return the
+  result. &lt;a href=#refsRFC4648&gt;[RFC4648]&lt;/a&gt;&lt;!--base64--&gt;&lt;/p&gt;
+  &lt;!-- Aryeh says: This seems to be what all browsers do as of January
+  2011 (except IE, which doesn't support these functions at all). --&gt;
+
+
+  &lt;p&gt;The &lt;dfn id=dom-windowbase64-atob title=dom-windowbase64-atob&gt;&lt;code&gt;atob()&lt;/code&gt;&lt;/dfn&gt;
+  method must run the following steps to parse the string passed in
+  the method's first argument:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;!-- Aryeh says: Copies Firefox behavior as of January 2011
+   (4.0b8). WebKit is somewhat laxer, and Opera throws no exceptions
+   at all. gsnedders reports Opera's behavior causes site-compat
+   problems, and I figure most sites depend on Firefox if on anything,
+   so go with that. --&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; be the string being
+   parsed.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; be a pointer into &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;, initially pointing at the start of the
+   string.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the length of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; divides by 4
+   leaving no remainder, then: if &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; ends with
+   one or two U+003D EQUALS SIGN (=) characters, remove them from &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the length of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; divides by 4
+   leaving a remainder of 1, throw an
+   &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception and abort these
+   steps.&lt;/p&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; contains a character that is not
+    in the following list of characters and character ranges, throw an
+    &lt;code&gt;&lt;a href=#invalid_character_err&gt;INVALID_CHARACTER_ERR&lt;/a&gt;&lt;/code&gt; exception and abort these
+    steps:&lt;/p&gt;
+
+    &lt;ul class=brief&gt;&lt;li&gt;U+002B PLUS SIGN (+)
+     &lt;li&gt;U+002F SOLIDUS (/)
+     &lt;li&gt;U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9)
+     &lt;li&gt;U+0041 LATIN CAPITAL LETTER A to U+005A LATIN CAPITAL LETTER Z
+     &lt;li&gt;U+0061 LATIN SMALL LETTER A to U+007A LATIN SMALL LETTER Z
+    &lt;/ul&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;output&lt;/var&gt; be a string, initially
+   empty.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; be a buffer that can have
+   bits appended to it, initially empty.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;While &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; does not point past the end
+    of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;, run these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;
+
+      &lt;p&gt;Find the character pointed to by &lt;var title=&quot;&quot;&gt;position&lt;/var&gt;
+      in the first column of the following table. Let &lt;var title=&quot;&quot;&gt;n&lt;/var&gt; be the number given in the second cell of the
+      same row.&lt;/p&gt;
+
+      &lt;div id=base64-table&gt;
+       &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Character
+          &lt;th&gt;Number
+        &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;A&lt;td&gt;0
+         &lt;tr&gt;&lt;td&gt;B&lt;td&gt;1
+         &lt;tr&gt;&lt;td&gt;C&lt;td&gt;2
+         &lt;tr&gt;&lt;td&gt;D&lt;td&gt;3
+         &lt;tr&gt;&lt;td&gt;E&lt;td&gt;4
+         &lt;tr&gt;&lt;td&gt;F&lt;td&gt;5
+         &lt;tr&gt;&lt;td&gt;G&lt;td&gt;6
+         &lt;tr&gt;&lt;td&gt;H&lt;td&gt;7
+         &lt;tr&gt;&lt;td&gt;I&lt;td&gt;8
+         &lt;tr&gt;&lt;td&gt;J&lt;td&gt;9
+         &lt;tr&gt;&lt;td&gt;K&lt;td&gt;10
+         &lt;tr&gt;&lt;td&gt;L&lt;td&gt;11
+         &lt;tr&gt;&lt;td&gt;M&lt;td&gt;12
+         &lt;tr&gt;&lt;td&gt;N&lt;td&gt;13
+         &lt;tr&gt;&lt;td&gt;O&lt;td&gt;14
+         &lt;tr&gt;&lt;td&gt;P&lt;td&gt;15
+         &lt;tr&gt;&lt;td&gt;Q&lt;td&gt;16
+         &lt;tr&gt;&lt;td&gt;R&lt;td&gt;17
+         &lt;tr&gt;&lt;td&gt;S&lt;td&gt;18
+         &lt;tr&gt;&lt;td&gt;T&lt;td&gt;19
+         &lt;tr&gt;&lt;td&gt;U&lt;td&gt;20
+         &lt;tr&gt;&lt;td&gt;V&lt;td&gt;21
+         &lt;tr&gt;&lt;td&gt;W&lt;td&gt;22
+         &lt;tr&gt;&lt;td&gt;X&lt;td&gt;23
+         &lt;tr&gt;&lt;td&gt;Y&lt;td&gt;24
+         &lt;tr&gt;&lt;td&gt;Z&lt;td&gt;25
+         &lt;tr&gt;&lt;td&gt;a&lt;td&gt;26
+         &lt;tr&gt;&lt;td&gt;b&lt;td&gt;27
+         &lt;tr&gt;&lt;td&gt;c&lt;td&gt;28
+         &lt;tr&gt;&lt;td&gt;d&lt;td&gt;29
+         &lt;tr&gt;&lt;td&gt;e&lt;td&gt;30
+         &lt;tr&gt;&lt;td&gt;f&lt;td&gt;31
+         &lt;tr&gt;&lt;td&gt;g&lt;td&gt;32
+         &lt;tr&gt;&lt;td&gt;h&lt;td&gt;33
+         &lt;tr&gt;&lt;td&gt;i&lt;td&gt;34
+         &lt;tr&gt;&lt;td&gt;j&lt;td&gt;35
+         &lt;tr&gt;&lt;td&gt;k&lt;td&gt;36
+         &lt;tr&gt;&lt;td&gt;l&lt;td&gt;37
+         &lt;tr&gt;&lt;td&gt;m&lt;td&gt;38
+         &lt;tr&gt;&lt;td&gt;n&lt;td&gt;39
+         &lt;tr&gt;&lt;td&gt;o&lt;td&gt;40
+         &lt;tr&gt;&lt;td&gt;p&lt;td&gt;41
+         &lt;tr&gt;&lt;td&gt;q&lt;td&gt;42
+         &lt;tr&gt;&lt;td&gt;r&lt;td&gt;43
+         &lt;tr&gt;&lt;td&gt;s&lt;td&gt;44
+         &lt;tr&gt;&lt;td&gt;t&lt;td&gt;45
+         &lt;tr&gt;&lt;td&gt;u&lt;td&gt;46
+         &lt;tr&gt;&lt;td&gt;v&lt;td&gt;47
+         &lt;tr&gt;&lt;td&gt;w&lt;td&gt;48
+         &lt;tr&gt;&lt;td&gt;x&lt;td&gt;49
+         &lt;tr&gt;&lt;td&gt;y&lt;td&gt;50
+         &lt;tr&gt;&lt;td&gt;z&lt;td&gt;51
+         &lt;tr&gt;&lt;td&gt;0&lt;td&gt;52
+         &lt;tr&gt;&lt;td&gt;1&lt;td&gt;53
+         &lt;tr&gt;&lt;td&gt;2&lt;td&gt;54
+         &lt;tr&gt;&lt;td&gt;3&lt;td&gt;55
+         &lt;tr&gt;&lt;td&gt;4&lt;td&gt;56
+         &lt;tr&gt;&lt;td&gt;5&lt;td&gt;57
+         &lt;tr&gt;&lt;td&gt;6&lt;td&gt;58
+         &lt;tr&gt;&lt;td&gt;7&lt;td&gt;59
+         &lt;tr&gt;&lt;td&gt;8&lt;td&gt;60
+         &lt;tr&gt;&lt;td&gt;9&lt;td&gt;61
+         &lt;tr&gt;&lt;td&gt;+&lt;td&gt;62
+         &lt;tr&gt;&lt;td&gt;/&lt;td&gt;63
+       &lt;/table&gt;&lt;/div&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append to &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; the six bits
+     corresponding to &lt;var title=&quot;&quot;&gt;number&lt;/var&gt;, most significant bit
+     first.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; has accumulated 24 bits,
+     interpret them as three 8-bit big-endian numbers. Append the
+     three characters with code points equal to those numbers to &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;, in the same order, and then empty &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Advance &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; by one
+     character.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; is not empty, it contains either
+    12 or 18 bits. If it contains 12 bits, discard the last four and
+    interpret the remaining eight as an 8-bit big-endian number. If it
+    contains 18 bits, discard the last two and interpret the remaining
+    16 as two 8-bit big-endian numbers. Append the one or two
+    characters with code points equal to those one or two numbers to
+    &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;, in the same order.&lt;/p&gt;
+
+    &lt;p&gt;The discarded bits mean that, for instance, &lt;code title=&quot;&quot;&gt;atob(&quot;YQ&quot;)&lt;/code&gt; and &lt;code title=&quot;&quot;&gt;atob(&quot;YR&quot;)&lt;/code&gt;
+    both return &quot;&lt;code title=&quot;&quot;&gt;a&lt;/code&gt;&quot;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;!-- Note: this function is defined explicitly here because RFC4648
+  does not specify how to handle erroneous input, and no preexisting
+  browser implementation simply throws an exception on all erroneous
+  input. --&gt;&lt;p class=note&gt;Some base64 encoders add newlines or other
+  whitespace to their output. The &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob()&lt;/a&gt;&lt;/code&gt; method throws an
+  exception if its input contains characters other than those
+  described by the regular expression bracket expression &lt;code title=&quot;&quot;&gt;[+/=0-9A-Za-z]&lt;/code&gt;, so other characters need to be
+  removed before &lt;code title=dom-windowbase64-atob&gt;&lt;a href=#dom-windowbase64-atob&gt;atob()&lt;/a&gt;&lt;/code&gt; is
+  used for decoding.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+
+
+
+  &lt;h3 id=timers&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;Timers&lt;/h3&gt;
+
   &lt;p&gt;The &lt;code title=dom-windowtimers-setTimeout&gt;&lt;a href=#dom-windowtimers-settimeout&gt;setTimeout()&lt;/a&gt;&lt;/code&gt;
   and &lt;code title=dom-windowtimers-setInterval&gt;&lt;a href=#dom-windowtimers-setinterval&gt;setInterval()&lt;/a&gt;&lt;/code&gt;
   methods allow authors to schedule timer-based callbacks.&lt;/p&gt;
@@ -65317,7 +65577,7 @@
 
 
 
-  &lt;h3 id=user-prompts&gt;&lt;span class=secno&gt;7.3 &lt;/span&gt;User prompts&lt;/h3&gt;
+  &lt;h3 id=user-prompts&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;User prompts&lt;/h3&gt;
 
   &lt;!--
    v2 ideas:
@@ -65328,7 +65588,7 @@
        - with a solution for the mobile space
   --&gt;
 
-  &lt;h4 id=simple-dialogs&gt;&lt;span class=secno&gt;7.3.1 &lt;/span&gt;Simple dialogs&lt;/h4&gt;
+  &lt;h4 id=simple-dialogs&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Simple dialogs&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-alert&gt;&lt;a href=#dom-alert&gt;alert&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;)&lt;/dt&gt;
    &lt;dd&gt;
@@ -65395,7 +65655,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=printing&gt;&lt;span class=secno&gt;7.3.2 &lt;/span&gt;Printing&lt;/h4&gt;
+  &lt;h4 id=printing&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Printing&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-print&gt;&lt;a href=#dom-print&gt;print&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
 
@@ -65489,7 +65749,7 @@
   &lt;/ol&gt;&lt;/div&gt;
 
 
-  &lt;h4 id=dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.3.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/h4&gt;
+  &lt;h4 id=dialogs-implemented-using-separate-documents&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Dialogs implemented using separate documents&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-showModalDialog&gt;&lt;a href=#dom-showmodaldialog&gt;showModalDialog&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;url&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;argument&lt;/var&gt;] )&lt;/dt&gt;
 
@@ -65708,7 +65968,7 @@
 
 
 
-  &lt;h3 id=system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;System state and capabilities: the &lt;code&gt;&lt;a href=#navigator&gt;Navigator&lt;/a&gt;&lt;/code&gt; object&lt;/h3&gt;
+  &lt;h3 id=system-state-and-capabilities:-the-navigator-object&gt;&lt;span class=secno&gt;7.5 &lt;/span&gt;System state and capabilities: the &lt;code&gt;&lt;a href=#navigator&gt;Navigator&lt;/a&gt;&lt;/code&gt; object&lt;/h3&gt;
 
   &lt;div class=impl&gt;
 
@@ -65773,7 +66033,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=client-identification&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Client identification&lt;/h4&gt;
+  &lt;h4 id=client-identification&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Client identification&lt;/h4&gt;
 
   &lt;p&gt;In certain cases, despite the best efforts of the entire
   industry, Web browsers have bugs and limitations that Web authors
@@ -65849,7 +66109,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=custom-handlers&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Custom scheme and content handlers&lt;/h4&gt;
+  &lt;h4 id=custom-handlers&gt;&lt;span class=secno&gt;7.5.2 &lt;/span&gt;Custom scheme and content handlers&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-navigator-registerprotocolhandler title=dom-navigator-registerProtocolHandler&gt;&lt;code&gt;registerProtocolHandler()&lt;/code&gt;&lt;/dfn&gt;
   method allows Web sites to register themselves as possible handlers
@@ -66044,7 +66304,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h5 id=security-and-privacy&gt;&lt;span class=secno&gt;7.4.2.1 &lt;/span&gt;Security and privacy&lt;/h5&gt;
+  &lt;h5 id=security-and-privacy&gt;&lt;span class=secno&gt;7.5.2.1 &lt;/span&gt;Security and privacy&lt;/h5&gt;
 
   &lt;p&gt;These mechanisms can introduce a number of concerns, in
   particular privacy concerns.&lt;/p&gt;
@@ -66128,7 +66388,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h5 id=sample-handler-impl&gt;&lt;span class=secno&gt;7.4.2.2 &lt;/span&gt;Sample user interface&lt;/h5&gt;
+  &lt;h5 id=sample-handler-impl&gt;&lt;span class=secno&gt;7.5.2.2 &lt;/span&gt;Sample user interface&lt;/h5&gt;
 
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
 
@@ -66174,7 +66434,7 @@
 
 
 
-  &lt;h4 id=manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.4.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/h4&gt;
+  &lt;h4 id=manually-releasing-the-storage-mutex&gt;&lt;span class=secno&gt;7.5.3 &lt;/span&gt;Manually releasing the storage mutex&lt;/h4&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-navigator&gt;&lt;a href=#dom-navigator&gt;navigator&lt;/a&gt;&lt;/code&gt; . &lt;code title=dom-navigator-yieldForStorageUpdates&gt;&lt;a href=#dom-navigator-yieldforstorageupdates&gt;yieldForStorageUpdates&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
 

Modified: source
===================================================================
--- source	2011-02-01 01:30:07 UTC (rev 5813)
+++ source	2011-02-01 08:18:29 UTC (rev 5814)
@@ -2267,6 +2267,13 @@
     is passed an Infinity or Not-a-Number (NaN) value, a
     &lt;code&gt;NOT_SUPPORTED_ERR&lt;/code&gt; exception must be raised.&lt;/p&gt;
 
+    &lt;p&gt;Except where otherwise specified, if a method has an argument
+    of type &lt;code&gt;DOMString&lt;/code&gt;, the user agent must &lt;span
+    title=&quot;dfn-obtain-unicode&quot;&gt;convert the &lt;code&gt;DOMString&lt;/code&gt; to a
+    sequence of Unicode characters&lt;/span&gt; when the method is invoked,
+    to obtain the string on which the method is to operate. &lt;a
+    href=&quot;#refsWEBIDL&quot;&gt;[WEBIDL]&lt;/a&gt;&lt;/p&gt;
+
    &lt;/dd&gt;
 
    &lt;dt&gt;JavaScript&lt;/dt&gt;
@@ -74012,6 +74019,276 @@
   &lt;/div&gt;
 
 
+  &lt;h3 id=&quot;atob&quot;&gt;Base64 utility methods&lt;/h3&gt;
+
+  &lt;p&gt;The &lt;code title=&quot;dom-windowbase64-atob&quot;&gt;atob()&lt;/code&gt; and &lt;code
+  title=&quot;dom-windowbase64-btoa&quot;&gt;btoa()&lt;/code&gt; methods allow authors to
+  transform content to and from the base64 encoding.&lt;/p&gt;
+
+  &lt;!-- v2: actual binary support --&gt;
+
+  &lt;pre class=&quot;idl&quot;&gt;[Supplemental, NoInterfaceObject]
+interface &lt;dfn&gt;WindowBase64&lt;/dfn&gt; {
+  DOMString &lt;span title=&quot;dom-windowbase64-btoa&quot;&gt;btoa&lt;/span&gt;(in DOMString btoa);
+  DOMString &lt;span title=&quot;dom-windowbase64-atob&quot;&gt;atob&lt;/span&gt;(in DOMString atob);
+};
+&lt;span&gt;Window&lt;/span&gt; implements &lt;span&gt;WindowBase64&lt;/span&gt;;&lt;/pre&gt;
+
+  &lt;p class=&quot;note&quot;&gt;In these APIs, for mnemonic purposes, the &quot;b&quot; can be
+  considered to stand for &quot;binary&quot;, and the &quot;a&quot; for &quot;ASCII&quot;. In
+  practice, though, for primarily historical reasons, both the input
+  and output of these functions are Unicode strings.&lt;/p&gt;
+
+  &lt;dl class=&quot;domintro&quot;&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=&quot;dom-windowbase64-btoa&quot;&gt;btoa&lt;/code&gt;( &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; )&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Takes the input data, in the form of a Unicode string
+    containing only characters in the range U+0000 to U+00FF, each
+    representing a binary byte with values 0x00 to 0xFF respectively,
+    and converts it to its base64 representation, which it returns.&lt;/p&gt;
+
+    &lt;p&gt;Throws an &lt;code&gt;INVALID_CHARACTER_ERR&lt;/code&gt; exception if the
+    input string contains any out-of-range characters.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;result&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=&quot;dom-windowbase64-atob&quot;&gt;atob&lt;/code&gt;( &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; )&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Takes the input data, in the form of a Unicode string
+    containing base64-encoded binary data, decodes it, and returns a
+    string consisting of characters in the range U+0000 to U+00FF,
+    each representing a binary byte with values 0x00 to 0xFF
+    respectively, corresponding to that binary data.&lt;/p&gt;
+
+    &lt;p&gt;Throws an &lt;code&gt;INVALID_CHARACTER_ERR&lt;/code&gt; exception if the
+    input string is not valid base64 data.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+  &lt;div class=&quot;impl&quot;&gt;
+
+  &lt;p class=&quot;note&quot;&gt;The &lt;code&gt;WindowBase64&lt;/code&gt; interface adds to the
+  &lt;code&gt;Window&lt;/code&gt; interface and the &lt;code&gt;WorkerUtils&lt;/code&gt;
+  interface (part of Web Workers).&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;dom-windowbase64-btoa&quot;&gt;&lt;code&gt;btoa()&lt;/code&gt;&lt;/dfn&gt;
+  method must throw an &lt;code&gt;INVALID_CHARACTER_ERR&lt;/code&gt; exeption if
+  the method's first argument contains any character whose code point
+  is greater than U+00FF. Otherwise, the user agent must convert that
+  argument to a sequence of octets whose &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th octet
+  is the eight-bit representation of the code point of the &lt;var
+  title=&quot;&quot;&gt;n&lt;/var&gt;th character of the argument, and then must apply
+  the base64 algorithm to that sequence of octets, and return the
+  result. &lt;a href=&quot;#refsRFC4648&quot;&gt;[RFC4648]&lt;/a&gt;&lt;!--base64--&gt;&lt;/p&gt;
+  &lt;!-- Aryeh says: This seems to be what all browsers do as of January
+  2011 (except IE, which doesn't support these functions at all). --&gt;
+
+
+  &lt;p&gt;The &lt;dfn title=&quot;dom-windowbase64-atob&quot;&gt;&lt;code&gt;atob()&lt;/code&gt;&lt;/dfn&gt;
+  method must run the following steps to parse the string passed in
+  the method's first argument:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;!-- Aryeh says: Copies Firefox behavior as of January 2011
+   (4.0b8). WebKit is somewhat laxer, and Opera throws no exceptions
+   at all. gsnedders reports Opera's behavior causes site-compat
+   problems, and I figure most sites depend on Firefox if on anything,
+   so go with that. --&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; be the string being
+   parsed.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; be a pointer into &lt;var
+   title=&quot;&quot;&gt;input&lt;/var&gt;, initially pointing at the start of the
+   string.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the length of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; divides by 4
+   leaving no remainder, then: if &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; ends with
+   one or two U+003D EQUALS SIGN (=) characters, remove them from &lt;var
+   title=&quot;&quot;&gt;input&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the length of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; divides by 4
+   leaving a remainder of 1, throw an
+   &lt;code&gt;INVALID_CHARACTER_ERR&lt;/code&gt; exception and abort these
+   steps.&lt;/p&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; contains a character that is not
+    in the following list of characters and character ranges, throw an
+    &lt;code&gt;INVALID_CHARACTER_ERR&lt;/code&gt; exception and abort these
+    steps:&lt;/p&gt;
+
+    &lt;ul class=&quot;brief&quot;&gt;
+     &lt;li&gt;U+002B PLUS SIGN (+)
+     &lt;li&gt;U+002F SOLIDUS (/)
+     &lt;li&gt;U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9)
+     &lt;li&gt;U+0041 LATIN CAPITAL LETTER A to U+005A LATIN CAPITAL LETTER Z
+     &lt;li&gt;U+0061 LATIN SMALL LETTER A to U+007A LATIN SMALL LETTER Z
+    &lt;/ul&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;output&lt;/var&gt; be a string, initially
+   empty.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; be a buffer that can have
+   bits appended to it, initially empty.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;While &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; does not point past the end
+    of &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;, run these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;
+
+     &lt;li&gt;
+
+      &lt;p&gt;Find the character pointed to by &lt;var title=&quot;&quot;&gt;position&lt;/var&gt;
+      in the first column of the following table. Let &lt;var
+      title=&quot;&quot;&gt;n&lt;/var&gt; be the number given in the second cell of the
+      same row.&lt;/p&gt;
+
+      &lt;div id=&quot;base64-table&quot;&gt;
+       &lt;table&gt;
+        &lt;thead&gt;
+         &lt;tr&gt;
+          &lt;th&gt;Character
+          &lt;th&gt;Number
+        &lt;tbody&gt;
+         &lt;tr&gt;&lt;td&gt;A&lt;td&gt;0
+         &lt;tr&gt;&lt;td&gt;B&lt;td&gt;1
+         &lt;tr&gt;&lt;td&gt;C&lt;td&gt;2
+         &lt;tr&gt;&lt;td&gt;D&lt;td&gt;3
+         &lt;tr&gt;&lt;td&gt;E&lt;td&gt;4
+         &lt;tr&gt;&lt;td&gt;F&lt;td&gt;5
+         &lt;tr&gt;&lt;td&gt;G&lt;td&gt;6
+         &lt;tr&gt;&lt;td&gt;H&lt;td&gt;7
+         &lt;tr&gt;&lt;td&gt;I&lt;td&gt;8
+         &lt;tr&gt;&lt;td&gt;J&lt;td&gt;9
+         &lt;tr&gt;&lt;td&gt;K&lt;td&gt;10
+         &lt;tr&gt;&lt;td&gt;L&lt;td&gt;11
+         &lt;tr&gt;&lt;td&gt;M&lt;td&gt;12
+         &lt;tr&gt;&lt;td&gt;N&lt;td&gt;13
+         &lt;tr&gt;&lt;td&gt;O&lt;td&gt;14
+         &lt;tr&gt;&lt;td&gt;P&lt;td&gt;15
+         &lt;tr&gt;&lt;td&gt;Q&lt;td&gt;16
+         &lt;tr&gt;&lt;td&gt;R&lt;td&gt;17
+         &lt;tr&gt;&lt;td&gt;S&lt;td&gt;18
+         &lt;tr&gt;&lt;td&gt;T&lt;td&gt;19
+         &lt;tr&gt;&lt;td&gt;U&lt;td&gt;20
+         &lt;tr&gt;&lt;td&gt;V&lt;td&gt;21
+         &lt;tr&gt;&lt;td&gt;W&lt;td&gt;22
+         &lt;tr&gt;&lt;td&gt;X&lt;td&gt;23
+         &lt;tr&gt;&lt;td&gt;Y&lt;td&gt;24
+         &lt;tr&gt;&lt;td&gt;Z&lt;td&gt;25
+         &lt;tr&gt;&lt;td&gt;a&lt;td&gt;26
+         &lt;tr&gt;&lt;td&gt;b&lt;td&gt;27
+         &lt;tr&gt;&lt;td&gt;c&lt;td&gt;28
+         &lt;tr&gt;&lt;td&gt;d&lt;td&gt;29
+         &lt;tr&gt;&lt;td&gt;e&lt;td&gt;30
+         &lt;tr&gt;&lt;td&gt;f&lt;td&gt;31
+         &lt;tr&gt;&lt;td&gt;g&lt;td&gt;32
+         &lt;tr&gt;&lt;td&gt;h&lt;td&gt;33
+         &lt;tr&gt;&lt;td&gt;i&lt;td&gt;34
+         &lt;tr&gt;&lt;td&gt;j&lt;td&gt;35
+         &lt;tr&gt;&lt;td&gt;k&lt;td&gt;36
+         &lt;tr&gt;&lt;td&gt;l&lt;td&gt;37
+         &lt;tr&gt;&lt;td&gt;m&lt;td&gt;38
+         &lt;tr&gt;&lt;td&gt;n&lt;td&gt;39
+         &lt;tr&gt;&lt;td&gt;o&lt;td&gt;40
+         &lt;tr&gt;&lt;td&gt;p&lt;td&gt;41
+         &lt;tr&gt;&lt;td&gt;q&lt;td&gt;42
+         &lt;tr&gt;&lt;td&gt;r&lt;td&gt;43
+         &lt;tr&gt;&lt;td&gt;s&lt;td&gt;44
+         &lt;tr&gt;&lt;td&gt;t&lt;td&gt;45
+         &lt;tr&gt;&lt;td&gt;u&lt;td&gt;46
+         &lt;tr&gt;&lt;td&gt;v&lt;td&gt;47
+         &lt;tr&gt;&lt;td&gt;w&lt;td&gt;48
+         &lt;tr&gt;&lt;td&gt;x&lt;td&gt;49
+         &lt;tr&gt;&lt;td&gt;y&lt;td&gt;50
+         &lt;tr&gt;&lt;td&gt;z&lt;td&gt;51
+         &lt;tr&gt;&lt;td&gt;0&lt;td&gt;52
+         &lt;tr&gt;&lt;td&gt;1&lt;td&gt;53
+         &lt;tr&gt;&lt;td&gt;2&lt;td&gt;54
+         &lt;tr&gt;&lt;td&gt;3&lt;td&gt;55
+         &lt;tr&gt;&lt;td&gt;4&lt;td&gt;56
+         &lt;tr&gt;&lt;td&gt;5&lt;td&gt;57
+         &lt;tr&gt;&lt;td&gt;6&lt;td&gt;58
+         &lt;tr&gt;&lt;td&gt;7&lt;td&gt;59
+         &lt;tr&gt;&lt;td&gt;8&lt;td&gt;60
+         &lt;tr&gt;&lt;td&gt;9&lt;td&gt;61
+         &lt;tr&gt;&lt;td&gt;+&lt;td&gt;62
+         &lt;tr&gt;&lt;td&gt;/&lt;td&gt;63
+       &lt;/table&gt;
+      &lt;/div&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append to &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; the six bits
+     corresponding to &lt;var title=&quot;&quot;&gt;number&lt;/var&gt;, most significant bit
+     first.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; has accumulated 24 bits,
+     interpret them as three 8-bit big-endian numbers. Append the
+     three characters with code points equal to those numbers to &lt;var
+     title=&quot;&quot;&gt;output&lt;/var&gt;, in the same order, and then empty &lt;var
+     title=&quot;&quot;&gt;buffer&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Advance &lt;var title=&quot;&quot;&gt;position&lt;/var&gt; by one
+     character.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;buffer&lt;/var&gt; is not empty, it contains either
+    12 or 18 bits. If it contains 12 bits, discard the last four and
+    interpret the remaining eight as an 8-bit big-endian number. If it
+    contains 18 bits, discard the last two and interpret the remaining
+    16 as two 8-bit big-endian numbers. Append the one or two
+    characters with code points equal to those one or two numbers to
+    &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;, in the same order.&lt;/p&gt;
+
+    &lt;p&gt;The discarded bits mean that, for instance, &lt;code
+    title=&quot;&quot;&gt;atob(&quot;YQ&quot;)&lt;/code&gt; and &lt;code title=&quot;&quot;&gt;atob(&quot;YR&quot;)&lt;/code&gt;
+    both return &quot;&lt;code title=&quot;&quot;&gt;a&lt;/code&gt;&quot;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;!-- Note: this function is defined explicitly here because RFC4648
+  does not specify how to handle erroneous input, and no preexisting
+  browser implementation simply throws an exception on all erroneous
+  input. --&gt;
+
+  &lt;p class=&quot;note&quot;&gt;Some base64 encoders add newlines or other
+  whitespace to their output. The &lt;code
+  title=&quot;dom-windowbase64-atob&quot;&gt;atob()&lt;/code&gt; method throws an
+  exception if its input contains characters other than those
+  described by the regular expression bracket expression &lt;code
+  title=&quot;&quot;&gt;[+/=0-9A-Za-z]&lt;/code&gt;, so other characters need to be
+  removed before &lt;code title=&quot;dom-windowbase64-atob&quot;&gt;atob()&lt;/code&gt; is
+  used for decoding.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+
+
+
   &lt;h3 id=&quot;timers&quot;&gt;Timers&lt;/h3&gt;
 
   &lt;p&gt;The &lt;code title=&quot;dom-windowtimers-setTimeout&quot;&gt;setTimeout()&lt;/code&gt;


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012680.html">[html5] r5813 - [e] (0) clarify that pages with a manifest=''	always get served from their cache [...]
</A></li>
	<LI>Next message: <A HREF="012682.html">[html5] r5815 - [e] (0) move note out of impl section
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12681">[ date ]</a>
              <a href="thread.html#12681">[ thread ]</a>
              <a href="subject.html#12681">[ subject ]</a>
              <a href="author.html#12681">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
