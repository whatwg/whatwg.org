<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r5883 - [giow] (2) Make a parser-inserted script not run if	it is moved to another docum [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5883%20-%20%5Bgiow%5D%20%282%29%20Make%20a%20parser-inserted%20script%20not%20run%20if%0A%09it%20is%20moved%20to%20another%20docum%20%5B...%5D&In-Reply-To=%3C20110214204748.475D611C7C003%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012749.html">
   <LINK REL="Next"  HREF="012751.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r5883 - [giow] (2) Make a parser-inserted script not run if	it is moved to another docum [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5883%20-%20%5Bgiow%5D%20%282%29%20Make%20a%20parser-inserted%20script%20not%20run%20if%0A%09it%20is%20moved%20to%20another%20docum%20%5B...%5D&In-Reply-To=%3C20110214204748.475D611C7C003%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r5883 - [giow] (2) Make a parser-inserted script not run if	it is moved to another docum [...]">whatwg at whatwg.org
       </A><BR>
    <I>Mon Feb 14 12:47:48 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012749.html">[html5] r5882 - [e] (0) typo
</A></li>
        <LI>Next message: <A HREF="012751.html">[html5] r5884 - [e] (0) clarify 'attribute' in a few cases where it	could be confusing.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12750">[ date ]</a>
              <a href="thread.html#12750">[ thread ]</a>
              <a href="subject.html#12750">[ subject ]</a>
              <a href="author.html#12750">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2011-02-14 12:47:46 -0800 (Mon, 14 Feb 2011)
New Revision: 5883

Modified:
   complete.html
   index
   source
Log:
[giow] (2) Make a parser-inserted script not run if it is moved to another document before it executes (and not even fetch if it is parsed into another document than its parser's document).
Fixing <A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=11323">http://www.w3.org/Bugs/Public/show_bug.cgi?id=11323</A>

Modified: complete.html
===================================================================
--- complete.html	2011-02-14 10:02:35 UTC (rev 5882)
+++ complete.html	2011-02-14 20:47:46 UTC (rev 5883)
@@ -15061,6 +15061,15 @@
 
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;If the element is flagged as &lt;a href=#parser-inserted&gt;&quot;parser-inserted&quot;&lt;/a&gt;,
+    but the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is not the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the parser that created the element, then
+    abort these steps.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li id=script-processing-noscript&gt;
 
     &lt;p&gt;If &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is
@@ -15325,172 +15334,194 @@
   style sheets are blocking which scripts --&gt;
 
   &lt;p&gt;When the user agent is required to &lt;dfn id=execute-the-script-block title=&quot;execute the script
-  block&quot;&gt;execute a script block&lt;/dfn&gt;, it must act as follows:&lt;/p&gt;
+  block&quot;&gt;execute a script block&lt;/dfn&gt;, it must run the following
+  steps:&lt;/p&gt;
 
-  &lt;dl class=switch&gt;&lt;dt&gt;If the load resulted in an error (for example a DNS error, or
-   an HTTP 404 error)&lt;/dt&gt;
+  &lt;ol&gt;&lt;li&gt;
 
-   &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;firing a simple event&lt;/a&gt; named
-   &lt;code title=event-error&gt;error&lt;/code&gt; at the element.&lt;/dd&gt;
+    &lt;p&gt;If the element is flagged as &lt;a href=#parser-inserted&gt;&quot;parser-inserted&quot;&lt;/a&gt;,
+    but the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is not the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the parser that created the element, then
+    abort these steps.&lt;/p&gt;
 
-   &lt;dt&gt;If the load was successful&lt;/dt&gt;
+   &lt;/li&gt;
 
-   &lt;!-- SCRIPT EXEC --&gt;
-   &lt;dd&gt;
+   &lt;li&gt;
 
-    &lt;p&gt;Executing the script block must consists of running the
-    following steps. For the purposes of these steps, the script is
-    considered to be from an &lt;i&gt;external file&lt;/i&gt; if, while the
-    &lt;a href=#prepare-a-script&gt;prepare a script&lt;/a&gt; algorithm above was running for this
-    script, the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element had a &lt;code title=attr-script-src&gt;&lt;a href=#attr-script-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute specified.&lt;/p&gt;
+    &lt;p&gt;Jump to the appropriate set of steps from the list below:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li id=establish-script-block-source&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If the load resulted in an error (for example a DNS error, or
+     an HTTP 404 error)&lt;/dt&gt;
 
-      &lt;p&gt;Initialize &lt;dfn id=&quot;the-script-block's-source&quot;&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt; as
-      follows:&lt;/p&gt;
+     &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;firing a simple event&lt;/a&gt; named
+     &lt;code title=event-error&gt;error&lt;/code&gt; at the element.&lt;/dd&gt;
 
-      &lt;dl class=switch&gt;&lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
+     &lt;dt&gt;If the load was successful&lt;/dt&gt;
 
-       &lt;dd&gt;
+     &lt;!-- SCRIPT EXEC --&gt;
+     &lt;dd&gt;
 
-        &lt;p&gt;The contents of that file, interpreted as string of
-        Unicode characters, are the script source.&lt;/p&gt;
+      &lt;p&gt;Executing the script block must consists of running the
+      following steps. For the purposes of these steps, the script is
+      considered to be from an &lt;i&gt;external file&lt;/i&gt; if, while the
+      &lt;a href=#prepare-a-script&gt;prepare a script&lt;/a&gt; algorithm above was running for
+      this script, the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element had a &lt;code title=attr-script-src&gt;&lt;a href=#attr-script-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute specified.&lt;/p&gt;
 
-        &lt;p&gt;To obtain the string of Unicode characters, the user agent
-        run the following steps:&lt;/p&gt;
+      &lt;ol&gt;&lt;li id=establish-script-block-source&gt;
 
-        &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the resource's &lt;a href=#content-type title=Content-Type&gt;Content
-         Type metadata&lt;/a&gt;, if any, specifies a character encoding,
-         and the user agent supports that encoding, then let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be that encoding, and jump
-         to the bottom step in this series of steps.&lt;/li&gt;
+        &lt;p&gt;Initialize &lt;dfn id=&quot;the-script-block's-source&quot;&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt;
+        as follows:&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;If the algorithm above set &lt;var&gt;&lt;a href=&quot;#the-script-block's-character-encoding&quot;&gt;the script block's
-         character encoding&lt;/a&gt;&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;character
-         encoding&lt;/var&gt; be that encoding, and jump to the bottom step
-         in this series of steps.&lt;/li&gt;
+        &lt;dl class=switch&gt;&lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
+         script block's type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
-         &lt;li&gt;&lt;p&gt;For each of the rows in the following table, starting
-         with the first one and going down, if the file has as many or
-         more bytes available than the number of bytes in the first
-         column, and the first bytes of the file match the bytes given
-         in the first column, then set &lt;var title=&quot;&quot;&gt;character
-         encoding&lt;/var&gt; to the encoding given in the cell in the
-         second column of that row, and jump to the bottom step in
-         this series of steps:&lt;/p&gt;
+         &lt;dd&gt;
 
-          &lt;!-- this table is present in several forms in this file; keep them in sync --&gt;
-          &lt;table id=table-script-bom&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Bytes in Hexadecimal
-             &lt;th&gt;Encoding
-           &lt;tbody&gt;&lt;!-- nobody uses this
-            &lt;tr&gt;
-             &lt;td&gt;00 00 FE FF
-             &lt;td&gt;UTF-32BE
-            &lt;tr&gt;
-             &lt;td&gt;FF FE 00 00
-             &lt;td&gt;UTF-32LE
-  --&gt;&lt;tr&gt;&lt;td&gt;FE FF
-             &lt;td&gt;Big-endian UTF-16
-            &lt;tr&gt;&lt;td&gt;FF FE
-             &lt;td&gt;Little-endian UTF-16
-            &lt;tr&gt;&lt;td&gt;EF BB BF
-             &lt;td&gt;UTF-8
-  &lt;!-- nobody uses this
-            &lt;tr&gt;
-             &lt;td&gt;DD 73 66 73
-             &lt;td&gt;UTF-EBCDIC
-  --&gt;
-          &lt;/table&gt;&lt;p class=note&gt;This step looks for Unicode Byte Order Marks
-          (BOMs).&lt;/p&gt;
+          &lt;p&gt;The contents of that file, interpreted as string of
+          Unicode characters, are the script source.&lt;/p&gt;
 
-         &lt;/li&gt;
+          &lt;p&gt;To obtain the string of Unicode characters, the user
+          agent run the following steps:&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be &lt;var&gt;&lt;a href=&quot;#the-script-block's-fallback-character-encoding&quot;&gt;the
-         script block's fallback character encoding&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the resource's &lt;a href=#content-type title=Content-Type&gt;Content
+           Type metadata&lt;/a&gt;, if any, specifies a character
+           encoding, and the user agent supports that encoding, then
+           let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be that
+           encoding, and jump to the bottom step in this series of
+           steps.&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Convert the file to Unicode using &lt;var&gt;character
-         encoding&lt;/var&gt;, following the rules for doing so given by the
-         specification for &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
-         type&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If the algorithm above set &lt;var&gt;&lt;a href=&quot;#the-script-block's-character-encoding&quot;&gt;the script block's
+           character encoding&lt;/a&gt;&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;character
+           encoding&lt;/var&gt; be that encoding, and jump to the bottom
+           step in this series of steps.&lt;/li&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+           &lt;li&gt;&lt;p&gt;For each of the rows in the following table,
+           starting with the first one and going down, if the file has
+           as many or more bytes available than the number of bytes in
+           the first column, and the first bytes of the file match the
+           bytes given in the first column, then set &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; to the encoding given in
+           the cell in the second column of that row, and jump to the
+           bottom step in this series of steps:&lt;/p&gt;
 
-       &lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
+            &lt;!-- this table is present in several forms in this file; keep them in sync --&gt;
+            &lt;table id=table-script-bom&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Bytes in Hexadecimal
+               &lt;th&gt;Encoding
+             &lt;tbody&gt;&lt;!-- nobody uses this
+              &lt;tr&gt;
+               &lt;td&gt;00 00 FE FF
+               &lt;td&gt;UTF-32BE
+              &lt;tr&gt;
+               &lt;td&gt;FF FE 00 00
+               &lt;td&gt;UTF-32LE
+    --&gt;&lt;tr&gt;&lt;td&gt;FE FF
+               &lt;td&gt;Big-endian UTF-16
+              &lt;tr&gt;&lt;td&gt;FF FE
+               &lt;td&gt;Little-endian UTF-16
+              &lt;tr&gt;&lt;td&gt;EF BB BF
+               &lt;td&gt;UTF-8
+    &lt;!-- nobody uses this
+              &lt;tr&gt;
+               &lt;td&gt;DD 73 66 73
+               &lt;td&gt;UTF-EBCDIC
+    --&gt;
+            &lt;/table&gt;&lt;p class=note&gt;This step looks for Unicode Byte Order
+            Marks (BOMs).&lt;/p&gt;
 
-       &lt;dd&gt;
+           &lt;/li&gt;
 
-        &lt;p&gt;The external file is the script source. When it is later
-        executed, it must be interpreted in a manner consistent with
-        the specification defining the language given by &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
-        script block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be
+           &lt;var&gt;&lt;a href=&quot;#the-script-block's-fallback-character-encoding&quot;&gt;the script block's fallback character
+           encoding&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
 
-       &lt;/dd&gt;
+           &lt;li&gt;&lt;p&gt;Convert the file to Unicode using &lt;var&gt;character
+           encoding&lt;/var&gt;, following the rules for doing so given by
+           the specification for &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
+           type&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
 
-       &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
+          &lt;/ol&gt;&lt;/dd&gt;
 
-       &lt;dd&gt;
+         &lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
+         script block's type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
 
-        &lt;p&gt;The value of the &lt;code title=dom-script-text&gt;&lt;a href=#dom-script-text&gt;text&lt;/a&gt;&lt;/code&gt;
-        IDL attribute at the time the element's &lt;a href=#already-started&gt;&quot;already
-        started&quot;&lt;/a&gt; flag was last set is the script source.&lt;/p&gt;
+         &lt;dd&gt;
 
-       &lt;/dd&gt;
+          &lt;p&gt;The external file is the script source. When it is later
+          executed, it must be interpreted in a manner consistent with
+          the specification defining the language given by &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
+          script block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
+         &lt;/dd&gt;
 
-       &lt;dd&gt;
+         &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
+         type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
-        &lt;p&gt;The child nodes of the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element at the
-        time the element's &lt;a href=#already-started&gt;&quot;already started&quot;&lt;/a&gt; flag was
-        last set are the script source.&lt;/p&gt;
+         &lt;dd&gt;
 
-       &lt;/dd&gt;
+          &lt;p&gt;The value of the &lt;code title=dom-script-text&gt;&lt;a href=#dom-script-text&gt;text&lt;/a&gt;&lt;/code&gt; IDL attribute at the
+          time the element's &lt;a href=#already-started&gt;&quot;already started&quot;&lt;/a&gt; flag was
+          last set is the script source.&lt;/p&gt;
 
-      &lt;/dl&gt;&lt;/li&gt;
+         &lt;/dd&gt;
 
-     &lt;li&gt;
+         &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
+         type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
 
-      &lt;p&gt;If the script is from an external file, then increment the
-      &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes counter&lt;/a&gt; of the
-      &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;. Let &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt; be that
-      &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
+         &lt;dd&gt;
 
-     &lt;/li&gt;
+          &lt;p&gt;The child nodes of the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element at the
+          time the element's &lt;a href=#already-started&gt;&quot;already started&quot;&lt;/a&gt; flag was
+          last set are the script source.&lt;/p&gt;
 
-     &lt;li&gt;
+         &lt;/dd&gt;
 
-      &lt;p&gt;&lt;a href=#create-a-script-from-a-node title=&quot;create a script from a node&quot;&gt;Create a
-      script&lt;/a&gt; from the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element node, using
-      &lt;var&gt;&lt;a href=&quot;#the-script-block's-source&quot;&gt;the script block's source&lt;/a&gt;&lt;/var&gt; and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script
-      block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
+        &lt;/dl&gt;&lt;/li&gt;
 
-      &lt;p class=note&gt;This is where the script is compiled and
-      actually executed.&lt;/p&gt;
+       &lt;li&gt;
 
-     &lt;/li&gt;
+        &lt;p&gt;If the script is from an external file, then increment the
+        &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes counter&lt;/a&gt; of the
+        &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;. Let &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt; be that
+        &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+       &lt;/li&gt;
 
-      &lt;p&gt;Decrement the &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes counter&lt;/a&gt;
-      of &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt;, if it was incremented in
-      the earlier step.&lt;/p&gt;
+       &lt;li&gt;
 
-     &lt;/li&gt;
+        &lt;p&gt;&lt;a href=#create-a-script-from-a-node title=&quot;create a script from a node&quot;&gt;Create a
+        script&lt;/a&gt; from the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element node, using
+        &lt;var&gt;&lt;a href=&quot;#the-script-block's-source&quot;&gt;the script block's source&lt;/a&gt;&lt;/var&gt; and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script
+        block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+        &lt;p class=note&gt;This is where the script is compiled and
+        actually executed.&lt;/p&gt;
 
-      &lt;p&gt;If the script is from an external file, &lt;a href=#fire-a-simple-event&gt;fire a simple
-      event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the
-      &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
+       &lt;/li&gt;
 
-      &lt;p&gt;Otherwise, the script is internal; &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt;
-      to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;
-      element.&lt;/p&gt;
+       &lt;li&gt;
 
-     &lt;/li&gt;
+        &lt;p&gt;Decrement the &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes
+        counter&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt;, if it
+        was incremented in the earlier step.&lt;/p&gt;
 
-    &lt;/ol&gt;&lt;/dd&gt;
+       &lt;/li&gt;
 
-  &lt;/dl&gt;&lt;p&gt;The IDL attributes &lt;dfn id=dom-script-src title=dom-script-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-type title=dom-script-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-charset title=dom-script-charset&gt;&lt;code&gt;charset&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn id=dom-script-defer title=dom-script-defer&gt;&lt;code&gt;defer&lt;/code&gt;&lt;/dfn&gt;, each must
+       &lt;li&gt;
+
+        &lt;p&gt;If the script is from an external file, &lt;a href=#fire-a-simple-event&gt;fire a simple
+        event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the
+        &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
+
+        &lt;p&gt;Otherwise, the script is internal; &lt;a href=#queue-a-task&gt;queue a
+        task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;
+        element.&lt;/p&gt;
+
+       &lt;/li&gt;
+
+      &lt;/ol&gt;&lt;/dd&gt;
+
+    &lt;/dl&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;The IDL attributes &lt;dfn id=dom-script-src title=dom-script-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-type title=dom-script-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-charset title=dom-script-charset&gt;&lt;code&gt;charset&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn id=dom-script-defer title=dom-script-defer&gt;&lt;code&gt;defer&lt;/code&gt;&lt;/dfn&gt;, each must
   &lt;a href=#reflect&gt;reflect&lt;/a&gt; the respective content attributes of the same
   name.&lt;/p&gt;
 

Modified: index
===================================================================
--- index	2011-02-14 10:02:35 UTC (rev 5882)
+++ index	2011-02-14 20:47:46 UTC (rev 5883)
@@ -15041,6 +15041,15 @@
 
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;If the element is flagged as &lt;a href=#parser-inserted&gt;&quot;parser-inserted&quot;&lt;/a&gt;,
+    but the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is not the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the parser that created the element, then
+    abort these steps.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li id=script-processing-noscript&gt;
 
     &lt;p&gt;If &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is
@@ -15305,172 +15314,194 @@
   style sheets are blocking which scripts --&gt;
 
   &lt;p&gt;When the user agent is required to &lt;dfn id=execute-the-script-block title=&quot;execute the script
-  block&quot;&gt;execute a script block&lt;/dfn&gt;, it must act as follows:&lt;/p&gt;
+  block&quot;&gt;execute a script block&lt;/dfn&gt;, it must run the following
+  steps:&lt;/p&gt;
 
-  &lt;dl class=switch&gt;&lt;dt&gt;If the load resulted in an error (for example a DNS error, or
-   an HTTP 404 error)&lt;/dt&gt;
+  &lt;ol&gt;&lt;li&gt;
 
-   &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;firing a simple event&lt;/a&gt; named
-   &lt;code title=event-error&gt;error&lt;/code&gt; at the element.&lt;/dd&gt;
+    &lt;p&gt;If the element is flagged as &lt;a href=#parser-inserted&gt;&quot;parser-inserted&quot;&lt;/a&gt;,
+    but the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is not the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the parser that created the element, then
+    abort these steps.&lt;/p&gt;
 
-   &lt;dt&gt;If the load was successful&lt;/dt&gt;
+   &lt;/li&gt;
 
-   &lt;!-- SCRIPT EXEC --&gt;
-   &lt;dd&gt;
+   &lt;li&gt;
 
-    &lt;p&gt;Executing the script block must consists of running the
-    following steps. For the purposes of these steps, the script is
-    considered to be from an &lt;i&gt;external file&lt;/i&gt; if, while the
-    &lt;a href=#prepare-a-script&gt;prepare a script&lt;/a&gt; algorithm above was running for this
-    script, the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element had a &lt;code title=attr-script-src&gt;&lt;a href=#attr-script-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute specified.&lt;/p&gt;
+    &lt;p&gt;Jump to the appropriate set of steps from the list below:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li id=establish-script-block-source&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If the load resulted in an error (for example a DNS error, or
+     an HTTP 404 error)&lt;/dt&gt;
 
-      &lt;p&gt;Initialize &lt;dfn id=&quot;the-script-block's-source&quot;&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt; as
-      follows:&lt;/p&gt;
+     &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;a href=#fire-a-simple-event title=&quot;fire a simple event&quot;&gt;firing a simple event&lt;/a&gt; named
+     &lt;code title=event-error&gt;error&lt;/code&gt; at the element.&lt;/dd&gt;
 
-      &lt;dl class=switch&gt;&lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
+     &lt;dt&gt;If the load was successful&lt;/dt&gt;
 
-       &lt;dd&gt;
+     &lt;!-- SCRIPT EXEC --&gt;
+     &lt;dd&gt;
 
-        &lt;p&gt;The contents of that file, interpreted as string of
-        Unicode characters, are the script source.&lt;/p&gt;
+      &lt;p&gt;Executing the script block must consists of running the
+      following steps. For the purposes of these steps, the script is
+      considered to be from an &lt;i&gt;external file&lt;/i&gt; if, while the
+      &lt;a href=#prepare-a-script&gt;prepare a script&lt;/a&gt; algorithm above was running for
+      this script, the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element had a &lt;code title=attr-script-src&gt;&lt;a href=#attr-script-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute specified.&lt;/p&gt;
 
-        &lt;p&gt;To obtain the string of Unicode characters, the user agent
-        run the following steps:&lt;/p&gt;
+      &lt;ol&gt;&lt;li id=establish-script-block-source&gt;
 
-        &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the resource's &lt;a href=#content-type title=Content-Type&gt;Content
-         Type metadata&lt;/a&gt;, if any, specifies a character encoding,
-         and the user agent supports that encoding, then let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be that encoding, and jump
-         to the bottom step in this series of steps.&lt;/li&gt;
+        &lt;p&gt;Initialize &lt;dfn id=&quot;the-script-block's-source&quot;&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt;
+        as follows:&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;If the algorithm above set &lt;var&gt;&lt;a href=&quot;#the-script-block's-character-encoding&quot;&gt;the script block's
-         character encoding&lt;/a&gt;&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;character
-         encoding&lt;/var&gt; be that encoding, and jump to the bottom step
-         in this series of steps.&lt;/li&gt;
+        &lt;dl class=switch&gt;&lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
+         script block's type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
-         &lt;li&gt;&lt;p&gt;For each of the rows in the following table, starting
-         with the first one and going down, if the file has as many or
-         more bytes available than the number of bytes in the first
-         column, and the first bytes of the file match the bytes given
-         in the first column, then set &lt;var title=&quot;&quot;&gt;character
-         encoding&lt;/var&gt; to the encoding given in the cell in the
-         second column of that row, and jump to the bottom step in
-         this series of steps:&lt;/p&gt;
+         &lt;dd&gt;
 
-          &lt;!-- this table is present in several forms in this file; keep them in sync --&gt;
-          &lt;table id=table-script-bom&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Bytes in Hexadecimal
-             &lt;th&gt;Encoding
-           &lt;tbody&gt;&lt;!-- nobody uses this
-            &lt;tr&gt;
-             &lt;td&gt;00 00 FE FF
-             &lt;td&gt;UTF-32BE
-            &lt;tr&gt;
-             &lt;td&gt;FF FE 00 00
-             &lt;td&gt;UTF-32LE
-  --&gt;&lt;tr&gt;&lt;td&gt;FE FF
-             &lt;td&gt;Big-endian UTF-16
-            &lt;tr&gt;&lt;td&gt;FF FE
-             &lt;td&gt;Little-endian UTF-16
-            &lt;tr&gt;&lt;td&gt;EF BB BF
-             &lt;td&gt;UTF-8
-  &lt;!-- nobody uses this
-            &lt;tr&gt;
-             &lt;td&gt;DD 73 66 73
-             &lt;td&gt;UTF-EBCDIC
-  --&gt;
-          &lt;/table&gt;&lt;p class=note&gt;This step looks for Unicode Byte Order Marks
-          (BOMs).&lt;/p&gt;
+          &lt;p&gt;The contents of that file, interpreted as string of
+          Unicode characters, are the script source.&lt;/p&gt;
 
-         &lt;/li&gt;
+          &lt;p&gt;To obtain the string of Unicode characters, the user
+          agent run the following steps:&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be &lt;var&gt;&lt;a href=&quot;#the-script-block's-fallback-character-encoding&quot;&gt;the
-         script block's fallback character encoding&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the resource's &lt;a href=#content-type title=Content-Type&gt;Content
+           Type metadata&lt;/a&gt;, if any, specifies a character
+           encoding, and the user agent supports that encoding, then
+           let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be that
+           encoding, and jump to the bottom step in this series of
+           steps.&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Convert the file to Unicode using &lt;var&gt;character
-         encoding&lt;/var&gt;, following the rules for doing so given by the
-         specification for &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
-         type&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If the algorithm above set &lt;var&gt;&lt;a href=&quot;#the-script-block's-character-encoding&quot;&gt;the script block's
+           character encoding&lt;/a&gt;&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;character
+           encoding&lt;/var&gt; be that encoding, and jump to the bottom
+           step in this series of steps.&lt;/li&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+           &lt;li&gt;&lt;p&gt;For each of the rows in the following table,
+           starting with the first one and going down, if the file has
+           as many or more bytes available than the number of bytes in
+           the first column, and the first bytes of the file match the
+           bytes given in the first column, then set &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; to the encoding given in
+           the cell in the second column of that row, and jump to the
+           bottom step in this series of steps:&lt;/p&gt;
 
-       &lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
+            &lt;!-- this table is present in several forms in this file; keep them in sync --&gt;
+            &lt;table id=table-script-bom&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Bytes in Hexadecimal
+               &lt;th&gt;Encoding
+             &lt;tbody&gt;&lt;!-- nobody uses this
+              &lt;tr&gt;
+               &lt;td&gt;00 00 FE FF
+               &lt;td&gt;UTF-32BE
+              &lt;tr&gt;
+               &lt;td&gt;FF FE 00 00
+               &lt;td&gt;UTF-32LE
+    --&gt;&lt;tr&gt;&lt;td&gt;FE FF
+               &lt;td&gt;Big-endian UTF-16
+              &lt;tr&gt;&lt;td&gt;FF FE
+               &lt;td&gt;Little-endian UTF-16
+              &lt;tr&gt;&lt;td&gt;EF BB BF
+               &lt;td&gt;UTF-8
+    &lt;!-- nobody uses this
+              &lt;tr&gt;
+               &lt;td&gt;DD 73 66 73
+               &lt;td&gt;UTF-EBCDIC
+    --&gt;
+            &lt;/table&gt;&lt;p class=note&gt;This step looks for Unicode Byte Order
+            Marks (BOMs).&lt;/p&gt;
 
-       &lt;dd&gt;
+           &lt;/li&gt;
 
-        &lt;p&gt;The external file is the script source. When it is later
-        executed, it must be interpreted in a manner consistent with
-        the specification defining the language given by &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
-        script block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be
+           &lt;var&gt;&lt;a href=&quot;#the-script-block's-fallback-character-encoding&quot;&gt;the script block's fallback character
+           encoding&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
 
-       &lt;/dd&gt;
+           &lt;li&gt;&lt;p&gt;Convert the file to Unicode using &lt;var&gt;character
+           encoding&lt;/var&gt;, following the rules for doing so given by
+           the specification for &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
+           type&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
 
-       &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
+          &lt;/ol&gt;&lt;/dd&gt;
 
-       &lt;dd&gt;
+         &lt;dt&gt;If the script is from an external file and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
+         script block's type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
 
-        &lt;p&gt;The value of the &lt;code title=dom-script-text&gt;&lt;a href=#dom-script-text&gt;text&lt;/a&gt;&lt;/code&gt;
-        IDL attribute at the time the element's &lt;a href=#already-started&gt;&quot;already
-        started&quot;&lt;/a&gt; flag was last set is the script source.&lt;/p&gt;
+         &lt;dd&gt;
 
-       &lt;/dd&gt;
+          &lt;p&gt;The external file is the script source. When it is later
+          executed, it must be interpreted in a manner consistent with
+          the specification defining the language given by &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
+          script block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
+         &lt;/dd&gt;
 
-       &lt;dd&gt;
+         &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
+         type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
-        &lt;p&gt;The child nodes of the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element at the
-        time the element's &lt;a href=#already-started&gt;&quot;already started&quot;&lt;/a&gt; flag was
-        last set are the script source.&lt;/p&gt;
+         &lt;dd&gt;
 
-       &lt;/dd&gt;
+          &lt;p&gt;The value of the &lt;code title=dom-script-text&gt;&lt;a href=#dom-script-text&gt;text&lt;/a&gt;&lt;/code&gt; IDL attribute at the
+          time the element's &lt;a href=#already-started&gt;&quot;already started&quot;&lt;/a&gt; flag was
+          last set is the script source.&lt;/p&gt;
 
-      &lt;/dl&gt;&lt;/li&gt;
+         &lt;/dd&gt;
 
-     &lt;li&gt;
+         &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
+         type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
 
-      &lt;p&gt;If the script is from an external file, then increment the
-      &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes counter&lt;/a&gt; of the
-      &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;. Let &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt; be that
-      &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
+         &lt;dd&gt;
 
-     &lt;/li&gt;
+          &lt;p&gt;The child nodes of the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element at the
+          time the element's &lt;a href=#already-started&gt;&quot;already started&quot;&lt;/a&gt; flag was
+          last set are the script source.&lt;/p&gt;
 
-     &lt;li&gt;
+         &lt;/dd&gt;
 
-      &lt;p&gt;&lt;a href=#create-a-script-from-a-node title=&quot;create a script from a node&quot;&gt;Create a
-      script&lt;/a&gt; from the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element node, using
-      &lt;var&gt;&lt;a href=&quot;#the-script-block's-source&quot;&gt;the script block's source&lt;/a&gt;&lt;/var&gt; and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script
-      block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
+        &lt;/dl&gt;&lt;/li&gt;
 
-      &lt;p class=note&gt;This is where the script is compiled and
-      actually executed.&lt;/p&gt;
+       &lt;li&gt;
 
-     &lt;/li&gt;
+        &lt;p&gt;If the script is from an external file, then increment the
+        &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes counter&lt;/a&gt; of the
+        &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;. Let &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt; be that
+        &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+       &lt;/li&gt;
 
-      &lt;p&gt;Decrement the &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes counter&lt;/a&gt;
-      of &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt;, if it was incremented in
-      the earlier step.&lt;/p&gt;
+       &lt;li&gt;
 
-     &lt;/li&gt;
+        &lt;p&gt;&lt;a href=#create-a-script-from-a-node title=&quot;create a script from a node&quot;&gt;Create a
+        script&lt;/a&gt; from the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element node, using
+        &lt;var&gt;&lt;a href=&quot;#the-script-block's-source&quot;&gt;the script block's source&lt;/a&gt;&lt;/var&gt; and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script
+        block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+        &lt;p class=note&gt;This is where the script is compiled and
+        actually executed.&lt;/p&gt;
 
-      &lt;p&gt;If the script is from an external file, &lt;a href=#fire-a-simple-event&gt;fire a simple
-      event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the
-      &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
+       &lt;/li&gt;
 
-      &lt;p&gt;Otherwise, the script is internal; &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt;
-      to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;
-      element.&lt;/p&gt;
+       &lt;li&gt;
 
-     &lt;/li&gt;
+        &lt;p&gt;Decrement the &lt;a href=#ignore-destructive-writes-counter&gt;ignore-destructive-writes
+        counter&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt;, if it
+        was incremented in the earlier step.&lt;/p&gt;
 
-    &lt;/ol&gt;&lt;/dd&gt;
+       &lt;/li&gt;
 
-  &lt;/dl&gt;&lt;p&gt;The IDL attributes &lt;dfn id=dom-script-src title=dom-script-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-type title=dom-script-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-charset title=dom-script-charset&gt;&lt;code&gt;charset&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn id=dom-script-defer title=dom-script-defer&gt;&lt;code&gt;defer&lt;/code&gt;&lt;/dfn&gt;, each must
+       &lt;li&gt;
+
+        &lt;p&gt;If the script is from an external file, &lt;a href=#fire-a-simple-event&gt;fire a simple
+        event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the
+        &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
+
+        &lt;p&gt;Otherwise, the script is internal; &lt;a href=#queue-a-task&gt;queue a
+        task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=event-load&gt;load&lt;/code&gt; at the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;
+        element.&lt;/p&gt;
+
+       &lt;/li&gt;
+
+      &lt;/ol&gt;&lt;/dd&gt;
+
+    &lt;/dl&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;The IDL attributes &lt;dfn id=dom-script-src title=dom-script-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-type title=dom-script-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-script-charset title=dom-script-charset&gt;&lt;code&gt;charset&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn id=dom-script-defer title=dom-script-defer&gt;&lt;code&gt;defer&lt;/code&gt;&lt;/dfn&gt;, each must
   &lt;a href=#reflect&gt;reflect&lt;/a&gt; the respective content attributes of the same
   name.&lt;/p&gt;
 

Modified: source
===================================================================
--- source	2011-02-14 10:02:35 UTC (rev 5882)
+++ source	2011-02-14 20:47:46 UTC (rev 5883)
@@ -15970,6 +15970,15 @@
 
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;If the element is flagged as &lt;span&gt;&quot;parser-inserted&quot;&lt;/span&gt;,
+    but the element's &lt;code&gt;Document&lt;/code&gt; is not the
+    &lt;code&gt;Document&lt;/code&gt; of the parser that created the element, then
+    abort these steps.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li id=&quot;script-processing-noscript&quot;&gt;
 
     &lt;p&gt;If &lt;span title=&quot;concept-n-noscript&quot;&gt;scripting is
@@ -16271,202 +16280,229 @@
   style sheets are blocking which scripts --&gt;
 
   &lt;p&gt;When the user agent is required to &lt;dfn title=&quot;execute the script
-  block&quot;&gt;execute a script block&lt;/dfn&gt;, it must act as follows:&lt;/p&gt;
+  block&quot;&gt;execute a script block&lt;/dfn&gt;, it must run the following
+  steps:&lt;/p&gt;
 
-  &lt;dl class=&quot;switch&quot;&gt;
+  &lt;ol&gt;
 
-   &lt;dt&gt;If the load resulted in an error (for example a DNS error, or
-   an HTTP 404 error)&lt;/dt&gt;
+   &lt;li&gt;
 
-   &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;span
-   title=&quot;fire a simple event&quot;&gt;firing a simple event&lt;/span&gt; named
-   &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the element.&lt;/p&gt;&lt;/dd&gt;
+    &lt;p&gt;If the element is flagged as &lt;span&gt;&quot;parser-inserted&quot;&lt;/span&gt;,
+    but the element's &lt;code&gt;Document&lt;/code&gt; is not the
+    &lt;code&gt;Document&lt;/code&gt; of the parser that created the element, then
+    abort these steps.&lt;/p&gt;
 
-   &lt;dt&gt;If the load was successful&lt;/dt&gt;
+   &lt;/li&gt;
 
-   &lt;!-- SCRIPT EXEC --&gt;
-   &lt;dd&gt;
+   &lt;li&gt;
 
-    &lt;p&gt;Executing the script block must consists of running the
-    following steps. For the purposes of these steps, the script is
-    considered to be from an &lt;i&gt;external file&lt;/i&gt; if, while the
-    &lt;span&gt;prepare a script&lt;/span&gt; algorithm above was running for this
-    script, the &lt;code&gt;script&lt;/code&gt; element had a &lt;code
-    title=&quot;attr-script-src&quot;&gt;src&lt;/code&gt; attribute specified.&lt;/p&gt;
+    &lt;p&gt;Jump to the appropriate set of steps from the list below:&lt;/p&gt;
 
-    &lt;ol&gt;
+    &lt;dl class=&quot;switch&quot;&gt;
 
-     &lt;li id=&quot;establish-script-block-source&quot;&gt;
+     &lt;dt&gt;If the load resulted in an error (for example a DNS error, or
+     an HTTP 404 error)&lt;/dt&gt;
 
-      &lt;p&gt;Initialize &lt;dfn&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt; as
-      follows:&lt;/p&gt;
+     &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;span
+     title=&quot;fire a simple event&quot;&gt;firing a simple event&lt;/span&gt; named
+     &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the element.&lt;/p&gt;&lt;/dd&gt;
 
-      &lt;dl class=&quot;switch&quot;&gt;
+     &lt;dt&gt;If the load was successful&lt;/dt&gt;
 
-       &lt;dt&gt;If the script is from an external file and &lt;var&gt;the script block's type&lt;/var&gt; is a text-based language&lt;/dt&gt;
+     &lt;!-- SCRIPT EXEC --&gt;
+     &lt;dd&gt;
 
-       &lt;dd&gt;
+      &lt;p&gt;Executing the script block must consists of running the
+      following steps. For the purposes of these steps, the script is
+      considered to be from an &lt;i&gt;external file&lt;/i&gt; if, while the
+      &lt;span&gt;prepare a script&lt;/span&gt; algorithm above was running for
+      this script, the &lt;code&gt;script&lt;/code&gt; element had a &lt;code
+      title=&quot;attr-script-src&quot;&gt;src&lt;/code&gt; attribute specified.&lt;/p&gt;
 
-        &lt;p&gt;The contents of that file, interpreted as string of
-        Unicode characters, are the script source.&lt;/p&gt;
+      &lt;ol&gt;
 
-        &lt;p&gt;To obtain the string of Unicode characters, the user agent
-        run the following steps:&lt;/p&gt;
+       &lt;li id=&quot;establish-script-block-source&quot;&gt;
 
-        &lt;ol&gt;
+        &lt;p&gt;Initialize &lt;dfn&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt;
+        as follows:&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;If the resource's &lt;span title=&quot;Content-Type&quot;&gt;Content
-         Type metadata&lt;/span&gt;, if any, specifies a character encoding,
-         and the user agent supports that encoding, then let &lt;var
-         title=&quot;&quot;&gt;character encoding&lt;/var&gt; be that encoding, and jump
-         to the bottom step in this series of steps.&lt;/p&gt;&lt;/li&gt;
+        &lt;dl class=&quot;switch&quot;&gt;
 
-         &lt;li&gt;&lt;p&gt;If the algorithm above set &lt;var&gt;the script block's
-         character encoding&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;character
-         encoding&lt;/var&gt; be that encoding, and jump to the bottom step
-         in this series of steps.&lt;/p&gt;&lt;/li&gt;
+         &lt;dt&gt;If the script is from an external file and &lt;var&gt;the
+         script block's type&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
-         &lt;li&gt;&lt;p&gt;For each of the rows in the following table, starting
-         with the first one and going down, if the file has as many or
-         more bytes available than the number of bytes in the first
-         column, and the first bytes of the file match the bytes given
-         in the first column, then set &lt;var title=&quot;&quot;&gt;character
-         encoding&lt;/var&gt; to the encoding given in the cell in the
-         second column of that row, and jump to the bottom step in
-         this series of steps:&lt;/p&gt;
+         &lt;dd&gt;
 
-          &lt;!-- this table is present in several forms in this file; keep them in sync --&gt;
-          &lt;table id=&quot;table-script-bom&quot;&gt;
-           &lt;thead&gt;
-            &lt;tr&gt;
-             &lt;th&gt;Bytes in Hexadecimal
-             &lt;th&gt;Encoding
-           &lt;tbody&gt;
-  &lt;!-- nobody uses this
-            &lt;tr&gt;
-             &lt;td&gt;00 00 FE FF
-             &lt;td&gt;UTF-32BE
-            &lt;tr&gt;
-             &lt;td&gt;FF FE 00 00
-             &lt;td&gt;UTF-32LE
-  --&gt;
-            &lt;tr&gt;
-             &lt;td&gt;FE FF
-             &lt;td&gt;Big-endian UTF-16
-            &lt;tr&gt;
-             &lt;td&gt;FF FE
-             &lt;td&gt;Little-endian UTF-16
-            &lt;tr&gt;
-             &lt;td&gt;EF BB BF
-             &lt;td&gt;UTF-8
-  &lt;!-- nobody uses this
-            &lt;tr&gt;
-             &lt;td&gt;DD 73 66 73
-             &lt;td&gt;UTF-EBCDIC
-  --&gt;
-          &lt;/table&gt;
+          &lt;p&gt;The contents of that file, interpreted as string of
+          Unicode characters, are the script source.&lt;/p&gt;
 
-          &lt;p class=&quot;note&quot;&gt;This step looks for Unicode Byte Order Marks
-          (BOMs).&lt;/p&gt;
+          &lt;p&gt;To obtain the string of Unicode characters, the user
+          agent run the following steps:&lt;/p&gt;
 
-         &lt;/li&gt;
+          &lt;ol&gt;
 
-         &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be &lt;var&gt;the
-         script block's fallback character encoding&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If the resource's &lt;span title=&quot;Content-Type&quot;&gt;Content
+           Type metadata&lt;/span&gt;, if any, specifies a character
+           encoding, and the user agent supports that encoding, then
+           let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be that
+           encoding, and jump to the bottom step in this series of
+           steps.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Convert the file to Unicode using &lt;var&gt;character
-         encoding&lt;/var&gt;, following the rules for doing so given by the
-         specification for &lt;var&gt;the script block's
-         type&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If the algorithm above set &lt;var&gt;the script block's
+           character encoding&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;character
+           encoding&lt;/var&gt; be that encoding, and jump to the bottom
+           step in this series of steps.&lt;/p&gt;&lt;/li&gt;
 
-        &lt;/ol&gt;
+           &lt;li&gt;&lt;p&gt;For each of the rows in the following table,
+           starting with the first one and going down, if the file has
+           as many or more bytes available than the number of bytes in
+           the first column, and the first bytes of the file match the
+           bytes given in the first column, then set &lt;var
+           title=&quot;&quot;&gt;character encoding&lt;/var&gt; to the encoding given in
+           the cell in the second column of that row, and jump to the
+           bottom step in this series of steps:&lt;/p&gt;
 
-       &lt;/dd&gt;
+            &lt;!-- this table is present in several forms in this file; keep them in sync --&gt;
+            &lt;table id=&quot;table-script-bom&quot;&gt;
+             &lt;thead&gt;
+              &lt;tr&gt;
+               &lt;th&gt;Bytes in Hexadecimal
+               &lt;th&gt;Encoding
+             &lt;tbody&gt;
+    &lt;!-- nobody uses this
+              &lt;tr&gt;
+               &lt;td&gt;00 00 FE FF
+               &lt;td&gt;UTF-32BE
+              &lt;tr&gt;
+               &lt;td&gt;FF FE 00 00
+               &lt;td&gt;UTF-32LE
+    --&gt;
+              &lt;tr&gt;
+               &lt;td&gt;FE FF
+               &lt;td&gt;Big-endian UTF-16
+              &lt;tr&gt;
+               &lt;td&gt;FF FE
+               &lt;td&gt;Little-endian UTF-16
+              &lt;tr&gt;
+               &lt;td&gt;EF BB BF
+               &lt;td&gt;UTF-8
+    &lt;!-- nobody uses this
+              &lt;tr&gt;
+               &lt;td&gt;DD 73 66 73
+               &lt;td&gt;UTF-EBCDIC
+    --&gt;
+            &lt;/table&gt;
 
-       &lt;dt&gt;If the script is from an external file and &lt;var&gt;the script block's type&lt;/var&gt; is an XML-based language&lt;/dt&gt;
+            &lt;p class=&quot;note&quot;&gt;This step looks for Unicode Byte Order
+            Marks (BOMs).&lt;/p&gt;
 
-       &lt;dd&gt;
+           &lt;/li&gt;
 
-        &lt;p&gt;The external file is the script source. When it is later
-        executed, it must be interpreted in a manner consistent with
-        the specification defining the language given by &lt;var&gt;the
-        script block's type&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be
+           &lt;var&gt;the script block's fallback character
+           encoding&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;/dd&gt;
+           &lt;li&gt;&lt;p&gt;Convert the file to Unicode using &lt;var&gt;character
+           encoding&lt;/var&gt;, following the rules for doing so given by
+           the specification for &lt;var&gt;the script block's
+           type&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;dt&gt;If the script is inline and &lt;var&gt;the script block's type&lt;/var&gt; is a text-based language&lt;/dt&gt;
+          &lt;/ol&gt;
 
-       &lt;dd&gt;
+         &lt;/dd&gt;
 
-        &lt;p&gt;The value of the &lt;code title=&quot;dom-script-text&quot;&gt;text&lt;/code&gt;
-        IDL attribute at the time the element's &lt;span&gt;&quot;already
-        started&quot;&lt;/span&gt; flag was last set is the script source.&lt;/p&gt;
+         &lt;dt&gt;If the script is from an external file and &lt;var&gt;the
+         script block's type&lt;/var&gt; is an XML-based language&lt;/dt&gt;
 
-       &lt;/dd&gt;
+         &lt;dd&gt;
 
-       &lt;dt&gt;If the script is inline and &lt;var&gt;the script block's type&lt;/var&gt; is an XML-based language&lt;/dt&gt;
+          &lt;p&gt;The external file is the script source. When it is later
+          executed, it must be interpreted in a manner consistent with
+          the specification defining the language given by &lt;var&gt;the
+          script block's type&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;dd&gt;
+         &lt;/dd&gt;
 
-        &lt;p&gt;The child nodes of the &lt;code&gt;script&lt;/code&gt; element at the
-        time the element's &lt;span&gt;&quot;already started&quot;&lt;/span&gt; flag was
-        last set are the script source.&lt;/p&gt;
+         &lt;dt&gt;If the script is inline and &lt;var&gt;the script block's
+         type&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
-       &lt;/dd&gt;
+         &lt;dd&gt;
 
-      &lt;/dl&gt;
+          &lt;p&gt;The value of the &lt;code
+          title=&quot;dom-script-text&quot;&gt;text&lt;/code&gt; IDL attribute at the
+          time the element's &lt;span&gt;&quot;already started&quot;&lt;/span&gt; flag was
+          last set is the script source.&lt;/p&gt;
 
-     &lt;/li&gt;
+         &lt;/dd&gt;
 
-     &lt;li&gt;
+         &lt;dt&gt;If the script is inline and &lt;var&gt;the script block's
+         type&lt;/var&gt; is an XML-based language&lt;/dt&gt;
 
-      &lt;p&gt;If the script is from an external file, then increment the
-      &lt;span&gt;ignore-destructive-writes counter&lt;/span&gt; of the
-      &lt;code&gt;script&lt;/code&gt; element's &lt;code&gt;Document&lt;/code&gt;. Let &lt;var
-      title=&quot;&quot;&gt;neutralized doc&lt;/var&gt; be that
-      &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
+         &lt;dd&gt;
 
-     &lt;/li&gt;
+          &lt;p&gt;The child nodes of the &lt;code&gt;script&lt;/code&gt; element at the
+          time the element's &lt;span&gt;&quot;already started&quot;&lt;/span&gt; flag was
+          last set are the script source.&lt;/p&gt;
 
-     &lt;li&gt;
+         &lt;/dd&gt;
 
-      &lt;p&gt;&lt;span title=&quot;create a script from a node&quot;&gt;Create a
-      script&lt;/span&gt; from the &lt;code&gt;script&lt;/code&gt; element node, using
-      &lt;var&gt;the script block's source&lt;/var&gt; and &lt;var&gt;the script
-      block's type&lt;/var&gt;.&lt;/p&gt;
+        &lt;/dl&gt;
 
-      &lt;p class=&quot;note&quot;&gt;This is where the script is compiled and
-      actually executed.&lt;/p&gt;
+       &lt;/li&gt;
 
-     &lt;/li&gt;
+       &lt;li&gt;
 
-     &lt;li&gt;
+        &lt;p&gt;If the script is from an external file, then increment the
+        &lt;span&gt;ignore-destructive-writes counter&lt;/span&gt; of the
+        &lt;code&gt;script&lt;/code&gt; element's &lt;code&gt;Document&lt;/code&gt;. Let &lt;var
+        title=&quot;&quot;&gt;neutralized doc&lt;/var&gt; be that
+        &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Decrement the &lt;span&gt;ignore-destructive-writes counter&lt;/span&gt;
-      of &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt;, if it was incremented in
-      the earlier step.&lt;/p&gt;
+       &lt;/li&gt;
 
-     &lt;/li&gt;
+       &lt;li&gt;
 
-     &lt;li&gt;
+        &lt;p&gt;&lt;span title=&quot;create a script from a node&quot;&gt;Create a
+        script&lt;/span&gt; from the &lt;code&gt;script&lt;/code&gt; element node, using
+        &lt;var&gt;the script block's source&lt;/var&gt; and &lt;var&gt;the script
+        block's type&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p&gt;If the script is from an external file, &lt;span&gt;fire a simple
-      event&lt;/span&gt; named &lt;code title=&quot;event-load&quot;&gt;load&lt;/code&gt; at the
-      &lt;code&gt;script&lt;/code&gt; element.&lt;/p&gt;
+        &lt;p class=&quot;note&quot;&gt;This is where the script is compiled and
+        actually executed.&lt;/p&gt;
 
-      &lt;p&gt;Otherwise, the script is internal; &lt;span&gt;queue a task&lt;/span&gt;
-      to &lt;span&gt;fire a simple event&lt;/span&gt; named &lt;code
-      title=&quot;event-load&quot;&gt;load&lt;/code&gt; at the &lt;code&gt;script&lt;/code&gt;
-      element.&lt;/p&gt;
+       &lt;/li&gt;
 
-     &lt;/li&gt;
+       &lt;li&gt;
 
-    &lt;/ol&gt;
+        &lt;p&gt;Decrement the &lt;span&gt;ignore-destructive-writes
+        counter&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;neutralized doc&lt;/var&gt;, if it
+        was incremented in the earlier step.&lt;/p&gt;
 
-   &lt;/dd&gt;
+       &lt;/li&gt;
 
-  &lt;/dl&gt;
+       &lt;li&gt;
 
+        &lt;p&gt;If the script is from an external file, &lt;span&gt;fire a simple
+        event&lt;/span&gt; named &lt;code title=&quot;event-load&quot;&gt;load&lt;/code&gt; at the
+        &lt;code&gt;script&lt;/code&gt; element.&lt;/p&gt;
+
+        &lt;p&gt;Otherwise, the script is internal; &lt;span&gt;queue a
+        task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt; named &lt;code
+        title=&quot;event-load&quot;&gt;load&lt;/code&gt; at the &lt;code&gt;script&lt;/code&gt;
+        element.&lt;/p&gt;
+
+       &lt;/li&gt;
+
+      &lt;/ol&gt;
+
+     &lt;/dd&gt;
+
+    &lt;/dl&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;
+
   &lt;p&gt;The IDL attributes &lt;dfn
   title=&quot;dom-script-src&quot;&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn
   title=&quot;dom-script-type&quot;&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012749.html">[html5] r5882 - [e] (0) typo
</A></li>
	<LI>Next message: <A HREF="012751.html">[html5] r5884 - [e] (0) clarify 'attribute' in a few cases where it	could be confusing.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12750">[ date ]</a>
              <a href="thread.html#12750">[ thread ]</a>
              <a href="subject.html#12750">[ subject ]</a>
              <a href="author.html#12750">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
