<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r6125 - [giow] (0) updated drawFocusRing to take recent	feedback into account
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r6125%20-%20%5Bgiow%5D%20%280%29%20updated%20drawFocusRing%20to%20take%20recent%0A%09feedback%20into%20account&In-Reply-To=%3C20110511000846.82D2D11C7C007%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012991.html">
   <LINK REL="Next"  HREF="012993.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r6125 - [giow] (0) updated drawFocusRing to take recent	feedback into account</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r6125%20-%20%5Bgiow%5D%20%280%29%20updated%20drawFocusRing%20to%20take%20recent%0A%09feedback%20into%20account&In-Reply-To=%3C20110511000846.82D2D11C7C007%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r6125 - [giow] (0) updated drawFocusRing to take recent	feedback into account">whatwg at whatwg.org
       </A><BR>
    <I>Tue May 10 17:08:46 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="012991.html">[html5] r6124 - [e] (0) notes
</A></li>
        <LI>Next message: <A HREF="012993.html">[html5] r6126 - [e] (0) highlight more text in the example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12992">[ date ]</a>
              <a href="thread.html#12992">[ thread ]</a>
              <a href="subject.html#12992">[ subject ]</a>
              <a href="author.html#12992">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2011-05-10 17:08:45 -0700 (Tue, 10 May 2011)
New Revision: 6125

Modified:
   complete.html
   index
   source
Log:
[giow] (0) updated drawFocusRing to take recent feedback into account

Modified: complete.html
===================================================================
--- complete.html	2011-05-09 22:22:16 UTC (rev 6124)
+++ complete.html	2011-05-11 00:08:45 UTC (rev 6125)
@@ -239,7 +239,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG height=101 src=/images/logo width=101&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1&gt;Web Applications 1.0&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 9 May 2011&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 10 May 2011&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;!--&lt;p class=&quot;impl&quot;&gt;&lt;strong&gt;Implementors!&lt;/strong&gt; We have a &lt;a href=&quot;<A HREF="http://www.whatwg.org/mailing-list#implementors">http://www.whatwg.org/mailing-list#implementors</A>&quot;&gt;mailing list&lt;/a&gt; for you too!&lt;/p&gt;--&gt;
@@ -634,11 +634,11 @@
          &lt;li&gt;&lt;a href=#shadows&gt;&lt;span class=secno&gt;4.8.11.1.6 &lt;/span&gt;Shadows&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=#simple-shapes-(rectangles)&gt;&lt;span class=secno&gt;4.8.11.1.7 &lt;/span&gt;Simple shapes (rectangles)&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=#complex-shapes-(paths)&gt;&lt;span class=secno&gt;4.8.11.1.8 &lt;/span&gt;Complex shapes (paths)&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#focus-management-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Focus management&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#text-0&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Text&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#images&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;Images&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;Pixel manipulation&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;Drawing model&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#text-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Text&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#images&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Images&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;Pixel manipulation&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;Drawing model&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#best-practices&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;Best practices&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=#examples&gt;&lt;span class=secno&gt;4.8.11.1.14 &lt;/span&gt;Examples&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#color-spaces-and-color-correction&gt;&lt;span class=secno&gt;4.8.11.2 &lt;/span&gt;Color spaces and color correction&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#security-with-canvas-elements&gt;&lt;span class=secno&gt;4.8.11.3 &lt;/span&gt;Security with &lt;code&gt;canvas&lt;/code&gt; elements&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
@@ -34134,7 +34134,7 @@
 
   &lt;h5 id=2dcontext&gt;&lt;span class=secno&gt;4.8.11.1 &lt;/span&gt;The 2D context&lt;/h5&gt;
 
-  &lt;!-- v2: we're on v4. suggestions for next version are marked v5. --&gt;
+  &lt;!-- v2: we're on v4.1. suggestions for next version are marked v5. --&gt;
 
   
 
@@ -34230,12 +34230,12 @@
   void &lt;a href=#dom-context-2d-arc title=dom-context-2d-arc&gt;arc&lt;/a&gt;(in double x, in double y, in double radius, in double startAngle, in double endAngle, in optional boolean anticlockwise);
   void &lt;a href=#dom-context-2d-fill title=dom-context-2d-fill&gt;fill&lt;/a&gt;();
   void &lt;a href=#dom-context-2d-stroke title=dom-context-2d-stroke&gt;stroke&lt;/a&gt;();
+  void &lt;a href=#dom-context-2d-drawosfocusring title=dom-context-2d-drawOSFocusRing&gt;drawOSFocusRing&lt;/a&gt;(in &lt;a href=#element&gt;Element&lt;/a&gt; element);
+  boolean &lt;a href=#dom-context-2d-drawcustomfocusring title=dom-context-2d-drawCustomFocusRing&gt;drawCustomFocusRing&lt;/a&gt;(in &lt;a href=#element&gt;Element&lt;/a&gt; element);
+  void &lt;a href=#dom-context-2d-scrollpathintoview title=dom-context-2d-scrollPathIntoView&gt;scrollPathIntoView&lt;/a&gt;();
   void &lt;a href=#dom-context-2d-clip title=dom-context-2d-clip&gt;clip&lt;/a&gt;();
   boolean &lt;a href=#dom-context-2d-ispointinpath title=dom-context-2d-isPointInPath&gt;isPointInPath&lt;/a&gt;(in double x, in double y);
 
-  // focus management
-  boolean &lt;a href=#dom-context-2d-drawfocusring title=dom-context-2d-drawFocusRing&gt;drawFocusRing&lt;/a&gt;(in &lt;a href=#element&gt;Element&lt;/a&gt; element, in double xCaret, in double yCaret, in optional boolean canDrawCustom);
-
   // text
            attribute DOMString &lt;a href=#dom-context-2d-font title=dom-context-2d-font&gt;font&lt;/a&gt;; // (default 10px sans-serif)
            attribute DOMString &lt;a href=#dom-context-2d-textalign title=dom-context-2d-textAlign&gt;textAlign&lt;/a&gt;; // &quot;start&quot;, &quot;end&quot;, &quot;left&quot;, &quot;right&quot;, &quot;center&quot; (default: &quot;start&quot;)
@@ -35550,6 +35550,42 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-drawOSFocusRing&gt;&lt;a href=#dom-context-2d-drawosfocusring&gt;drawOSFocusRing&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;If the given element is focused, draws a focus ring around the
+    current path, following the platform conventions for focus
+    rings.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;shouldDraw&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-drawCustomFocusRing&gt;&lt;a href=#dom-context-2d-drawcustomfocusring&gt;drawCustomFocusRing&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;If the given element is focused, and the user has configured
+    his system to draw focus rings in a particular manner (for
+    example, high contrast focus rings), draws a focus ring around the
+    current path and returns false.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, returns true if the given element is focused, and
+    false otherwise. This can thus be used to determine when to draw a
+    focus ring (see &lt;a href=#drawCustomFocusRingExample&gt;the
+    example&lt;/a&gt; below).&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-scrollPathIntoView&gt;&lt;a href=#dom-context-2d-scrollpathintoview&gt;scrollPathIntoView&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Scrolls the current path into view. This is especially useful
+    on devices with small screens, where the whole canvas might not be
+    visible at once.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-clip&gt;&lt;a href=#dom-context-2d-clip&gt;clip&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -35752,8 +35788,100 @@
   &lt;p&gt;Zero-length line segments must be pruned before stroking a
   path. Empty subpaths must be ignored.&lt;/p&gt;
 
+  &lt;hr&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-drawosfocusring title=dom-context-2d-drawOSFocusRing&gt;&lt;code&gt;drawOSFocusRing(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked,
+  must run the following steps:&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn id=dom-context-2d-clip title=dom-context-2d-clip&gt;&lt;code&gt;clip()&lt;/code&gt;&lt;/dfn&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; is not focused or is not a
+   descendant of the element with whose context the method is
+   associated, then abort these steps.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If the user has requested the use of particular focus rings
+    (e.g. high-contrast focus rings), or if the &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; would have a focus ring drawn around it,
+    then draw a focus ring of the appropriate style along the path,
+    following platform conventions, and abort these steps.&lt;/p&gt;
+
+    &lt;p class=note&gt;Some platforms only draw focus rings around
+    elements that have been focused from the keyboard, and not those
+    focused from the mouse. Other platforms simply don't draw focus
+    rings around some elements at all unless relevant accessibility
+    features are enabled. This API is intended to follow these
+    conventions.&lt;/p&gt;
+
+    &lt;p&gt;The focus ring should not be subject to the &lt;a href=#shadows title=shadows&gt;shadow effects&lt;/a&gt;, the &lt;a href=#dom-context-2d-globalalpha title=dom-context-2d-globalAlpha&gt;global alpha&lt;/a&gt;, or the &lt;a href=#dom-context-2d-globalcompositeoperation title=dom-context-2d-globalCompositeOperation&gt;global composition
+    operators&lt;/a&gt;, but &lt;em&gt;should&lt;/em&gt; be subject to the &lt;a href=#clipping-region title=&quot;clipping region&quot;&gt;clipping region&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Optionally, &lt;a href=#inform&gt;inform the user&lt;/a&gt; that the
+    focus is at the location given by the path. User agents may wait
+    until the next time the &lt;a href=#event-loop&gt;event loop&lt;/a&gt; reaches its
+    &quot;update the rendering&quot; step to optionally inform the user.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-drawcustomfocusring title=dom-context-2d-drawCustomFocusRing&gt;&lt;code&gt;drawCustomFocusRing(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked, must run
+  the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; is not focused or is not a
+   descendant of the element with whose context the method is
+   associated, then return false and abort these steps.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If the user has requested the use of particular focus rings
+    (e.g. high-contrast focus rings), then draw a focus ring of the
+    appropriate style along the path, return false, and abort these
+    steps.&lt;/p&gt;
+
+    &lt;p&gt;The focus ring should not be subject to the &lt;a href=#shadows title=shadows&gt;shadow effects&lt;/a&gt;, the &lt;a href=#dom-context-2d-globalalpha title=dom-context-2d-globalAlpha&gt;global alpha&lt;/a&gt;, or the &lt;a href=#dom-context-2d-globalcompositeoperation title=dom-context-2d-globalCompositeOperation&gt;global composition
+    operators&lt;/a&gt;, but &lt;em&gt;should&lt;/em&gt; be subject to the &lt;a href=#clipping-region title=&quot;clipping region&quot;&gt;clipping region&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Optionally, &lt;a href=#inform&gt;inform the user&lt;/a&gt; that the
+    focus is at the location given by the path. User agents may wait
+    until the next time the &lt;a href=#event-loop&gt;event loop&lt;/a&gt; reaches its
+    &quot;update the rendering&quot; step to optionally inform the user.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return true.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-scrollpathintoview title=dom-context-2d-scrollPathIntoView&gt;&lt;code&gt;scrollPathIntoView()&lt;/code&gt;&lt;/dfn&gt;
+  method, when invoked, must run the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;notional child&lt;/var&gt; be a hypothetical
+   element that is a rendered child of the &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element
+   whose dimensions are exactly the rectangle of the bounding box of
+   the current path.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;span title=&quot;scroll an element into view&quot;&gt;Scroll &lt;var title=&quot;&quot;&gt;notional child&lt;/var&gt; into view&lt;/span&gt; with the &lt;var title=&quot;&quot;&gt;align to top flag&lt;/var&gt; set.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;Optionally, &lt;a href=#inform&gt;inform the user&lt;/a&gt; that the
+   caret and/or selection cover &lt;var title=&quot;&quot;&gt;the specified
+   rectangle&lt;/var&gt; of the canvas. User agents may wait until the next
+   time the &lt;a href=#event-loop&gt;event loop&lt;/a&gt; reaches its &quot;update the rendering&quot;
+   step to optionally inform the user.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p class=note id=inform&gt;&quot;Inform the user&quot;, as used in this
+  section, could mean calling a system accessibility API, which would
+  notify assistive technologies such as magnification tools. To
+  properly drive magnification based on a focus change, a system
+  accessibility API driving a screen magnifier needs the bounds for
+  the newly focused object. The methods above are intended to enable
+  this by allowing the user agent to report the bounding box of the
+  path used to render the focus ring as the bounds of the &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; element passed as an argument, if that
+  element is focused, and the bounding box of the area to which the
+  user agent is scrolling as the bounding box of the current
+  selection.&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-clip title=dom-context-2d-clip&gt;&lt;code&gt;clip()&lt;/code&gt;&lt;/dfn&gt;
   method must create a new &lt;dfn id=clipping-region&gt;clipping region&lt;/dfn&gt; by calculating
   the intersection of the current clipping region and the area
   described by the current path, using the non-zero winding number
@@ -35772,8 +35900,7 @@
     * support ways of resetting the clipping region without save/restore
   --&gt;
 
-
-  &lt;p&gt;The &lt;dfn id=dom-context-2d-ispointinpath title=dom-context-2d-isPointInPath&gt;&lt;code&gt;isPointInPath(&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must
+  &lt;hr&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-ispointinpath title=dom-context-2d-isPointInPath&gt;&lt;code&gt;isPointInPath(&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must
   return true if the point given by the &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; coordinates passed to the method, when treated as
   coordinates in the canvas coordinate space unaffected by the current
   transformation, is inside the current path as determined by the
@@ -35785,110 +35912,41 @@
   &lt;/div&gt;
 
 
-  &lt;h6 id=focus-management-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Focus management&lt;/h6&gt; &lt;!-- a v4 feature --&gt;
+  &lt;div class=example id=drawCustomFocusRingExample&gt;
 
-  &lt;p&gt;When a canvas is interactive, authors should include focusable
-  elements in the element's fallback content corresponding to each
-  focusable part of the canvas.&lt;/p&gt;
+   &lt;p&gt;This &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element has a couple of checkboxes. The
+   path-related commands are highlighted:&lt;/p&gt;
 
-  &lt;p&gt;To indicate which focusable part of the canvas is currently
-  focused, authors should use the &lt;code title=dom-context-2d-drawFocusRing&gt;&lt;a href=#dom-context-2d-drawfocusring&gt;drawFocusRing()&lt;/a&gt;&lt;/code&gt; method,
-  passing it the element for which a ring is being drawn. This method
-  only draws the focus ring if the element is focused, so that it can
-  simply be called whenever drawing the element, without checking
-  whether the element is focused or not first. The position of the
-  center of the control, or of the editing caret if the control has
-  one, should be given in the &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; arguments.&lt;/p&gt;
-
-  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;shouldDraw&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-drawFocusRing&gt;&lt;a href=#dom-context-2d-drawfocusring&gt;drawFocusRing&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;, [ &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; ])&lt;/dt&gt;
-
-   &lt;dd&gt;
-
-    &lt;p&gt;If the given element is focused, draws a focus ring around the
-    current path, following the platform conventions for focus
-    rings. The given coordinate is used if the user's attention needs
-    to be brought to a particular position (e.g. if a magnifier is
-    following the editing caret in a text field).&lt;/p&gt;
-
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is true, then
-    the focus ring is only drawn if the user has configured his system
-    to draw focus rings in a particular manner. (For example, high
-    contrast focus rings.)&lt;/p&gt;
-
-    &lt;p&gt;Returns true if the given element is focused, the &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is true, and the user has
-    not configured his system to draw focus rings in a particular
-    manner. Otherwise, returns false.&lt;/p&gt;
-
-    &lt;p&gt;When the method returns true, the author is expected to
-    manually draw a focus ring.&lt;/p&gt;
-
-   &lt;/dd&gt;
-
-  &lt;/dl&gt;&lt;div class=impl&gt;
-
-  &lt;p&gt;The &lt;dfn id=dom-context-2d-drawfocusring title=dom-context-2d-drawFocusRing&gt;&lt;code&gt;drawFocusRing(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;, [&lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt;])&lt;/code&gt;&lt;/dfn&gt;
-  method, when invoked, must run the following steps:&lt;/p&gt;
-
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; is not focused or is not a
-   descendant of the element with whose context the method is
-   associated, then return false and abort these steps.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Transform the given point (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;) according to the &lt;a href=#transformations title=dom-context-2d-transformation&gt;current transformation
-   matrix&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Optionally, inform the user that the focus is at the given
-   (transformed) coordinate on the canvas. (For example, this could
-   involve moving the user's magnification tool.)&lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;If the user has requested the use of particular focus rings
-    (e.g. high-contrast focus rings), or if the &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is absent or false, then
-    draw a focus ring of the appropriate style along the path,
-    following platform conventions, return false, and abort these
-    steps.&lt;/p&gt;
-
-    &lt;p&gt;The focus ring should not be subject to the &lt;a href=#shadows title=shadows&gt;shadow effects&lt;/a&gt;, the &lt;a href=#dom-context-2d-globalalpha title=dom-context-2d-globalAlpha&gt;global alpha&lt;/a&gt;, or the &lt;a href=#dom-context-2d-globalcompositeoperation title=dom-context-2d-globalCompositeOperation&gt;global composition
-    operators&lt;/a&gt;, but &lt;em&gt;should&lt;/em&gt; be subject to the &lt;a href=#clipping-region title=&quot;clipping region&quot;&gt;clipping region&lt;/a&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Return true.&lt;/li&gt;
-
-  &lt;/ol&gt;&lt;/div&gt;
-
-  &lt;div class=example&gt;
-
-   &lt;p&gt;This &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element has a couple of checkboxes:&lt;/p&gt;
-
    &lt;pre&gt;&lt;canvas height=400 width=750&gt;
  &lt;label&gt;&lt;input type=checkbox id=showA&gt; Show As&lt;/label&gt;
  &lt;label&gt;&lt;input type=checkbox id=showB&gt; Show Bs&lt;/label&gt;
  &lt;!-- ... --&gt;
 &lt;/canvas&gt;
 &lt;script&gt;
- function drawCheckbox(context, element, x, y) {
+ function drawCheckbox(context, element, x, y, paint) {
    context.save();
    context.font = '10px sans-serif';
    context.textAlign = 'left';
    context.textBaseline = 'middle';
    var metrics = context.measureText(element.labels[0].textContent);
-   context.beginPath();
-   context.strokeStyle = 'black';
-   context.rect(x-5, y-5, 10, 10);
-   context.stroke();
-   if (element.checked) {
-     context.fillStyle = 'black';
-     context.fill();
+   if (paint) {
+&lt;strong&gt;     context.beginPath();
+     context.strokeStyle = 'black';
+     context.rect(x-5, y-5, 10, 10);
+     context.stroke();
+&lt;/strong&gt;     if (element.checked) {
+&lt;strong&gt;       context.fillStyle = 'black';
+       context.fill();
+&lt;/strong&gt;     }
+     context.fillText(element.labels[0].textContent, x+5, y);
    }
-   context.fillText(element.labels[0].textContent, x+5, y);
-   context.beginPath();
+&lt;strong&gt;   context.beginPath();
    context.rect(x-7, y-7, 12 + metrics.width+2, 14);
-   if (context.drawFocusRing(element, x, y, true)) {
+   if (paint &amp;&amp; context.drawCustomFocusRing(element)) {
      context.strokeStyle = 'silver';
      context.stroke();
    }
-   context.restore();
+&lt;/strong&gt;   context.restore();
  }
  function drawBase() { /* ... */ }
  function drawAs() { /* ... */ }
@@ -35897,8 +35955,8 @@
    var canvas = document.getElementsByTagName('canvas')[0];
    var context = canvas.getContext('2d');
    context.clearRect(0, 0, canvas.width, canvas.height);
-   drawCheckbox(context, document.getElementById('showA'), 20, 40);
-   drawCheckbox(context, document.getElementById('showB'), 20, 60);
+   drawCheckbox(context, document.getElementById('showA'), 20, 40, true);
+   drawCheckbox(context, document.getElementById('showB'), 20, 60, true);
    drawBase();
    if (document.getElementById('showA').checked)
      drawAs();
@@ -35908,12 +35966,17 @@
  function processClick(event) {
    var canvas = document.getElementsByTagName('canvas')[0];
    var context = canvas.getContext('2d');
-   var x = event.clientX - canvas.offsetLeft;
-   var y = event.clientY - canvas.offsetTop;
-   drawCheckbox(context, document.getElementById('showA'), 20, 40);
+   var x = event.clientX;
+   var y = event.clientY;
+   while (node) {
+     x -= node.offsetLeft - node.scrollLeft;
+     y -= node.offsetTop - node.scrollTop;
+     node = node.offsetParent;
+   }
+   drawCheckbox(context, document.getElementById('showA'), 20, 40, false);
    if (context.isPointInPath(x, y))
      document.getElementById('showA').checked = !(document.getElementById('showA').checked);
-   drawCheckbox(context, document.getElementById('showB'), 20, 60);
+   drawCheckbox(context, document.getElementById('showB'), 20, 60, false);
    if (context.isPointInPath(x, y))
      document.getElementById('showB').checked = !(document.getElementById('showB').checked);
    redraw();
@@ -35929,8 +35992,10 @@
   &lt;/div&gt;
 
 
-  &lt;h6 id=text-0&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Text&lt;/h6&gt; &lt;!-- a v3 feature --&gt;
 
+
+  &lt;h6 id=text-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Text&lt;/h6&gt; &lt;!-- a v3 feature --&gt;
+
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-font&gt;&lt;a href=#dom-context-2d-font&gt;font&lt;/a&gt;&lt;/code&gt; [ = &lt;var title=&quot;&quot;&gt;value&lt;/var&gt; ]&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -36437,7 +36502,7 @@
 
 
 
-  &lt;h6 id=images&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;Images&lt;/h6&gt;
+  &lt;h6 id=images&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Images&lt;/h6&gt;
 
   &lt;p&gt;To draw images onto the canvas, the &lt;dfn id=dom-context-2d-drawimage title=dom-context-2d-drawImage&gt;&lt;code&gt;drawImage&lt;/code&gt;&lt;/dfn&gt; method
   can be used.&lt;/p&gt;
@@ -36578,7 +36643,7 @@
 
 
 
-  &lt;h6 id=pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;&lt;dfn&gt;Pixel manipulation&lt;/dfn&gt;&lt;/h6&gt;
+  &lt;h6 id=pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;&lt;dfn&gt;Pixel manipulation&lt;/dfn&gt;&lt;/h6&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-createImageData&gt;&lt;a href=#dom-context-2d-createimagedata&gt;createImageData&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/dt&gt;
 
@@ -36937,7 +37002,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h6 id=drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;&lt;dfn&gt;Drawing model&lt;/dfn&gt;&lt;/h6&gt;
+  &lt;h6 id=drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;&lt;dfn&gt;Drawing model&lt;/dfn&gt;&lt;/h6&gt;
 
   &lt;p&gt;When a shape or image is painted, user agents must follow these
   steps, in the order given (or act as if they do):&lt;/p&gt;
@@ -36968,6 +37033,68 @@
   &lt;/ol&gt;&lt;/div&gt;
 
 
+  &lt;h6 id=best-practices&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;Best practices&lt;/h6&gt;
+
+  &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
+
+  &lt;p&gt;When a canvas is interactive, authors should include focusable
+  elements in the element's fallback content corresponding to each
+  focusable part of the canvas, as in the &lt;a href=#drawCustomFocusRingExample&gt;example above&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;To indicate which focusable part of the canvas is currently
+  focused, authors should use the &lt;code title=dom-context-2d-drawOSFocusRing&gt;&lt;a href=#dom-context-2d-drawosfocusring&gt;drawOSFocusRing()&lt;/a&gt;&lt;/code&gt; method,
+  passing it the element for which a ring is being drawn. This method
+  only draws the focus ring if the element is focused, so that it can
+  simply be called whenever drawing the element, without checking
+  whether the element is focused or not first.&lt;/p&gt;
+
+  &lt;p&gt;Authors should avoid implementing text editing controls using the
+  &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element. Doing so has a large number of
+  disadvantages:&lt;/p&gt;
+
+  &lt;ul&gt;&lt;li&gt;Mouse placement of the caret has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Keyboard movement of the caret has to be reimplemented (possibly across lines, for multiline text input).&lt;/li&gt;
+
+   &lt;li&gt;Scrolling of the text field has to be implemented (horizontally for long lines, vertically for multiline input).&lt;/li&gt;
+
+   &lt;li&gt;Native features such as copy-and-paste have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as spell-checking have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as drag-and-drop have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as page-wide text search have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features specific to the user, for example custom text
+   services, have to be reimplemented. This is close to impossible
+   since each user might have different services installed, and there
+   is an unbounded set of possible such services.&lt;/li&gt;
+
+   &lt;li&gt;Bidirectional text editing has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;For multiline text editing, line wrapping has to be implemented for all relevant languages.&lt;/li&gt;
+
+   &lt;li&gt;Text selection has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Dragging of bidirectional text selections has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Platform-native keyboard shortcuts have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Platform-native input method editors (IMEs) have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Undo and redo functionality has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Accessibility features such as magnification following the
+   caret or selection have to be reimplemented.&lt;/li&gt;
+
+  &lt;/ul&gt;&lt;p&gt;This is a huge amount of work, and authors are most strongly
+  encouraged to avoid doing any of it by instead using the
+  &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element, the &lt;code&gt;&lt;a href=#the-textarea-element&gt;textarea&lt;/a&gt;&lt;/code&gt; element, or
+  the &lt;code title=attr-contenteditable&gt;&lt;a href=#attr-contenteditable&gt;contenteditable&lt;/a&gt;&lt;/code&gt;
+  attribute.&lt;/p&gt;
+
+
   &lt;h6 id=examples&gt;&lt;span class=secno&gt;4.8.11.1.14 &lt;/span&gt;Examples&lt;/h6&gt;
 
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;

Modified: index
===================================================================
--- index	2011-05-09 22:22:16 UTC (rev 6124)
+++ index	2011-05-11 00:08:45 UTC (rev 6125)
@@ -243,7 +243,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG height=101 src=/images/logo width=101&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1 class=allcaps&gt;HTML&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 9 May 2011&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 10 May 2011&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;!--&lt;p class=&quot;impl&quot;&gt;&lt;strong&gt;Implementors!&lt;/strong&gt; We have a &lt;a href=&quot;<A HREF="http://www.whatwg.org/mailing-list#implementors">http://www.whatwg.org/mailing-list#implementors</A>&quot;&gt;mailing list&lt;/a&gt; for you too!&lt;/p&gt;--&gt;
@@ -642,11 +642,11 @@
          &lt;li&gt;&lt;a href=#shadows&gt;&lt;span class=secno&gt;4.8.11.1.6 &lt;/span&gt;Shadows&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=#simple-shapes-(rectangles)&gt;&lt;span class=secno&gt;4.8.11.1.7 &lt;/span&gt;Simple shapes (rectangles)&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=#complex-shapes-(paths)&gt;&lt;span class=secno&gt;4.8.11.1.8 &lt;/span&gt;Complex shapes (paths)&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#focus-management-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Focus management&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#text-0&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Text&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#images&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;Images&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;Pixel manipulation&lt;/a&gt;&lt;/li&gt;
-         &lt;li&gt;&lt;a href=#drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;Drawing model&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#text-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Text&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#images&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Images&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;Pixel manipulation&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;Drawing model&lt;/a&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#best-practices&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;Best practices&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=#examples&gt;&lt;span class=secno&gt;4.8.11.1.14 &lt;/span&gt;Examples&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#color-spaces-and-color-correction&gt;&lt;span class=secno&gt;4.8.11.2 &lt;/span&gt;Color spaces and color correction&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#security-with-canvas-elements&gt;&lt;span class=secno&gt;4.8.11.3 &lt;/span&gt;Security with &lt;code&gt;canvas&lt;/code&gt; elements&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
@@ -1424,7 +1424,13 @@
    &lt;li&gt;&lt;a href=#mdvocabs&gt;Microdata vocabularies&lt;/a&gt;
    &lt;li&gt;&lt;a href=#crossDocumentMessages&gt;Cross-document messaging&lt;/a&gt; (also known as Communications)&lt;!--POSTMSG--&gt;
    &lt;li&gt;&lt;a href=#channel-messaging&gt;Channel messaging&lt;/a&gt; (also known as Communications)&lt;!--POSTMSG--&gt;
-  &lt;/ul&gt;&lt;p&gt;The &lt;a href=#forms&gt;forms&lt;/a&gt; part of this specification was
+  &lt;/ul&gt;&lt;p&gt;The specification that covers the Canvas 2D Graphics Context at
+  the W3C does not include all the advice included in the equivalent
+  section in this document, because of &lt;a href=<A HREF="http://lists.w3.org/Archives/Public/public-html/2011Apr/0712.html">http://lists.w3.org/Archives/Public/public-html/2011Apr/0712.html</A>&gt;the
+  discussion&lt;/a&gt; that followed &lt;a href=<A HREF="http://lists.w3.org/Archives/Public/public-html/2011Apr/0271.html">http://lists.w3.org/Archives/Public/public-html/2011Apr/0271.html</A>&gt;a
+  working gorup decision from April 2011&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;a href=#forms&gt;forms&lt;/a&gt; part of this specification was
   previously published separately in a specification known as Web
   Forms 2.&lt;/p&gt;
 
@@ -34162,7 +34168,7 @@
 
   &lt;h5 id=2dcontext&gt;&lt;span class=secno&gt;4.8.11.1 &lt;/span&gt;The 2D context&lt;/h5&gt;
 
-  &lt;!-- v2: we're on v4. suggestions for next version are marked v5. --&gt;
+  &lt;!-- v2: we're on v4.1. suggestions for next version are marked v5. --&gt;
 
   
 
@@ -34258,12 +34264,12 @@
   void &lt;a href=#dom-context-2d-arc title=dom-context-2d-arc&gt;arc&lt;/a&gt;(in double x, in double y, in double radius, in double startAngle, in double endAngle, in optional boolean anticlockwise);
   void &lt;a href=#dom-context-2d-fill title=dom-context-2d-fill&gt;fill&lt;/a&gt;();
   void &lt;a href=#dom-context-2d-stroke title=dom-context-2d-stroke&gt;stroke&lt;/a&gt;();
+  void &lt;a href=#dom-context-2d-drawosfocusring title=dom-context-2d-drawOSFocusRing&gt;drawOSFocusRing&lt;/a&gt;(in &lt;a href=#element&gt;Element&lt;/a&gt; element);
+  boolean &lt;a href=#dom-context-2d-drawcustomfocusring title=dom-context-2d-drawCustomFocusRing&gt;drawCustomFocusRing&lt;/a&gt;(in &lt;a href=#element&gt;Element&lt;/a&gt; element);
+  void &lt;a href=#dom-context-2d-scrollpathintoview title=dom-context-2d-scrollPathIntoView&gt;scrollPathIntoView&lt;/a&gt;();
   void &lt;a href=#dom-context-2d-clip title=dom-context-2d-clip&gt;clip&lt;/a&gt;();
   boolean &lt;a href=#dom-context-2d-ispointinpath title=dom-context-2d-isPointInPath&gt;isPointInPath&lt;/a&gt;(in double x, in double y);
 
-  // focus management
-  boolean &lt;a href=#dom-context-2d-drawfocusring title=dom-context-2d-drawFocusRing&gt;drawFocusRing&lt;/a&gt;(in &lt;a href=#element&gt;Element&lt;/a&gt; element, in double xCaret, in double yCaret, in optional boolean canDrawCustom);
-
   // text
            attribute DOMString &lt;a href=#dom-context-2d-font title=dom-context-2d-font&gt;font&lt;/a&gt;; // (default 10px sans-serif)
            attribute DOMString &lt;a href=#dom-context-2d-textalign title=dom-context-2d-textAlign&gt;textAlign&lt;/a&gt;; // &quot;start&quot;, &quot;end&quot;, &quot;left&quot;, &quot;right&quot;, &quot;center&quot; (default: &quot;start&quot;)
@@ -35578,6 +35584,42 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-drawOSFocusRing&gt;&lt;a href=#dom-context-2d-drawosfocusring&gt;drawOSFocusRing&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;If the given element is focused, draws a focus ring around the
+    current path, following the platform conventions for focus
+    rings.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;shouldDraw&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-drawCustomFocusRing&gt;&lt;a href=#dom-context-2d-drawcustomfocusring&gt;drawCustomFocusRing&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;If the given element is focused, and the user has configured
+    his system to draw focus rings in a particular manner (for
+    example, high contrast focus rings), draws a focus ring around the
+    current path and returns false.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, returns true if the given element is focused, and
+    false otherwise. This can thus be used to determine when to draw a
+    focus ring (see &lt;a href=#drawCustomFocusRingExample&gt;the
+    example&lt;/a&gt; below).&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-scrollPathIntoView&gt;&lt;a href=#dom-context-2d-scrollpathintoview&gt;scrollPathIntoView&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Scrolls the current path into view. This is especially useful
+    on devices with small screens, where the whole canvas might not be
+    visible at once.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-clip&gt;&lt;a href=#dom-context-2d-clip&gt;clip&lt;/a&gt;&lt;/code&gt;()&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -35780,8 +35822,100 @@
   &lt;p&gt;Zero-length line segments must be pruned before stroking a
   path. Empty subpaths must be ignored.&lt;/p&gt;
 
+  &lt;hr&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-drawosfocusring title=dom-context-2d-drawOSFocusRing&gt;&lt;code&gt;drawOSFocusRing(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked,
+  must run the following steps:&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn id=dom-context-2d-clip title=dom-context-2d-clip&gt;&lt;code&gt;clip()&lt;/code&gt;&lt;/dfn&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; is not focused or is not a
+   descendant of the element with whose context the method is
+   associated, then abort these steps.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If the user has requested the use of particular focus rings
+    (e.g. high-contrast focus rings), or if the &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; would have a focus ring drawn around it,
+    then draw a focus ring of the appropriate style along the path,
+    following platform conventions, and abort these steps.&lt;/p&gt;
+
+    &lt;p class=note&gt;Some platforms only draw focus rings around
+    elements that have been focused from the keyboard, and not those
+    focused from the mouse. Other platforms simply don't draw focus
+    rings around some elements at all unless relevant accessibility
+    features are enabled. This API is intended to follow these
+    conventions.&lt;/p&gt;
+
+    &lt;p&gt;The focus ring should not be subject to the &lt;a href=#shadows title=shadows&gt;shadow effects&lt;/a&gt;, the &lt;a href=#dom-context-2d-globalalpha title=dom-context-2d-globalAlpha&gt;global alpha&lt;/a&gt;, or the &lt;a href=#dom-context-2d-globalcompositeoperation title=dom-context-2d-globalCompositeOperation&gt;global composition
+    operators&lt;/a&gt;, but &lt;em&gt;should&lt;/em&gt; be subject to the &lt;a href=#clipping-region title=&quot;clipping region&quot;&gt;clipping region&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Optionally, &lt;a href=#inform&gt;inform the user&lt;/a&gt; that the
+    focus is at the location given by the path. User agents may wait
+    until the next time the &lt;a href=#event-loop&gt;event loop&lt;/a&gt; reaches its
+    &quot;update the rendering&quot; step to optionally inform the user.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-drawcustomfocusring title=dom-context-2d-drawCustomFocusRing&gt;&lt;code&gt;drawCustomFocusRing(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked, must run
+  the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; is not focused or is not a
+   descendant of the element with whose context the method is
+   associated, then return false and abort these steps.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If the user has requested the use of particular focus rings
+    (e.g. high-contrast focus rings), then draw a focus ring of the
+    appropriate style along the path, return false, and abort these
+    steps.&lt;/p&gt;
+
+    &lt;p&gt;The focus ring should not be subject to the &lt;a href=#shadows title=shadows&gt;shadow effects&lt;/a&gt;, the &lt;a href=#dom-context-2d-globalalpha title=dom-context-2d-globalAlpha&gt;global alpha&lt;/a&gt;, or the &lt;a href=#dom-context-2d-globalcompositeoperation title=dom-context-2d-globalCompositeOperation&gt;global composition
+    operators&lt;/a&gt;, but &lt;em&gt;should&lt;/em&gt; be subject to the &lt;a href=#clipping-region title=&quot;clipping region&quot;&gt;clipping region&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Optionally, &lt;a href=#inform&gt;inform the user&lt;/a&gt; that the
+    focus is at the location given by the path. User agents may wait
+    until the next time the &lt;a href=#event-loop&gt;event loop&lt;/a&gt; reaches its
+    &quot;update the rendering&quot; step to optionally inform the user.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return true.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-scrollpathintoview title=dom-context-2d-scrollPathIntoView&gt;&lt;code&gt;scrollPathIntoView()&lt;/code&gt;&lt;/dfn&gt;
+  method, when invoked, must run the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;notional child&lt;/var&gt; be a hypothetical
+   element that is a rendered child of the &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element
+   whose dimensions are exactly the rectangle of the bounding box of
+   the current path.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;span title=&quot;scroll an element into view&quot;&gt;Scroll &lt;var title=&quot;&quot;&gt;notional child&lt;/var&gt; into view&lt;/span&gt; with the &lt;var title=&quot;&quot;&gt;align to top flag&lt;/var&gt; set.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;Optionally, &lt;a href=#inform&gt;inform the user&lt;/a&gt; that the
+   caret and/or selection cover &lt;var title=&quot;&quot;&gt;the specified
+   rectangle&lt;/var&gt; of the canvas. User agents may wait until the next
+   time the &lt;a href=#event-loop&gt;event loop&lt;/a&gt; reaches its &quot;update the rendering&quot;
+   step to optionally inform the user.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p class=note id=inform&gt;&quot;Inform the user&quot;, as used in this
+  section, could mean calling a system accessibility API, which would
+  notify assistive technologies such as magnification tools. To
+  properly drive magnification based on a focus change, a system
+  accessibility API driving a screen magnifier needs the bounds for
+  the newly focused object. The methods above are intended to enable
+  this by allowing the user agent to report the bounding box of the
+  path used to render the focus ring as the bounds of the &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; element passed as an argument, if that
+  element is focused, and the bounding box of the area to which the
+  user agent is scrolling as the bounding box of the current
+  selection.&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-clip title=dom-context-2d-clip&gt;&lt;code&gt;clip()&lt;/code&gt;&lt;/dfn&gt;
   method must create a new &lt;dfn id=clipping-region&gt;clipping region&lt;/dfn&gt; by calculating
   the intersection of the current clipping region and the area
   described by the current path, using the non-zero winding number
@@ -35800,8 +35934,7 @@
     * support ways of resetting the clipping region without save/restore
   --&gt;
 
-
-  &lt;p&gt;The &lt;dfn id=dom-context-2d-ispointinpath title=dom-context-2d-isPointInPath&gt;&lt;code&gt;isPointInPath(&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must
+  &lt;hr&gt;&lt;p&gt;The &lt;dfn id=dom-context-2d-ispointinpath title=dom-context-2d-isPointInPath&gt;&lt;code&gt;isPointInPath(&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must
   return true if the point given by the &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; coordinates passed to the method, when treated as
   coordinates in the canvas coordinate space unaffected by the current
   transformation, is inside the current path as determined by the
@@ -35813,110 +35946,41 @@
   &lt;/div&gt;
 
 
-  &lt;h6 id=focus-management-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Focus management&lt;/h6&gt; &lt;!-- a v4 feature --&gt;
+  &lt;div class=example id=drawCustomFocusRingExample&gt;
 
-  &lt;p&gt;When a canvas is interactive, authors should include focusable
-  elements in the element's fallback content corresponding to each
-  focusable part of the canvas.&lt;/p&gt;
+   &lt;p&gt;This &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element has a couple of checkboxes. The
+   path-related commands are highlighted:&lt;/p&gt;
 
-  &lt;p&gt;To indicate which focusable part of the canvas is currently
-  focused, authors should use the &lt;code title=dom-context-2d-drawFocusRing&gt;&lt;a href=#dom-context-2d-drawfocusring&gt;drawFocusRing()&lt;/a&gt;&lt;/code&gt; method,
-  passing it the element for which a ring is being drawn. This method
-  only draws the focus ring if the element is focused, so that it can
-  simply be called whenever drawing the element, without checking
-  whether the element is focused or not first. The position of the
-  center of the control, or of the editing caret if the control has
-  one, should be given in the &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; arguments.&lt;/p&gt;
-
-  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;shouldDraw&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-drawFocusRing&gt;&lt;a href=#dom-context-2d-drawfocusring&gt;drawFocusRing&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;, [ &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; ])&lt;/dt&gt;
-
-   &lt;dd&gt;
-
-    &lt;p&gt;If the given element is focused, draws a focus ring around the
-    current path, following the platform conventions for focus
-    rings. The given coordinate is used if the user's attention needs
-    to be brought to a particular position (e.g. if a magnifier is
-    following the editing caret in a text field).&lt;/p&gt;
-
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is true, then
-    the focus ring is only drawn if the user has configured his system
-    to draw focus rings in a particular manner. (For example, high
-    contrast focus rings.)&lt;/p&gt;
-
-    &lt;p&gt;Returns true if the given element is focused, the &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is true, and the user has
-    not configured his system to draw focus rings in a particular
-    manner. Otherwise, returns false.&lt;/p&gt;
-
-    &lt;p&gt;When the method returns true, the author is expected to
-    manually draw a focus ring.&lt;/p&gt;
-
-   &lt;/dd&gt;
-
-  &lt;/dl&gt;&lt;div class=impl&gt;
-
-  &lt;p&gt;The &lt;dfn id=dom-context-2d-drawfocusring title=dom-context-2d-drawFocusRing&gt;&lt;code&gt;drawFocusRing(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;, [&lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt;])&lt;/code&gt;&lt;/dfn&gt;
-  method, when invoked, must run the following steps:&lt;/p&gt;
-
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; is not focused or is not a
-   descendant of the element with whose context the method is
-   associated, then return false and abort these steps.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Transform the given point (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;) according to the &lt;a href=#transformations title=dom-context-2d-transformation&gt;current transformation
-   matrix&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Optionally, inform the user that the focus is at the given
-   (transformed) coordinate on the canvas. (For example, this could
-   involve moving the user's magnification tool.)&lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;If the user has requested the use of particular focus rings
-    (e.g. high-contrast focus rings), or if the &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is absent or false, then
-    draw a focus ring of the appropriate style along the path,
-    following platform conventions, return false, and abort these
-    steps.&lt;/p&gt;
-
-    &lt;p&gt;The focus ring should not be subject to the &lt;a href=#shadows title=shadows&gt;shadow effects&lt;/a&gt;, the &lt;a href=#dom-context-2d-globalalpha title=dom-context-2d-globalAlpha&gt;global alpha&lt;/a&gt;, or the &lt;a href=#dom-context-2d-globalcompositeoperation title=dom-context-2d-globalCompositeOperation&gt;global composition
-    operators&lt;/a&gt;, but &lt;em&gt;should&lt;/em&gt; be subject to the &lt;a href=#clipping-region title=&quot;clipping region&quot;&gt;clipping region&lt;/a&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Return true.&lt;/li&gt;
-
-  &lt;/ol&gt;&lt;/div&gt;
-
-  &lt;div class=example&gt;
-
-   &lt;p&gt;This &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element has a couple of checkboxes:&lt;/p&gt;
-
    &lt;pre&gt;&lt;canvas height=400 width=750&gt;
  &lt;label&gt;&lt;input type=checkbox id=showA&gt; Show As&lt;/label&gt;
  &lt;label&gt;&lt;input type=checkbox id=showB&gt; Show Bs&lt;/label&gt;
  &lt;!-- ... --&gt;
 &lt;/canvas&gt;
 &lt;script&gt;
- function drawCheckbox(context, element, x, y) {
+ function drawCheckbox(context, element, x, y, paint) {
    context.save();
    context.font = '10px sans-serif';
    context.textAlign = 'left';
    context.textBaseline = 'middle';
    var metrics = context.measureText(element.labels[0].textContent);
-   context.beginPath();
-   context.strokeStyle = 'black';
-   context.rect(x-5, y-5, 10, 10);
-   context.stroke();
-   if (element.checked) {
-     context.fillStyle = 'black';
-     context.fill();
+   if (paint) {
+&lt;strong&gt;     context.beginPath();
+     context.strokeStyle = 'black';
+     context.rect(x-5, y-5, 10, 10);
+     context.stroke();
+&lt;/strong&gt;     if (element.checked) {
+&lt;strong&gt;       context.fillStyle = 'black';
+       context.fill();
+&lt;/strong&gt;     }
+     context.fillText(element.labels[0].textContent, x+5, y);
    }
-   context.fillText(element.labels[0].textContent, x+5, y);
-   context.beginPath();
+&lt;strong&gt;   context.beginPath();
    context.rect(x-7, y-7, 12 + metrics.width+2, 14);
-   if (context.drawFocusRing(element, x, y, true)) {
+   if (paint &amp;&amp; context.drawCustomFocusRing(element)) {
      context.strokeStyle = 'silver';
      context.stroke();
    }
-   context.restore();
+&lt;/strong&gt;   context.restore();
  }
  function drawBase() { /* ... */ }
  function drawAs() { /* ... */ }
@@ -35925,8 +35989,8 @@
    var canvas = document.getElementsByTagName('canvas')[0];
    var context = canvas.getContext('2d');
    context.clearRect(0, 0, canvas.width, canvas.height);
-   drawCheckbox(context, document.getElementById('showA'), 20, 40);
-   drawCheckbox(context, document.getElementById('showB'), 20, 60);
+   drawCheckbox(context, document.getElementById('showA'), 20, 40, true);
+   drawCheckbox(context, document.getElementById('showB'), 20, 60, true);
    drawBase();
    if (document.getElementById('showA').checked)
      drawAs();
@@ -35936,12 +36000,17 @@
  function processClick(event) {
    var canvas = document.getElementsByTagName('canvas')[0];
    var context = canvas.getContext('2d');
-   var x = event.clientX - canvas.offsetLeft;
-   var y = event.clientY - canvas.offsetTop;
-   drawCheckbox(context, document.getElementById('showA'), 20, 40);
+   var x = event.clientX;
+   var y = event.clientY;
+   while (node) {
+     x -= node.offsetLeft - node.scrollLeft;
+     y -= node.offsetTop - node.scrollTop;
+     node = node.offsetParent;
+   }
+   drawCheckbox(context, document.getElementById('showA'), 20, 40, false);
    if (context.isPointInPath(x, y))
      document.getElementById('showA').checked = !(document.getElementById('showA').checked);
-   drawCheckbox(context, document.getElementById('showB'), 20, 60);
+   drawCheckbox(context, document.getElementById('showB'), 20, 60, false);
    if (context.isPointInPath(x, y))
      document.getElementById('showB').checked = !(document.getElementById('showB').checked);
    redraw();
@@ -35957,8 +36026,10 @@
   &lt;/div&gt;
 
 
-  &lt;h6 id=text-0&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Text&lt;/h6&gt; &lt;!-- a v3 feature --&gt;
 
+
+  &lt;h6 id=text-0&gt;&lt;span class=secno&gt;4.8.11.1.9 &lt;/span&gt;Text&lt;/h6&gt; &lt;!-- a v3 feature --&gt;
+
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-font&gt;&lt;a href=#dom-context-2d-font&gt;font&lt;/a&gt;&lt;/code&gt; [ = &lt;var title=&quot;&quot;&gt;value&lt;/var&gt; ]&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -36465,7 +36536,7 @@
 
 
 
-  &lt;h6 id=images&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;Images&lt;/h6&gt;
+  &lt;h6 id=images&gt;&lt;span class=secno&gt;4.8.11.1.10 &lt;/span&gt;Images&lt;/h6&gt;
 
   &lt;p&gt;To draw images onto the canvas, the &lt;dfn id=dom-context-2d-drawimage title=dom-context-2d-drawImage&gt;&lt;code&gt;drawImage&lt;/code&gt;&lt;/dfn&gt; method
   can be used.&lt;/p&gt;
@@ -36606,7 +36677,7 @@
 
 
 
-  &lt;h6 id=pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;&lt;dfn&gt;Pixel manipulation&lt;/dfn&gt;&lt;/h6&gt;
+  &lt;h6 id=pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.1.11 &lt;/span&gt;&lt;dfn&gt;Pixel manipulation&lt;/dfn&gt;&lt;/h6&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-createImageData&gt;&lt;a href=#dom-context-2d-createimagedata&gt;createImageData&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/dt&gt;
 
@@ -36965,7 +37036,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h6 id=drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;&lt;dfn&gt;Drawing model&lt;/dfn&gt;&lt;/h6&gt;
+  &lt;h6 id=drawing-model&gt;&lt;span class=secno&gt;4.8.11.1.12 &lt;/span&gt;&lt;dfn&gt;Drawing model&lt;/dfn&gt;&lt;/h6&gt;
 
   &lt;p&gt;When a shape or image is painted, user agents must follow these
   steps, in the order given (or act as if they do):&lt;/p&gt;
@@ -36996,6 +37067,68 @@
   &lt;/ol&gt;&lt;/div&gt;
 
 
+  &lt;h6 id=best-practices&gt;&lt;span class=secno&gt;4.8.11.1.13 &lt;/span&gt;Best practices&lt;/h6&gt;
+
+  &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
+
+  &lt;p&gt;When a canvas is interactive, authors should include focusable
+  elements in the element's fallback content corresponding to each
+  focusable part of the canvas, as in the &lt;a href=#drawCustomFocusRingExample&gt;example above&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;To indicate which focusable part of the canvas is currently
+  focused, authors should use the &lt;code title=dom-context-2d-drawOSFocusRing&gt;&lt;a href=#dom-context-2d-drawosfocusring&gt;drawOSFocusRing()&lt;/a&gt;&lt;/code&gt; method,
+  passing it the element for which a ring is being drawn. This method
+  only draws the focus ring if the element is focused, so that it can
+  simply be called whenever drawing the element, without checking
+  whether the element is focused or not first.&lt;/p&gt;
+
+  &lt;p&gt;Authors should avoid implementing text editing controls using the
+  &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element. Doing so has a large number of
+  disadvantages:&lt;/p&gt;
+
+  &lt;ul&gt;&lt;li&gt;Mouse placement of the caret has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Keyboard movement of the caret has to be reimplemented (possibly across lines, for multiline text input).&lt;/li&gt;
+
+   &lt;li&gt;Scrolling of the text field has to be implemented (horizontally for long lines, vertically for multiline input).&lt;/li&gt;
+
+   &lt;li&gt;Native features such as copy-and-paste have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as spell-checking have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as drag-and-drop have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as page-wide text search have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features specific to the user, for example custom text
+   services, have to be reimplemented. This is close to impossible
+   since each user might have different services installed, and there
+   is an unbounded set of possible such services.&lt;/li&gt;
+
+   &lt;li&gt;Bidirectional text editing has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;For multiline text editing, line wrapping has to be implemented for all relevant languages.&lt;/li&gt;
+
+   &lt;li&gt;Text selection has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Dragging of bidirectional text selections has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Platform-native keyboard shortcuts have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Platform-native input method editors (IMEs) have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Undo and redo functionality has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Accessibility features such as magnification following the
+   caret or selection have to be reimplemented.&lt;/li&gt;
+
+  &lt;/ul&gt;&lt;p&gt;This is a huge amount of work, and authors are most strongly
+  encouraged to avoid doing any of it by instead using the
+  &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element, the &lt;code&gt;&lt;a href=#the-textarea-element&gt;textarea&lt;/a&gt;&lt;/code&gt; element, or
+  the &lt;code title=attr-contenteditable&gt;&lt;a href=#attr-contenteditable&gt;contenteditable&lt;/a&gt;&lt;/code&gt;
+  attribute.&lt;/p&gt;
+
+
   &lt;h6 id=examples&gt;&lt;span class=secno&gt;4.8.11.1.14 &lt;/span&gt;Examples&lt;/h6&gt;
 
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;

Modified: source
===================================================================
--- source	2011-05-09 22:22:16 UTC (rev 6124)
+++ source	2011-05-11 00:08:45 UTC (rev 6125)
@@ -176,6 +176,14 @@
    &lt;li&gt;&lt;a href=&quot;#crossDocumentMessages&quot;&gt;Cross-document messaging&lt;/a&gt; (also known as Communications)&lt;!--POSTMSG--&gt;
    &lt;li&gt;&lt;a href=&quot;#channel-messaging&quot;&gt;Channel messaging&lt;/a&gt; (also known as Communications)&lt;!--POSTMSG--&gt;
   &lt;/ul&gt;
+  
+  &lt;p&gt;The specification that covers the Canvas 2D Graphics Context at
+  the W3C does not include all the advice included in the equivalent
+  section in this document, because of &lt;a
+  href=&quot;<A HREF="http://lists.w3.org/Archives/Public/public-html/2011Apr/0712.html">http://lists.w3.org/Archives/Public/public-html/2011Apr/0712.html</A>&quot;&gt;the
+  discussion&lt;/a&gt; that followed &lt;a
+  href=&quot;<A HREF="http://lists.w3.org/Archives/Public/public-html/2011Apr/0271.html">http://lists.w3.org/Archives/Public/public-html/2011Apr/0271.html</A>&quot;&gt;a
+  working gorup decision from April 2011&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;The &lt;a href=&quot;#forms&quot;&gt;forms&lt;/a&gt; part of this specification was
   previously published separately in a specification known as Web
@@ -37675,7 +37683,7 @@
 
   &lt;h5 id=&quot;2dcontext&quot;&gt;The 2D context&lt;/h5&gt;
 
-  &lt;!-- v2: we're on v4. suggestions for next version are marked v5. --&gt;
+  &lt;!-- v2: we're on v4.1. suggestions for next version are marked v5. --&gt;
 
   &lt;!--START 2dcontext--&gt;
 
@@ -37776,12 +37784,12 @@
   void &lt;span title=&quot;dom-context-2d-arc&quot;&gt;arc&lt;/span&gt;(in double x, in double y, in double radius, in double startAngle, in double endAngle, in optional boolean anticlockwise);
   void &lt;span title=&quot;dom-context-2d-fill&quot;&gt;fill&lt;/span&gt;();
   void &lt;span title=&quot;dom-context-2d-stroke&quot;&gt;stroke&lt;/span&gt;();
+  void &lt;span title=&quot;dom-context-2d-drawOSFocusRing&quot;&gt;drawOSFocusRing&lt;/span&gt;(in &lt;span&gt;Element&lt;/span&gt; element);
+  boolean &lt;span title=&quot;dom-context-2d-drawCustomFocusRing&quot;&gt;drawCustomFocusRing&lt;/span&gt;(in &lt;span&gt;Element&lt;/span&gt; element);
+  void &lt;span title=&quot;dom-context-2d-scrollPathIntoView&quot;&gt;scrollPathIntoView&lt;/span&gt;();
   void &lt;span title=&quot;dom-context-2d-clip&quot;&gt;clip&lt;/span&gt;();
   boolean &lt;span title=&quot;dom-context-2d-isPointInPath&quot;&gt;isPointInPath&lt;/span&gt;(in double x, in double y);
 
-  // focus management
-  boolean &lt;span title=&quot;dom-context-2d-drawFocusRing&quot;&gt;drawFocusRing&lt;/span&gt;(in &lt;span&gt;Element&lt;/span&gt; element, in double xCaret, in double yCaret, in optional boolean canDrawCustom);
-
   // text
            attribute DOMString &lt;span title=&quot;dom-context-2d-font&quot;&gt;font&lt;/span&gt;; // (default 10px sans-serif)
            attribute DOMString &lt;span title=&quot;dom-context-2d-textAlign&quot;&gt;textAlign&lt;/span&gt;; // &quot;start&quot;, &quot;end&quot;, &quot;left&quot;, &quot;right&quot;, &quot;center&quot; (default: &quot;start&quot;)
@@ -39346,6 +39354,42 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=&quot;dom-context-2d-drawOSFocusRing&quot;&gt;drawOSFocusRing&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;If the given element is focused, draws a focus ring around the
+    current path, following the platform conventions for focus
+    rings.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;shouldDraw&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=&quot;dom-context-2d-drawCustomFocusRing&quot;&gt;drawCustomFocusRing&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;If the given element is focused, and the user has configured
+    his system to draw focus rings in a particular manner (for
+    example, high contrast focus rings), draws a focus ring around the
+    current path and returns false.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, returns true if the given element is focused, and
+    false otherwise. This can thus be used to determine when to draw a
+    focus ring (see &lt;a href=&quot;#drawCustomFocusRingExample&quot;&gt;the
+    example&lt;/a&gt; below).&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=&quot;dom-context-2d-scrollPathIntoView&quot;&gt;scrollPathIntoView&lt;/code&gt;()&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Scrolls the current path into view. This is especially useful
+    on devices with small screens, where the whole canvas might not be
+    visible at once.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=&quot;dom-context-2d-clip&quot;&gt;clip&lt;/code&gt;()&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -39611,95 +39655,58 @@
   &lt;p&gt;Zero-length line segments must be pruned before stroking a
   path. Empty subpaths must be ignored.&lt;/p&gt;
 
+  &lt;hr&gt;
 
-  &lt;p&gt;The &lt;dfn title=&quot;dom-context-2d-clip&quot;&gt;&lt;code&gt;clip()&lt;/code&gt;&lt;/dfn&gt;
-  method must create a new &lt;dfn&gt;clipping region&lt;/dfn&gt; by calculating
-  the intersection of the current clipping region and the area
-  described by the current path, using the non-zero winding number
-  rule. Open subpaths must be implicitly closed when computing the
-  clipping region, without affecting the actual subpaths. The new
-  clipping region replaces the current clipping region.&lt;/p&gt;
-
-  &lt;p&gt;When the context is initialized, the clipping region must be set
-  to the rectangle with the top left corner at (0,0) and the width and
-  height of the coordinate space.&lt;/p&gt;
-
-  &lt;!-- v5
-   Jordan OSETE suggests:
-    * support ways of extending the clipping region (union instead of intersection)
-       - also &quot;add&quot;, &quot;subtract&quot;, &quot;replace&quot;, &quot;intersect&quot; and &quot;xor&quot;
-    * support ways of resetting the clipping region without save/restore
-  --&gt;
-
-
   &lt;p&gt;The &lt;dfn
-  title=&quot;dom-context-2d-isPointInPath&quot;&gt;&lt;code&gt;isPointInPath(&lt;var
-  title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must
-  return true if the point given by the &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &lt;var
-  title=&quot;&quot;&gt;y&lt;/var&gt; coordinates passed to the method, when treated as
-  coordinates in the canvas coordinate space unaffected by the current
-  transformation, is inside the current path as determined by the
-  non-zero winding number rule; and must return false
-  otherwise. Points on the path itself are considered to be inside the
-  path. If either of the arguments is infinite or NaN, then the method
-  must return false.&lt;/p&gt;
+  title=&quot;dom-context-2d-drawOSFocusRing&quot;&gt;&lt;code&gt;drawOSFocusRing(&lt;var
+  title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked,
+  must run the following steps:&lt;/p&gt;
 
-  &lt;/div&gt;
+  &lt;ol&gt;
 
+   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;element&lt;/var&gt; is not focused or is not a
+   descendant of the element with whose context the method is
+   associated, then abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-  &lt;h6&gt;Focus management&lt;/h6&gt; &lt;!-- a v4 feature --&gt;
+   &lt;li&gt;
 
-  &lt;p&gt;When a canvas is interactive, authors should include focusable
-  elements in the element's fallback content corresponding to each
-  focusable part of the canvas.&lt;/p&gt;
+    &lt;p&gt;If the user has requested the use of particular focus rings
+    (e.g. high-contrast focus rings), or if the &lt;var
+    title=&quot;&quot;&gt;element&lt;/var&gt; would have a focus ring drawn around it,
+    then draw a focus ring of the appropriate style along the path,
+    following platform conventions, and abort these steps.&lt;/p&gt;
 
-  &lt;p&gt;To indicate which focusable part of the canvas is currently
-  focused, authors should use the &lt;code
-  title=&quot;dom-context-2d-drawFocusRing&quot;&gt;drawFocusRing()&lt;/code&gt; method,
-  passing it the element for which a ring is being drawn. This method
-  only draws the focus ring if the element is focused, so that it can
-  simply be called whenever drawing the element, without checking
-  whether the element is focused or not first. The position of the
-  center of the control, or of the editing caret if the control has
-  one, should be given in the &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &lt;var
-  title=&quot;&quot;&gt;y&lt;/var&gt; arguments.&lt;/p&gt;
+    &lt;p class=&quot;note&quot;&gt;Some platforms only draw focus rings around
+    elements that have been focused from the keyboard, and not those
+    focused from the mouse. Other platforms simply don't draw focus
+    rings around some elements at all unless relevant accessibility
+    features are enabled. This API is intended to follow these
+    conventions.&lt;/p&gt;
 
-  &lt;dl class=&quot;domintro&quot;&gt;
+    &lt;p&gt;The focus ring should not be subject to the &lt;span
+    title=&quot;shadows&quot;&gt;shadow effects&lt;/span&gt;, the &lt;span
+    title=&quot;dom-context-2d-globalAlpha&quot;&gt;global alpha&lt;/span&gt;, or the &lt;span
+    title=&quot;dom-context-2d-globalCompositeOperation&quot;&gt;global composition
+    operators&lt;/span&gt;, but &lt;em&gt;should&lt;/em&gt; be subject to the &lt;span
+    title=&quot;clipping region&quot;&gt;clipping region&lt;/span&gt;.&lt;/p&gt;
 
-   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;shouldDraw&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=&quot;dom-context-2d-drawFocusRing&quot;&gt;drawFocusRing&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;element&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;, [ &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; ])&lt;/dt&gt;
+   &lt;/li&gt;
 
-   &lt;dd&gt;
+   &lt;li&gt;
 
-    &lt;p&gt;If the given element is focused, draws a focus ring around the
-    current path, following the platform conventions for focus
-    rings. The given coordinate is used if the user's attention needs
-    to be brought to a particular position (e.g. if a magnifier is
-    following the editing caret in a text field).&lt;/p&gt;
+    &lt;p&gt;Optionally, &lt;a href=&quot;#inform&quot;&gt;inform the user&lt;/a&gt; that the
+    focus is at the location given by the path. User agents may wait
+    until the next time the &lt;span&gt;event loop&lt;/span&gt; reaches its
+    &quot;update the rendering&quot; step to optionally inform the user.&lt;/p&gt;
 
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is true, then
-    the focus ring is only drawn if the user has configured his system
-    to draw focus rings in a particular manner. (For example, high
-    contrast focus rings.)&lt;/p&gt;
+   &lt;/li&gt;
 
-    &lt;p&gt;Returns true if the given element is focused, the &lt;var
-    title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is true, and the user has
-    not configured his system to draw focus rings in a particular
-    manner. Otherwise, returns false.&lt;/p&gt;
+  &lt;/ol&gt;
 
-    &lt;p&gt;When the method returns true, the author is expected to
-    manually draw a focus ring.&lt;/p&gt;
-
-   &lt;/dd&gt;
-
-  &lt;/dl&gt;
-
-  &lt;div class=&quot;impl&quot;&gt;
-
   &lt;p&gt;The &lt;dfn
-  title=&quot;dom-context-2d-drawFocusRing&quot;&gt;&lt;code&gt;drawFocusRing(&lt;var
-  title=&quot;&quot;&gt;element&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var
-  title=&quot;&quot;&gt;y&lt;/var&gt;, [&lt;var title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt;])&lt;/code&gt;&lt;/dfn&gt;
-  method, when invoked, must run the following steps:&lt;/p&gt;
+  title=&quot;dom-context-2d-drawCustomFocusRing&quot;&gt;&lt;code&gt;drawCustomFocusRing(&lt;var
+  title=&quot;&quot;&gt;element&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked, must run
+  the following steps:&lt;/p&gt;
 
   &lt;ol&gt;
 
@@ -39707,22 +39714,11 @@
    descendant of the element with whose context the method is
    associated, then return false and abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Transform the given point (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var
-   title=&quot;&quot;&gt;y&lt;/var&gt;) according to the &lt;span
-   title=&quot;dom-context-2d-transformation&quot;&gt;current transformation
-   matrix&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Optionally, inform the user that the focus is at the given
-   (transformed) coordinate on the canvas. (For example, this could
-   involve moving the user's magnification tool.)&lt;/p&gt;&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;If the user has requested the use of particular focus rings
-    (e.g. high-contrast focus rings), or if the &lt;var
-    title=&quot;&quot;&gt;canDrawCustom&lt;/var&gt; argument is absent or false, then
-    draw a focus ring of the appropriate style along the path,
-    following platform conventions, return false, and abort these
+    (e.g. high-contrast focus rings), then draw a focus ring of the
+    appropriate style along the path, return false, and abort these
     steps.&lt;/p&gt;
 
     &lt;p&gt;The focus ring should not be subject to the &lt;span
@@ -39734,44 +39730,128 @@
 
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;Optionally, &lt;a href=&quot;#inform&quot;&gt;inform the user&lt;/a&gt; that the
+    focus is at the location given by the path. User agents may wait
+    until the next time the &lt;span&gt;event loop&lt;/span&gt; reaches its
+    &quot;update the rendering&quot; step to optionally inform the user.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;Return true.&lt;/p&gt;&lt;/li&gt;
 
   &lt;/ol&gt;
 
+  &lt;p&gt;The &lt;dfn
+  title=&quot;dom-context-2d-scrollPathIntoView&quot;&gt;&lt;code&gt;scrollPathIntoView()&lt;/code&gt;&lt;/dfn&gt;
+  method, when invoked, must run the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;notional child&lt;/var&gt; be a hypothetical
+   element that is a rendered child of the &lt;code&gt;canvas&lt;/code&gt; element
+   whose dimensions are exactly the rectangle of the bounding box of
+   the current path.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;span title=&quot;scroll an element into view&quot;&gt;Scroll &lt;var
+   title=&quot;&quot;&gt;notional child&lt;/var&gt; into view&lt;/span&gt; with the &lt;var
+   title=&quot;&quot;&gt;align to top flag&lt;/var&gt; set.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;Optionally, &lt;a href=&quot;#inform&quot;&gt;inform the user&lt;/a&gt; that the
+   caret and/or selection cover &lt;var title=&quot;&quot;&gt;the specified
+   rectangle&lt;/var&gt; of the canvas. User agents may wait until the next
+   time the &lt;span&gt;event loop&lt;/span&gt; reaches its &quot;update the rendering&quot;
+   step to optionally inform the user.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;p class=&quot;note&quot; id=&quot;inform&quot;&gt;&quot;Inform the user&quot;, as used in this
+  section, could mean calling a system accessibility API, which would
+  notify assistive technologies such as magnification tools. To
+  properly drive magnification based on a focus change, a system
+  accessibility API driving a screen magnifier needs the bounds for
+  the newly focused object. The methods above are intended to enable
+  this by allowing the user agent to report the bounding box of the
+  path used to render the focus ring as the bounds of the &lt;var
+  title=&quot;&quot;&gt;element&lt;/var&gt; element passed as an argument, if that
+  element is focused, and the bounding box of the area to which the
+  user agent is scrolling as the bounding box of the current
+  selection.&lt;/p&gt;
+
+  &lt;hr&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;dom-context-2d-clip&quot;&gt;&lt;code&gt;clip()&lt;/code&gt;&lt;/dfn&gt;
+  method must create a new &lt;dfn&gt;clipping region&lt;/dfn&gt; by calculating
+  the intersection of the current clipping region and the area
+  described by the current path, using the non-zero winding number
+  rule. Open subpaths must be implicitly closed when computing the
+  clipping region, without affecting the actual subpaths. The new
+  clipping region replaces the current clipping region.&lt;/p&gt;
+
+  &lt;p&gt;When the context is initialized, the clipping region must be set
+  to the rectangle with the top left corner at (0,0) and the width and
+  height of the coordinate space.&lt;/p&gt;
+
+  &lt;!-- v5
+   Jordan OSETE suggests:
+    * support ways of extending the clipping region (union instead of intersection)
+       - also &quot;add&quot;, &quot;subtract&quot;, &quot;replace&quot;, &quot;intersect&quot; and &quot;xor&quot;
+    * support ways of resetting the clipping region without save/restore
+  --&gt;
+
+  &lt;hr&gt;
+
+  &lt;p&gt;The &lt;dfn
+  title=&quot;dom-context-2d-isPointInPath&quot;&gt;&lt;code&gt;isPointInPath(&lt;var
+  title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must
+  return true if the point given by the &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &lt;var
+  title=&quot;&quot;&gt;y&lt;/var&gt; coordinates passed to the method, when treated as
+  coordinates in the canvas coordinate space unaffected by the current
+  transformation, is inside the current path as determined by the
+  non-zero winding number rule; and must return false
+  otherwise. Points on the path itself are considered to be inside the
+  path. If either of the arguments is infinite or NaN, then the method
+  must return false.&lt;/p&gt;
+
   &lt;/div&gt;
 
-  &lt;div class=&quot;example&quot;&gt;
 
-   &lt;p&gt;This &lt;code&gt;canvas&lt;/code&gt; element has a couple of checkboxes:&lt;/p&gt;
+  &lt;div class=&quot;example&quot; id=&quot;drawCustomFocusRingExample&quot;&gt;
 
+   &lt;p&gt;This &lt;code&gt;canvas&lt;/code&gt; element has a couple of checkboxes. The
+   path-related commands are highlighted:&lt;/p&gt;
+
    &lt;pre&gt;&lt;canvas height=400 width=750&gt;
  &lt;label&gt;&lt;input type=checkbox id=showA&gt; Show As&lt;/label&gt;
  &lt;label&gt;&lt;input type=checkbox id=showB&gt; Show Bs&lt;/label&gt;
  &lt;!-- ... --&gt;
 &lt;/canvas&gt;
 &lt;script&gt;
- function drawCheckbox(context, element, x, y) {
+ function drawCheckbox(context, element, x, y, paint) {
    context.save();
    context.font = '10px sans-serif';
    context.textAlign = 'left';
    context.textBaseline = 'middle';
    var metrics = context.measureText(element.labels[0].textContent);
-   context.beginPath();
-   context.strokeStyle = 'black';
-   context.rect(x-5, y-5, 10, 10);
-   context.stroke();
-   if (element.checked) {
-     context.fillStyle = 'black';
-     context.fill();
+   if (paint) {
+&lt;strong&gt;     context.beginPath();
+     context.strokeStyle = 'black';
+     context.rect(x-5, y-5, 10, 10);
+     context.stroke();
+&lt;/strong&gt;     if (element.checked) {
+&lt;strong&gt;       context.fillStyle = 'black';
+       context.fill();
+&lt;/strong&gt;     }
+     context.fillText(element.labels[0].textContent, x+5, y);
    }
-   context.fillText(element.labels[0].textContent, x+5, y);
-   context.beginPath();
+&lt;strong&gt;   context.beginPath();
    context.rect(x-7, y-7, 12 + metrics.width+2, 14);
-   if (context.drawFocusRing(element, x, y, true)) {
+   if (paint &amp;&amp; context.drawCustomFocusRing(element)) {
      context.strokeStyle = 'silver';
      context.stroke();
    }
-   context.restore();
+&lt;/strong&gt;   context.restore();
  }
  function drawBase() { /* ... */ }
  function drawAs() { /* ... */ }
@@ -39780,8 +39860,8 @@
    var canvas = document.getElementsByTagName('canvas')[0];
    var context = canvas.getContext('2d');
    context.clearRect(0, 0, canvas.width, canvas.height);
-   drawCheckbox(context, document.getElementById('showA'), 20, 40);
-   drawCheckbox(context, document.getElementById('showB'), 20, 60);
+   drawCheckbox(context, document.getElementById('showA'), 20, 40, true);
+   drawCheckbox(context, document.getElementById('showB'), 20, 60, true);
    drawBase();
    if (document.getElementById('showA').checked)
      drawAs();
@@ -39791,12 +39871,17 @@
  function processClick(event) {
    var canvas = document.getElementsByTagName('canvas')[0];
    var context = canvas.getContext('2d');
-   var x = event.clientX - canvas.offsetLeft;
-   var y = event.clientY - canvas.offsetTop;
-   drawCheckbox(context, document.getElementById('showA'), 20, 40);
+   var x = event.clientX;
+   var y = event.clientY;
+   while (node) {
+     x -= node.offsetLeft - node.scrollLeft;
+     y -= node.offsetTop - node.scrollTop;
+     node = node.offsetParent;
+   }
+   drawCheckbox(context, document.getElementById('showA'), 20, 40, false);
    if (context.isPointInPath(x, y))
      document.getElementById('showA').checked = !(document.getElementById('showA').checked);
-   drawCheckbox(context, document.getElementById('showB'), 20, 60);
+   drawCheckbox(context, document.getElementById('showB'), 20, 60, false);
    if (context.isPointInPath(x, y))
      document.getElementById('showB').checked = !(document.getElementById('showB').checked);
    redraw();
@@ -39812,6 +39897,8 @@
   &lt;/div&gt;
 
 
+
+
   &lt;h6&gt;Text&lt;/h6&gt; &lt;!-- a v3 feature --&gt;
 
   &lt;dl class=&quot;domintro&quot;&gt;
@@ -41074,6 +41161,74 @@
   &lt;/div&gt;
 
 
+  &lt;h6&gt;Best practices&lt;/h6&gt;
+
+  &lt;!--END dev-html--&gt;&lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;&lt;!--START dev-html--&gt;
+
+  &lt;p&gt;When a canvas is interactive, authors should include focusable
+  elements in the element's fallback content corresponding to each
+  focusable part of the canvas, as in the &lt;a
+  href=&quot;#drawCustomFocusRingExample&quot;&gt;example above&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;To indicate which focusable part of the canvas is currently
+  focused, authors should use the &lt;code
+  title=&quot;dom-context-2d-drawOSFocusRing&quot;&gt;drawOSFocusRing()&lt;/code&gt; method,
+  passing it the element for which a ring is being drawn. This method
+  only draws the focus ring if the element is focused, so that it can
+  simply be called whenever drawing the element, without checking
+  whether the element is focused or not first.&lt;/p&gt;
+
+  &lt;p&gt;Authors should avoid implementing text editing controls using the
+  &lt;code&gt;canvas&lt;/code&gt; element. Doing so has a large number of
+  disadvantages:&lt;/p&gt;
+
+  &lt;ul&gt;
+
+   &lt;li&gt;Mouse placement of the caret has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Keyboard movement of the caret has to be reimplemented (possibly across lines, for multiline text input).&lt;/li&gt;
+
+   &lt;li&gt;Scrolling of the text field has to be implemented (horizontally for long lines, vertically for multiline input).&lt;/li&gt;
+
+   &lt;li&gt;Native features such as copy-and-paste have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as spell-checking have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as drag-and-drop have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features such as page-wide text search have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Native features specific to the user, for example custom text
+   services, have to be reimplemented. This is close to impossible
+   since each user might have different services installed, and there
+   is an unbounded set of possible such services.&lt;/li&gt;
+
+   &lt;li&gt;Bidirectional text editing has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;For multiline text editing, line wrapping has to be implemented for all relevant languages.&lt;/li&gt;
+
+   &lt;li&gt;Text selection has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Dragging of bidirectional text selections has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Platform-native keyboard shortcuts have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Platform-native input method editors (IMEs) have to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Undo and redo functionality has to be reimplemented.&lt;/li&gt;
+
+   &lt;li&gt;Accessibility features such as magnification following the
+   caret or selection have to be reimplemented.&lt;/li&gt;
+
+  &lt;/ul&gt;
+
+  &lt;p&gt;This is a huge amount of work, and authors are most strongly
+  encouraged to avoid doing any of it by instead using the
+  &lt;code&gt;input&lt;/code&gt; element, the &lt;code&gt;textarea&lt;/code&gt; element, or
+  the &lt;code title=&quot;attr-contenteditable&quot;&gt;contenteditable&lt;/code&gt;
+  attribute.&lt;/p&gt;
+
+
   &lt;h6&gt;Examples&lt;/h6&gt;
 
   &lt;!--END dev-html--&gt;&lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;&lt;!--START dev-html--&gt;


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012991.html">[html5] r6124 - [e] (0) notes
</A></li>
	<LI>Next message: <A HREF="012993.html">[html5] r6126 - [e] (0) highlight more text in the example
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12992">[ date ]</a>
              <a href="thread.html#12992">[ thread ]</a>
              <a href="subject.html#12992">[ subject ]</a>
              <a href="author.html#12992">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
