<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r7454 - [e] (0) Add an intro section that describes the	'prefer-online' feature a bit. F [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7454%20-%20%5Be%5D%20%280%29%20Add%20an%20intro%20section%20that%20describes%20the%0A%09%27prefer-online%27%20feature%20a%20bit.%20F%20%5B...%5D&In-Reply-To=%3C20121011230210.319B71C8C0AE%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014316.html">
   <LINK REL="Next"  HREF="014318.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r7454 - [e] (0) Add an intro section that describes the	'prefer-online' feature a bit. F [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7454%20-%20%5Be%5D%20%280%29%20Add%20an%20intro%20section%20that%20describes%20the%0A%09%27prefer-online%27%20feature%20a%20bit.%20F%20%5B...%5D&In-Reply-To=%3C20121011230210.319B71C8C0AE%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r7454 - [e] (0) Add an intro section that describes the	'prefer-online' feature a bit. F [...]">whatwg at whatwg.org
       </A><BR>
    <I>Thu Oct 11 16:02:10 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="014316.html">[html5] r7453 - [giow] (3) Improve compatibility for &lt;embed hidden&gt;	Fixing https://www.w3.org/Bu [...]
</A></li>
        <LI>Next message: <A HREF="014318.html">[html5] r7455 - [e] (0) add a non-normative line Affected topics:	Offline Web Applications
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14317">[ date ]</a>
              <a href="thread.html#14317">[ thread ]</a>
              <a href="subject.html#14317">[ subject ]</a>
              <a href="author.html#14317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2012-10-11 16:02:08 -0700 (Thu, 11 Oct 2012)
New Revision: 7454

Modified:
   complete.html
   index
   source
Log:
[e] (0) Add an intro section that describes the 'prefer-online' feature a bit.
Fixing <A HREF="https://www.w3.org/Bugs/Public/show_bug.cgi?id=17651">https://www.w3.org/Bugs/Public/show_bug.cgi?id=17651</A>
Affected topics: HTML, Offline Web Applications

Modified: complete.html
===================================================================
--- complete.html	2012-10-11 19:55:47 UTC (rev 7453)
+++ complete.html	2012-10-11 23:02:08 UTC (rev 7454)
@@ -922,7 +922,8 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-5&gt;&lt;span class=secno&gt;6.7.1 &lt;/span&gt;Introduction&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#appcacheevents&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Event summary&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#supporting-offline-caching-for-legacy-applications&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Supporting offline caching for legacy applications&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#appcacheevents&gt;&lt;span class=secno&gt;6.7.1.2 &lt;/span&gt;Event summary&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#appcache&gt;&lt;span class=secno&gt;6.7.2 &lt;/span&gt;Application caches&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#manifests&gt;&lt;span class=secno&gt;6.7.3 &lt;/span&gt;The cache manifest syntax&lt;/a&gt;
       &lt;ol&gt;
@@ -70770,7 +70771,6 @@
 
    &lt;/li&gt;
 
-&lt;!--FORK--&gt;&lt;!--APPCACHE-PREFER-ONLINE--&gt;
    &lt;li&gt;
 
     &lt;p&gt;If the resource was not fetched from an &lt;a href=#application-cache&gt;application
@@ -72179,7 +72179,7 @@
   &lt;pre&gt;/* clock.css */
 output { font: 2em sans-serif; }&lt;/pre&gt;
   &lt;pre&gt;/* clock.js */
-setTimeout(function () {
+setInterval(function () {
     document.getElementById('clock').value = new Date();
 }, 1000);&lt;/pre&gt;
 
@@ -72193,7 +72193,8 @@
   &lt;pre&gt;CACHE MANIFEST
 clock.html
 clock.css
-clock.js&lt;/pre&gt;
+clock.js
+&lt;/pre&gt;
 
   &lt;p&gt;With a small change to the HTML file, the manifest (served as
   &lt;code&gt;&lt;a href=#text/cache-manifest&gt;text/cache-manifest&lt;/a&gt;&lt;/code&gt;) is linked to the application:&lt;/p&gt;
@@ -72226,14 +72227,61 @@
   before the user agent has updated it, and even applications served
   over TLS can be made to work offline.&lt;/p&gt;
 
-&lt;!--(doesn't currently function)
-  &lt;p&gt;&lt;a href=&quot;<A HREF="http://www.whatwg.org/demos/offline/clock/clock2.html">http://www.whatwg.org/demos/offline/clock/clock2.html</A>&quot;&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
---&gt;
+  &lt;p&gt;&lt;a href=<A HREF="http://www.whatwg.org/demos/offline/clock/live-demo/clock.html">http://www.whatwg.org/demos/offline/clock/live-demo/clock.html</A>&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
 
 
 
-  &lt;h5 id=appcacheevents&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Event summary&lt;/h5&gt;
+  &lt;h5 id=supporting-offline-caching-for-legacy-applications&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Supporting offline caching for legacy applications&lt;/h5&gt;
 
+  &lt;p&gt;The application cache feature works best if the application logic is separate from the
+  application and user data, with the logic (markup, scripts, style sheets, images, etc) listed in
+  the manifest and stored in the application cache, with a finite number of static HTML pages for
+  the application, and with the application and user data stored in Web Storage or a client-side
+  Indexed Database, updated dynamically using Web Sockets, &lt;code&gt;XMLHttpRequest&lt;/code&gt;, server-sent
+  events, or some other similar mechanism.&lt;/p&gt;
+
+  &lt;p&gt;This model results in a fast experience for the user: the application immediately loads, and
+  fresh data is obtained as fast as the network will allow it (possibly while stale data shows).&lt;/p&gt;
+
+  &lt;p&gt;Legacy applications, however, tend to be designed so that the user data and the logic are mixed
+  together in the HTML, with each operation resulting in a new HTML page from the server.&lt;/p&gt;
+
+  &lt;div class=example&gt;
+
+   &lt;p&gt;For example, consider a news application. The typical architecture of such an application,
+   when not using the application cache feature, is that the user fetches the main page, and the
+   server returns a dynamically-generated page with the current headlines and the user interface
+   logic mixed together.&lt;/p&gt;
+
+   &lt;p&gt;A news application designed for the application cache feature, however, would instead have the
+   main page just consist of the logic, and would then have the main page fetch the data separately
+   from the server, e.g. using &lt;code&gt;XMLHttpRequest&lt;/code&gt;.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+  &lt;p&gt;The mixed-content model does not work well with the application cache feature: since the
+  content is cached, it would result in the user always seeing the stale data from the previous time
+  the cache was updated.&lt;/p&gt;
+
+  &lt;p&gt;While there is no way to make the legacy model work as fast as the separated model, it
+  &lt;em&gt;can&lt;/em&gt; at least be retrofitted for offline use using the &lt;a href=#concept-appcache-mode-prefer-online title=concept-appcache-mode-prefer-online&gt;prefer-online&lt;/a&gt; &lt;a href=#concept-appcache-mode title=concept-appcache-mode&gt;application cache mode&lt;/a&gt;. To do so, list all the static
+  resources used by the HTML page you want to have work offline in an &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;application cache manifest&lt;/a&gt;, use the &lt;code title=attr-html-manifest&gt;&lt;a href=#attr-html-manifest&gt;manifest&lt;/a&gt;&lt;/code&gt; attribute to select that manifest from the HTML file,
+  and then add the following line at the bottom of the manifest:&lt;/p&gt;
+
+  &lt;pre&gt;SETTINGS:
+prefer-online
+NETWORK:
+*&lt;/pre&gt;
+
+  &lt;p&gt;This causes the &lt;a href=#application-cache&gt;application cache&lt;/a&gt; to only be used for &lt;a href=#concept-appcache-master title=concept-appcache-master&gt;master entries&lt;/a&gt; when the user is offline, and causes the
+  application cache to be used as an atomic HTTP cache (essentially pinning resources listed in the
+  manifest), while allowing all resources not listed in the manifest to be accessed normally when
+  the user is online.&lt;/p&gt;
+
+
+
+  &lt;h5 id=appcacheevents&gt;&lt;span class=secno&gt;6.7.1.2 &lt;/span&gt;Event summary&lt;/h5&gt;
+
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
 
   &lt;p&gt;When the user visits a page that declares a manifest, the browser

Modified: index
===================================================================
--- index	2012-10-11 19:55:47 UTC (rev 7453)
+++ index	2012-10-11 23:02:08 UTC (rev 7454)
@@ -922,7 +922,8 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-5&gt;&lt;span class=secno&gt;6.7.1 &lt;/span&gt;Introduction&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#appcacheevents&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Event summary&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#supporting-offline-caching-for-legacy-applications&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Supporting offline caching for legacy applications&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#appcacheevents&gt;&lt;span class=secno&gt;6.7.1.2 &lt;/span&gt;Event summary&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#appcache&gt;&lt;span class=secno&gt;6.7.2 &lt;/span&gt;Application caches&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#manifests&gt;&lt;span class=secno&gt;6.7.3 &lt;/span&gt;The cache manifest syntax&lt;/a&gt;
       &lt;ol&gt;
@@ -70770,7 +70771,6 @@
 
    &lt;/li&gt;
 
-&lt;!--FORK--&gt;&lt;!--APPCACHE-PREFER-ONLINE--&gt;
    &lt;li&gt;
 
     &lt;p&gt;If the resource was not fetched from an &lt;a href=#application-cache&gt;application
@@ -72179,7 +72179,7 @@
   &lt;pre&gt;/* clock.css */
 output { font: 2em sans-serif; }&lt;/pre&gt;
   &lt;pre&gt;/* clock.js */
-setTimeout(function () {
+setInterval(function () {
     document.getElementById('clock').value = new Date();
 }, 1000);&lt;/pre&gt;
 
@@ -72193,7 +72193,8 @@
   &lt;pre&gt;CACHE MANIFEST
 clock.html
 clock.css
-clock.js&lt;/pre&gt;
+clock.js
+&lt;/pre&gt;
 
   &lt;p&gt;With a small change to the HTML file, the manifest (served as
   &lt;code&gt;&lt;a href=#text/cache-manifest&gt;text/cache-manifest&lt;/a&gt;&lt;/code&gt;) is linked to the application:&lt;/p&gt;
@@ -72226,14 +72227,61 @@
   before the user agent has updated it, and even applications served
   over TLS can be made to work offline.&lt;/p&gt;
 
-&lt;!--(doesn't currently function)
-  &lt;p&gt;&lt;a href=&quot;<A HREF="http://www.whatwg.org/demos/offline/clock/clock2.html">http://www.whatwg.org/demos/offline/clock/clock2.html</A>&quot;&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
---&gt;
+  &lt;p&gt;&lt;a href=<A HREF="http://www.whatwg.org/demos/offline/clock/live-demo/clock.html">http://www.whatwg.org/demos/offline/clock/live-demo/clock.html</A>&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
 
 
 
-  &lt;h5 id=appcacheevents&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Event summary&lt;/h5&gt;
+  &lt;h5 id=supporting-offline-caching-for-legacy-applications&gt;&lt;span class=secno&gt;6.7.1.1 &lt;/span&gt;Supporting offline caching for legacy applications&lt;/h5&gt;
 
+  &lt;p&gt;The application cache feature works best if the application logic is separate from the
+  application and user data, with the logic (markup, scripts, style sheets, images, etc) listed in
+  the manifest and stored in the application cache, with a finite number of static HTML pages for
+  the application, and with the application and user data stored in Web Storage or a client-side
+  Indexed Database, updated dynamically using Web Sockets, &lt;code&gt;XMLHttpRequest&lt;/code&gt;, server-sent
+  events, or some other similar mechanism.&lt;/p&gt;
+
+  &lt;p&gt;This model results in a fast experience for the user: the application immediately loads, and
+  fresh data is obtained as fast as the network will allow it (possibly while stale data shows).&lt;/p&gt;
+
+  &lt;p&gt;Legacy applications, however, tend to be designed so that the user data and the logic are mixed
+  together in the HTML, with each operation resulting in a new HTML page from the server.&lt;/p&gt;
+
+  &lt;div class=example&gt;
+
+   &lt;p&gt;For example, consider a news application. The typical architecture of such an application,
+   when not using the application cache feature, is that the user fetches the main page, and the
+   server returns a dynamically-generated page with the current headlines and the user interface
+   logic mixed together.&lt;/p&gt;
+
+   &lt;p&gt;A news application designed for the application cache feature, however, would instead have the
+   main page just consist of the logic, and would then have the main page fetch the data separately
+   from the server, e.g. using &lt;code&gt;XMLHttpRequest&lt;/code&gt;.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+  &lt;p&gt;The mixed-content model does not work well with the application cache feature: since the
+  content is cached, it would result in the user always seeing the stale data from the previous time
+  the cache was updated.&lt;/p&gt;
+
+  &lt;p&gt;While there is no way to make the legacy model work as fast as the separated model, it
+  &lt;em&gt;can&lt;/em&gt; at least be retrofitted for offline use using the &lt;a href=#concept-appcache-mode-prefer-online title=concept-appcache-mode-prefer-online&gt;prefer-online&lt;/a&gt; &lt;a href=#concept-appcache-mode title=concept-appcache-mode&gt;application cache mode&lt;/a&gt;. To do so, list all the static
+  resources used by the HTML page you want to have work offline in an &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;application cache manifest&lt;/a&gt;, use the &lt;code title=attr-html-manifest&gt;&lt;a href=#attr-html-manifest&gt;manifest&lt;/a&gt;&lt;/code&gt; attribute to select that manifest from the HTML file,
+  and then add the following line at the bottom of the manifest:&lt;/p&gt;
+
+  &lt;pre&gt;SETTINGS:
+prefer-online
+NETWORK:
+*&lt;/pre&gt;
+
+  &lt;p&gt;This causes the &lt;a href=#application-cache&gt;application cache&lt;/a&gt; to only be used for &lt;a href=#concept-appcache-master title=concept-appcache-master&gt;master entries&lt;/a&gt; when the user is offline, and causes the
+  application cache to be used as an atomic HTTP cache (essentially pinning resources listed in the
+  manifest), while allowing all resources not listed in the manifest to be accessed normally when
+  the user is online.&lt;/p&gt;
+
+
+
+  &lt;h5 id=appcacheevents&gt;&lt;span class=secno&gt;6.7.1.2 &lt;/span&gt;Event summary&lt;/h5&gt;
+
   &lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;
 
   &lt;p&gt;When the user visits a page that declares a manifest, the browser

Modified: source
===================================================================
--- source	2012-10-11 19:55:47 UTC (rev 7453)
+++ source	2012-10-11 23:02:08 UTC (rev 7454)
@@ -82834,7 +82834,6 @@
 
    &lt;/li&gt;
 
-&lt;!--END w3c-html--&gt;&lt;!--FORK--&gt;&lt;!--APPCACHE-PREFER-ONLINE--&gt;
    &lt;li&gt;
 
     &lt;p&gt;If the resource was not fetched from an &lt;span&gt;application
@@ -84497,12 +84496,64 @@
   before the user agent has updated it, and even applications served
   over TLS can be made to work offline.&lt;/p&gt;
 
-&lt;!--(doesn't currently function)
-  &lt;p&gt;&lt;a href=&quot;<A HREF="http://www.whatwg.org/demos/offline/clock/clock2.html">http://www.whatwg.org/demos/offline/clock/clock2.html</A>&quot;&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
---&gt;
+  &lt;p&gt;&lt;a href=&quot;<A HREF="http://www.whatwg.org/demos/offline/clock/live-demo/clock.html">http://www.whatwg.org/demos/offline/clock/live-demo/clock.html</A>&quot;&gt;View this example online&lt;/a&gt;.&lt;/p&gt;
 
 
 
+  &lt;h5&gt;Supporting offline caching for legacy applications&lt;/h5&gt;
+
+  &lt;p&gt;The application cache feature works best if the application logic is separate from the
+  application and user data, with the logic (markup, scripts, style sheets, images, etc) listed in
+  the manifest and stored in the application cache, with a finite number of static HTML pages for
+  the application, and with the application and user data stored in Web Storage or a client-side
+  Indexed Database, updated dynamically using Web Sockets, &lt;code&gt;XMLHttpRequest&lt;/code&gt;, server-sent
+  events, or some other similar mechanism.&lt;/p&gt;
+
+  &lt;p&gt;This model results in a fast experience for the user: the application immediately loads, and
+  fresh data is obtained as fast as the network will allow it (possibly while stale data shows).&lt;/p&gt;
+
+  &lt;p&gt;Legacy applications, however, tend to be designed so that the user data and the logic are mixed
+  together in the HTML, with each operation resulting in a new HTML page from the server.&lt;/p&gt;
+
+  &lt;div class=&quot;example&quot;&gt;
+
+   &lt;p&gt;For example, consider a news application. The typical architecture of such an application,
+   when not using the application cache feature, is that the user fetches the main page, and the
+   server returns a dynamically-generated page with the current headlines and the user interface
+   logic mixed together.&lt;/p&gt;
+
+   &lt;p&gt;A news application designed for the application cache feature, however, would instead have the
+   main page just consist of the logic, and would then have the main page fetch the data separately
+   from the server, e.g. using &lt;code&gt;XMLHttpRequest&lt;/code&gt;.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+  &lt;p&gt;The mixed-content model does not work well with the application cache feature: since the
+  content is cached, it would result in the user always seeing the stale data from the previous time
+  the cache was updated.&lt;/p&gt;
+
+  &lt;p&gt;While there is no way to make the legacy model work as fast as the separated model, it
+  &lt;em&gt;can&lt;/em&gt; at least be retrofitted for offline use using the &lt;span
+  title=&quot;concept-appcache-mode-prefer-online&quot;&gt;prefer-online&lt;/span&gt; &lt;span
+  title=&quot;concept-appcache-mode&quot;&gt;application cache mode&lt;/span&gt;. To do so, list all the static
+  resources used by the HTML page you want to have work offline in an &lt;span
+  title=&quot;concept-appcache-manifest&quot;&gt;application cache manifest&lt;/span&gt;, use the &lt;code
+  title=&quot;attr-html-manifest&quot;&gt;manifest&lt;/code&gt; attribute to select that manifest from the HTML file,
+  and then add the following line at the bottom of the manifest:&lt;/p&gt;
+
+  &lt;pre&gt;SETTINGS:
+prefer-online
+NETWORK:
+*&lt;/pre&gt;
+
+  &lt;p&gt;This causes the &lt;span&gt;application cache&lt;/span&gt; to only be used for &lt;span
+  title=&quot;concept-appcache-master&quot;&gt;master entries&lt;/span&gt; when the user is offline, and causes the
+  application cache to be used as an atomic HTTP cache (essentially pinning resources listed in the
+  manifest), while allowing all resources not listed in the manifest to be accessed normally when
+  the user is online.&lt;/p&gt;
+
+
+
   &lt;h5 id=&quot;appcacheevents&quot;&gt;Event summary&lt;/h5&gt;
 
   &lt;!--END dev-html--&gt;&lt;p&gt;&lt;i&gt;This section is non-normative.&lt;/i&gt;&lt;/p&gt;&lt;!--START dev-html--&gt;


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014316.html">[html5] r7453 - [giow] (3) Improve compatibility for &lt;embed hidden&gt;	Fixing https://www.w3.org/Bu [...]
</A></li>
	<LI>Next message: <A HREF="014318.html">[html5] r7455 - [e] (0) add a non-normative line Affected topics:	Offline Web Applications
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14317">[ date ]</a>
              <a href="thread.html#14317">[ thread ]</a>
              <a href="subject.html#14317">[ subject ]</a>
              <a href="author.html#14317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
