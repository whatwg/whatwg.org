<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r7341 - [giow] (3) Attempt to actually define what Referer	headers are used for a whole [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7341%20-%20%5Bgiow%5D%20%283%29%20Attempt%20to%20actually%20define%20what%20Referer%0A%09headers%20are%20used%20for%20a%20whole%20%5B...%5D&In-Reply-To=%3C20120912231446.E133D9C7C23A%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014203.html">
   <LINK REL="Next"  HREF="014205.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r7341 - [giow] (3) Attempt to actually define what Referer	headers are used for a whole [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7341%20-%20%5Bgiow%5D%20%283%29%20Attempt%20to%20actually%20define%20what%20Referer%0A%09headers%20are%20used%20for%20a%20whole%20%5B...%5D&In-Reply-To=%3C20120912231446.E133D9C7C23A%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r7341 - [giow] (3) Attempt to actually define what Referer	headers are used for a whole [...]">whatwg at whatwg.org
       </A><BR>
    <I>Wed Sep 12 16:14:46 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="014203.html">[html5] r7340 - [e] (0) Make this more consistent with other prose,	for clarity. Fixing https:// [...]
</A></li>
        <LI>Next message: <A HREF="014205.html">[html5] r7342 - [e] (0) update for CORS Affected topics: HTML
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14204">[ date ]</a>
              <a href="thread.html#14204">[ thread ]</a>
              <a href="subject.html#14204">[ subject ]</a>
              <a href="author.html#14204">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2012-09-12 16:14:45 -0700 (Wed, 12 Sep 2012)
New Revision: 7341

Modified:
   complete.html
   index
   source
Log:
[giow] (3) Attempt to actually define what Referer headers are used for a whole host of things that were poorly defined. Also: cleanup of a bunch of editorial mistakes I found from past such attempts. Mark every fetch algorithm use for sanity in the future. Block data:, javascript:, and about:blank referrers. Note: This relies on not-yet-done changes to CORS and XHR.
Affected topics: DOM APIs, HTML, Offline Web Applications, Server-Sent Events, Video Text Tracks, Video and Audio, Web Workers

Modified: complete.html
===================================================================
--- complete.html	2012-09-12 07:21:58 UTC (rev 7340)
+++ complete.html	2012-09-12 23:14:45 UTC (rev 7341)
@@ -365,12 +365,13 @@
      &lt;li&gt;&lt;a href=#interfaces-for-url-manipulation&gt;&lt;span class=secno&gt;2.6.7 &lt;/span&gt;Interfaces for URL manipulation&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#fetching-resources&gt;&lt;span class=secno&gt;2.7 &lt;/span&gt;Fetching resources&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#concept-http-equivalent&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Protocol concepts&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#content-type-sniffing&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Determining the type of a resource&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Extracting encodings from &lt;code&gt;meta&lt;/code&gt; elements&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;CORS settings attributes&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS-enabled fetch&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#terminology-1&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Terminology&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#content-type-sniffing&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Determining the type of a resource&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;Extracting encodings from &lt;code&gt;meta&lt;/code&gt; elements&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS settings attributes&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.7 &lt;/span&gt;CORS-enabled fetch&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#common-dom-interfaces&gt;&lt;span class=secno&gt;2.8 &lt;/span&gt;Common DOM interfaces&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#reflecting-content-attributes-in-idl-attributes&gt;&lt;span class=secno&gt;2.8.1 &lt;/span&gt;Reflecting content attributes in IDL attributes&lt;/a&gt;&lt;/li&gt;
@@ -635,7 +636,7 @@
      &lt;li&gt;&lt;a href=#image-maps&gt;&lt;span class=secno&gt;4.8.14 &lt;/span&gt;Image maps&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#authoring&gt;&lt;span class=secno&gt;4.8.14.1 &lt;/span&gt;Authoring&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#processing-model&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#processing-model-0&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#mathml&gt;&lt;span class=secno&gt;4.8.15 &lt;/span&gt;MathML&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#svg-0&gt;&lt;span class=secno&gt;4.8.16 &lt;/span&gt;SVG&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#dimension-attributes&gt;&lt;span class=secno&gt;4.8.17 &lt;/span&gt;Dimension attributes&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
@@ -655,7 +656,7 @@
      &lt;li&gt;&lt;a href=#the-td-element&gt;&lt;span class=secno&gt;4.9.9 &lt;/span&gt;The &lt;code&gt;td&lt;/code&gt; element&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-th-element&gt;&lt;span class=secno&gt;4.9.10 &lt;/span&gt;The &lt;code&gt;th&lt;/code&gt; element&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#attributes-common-to-td-and-th-elements&gt;&lt;span class=secno&gt;4.9.11 &lt;/span&gt;Attributes common to &lt;code&gt;td&lt;/code&gt; and &lt;code&gt;th&lt;/code&gt; elements&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-0&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#processing-model-1&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#forming-a-table&gt;&lt;span class=secno&gt;4.9.12.1 &lt;/span&gt;Forming a table&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#header-and-data-cell-semantics&gt;&lt;span class=secno&gt;4.9.12.2 &lt;/span&gt;Forming relationships between data cells and header cells&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
@@ -936,7 +937,7 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-6&gt;&lt;span class=secno&gt;7.1.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#enabling-and-disabling-scripting&gt;&lt;span class=secno&gt;7.1.2 &lt;/span&gt;Enabling and disabling scripting&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-1&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#processing-model-2&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#definitions-0&gt;&lt;span class=secno&gt;7.1.3.1 &lt;/span&gt;Definitions&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#calling-scripts&gt;&lt;span class=secno&gt;7.1.3.2 &lt;/span&gt;Calling scripts&lt;/a&gt;&lt;/li&gt;
@@ -948,7 +949,7 @@
      &lt;li&gt;&lt;a href=#event-loops&gt;&lt;span class=secno&gt;7.1.4 &lt;/span&gt;Event loops&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#definitions-1&gt;&lt;span class=secno&gt;7.1.4.1 &lt;/span&gt;Definitions&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#processing-model-2&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#processing-model-3&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#generic-task-sources&gt;&lt;span class=secno&gt;7.1.4.3 &lt;/span&gt;Generic task sources&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#javascript-protocol&gt;&lt;span class=secno&gt;7.1.5 &lt;/span&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; URL scheme&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#events&gt;&lt;span class=secno&gt;7.1.6 &lt;/span&gt;Events&lt;/a&gt;
@@ -991,7 +992,7 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-7&gt;&lt;span class=secno&gt;8.5.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-accesskey-attribute&gt;&lt;span class=secno&gt;8.5.2 &lt;/span&gt;The &lt;code&gt;accesskey&lt;/code&gt; attribute&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-3&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model-4&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#editing-0&gt;&lt;span class=secno&gt;8.6 &lt;/span&gt;Editing&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#contenteditable&gt;&lt;span class=secno&gt;8.6.1 &lt;/span&gt;Making document regions editable: The &lt;code title=attr-contenteditable&gt;contenteditable&lt;/code&gt; content
@@ -1040,7 +1041,7 @@
        &lt;li&gt;&lt;a href=#shared-workers-and-the-sharedworkerglobalscope-interface&gt;&lt;span class=secno&gt;9.2.1.3 &lt;/span&gt;Shared workers and the &lt;code&gt;SharedWorkerGlobalScope&lt;/code&gt; interface&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-event-loop&gt;&lt;span class=secno&gt;9.2.2 &lt;/span&gt;The event loop&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#the-worker's-lifetime&quot;&gt;&lt;span class=secno&gt;9.2.3 &lt;/span&gt;The worker's lifetime&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-4&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model-5&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#runtime-script-errors-0&gt;&lt;span class=secno&gt;9.2.5 &lt;/span&gt;Runtime script errors&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#creating-workers&gt;&lt;span class=secno&gt;9.2.6 &lt;/span&gt;Creating workers&lt;/a&gt;
       &lt;ol&gt;
@@ -1060,7 +1061,7 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#server-sent-events-intro&gt;&lt;span class=secno&gt;10.2.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-eventsource-interface&gt;&lt;span class=secno&gt;10.2.2 &lt;/span&gt;The &lt;code&gt;EventSource&lt;/code&gt; interface&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-5&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model-6&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#parsing-an-event-stream&gt;&lt;span class=secno&gt;10.2.4 &lt;/span&gt;Parsing an event stream&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#event-stream-interpretation&gt;&lt;span class=secno&gt;10.2.5 &lt;/span&gt;Interpreting an event stream&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#notes&gt;&lt;span class=secno&gt;10.2.6 &lt;/span&gt;Notes&lt;/a&gt;&lt;/li&gt;
@@ -4248,9 +4249,10 @@
     &lt;p&gt;This specification references the XMLHttpRequest specification
     to define how the two specifications interact. The terms
     &lt;dfn id=document-response-entity-body&gt;document response entity body&lt;/dfn&gt;,
-    &lt;dfn id=xmlhttprequest-base-url&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/dfn&gt;, and
-    &lt;dfn id=xmlhttprequest-origin&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/dfn&gt; are defined in that
-    specification. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/p&gt;
+    &lt;dfn id=xmlhttprequest-base-url&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/dfn&gt;,
+    &lt;dfn id=xmlhttprequest-origin&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/dfn&gt;, and
+    &lt;dfn id=xmlhttprequest-referrer-source&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; referrer source&lt;/dfn&gt; are defined
+    in that specification. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -8308,8 +8310,38 @@
 
   &lt;h3 id=fetching-resources&gt;&lt;span class=secno&gt;2.7 &lt;/span&gt;Fetching resources&lt;/h3&gt;
 
-  &lt;p&gt;When a user agent is to &lt;dfn id=fetch&gt;fetch&lt;/dfn&gt; a resource or
-  &lt;a href=#url&gt;URL&lt;/a&gt;, optionally from an origin &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;,
+  &lt;h4 id=terminology-1&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Terminology&lt;/h4&gt;
+
+  &lt;p id=concept-http-equivalent&gt;User agents can implement a variety
+  of transfer protocols, but this specification mostly defines
+  behavior in terms of HTTP. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-get title=concept-http-equivalent-get&gt;HTTP GET
+  method&lt;/dfn&gt; is equivalent to the default retrieval action of the
+  protocol. For example, RETR in FTP. Such actions are idempotent and
+  safe, in HTTP terms.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;HTTP response
+  codes&lt;/dfn&gt; are equivalent to statuses in other protocols that have
+  the same basic meanings. For example, a &quot;file not found&quot; error is
+  equivalent to a 404 code, a server error is equivalent to a 5xx
+  code, and so on.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-headers title=concept-http-equivalent-headers&gt;HTTP
+  headers&lt;/dfn&gt; are equivalent to fields in other protocols that have
+  the same basic meaning. For example, the HTTP authentication
+  headers are equivalent to the authentication aspects of the FTP
+  protocol.&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;A &lt;dfn id=referrer-source&gt;referrer source&lt;/dfn&gt; is either a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; or
+  a &lt;a href=#url&gt;URL&lt;/a&gt;.&lt;/p&gt;
+
+
+  &lt;h4 id=processing-model&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Processing model&lt;/h4&gt;
+
+  &lt;p&gt;When a user agent is to &lt;dfn id=fetch&gt;fetch&lt;/dfn&gt;&lt;!--FETCH--&gt; a resource
+  or &lt;a href=#url&gt;URL&lt;/a&gt;, optionally &lt;strong&gt;from&lt;/strong&gt; an origin &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, optionally &lt;strong&gt;using&lt;/strong&gt; a specific
+  &lt;a href=#referrer-source&gt;referrer source&lt;/a&gt; as an &lt;i&gt;override referrer source&lt;/i&gt;,
   and optionally with a &lt;i&gt;synchronous flag&lt;/i&gt;, a &lt;i&gt;manual redirect
   flag&lt;/i&gt;, a &lt;i&gt;force same-origin flag&lt;/i&gt;, and/or a &lt;i&gt;block cookies
   flag&lt;/i&gt;, the following steps must be run. (When a &lt;em&gt;URL&lt;/em&gt; is
@@ -8330,25 +8362,32 @@
 
   &lt;!-- &quot;block cookies&quot; is currently only used by XHR --&gt;
 
-  &lt;ol&gt;&lt;li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If there is a specific &lt;i&gt;override referrer source&lt;/i&gt;, and
+   it is a &lt;a href=#url&gt;URL&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; be
+   the &lt;i&gt;override referrer source&lt;/i&gt;, and jump to the step labeled
+   &lt;i&gt;clean referrer&lt;/i&gt;.&lt;/li&gt;
 
+   &lt;li&gt;
+
     &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; be the appropriate
     &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; as given by the following list:&lt;/p&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;When &lt;a href=#navigate title=navigate&gt;navigating&lt;/a&gt;&lt;/dt&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If there is a specific &lt;i&gt;override referrer source&lt;/i&gt;&lt;/dt&gt;
 
+     &lt;dd&gt;The &lt;i&gt;override referrer source&lt;/i&gt;.&lt;/dd&gt;
+
+
+     &lt;dt&gt;When &lt;a href=#navigate title=navigate&gt;navigating&lt;/a&gt;&lt;/dt&gt;
+
      &lt;dd&gt;The &lt;a href=#active-document&gt;active document&lt;/a&gt; of the &lt;a href=#source-browsing-context&gt;source browsing
      context&lt;/a&gt;.&lt;/dd&gt;
 
+
      &lt;dt&gt;When fetching resources for an element&lt;/dt&gt;
 
      &lt;dd&gt;The element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;When fetching resources in response to a call to an API&lt;/dt&gt;
 
-     &lt;dd&gt;The &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-document&quot; title=&quot;script's
-     document&quot;&gt;document&lt;/a&gt;.&lt;/dd&gt;
-
     &lt;/dl&gt;&lt;/li&gt;
 
    &lt;li&gt;
@@ -8363,22 +8402,40 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Generate the &lt;i&gt;address of the resource from which Request-URIs
-    are obtained&lt;/i&gt; as required by HTTP for the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header from &lt;a href=&quot;#the-document's-address&quot;&gt;the
-    document's address&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+    &lt;p&gt;If the &lt;a href=#origin&gt;origin&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;Document&lt;/var&gt; is
+    not a scheme/host/port tuple, then set &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; to the empty string and jump to the step
+    labeled &lt;i&gt;clean referrer&lt;/i&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Remove any &lt;a href=#url-fragment title=url-fragment&gt;&lt;fragment&gt;&lt;/a&gt;
-    component from the generated &lt;i&gt;address of the resource from which
-    Request-URIs are obtained&lt;/i&gt;.&lt;/p&gt; &lt;!-- RFC2616 says &quot;The URI MUST
-    NOT include a fragment.&quot; (section 14.36) --&gt;
+   &lt;/li&gt;
 
-    &lt;p&gt;If the &lt;a href=#origin&gt;origin&lt;/a&gt; of the appropriate
-    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is not a scheme/host/port tuple, then the
-    &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header must be
-    omitted, regardless of its value.&lt;/p&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; be &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
+    address&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;&lt;i&gt;Clean referrer&lt;/i&gt;: Remove any &lt;a href=#url-fragment title=url-fragment&gt;&lt;fragment&gt;&lt;/a&gt; component from &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt;.&lt;/p&gt; &lt;!-- RFC2616 says &quot;The URI MUST NOT
+    include a fragment.&quot; (section 14.36) --&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; is not the empty string, is not
+    a &lt;a href=#data-protocol title=&quot;data protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;data:&lt;/code&gt;
+    URL&lt;/a&gt;, is not a &lt;a href=#javascript-protocol title=&quot;javascript protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; URL&lt;/a&gt;, and is not the
+    &lt;a href=#url&gt;URL&lt;/a&gt; &quot;&lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt;&quot;, then generate the
+    &lt;i&gt;address of the resource from which Request-URIs are
+    obtained&lt;/i&gt; as required by HTTP for the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header from &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt;. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic)
+    header must be omitted, regardless of its value.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;If the algorithm was not invoked with the &lt;i&gt;synchronous
    flag&lt;/i&gt;, perform the remaining steps asynchronously.&lt;/li&gt;
 
@@ -8541,31 +8598,8 @@
   applicable.&lt;/p&gt;
 
 
-  &lt;h4 id=concept-http-equivalent&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Protocol concepts&lt;/h4&gt;
-
-  &lt;p&gt;User agents can implement a variety of transfer protocols, but
-  this specification mostly defines behavior in terms of HTTP. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-get title=concept-http-equivalent-get&gt;HTTP GET
-  method&lt;/dfn&gt; is equivalent to the default retrieval action of the
-  protocol. For example, RETR in FTP. Such actions are idempotent and
-  safe, in HTTP terms.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;HTTP response
-  codes&lt;/dfn&gt; are equivalent to statuses in other protocols that have
-  the same basic meanings. For example, a &quot;file not found&quot; error is
-  equivalent to a 404 code, a server error is equivalent to a 5xx
-  code, and so on.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-headers title=concept-http-equivalent-headers&gt;HTTP
-  headers&lt;/dfn&gt; are equivalent to fields in other protocols that have
-  the same basic meaning. For example, the HTTP authentication
-  headers are equivalent to the authentication aspects of the FTP
-  protocol.&lt;/p&gt;
-
-
 &lt;!--ADD-TOPIC:Security--&gt;
-  &lt;h4 id=encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/h4&gt;
+  &lt;h4 id=encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/h4&gt;
 
   &lt;p&gt;Anything in this specification that refers to HTTP also applies
   to HTTP-over-TLS, as represented by &lt;a href=#url title=url&gt;URLs&lt;/a&gt;
@@ -8612,7 +8646,7 @@
 &lt;!--REMOVE-TOPIC:Security--&gt;
 
 
-  &lt;h4 id=content-type-sniffing&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Determining the type of a resource&lt;/h4&gt;
+  &lt;h4 id=content-type-sniffing&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Determining the type of a resource&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=content-type title=Content-Type&gt;Content-Type metadata&lt;/dfn&gt; of a
   resource must be obtained and interpreted in a manner consistent
@@ -8639,7 +8673,7 @@
   Media Type Sniffing specification. &lt;a href=#refsMIMESNIFF&gt;[MIMESNIFF]&lt;/a&gt;&lt;/p&gt;
 
 
-  &lt;h4 id=extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Extracting encodings from &lt;code&gt;&lt;a href=#the-meta-element&gt;meta&lt;/a&gt;&lt;/code&gt; elements&lt;/h4&gt;
+  &lt;h4 id=extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;Extracting encodings from &lt;code&gt;&lt;a href=#the-meta-element&gt;meta&lt;/a&gt;&lt;/code&gt; elements&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=algorithm-for-extracting-an-encoding-from-a-meta-element&gt;algorithm for extracting an encoding from a
   &lt;code&gt;meta&lt;/code&gt; element&lt;/dfn&gt;, given a string &lt;var title=&quot;&quot;&gt;s&lt;/var&gt;, is as follows. It either returns an encoding or
@@ -8697,7 +8731,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;CORS settings attributes&lt;/h4&gt;
+  &lt;h4 id=cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS settings attributes&lt;/h4&gt;
 
   &lt;p&gt;A &lt;dfn id=cors-settings-attribute&gt;CORS settings attribute&lt;/dfn&gt; is an &lt;a href=#enumerated-attribute&gt;enumerated
   attribute&lt;/a&gt;. The following table lists the keywords and states
@@ -8721,19 +8755,19 @@
 
 
   &lt;div class=impl&gt;
-  &lt;h4 id=cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS-enabled fetch&lt;/h4&gt;
+  &lt;h4 id=cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.7 &lt;/span&gt;CORS-enabled fetch&lt;/h4&gt;
 
   &lt;p&gt;When the user agent is required to perform a &lt;dfn id=potentially-cors-enabled-fetch&gt;potentially
-  CORS-enabled fetch&lt;/dfn&gt; of an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with a mode &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; that is
+  CORS-enabled fetch&lt;/dfn&gt; of an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; with a mode &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; that is
   either &quot;&lt;a href=#attr-crossorigin-none title=attr-crossorigin-none&gt;No CORS&lt;/a&gt;&quot;, &quot;&lt;a href=#attr-crossorigin-anonymous title=attr-crossorigin-anonymous&gt;Anonymous&lt;/a&gt;&quot;, or &quot;&lt;a href=#attr-crossorigin-use-credentials title=attr-crossorigin-use-credentials&gt;Use Credentials&lt;/a&gt;&quot;,
-  an &lt;a href=#origin&gt;origin&lt;/a&gt; &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and a default
-  origin behaviour &lt;var title=&quot;&quot;&gt;default&lt;/var&gt; which is either
-  &quot;&lt;i&gt;taint&lt;/i&gt;&quot; or &quot;&lt;i&gt;fail&lt;/i&gt;&quot;, it must run the first applicable
-  set of steps from the following list. The default origin behaviour
-  is only used if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-none title=attr-crossorigin-none&gt;No CORS&lt;/a&gt;&quot;. This algorithm wraps
-  the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm above, and labels the obtained
-  resource as either &lt;dfn id=cors-same-origin&gt;CORS-same-origin&lt;/dfn&gt; or
-  &lt;dfn id=cors-cross-origin&gt;CORS-cross-origin&lt;/dfn&gt;, or blocks the resource entirely.&lt;/p&gt;
+  optionally using a &lt;a href=#referrer-source&gt;referrer source&lt;/a&gt; &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt;, with an &lt;a href=#origin&gt;origin&lt;/a&gt; &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and with a default origin behaviour &lt;var title=&quot;&quot;&gt;default&lt;/var&gt; which is either &quot;&lt;i&gt;taint&lt;/i&gt;&quot; or
+  &quot;&lt;i&gt;fail&lt;/i&gt;&quot;, it must run the first applicable set of steps from
+  the following list. The default origin behaviour is only used if
+  &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-none title=attr-crossorigin-none&gt;No
+  CORS&lt;/a&gt;&quot;. This algorithm wraps the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm
+  above, and labels the obtained resource as either
+  &lt;dfn id=cors-same-origin&gt;CORS-same-origin&lt;/dfn&gt; or &lt;dfn id=cors-cross-origin&gt;CORS-cross-origin&lt;/dfn&gt;, or
+  blocks the resource entirely.&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;&lt;/dt&gt;
    &lt;dt&gt;If the &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; is a &lt;a href=#data-protocol title=&quot;data protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;data:&lt;/code&gt; URL&lt;/a&gt;&lt;/dt&gt;
@@ -8744,9 +8778,10 @@
 
     &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with the
-     &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/li&gt; &lt;!-- http-origin privacy
-     sensitive --&gt;
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;,
+     using &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified,
+     with the &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/li&gt; &lt;!-- http-origin
+     privacy sensitive --&gt;
 
      &lt;li&gt;&lt;p&gt;&lt;i&gt;Loop&lt;/i&gt;: Wait for the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm
      to know if the result is a redirect or not.&lt;/li&gt;
@@ -8810,7 +8845,8 @@
     &lt;p class=note&gt;The &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; does not have the
     &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;.&lt;/p&gt;
 
-    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;.&lt;/p&gt; &lt;!--
+    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, using
+    &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified.&lt;/p&gt; &lt;!--
     http-origin privacy sensitive --&gt;
 
     &lt;p&gt;The &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; from the
@@ -8854,10 +8890,11 @@
 
     &lt;p&gt;Run these steps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Perform a &lt;a href=#cross-origin-request&gt;cross-origin request&lt;/a&gt; with the
-     &lt;i&gt;request URL&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, the &lt;i&gt;source
-     origin&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and the &lt;i&gt;&lt;a href=#omit-credentials-flag&gt;omit
-     credentials flag&lt;/a&gt;&lt;/i&gt; set if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-anonymous title=attr-crossorigin-anonymous&gt;Anonymous&lt;/a&gt;&quot; and not set
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Perform a &lt;a href=#cross-origin-request&gt;cross-origin request&lt;/a&gt;&lt;!--FETCH--&gt;
+     with the &lt;i&gt;request URL&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, using
+     &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified, with
+     the &lt;i&gt;source origin&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and
+     with the &lt;i&gt;&lt;a href=#omit-credentials-flag&gt;omit credentials flag&lt;/a&gt;&lt;/i&gt; set if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-anonymous title=attr-crossorigin-anonymous&gt;Anonymous&lt;/a&gt;&quot; and not set
      otherwise. &lt;a href=#refsCORS&gt;[CORS]&lt;/a&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Wait for the CORS &lt;a href=#cross-origin-request-status&gt;cross-origin request status&lt;/a&gt;
@@ -10893,9 +10930,12 @@
 
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;success&lt;/var&gt; be false.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; from the
-   &lt;a href=#origin&gt;origin&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, with the &lt;i title=&quot;&quot;&gt;synchronous flag&lt;/i&gt; set and the &lt;i title=&quot;&quot;&gt;force
-   same-origin flag&lt;/i&gt; set.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; from
+   the &lt;a href=#origin&gt;origin&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, using the
+   &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-referrer-source&quot; title=&quot;script's referrer
+   source&quot;&gt;referrer source&lt;/a&gt;, with the &lt;i title=&quot;&quot;&gt;synchronous
+   flag&lt;/i&gt; set and the &lt;i title=&quot;&quot;&gt;force same-origin flag&lt;/i&gt;
+   set.&lt;/li&gt;
 
    &lt;li&gt;
 
@@ -14871,7 +14911,7 @@
 
    &lt;li&gt;&lt;p&gt;If the previous step fails, then abort these steps.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
    URL&lt;/a&gt;.&lt;/li&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;/ol&gt;&lt;p&gt;User agents may opt to only try to obtain such resources when
@@ -16914,7 +16954,7 @@
     attribute whose value is not the empty string, then the value of
     that attribute must be &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt;
     relative to the element, and if that is successful, the specified
-    resource must then be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;, from the
+    resource must then be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;&lt;!--FETCH--&gt;, from the
     &lt;a href=#origin&gt;origin&lt;/a&gt; of the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
     &lt;!-- not http-origin privacy sensitive --&gt;
 
@@ -24559,8 +24599,8 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; that resulted from the earlier step,
+    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of
+    the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; that resulted from the earlier step,
     with the &lt;i&gt;mode&lt;/i&gt; being the state of the element's &lt;code title=attr-img-crossorigin&gt;&lt;a href=#attr-img-crossorigin&gt;crossorigin&lt;/a&gt;&lt;/code&gt; content attribute,
     the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
     &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the
@@ -24944,10 +24984,10 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being
-    &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being
-    the &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element's
+    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of
+    the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt;
+    being &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;
+    being the &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element's
     &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
     to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
 
@@ -27183,16 +27223,17 @@
     &lt;p&gt;The user agent must &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt;
     the value of the element's &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt;
     attribute, relative to the element. If that is successful, the
-    user agent should &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute
-    URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope
-    origin&lt;/a&gt; if it has one&lt;!-- potentially http-origin privacy
-    sensitive --&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is
-    &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking
-    task source&lt;/a&gt; once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must find and instantiate an
-    appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt;, and hand that
-    &lt;a href=#plugin&gt;plugin&lt;/a&gt; the content of the resource, replacing any
-    previously instantiated plugin for the element.&lt;/p&gt; &lt;!-- Note that
-    this doesn't happen when the base URL changes. --&gt;
+    user agent should &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting
+    &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing
+    context scope origin&lt;/a&gt; if it has one&lt;!-- potentially
+    http-origin privacy sensitive --&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is &lt;a href=#queue-a-task title=&quot;queue a
+    task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt;
+    once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must
+    find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on
+    the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt;, and
+    hand that &lt;a href=#plugin&gt;plugin&lt;/a&gt; the content of the resource,
+    replacing any previously instantiated plugin for the element.&lt;/p&gt;
+    &lt;!-- Note that this doesn't happen when the base URL changes. --&gt;
 
     &lt;p&gt;Fetching the resource must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of
     the element's document.&lt;/p&gt;
@@ -27592,15 +27633,17 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;,
-      from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope origin&lt;/a&gt; if
-      it has one&lt;!-- potentially http-origin privacy sensitive
-      --&gt;.&lt;/p&gt;
+      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+      URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope
+      origin&lt;/a&gt; if it has one&lt;!-- potentially http-origin privacy
+      sensitive --&gt;.&lt;/p&gt;
 
-      &lt;!-- similar text in various places --&gt; &lt;p&gt;Fetching the resource
-      must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of the element's document
-      until the &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task
-      source&lt;/a&gt; once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; (defined next) has been run.&lt;/p&gt;
+      &lt;!-- similar text in various places --&gt;
+      &lt;p&gt;Fetching the resource must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt;
+      of the element's document until the &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is &lt;a href=#queue-a-task title=&quot;queue a
+      task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt;
+      once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;
+      (defined next) has been run.&lt;/p&gt;
 
       &lt;p&gt;For the purposes of the &lt;a href=#application-cache&gt;application cache&lt;/a&gt;
       networking model, this &lt;a href=#fetch&gt;fetch&lt;/a&gt; operation is not for a
@@ -28373,10 +28416,10 @@
    to the element. If this fails, then there is no &lt;a href=#poster-frame&gt;poster
    frame&lt;/a&gt;; abort these steps.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;,
-   from the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;.
-   This must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of the element's
-   document.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+   URL&lt;/a&gt;, from the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s
+   &lt;a href=#origin&gt;origin&lt;/a&gt;. This must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of
+   the element's document.&lt;/li&gt;
 
    &lt;!-- could define how to sniff for an image here --&gt;
 
@@ -30064,13 +30107,14 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt;'s &lt;a href=#absolute-url&gt;absolute
-    URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being the state of the
-    &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=attr-media-crossorigin&gt;&lt;a href=#attr-media-crossorigin&gt;crossorigin&lt;/a&gt;&lt;/code&gt; content
-    attribute, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
-    &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the
-    &lt;i&gt;default origin behaviour&lt;/i&gt; set to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
+    &lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled
+    fetch&lt;/a&gt;&lt;!--FETCH--&gt; of the &lt;var title=&quot;&quot;&gt;current media
+    resource&lt;/var&gt;'s &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt;
+    being the state of the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=attr-media-crossorigin&gt;&lt;a href=#attr-media-crossorigin&gt;crossorigin&lt;/a&gt;&lt;/code&gt; content
+    attribute, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the
+    &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
+    to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
 
     &lt;p&gt;The resource obtained in this fashion, if any, contains the
     &lt;a href=#media-data&gt;media data&lt;/a&gt;. It can be &lt;a href=#cors-same-origin&gt;CORS-same-origin&lt;/a&gt;
@@ -34434,7 +34478,7 @@
    &lt;li&gt;
 
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; is not the empty string, perform a
-    &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
+    &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
     mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the
     &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; element's
     &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
@@ -42440,7 +42484,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h5 id=processing-model&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/h5&gt;
+  &lt;h5 id=processing-model-0&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/h5&gt;
 
   &lt;p&gt;If an &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element or an &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element
   representing an image has a &lt;code title=attr-hyperlink-usemap&gt;&lt;a href=#attr-hyperlink-usemap&gt;usemap&lt;/a&gt;&lt;/code&gt; attribute specified,
@@ -44244,7 +44288,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h4 id=processing-model-0&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-1&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;The various table elements and their content attributes together
   define the &lt;dfn id=table-model&gt;table model&lt;/dfn&gt;.&lt;/p&gt;
@@ -51156,10 +51200,10 @@
   or the user agent only fetches elements on demand, or the &lt;code title=attr-input-src&gt;&lt;a href=#attr-input-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute's value is the empty
   string, the user agent must &lt;a href=#resolve-a-url title=&quot;resolve a
   url&quot;&gt;resolve&lt;/a&gt; the value of the &lt;code title=attr-input-src&gt;&lt;a href=#attr-input-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute, relative to the
-  element, and if that is successful, must &lt;a href=#fetch&gt;fetch&lt;/a&gt; the
-  resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT
-  happen when the base URL changes. --&gt; &lt;!-- http-origin privacy
-  sensitive --&gt;
+  element, and if that is successful, must
+  &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+  URL&lt;/a&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT happen when the base URL
+  changes. --&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;ul&gt;&lt;li&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;code title=attr-input-type&gt;&lt;a href=#attr-input-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is first set to the
    &lt;a href=&quot;#image-button-state-(type=image)&quot; title=attr-input-type-image&gt;Image Button&lt;/a&gt; state
@@ -59112,13 +59156,13 @@
    &lt;dd&gt;Append the command to the menu, respecting its &lt;a href=#concept-facet title=concept-facet&gt;facets&lt;/a&gt;&lt;!-- we might need to be
    explicit about what this means for each facet, if testing shows
    this isn't well-implemented. e.g.: If there's an Icon facet for the
-   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; (this
-   would be http-origin privacy-sensitive), and then that image should
-   be associated with the command, such that each command only has its
-   image fetched once, to prevent changes to the base URL from having
-   effects after the image has been fetched once. (no need to resolve
-   the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the element is a
-   &lt;code&gt;command&lt;/code&gt; element with a &lt;code
+   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;&lt;!- -FETCH-
+   -&gt; (this would be http-origin privacy-sensitive), and then that
+   image should be associated with the command, such that each command
+   only has its image fetched once, to prevent changes to the base URL
+   from having effects after the image has been fetched once. (no need
+   to resolve the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the
+   element is a &lt;code&gt;command&lt;/code&gt; element with a &lt;code
    title=&quot;attr-command-default&quot;&gt;default&lt;/code&gt; attribute, mark the
    command as being a default command.--&gt;&lt;/dd&gt;
 
@@ -60744,9 +60788,9 @@
    &lt;li&gt;&lt;p&gt;Return to whatever algorithm invoked these steps and continue
    these steps asynchronously.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; and handle the
-   resulting resource &lt;a href=#as-a-download&gt;as a download&lt;/a&gt;.&lt;/li&gt; &lt;!--
-   http-origin privacy sensitive --&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; and
+   handle the resulting resource &lt;a href=#as-a-download&gt;as a download&lt;/a&gt;.&lt;/li&gt;
+   &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a user agent is to handle a resource obtained from a
   &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm &lt;dfn id=as-a-download&gt;as a download&lt;/dfn&gt;, it should
@@ -60927,9 +60971,7 @@
 
   &lt;/div&gt;
 
-&lt;!--DOWNLOAD--&gt;
 
-
 &lt;!--PING--&gt;
 
   &lt;div class=impl&gt;
@@ -60941,11 +60983,12 @@
   follows the hyperlink, and the value of the element's &lt;code title=attr-hyperlink-href&gt;&lt;a href=#attr-hyperlink-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute can be &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt;, relative to the element,
   without failure, then the user agent must take the &lt;code title=attr-hyperlink-ping&gt;&lt;a href=#ping&gt;ping&lt;/a&gt;&lt;/code&gt; attribute's value, &lt;a href=#split-a-string-on-spaces title=&quot;split a string on spaces&quot;&gt;split that string on spaces&lt;/a&gt;,
   &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt; each resulting token
-  relative to the element, and then should send a request (as
-  described below) to each of the resulting &lt;a href=#absolute-url title=&quot;absolute
-  URL&quot;&gt;absolute URLs&lt;/a&gt;. (Tokens that fail to resolve are
-  ignored.) This may be done in parallel with the primary request, and
-  is independent of the result of that request.&lt;/p&gt;
+  relative to the element, and then each of the resulting &lt;a href=#absolute-url title=&quot;absolute URL&quot;&gt;absolute URLs&lt;/a&gt; should be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;&lt;!--FETCH--&gt; from the
+  &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; containing the
+  &lt;a href=#hyperlink&gt;hyperlink&lt;/a&gt; &lt;!-- not http-origin privacy sensitive --&gt;
+  (as described below). (Tokens that fail to resolve are ignored.)
+  This may be done in parallel with the primary request, and is
+  independent of the result of that request.&lt;/p&gt;
 
   &lt;p&gt;User agents should allow the user to adjust this behavior, for
   example in conjunction with a setting that disables the sending of
@@ -60955,13 +60998,10 @@
   or selectively ignore URLs in the list (e.g. ignoring any
   third-party URLs).&lt;/p&gt;
 
-  &lt;p&gt;For URLs that are HTTP URLs, the requests must be performed by
-  &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; the specified URLs using the
-  POST method, with an entity body with the &lt;a href=#mime-type&gt;MIME type&lt;/a&gt;
+  &lt;p&gt;For URLs that are HTTP URLs, the requests must be performed using
+  the POST method, with an entity body with the &lt;a href=#mime-type&gt;MIME type&lt;/a&gt;
   &lt;code&gt;&lt;a href=#text/ping&gt;text/ping&lt;/a&gt;&lt;/code&gt; consisting of the four-character string
-  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;, from the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
-  &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; containing the &lt;a href=#hyperlink&gt;hyperlink&lt;/a&gt;. &lt;!--
-  not http-origin privacy sensitive --&gt; All relevant cookie and HTTP
+  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;. All relevant cookie and HTTP
   authentication headers must be included in the request. Which other
   headers are required depends on the URLs involved.&lt;/p&gt;
 
@@ -61006,10 +61046,6 @@
   responses. User agents may close the connection prematurely once
   they start receiving an entity body. &lt;a href=#refsCOOKIES&gt;[COOKIES]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;For URLs that are not HTTP URLs, the requests must be performed
-  by &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; the specified URL normally,
-  and discarding the results.&lt;/p&gt;
-
   &lt;p&gt;When the &lt;code title=attr-hyperlink-ping&gt;&lt;a href=#ping&gt;ping&lt;/a&gt;&lt;/code&gt; attribute is
   present, user agents should clearly indicate to the user that
   following the hyperlink will also cause secondary requests to be
@@ -61052,7 +61088,6 @@
 
   &lt;!-- resolving ping urls happens at audit time, so base URL changes
   affect the values of ping attributes --&gt;
-&lt;!--PING--&gt;
 
 
 
@@ -61539,8 +61574,9 @@
 
   &lt;p&gt;In the absence of a &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt; with the &lt;code title=rel-icon&gt;&lt;a href=#rel-icon&gt;icon&lt;/a&gt;&lt;/code&gt; keyword, for &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;s
   obtained over HTTP or HTTPS, user agents may instead attempt to
-  &lt;a href=#fetch&gt;fetch&lt;/a&gt; and use an icon with the &lt;a href=#absolute-url&gt;absolute
-  URL&lt;/a&gt; obtained by resolving the &lt;a href=#url&gt;URL&lt;/a&gt; &quot;&lt;code title=&quot;&quot;&gt;/favicon.ico&lt;/code&gt;&quot; against &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
+  &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; and use an icon with the
+  &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; obtained by resolving the &lt;a href=#url&gt;URL&lt;/a&gt;
+  &quot;&lt;code title=&quot;&quot;&gt;/favicon.ico&lt;/code&gt;&quot; against &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
   address&lt;/a&gt;, as if the page had declared that icon using the
   &lt;code title=rel-icon&gt;&lt;a href=#rel-icon&gt;icon&lt;/a&gt;&lt;/code&gt; keyword.&lt;/p&gt;
 
@@ -70403,8 +70439,8 @@
     application cache at all; the submission will be made to the
     network.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, &lt;a href=#fetch&gt;fetch&lt;/a&gt; the new resource, with the
-    &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/p&gt;
+    &lt;p&gt;Otherwise, &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the new resource,
+    with the &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/p&gt;
 
     &lt;p&gt;If the resource is being fetched using a method other than one
     &lt;a href=#concept-http-equivalent-get title=concept-http-equivalent-get&gt;equivalent to&lt;/a&gt;
@@ -72967,12 +73003,12 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource
-    from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; with the &lt;i&gt;synchronous
-    flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; be that
-    resource. HTTP caching semantics should be honored for this
-    request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it doesn't
-    matter, since this can never be cross-origin --&gt;
+    &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt;
+    the resource from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; with the
+    &lt;i&gt;synchronous flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt;
+    be that resource. HTTP caching semantics should be honored for
+    this request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it
+    doesn't matter, since this can never be cross-origin --&gt;
 
     &lt;p&gt;Parse &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; according to the &lt;a href=#parse-a-manifest title=&quot;parse a manifest&quot;&gt;rules for parsing manifests&lt;/a&gt;,
     obtaining a list of &lt;a href=#concept-appcache-explicit title=concept-appcache-explicit&gt;explicit entries&lt;/a&gt;, &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt; and the
@@ -73214,10 +73250,9 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource, from the &lt;a href=#origin&gt;origin&lt;/a&gt;
-      of the &lt;a href=#url&gt;URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, with
-      the &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;manual redirect
-      flag&lt;/i&gt; set. If this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade attempt&lt;/a&gt;, then
+      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resource, from the
+      &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;a href=#url&gt;URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, with the &lt;i&gt;synchronous flag&lt;/i&gt;
+      set and the &lt;i&gt;manual redirect flag&lt;/i&gt; set. If this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade attempt&lt;/a&gt;, then
       use the &lt;a href=#concept-appcache-newer title=concept-appcache-newer&gt;newest&lt;/a&gt;
       &lt;a href=#application-cache&gt;application cache&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;cache
       group&lt;/var&gt; as an HTTP cache, and honor HTTP caching semantics
@@ -73427,12 +73462,11 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource from &lt;var title=&quot;&quot;&gt;manifest
-    URL&lt;/var&gt; again, with the &lt;i&gt;synchronous flag&lt;/i&gt; set, and let
-    &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be that resource. HTTP caching
-    semantics should again be honored for this request.&lt;/p&gt; &lt;!--
-    http-origin privacy sensitive, though it doesn't matter, since
-    this can never be cross-origin --&gt;
+    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resource from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; again, with the &lt;i&gt;synchronous
+    flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be that
+    resource. HTTP caching semantics should again be honored for this
+    request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it doesn't
+    matter, since this can never be cross-origin --&gt;
 
     &lt;p class=note&gt;Since caching can be honored, authors are
     encouraged to avoid setting the cache headers on the manifest in
@@ -73711,7 +73745,7 @@
   following steps instead of immediately invoking the mechanisms
   appropriate to that resource's scheme:&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the resource is not to be fetched using the HTTP GET
+  &lt;ol&gt;&lt;!--FETCH--&gt;&lt;li&gt;&lt;p&gt;If the resource is not to be fetched using the HTTP GET
    mechanism &lt;a href=#concept-http-equivalent-get title=concept-http-equivalent-get&gt;or
    equivalent&lt;/a&gt;, or if its &lt;a href=#url&gt;URL&lt;/a&gt; has a different &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component than the
    &lt;a href=#application-cache&gt;application cache&lt;/a&gt;'s &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;manifest&lt;/a&gt;, then
@@ -74217,7 +74251,7 @@
   &lt;div class=impl&gt;
 
   &lt;!-- SCRIPT EXEC (marks areas related to creation of scripts) --&gt;
-  &lt;h4 id=processing-model-1&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-2&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;h5 id=definitions-0&gt;&lt;span class=secno&gt;7.1.3.1 &lt;/span&gt;Definitions&lt;/h5&gt;
 
@@ -74322,12 +74356,25 @@
     &lt;p&gt;A &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; that is assigned responsibility for
     actions taken by the script.&lt;/p&gt;
 
-    &lt;p class=example&gt;When a script &lt;a href=#fetch title=fetch&gt;fetches&lt;/a&gt; a resource, the &lt;a href=&quot;#the-document's-address&quot; title=&quot;the
-    document's address&quot;&gt;address&lt;/a&gt; of the &lt;a href=&quot;#script's-document&quot;&gt;script's
-    document&lt;/a&gt; will be used to set the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header.&lt;/p&gt;
+    &lt;p class=example&gt;For example, the &lt;a href=&quot;#the-document's-address&quot; title=&quot;the document's
+    address&quot;&gt;address&lt;/a&gt; of the &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt; is
+    used to set the &lt;a href=&quot;#the-document's-address&quot; title=&quot;the document's
+    address&quot;&gt;address&lt;/a&gt; of any &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; elements
+    created using &lt;code title=dom-DOMImplementation-createDocument&gt;&lt;a href=#dom-domimplementation-createdocument&gt;createDocument()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;The &lt;dfn id=&quot;script's-referrer-source&quot;&gt;script's referrer source&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Either a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; (specifically, the
+    &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt;), or a &lt;a href=#url&gt;URL&lt;/a&gt;, which is
+    used by some APIs to determine what value to use for the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header in calls to the
+    &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; algorithm.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;A &lt;dfn id=&quot;script's-url-character-encoding&quot; title=&quot;script's URL character encoding&quot;&gt;URL character encoding&lt;/dfn&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -74394,8 +74441,8 @@
   &lt;p&gt;When the specification says that a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; is to be &lt;dfn id=create-a-script title=&quot;create a
   script&quot;&gt;created&lt;/dfn&gt;, given some script source, a script source
   URL, its scripting language, a global object, a browsing context, a
-  URL character encoding, and a base URL, the user agent must run the
-  following steps:&lt;/p&gt;
+  document, a referrer source, a URL character encoding, and a base
+  URL, the user agent must run the following steps:&lt;/p&gt;
 
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;a href=#concept-bc-noscript title=concept-bc-noscript&gt;scripting is
    disabled&lt;/a&gt; for &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; passed to this
@@ -74415,9 +74462,10 @@
 
    &lt;li&gt;&lt;p&gt;Set up the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, the
    &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, the &lt;a href=&quot;#script's-document&quot;&gt;script's
-   document&lt;/a&gt;, the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;,
-   and the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from the settings passed to
-   this algorithm.&lt;/li&gt;
+   document&lt;/a&gt;, the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt;, the
+   &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;, and the
+   &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from the settings passed to this
+   algorithm.&lt;/li&gt;
 
    &lt;li&gt;
  
@@ -74440,9 +74488,9 @@
   browsing context, the user agent must &lt;a href=#create-a-script&gt;create a script&lt;/a&gt;,
   using the given script source, URL, and scripting language, using a
   new empty object as the global object, and using the given browsing
-  context as the browsing context. The URL character encoding and base
-  URL for the resulting &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; are
-  not important as no APIs are exposed to the script.&lt;/p&gt;
+  context as the browsing context. The referrer source, URL character
+  encoding, and base URL for the resulting &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; are not important as no APIs
+  are exposed to the script.&lt;/p&gt;
 
   &lt;hr&gt;&lt;p&gt;When the specification says that a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; is to be &lt;dfn id=create-a-script-from-a-node title=&quot;create a
   script from a node&quot;&gt;created from a node&lt;/dfn&gt; &lt;var title=&quot;&quot;&gt;node&lt;/var&gt;, given some script source, its URL, and its
@@ -74457,12 +74505,15 @@
    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; (or &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; itself if it is a
    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;).&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;The browsing context is the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; of
    &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of
-   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;The document is &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
 
+   &lt;li&gt;&lt;p&gt;The referrer source is &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
    &lt;li&gt;&lt;p&gt;The URL character encoding is the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's
    character encoding&quot;&gt;character encoding&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. (&lt;a href=#sce-not-copy&gt;This is a
    reference, not a copy&lt;/a&gt;.)&lt;/li&gt;
@@ -74727,7 +74778,7 @@
   release the &lt;a href=#storage-mutex&gt;storage mutex&lt;/a&gt;.&lt;/p&gt;
 
 
-  &lt;h5 id=processing-model-2&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/h5&gt;
+  &lt;h5 id=processing-model-3&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/h5&gt;
 
   &lt;p&gt;An &lt;a href=#event-loop&gt;event loop&lt;/a&gt; must continually run through the
   following steps for as long as it exists:&lt;/p&gt;
@@ -75243,10 +75294,11 @@
 
    &lt;li&gt;&lt;p&gt;Set up the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, the
    &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, the &lt;a href=&quot;#script's-document&quot;&gt;script's
-   document&lt;/a&gt;, the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;,
-   and the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from &lt;a href=#the-script-settings-determined-from-the-node&gt;the script
-   settings determined from the node&lt;/a&gt; on which the attribute is
-   being set.&lt;/li&gt;
+   document&lt;/a&gt;, the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt;, the
+   &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;, and the
+   &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from &lt;a href=#the-script-settings-determined-from-the-node&gt;the script settings
+   determined from the node&lt;/a&gt; on which the attribute is being
+   set.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Set the corresponding &lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;event
    handler&lt;/a&gt; to the aforementioned function.&lt;/li&gt;
@@ -76158,25 +76210,27 @@
     object, let &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; be the &lt;a href=#method-context&gt;method
     context&lt;/a&gt;, let &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; be the
     &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; with which &lt;var title=&quot;&quot;&gt;global
-    object&lt;/var&gt; is associated, let &lt;var title=&quot;&quot;&gt;character
-    encoding&lt;/var&gt; be the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character
-    encoding&quot;&gt;character encoding&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
-    associated with &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; (&lt;a href=#sce-not-copy&gt;this is a reference, not a copy&lt;/a&gt;), and let
-    &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;a href=#document-base-url title=&quot;document base
-    URL&quot;&gt;base URL&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; associated with
-    &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; (&lt;a href=#sbu-not-copy&gt;this is
-    a reference, not a copy&lt;/a&gt;).&lt;/p&gt;
+    object&lt;/var&gt; is associated, let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; and
+    &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; be the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
+    associated with &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt;, let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's
+    character encoding&quot;&gt;character encoding&lt;/a&gt; of the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; associated with &lt;var title=&quot;&quot;&gt;global
+    object&lt;/var&gt; (&lt;a href=#sce-not-copy&gt;this is a reference, not a
+    copy&lt;/a&gt;), and let &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;a href=#document-base-url title=&quot;document base URL&quot;&gt;base URL&lt;/a&gt; of the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; associated with &lt;var title=&quot;&quot;&gt;global
+    object&lt;/var&gt; (&lt;a href=#sbu-not-copy&gt;this is a reference, not a
+    copy&lt;/a&gt;).&lt;/p&gt;
 
     &lt;p&gt;Otherwise, if the &lt;a href=#method-context&gt;method context&lt;/a&gt; is a
     &lt;code&gt;&lt;a href=#workerutils&gt;WorkerUtils&lt;/a&gt;&lt;/code&gt; object, let &lt;var title=&quot;&quot;&gt;global
-    object&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt;,
-    and &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global
-    object&lt;/a&gt;, &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;,
-    &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt;, &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character
-    encoding&lt;/a&gt;, and &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; (respectively)
-    of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that the
-    &lt;a href=#run-a-worker&gt;run a worker&lt;/a&gt; algorithm created when it created the
-    &lt;a href=#method-context&gt;method context&lt;/a&gt;.&lt;/p&gt;
+    object&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt;, and &lt;var title=&quot;&quot;&gt;base
+    URL&lt;/var&gt; be the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;,
+    &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, &lt;a href=&quot;#script's-document&quot;&gt;script's
+    document&lt;/a&gt;, &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt;,
+    &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;, and &lt;a href=&quot;#script's-base-url&quot;&gt;script's
+    base URL&lt;/a&gt; (respectively) of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that the &lt;a href=#run-a-worker&gt;run a
+    worker&lt;/a&gt; algorithm created when it created the &lt;a href=#method-context&gt;method
+    context&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, act as described in the specification that defines
     that the &lt;code&gt;&lt;a href=#windowtimers&gt;WindowTimers&lt;/a&gt;&lt;/code&gt; interface is implemented by
@@ -76189,7 +76243,8 @@
    &lt;a href=#url&gt;URL&lt;/a&gt; where &lt;var title=&quot;&quot;&gt;script source&lt;/var&gt; can be
    found, &lt;var title=&quot;&quot;&gt;scripting language&lt;/var&gt; as the scripting
    language, &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; as the global object,
-   &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; as the browsing context, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; as the document, &lt;var title=&quot;&quot;&gt;character
+   &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; as the browsing context, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; as the document, &lt;var title=&quot;&quot;&gt;referrer
+   source&lt;/var&gt; as the referrer source, &lt;var title=&quot;&quot;&gt;character
    encoding&lt;/var&gt; as the URL character encoding, and &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; as the base URL.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;hr&gt;&lt;p&gt;The &lt;a href=#task-source&gt;task source&lt;/a&gt; for these &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; is the &lt;dfn id=timer-task-source&gt;timer task
@@ -78386,7 +78441,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h4 id=processing-model-3&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-4&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;An element's &lt;dfn id=assigned-access-key&gt;assigned access key&lt;/dfn&gt; is a key combination
   derived from the element's &lt;code title=attr-accesskey&gt;&lt;a href=#the-accesskey-attribute&gt;accesskey&lt;/a&gt;&lt;/code&gt; content attribute.
@@ -82587,7 +82642,7 @@
   &lt;a href=#permissible-worker&gt;permissible worker&lt;/a&gt;.&lt;/p&gt;
 
 
-  &lt;h4 id=processing-model-4&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-5&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;When a user agent is to &lt;dfn id=run-a-worker&gt;run a worker&lt;/dfn&gt; for a script with
   &lt;a href=#url&gt;URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, a &lt;a href=#browsing-context&gt;browsing
@@ -82616,10 +82671,12 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resource identified by &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, from the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;,
-    with the &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;force same-origin
-    flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy sensitive (looking
-    forward to CORS) --&gt;
+    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resource
+    identified by &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, from the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;, using &lt;var title=&quot;&quot;&gt;owner
+    document&lt;/var&gt; as the &lt;a href=#referrer-source&gt;referrer source&lt;/a&gt;, with the
+    &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;force same-origin flag&lt;/i&gt;
+    set.&lt;/p&gt; &lt;!-- not http-origin privacy sensitive (looking forward
+    to CORS) --&gt;
 
     &lt;p&gt;If the attempt fails, then for each &lt;code&gt;&lt;a href=#worker&gt;Worker&lt;/a&gt;&lt;/code&gt; or
     &lt;code&gt;&lt;a href=#sharedworker&gt;SharedWorker&lt;/a&gt;&lt;/code&gt; object associated with &lt;var title=&quot;&quot;&gt;worker global scope&lt;/var&gt;, &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to
@@ -82669,6 +82726,8 @@
     &lt;p&gt;Set the &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;owner
     document&lt;/var&gt;.&lt;/p&gt;
 
+    &lt;p&gt;Set the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;.&lt;/p&gt;
+
     &lt;p&gt;Set the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt; to
     UTF-8. (This is just used for encoding non-ASCII characters in the
     query component of URLs.)&lt;/p&gt;
@@ -83404,10 +83463,11 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt; each resource identified by the
-    resulting &lt;a href=#absolute-url title=&quot;absolute URL&quot;&gt;absolute URLs&lt;/a&gt;, from
-    the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;, with the
-    &lt;i&gt;synchronous flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy
+    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; each resource
+    identified by the resulting &lt;a href=#absolute-url title=&quot;absolute URL&quot;&gt;absolute
+    URLs&lt;/a&gt;, from the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s
+    &lt;a href=#origin&gt;origin&lt;/a&gt;, using the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-referrer-source&quot; title=&quot;script's referrer source&quot;&gt;referrer source&lt;/a&gt;, and with
+    the &lt;i&gt;synchronous flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy
     sensitive --&gt;
 
    &lt;/li&gt;
@@ -83443,8 +83503,8 @@
 
       &lt;p&gt;&lt;a href=#create-a-script&gt;Create a script&lt;/a&gt;, using &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; as the script source, the &lt;a href=#url&gt;URL&lt;/a&gt;
       from which &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; was obtained, and &lt;var title=&quot;&quot;&gt;language&lt;/var&gt; as the scripting language, using the
-      same global object, browsing context, URL character encoding,
-      base URL, and script group as the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that was created by the
+      same global object, browsing context, document, referrer source,
+      URL character encoding, and base URL as the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that was created by the
       worker's &lt;a href=#run-a-worker&gt;run a worker&lt;/a&gt; algorithm.&lt;/p&gt;
 
       &lt;p&gt;Let the newly created &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; run until it either
@@ -83504,7 +83564,9 @@
    null. The &lt;a href=#xmlhttprequest-base-url&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/a&gt; is the
    &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt;; the
    &lt;a href=#xmlhttprequest-origin&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/a&gt; is the script's
-   &lt;a href=#origin&gt;origin&lt;/a&gt;. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/li&gt;
+   &lt;a href=#origin&gt;origin&lt;/a&gt;, and the &lt;a href=#xmlhttprequest-referrer-source&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt;
+   referrer source&lt;/a&gt; is the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer
+   source&lt;/a&gt;. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;The interface objects and constructors defined by this
    specification, except where is further restricted by explicit
@@ -83821,14 +83883,15 @@
    &lt;li&gt;&lt;!-- if you change this, don't forget to update the
             reconnecting fetch lower down as well! --&gt;
 
-    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being
-    &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, and the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;
-    being the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;&lt;!--, and
-    the &lt;i&gt;default origin behaviour&lt;/i&gt; set to &lt;i&gt;fail&lt;/i&gt; (though it
-    has no effect in the &quot;Anonymous&quot; and &quot;Use Credentials&quot; modes)--&gt;,
-    and process the resource obtained in this fashion, if any, as
-    described below.&lt;/p&gt;
+    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of
+    the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; using the &lt;a href=#entry-script&gt;entry
+    script&lt;/a&gt;'s &lt;a href=&quot;#script's-referrer-source&quot; title=&quot;script's referrer source&quot;&gt;referrer
+    source&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
+    mode&lt;/var&gt;, and the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;a href=#entry-script&gt;entry
+    script&lt;/a&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;&lt;!--, and the &lt;i&gt;default origin
+    behaviour&lt;/i&gt; set to &lt;i&gt;fail&lt;/i&gt; (though it has no effect in the
+    &quot;Anonymous&quot; and &quot;Use Credentials&quot; modes)--&gt;, and process the
+    resource obtained in this fashion, if any, as described below.&lt;/p&gt;
 
     &lt;p class=note&gt;The definition of the &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; algorithm (which is used by CORS) is
     such that if the browser is already fetching the resource
@@ -83909,7 +83972,7 @@
   &lt;/ul&gt;&lt;p&gt;These values are not currently exposed on the interface.&lt;/p&gt;
 
 
-  &lt;h4 id=processing-model-5&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-6&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;The resource indicated in the argument to the &lt;code title=dom-EventSource&gt;&lt;a href=#dom-eventsource&gt;EventSource&lt;/a&gt;&lt;/code&gt; constructor is &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; when the constructor is run.&lt;/p&gt;
 
@@ -84031,11 +84094,12 @@
      not set to &lt;code title=dom-EventSource-CONNECTING&gt;&lt;a href=#dom-eventsource-connecting&gt;CONNECTING&lt;/a&gt;&lt;/code&gt;, abort these
      steps.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of
-     the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; of the event source resource, with
-     the &lt;i&gt;mode&lt;/i&gt;&lt;!--, the &lt;i&gt;default origin behaviour&lt;/i&gt;,--&gt; and
-     the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the same as those used in the
-     original request triggered by the &lt;code title=dom-EventSource&gt;&lt;a href=#dom-eventsource&gt;EventSource()&lt;/a&gt;&lt;/code&gt; constructor, and
+     &lt;li&gt;&lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled
+     fetch&lt;/a&gt;&lt;!--FETCH--&gt; of the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; of the
+     event source resource, using the same &lt;i&gt;&lt;a href=#referrer-source&gt;referrer source&lt;/a&gt;&lt;/i&gt;, and
+     with the same &lt;i&gt;mode&lt;/i&gt;&lt;!--, &lt;i&gt;default origin
+     behaviour&lt;/i&gt;,--&gt; and &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, as those used in
+     the original request triggered by the &lt;code title=dom-EventSource&gt;&lt;a href=#dom-eventsource&gt;EventSource()&lt;/a&gt;&lt;/code&gt; constructor, and
      process the resource obtained in this fashion, if any, as
      described earlier in this section.&lt;/li&gt;
 

Modified: index
===================================================================
--- index	2012-09-12 07:21:58 UTC (rev 7340)
+++ index	2012-09-12 23:14:45 UTC (rev 7341)
@@ -365,12 +365,13 @@
      &lt;li&gt;&lt;a href=#interfaces-for-url-manipulation&gt;&lt;span class=secno&gt;2.6.7 &lt;/span&gt;Interfaces for URL manipulation&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#fetching-resources&gt;&lt;span class=secno&gt;2.7 &lt;/span&gt;Fetching resources&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#concept-http-equivalent&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Protocol concepts&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#content-type-sniffing&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Determining the type of a resource&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Extracting encodings from &lt;code&gt;meta&lt;/code&gt; elements&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;CORS settings attributes&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS-enabled fetch&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#terminology-1&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Terminology&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#content-type-sniffing&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Determining the type of a resource&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;Extracting encodings from &lt;code&gt;meta&lt;/code&gt; elements&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS settings attributes&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.7 &lt;/span&gt;CORS-enabled fetch&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#common-dom-interfaces&gt;&lt;span class=secno&gt;2.8 &lt;/span&gt;Common DOM interfaces&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#reflecting-content-attributes-in-idl-attributes&gt;&lt;span class=secno&gt;2.8.1 &lt;/span&gt;Reflecting content attributes in IDL attributes&lt;/a&gt;&lt;/li&gt;
@@ -635,7 +636,7 @@
      &lt;li&gt;&lt;a href=#image-maps&gt;&lt;span class=secno&gt;4.8.14 &lt;/span&gt;Image maps&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#authoring&gt;&lt;span class=secno&gt;4.8.14.1 &lt;/span&gt;Authoring&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#processing-model&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#processing-model-0&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#mathml&gt;&lt;span class=secno&gt;4.8.15 &lt;/span&gt;MathML&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#svg-0&gt;&lt;span class=secno&gt;4.8.16 &lt;/span&gt;SVG&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#dimension-attributes&gt;&lt;span class=secno&gt;4.8.17 &lt;/span&gt;Dimension attributes&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
@@ -655,7 +656,7 @@
      &lt;li&gt;&lt;a href=#the-td-element&gt;&lt;span class=secno&gt;4.9.9 &lt;/span&gt;The &lt;code&gt;td&lt;/code&gt; element&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-th-element&gt;&lt;span class=secno&gt;4.9.10 &lt;/span&gt;The &lt;code&gt;th&lt;/code&gt; element&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#attributes-common-to-td-and-th-elements&gt;&lt;span class=secno&gt;4.9.11 &lt;/span&gt;Attributes common to &lt;code&gt;td&lt;/code&gt; and &lt;code&gt;th&lt;/code&gt; elements&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-0&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#processing-model-1&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#forming-a-table&gt;&lt;span class=secno&gt;4.9.12.1 &lt;/span&gt;Forming a table&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#header-and-data-cell-semantics&gt;&lt;span class=secno&gt;4.9.12.2 &lt;/span&gt;Forming relationships between data cells and header cells&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
@@ -936,7 +937,7 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-6&gt;&lt;span class=secno&gt;7.1.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#enabling-and-disabling-scripting&gt;&lt;span class=secno&gt;7.1.2 &lt;/span&gt;Enabling and disabling scripting&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-1&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#processing-model-2&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#definitions-0&gt;&lt;span class=secno&gt;7.1.3.1 &lt;/span&gt;Definitions&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#calling-scripts&gt;&lt;span class=secno&gt;7.1.3.2 &lt;/span&gt;Calling scripts&lt;/a&gt;&lt;/li&gt;
@@ -948,7 +949,7 @@
      &lt;li&gt;&lt;a href=#event-loops&gt;&lt;span class=secno&gt;7.1.4 &lt;/span&gt;Event loops&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#definitions-1&gt;&lt;span class=secno&gt;7.1.4.1 &lt;/span&gt;Definitions&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#processing-model-2&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#processing-model-3&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#generic-task-sources&gt;&lt;span class=secno&gt;7.1.4.3 &lt;/span&gt;Generic task sources&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#javascript-protocol&gt;&lt;span class=secno&gt;7.1.5 &lt;/span&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; URL scheme&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#events&gt;&lt;span class=secno&gt;7.1.6 &lt;/span&gt;Events&lt;/a&gt;
@@ -991,7 +992,7 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-7&gt;&lt;span class=secno&gt;8.5.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-accesskey-attribute&gt;&lt;span class=secno&gt;8.5.2 &lt;/span&gt;The &lt;code&gt;accesskey&lt;/code&gt; attribute&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-3&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model-4&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#editing-0&gt;&lt;span class=secno&gt;8.6 &lt;/span&gt;Editing&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#contenteditable&gt;&lt;span class=secno&gt;8.6.1 &lt;/span&gt;Making document regions editable: The &lt;code title=attr-contenteditable&gt;contenteditable&lt;/code&gt; content
@@ -1040,7 +1041,7 @@
        &lt;li&gt;&lt;a href=#shared-workers-and-the-sharedworkerglobalscope-interface&gt;&lt;span class=secno&gt;9.2.1.3 &lt;/span&gt;Shared workers and the &lt;code&gt;SharedWorkerGlobalScope&lt;/code&gt; interface&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-event-loop&gt;&lt;span class=secno&gt;9.2.2 &lt;/span&gt;The event loop&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#the-worker's-lifetime&quot;&gt;&lt;span class=secno&gt;9.2.3 &lt;/span&gt;The worker's lifetime&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-4&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model-5&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#runtime-script-errors-0&gt;&lt;span class=secno&gt;9.2.5 &lt;/span&gt;Runtime script errors&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#creating-workers&gt;&lt;span class=secno&gt;9.2.6 &lt;/span&gt;Creating workers&lt;/a&gt;
       &lt;ol&gt;
@@ -1060,7 +1061,7 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#server-sent-events-intro&gt;&lt;span class=secno&gt;10.2.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-eventsource-interface&gt;&lt;span class=secno&gt;10.2.2 &lt;/span&gt;The &lt;code&gt;EventSource&lt;/code&gt; interface&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-5&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model-6&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#parsing-an-event-stream&gt;&lt;span class=secno&gt;10.2.4 &lt;/span&gt;Parsing an event stream&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#event-stream-interpretation&gt;&lt;span class=secno&gt;10.2.5 &lt;/span&gt;Interpreting an event stream&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#notes&gt;&lt;span class=secno&gt;10.2.6 &lt;/span&gt;Notes&lt;/a&gt;&lt;/li&gt;
@@ -4248,9 +4249,10 @@
     &lt;p&gt;This specification references the XMLHttpRequest specification
     to define how the two specifications interact. The terms
     &lt;dfn id=document-response-entity-body&gt;document response entity body&lt;/dfn&gt;,
-    &lt;dfn id=xmlhttprequest-base-url&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/dfn&gt;, and
-    &lt;dfn id=xmlhttprequest-origin&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/dfn&gt; are defined in that
-    specification. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/p&gt;
+    &lt;dfn id=xmlhttprequest-base-url&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/dfn&gt;,
+    &lt;dfn id=xmlhttprequest-origin&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/dfn&gt;, and
+    &lt;dfn id=xmlhttprequest-referrer-source&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; referrer source&lt;/dfn&gt; are defined
+    in that specification. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -8308,8 +8310,38 @@
 
   &lt;h3 id=fetching-resources&gt;&lt;span class=secno&gt;2.7 &lt;/span&gt;Fetching resources&lt;/h3&gt;
 
-  &lt;p&gt;When a user agent is to &lt;dfn id=fetch&gt;fetch&lt;/dfn&gt; a resource or
-  &lt;a href=#url&gt;URL&lt;/a&gt;, optionally from an origin &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;,
+  &lt;h4 id=terminology-1&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Terminology&lt;/h4&gt;
+
+  &lt;p id=concept-http-equivalent&gt;User agents can implement a variety
+  of transfer protocols, but this specification mostly defines
+  behavior in terms of HTTP. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-get title=concept-http-equivalent-get&gt;HTTP GET
+  method&lt;/dfn&gt; is equivalent to the default retrieval action of the
+  protocol. For example, RETR in FTP. Such actions are idempotent and
+  safe, in HTTP terms.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;HTTP response
+  codes&lt;/dfn&gt; are equivalent to statuses in other protocols that have
+  the same basic meanings. For example, a &quot;file not found&quot; error is
+  equivalent to a 404 code, a server error is equivalent to a 5xx
+  code, and so on.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-headers title=concept-http-equivalent-headers&gt;HTTP
+  headers&lt;/dfn&gt; are equivalent to fields in other protocols that have
+  the same basic meaning. For example, the HTTP authentication
+  headers are equivalent to the authentication aspects of the FTP
+  protocol.&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;A &lt;dfn id=referrer-source&gt;referrer source&lt;/dfn&gt; is either a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; or
+  a &lt;a href=#url&gt;URL&lt;/a&gt;.&lt;/p&gt;
+
+
+  &lt;h4 id=processing-model&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Processing model&lt;/h4&gt;
+
+  &lt;p&gt;When a user agent is to &lt;dfn id=fetch&gt;fetch&lt;/dfn&gt;&lt;!--FETCH--&gt; a resource
+  or &lt;a href=#url&gt;URL&lt;/a&gt;, optionally &lt;strong&gt;from&lt;/strong&gt; an origin &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, optionally &lt;strong&gt;using&lt;/strong&gt; a specific
+  &lt;a href=#referrer-source&gt;referrer source&lt;/a&gt; as an &lt;i&gt;override referrer source&lt;/i&gt;,
   and optionally with a &lt;i&gt;synchronous flag&lt;/i&gt;, a &lt;i&gt;manual redirect
   flag&lt;/i&gt;, a &lt;i&gt;force same-origin flag&lt;/i&gt;, and/or a &lt;i&gt;block cookies
   flag&lt;/i&gt;, the following steps must be run. (When a &lt;em&gt;URL&lt;/em&gt; is
@@ -8330,25 +8362,32 @@
 
   &lt;!-- &quot;block cookies&quot; is currently only used by XHR --&gt;
 
-  &lt;ol&gt;&lt;li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If there is a specific &lt;i&gt;override referrer source&lt;/i&gt;, and
+   it is a &lt;a href=#url&gt;URL&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; be
+   the &lt;i&gt;override referrer source&lt;/i&gt;, and jump to the step labeled
+   &lt;i&gt;clean referrer&lt;/i&gt;.&lt;/li&gt;
 
+   &lt;li&gt;
+
     &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; be the appropriate
     &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; as given by the following list:&lt;/p&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;When &lt;a href=#navigate title=navigate&gt;navigating&lt;/a&gt;&lt;/dt&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If there is a specific &lt;i&gt;override referrer source&lt;/i&gt;&lt;/dt&gt;
 
+     &lt;dd&gt;The &lt;i&gt;override referrer source&lt;/i&gt;.&lt;/dd&gt;
+
+
+     &lt;dt&gt;When &lt;a href=#navigate title=navigate&gt;navigating&lt;/a&gt;&lt;/dt&gt;
+
      &lt;dd&gt;The &lt;a href=#active-document&gt;active document&lt;/a&gt; of the &lt;a href=#source-browsing-context&gt;source browsing
      context&lt;/a&gt;.&lt;/dd&gt;
 
+
      &lt;dt&gt;When fetching resources for an element&lt;/dt&gt;
 
      &lt;dd&gt;The element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;When fetching resources in response to a call to an API&lt;/dt&gt;
 
-     &lt;dd&gt;The &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-document&quot; title=&quot;script's
-     document&quot;&gt;document&lt;/a&gt;.&lt;/dd&gt;
-
     &lt;/dl&gt;&lt;/li&gt;
 
    &lt;li&gt;
@@ -8363,22 +8402,40 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Generate the &lt;i&gt;address of the resource from which Request-URIs
-    are obtained&lt;/i&gt; as required by HTTP for the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header from &lt;a href=&quot;#the-document's-address&quot;&gt;the
-    document's address&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+    &lt;p&gt;If the &lt;a href=#origin&gt;origin&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;Document&lt;/var&gt; is
+    not a scheme/host/port tuple, then set &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; to the empty string and jump to the step
+    labeled &lt;i&gt;clean referrer&lt;/i&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Remove any &lt;a href=#url-fragment title=url-fragment&gt;&lt;fragment&gt;&lt;/a&gt;
-    component from the generated &lt;i&gt;address of the resource from which
-    Request-URIs are obtained&lt;/i&gt;.&lt;/p&gt; &lt;!-- RFC2616 says &quot;The URI MUST
-    NOT include a fragment.&quot; (section 14.36) --&gt;
+   &lt;/li&gt;
 
-    &lt;p&gt;If the &lt;a href=#origin&gt;origin&lt;/a&gt; of the appropriate
-    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is not a scheme/host/port tuple, then the
-    &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header must be
-    omitted, regardless of its value.&lt;/p&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; be &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
+    address&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;&lt;i&gt;Clean referrer&lt;/i&gt;: Remove any &lt;a href=#url-fragment title=url-fragment&gt;&lt;fragment&gt;&lt;/a&gt; component from &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt;.&lt;/p&gt; &lt;!-- RFC2616 says &quot;The URI MUST NOT
+    include a fragment.&quot; (section 14.36) --&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; is not the empty string, is not
+    a &lt;a href=#data-protocol title=&quot;data protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;data:&lt;/code&gt;
+    URL&lt;/a&gt;, is not a &lt;a href=#javascript-protocol title=&quot;javascript protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; URL&lt;/a&gt;, and is not the
+    &lt;a href=#url&gt;URL&lt;/a&gt; &quot;&lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt;&quot;, then generate the
+    &lt;i&gt;address of the resource from which Request-URIs are
+    obtained&lt;/i&gt; as required by HTTP for the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header from &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt;. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic)
+    header must be omitted, regardless of its value.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;If the algorithm was not invoked with the &lt;i&gt;synchronous
    flag&lt;/i&gt;, perform the remaining steps asynchronously.&lt;/li&gt;
 
@@ -8541,31 +8598,8 @@
   applicable.&lt;/p&gt;
 
 
-  &lt;h4 id=concept-http-equivalent&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Protocol concepts&lt;/h4&gt;
-
-  &lt;p&gt;User agents can implement a variety of transfer protocols, but
-  this specification mostly defines behavior in terms of HTTP. &lt;a href=#refsHTTP&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-get title=concept-http-equivalent-get&gt;HTTP GET
-  method&lt;/dfn&gt; is equivalent to the default retrieval action of the
-  protocol. For example, RETR in FTP. Such actions are idempotent and
-  safe, in HTTP terms.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;HTTP response
-  codes&lt;/dfn&gt; are equivalent to statuses in other protocols that have
-  the same basic meanings. For example, a &quot;file not found&quot; error is
-  equivalent to a 404 code, a server error is equivalent to a 5xx
-  code, and so on.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn id=concept-http-equivalent-headers title=concept-http-equivalent-headers&gt;HTTP
-  headers&lt;/dfn&gt; are equivalent to fields in other protocols that have
-  the same basic meaning. For example, the HTTP authentication
-  headers are equivalent to the authentication aspects of the FTP
-  protocol.&lt;/p&gt;
-
-
 &lt;!--ADD-TOPIC:Security--&gt;
-  &lt;h4 id=encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/h4&gt;
+  &lt;h4 id=encrypted-http-and-related-security-concerns&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Encrypted HTTP and related security concerns&lt;/h4&gt;
 
   &lt;p&gt;Anything in this specification that refers to HTTP also applies
   to HTTP-over-TLS, as represented by &lt;a href=#url title=url&gt;URLs&lt;/a&gt;
@@ -8612,7 +8646,7 @@
 &lt;!--REMOVE-TOPIC:Security--&gt;
 
 
-  &lt;h4 id=content-type-sniffing&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;Determining the type of a resource&lt;/h4&gt;
+  &lt;h4 id=content-type-sniffing&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Determining the type of a resource&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=content-type title=Content-Type&gt;Content-Type metadata&lt;/dfn&gt; of a
   resource must be obtained and interpreted in a manner consistent
@@ -8639,7 +8673,7 @@
   Media Type Sniffing specification. &lt;a href=#refsMIMESNIFF&gt;[MIMESNIFF]&lt;/a&gt;&lt;/p&gt;
 
 
-  &lt;h4 id=extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;Extracting encodings from &lt;code&gt;&lt;a href=#the-meta-element&gt;meta&lt;/a&gt;&lt;/code&gt; elements&lt;/h4&gt;
+  &lt;h4 id=extracting-encodings-from-meta-elements&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;Extracting encodings from &lt;code&gt;&lt;a href=#the-meta-element&gt;meta&lt;/a&gt;&lt;/code&gt; elements&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=algorithm-for-extracting-an-encoding-from-a-meta-element&gt;algorithm for extracting an encoding from a
   &lt;code&gt;meta&lt;/code&gt; element&lt;/dfn&gt;, given a string &lt;var title=&quot;&quot;&gt;s&lt;/var&gt;, is as follows. It either returns an encoding or
@@ -8697,7 +8731,7 @@
   &lt;/div&gt;
 
 
-  &lt;h4 id=cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;CORS settings attributes&lt;/h4&gt;
+  &lt;h4 id=cors-settings-attributes&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS settings attributes&lt;/h4&gt;
 
   &lt;p&gt;A &lt;dfn id=cors-settings-attribute&gt;CORS settings attribute&lt;/dfn&gt; is an &lt;a href=#enumerated-attribute&gt;enumerated
   attribute&lt;/a&gt;. The following table lists the keywords and states
@@ -8721,19 +8755,19 @@
 
 
   &lt;div class=impl&gt;
-  &lt;h4 id=cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;CORS-enabled fetch&lt;/h4&gt;
+  &lt;h4 id=cors-enabled-fetch&gt;&lt;span class=secno&gt;2.7.7 &lt;/span&gt;CORS-enabled fetch&lt;/h4&gt;
 
   &lt;p&gt;When the user agent is required to perform a &lt;dfn id=potentially-cors-enabled-fetch&gt;potentially
-  CORS-enabled fetch&lt;/dfn&gt; of an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with a mode &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; that is
+  CORS-enabled fetch&lt;/dfn&gt; of an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; with a mode &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; that is
   either &quot;&lt;a href=#attr-crossorigin-none title=attr-crossorigin-none&gt;No CORS&lt;/a&gt;&quot;, &quot;&lt;a href=#attr-crossorigin-anonymous title=attr-crossorigin-anonymous&gt;Anonymous&lt;/a&gt;&quot;, or &quot;&lt;a href=#attr-crossorigin-use-credentials title=attr-crossorigin-use-credentials&gt;Use Credentials&lt;/a&gt;&quot;,
-  an &lt;a href=#origin&gt;origin&lt;/a&gt; &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and a default
-  origin behaviour &lt;var title=&quot;&quot;&gt;default&lt;/var&gt; which is either
-  &quot;&lt;i&gt;taint&lt;/i&gt;&quot; or &quot;&lt;i&gt;fail&lt;/i&gt;&quot;, it must run the first applicable
-  set of steps from the following list. The default origin behaviour
-  is only used if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-none title=attr-crossorigin-none&gt;No CORS&lt;/a&gt;&quot;. This algorithm wraps
-  the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm above, and labels the obtained
-  resource as either &lt;dfn id=cors-same-origin&gt;CORS-same-origin&lt;/dfn&gt; or
-  &lt;dfn id=cors-cross-origin&gt;CORS-cross-origin&lt;/dfn&gt;, or blocks the resource entirely.&lt;/p&gt;
+  optionally using a &lt;a href=#referrer-source&gt;referrer source&lt;/a&gt; &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt;, with an &lt;a href=#origin&gt;origin&lt;/a&gt; &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and with a default origin behaviour &lt;var title=&quot;&quot;&gt;default&lt;/var&gt; which is either &quot;&lt;i&gt;taint&lt;/i&gt;&quot; or
+  &quot;&lt;i&gt;fail&lt;/i&gt;&quot;, it must run the first applicable set of steps from
+  the following list. The default origin behaviour is only used if
+  &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-none title=attr-crossorigin-none&gt;No
+  CORS&lt;/a&gt;&quot;. This algorithm wraps the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm
+  above, and labels the obtained resource as either
+  &lt;dfn id=cors-same-origin&gt;CORS-same-origin&lt;/dfn&gt; or &lt;dfn id=cors-cross-origin&gt;CORS-cross-origin&lt;/dfn&gt;, or
+  blocks the resource entirely.&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;&lt;/dt&gt;
    &lt;dt&gt;If the &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; is a &lt;a href=#data-protocol title=&quot;data protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;data:&lt;/code&gt; URL&lt;/a&gt;&lt;/dt&gt;
@@ -8744,9 +8778,10 @@
 
     &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with the
-     &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/li&gt; &lt;!-- http-origin privacy
-     sensitive --&gt;
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;,
+     using &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified,
+     with the &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/li&gt; &lt;!-- http-origin
+     privacy sensitive --&gt;
 
      &lt;li&gt;&lt;p&gt;&lt;i&gt;Loop&lt;/i&gt;: Wait for the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm
      to know if the result is a redirect or not.&lt;/li&gt;
@@ -8810,7 +8845,8 @@
     &lt;p class=note&gt;The &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; does not have the
     &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;.&lt;/p&gt;
 
-    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;.&lt;/p&gt; &lt;!--
+    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, using
+    &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified.&lt;/p&gt; &lt;!--
     http-origin privacy sensitive --&gt;
 
     &lt;p&gt;The &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; from the
@@ -8854,10 +8890,11 @@
 
     &lt;p&gt;Run these steps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Perform a &lt;a href=#cross-origin-request&gt;cross-origin request&lt;/a&gt; with the
-     &lt;i&gt;request URL&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, the &lt;i&gt;source
-     origin&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and the &lt;i&gt;&lt;a href=#omit-credentials-flag&gt;omit
-     credentials flag&lt;/a&gt;&lt;/i&gt; set if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-anonymous title=attr-crossorigin-anonymous&gt;Anonymous&lt;/a&gt;&quot; and not set
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Perform a &lt;a href=#cross-origin-request&gt;cross-origin request&lt;/a&gt;&lt;!--FETCH--&gt;
+     with the &lt;i&gt;request URL&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, using
+     &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified, with
+     the &lt;i&gt;source origin&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and
+     with the &lt;i&gt;&lt;a href=#omit-credentials-flag&gt;omit credentials flag&lt;/a&gt;&lt;/i&gt; set if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;a href=#attr-crossorigin-anonymous title=attr-crossorigin-anonymous&gt;Anonymous&lt;/a&gt;&quot; and not set
      otherwise. &lt;a href=#refsCORS&gt;[CORS]&lt;/a&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Wait for the CORS &lt;a href=#cross-origin-request-status&gt;cross-origin request status&lt;/a&gt;
@@ -10893,9 +10930,12 @@
 
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;success&lt;/var&gt; be false.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; from the
-   &lt;a href=#origin&gt;origin&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, with the &lt;i title=&quot;&quot;&gt;synchronous flag&lt;/i&gt; set and the &lt;i title=&quot;&quot;&gt;force
-   same-origin flag&lt;/i&gt; set.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; from
+   the &lt;a href=#origin&gt;origin&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, using the
+   &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-referrer-source&quot; title=&quot;script's referrer
+   source&quot;&gt;referrer source&lt;/a&gt;, with the &lt;i title=&quot;&quot;&gt;synchronous
+   flag&lt;/i&gt; set and the &lt;i title=&quot;&quot;&gt;force same-origin flag&lt;/i&gt;
+   set.&lt;/li&gt;
 
    &lt;li&gt;
 
@@ -14871,7 +14911,7 @@
 
    &lt;li&gt;&lt;p&gt;If the previous step fails, then abort these steps.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
    URL&lt;/a&gt;.&lt;/li&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;/ol&gt;&lt;p&gt;User agents may opt to only try to obtain such resources when
@@ -16914,7 +16954,7 @@
     attribute whose value is not the empty string, then the value of
     that attribute must be &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt;
     relative to the element, and if that is successful, the specified
-    resource must then be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;, from the
+    resource must then be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;&lt;!--FETCH--&gt;, from the
     &lt;a href=#origin&gt;origin&lt;/a&gt; of the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
     &lt;!-- not http-origin privacy sensitive --&gt;
 
@@ -24559,8 +24599,8 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; that resulted from the earlier step,
+    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of
+    the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; that resulted from the earlier step,
     with the &lt;i&gt;mode&lt;/i&gt; being the state of the element's &lt;code title=attr-img-crossorigin&gt;&lt;a href=#attr-img-crossorigin&gt;crossorigin&lt;/a&gt;&lt;/code&gt; content attribute,
     the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
     &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the
@@ -24944,10 +24984,10 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being
-    &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being
-    the &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element's
+    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of
+    the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt;
+    being &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;
+    being the &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element's
     &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
     to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
 
@@ -27183,16 +27223,17 @@
     &lt;p&gt;The user agent must &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt;
     the value of the element's &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt;
     attribute, relative to the element. If that is successful, the
-    user agent should &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute
-    URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope
-    origin&lt;/a&gt; if it has one&lt;!-- potentially http-origin privacy
-    sensitive --&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is
-    &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking
-    task source&lt;/a&gt; once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must find and instantiate an
-    appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt;, and hand that
-    &lt;a href=#plugin&gt;plugin&lt;/a&gt; the content of the resource, replacing any
-    previously instantiated plugin for the element.&lt;/p&gt; &lt;!-- Note that
-    this doesn't happen when the base URL changes. --&gt;
+    user agent should &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting
+    &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing
+    context scope origin&lt;/a&gt; if it has one&lt;!-- potentially
+    http-origin privacy sensitive --&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is &lt;a href=#queue-a-task title=&quot;queue a
+    task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt;
+    once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must
+    find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on
+    the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt;, and
+    hand that &lt;a href=#plugin&gt;plugin&lt;/a&gt; the content of the resource,
+    replacing any previously instantiated plugin for the element.&lt;/p&gt;
+    &lt;!-- Note that this doesn't happen when the base URL changes. --&gt;
 
     &lt;p&gt;Fetching the resource must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of
     the element's document.&lt;/p&gt;
@@ -27592,15 +27633,17 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;,
-      from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope origin&lt;/a&gt; if
-      it has one&lt;!-- potentially http-origin privacy sensitive
-      --&gt;.&lt;/p&gt;
+      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+      URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope
+      origin&lt;/a&gt; if it has one&lt;!-- potentially http-origin privacy
+      sensitive --&gt;.&lt;/p&gt;
 
-      &lt;!-- similar text in various places --&gt; &lt;p&gt;Fetching the resource
-      must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of the element's document
-      until the &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task
-      source&lt;/a&gt; once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; (defined next) has been run.&lt;/p&gt;
+      &lt;!-- similar text in various places --&gt;
+      &lt;p&gt;Fetching the resource must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt;
+      of the element's document until the &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is &lt;a href=#queue-a-task title=&quot;queue a
+      task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt;
+      once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;
+      (defined next) has been run.&lt;/p&gt;
 
       &lt;p&gt;For the purposes of the &lt;a href=#application-cache&gt;application cache&lt;/a&gt;
       networking model, this &lt;a href=#fetch&gt;fetch&lt;/a&gt; operation is not for a
@@ -28373,10 +28416,10 @@
    to the element. If this fails, then there is no &lt;a href=#poster-frame&gt;poster
    frame&lt;/a&gt;; abort these steps.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;,
-   from the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;.
-   This must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of the element's
-   document.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+   URL&lt;/a&gt;, from the element's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s
+   &lt;a href=#origin&gt;origin&lt;/a&gt;. This must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of
+   the element's document.&lt;/li&gt;
 
    &lt;!-- could define how to sniff for an image here --&gt;
 
@@ -30064,13 +30107,14 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt;'s &lt;a href=#absolute-url&gt;absolute
-    URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being the state of the
-    &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=attr-media-crossorigin&gt;&lt;a href=#attr-media-crossorigin&gt;crossorigin&lt;/a&gt;&lt;/code&gt; content
-    attribute, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
-    &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the
-    &lt;i&gt;default origin behaviour&lt;/i&gt; set to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
+    &lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled
+    fetch&lt;/a&gt;&lt;!--FETCH--&gt; of the &lt;var title=&quot;&quot;&gt;current media
+    resource&lt;/var&gt;'s &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt;
+    being the state of the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=attr-media-crossorigin&gt;&lt;a href=#attr-media-crossorigin&gt;crossorigin&lt;/a&gt;&lt;/code&gt; content
+    attribute, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the
+    &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
+    to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
 
     &lt;p&gt;The resource obtained in this fashion, if any, contains the
     &lt;a href=#media-data&gt;media data&lt;/a&gt;. It can be &lt;a href=#cors-same-origin&gt;CORS-same-origin&lt;/a&gt;
@@ -34434,7 +34478,7 @@
    &lt;li&gt;
 
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; is not the empty string, perform a
-    &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
+    &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
     mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the
     &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; element's
     &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
@@ -42440,7 +42484,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h5 id=processing-model&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/h5&gt;
+  &lt;h5 id=processing-model-0&gt;&lt;span class=secno&gt;4.8.14.2 &lt;/span&gt;Processing model&lt;/h5&gt;
 
   &lt;p&gt;If an &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element or an &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element
   representing an image has a &lt;code title=attr-hyperlink-usemap&gt;&lt;a href=#attr-hyperlink-usemap&gt;usemap&lt;/a&gt;&lt;/code&gt; attribute specified,
@@ -44244,7 +44288,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h4 id=processing-model-0&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-1&gt;&lt;span class=secno&gt;4.9.12 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;The various table elements and their content attributes together
   define the &lt;dfn id=table-model&gt;table model&lt;/dfn&gt;.&lt;/p&gt;
@@ -51156,10 +51200,10 @@
   or the user agent only fetches elements on demand, or the &lt;code title=attr-input-src&gt;&lt;a href=#attr-input-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute's value is the empty
   string, the user agent must &lt;a href=#resolve-a-url title=&quot;resolve a
   url&quot;&gt;resolve&lt;/a&gt; the value of the &lt;code title=attr-input-src&gt;&lt;a href=#attr-input-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute, relative to the
-  element, and if that is successful, must &lt;a href=#fetch&gt;fetch&lt;/a&gt; the
-  resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT
-  happen when the base URL changes. --&gt; &lt;!-- http-origin privacy
-  sensitive --&gt;
+  element, and if that is successful, must
+  &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+  URL&lt;/a&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT happen when the base URL
+  changes. --&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;ul&gt;&lt;li&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;code title=attr-input-type&gt;&lt;a href=#attr-input-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is first set to the
    &lt;a href=&quot;#image-button-state-(type=image)&quot; title=attr-input-type-image&gt;Image Button&lt;/a&gt; state
@@ -59112,13 +59156,13 @@
    &lt;dd&gt;Append the command to the menu, respecting its &lt;a href=#concept-facet title=concept-facet&gt;facets&lt;/a&gt;&lt;!-- we might need to be
    explicit about what this means for each facet, if testing shows
    this isn't well-implemented. e.g.: If there's an Icon facet for the
-   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; (this
-   would be http-origin privacy-sensitive), and then that image should
-   be associated with the command, such that each command only has its
-   image fetched once, to prevent changes to the base URL from having
-   effects after the image has been fetched once. (no need to resolve
-   the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the element is a
-   &lt;code&gt;command&lt;/code&gt; element with a &lt;code
+   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;&lt;!- -FETCH-
+   -&gt; (this would be http-origin privacy-sensitive), and then that
+   image should be associated with the command, such that each command
+   only has its image fetched once, to prevent changes to the base URL
+   from having effects after the image has been fetched once. (no need
+   to resolve the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the
+   element is a &lt;code&gt;command&lt;/code&gt; element with a &lt;code
    title=&quot;attr-command-default&quot;&gt;default&lt;/code&gt; attribute, mark the
    command as being a default command.--&gt;&lt;/dd&gt;
 
@@ -60744,9 +60788,9 @@
    &lt;li&gt;&lt;p&gt;Return to whatever algorithm invoked these steps and continue
    these steps asynchronously.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; and handle the
-   resulting resource &lt;a href=#as-a-download&gt;as a download&lt;/a&gt;.&lt;/li&gt; &lt;!--
-   http-origin privacy sensitive --&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; and
+   handle the resulting resource &lt;a href=#as-a-download&gt;as a download&lt;/a&gt;.&lt;/li&gt;
+   &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;/ol&gt;&lt;p&gt;When a user agent is to handle a resource obtained from a
   &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm &lt;dfn id=as-a-download&gt;as a download&lt;/dfn&gt;, it should
@@ -60927,9 +60971,7 @@
 
   &lt;/div&gt;
 
-&lt;!--DOWNLOAD--&gt;
 
-
 &lt;!--PING--&gt;
 
   &lt;div class=impl&gt;
@@ -60941,11 +60983,12 @@
   follows the hyperlink, and the value of the element's &lt;code title=attr-hyperlink-href&gt;&lt;a href=#attr-hyperlink-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute can be &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt;, relative to the element,
   without failure, then the user agent must take the &lt;code title=attr-hyperlink-ping&gt;&lt;a href=#ping&gt;ping&lt;/a&gt;&lt;/code&gt; attribute's value, &lt;a href=#split-a-string-on-spaces title=&quot;split a string on spaces&quot;&gt;split that string on spaces&lt;/a&gt;,
   &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt; each resulting token
-  relative to the element, and then should send a request (as
-  described below) to each of the resulting &lt;a href=#absolute-url title=&quot;absolute
-  URL&quot;&gt;absolute URLs&lt;/a&gt;. (Tokens that fail to resolve are
-  ignored.) This may be done in parallel with the primary request, and
-  is independent of the result of that request.&lt;/p&gt;
+  relative to the element, and then each of the resulting &lt;a href=#absolute-url title=&quot;absolute URL&quot;&gt;absolute URLs&lt;/a&gt; should be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;&lt;!--FETCH--&gt; from the
+  &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; containing the
+  &lt;a href=#hyperlink&gt;hyperlink&lt;/a&gt; &lt;!-- not http-origin privacy sensitive --&gt;
+  (as described below). (Tokens that fail to resolve are ignored.)
+  This may be done in parallel with the primary request, and is
+  independent of the result of that request.&lt;/p&gt;
 
   &lt;p&gt;User agents should allow the user to adjust this behavior, for
   example in conjunction with a setting that disables the sending of
@@ -60955,13 +60998,10 @@
   or selectively ignore URLs in the list (e.g. ignoring any
   third-party URLs).&lt;/p&gt;
 
-  &lt;p&gt;For URLs that are HTTP URLs, the requests must be performed by
-  &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; the specified URLs using the
-  POST method, with an entity body with the &lt;a href=#mime-type&gt;MIME type&lt;/a&gt;
+  &lt;p&gt;For URLs that are HTTP URLs, the requests must be performed using
+  the POST method, with an entity body with the &lt;a href=#mime-type&gt;MIME type&lt;/a&gt;
   &lt;code&gt;&lt;a href=#text/ping&gt;text/ping&lt;/a&gt;&lt;/code&gt; consisting of the four-character string
-  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;, from the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
-  &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; containing the &lt;a href=#hyperlink&gt;hyperlink&lt;/a&gt;. &lt;!--
-  not http-origin privacy sensitive --&gt; All relevant cookie and HTTP
+  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;. All relevant cookie and HTTP
   authentication headers must be included in the request. Which other
   headers are required depends on the URLs involved.&lt;/p&gt;
 
@@ -61006,10 +61046,6 @@
   responses. User agents may close the connection prematurely once
   they start receiving an entity body. &lt;a href=#refsCOOKIES&gt;[COOKIES]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;For URLs that are not HTTP URLs, the requests must be performed
-  by &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; the specified URL normally,
-  and discarding the results.&lt;/p&gt;
-
   &lt;p&gt;When the &lt;code title=attr-hyperlink-ping&gt;&lt;a href=#ping&gt;ping&lt;/a&gt;&lt;/code&gt; attribute is
   present, user agents should clearly indicate to the user that
   following the hyperlink will also cause secondary requests to be
@@ -61052,7 +61088,6 @@
 
   &lt;!-- resolving ping urls happens at audit time, so base URL changes
   affect the values of ping attributes --&gt;
-&lt;!--PING--&gt;
 
 
 
@@ -61539,8 +61574,9 @@
 
   &lt;p&gt;In the absence of a &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt; with the &lt;code title=rel-icon&gt;&lt;a href=#rel-icon&gt;icon&lt;/a&gt;&lt;/code&gt; keyword, for &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;s
   obtained over HTTP or HTTPS, user agents may instead attempt to
-  &lt;a href=#fetch&gt;fetch&lt;/a&gt; and use an icon with the &lt;a href=#absolute-url&gt;absolute
-  URL&lt;/a&gt; obtained by resolving the &lt;a href=#url&gt;URL&lt;/a&gt; &quot;&lt;code title=&quot;&quot;&gt;/favicon.ico&lt;/code&gt;&quot; against &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
+  &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; and use an icon with the
+  &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; obtained by resolving the &lt;a href=#url&gt;URL&lt;/a&gt;
+  &quot;&lt;code title=&quot;&quot;&gt;/favicon.ico&lt;/code&gt;&quot; against &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
   address&lt;/a&gt;, as if the page had declared that icon using the
   &lt;code title=rel-icon&gt;&lt;a href=#rel-icon&gt;icon&lt;/a&gt;&lt;/code&gt; keyword.&lt;/p&gt;
 
@@ -70403,8 +70439,8 @@
     application cache at all; the submission will be made to the
     network.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, &lt;a href=#fetch&gt;fetch&lt;/a&gt; the new resource, with the
-    &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/p&gt;
+    &lt;p&gt;Otherwise, &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the new resource,
+    with the &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/p&gt;
 
     &lt;p&gt;If the resource is being fetched using a method other than one
     &lt;a href=#concept-http-equivalent-get title=concept-http-equivalent-get&gt;equivalent to&lt;/a&gt;
@@ -72967,12 +73003,12 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource
-    from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; with the &lt;i&gt;synchronous
-    flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; be that
-    resource. HTTP caching semantics should be honored for this
-    request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it doesn't
-    matter, since this can never be cross-origin --&gt;
+    &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt;
+    the resource from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; with the
+    &lt;i&gt;synchronous flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt;
+    be that resource. HTTP caching semantics should be honored for
+    this request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it
+    doesn't matter, since this can never be cross-origin --&gt;
 
     &lt;p&gt;Parse &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; according to the &lt;a href=#parse-a-manifest title=&quot;parse a manifest&quot;&gt;rules for parsing manifests&lt;/a&gt;,
     obtaining a list of &lt;a href=#concept-appcache-explicit title=concept-appcache-explicit&gt;explicit entries&lt;/a&gt;, &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt; and the
@@ -73214,10 +73250,9 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource, from the &lt;a href=#origin&gt;origin&lt;/a&gt;
-      of the &lt;a href=#url&gt;URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, with
-      the &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;manual redirect
-      flag&lt;/i&gt; set. If this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade attempt&lt;/a&gt;, then
+      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resource, from the
+      &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;a href=#url&gt;URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, with the &lt;i&gt;synchronous flag&lt;/i&gt;
+      set and the &lt;i&gt;manual redirect flag&lt;/i&gt; set. If this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade attempt&lt;/a&gt;, then
       use the &lt;a href=#concept-appcache-newer title=concept-appcache-newer&gt;newest&lt;/a&gt;
       &lt;a href=#application-cache&gt;application cache&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;cache
       group&lt;/var&gt; as an HTTP cache, and honor HTTP caching semantics
@@ -73427,12 +73462,11 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource from &lt;var title=&quot;&quot;&gt;manifest
-    URL&lt;/var&gt; again, with the &lt;i&gt;synchronous flag&lt;/i&gt; set, and let
-    &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be that resource. HTTP caching
-    semantics should again be honored for this request.&lt;/p&gt; &lt;!--
-    http-origin privacy sensitive, though it doesn't matter, since
-    this can never be cross-origin --&gt;
+    &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resource from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; again, with the &lt;i&gt;synchronous
+    flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be that
+    resource. HTTP caching semantics should again be honored for this
+    request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it doesn't
+    matter, since this can never be cross-origin --&gt;
 
     &lt;p class=note&gt;Since caching can be honored, authors are
     encouraged to avoid setting the cache headers on the manifest in
@@ -73711,7 +73745,7 @@
   following steps instead of immediately invoking the mechanisms
   appropriate to that resource's scheme:&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the resource is not to be fetched using the HTTP GET
+  &lt;ol&gt;&lt;!--FETCH--&gt;&lt;li&gt;&lt;p&gt;If the resource is not to be fetched using the HTTP GET
    mechanism &lt;a href=#concept-http-equivalent-get title=concept-http-equivalent-get&gt;or
    equivalent&lt;/a&gt;, or if its &lt;a href=#url&gt;URL&lt;/a&gt; has a different &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component than the
    &lt;a href=#application-cache&gt;application cache&lt;/a&gt;'s &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;manifest&lt;/a&gt;, then
@@ -74217,7 +74251,7 @@
   &lt;div class=impl&gt;
 
   &lt;!-- SCRIPT EXEC (marks areas related to creation of scripts) --&gt;
-  &lt;h4 id=processing-model-1&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-2&gt;&lt;span class=secno&gt;7.1.3 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;h5 id=definitions-0&gt;&lt;span class=secno&gt;7.1.3.1 &lt;/span&gt;Definitions&lt;/h5&gt;
 
@@ -74322,12 +74356,25 @@
     &lt;p&gt;A &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; that is assigned responsibility for
     actions taken by the script.&lt;/p&gt;
 
-    &lt;p class=example&gt;When a script &lt;a href=#fetch title=fetch&gt;fetches&lt;/a&gt; a resource, the &lt;a href=&quot;#the-document's-address&quot; title=&quot;the
-    document's address&quot;&gt;address&lt;/a&gt; of the &lt;a href=&quot;#script's-document&quot;&gt;script's
-    document&lt;/a&gt; will be used to set the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header.&lt;/p&gt;
+    &lt;p class=example&gt;For example, the &lt;a href=&quot;#the-document's-address&quot; title=&quot;the document's
+    address&quot;&gt;address&lt;/a&gt; of the &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt; is
+    used to set the &lt;a href=&quot;#the-document's-address&quot; title=&quot;the document's
+    address&quot;&gt;address&lt;/a&gt; of any &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; elements
+    created using &lt;code title=dom-DOMImplementation-createDocument&gt;&lt;a href=#dom-domimplementation-createdocument&gt;createDocument()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;The &lt;dfn id=&quot;script's-referrer-source&quot;&gt;script's referrer source&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Either a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; (specifically, the
+    &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt;), or a &lt;a href=#url&gt;URL&lt;/a&gt;, which is
+    used by some APIs to determine what value to use for the &lt;code title=http-referer&gt;Referer&lt;/code&gt; (sic) header in calls to the
+    &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; algorithm.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;A &lt;dfn id=&quot;script's-url-character-encoding&quot; title=&quot;script's URL character encoding&quot;&gt;URL character encoding&lt;/dfn&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -74394,8 +74441,8 @@
   &lt;p&gt;When the specification says that a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; is to be &lt;dfn id=create-a-script title=&quot;create a
   script&quot;&gt;created&lt;/dfn&gt;, given some script source, a script source
   URL, its scripting language, a global object, a browsing context, a
-  URL character encoding, and a base URL, the user agent must run the
-  following steps:&lt;/p&gt;
+  document, a referrer source, a URL character encoding, and a base
+  URL, the user agent must run the following steps:&lt;/p&gt;
 
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;a href=#concept-bc-noscript title=concept-bc-noscript&gt;scripting is
    disabled&lt;/a&gt; for &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; passed to this
@@ -74415,9 +74462,10 @@
 
    &lt;li&gt;&lt;p&gt;Set up the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, the
    &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, the &lt;a href=&quot;#script's-document&quot;&gt;script's
-   document&lt;/a&gt;, the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;,
-   and the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from the settings passed to
-   this algorithm.&lt;/li&gt;
+   document&lt;/a&gt;, the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt;, the
+   &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;, and the
+   &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from the settings passed to this
+   algorithm.&lt;/li&gt;
 
    &lt;li&gt;
  
@@ -74440,9 +74488,9 @@
   browsing context, the user agent must &lt;a href=#create-a-script&gt;create a script&lt;/a&gt;,
   using the given script source, URL, and scripting language, using a
   new empty object as the global object, and using the given browsing
-  context as the browsing context. The URL character encoding and base
-  URL for the resulting &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; are
-  not important as no APIs are exposed to the script.&lt;/p&gt;
+  context as the browsing context. The referrer source, URL character
+  encoding, and base URL for the resulting &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; are not important as no APIs
+  are exposed to the script.&lt;/p&gt;
 
   &lt;hr&gt;&lt;p&gt;When the specification says that a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; is to be &lt;dfn id=create-a-script-from-a-node title=&quot;create a
   script from a node&quot;&gt;created from a node&lt;/dfn&gt; &lt;var title=&quot;&quot;&gt;node&lt;/var&gt;, given some script source, its URL, and its
@@ -74457,12 +74505,15 @@
    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; (or &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; itself if it is a
    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;).&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;The browsing context is the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; of
    &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of
-   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;The document is &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
 
+   &lt;li&gt;&lt;p&gt;The referrer source is &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
    &lt;li&gt;&lt;p&gt;The URL character encoding is the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's
    character encoding&quot;&gt;character encoding&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. (&lt;a href=#sce-not-copy&gt;This is a
    reference, not a copy&lt;/a&gt;.)&lt;/li&gt;
@@ -74727,7 +74778,7 @@
   release the &lt;a href=#storage-mutex&gt;storage mutex&lt;/a&gt;.&lt;/p&gt;
 
 
-  &lt;h5 id=processing-model-2&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/h5&gt;
+  &lt;h5 id=processing-model-3&gt;&lt;span class=secno&gt;7.1.4.2 &lt;/span&gt;Processing model&lt;/h5&gt;
 
   &lt;p&gt;An &lt;a href=#event-loop&gt;event loop&lt;/a&gt; must continually run through the
   following steps for as long as it exists:&lt;/p&gt;
@@ -75243,10 +75294,11 @@
 
    &lt;li&gt;&lt;p&gt;Set up the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, the
    &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, the &lt;a href=&quot;#script's-document&quot;&gt;script's
-   document&lt;/a&gt;, the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;,
-   and the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from &lt;a href=#the-script-settings-determined-from-the-node&gt;the script
-   settings determined from the node&lt;/a&gt; on which the attribute is
-   being set.&lt;/li&gt;
+   document&lt;/a&gt;, the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt;, the
+   &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;, and the
+   &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; from &lt;a href=#the-script-settings-determined-from-the-node&gt;the script settings
+   determined from the node&lt;/a&gt; on which the attribute is being
+   set.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Set the corresponding &lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;event
    handler&lt;/a&gt; to the aforementioned function.&lt;/li&gt;
@@ -76158,25 +76210,27 @@
     object, let &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; be the &lt;a href=#method-context&gt;method
     context&lt;/a&gt;, let &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; be the
     &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; with which &lt;var title=&quot;&quot;&gt;global
-    object&lt;/var&gt; is associated, let &lt;var title=&quot;&quot;&gt;character
-    encoding&lt;/var&gt; be the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character
-    encoding&quot;&gt;character encoding&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
-    associated with &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; (&lt;a href=#sce-not-copy&gt;this is a reference, not a copy&lt;/a&gt;), and let
-    &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;a href=#document-base-url title=&quot;document base
-    URL&quot;&gt;base URL&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; associated with
-    &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; (&lt;a href=#sbu-not-copy&gt;this is
-    a reference, not a copy&lt;/a&gt;).&lt;/p&gt;
+    object&lt;/var&gt; is associated, let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; and
+    &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; be the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
+    associated with &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt;, let &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt; be the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's
+    character encoding&quot;&gt;character encoding&lt;/a&gt; of the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; associated with &lt;var title=&quot;&quot;&gt;global
+    object&lt;/var&gt; (&lt;a href=#sce-not-copy&gt;this is a reference, not a
+    copy&lt;/a&gt;), and let &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;a href=#document-base-url title=&quot;document base URL&quot;&gt;base URL&lt;/a&gt; of the
+    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; associated with &lt;var title=&quot;&quot;&gt;global
+    object&lt;/var&gt; (&lt;a href=#sbu-not-copy&gt;this is a reference, not a
+    copy&lt;/a&gt;).&lt;/p&gt;
 
     &lt;p&gt;Otherwise, if the &lt;a href=#method-context&gt;method context&lt;/a&gt; is a
     &lt;code&gt;&lt;a href=#workerutils&gt;WorkerUtils&lt;/a&gt;&lt;/code&gt; object, let &lt;var title=&quot;&quot;&gt;global
-    object&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt;,
-    and &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global
-    object&lt;/a&gt;, &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;,
-    &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt;, &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character
-    encoding&lt;/a&gt;, and &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; (respectively)
-    of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that the
-    &lt;a href=#run-a-worker&gt;run a worker&lt;/a&gt; algorithm created when it created the
-    &lt;a href=#method-context&gt;method context&lt;/a&gt;.&lt;/p&gt;
+    object&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt;, and &lt;var title=&quot;&quot;&gt;base
+    URL&lt;/var&gt; be the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;,
+    &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, &lt;a href=&quot;#script's-document&quot;&gt;script's
+    document&lt;/a&gt;, &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt;,
+    &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt;, and &lt;a href=&quot;#script's-base-url&quot;&gt;script's
+    base URL&lt;/a&gt; (respectively) of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that the &lt;a href=#run-a-worker&gt;run a
+    worker&lt;/a&gt; algorithm created when it created the &lt;a href=#method-context&gt;method
+    context&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, act as described in the specification that defines
     that the &lt;code&gt;&lt;a href=#windowtimers&gt;WindowTimers&lt;/a&gt;&lt;/code&gt; interface is implemented by
@@ -76189,7 +76243,8 @@
    &lt;a href=#url&gt;URL&lt;/a&gt; where &lt;var title=&quot;&quot;&gt;script source&lt;/var&gt; can be
    found, &lt;var title=&quot;&quot;&gt;scripting language&lt;/var&gt; as the scripting
    language, &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; as the global object,
-   &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; as the browsing context, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; as the document, &lt;var title=&quot;&quot;&gt;character
+   &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; as the browsing context, &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; as the document, &lt;var title=&quot;&quot;&gt;referrer
+   source&lt;/var&gt; as the referrer source, &lt;var title=&quot;&quot;&gt;character
    encoding&lt;/var&gt; as the URL character encoding, and &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; as the base URL.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;hr&gt;&lt;p&gt;The &lt;a href=#task-source&gt;task source&lt;/a&gt; for these &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; is the &lt;dfn id=timer-task-source&gt;timer task
@@ -78386,7 +78441,7 @@
 
   &lt;div class=impl&gt;
 
-  &lt;h4 id=processing-model-3&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-4&gt;&lt;span class=secno&gt;8.5.3 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;An element's &lt;dfn id=assigned-access-key&gt;assigned access key&lt;/dfn&gt; is a key combination
   derived from the element's &lt;code title=attr-accesskey&gt;&lt;a href=#the-accesskey-attribute&gt;accesskey&lt;/a&gt;&lt;/code&gt; content attribute.
@@ -82587,7 +82642,7 @@
   &lt;a href=#permissible-worker&gt;permissible worker&lt;/a&gt;.&lt;/p&gt;
 
 
-  &lt;h4 id=processing-model-4&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-5&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;When a user agent is to &lt;dfn id=run-a-worker&gt;run a worker&lt;/dfn&gt; for a script with
   &lt;a href=#url&gt;URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, a &lt;a href=#browsing-context&gt;browsing
@@ -82616,10 +82671,12 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resource identified by &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, from the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;,
-    with the &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;force same-origin
-    flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy sensitive (looking
-    forward to CORS) --&gt;
+    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; the resource
+    identified by &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, from the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;, using &lt;var title=&quot;&quot;&gt;owner
+    document&lt;/var&gt; as the &lt;a href=#referrer-source&gt;referrer source&lt;/a&gt;, with the
+    &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;force same-origin flag&lt;/i&gt;
+    set.&lt;/p&gt; &lt;!-- not http-origin privacy sensitive (looking forward
+    to CORS) --&gt;
 
     &lt;p&gt;If the attempt fails, then for each &lt;code&gt;&lt;a href=#worker&gt;Worker&lt;/a&gt;&lt;/code&gt; or
     &lt;code&gt;&lt;a href=#sharedworker&gt;SharedWorker&lt;/a&gt;&lt;/code&gt; object associated with &lt;var title=&quot;&quot;&gt;worker global scope&lt;/var&gt;, &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to
@@ -82669,6 +82726,8 @@
     &lt;p&gt;Set the &lt;a href=&quot;#script's-document&quot;&gt;script's document&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;owner
     document&lt;/var&gt;.&lt;/p&gt;
 
+    &lt;p&gt;Set the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer source&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;.&lt;/p&gt;
+
     &lt;p&gt;Set the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character encoding&lt;/a&gt; to
     UTF-8. (This is just used for encoding non-ASCII characters in the
     query component of URLs.)&lt;/p&gt;
@@ -83404,10 +83463,11 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt; each resource identified by the
-    resulting &lt;a href=#absolute-url title=&quot;absolute URL&quot;&gt;absolute URLs&lt;/a&gt;, from
-    the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;, with the
-    &lt;i&gt;synchronous flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy
+    &lt;p&gt;Attempt to &lt;a href=#fetch&gt;fetch&lt;/a&gt;&lt;!--FETCH--&gt; each resource
+    identified by the resulting &lt;a href=#absolute-url title=&quot;absolute URL&quot;&gt;absolute
+    URLs&lt;/a&gt;, from the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s
+    &lt;a href=#origin&gt;origin&lt;/a&gt;, using the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-referrer-source&quot; title=&quot;script's referrer source&quot;&gt;referrer source&lt;/a&gt;, and with
+    the &lt;i&gt;synchronous flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy
     sensitive --&gt;
 
    &lt;/li&gt;
@@ -83443,8 +83503,8 @@
 
       &lt;p&gt;&lt;a href=#create-a-script&gt;Create a script&lt;/a&gt;, using &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; as the script source, the &lt;a href=#url&gt;URL&lt;/a&gt;
       from which &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; was obtained, and &lt;var title=&quot;&quot;&gt;language&lt;/var&gt; as the scripting language, using the
-      same global object, browsing context, URL character encoding,
-      base URL, and script group as the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that was created by the
+      same global object, browsing context, document, referrer source,
+      URL character encoding, and base URL as the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that was created by the
       worker's &lt;a href=#run-a-worker&gt;run a worker&lt;/a&gt; algorithm.&lt;/p&gt;
 
       &lt;p&gt;Let the newly created &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; run until it either
@@ -83504,7 +83564,9 @@
    null. The &lt;a href=#xmlhttprequest-base-url&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/a&gt; is the
    &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt;; the
    &lt;a href=#xmlhttprequest-origin&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/a&gt; is the script's
-   &lt;a href=#origin&gt;origin&lt;/a&gt;. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/li&gt;
+   &lt;a href=#origin&gt;origin&lt;/a&gt;, and the &lt;a href=#xmlhttprequest-referrer-source&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt;
+   referrer source&lt;/a&gt; is the &lt;a href=&quot;#script's-referrer-source&quot;&gt;script's referrer
+   source&lt;/a&gt;. &lt;a href=#refsXHR&gt;[XHR]&lt;/a&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;The interface objects and constructors defined by this
    specification, except where is further restricted by explicit
@@ -83821,14 +83883,15 @@
    &lt;li&gt;&lt;!-- if you change this, don't forget to update the
             reconnecting fetch lower down as well! --&gt;
 
-    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of the
-    resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being
-    &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, and the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;
-    being the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;&lt;!--, and
-    the &lt;i&gt;default origin behaviour&lt;/i&gt; set to &lt;i&gt;fail&lt;/i&gt; (though it
-    has no effect in the &quot;Anonymous&quot; and &quot;Use Credentials&quot; modes)--&gt;,
-    and process the resource obtained in this fashion, if any, as
-    described below.&lt;/p&gt;
+    &lt;p&gt;Do a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt;&lt;!--FETCH--&gt; of
+    the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; using the &lt;a href=#entry-script&gt;entry
+    script&lt;/a&gt;'s &lt;a href=&quot;#script's-referrer-source&quot; title=&quot;script's referrer source&quot;&gt;referrer
+    source&lt;/a&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
+    mode&lt;/var&gt;, and the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;a href=#entry-script&gt;entry
+    script&lt;/a&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;&lt;!--, and the &lt;i&gt;default origin
+    behaviour&lt;/i&gt; set to &lt;i&gt;fail&lt;/i&gt; (though it has no effect in the
+    &quot;Anonymous&quot; and &quot;Use Credentials&quot; modes)--&gt;, and process the
+    resource obtained in this fashion, if any, as described below.&lt;/p&gt;
 
     &lt;p class=note&gt;The definition of the &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; algorithm (which is used by CORS) is
     such that if the browser is already fetching the resource
@@ -83909,7 +83972,7 @@
   &lt;/ul&gt;&lt;p&gt;These values are not currently exposed on the interface.&lt;/p&gt;
 
 
-  &lt;h4 id=processing-model-5&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-6&gt;&lt;span class=secno&gt;10.2.3 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;The resource indicated in the argument to the &lt;code title=dom-EventSource&gt;&lt;a href=#dom-eventsource&gt;EventSource&lt;/a&gt;&lt;/code&gt; constructor is &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; when the constructor is run.&lt;/p&gt;
 
@@ -84031,11 +84094,12 @@
      not set to &lt;code title=dom-EventSource-CONNECTING&gt;&lt;a href=#dom-eventsource-connecting&gt;CONNECTING&lt;/a&gt;&lt;/code&gt;, abort these
      steps.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled fetch&lt;/a&gt; of
-     the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; of the event source resource, with
-     the &lt;i&gt;mode&lt;/i&gt;&lt;!--, the &lt;i&gt;default origin behaviour&lt;/i&gt;,--&gt; and
-     the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the same as those used in the
-     original request triggered by the &lt;code title=dom-EventSource&gt;&lt;a href=#dom-eventsource&gt;EventSource()&lt;/a&gt;&lt;/code&gt; constructor, and
+     &lt;li&gt;&lt;p&gt;Perform a &lt;a href=#potentially-cors-enabled-fetch&gt;potentially CORS-enabled
+     fetch&lt;/a&gt;&lt;!--FETCH--&gt; of the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; of the
+     event source resource, using the same &lt;i&gt;&lt;a href=#referrer-source&gt;referrer source&lt;/a&gt;&lt;/i&gt;, and
+     with the same &lt;i&gt;mode&lt;/i&gt;&lt;!--, &lt;i&gt;default origin
+     behaviour&lt;/i&gt;,--&gt; and &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, as those used in
+     the original request triggered by the &lt;code title=dom-EventSource&gt;&lt;a href=#dom-eventsource&gt;EventSource()&lt;/a&gt;&lt;/code&gt; constructor, and
      process the resource obtained in this fashion, if any, as
      described earlier in this section.&lt;/li&gt;
 

Modified: source
===================================================================
--- source	2012-09-12 07:21:58 UTC (rev 7340)
+++ source	2012-09-12 23:14:45 UTC (rev 7341)
@@ -3208,9 +3208,10 @@
     &lt;p&gt;This specification references the XMLHttpRequest specification
     to define how the two specifications interact. The terms
     &lt;dfn&gt;document response entity body&lt;/dfn&gt;,
-    &lt;dfn&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/dfn&gt;, and
-    &lt;dfn&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/dfn&gt; are defined in that
-    specification. &lt;a href=&quot;#refsXHR&quot;&gt;[XHR]&lt;/a&gt;&lt;/p&gt;
+    &lt;dfn&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/dfn&gt;,
+    &lt;dfn&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/dfn&gt;, and
+    &lt;dfn&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; referrer source&lt;/dfn&gt; are defined
+    in that specification. &lt;a href=&quot;#refsXHR&quot;&gt;[XHR]&lt;/a&gt;&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -8219,8 +8220,41 @@
 
   &lt;h3&gt;Fetching resources&lt;/h3&gt;
 
-  &lt;p&gt;When a user agent is to &lt;dfn&gt;fetch&lt;/dfn&gt; a resource or
-  &lt;span&gt;URL&lt;/span&gt;, optionally from an origin &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;,
+  &lt;h4&gt;Terminology&lt;/h4&gt;
+
+  &lt;p id=&quot;concept-http-equivalent&quot;&gt;User agents can implement a variety
+  of transfer protocols, but this specification mostly defines
+  behavior in terms of HTTP. &lt;a href=&quot;#refsHTTP&quot;&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;concept-http-equivalent-get&quot;&gt;HTTP GET
+  method&lt;/dfn&gt; is equivalent to the default retrieval action of the
+  protocol. For example, RETR in FTP. Such actions are idempotent and
+  safe, in HTTP terms.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;concept-http-equivalent-codes&quot;&gt;HTTP response
+  codes&lt;/dfn&gt; are equivalent to statuses in other protocols that have
+  the same basic meanings. For example, a &quot;file not found&quot; error is
+  equivalent to a 404 code, a server error is equivalent to a 5xx
+  code, and so on.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;concept-http-equivalent-headers&quot;&gt;HTTP
+  headers&lt;/dfn&gt; are equivalent to fields in other protocols that have
+  the same basic meaning. For example, the HTTP authentication
+  headers are equivalent to the authentication aspects of the FTP
+  protocol.&lt;/p&gt;
+
+  &lt;hr&gt;
+
+  &lt;p&gt;A &lt;dfn&gt;referrer source&lt;/dfn&gt; is either a &lt;code&gt;Document&lt;/code&gt; or
+  a &lt;span&gt;URL&lt;/span&gt;.&lt;/p&gt;
+
+
+  &lt;h4&gt;Processing model&lt;/h4&gt;
+
+  &lt;p&gt;When a user agent is to &lt;dfn&gt;fetch&lt;/dfn&gt;&lt;!--FETCH--&gt; a resource
+  or &lt;span&gt;URL&lt;/span&gt;, optionally &lt;strong&gt;from&lt;/strong&gt; an origin &lt;i
+  title=&quot;&quot;&gt;origin&lt;/i&gt;, optionally &lt;strong&gt;using&lt;/strong&gt; a specific
+  &lt;span&gt;referrer source&lt;/span&gt; as an &lt;i&gt;override referrer source&lt;/i&gt;,
   and optionally with a &lt;i&gt;synchronous flag&lt;/i&gt;, a &lt;i&gt;manual redirect
   flag&lt;/i&gt;, a &lt;i&gt;force same-origin flag&lt;/i&gt;, and/or a &lt;i&gt;block cookies
   flag&lt;/i&gt;, the following steps must be run. (When a &lt;em&gt;URL&lt;/em&gt; is
@@ -8243,6 +8277,11 @@
 
   &lt;ol&gt;
 
+   &lt;li&gt;&lt;p&gt;If there is a specific &lt;i&gt;override referrer source&lt;/i&gt;, and
+   it is a &lt;span&gt;URL&lt;/span&gt;, then let &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; be
+   the &lt;i&gt;override referrer source&lt;/i&gt;, and jump to the step labeled
+   &lt;i&gt;clean referrer&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;
 
     &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; be the appropriate
@@ -8250,20 +8289,23 @@
 
     &lt;dl class=&quot;switch&quot;&gt;
 
+
+     &lt;dt&gt;If there is a specific &lt;i&gt;override referrer source&lt;/i&gt;&lt;/dt&gt;
+
+     &lt;dd&gt;The &lt;i&gt;override referrer source&lt;/i&gt;.&lt;/dd&gt;
+
+
      &lt;dt&gt;When &lt;span title=&quot;navigate&quot;&gt;navigating&lt;/span&gt;&lt;/dt&gt;
 
      &lt;dd&gt;The &lt;span&gt;active document&lt;/span&gt; of the &lt;span&gt;source browsing
      context&lt;/span&gt;.&lt;/dd&gt;
 
+
      &lt;dt&gt;When fetching resources for an element&lt;/dt&gt;
 
      &lt;dd&gt;The element's &lt;code&gt;Document&lt;/code&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;When fetching resources in response to a call to an API&lt;/dt&gt;
 
-     &lt;dd&gt;The &lt;span&gt;entry script&lt;/span&gt;'s &lt;span title=&quot;script's
-     document&quot;&gt;document&lt;/span&gt;.&lt;/dd&gt;
-
     &lt;/dl&gt;
 
    &lt;/li&gt;
@@ -8281,24 +8323,46 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Generate the &lt;i&gt;address of the resource from which Request-URIs
-    are obtained&lt;/i&gt; as required by HTTP for the &lt;code
-    title=&quot;http-referer&quot;&gt;Referer&lt;/code&gt; (sic) header from &lt;span&gt;the
-    document's address&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. &lt;a
-    href=&quot;#refsHTTP&quot;&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+    &lt;p&gt;If the &lt;span&gt;origin&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;Document&lt;/var&gt; is
+    not a scheme/host/port tuple, then set &lt;var
+    title=&quot;&quot;&gt;referrer&lt;/var&gt; to the empty string and jump to the step
+    labeled &lt;i&gt;clean referrer&lt;/i&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Remove any &lt;span title=&quot;url-fragment&quot;&gt;&lt;fragment&gt;&lt;/span&gt;
-    component from the generated &lt;i&gt;address of the resource from which
-    Request-URIs are obtained&lt;/i&gt;.&lt;/p&gt; &lt;!-- RFC2616 says &quot;The URI MUST
-    NOT include a fragment.&quot; (section 14.36) --&gt;
+   &lt;/li&gt;
 
-    &lt;p&gt;If the &lt;span&gt;origin&lt;/span&gt; of the appropriate
-    &lt;code&gt;Document&lt;/code&gt; is not a scheme/host/port tuple, then the
-    &lt;code title=&quot;http-referer&quot;&gt;Referer&lt;/code&gt; (sic) header must be
-    omitted, regardless of its value.&lt;/p&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; be &lt;span&gt;the document's
+    address&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;&lt;i&gt;Clean referrer&lt;/i&gt;: Remove any &lt;span
+    title=&quot;url-fragment&quot;&gt;&lt;fragment&gt;&lt;/span&gt; component from &lt;var
+    title=&quot;&quot;&gt;referrer&lt;/var&gt;.&lt;/p&gt; &lt;!-- RFC2616 says &quot;The URI MUST NOT
+    include a fragment.&quot; (section 14.36) --&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;referrer&lt;/var&gt; is not the empty string, is not
+    a &lt;span title=&quot;data protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;data:&lt;/code&gt;
+    URL&lt;/span&gt;, is not a &lt;span title=&quot;javascript protocol&quot;&gt;&lt;code
+    title=&quot;&quot;&gt;javascript:&lt;/code&gt; URL&lt;/span&gt;, and is not the
+    &lt;span&gt;URL&lt;/span&gt; &quot;&lt;code&gt;about:blank&lt;/code&gt;&quot;, then generate the
+    &lt;i&gt;address of the resource from which Request-URIs are
+    obtained&lt;/i&gt; as required by HTTP for the &lt;code
+    title=&quot;http-referer&quot;&gt;Referer&lt;/code&gt; (sic) header from &lt;var
+    title=&quot;&quot;&gt;referrer&lt;/var&gt;. &lt;a href=&quot;#refsHTTP&quot;&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, the &lt;code title=&quot;http-referer&quot;&gt;Referer&lt;/code&gt; (sic)
+    header must be omitted, regardless of its value.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;If the algorithm was not invoked with the &lt;i&gt;synchronous
    flag&lt;/i&gt;, perform the remaining steps asynchronously.&lt;/p&gt;&lt;/li&gt;
 
@@ -8482,30 +8546,6 @@
   applicable.&lt;/p&gt;
 
 
-  &lt;h4 id=&quot;concept-http-equivalent&quot;&gt;Protocol concepts&lt;/h4&gt;
-
-  &lt;p&gt;User agents can implement a variety of transfer protocols, but
-  this specification mostly defines behavior in terms of HTTP. &lt;a
-  href=&quot;#refsHTTP&quot;&gt;[HTTP]&lt;/a&gt;&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn title=&quot;concept-http-equivalent-get&quot;&gt;HTTP GET
-  method&lt;/dfn&gt; is equivalent to the default retrieval action of the
-  protocol. For example, RETR in FTP. Such actions are idempotent and
-  safe, in HTTP terms.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn title=&quot;concept-http-equivalent-codes&quot;&gt;HTTP response
-  codes&lt;/dfn&gt; are equivalent to statuses in other protocols that have
-  the same basic meanings. For example, a &quot;file not found&quot; error is
-  equivalent to a 404 code, a server error is equivalent to a 5xx
-  code, and so on.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn title=&quot;concept-http-equivalent-headers&quot;&gt;HTTP
-  headers&lt;/dfn&gt; are equivalent to fields in other protocols that have
-  the same basic meaning. For example, the HTTP authentication
-  headers are equivalent to the authentication aspects of the FTP
-  protocol.&lt;/p&gt;
-
-
 &lt;!--ADD-TOPIC:Security--&gt;
   &lt;h4&gt;Encrypted HTTP and related security concerns&lt;/h4&gt;
 
@@ -8692,19 +8732,21 @@
 
   &lt;p&gt;When the user agent is required to perform a &lt;dfn&gt;potentially
   CORS-enabled fetch&lt;/dfn&gt; of an &lt;span&gt;absolute URL&lt;/span&gt; &lt;var
-  title=&quot;&quot;&gt;URL&lt;/var&gt;, with a mode &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; that is
+  title=&quot;&quot;&gt;URL&lt;/var&gt; with a mode &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; that is
   either &quot;&lt;span title=&quot;attr-crossorigin-none&quot;&gt;No CORS&lt;/span&gt;&quot;, &quot;&lt;span
   title=&quot;attr-crossorigin-anonymous&quot;&gt;Anonymous&lt;/span&gt;&quot;, or &quot;&lt;span
   title=&quot;attr-crossorigin-use-credentials&quot;&gt;Use Credentials&lt;/span&gt;&quot;,
-  an &lt;span&gt;origin&lt;/span&gt; &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and a default
-  origin behaviour &lt;var title=&quot;&quot;&gt;default&lt;/var&gt; which is either
-  &quot;&lt;i&gt;taint&lt;/i&gt;&quot; or &quot;&lt;i&gt;fail&lt;/i&gt;&quot;, it must run the first applicable
-  set of steps from the following list. The default origin behaviour
-  is only used if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;span
-  title=&quot;attr-crossorigin-none&quot;&gt;No CORS&lt;/span&gt;&quot;. This algorithm wraps
-  the &lt;span&gt;fetch&lt;/span&gt; algorithm above, and labels the obtained
-  resource as either &lt;dfn&gt;CORS-same-origin&lt;/dfn&gt; or
-  &lt;dfn&gt;CORS-cross-origin&lt;/dfn&gt;, or blocks the resource entirely.&lt;/p&gt;
+  optionally using a &lt;span&gt;referrer source&lt;/span&gt; &lt;var
+  title=&quot;&quot;&gt;referrer source&lt;/var&gt;, with an &lt;span&gt;origin&lt;/span&gt; &lt;var
+  title=&quot;&quot;&gt;origin&lt;/var&gt;, and with a default origin behaviour &lt;var
+  title=&quot;&quot;&gt;default&lt;/var&gt; which is either &quot;&lt;i&gt;taint&lt;/i&gt;&quot; or
+  &quot;&lt;i&gt;fail&lt;/i&gt;&quot;, it must run the first applicable set of steps from
+  the following list. The default origin behaviour is only used if
+  &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;span title=&quot;attr-crossorigin-none&quot;&gt;No
+  CORS&lt;/span&gt;&quot;. This algorithm wraps the &lt;span&gt;fetch&lt;/span&gt; algorithm
+  above, and labels the obtained resource as either
+  &lt;dfn&gt;CORS-same-origin&lt;/dfn&gt; or &lt;dfn&gt;CORS-cross-origin&lt;/dfn&gt;, or
+  blocks the resource entirely.&lt;/p&gt;
 
   &lt;dl class=&quot;switch&quot;&gt;
 
@@ -8719,9 +8761,10 @@
 
     &lt;ol&gt;
 
-     &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, with the
-     &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/li&gt; &lt;!-- http-origin privacy
-     sensitive --&gt;
+     &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;,
+     using &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified,
+     with the &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/li&gt; &lt;!-- http-origin
+     privacy sensitive --&gt;
 
      &lt;li&gt;&lt;p&gt;&lt;i&gt;Loop&lt;/i&gt;: Wait for the &lt;span&gt;fetch&lt;/span&gt; algorithm
      to know if the result is a redirect or not.&lt;/p&gt;&lt;/li&gt;
@@ -8792,7 +8835,8 @@
     &lt;p class=&quot;note&quot;&gt;The &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; does not have the
     &lt;span&gt;same origin&lt;/span&gt; as &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;.&lt;/p&gt;
 
-    &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;.&lt;/p&gt; &lt;!--
+    &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, using
+    &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified.&lt;/p&gt; &lt;!--
     http-origin privacy sensitive --&gt;
 
     &lt;p&gt;The &lt;span title=&quot;concept-task&quot;&gt;tasks&lt;/span&gt; from the
@@ -8841,10 +8885,12 @@
 
     &lt;ol&gt;
 
-     &lt;li&gt;&lt;p&gt;Perform a &lt;span&gt;cross-origin request&lt;/span&gt; with the
-     &lt;i&gt;request URL&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, the &lt;i&gt;source
-     origin&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and the &lt;i&gt;omit
-     credentials flag&lt;/i&gt; set if &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;span
+     &lt;li&gt;&lt;p&gt;Perform a &lt;span&gt;cross-origin request&lt;/span&gt;&lt;!--FETCH--&gt;
+     with the &lt;i&gt;request URL&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt;, using
+     &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; if one was specified, with
+     the &lt;i&gt;source origin&lt;/i&gt; set to &lt;var title=&quot;&quot;&gt;origin&lt;/var&gt;, and
+     with the &lt;i&gt;omit credentials flag&lt;/i&gt; set if &lt;var
+     title=&quot;&quot;&gt;mode&lt;/var&gt; is &quot;&lt;span
      title=&quot;attr-crossorigin-anonymous&quot;&gt;Anonymous&lt;/span&gt;&quot; and not set
      otherwise. &lt;a href=&quot;#refsCORS&quot;&gt;[CORS]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
 
@@ -11250,10 +11296,12 @@
 
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;success&lt;/var&gt; be false.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; from the
-   &lt;span&gt;origin&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, with the &lt;i
-   title=&quot;&quot;&gt;synchronous flag&lt;/i&gt; set and the &lt;i title=&quot;&quot;&gt;force
-   same-origin flag&lt;/i&gt; set.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; from
+   the &lt;span&gt;origin&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;, using the
+   &lt;span&gt;entry script&lt;/span&gt;'s &lt;span title=&quot;script's referrer
+   source&quot;&gt;referrer source&lt;/span&gt;, with the &lt;i title=&quot;&quot;&gt;synchronous
+   flag&lt;/i&gt; set and the &lt;i title=&quot;&quot;&gt;force same-origin flag&lt;/i&gt;
+   set.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;
 
@@ -15743,7 +15791,7 @@
 
    &lt;li&gt;&lt;p&gt;If the previous step fails, then abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resulting &lt;span&gt;absolute
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resulting &lt;span&gt;absolute
    URL&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;/ol&gt;
@@ -18101,7 +18149,8 @@
     attribute whose value is not the empty string, then the value of
     that attribute must be &lt;span title=&quot;resolve a url&quot;&gt;resolved&lt;/span&gt;
     relative to the element, and if that is successful, the specified
-    resource must then be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;, from the
+    resource must then be &lt;span
+    title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;&lt;!--FETCH--&gt;, from the
     &lt;span&gt;origin&lt;/span&gt; of the element's &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
     &lt;!-- not http-origin privacy sensitive --&gt;
 
@@ -26381,8 +26430,8 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Do a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt; of the
-    &lt;span&gt;absolute URL&lt;/span&gt; that resulted from the earlier step,
+    &lt;p&gt;Do a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt;&lt;!--FETCH--&gt; of
+    the &lt;span&gt;absolute URL&lt;/span&gt; that resulted from the earlier step,
     with the &lt;i&gt;mode&lt;/i&gt; being the state of the element's &lt;code
     title=&quot;attr-img-crossorigin&quot;&gt;crossorigin&lt;/code&gt; content attribute,
     the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;span&gt;origin&lt;/span&gt; of the
@@ -26844,10 +26893,10 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Do a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt; of the
-    resulting &lt;span&gt;absolute URL&lt;/span&gt;, with the &lt;i&gt;mode&lt;/i&gt; being
-    &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being
-    the &lt;span&gt;origin&lt;/span&gt; of the &lt;code&gt;img&lt;/code&gt; element's
+    &lt;p&gt;Do a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt;&lt;!--FETCH--&gt; of
+    the resulting &lt;span&gt;absolute URL&lt;/span&gt;, with the &lt;i&gt;mode&lt;/i&gt;
+    being &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;
+    being the &lt;span&gt;origin&lt;/span&gt; of the &lt;code&gt;img&lt;/code&gt; element's
     &lt;code&gt;Document&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
     to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
 
@@ -29322,18 +29371,18 @@
     &lt;p&gt;The user agent must &lt;span title=&quot;resolve a url&quot;&gt;resolve&lt;/span&gt;
     the value of the element's &lt;code title=&quot;attr-embed-src&quot;&gt;src&lt;/code&gt;
     attribute, relative to the element. If that is successful, the
-    user agent should &lt;span&gt;fetch&lt;/span&gt; the resulting &lt;span&gt;absolute
-    URL&lt;/span&gt;, from the element's &lt;span&gt;browsing context scope
-    origin&lt;/span&gt; if it has one&lt;!-- potentially http-origin privacy
-    sensitive --&gt;. The &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that is
-    &lt;span title=&quot;queue a task&quot;&gt;queued&lt;/span&gt; by the &lt;span&gt;networking
-    task source&lt;/span&gt; once the resource has been &lt;span
-    title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; must find and instantiate an
-    appropriate &lt;span&gt;plugin&lt;/span&gt; based on the &lt;span
-    title=&quot;concept-embed-type&quot;&gt;content's type&lt;/span&gt;, and hand that
-    &lt;span&gt;plugin&lt;/span&gt; the content of the resource, replacing any
-    previously instantiated plugin for the element.&lt;/p&gt; &lt;!-- Note that
-    this doesn't happen when the base URL changes. --&gt;
+    user agent should &lt;span&gt;fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resulting
+    &lt;span&gt;absolute URL&lt;/span&gt;, from the element's &lt;span&gt;browsing
+    context scope origin&lt;/span&gt; if it has one&lt;!-- potentially
+    http-origin privacy sensitive --&gt;. The &lt;span
+    title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that is &lt;span title=&quot;queue a
+    task&quot;&gt;queued&lt;/span&gt; by the &lt;span&gt;networking task source&lt;/span&gt;
+    once the resource has been &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; must
+    find and instantiate an appropriate &lt;span&gt;plugin&lt;/span&gt; based on
+    the &lt;span title=&quot;concept-embed-type&quot;&gt;content's type&lt;/span&gt;, and
+    hand that &lt;span&gt;plugin&lt;/span&gt; the content of the resource,
+    replacing any previously instantiated plugin for the element.&lt;/p&gt;
+    &lt;!-- Note that this doesn't happen when the base URL changes. --&gt;
 
     &lt;p&gt;Fetching the resource must &lt;span&gt;delay the load event&lt;/span&gt; of
     the element's document.&lt;/p&gt;
@@ -29776,17 +29825,18 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resulting &lt;span&gt;absolute URL&lt;/span&gt;,
-      from the element's &lt;span&gt;browsing context scope origin&lt;/span&gt; if
-      it has one&lt;!-- potentially http-origin privacy sensitive
-      --&gt;.&lt;/p&gt;
+      &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resulting &lt;span&gt;absolute
+      URL&lt;/span&gt;, from the element's &lt;span&gt;browsing context scope
+      origin&lt;/span&gt; if it has one&lt;!-- potentially http-origin privacy
+      sensitive --&gt;.&lt;/p&gt;
 
-      &lt;!-- similar text in various places --&gt; &lt;p&gt;Fetching the resource
-      must &lt;span&gt;delay the load event&lt;/span&gt; of the element's document
-      until the &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that is &lt;span
-      title=&quot;queue a task&quot;&gt;queued&lt;/span&gt; by the &lt;span&gt;networking task
-      source&lt;/span&gt; once the resource has been &lt;span
-      title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; (defined next) has been run.&lt;/p&gt;
+      &lt;!-- similar text in various places --&gt;
+      &lt;p&gt;Fetching the resource must &lt;span&gt;delay the load event&lt;/span&gt;
+      of the element's document until the &lt;span
+      title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that is &lt;span title=&quot;queue a
+      task&quot;&gt;queued&lt;/span&gt; by the &lt;span&gt;networking task source&lt;/span&gt;
+      once the resource has been &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;
+      (defined next) has been run.&lt;/p&gt;
 
       &lt;p&gt;For the purposes of the &lt;span&gt;application cache&lt;/span&gt;
       networking model, this &lt;span&gt;fetch&lt;/span&gt; operation is not for a
@@ -30651,10 +30701,10 @@
    to the element. If this fails, then there is no &lt;span&gt;poster
    frame&lt;/span&gt;; abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resulting &lt;span&gt;absolute URL&lt;/span&gt;,
-   from the element's &lt;code&gt;Document&lt;/code&gt;'s &lt;span&gt;origin&lt;/span&gt;.
-   This must &lt;span&gt;delay the load event&lt;/span&gt; of the element's
-   document.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resulting &lt;span&gt;absolute
+   URL&lt;/span&gt;, from the element's &lt;code&gt;Document&lt;/code&gt;'s
+   &lt;span&gt;origin&lt;/span&gt;. This must &lt;span&gt;delay the load event&lt;/span&gt; of
+   the element's document.&lt;/p&gt;&lt;/li&gt;
 
    &lt;!-- could define how to sniff for an image here --&gt;
 
@@ -32626,14 +32676,15 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Perform a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt; of the
-    &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt;'s &lt;span&gt;absolute
-    URL&lt;/span&gt;, with the &lt;i&gt;mode&lt;/i&gt; being the state of the
-    &lt;span&gt;media element&lt;/span&gt;'s &lt;code
+    &lt;p&gt;Perform a &lt;span&gt;potentially CORS-enabled
+    fetch&lt;/span&gt;&lt;!--FETCH--&gt; of the &lt;var title=&quot;&quot;&gt;current media
+    resource&lt;/var&gt;'s &lt;span&gt;absolute URL&lt;/span&gt;, with the &lt;i&gt;mode&lt;/i&gt;
+    being the state of the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
     title=&quot;attr-media-crossorigin&quot;&gt;crossorigin&lt;/code&gt; content
-    attribute, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;span&gt;origin&lt;/span&gt; of the
-    &lt;span&gt;media element&lt;/span&gt;'s &lt;code&gt;Document&lt;/code&gt;, and the
-    &lt;i&gt;default origin behaviour&lt;/i&gt; set to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
+    attribute, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the
+    &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;media element&lt;/span&gt;'s
+    &lt;code&gt;Document&lt;/code&gt;, and the &lt;i&gt;default origin behaviour&lt;/i&gt; set
+    to &lt;i&gt;taint&lt;/i&gt;.&lt;/p&gt;
 
     &lt;p&gt;The resource obtained in this fashion, if any, contains the
     &lt;span&gt;media data&lt;/span&gt;. It can be &lt;span&gt;CORS-same-origin&lt;/span&gt;
@@ -37736,7 +37787,7 @@
    &lt;li&gt;
 
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; is not the empty string, perform a
-    &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt; of &lt;var
+    &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt;&lt;!--FETCH--&gt; of &lt;var
     title=&quot;&quot;&gt;URL&lt;/var&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
     mode&lt;/var&gt;, the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the
     &lt;span&gt;origin&lt;/span&gt; of the &lt;code&gt;track&lt;/code&gt; element's
@@ -59567,10 +59618,10 @@
   string, the user agent must &lt;span title=&quot;resolve a
   url&quot;&gt;resolve&lt;/span&gt; the value of the &lt;code
   title=&quot;attr-input-src&quot;&gt;src&lt;/code&gt; attribute, relative to the
-  element, and if that is successful, must &lt;span&gt;fetch&lt;/span&gt; the
-  resulting &lt;span&gt;absolute URL&lt;/span&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT
-  happen when the base URL changes. --&gt; &lt;!-- http-origin privacy
-  sensitive --&gt;
+  element, and if that is successful, must
+  &lt;span&gt;fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resulting &lt;span&gt;absolute
+  URL&lt;/span&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT happen when the base URL
+  changes. --&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;ul&gt;
 
@@ -69105,13 +69156,13 @@
    title=&quot;concept-facet&quot;&gt;facets&lt;/span&gt;&lt;!-- we might need to be
    explicit about what this means for each facet, if testing shows
    this isn't well-implemented. e.g.: If there's an Icon facet for the
-   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; (this
-   would be http-origin privacy-sensitive), and then that image should
-   be associated with the command, such that each command only has its
-   image fetched once, to prevent changes to the base URL from having
-   effects after the image has been fetched once. (no need to resolve
-   the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the element is a
-   &lt;code&gt;command&lt;/code&gt; element with a &lt;code
+   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;&lt;!- -FETCH-
+   -&gt; (this would be http-origin privacy-sensitive), and then that
+   image should be associated with the command, such that each command
+   only has its image fetched once, to prevent changes to the base URL
+   from having effects after the image has been fetched once. (no need
+   to resolve the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the
+   element is a &lt;code&gt;command&lt;/code&gt; element with a &lt;code
    title=&quot;attr-command-default&quot;&gt;default&lt;/code&gt; attribute, mark the
    command as being a default command.--&gt;&lt;/dd&gt;
 
@@ -70959,7 +71010,7 @@
   &lt;/div&gt;
 
 
-&lt;!--END w3c-html--&gt;&lt;!--DOWNLOAD--&gt;
+&lt;!--DOWNLOAD--&gt;
 
   &lt;h4&gt;Downloading resources&lt;/h4&gt;
 
@@ -71018,9 +71069,9 @@
    &lt;li&gt;&lt;p&gt;Return to whatever algorithm invoked these steps and continue
    these steps asynchronously.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; and handle the
-   resulting resource &lt;span&gt;as a download&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt; &lt;!--
-   http-origin privacy sensitive --&gt;
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; &lt;var title=&quot;&quot;&gt;URL&lt;/var&gt; and
+   handle the resulting resource &lt;span&gt;as a download&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;/ol&gt;
 
@@ -71231,9 +71282,7 @@
 
   &lt;/div&gt;
 
-&lt;!--DOWNLOAD--&gt;
 
-
 &lt;!--PING--&gt;
 
   &lt;div class=&quot;impl&quot;&gt;
@@ -71250,11 +71299,14 @@
   title=&quot;attr-hyperlink-ping&quot;&gt;ping&lt;/code&gt; attribute's value, &lt;span
   title=&quot;split a string on spaces&quot;&gt;split that string on spaces&lt;/span&gt;,
   &lt;span title=&quot;resolve a url&quot;&gt;resolve&lt;/span&gt; each resulting token
-  relative to the element, and then should send a request (as
-  described below) to each of the resulting &lt;span title=&quot;absolute
-  URL&quot;&gt;absolute URLs&lt;/span&gt;. (Tokens that fail to resolve are
-  ignored.) This may be done in parallel with the primary request, and
-  is independent of the result of that request.&lt;/p&gt;
+  relative to the element, and then each of the resulting &lt;span
+  title=&quot;absolute URL&quot;&gt;absolute URLs&lt;/span&gt; should be &lt;span
+  title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;&lt;!--FETCH--&gt; from the
+  &lt;span&gt;origin&lt;/span&gt; of the &lt;code&gt;Document&lt;/code&gt; containing the
+  &lt;span&gt;hyperlink&lt;/span&gt; &lt;!-- not http-origin privacy sensitive --&gt;
+  (as described below). (Tokens that fail to resolve are ignored.)
+  This may be done in parallel with the primary request, and is
+  independent of the result of that request.&lt;/p&gt;
 
   &lt;p&gt;User agents should allow the user to adjust this behavior, for
   example in conjunction with a setting that disables the sending of
@@ -71264,13 +71316,10 @@
   or selectively ignore URLs in the list (e.g. ignoring any
   third-party URLs).&lt;/p&gt;
 
-  &lt;p&gt;For URLs that are HTTP URLs, the requests must be performed by
-  &lt;span title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; the specified URLs using the
-  POST method, with an entity body with the &lt;span&gt;MIME type&lt;/span&gt;
+  &lt;p&gt;For URLs that are HTTP URLs, the requests must be performed using
+  the POST method, with an entity body with the &lt;span&gt;MIME type&lt;/span&gt;
   &lt;code&gt;text/ping&lt;/code&gt; consisting of the four-character string
-  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;, from the &lt;span&gt;origin&lt;/span&gt; of the
-  &lt;code&gt;Document&lt;/code&gt; containing the &lt;span&gt;hyperlink&lt;/span&gt;. &lt;!--
-  not http-origin privacy sensitive --&gt; All relevant cookie and HTTP
+  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;. All relevant cookie and HTTP
   authentication headers must be included in the request. Which other
   headers are required depends on the URLs involved.&lt;/p&gt;
 
@@ -71327,10 +71376,6 @@
   they start receiving an entity body. &lt;a
   href=&quot;#refsCOOKIES&quot;&gt;[COOKIES]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;For URLs that are not HTTP URLs, the requests must be performed
-  by &lt;span title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; the specified URL normally,
-  and discarding the results.&lt;/p&gt;
-
   &lt;p&gt;When the &lt;code title=&quot;attr-hyperlink-ping&quot;&gt;ping&lt;/code&gt; attribute is
   present, user agents should clearly indicate to the user that
   following the hyperlink will also cause secondary requests to be
@@ -71378,7 +71423,6 @@
 
   &lt;!-- resolving ping urls happens at audit time, so base URL changes
   affect the values of ping attributes --&gt;
-&lt;!--START w3c-html--&gt;&lt;!--PING--&gt;
 
 
 
@@ -71975,9 +72019,9 @@
   &lt;p&gt;In the absence of a &lt;code&gt;link&lt;/code&gt; with the &lt;code
   title=&quot;rel-icon&quot;&gt;icon&lt;/code&gt; keyword, for &lt;code&gt;Document&lt;/code&gt;s
   obtained over HTTP or HTTPS, user agents may instead attempt to
-  &lt;span&gt;fetch&lt;/span&gt; and use an icon with the &lt;span&gt;absolute
-  URL&lt;/span&gt; obtained by resolving the &lt;span&gt;URL&lt;/span&gt; &quot;&lt;code
-  title=&quot;&quot;&gt;/favicon.ico&lt;/code&gt;&quot; against &lt;span&gt;the document's
+  &lt;span&gt;fetch&lt;/span&gt;&lt;!--FETCH--&gt; and use an icon with the
+  &lt;span&gt;absolute URL&lt;/span&gt; obtained by resolving the &lt;span&gt;URL&lt;/span&gt;
+  &quot;&lt;code title=&quot;&quot;&gt;/favicon.ico&lt;/code&gt;&quot; against &lt;span&gt;the document's
   address&lt;/span&gt;, as if the page had declared that icon using the
   &lt;code title=&quot;rel-icon&quot;&gt;icon&lt;/code&gt; keyword.&lt;/p&gt;
 
@@ -82315,8 +82359,8 @@
     application cache at all; the submission will be made to the
     network.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, &lt;span&gt;fetch&lt;/span&gt; the new resource, with the
-    &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/p&gt;
+    &lt;p&gt;Otherwise, &lt;span&gt;fetch&lt;/span&gt;&lt;!--FETCH--&gt; the new resource,
+    with the &lt;i&gt;manual redirect flag&lt;/i&gt; set.&lt;/p&gt;
 
     &lt;p&gt;If the resource is being fetched using a method other than one
     &lt;span title=&quot;concept-http-equivalent-get&quot;&gt;equivalent to&lt;/span&gt;
@@ -85285,12 +85329,12 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;span&gt;Fetch&lt;/span&gt; the resource
-    from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; with the &lt;i&gt;synchronous
-    flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; be that
-    resource. HTTP caching semantics should be honored for this
-    request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it doesn't
-    matter, since this can never be cross-origin --&gt;
+    &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt;
+    the resource from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt; with the
+    &lt;i&gt;synchronous flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt;
+    be that resource. HTTP caching semantics should be honored for
+    this request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it
+    doesn't matter, since this can never be cross-origin --&gt;
 
     &lt;p&gt;Parse &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; according to the &lt;span
     title=&quot;parse a manifest&quot;&gt;rules for parsing manifests&lt;/span&gt;,
@@ -85586,10 +85630,10 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resource, from the &lt;span&gt;origin&lt;/span&gt;
-      of the &lt;span&gt;URL&lt;/span&gt; &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, with
-      the &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;manual redirect
-      flag&lt;/i&gt; set. If this is an &lt;span
+      &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resource, from the
+      &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;URL&lt;/span&gt; &lt;var
+      title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, with the &lt;i&gt;synchronous flag&lt;/i&gt;
+      set and the &lt;i&gt;manual redirect flag&lt;/i&gt; set. If this is an &lt;span
       title=&quot;concept-appcache-upgrade&quot;&gt;upgrade attempt&lt;/span&gt;, then
       use the &lt;span title=&quot;concept-appcache-newer&quot;&gt;newest&lt;/span&gt;
       &lt;span&gt;application cache&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;cache
@@ -85833,12 +85877,12 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resource from &lt;var title=&quot;&quot;&gt;manifest
-    URL&lt;/var&gt; again, with the &lt;i&gt;synchronous flag&lt;/i&gt; set, and let
-    &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be that resource. HTTP caching
-    semantics should again be honored for this request.&lt;/p&gt; &lt;!--
-    http-origin privacy sensitive, though it doesn't matter, since
-    this can never be cross-origin --&gt;
+    &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resource from &lt;var
+    title=&quot;&quot;&gt;manifest URL&lt;/var&gt; again, with the &lt;i&gt;synchronous
+    flag&lt;/i&gt; set, and let &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be that
+    resource. HTTP caching semantics should again be honored for this
+    request.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it doesn't
+    matter, since this can never be cross-origin --&gt;
 
     &lt;p class=&quot;note&quot;&gt;Since caching can be honored, authors are
     encouraged to avoid setting the cache headers on the manifest in
@@ -86173,7 +86217,7 @@
   following steps instead of immediately invoking the mechanisms
   appropriate to that resource's scheme:&lt;/p&gt;
 
-  &lt;ol&gt;
+  &lt;ol&gt; &lt;!--FETCH--&gt;
 
    &lt;li&gt;&lt;p&gt;If the resource is not to be fetched using the HTTP GET
    mechanism &lt;span title=&quot;concept-http-equivalent-get&quot;&gt;or
@@ -86877,14 +86921,27 @@
     &lt;p&gt;A &lt;code&gt;Document&lt;/code&gt; that is assigned responsibility for
     actions taken by the script.&lt;/p&gt;
 
-    &lt;p class=&quot;example&quot;&gt;When a script &lt;span
-    title=&quot;fetch&quot;&gt;fetches&lt;/span&gt; a resource, the &lt;span title=&quot;the
-    document's address&quot;&gt;address&lt;/span&gt; of the &lt;span&gt;script's
-    document&lt;/span&gt; will be used to set the &lt;code
-    title=&quot;http-referer&quot;&gt;Referer&lt;/code&gt; (sic) header.&lt;/p&gt;
+    &lt;p class=&quot;example&quot;&gt;For example, the &lt;span title=&quot;the document's
+    address&quot;&gt;address&lt;/span&gt; of the &lt;span&gt;script's document&lt;/span&gt; is
+    used to set the &lt;span title=&quot;the document's
+    address&quot;&gt;address&lt;/span&gt; of any &lt;code&gt;Document&lt;/code&gt; elements
+    created using &lt;code
+    title=&quot;dom-DOMImplementation-createDocument&quot;&gt;createDocument()&lt;/code&gt;.&lt;/p&gt;
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;The &lt;dfn&gt;script's referrer source&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Either a &lt;code&gt;Document&lt;/code&gt; (specifically, the
+    &lt;span&gt;script's document&lt;/span&gt;), or a &lt;span&gt;URL&lt;/span&gt;, which is
+    used by some APIs to determine what value to use for the &lt;code
+    title=&quot;http-referer&quot;&gt;Referer&lt;/code&gt; (sic) header in calls to the
+    &lt;span title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; algorithm.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;A &lt;dfn title=&quot;script's URL character encoding&quot;&gt;URL character encoding&lt;/dfn&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -86961,8 +87018,8 @@
   title=&quot;concept-script&quot;&gt;script&lt;/span&gt; is to be &lt;dfn title=&quot;create a
   script&quot;&gt;created&lt;/dfn&gt;, given some script source, a script source
   URL, its scripting language, a global object, a browsing context, a
-  URL character encoding, and a base URL, the user agent must run the
-  following steps:&lt;/p&gt;
+  document, a referrer source, a URL character encoding, and a base
+  URL, the user agent must run the following steps:&lt;/p&gt;
 
   &lt;ol&gt;
 
@@ -86984,9 +87041,10 @@
 
    &lt;li&gt;&lt;p&gt;Set up the &lt;span&gt;script's global object&lt;/span&gt;, the
    &lt;span&gt;script's browsing context&lt;/span&gt;, the &lt;span&gt;script's
-   document&lt;/span&gt;, the &lt;span&gt;script's URL character encoding&lt;/span&gt;,
-   and the &lt;span&gt;script's base URL&lt;/span&gt; from the settings passed to
-   this algorithm.&lt;/p&gt;&lt;/li&gt;
+   document&lt;/span&gt;, the &lt;span&gt;script's referrer source&lt;/span&gt;, the
+   &lt;span&gt;script's URL character encoding&lt;/span&gt;, and the
+   &lt;span&gt;script's base URL&lt;/span&gt; from the settings passed to this
+   algorithm.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;
  
@@ -87016,9 +87074,10 @@
   browsing context, the user agent must &lt;span&gt;create a script&lt;/span&gt;,
   using the given script source, URL, and scripting language, using a
   new empty object as the global object, and using the given browsing
-  context as the browsing context. The URL character encoding and base
-  URL for the resulting &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; are
-  not important as no APIs are exposed to the script.&lt;/p&gt;
+  context as the browsing context. The referrer source, URL character
+  encoding, and base URL for the resulting &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt; are not important as no APIs
+  are exposed to the script.&lt;/p&gt;
 
   &lt;hr&gt;
 
@@ -87041,12 +87100,16 @@
    title=&quot;&quot;&gt;node&lt;/var&gt; itself if it is a
    &lt;code&gt;Document&lt;/code&gt;).&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;Window&lt;/code&gt; object of &lt;var
+   title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;The browsing context is the &lt;span&gt;browsing context&lt;/span&gt; of
    &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;Window&lt;/code&gt; object of
-   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;The document is &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
 
+   &lt;li&gt;&lt;p&gt;The referrer source is &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
    &lt;li&gt;&lt;p&gt;The URL character encoding is the &lt;span title=&quot;document's
    character encoding&quot;&gt;character encoding&lt;/span&gt; of &lt;var
    title=&quot;&quot;&gt;document&lt;/var&gt;. (&lt;a href=&quot;#sce-not-copy&quot;&gt;This is a
@@ -87967,10 +88030,11 @@
 
    &lt;li&gt;&lt;p&gt;Set up the &lt;span&gt;script's global object&lt;/span&gt;, the
    &lt;span&gt;script's browsing context&lt;/span&gt;, the &lt;span&gt;script's
-   document&lt;/span&gt;, the &lt;span&gt;script's URL character encoding&lt;/span&gt;,
-   and the &lt;span&gt;script's base URL&lt;/span&gt; from &lt;span&gt;the script
-   settings determined from the node&lt;/span&gt; on which the attribute is
-   being set.&lt;/p&gt;&lt;/li&gt;
+   document&lt;/span&gt;, the &lt;span&gt;script's referrer source&lt;/span&gt;, the
+   &lt;span&gt;script's URL character encoding&lt;/span&gt;, and the
+   &lt;span&gt;script's base URL&lt;/span&gt; from &lt;span&gt;the script settings
+   determined from the node&lt;/span&gt; on which the attribute is being
+   set.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Set the corresponding &lt;span title=&quot;event handlers&quot;&gt;event
    handler&lt;/span&gt; to the aforementioned function.&lt;/p&gt;&lt;/li&gt;
@@ -89043,27 +89107,32 @@
     object, let &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; be the &lt;span&gt;method
     context&lt;/span&gt;, let &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; be the
     &lt;span&gt;browsing context&lt;/span&gt; with which &lt;var title=&quot;&quot;&gt;global
-    object&lt;/var&gt; is associated, let &lt;var title=&quot;&quot;&gt;character
-    encoding&lt;/var&gt; be the &lt;span title=&quot;document's character
-    encoding&quot;&gt;character encoding&lt;/span&gt; of the &lt;code&gt;Document&lt;/code&gt;
-    associated with &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; (&lt;a
-    href=&quot;#sce-not-copy&quot;&gt;this is a reference, not a copy&lt;/a&gt;), and let
-    &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;span title=&quot;document base
-    URL&quot;&gt;base URL&lt;/span&gt; of the &lt;code&gt;Document&lt;/code&gt; associated with
-    &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; (&lt;a href=&quot;#sbu-not-copy&quot;&gt;this is
-    a reference, not a copy&lt;/a&gt;).&lt;/p&gt;
+    object&lt;/var&gt; is associated, let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; and
+    &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt; be the &lt;code&gt;Document&lt;/code&gt;
+    associated with &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt;, let &lt;var
+    title=&quot;&quot;&gt;character encoding&lt;/var&gt; be the &lt;span title=&quot;document's
+    character encoding&quot;&gt;character encoding&lt;/span&gt; of the
+    &lt;code&gt;Document&lt;/code&gt; associated with &lt;var title=&quot;&quot;&gt;global
+    object&lt;/var&gt; (&lt;a href=&quot;#sce-not-copy&quot;&gt;this is a reference, not a
+    copy&lt;/a&gt;), and let &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;span
+    title=&quot;document base URL&quot;&gt;base URL&lt;/span&gt; of the
+    &lt;code&gt;Document&lt;/code&gt; associated with &lt;var title=&quot;&quot;&gt;global
+    object&lt;/var&gt; (&lt;a href=&quot;#sbu-not-copy&quot;&gt;this is a reference, not a
+    copy&lt;/a&gt;).&lt;/p&gt;
 
     &lt;p&gt;Otherwise, if the &lt;span&gt;method context&lt;/span&gt; is a
     &lt;code&gt;WorkerUtils&lt;/code&gt; object, let &lt;var title=&quot;&quot;&gt;global
     object&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt;, &lt;var
-    title=&quot;&quot;&gt;document&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;character encoding&lt;/var&gt;,
-    and &lt;var title=&quot;&quot;&gt;base URL&lt;/var&gt; be the &lt;span&gt;script's global
-    object&lt;/span&gt;, &lt;span&gt;script's browsing context&lt;/span&gt;,
-    &lt;span&gt;script's document&lt;/span&gt;, &lt;span&gt;script's URL character
-    encoding&lt;/span&gt;, and &lt;span&gt;script's base URL&lt;/span&gt; (respectively)
-    of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that the
-    &lt;span&gt;run a worker&lt;/span&gt; algorithm created when it created the
-    &lt;span&gt;method context&lt;/span&gt;.&lt;/p&gt;
+    title=&quot;&quot;&gt;document&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;referrer source&lt;/var&gt;, &lt;var
+    title=&quot;&quot;&gt;character encoding&lt;/var&gt;, and &lt;var title=&quot;&quot;&gt;base
+    URL&lt;/var&gt; be the &lt;span&gt;script's global object&lt;/span&gt;,
+    &lt;span&gt;script's browsing context&lt;/span&gt;, &lt;span&gt;script's
+    document&lt;/span&gt;, &lt;span&gt;script's referrer source&lt;/span&gt;,
+    &lt;span&gt;script's URL character encoding&lt;/span&gt;, and &lt;span&gt;script's
+    base URL&lt;/span&gt; (respectively) of the &lt;span
+    title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that the &lt;span&gt;run a
+    worker&lt;/span&gt; algorithm created when it created the &lt;span&gt;method
+    context&lt;/span&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, act as described in the specification that defines
     that the &lt;code&gt;WindowTimers&lt;/code&gt; interface is implemented by
@@ -89080,7 +89149,8 @@
    found, &lt;var title=&quot;&quot;&gt;scripting language&lt;/var&gt; as the scripting
    language, &lt;var title=&quot;&quot;&gt;global object&lt;/var&gt; as the global object,
    &lt;var title=&quot;&quot;&gt;browsing context&lt;/var&gt; as the browsing context, &lt;var
-   title=&quot;&quot;&gt;document&lt;/var&gt; as the document, &lt;var title=&quot;&quot;&gt;character
+   title=&quot;&quot;&gt;document&lt;/var&gt; as the document, &lt;var title=&quot;&quot;&gt;referrer
+   source&lt;/var&gt; as the referrer source, &lt;var title=&quot;&quot;&gt;character
    encoding&lt;/var&gt; as the URL character encoding, and &lt;var
    title=&quot;&quot;&gt;base URL&lt;/var&gt; as the base URL.&lt;/p&gt;&lt;/li&gt;
 
@@ -95842,11 +95912,13 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Attempt to &lt;span&gt;fetch&lt;/span&gt; the resource identified by &lt;var
-    title=&quot;&quot;&gt;url&lt;/var&gt;, from the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;,
-    with the &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;force same-origin
-    flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy sensitive (looking
-    forward to CORS) --&gt;
+    &lt;p&gt;Attempt to &lt;span&gt;fetch&lt;/span&gt;&lt;!--FETCH--&gt; the resource
+    identified by &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, from the &lt;var
+    title=&quot;&quot;&gt;owner origin&lt;/var&gt;, using &lt;var title=&quot;&quot;&gt;owner
+    document&lt;/var&gt; as the &lt;span&gt;referrer source&lt;/span&gt;, with the
+    &lt;i&gt;synchronous flag&lt;/i&gt; set and the &lt;i&gt;force same-origin flag&lt;/i&gt;
+    set.&lt;/p&gt; &lt;!-- not http-origin privacy sensitive (looking forward
+    to CORS) --&gt;
 
     &lt;p&gt;If the attempt fails, then for each &lt;code&gt;Worker&lt;/code&gt; or
     &lt;code&gt;SharedWorker&lt;/code&gt; object associated with &lt;var
@@ -95907,6 +95979,9 @@
     &lt;p&gt;Set the &lt;span&gt;script's document&lt;/span&gt; to &lt;var title=&quot;&quot;&gt;owner
     document&lt;/var&gt;.&lt;/p&gt;
 
+    &lt;p&gt;Set the &lt;span&gt;script's referrer source&lt;/span&gt; to &lt;var
+    title=&quot;&quot;&gt;url&lt;/var&gt;.&lt;/p&gt;
+
     &lt;p&gt;Set the &lt;span&gt;script's URL character encoding&lt;/span&gt; to
     UTF-8. (This is just used for encoding non-ASCII characters in the
     query component of URLs.)&lt;/p&gt;
@@ -96775,10 +96850,12 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Attempt to &lt;span&gt;fetch&lt;/span&gt; each resource identified by the
-    resulting &lt;span title=&quot;absolute URL&quot;&gt;absolute URLs&lt;/span&gt;, from
-    the &lt;span&gt;entry script&lt;/span&gt;'s &lt;span&gt;origin&lt;/span&gt;, with the
-    &lt;i&gt;synchronous flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy
+    &lt;p&gt;Attempt to &lt;span&gt;fetch&lt;/span&gt;&lt;!--FETCH--&gt; each resource
+    identified by the resulting &lt;span title=&quot;absolute URL&quot;&gt;absolute
+    URLs&lt;/span&gt;, from the &lt;span&gt;entry script&lt;/span&gt;'s
+    &lt;span&gt;origin&lt;/span&gt;, using the &lt;span&gt;entry script&lt;/span&gt;'s &lt;span
+    title=&quot;script's referrer source&quot;&gt;referrer source&lt;/span&gt;, and with
+    the &lt;i&gt;synchronous flag&lt;/i&gt; set.&lt;/p&gt; &lt;!-- not http-origin privacy
     sensitive --&gt;
 
    &lt;/li&gt;
@@ -96821,8 +96898,8 @@
       title=&quot;&quot;&gt;source&lt;/var&gt; as the script source, the &lt;span&gt;URL&lt;/span&gt;
       from which &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; was obtained, and &lt;var
       title=&quot;&quot;&gt;language&lt;/var&gt; as the scripting language, using the
-      same global object, browsing context, URL character encoding,
-      base URL, and script group as the &lt;span
+      same global object, browsing context, document, referrer source,
+      URL character encoding, and base URL as the &lt;span
       title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that was created by the
       worker's &lt;span&gt;run a worker&lt;/span&gt; algorithm.&lt;/p&gt;
 
@@ -96897,7 +96974,9 @@
    null. The &lt;span&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; base URL&lt;/span&gt; is the
    &lt;span&gt;script's base URL&lt;/span&gt;; the
    &lt;span&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt; origin&lt;/span&gt; is the script's
-   &lt;span&gt;origin&lt;/span&gt;. &lt;a href=&quot;#refsXHR&quot;&gt;[XHR]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
+   &lt;span&gt;origin&lt;/span&gt;, and the &lt;span&gt;&lt;code&gt;XMLHttpRequest&lt;/code&gt;
+   referrer source&lt;/span&gt; is the &lt;span&gt;script's referrer
+   source&lt;/span&gt;. &lt;a href=&quot;#refsXHR&quot;&gt;[XHR]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;The interface objects and constructors defined by this
    specification, except where is further restricted by explicit
@@ -97267,14 +97346,15 @@
    &lt;li&gt;&lt;!-- if you change this, don't forget to update the
             reconnecting fetch lower down as well! --&gt;
 
-    &lt;p&gt;Do a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt; of the
-    resulting &lt;span&gt;absolute URL&lt;/span&gt;, with the &lt;i&gt;mode&lt;/i&gt; being
-    &lt;var title=&quot;&quot;&gt;CORS mode&lt;/var&gt;, and the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;
-    being the &lt;span&gt;entry script&lt;/span&gt;'s &lt;span&gt;origin&lt;/span&gt;&lt;!--, and
-    the &lt;i&gt;default origin behaviour&lt;/i&gt; set to &lt;i&gt;fail&lt;/i&gt; (though it
-    has no effect in the &quot;Anonymous&quot; and &quot;Use Credentials&quot; modes)--&gt;,
-    and process the resource obtained in this fashion, if any, as
-    described below.&lt;/p&gt;
+    &lt;p&gt;Do a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt;&lt;!--FETCH--&gt; of
+    the resulting &lt;span&gt;absolute URL&lt;/span&gt; using the &lt;span&gt;entry
+    script&lt;/span&gt;'s &lt;span title=&quot;script's referrer source&quot;&gt;referrer
+    source&lt;/span&gt;, with the &lt;i&gt;mode&lt;/i&gt; being &lt;var title=&quot;&quot;&gt;CORS
+    mode&lt;/var&gt;, and the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the &lt;span&gt;entry
+    script&lt;/span&gt;'s &lt;span&gt;origin&lt;/span&gt;&lt;!--, and the &lt;i&gt;default origin
+    behaviour&lt;/i&gt; set to &lt;i&gt;fail&lt;/i&gt; (though it has no effect in the
+    &quot;Anonymous&quot; and &quot;Use Credentials&quot; modes)--&gt;, and process the
+    resource obtained in this fashion, if any, as described below.&lt;/p&gt;
 
     &lt;p class=&quot;note&quot;&gt;The definition of the &lt;span
     title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; algorithm (which is used by CORS) is
@@ -97531,11 +97611,12 @@
      title=&quot;dom-EventSource-CONNECTING&quot;&gt;CONNECTING&lt;/code&gt;, abort these
      steps.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Perform a &lt;span&gt;potentially CORS-enabled fetch&lt;/span&gt; of
-     the &lt;span&gt;absolute URL&lt;/span&gt; of the event source resource, with
-     the &lt;i&gt;mode&lt;/i&gt;&lt;!--, the &lt;i&gt;default origin behaviour&lt;/i&gt;,--&gt; and
-     the &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt; being the same as those used in the
-     original request triggered by the &lt;code
+     &lt;li&gt;&lt;p&gt;Perform a &lt;span&gt;potentially CORS-enabled
+     fetch&lt;/span&gt;&lt;!--FETCH--&gt; of the &lt;span&gt;absolute URL&lt;/span&gt; of the
+     event source resource, using the same &lt;i&gt;referrer source&lt;/i&gt;, and
+     with the same &lt;i&gt;mode&lt;/i&gt;&lt;!--, &lt;i&gt;default origin
+     behaviour&lt;/i&gt;,--&gt; and &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, as those used in
+     the original request triggered by the &lt;code
      title=&quot;dom-EventSource&quot;&gt;EventSource()&lt;/code&gt; constructor, and
      process the resource obtained in this fashion, if any, as
      described earlier in this section.&lt;/p&gt;&lt;/li&gt;


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014203.html">[html5] r7340 - [e] (0) Make this more consistent with other prose,	for clarity. Fixing https:// [...]
</A></li>
	<LI>Next message: <A HREF="014205.html">[html5] r7342 - [e] (0) update for CORS Affected topics: HTML
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14204">[ date ]</a>
              <a href="thread.html#14204">[ thread ]</a>
              <a href="subject.html#14204">[ subject ]</a>
              <a href="author.html#14204">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
