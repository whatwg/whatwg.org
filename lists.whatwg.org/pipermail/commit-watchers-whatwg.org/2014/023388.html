<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r8784 - [e] (0) Add in some clearer indentiation in the	table sorting algorithm to make [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8784%20-%20%5Be%5D%20%280%29%20Add%20in%20some%20clearer%20indentiation%20in%20the%0A%09table%20sorting%20algorithm%20to%20make%20%5B...%5D&In-Reply-To=%3C20140917225831.DF62A20237E13E%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023387.html">
   <LINK REL="Next"  HREF="023389.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r8784 - [e] (0) Add in some clearer indentiation in the	table sorting algorithm to make [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8784%20-%20%5Be%5D%20%280%29%20Add%20in%20some%20clearer%20indentiation%20in%20the%0A%09table%20sorting%20algorithm%20to%20make%20%5B...%5D&In-Reply-To=%3C20140917225831.DF62A20237E13E%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r8784 - [e] (0) Add in some clearer indentiation in the	table sorting algorithm to make [...]">whatwg at whatwg.org
       </A><BR>
    <I>Wed Sep 17 15:58:31 PDT 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="023387.html">[html5] r8783 - [giow] (1) Fix IDL blocks due to my	misunderstanding what 'optional' meant Fixin [...]
</A></li>
        <LI>Next message: <A HREF="023389.html">[html5] r8785 - [giow] (3) Add the select() method to input types	that might have text fields bu [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23388">[ date ]</a>
              <a href="thread.html#23388">[ thread ]</a>
              <a href="subject.html#23388">[ subject ]</a>
              <a href="author.html#23388">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2014-09-17 15:58:28 -0700 (Wed, 17 Sep 2014)
New Revision: 8784

Modified:
   complete.html
   index
   source
Log:
[e] (0) Add in some clearer indentiation in the table sorting algorithm to make it easier to understand
Fixing <A HREF="https://www.w3.org/Bugs/Public/show_bug.cgi?id=26660">https://www.w3.org/Bugs/Public/show_bug.cgi?id=26660</A>
Affected topics: HTML

Modified: complete.html
===================================================================
--- complete.html	2014-09-17 22:43:04 UTC (rev 8783)
+++ complete.html	2014-09-17 22:58:28 UTC (rev 8784)
@@ -29719,365 +29719,407 @@
 
    &lt;li&gt;&lt;p&gt;If &lt;var&gt;table&lt;/var&gt; has no &lt;a href=#concept-row-group id=table-sorting-model:concept-row-group-4&gt;row group&lt;/a&gt;
    corresponding to a &lt;code id=table-sorting-model:the-thead-element-9&gt;&lt;a href=#the-thead-element&gt;thead&lt;/a&gt;&lt;/code&gt; element, then set &lt;var&gt;ignore first group&lt;/var&gt; to
-   true. Otherwise, set it to false.&lt;li&gt;&lt;p&gt;&lt;i&gt;Row loop&lt;/i&gt;: Let &lt;var&gt;rows&lt;/var&gt; be an empty list of &lt;code id=table-sorting-model:the-tr-element-4&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
-   elements.&lt;li&gt;
+   true. Otherwise, set it to false.&lt;li&gt;
 
-    &lt;p&gt;Run the appropriate steps from the following list:&lt;/p&gt;
+    &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tr-element-5&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Row loop&lt;/i&gt;: Let &lt;var&gt;rows&lt;/var&gt; be an empty list of &lt;code id=table-sorting-model:the-tr-element-4&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
+     elements.&lt;li&gt;
 
-     &lt;dd&gt;
+      &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Collect&lt;/i&gt;: Append the element pointed to by &lt;var&gt;row collection
-       cursor&lt;/var&gt; to &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are no &lt;code id=table-sorting-model:the-tr-element-6&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-2&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
-       collection cursor&lt;/var&gt;, or if the next such child is a &lt;code id=table-sorting-model:the-tbody-element-3&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element, then jump
-       to the step labeled &lt;i&gt;group&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-7&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; child
-       of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;collect&lt;/i&gt; above.&lt;/ol&gt;
+      &lt;ol&gt;&lt;li&gt;
 
-     &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tbody-element-4&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element
+        &lt;p&gt;Run the appropriate steps from the following list:&lt;/p&gt;
 
-     &lt;dd&gt;
+        &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tr-element-5&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element
 
-      &lt;ol&gt;&lt;li&gt;&lt;p&gt;Place all the &lt;code id=table-sorting-model:the-tr-element-8&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element children of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt; into &lt;var&gt;rows&lt;/var&gt;, in &lt;a href=#tree-order id=table-sorting-model:tree-order-2&gt;tree
-       order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;rows&lt;/var&gt; is empty, jump to the step labeled &lt;i&gt;increment loop&lt;/i&gt;
-       below.&lt;/ol&gt;
+         &lt;dd&gt;
 
-     &lt;/dl&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Collect&lt;/i&gt;: Append the element pointed to by &lt;var&gt;row collection
+           cursor&lt;/var&gt; to &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are no &lt;code id=table-sorting-model:the-tr-element-6&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-2&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
+           collection cursor&lt;/var&gt;, or if the next such child is a &lt;code id=table-sorting-model:the-tbody-element-3&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element, then jump
+           to the step labeled &lt;i&gt;group&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-7&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; child
+           of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Jump back to the step labeled &lt;i&gt;collect&lt;/i&gt; above.&lt;/ol&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Group&lt;/i&gt;: Let &lt;var&gt;groups&lt;/var&gt; be an empty list of groups of &lt;code id=table-sorting-model:the-tr-element-9&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
-   elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group&lt;/var&gt; be an empty group of &lt;code id=table-sorting-model:the-tr-element-10&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; be a pointer to an element, initially pointing at the
-   first &lt;code id=table-sorting-model:the-tr-element-11&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Start group&lt;/i&gt;: Let &lt;var&gt;pending rows in group&lt;/var&gt; be 1.&lt;li&gt;&lt;p&gt;&lt;i&gt;Group loop&lt;/i&gt;: Append the &lt;code id=table-sorting-model:the-tr-element-12&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element pointed to by &lt;var&gt;group
-   cursor&lt;/var&gt; to &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are any &lt;a href=#concept-cell id=table-sorting-model:concept-cell-11&gt;cells&lt;/a&gt; whose highest &lt;a href=#concept-row id=table-sorting-model:concept-row-3&gt;row&lt;/a&gt;'s element is the one pointed to by &lt;var&gt;group
-   cursor&lt;/var&gt;, then let &lt;var&gt;tallest height&lt;/var&gt; be the number of rows covered by the
-   tallest such &lt;a href=#concept-cell id=table-sorting-model:concept-cell-12&gt;cell&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tallest height&lt;/var&gt; is greater than &lt;var&gt;pending rows in
-   group&lt;/var&gt; then set &lt;var&gt;pending rows in group&lt;/var&gt; to &lt;var&gt;tallest
-   height&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Decrement &lt;var&gt;pending rows in group&lt;/var&gt; by one.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-13&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;, if any; otherwise, let it be null.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null and &lt;var&gt;pending rows in
-   group&lt;/var&gt; is not zero, return to the step labeled &lt;i&gt;group loop&lt;/i&gt;.&lt;li&gt;&lt;p&gt;Append a new group to &lt;var&gt;groups&lt;/var&gt; consisting of the &lt;code id=table-sorting-model:the-tr-element-14&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
-   elements in &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Empty &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null, then return to the step labeled &lt;i&gt;start
-   group&lt;/i&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;ignore first group&lt;/var&gt; is true, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and set &lt;var&gt;ignore first group&lt;/var&gt; to false.&lt;li&gt;&lt;p&gt;&lt;i&gt;Drop leading header groups&lt;/i&gt;: If &lt;var&gt;groups&lt;/var&gt; is now empty, jump to the
-   step labeled &lt;i&gt;increment loop&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;If the first group of &lt;var&gt;groups&lt;/var&gt; consists of &lt;code id=table-sorting-model:the-tr-element-15&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements
-   whose element children are all &lt;code id=table-sorting-model:the-th-element-13&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; elements, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and return to the previous step (labeled &lt;i&gt;drop leading header
-   groups&lt;/i&gt;).&lt;li&gt;&lt;p&gt;Let &lt;var&gt;insertion point&lt;/var&gt; be a placeholder in a DOM tree, which can be used
-   to reinsert nodes at a specific point in the DOM. Insert &lt;var&gt;insertion point&lt;/var&gt; into
-   the parent of the first &lt;code id=table-sorting-model:the-tr-element-16&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element of the first group in &lt;var&gt;groups&lt;/var&gt;,
-   immediately before that &lt;code id=table-sorting-model:the-tr-element-17&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element.&lt;li&gt;
+         &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tbody-element-4&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element
 
-    &lt;p&gt;Sort the groups in &lt;var&gt;groups&lt;/var&gt;, using the following algorithm to decide the
-    relative order of any two groups &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; (the algorithm
-    either returns that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;, or that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;):&lt;/p&gt;
+         &lt;dd&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;key index&lt;/var&gt; be an index into &lt;var&gt;key heading
-     cells&lt;/var&gt;, initially denoting the first element in the list.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;direction&lt;/var&gt; be a sort direction, initially &lt;i&gt;ascending&lt;/i&gt;. Its
-     other possible value is &lt;i&gt;descending&lt;/i&gt;. When &lt;var&gt;direction&lt;/var&gt; is
-     &lt;i&gt;toggled&lt;/i&gt;, that means that if its value is &lt;i&gt;ascending&lt;/i&gt;, it must be changed to
-     &lt;i&gt;descending&lt;/i&gt;, and when its value is &lt;i&gt;descending&lt;/i&gt;, it must be changed to
-     &lt;i&gt;ascending&lt;/i&gt;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Column loop&lt;/i&gt;: Let &lt;var&gt;th&lt;/var&gt; be the &lt;var&gt;key index&lt;/var&gt;th
-     &lt;code id=table-sorting-model:the-th-element-14&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; in &lt;var&gt;key heading cells&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;th&lt;/var&gt;'s &lt;code id=table-sorting-model:attr-th-sorted-10&gt;&lt;a href=#attr-th-sorted&gt;sorted&lt;/a&gt;&lt;/code&gt; attribute's
-     &lt;a href=#column-sort-direction id=table-sorting-model:column-sort-direction-3&gt;column sort direction&lt;/a&gt; is &lt;i&gt;reversed&lt;/i&gt;, then toggle &lt;var&gt;direction&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;tentative order&lt;/var&gt; be the result of &lt;a href=#comparing-two-row-groups-using-the-th-element id=table-sorting-model:comparing-two-row-groups-using-the-th-element&gt;comparing two row groups
-     using the &lt;code&gt;th&lt;/code&gt; element&lt;/a&gt; &lt;var&gt;th&lt;/var&gt;, with &lt;var&gt;a&lt;/var&gt; and
-     &lt;var&gt;b&lt;/var&gt; as the rows.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tentative order&lt;/var&gt; is not &quot;equal&quot;, then jump to the step labeled
-     &lt;i&gt;return&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Increment &lt;var&gt;key index&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;key index&lt;/var&gt; still denotes a &lt;code id=table-sorting-model:the-th-element-15&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;key heading cells&lt;/var&gt;, then jump back to the step above labeled &lt;i&gt;column
-     loop&lt;/i&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;a&lt;/var&gt;'s &lt;code id=table-sorting-model:the-tr-element-18&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements precede &lt;var&gt;b&lt;/var&gt;'s in
-     &lt;a href=#tree-order id=table-sorting-model:tree-order-3&gt;tree order&lt;/a&gt;, then let &lt;var&gt;tentative order&lt;/var&gt; be &quot;a before b&quot;.
-     Otherwise, let &lt;var&gt;tentative order&lt;/var&gt; be &quot;b before a&quot;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Return&lt;/i&gt;: Return the relative order given by the matching option from the following
-     list:&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;Place all the &lt;code id=table-sorting-model:the-tr-element-8&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element children of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt; into &lt;var&gt;rows&lt;/var&gt;, in &lt;a href=#tree-order id=table-sorting-model:tree-order-2&gt;tree
+           order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;rows&lt;/var&gt; is empty, jump to the step labeled &lt;i&gt;increment loop&lt;/i&gt;
+           below.&lt;/ol&gt;
 
-      &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dl&gt;
+         &lt;/dl&gt;
 
-     &lt;/ol&gt;
+       &lt;li&gt;&lt;p&gt;&lt;i&gt;Group&lt;/i&gt;: Let &lt;var&gt;groups&lt;/var&gt; be an empty list of groups of &lt;code id=table-sorting-model:the-tr-element-9&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
+       elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group&lt;/var&gt; be an empty group of &lt;code id=table-sorting-model:the-tr-element-10&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; be a pointer to an element, initially pointing at the
+       first &lt;code id=table-sorting-model:the-tr-element-11&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;
 
-    &lt;p&gt;When the user agent is required to &lt;dfn id=comparing-two-row-groups-using-the-th-element&gt;compare two row groups using the &lt;code&gt;th&lt;/code&gt; element&lt;/dfn&gt; &lt;var&gt;th&lt;/var&gt;,
-    with &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; being the two row groups respectively, the
-    user agent must run the following steps:&lt;/p&gt;
+        &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;x&lt;/var&gt; be the &lt;var&gt;x&lt;/var&gt;-coordinate of the slots that
-     &lt;code id=table-sorting-model:the-th-element-16&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; covers in its &lt;a href=#concept-table id=table-sorting-model:concept-table-7&gt;table&lt;/a&gt;.&lt;li&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Start group&lt;/i&gt;: Let &lt;var&gt;pending rows in group&lt;/var&gt; be 1.&lt;li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-13&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-4&gt;row&lt;/a&gt; of group
-      &lt;var&gt;a&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-5&gt;row&lt;/a&gt; whose
-      &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-14&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-6&gt;row&lt;/a&gt; of group
-      &lt;var&gt;b&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-7&gt;row&lt;/a&gt; whose
-      &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Group loop&lt;/i&gt;: Append the &lt;code id=table-sorting-model:the-tr-element-12&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element pointed to by &lt;var&gt;group
+           cursor&lt;/var&gt; to &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are any &lt;a href=#concept-cell id=table-sorting-model:concept-cell-11&gt;cells&lt;/a&gt; whose highest &lt;a href=#concept-row id=table-sorting-model:concept-row-3&gt;row&lt;/a&gt;'s element is the one pointed to by &lt;var&gt;group
+           cursor&lt;/var&gt;, then let &lt;var&gt;tallest height&lt;/var&gt; be the number of rows covered by the
+           tallest such &lt;a href=#concept-cell id=table-sorting-model:concept-cell-12&gt;cell&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tallest height&lt;/var&gt; is greater than &lt;var&gt;pending rows in
+           group&lt;/var&gt; then set &lt;var&gt;pending rows in group&lt;/var&gt; to &lt;var&gt;tallest
+           height&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Decrement &lt;var&gt;pending rows in group&lt;/var&gt; by one.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-13&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;, if any; otherwise, let it be null.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null and &lt;var&gt;pending rows in
+           group&lt;/var&gt; is not zero, jump back to the step labeled &lt;i&gt;group loop&lt;/i&gt;.&lt;/ol&gt;
 
-      
+         &lt;li&gt;&lt;p&gt;Append a new group to &lt;var&gt;groups&lt;/var&gt; consisting of the &lt;code id=table-sorting-model:the-tr-element-14&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
+         elements in &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Empty &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null, then jump back to the step labeled &lt;i&gt;start
+         group&lt;/i&gt;.&lt;/ol&gt;
 
-      &lt;p&gt;In either case, if there's no &lt;a href=#concept-cell id=table-sorting-model:concept-cell-15&gt;cell&lt;/a&gt; that actually covers
-      the slot, then use the value &lt;i&gt;null&lt;/i&gt; instead.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If &lt;var&gt;ignore first group&lt;/var&gt; is true, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and set &lt;var&gt;ignore first group&lt;/var&gt; to false.&lt;li&gt;
 
-     &lt;li&gt;
+        &lt;p&gt;Run these steps:&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be
-      the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, as defined
-      below.&lt;/p&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Drop leading header groups&lt;/i&gt;: If &lt;var&gt;groups&lt;/var&gt; is now empty, jump to the
+         step labeled &lt;i&gt;increment loop&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;If the first group of &lt;var&gt;groups&lt;/var&gt; consists of &lt;code id=table-sorting-model:the-tr-element-15&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements
+         whose element children are all &lt;code id=table-sorting-model:the-th-element-13&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; elements, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and jump back to the previous step (labeled &lt;i&gt;drop leading header
+         groups&lt;/i&gt;).&lt;/ol&gt;
 
-      &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be
-      the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell-2&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, as defined
-      below.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;insertion point&lt;/var&gt; be a placeholder in a DOM tree, which can be used
+       to reinsert nodes at a specific point in the DOM. Insert &lt;var&gt;insertion point&lt;/var&gt; into
+       the parent of the first &lt;code id=table-sorting-model:the-tr-element-16&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element of the first group in &lt;var&gt;groups&lt;/var&gt;,
+       immediately before that &lt;code id=table-sorting-model:the-tr-element-17&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element.&lt;li&gt;
 
-      &lt;p&gt;The &lt;dfn id=type-and-value-of-the-cell&gt;type and value of the cell&lt;/dfn&gt; &lt;var&gt;cell&lt;/var&gt; are computed as follows.&lt;/p&gt;
+        &lt;p&gt;Sort the groups in &lt;var&gt;groups&lt;/var&gt;, using the following algorithm to decide the
+        relative order of any two groups &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; (the algorithm
+        either returns that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;, or that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;):&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var&gt;cell&lt;/var&gt; is &lt;i&gt;null&lt;/i&gt;, then the type is &quot;string&quot; and the value is
-       the empty string; abort these steps.&lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-       &lt;a href=#element id=table-sorting-model:element&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code id=table-sorting-model:the-data-element&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
-       &lt;code id=table-sorting-model:the-data-element-2&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-data-value&gt;&lt;a href=#attr-data-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
-       one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;key index&lt;/var&gt; be an index into &lt;var&gt;key heading
+         cells&lt;/var&gt;, initially denoting the first element in the list.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;direction&lt;/var&gt; be a sort direction, initially &lt;i&gt;ascending&lt;/i&gt;. Its
+         other possible value is &lt;i&gt;descending&lt;/i&gt;. When &lt;var&gt;direction&lt;/var&gt; is
+         &lt;i&gt;toggled&lt;/i&gt;, that means that if its value is &lt;i&gt;ascending&lt;/i&gt;, it must be changed to
+         &lt;i&gt;descending&lt;/i&gt;, and when its value is &lt;i&gt;descending&lt;/i&gt;, it must be changed to
+         &lt;i&gt;ascending&lt;/i&gt;.&lt;li&gt;
 
-       &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-2&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-       &lt;a href=#element id=table-sorting-model:element-2&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-2&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code id=table-sorting-model:the-progress-element&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
-       &lt;code id=table-sorting-model:the-progress-element-2&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-progress-value&gt;&lt;a href=#attr-progress-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
-       there is one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-3&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-       &lt;a href=#element id=table-sorting-model:element-3&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-3&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code id=table-sorting-model:the-meter-element&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
-       &lt;code id=table-sorting-model:the-meter-element-2&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-meter-value&gt;&lt;a href=#attr-meter-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
-       one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Column loop&lt;/i&gt;: Let &lt;var&gt;th&lt;/var&gt; be the &lt;var&gt;key index&lt;/var&gt;th
+           &lt;code id=table-sorting-model:the-th-element-14&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; in &lt;var&gt;key heading cells&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;th&lt;/var&gt;'s &lt;code id=table-sorting-model:attr-th-sorted-10&gt;&lt;a href=#attr-th-sorted&gt;sorted&lt;/a&gt;&lt;/code&gt; attribute's
+           &lt;a href=#column-sort-direction id=table-sorting-model:column-sort-direction-3&gt;column sort direction&lt;/a&gt; is &lt;i&gt;reversed&lt;/i&gt;, then toggle &lt;var&gt;direction&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;tentative order&lt;/var&gt; be the result of &lt;a href=#comparing-two-row-groups-using-the-th-element id=table-sorting-model:comparing-two-row-groups-using-the-th-element&gt;comparing two row groups
+           using the &lt;code&gt;th&lt;/code&gt; element&lt;/a&gt; &lt;var&gt;th&lt;/var&gt;, with &lt;var&gt;a&lt;/var&gt; and
+           &lt;var&gt;b&lt;/var&gt; as the rows.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tentative order&lt;/var&gt; is not &quot;equal&quot;, then jump to the step labeled
+           &lt;i&gt;return&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Increment &lt;var&gt;key index&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;key index&lt;/var&gt; still denotes a &lt;code id=table-sorting-model:the-th-element-15&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;key heading cells&lt;/var&gt;, then jump back to the step above labeled &lt;i&gt;column
+           loop&lt;/i&gt;.&lt;/ol&gt;
 
-       &lt;li&gt;
+         &lt;li&gt;&lt;p&gt;If &lt;var&gt;a&lt;/var&gt;'s &lt;code id=table-sorting-model:the-tr-element-18&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements precede &lt;var&gt;b&lt;/var&gt;'s in
+         &lt;a href=#tree-order id=table-sorting-model:tree-order-3&gt;tree order&lt;/a&gt;, then let &lt;var&gt;tentative order&lt;/var&gt; be &quot;a before b&quot;.
+         Otherwise, let &lt;var&gt;tentative order&lt;/var&gt; be &quot;b before a&quot;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Return&lt;/i&gt;: Return the relative order given by the matching option from the following
+         list:&lt;/p&gt;
 
-        &lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-4&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-        &lt;a href=#element id=table-sorting-model:element-4&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-4&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one
-        child and that child is a &lt;code id=table-sorting-model:the-time-element&gt;&lt;a href=#the-time-element&gt;time&lt;/a&gt;&lt;/code&gt; element, then the value is the
-        &lt;a href=&quot;#machine-readable-equivalent-of-the-element's-contents&quot; id=&quot;table-sorting-model:machine-readable-equivalent-of-the-element's-contents&quot;&gt;machine-readable equivalent of the element's contents&lt;/a&gt;, if any, and the type is
-        the kind of value that is thus obtained
-       (a &lt;a href=#concept-month id=table-sorting-model:concept-month&gt;month&lt;/a&gt;,
-        a &lt;a href=#concept-date id=table-sorting-model:concept-date&gt;date&lt;/a&gt;,
-        a &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date&gt;yearless date&lt;/a&gt;,
-        a &lt;a href=#concept-time id=table-sorting-model:concept-time&gt;time&lt;/a&gt;,
-        a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local&gt;local date and time&lt;/a&gt;,
-        a &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone&gt;time-zone offset&lt;/a&gt;,
-        a &lt;a href=#concept-datetime id=table-sorting-model:concept-datetime&gt;global date and time&lt;/a&gt;,
-        a &lt;a href=#concept-week id=table-sorting-model:concept-week&gt;week&lt;/a&gt;,
-        a year, or
-        a &lt;a href=#concept-duration id=table-sorting-model:concept-duration&gt;duration&lt;/a&gt;);
-        abort these steps after completing this one.&lt;/p&gt;
+          &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dl&gt;
 
-        &lt;p&gt;If there is no machine-readable equivalent, then the type is &quot;string&quot; and the value is
-        the empty string.&lt;/p&gt;
+         &lt;/ol&gt;
 
-        &lt;p&gt;If the type is
-        a &lt;a href=#concept-month id=table-sorting-model:concept-month-2&gt;month&lt;/a&gt;,
-        a &lt;a href=#concept-date id=table-sorting-model:concept-date-2&gt;date&lt;/a&gt;,
-        a &lt;a href=#concept-week id=table-sorting-model:concept-week-2&gt;week&lt;/a&gt;, or
-        a year,
-        then change the value to be the instant in time (with no time zone) that describes the
-        earliest moment that the value represents, and change the type to be
-        a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-2&gt;local date and time&lt;/a&gt;.&lt;/p&gt;
+        &lt;p&gt;When the user agent is required to &lt;dfn id=comparing-two-row-groups-using-the-th-element&gt;compare two row groups using the &lt;code&gt;th&lt;/code&gt; element&lt;/dfn&gt; &lt;var&gt;th&lt;/var&gt;,
+        with &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; being the two row groups respectively, the
+        user agent must run the following steps:&lt;/p&gt;
 
-        &lt;p class=example&gt;For example, if the cell was &lt;code&gt;&lt;td&gt;&lt;time&gt;2011-11&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is
-        interpreted as &quot;2011-11-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-3&gt;local date and time&lt;/a&gt; rather than a &lt;a href=#concept-month id=table-sorting-model:concept-month-3&gt;month&lt;/a&gt;.&lt;/p&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;x&lt;/var&gt; be the &lt;var&gt;x&lt;/var&gt;-coordinate of the slots that
+         &lt;code id=table-sorting-model:the-th-element-16&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; covers in its &lt;a href=#concept-table id=table-sorting-model:concept-table-7&gt;table&lt;/a&gt;.&lt;li&gt;
 
-        &lt;p class=example&gt;Similarly, if the cell was &lt;code&gt;&lt;td&gt;&lt;time
-        datetime=&quot;2014&quot;&gt;MMXIV&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is interpreted as
-        &quot;2014-01-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-4&gt;local date and time&lt;/a&gt; rather than a year.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-13&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-4&gt;row&lt;/a&gt; of group
+          &lt;var&gt;a&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-5&gt;row&lt;/a&gt; whose
+          &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;The value is the element's &lt;code id=table-sorting-model:textcontent&gt;&lt;a href=#textcontent&gt;textContent&lt;/a&gt;&lt;/code&gt;. The type is &quot;string&quot;.&lt;/ol&gt;
+          &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-14&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-6&gt;row&lt;/a&gt; of group
+          &lt;var&gt;b&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-7&gt;row&lt;/a&gt; whose
+          &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+          
 
-      &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
-      equal, then: return &quot;a before b&quot; if &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier in the
-      following list than &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, otherwise, return &quot;b before a&quot;;
-      then, abort these steps.&lt;/p&gt;
+          &lt;p&gt;In either case, if there's no &lt;a href=#concept-cell id=table-sorting-model:concept-cell-15&gt;cell&lt;/a&gt; that actually covers
+          the slot, then use the value &lt;i&gt;null&lt;/i&gt; instead.&lt;/p&gt;
 
-      &lt;ol class=brief&gt;&lt;li&gt;&lt;a href=#concept-time id=table-sorting-model:concept-time-2&gt;time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-2&gt;yearless date&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-5&gt;local date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime id=table-sorting-model:concept-datetime-2&gt;global date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-2&gt;time-zone offset&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-duration id=table-sorting-model:concept-duration-2&gt;duration&lt;/a&gt;&lt;li&gt;&quot;string&quot;&lt;/ol&gt;
+         &lt;li&gt;
 
-     &lt;li&gt;&lt;p&gt;If &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are
-     equal, then return &quot;equal&quot; and abort these steps.&lt;li&gt;
+          &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be
+          the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, as defined
+          below.&lt;/p&gt;
 
-      &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
-      &quot;string&quot;, then: if &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier than &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; then return &quot;a before b&quot; and abort these steps, otherwise,
-      return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be
+          the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell-2&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, as defined
+          below.&lt;/p&gt;
 
-      &lt;p&gt;Values sort in their natural order, with the following additional constraints:&lt;/p&gt;
+          &lt;p&gt;The &lt;dfn id=type-and-value-of-the-cell&gt;type and value of the cell&lt;/dfn&gt; &lt;var&gt;cell&lt;/var&gt; are computed as follows.&lt;/p&gt;
 
-      &lt;p&gt;For &lt;a href=#concept-time id=table-sorting-model:concept-time-3&gt;time&lt;/a&gt; values, 00:00:00.000 is the earliest value and
-      23:59:59.999 is the latest value.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var&gt;cell&lt;/var&gt; is &lt;i&gt;null&lt;/i&gt;, then the type is &quot;string&quot; and the value is
+           the empty string; abort these steps.&lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+           &lt;a href=#element id=table-sorting-model:element&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code id=table-sorting-model:the-data-element&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
+           &lt;code id=table-sorting-model:the-data-element-2&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-data-value&gt;&lt;a href=#attr-data-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
+           one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-      &lt;p&gt;For &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-3&gt;yearless date&lt;/a&gt; values, 01-01 is the earliest
-      value and 12-31 is the latest value; 02-28 is earlier than 02-29 which is earlier than
-      03-01.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-2&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+           &lt;a href=#element id=table-sorting-model:element-2&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-2&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code id=table-sorting-model:the-progress-element&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
+           &lt;code id=table-sorting-model:the-progress-element-2&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-progress-value&gt;&lt;a href=#attr-progress-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
+           there is one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-      &lt;p&gt;Values that are &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-6&gt;local date and time&lt;/a&gt; compare as
-      if they were in the same time zone.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-3&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+           &lt;a href=#element id=table-sorting-model:element-3&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-3&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code id=table-sorting-model:the-meter-element&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
+           &lt;code id=table-sorting-model:the-meter-element-2&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-meter-value&gt;&lt;a href=#attr-meter-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
+           one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-      
+           &lt;li&gt;
 
-      &lt;p&gt;For &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-3&gt;time-zone offset&lt;/a&gt; values, -23:59 is the earliest
-      value and +23:59 is the latest value.&lt;/p&gt;
+            &lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-4&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+            &lt;a href=#element id=table-sorting-model:element-4&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-4&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one
+            child and that child is a &lt;code id=table-sorting-model:the-time-element&gt;&lt;a href=#the-time-element&gt;time&lt;/a&gt;&lt;/code&gt; element, then the value is the
+            &lt;a href=&quot;#machine-readable-equivalent-of-the-element's-contents&quot; id=&quot;table-sorting-model:machine-readable-equivalent-of-the-element's-contents&quot;&gt;machine-readable equivalent of the element's contents&lt;/a&gt;, if any, and the type is
+            the kind of value that is thus obtained
+           (a &lt;a href=#concept-month id=table-sorting-model:concept-month&gt;month&lt;/a&gt;,
+            a &lt;a href=#concept-date id=table-sorting-model:concept-date&gt;date&lt;/a&gt;,
+            a &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date&gt;yearless date&lt;/a&gt;,
+            a &lt;a href=#concept-time id=table-sorting-model:concept-time&gt;time&lt;/a&gt;,
+            a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local&gt;local date and time&lt;/a&gt;,
+            a &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone&gt;time-zone offset&lt;/a&gt;,
+            a &lt;a href=#concept-datetime id=table-sorting-model:concept-datetime&gt;global date and time&lt;/a&gt;,
+            a &lt;a href=#concept-week id=table-sorting-model:concept-week&gt;week&lt;/a&gt;,
+            a year, or
+            a &lt;a href=#concept-duration id=table-sorting-model:concept-duration&gt;duration&lt;/a&gt;);
+            abort these steps after completing this one.&lt;/p&gt;
 
-      
+            &lt;p&gt;If there is no machine-readable equivalent, then the type is &quot;string&quot; and the value is
+            the empty string.&lt;/p&gt;
 
-     &lt;li&gt;
+            &lt;p&gt;If the type is
+            a &lt;a href=#concept-month id=table-sorting-model:concept-month-2&gt;month&lt;/a&gt;,
+            a &lt;a href=#concept-date id=table-sorting-model:concept-date-2&gt;date&lt;/a&gt;,
+            a &lt;a href=#concept-week id=table-sorting-model:concept-week-2&gt;week&lt;/a&gt;, or
+            a year,
+            then change the value to be the instant in time (with no time zone) that describes the
+            earliest moment that the value represents, and change the type to be
+            a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-2&gt;local date and time&lt;/a&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key&gt;parsing the sort
-      key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
+            &lt;p class=example&gt;For example, if the cell was &lt;code&gt;&lt;td&gt;&lt;time&gt;2011-11&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is
+            interpreted as &quot;2011-11-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-3&gt;local date and time&lt;/a&gt; rather than a &lt;a href=#concept-month id=table-sorting-model:concept-month-3&gt;month&lt;/a&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key-2&gt;parsing the sort
-      key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
+            &lt;p class=example&gt;Similarly, if the cell was &lt;code&gt;&lt;td&gt;&lt;time
+            datetime=&quot;2014&quot;&gt;MMXIV&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is interpreted as
+            &quot;2014-01-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-4&gt;local date and time&lt;/a&gt; rather than a year.&lt;/p&gt;
 
-      &lt;p&gt;As described below, &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are tuples consisting of a list of &lt;var&gt;n&lt;/var&gt;
-      &lt;i&gt;numbers&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt; &lt;i&gt;number strings&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;non-numeric strings&lt;/i&gt;, and a list of 2&lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;raw
-      strings&lt;/i&gt;, for any non-negative integer value of &lt;var&gt;n&lt;/var&gt; (zero or more).&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;The value is the element's &lt;code id=table-sorting-model:textcontent&gt;&lt;a href=#textcontent&gt;textContent&lt;/a&gt;&lt;/code&gt;. The type is &quot;string&quot;.&lt;/ol&gt;
 
-     &lt;li&gt;
+         &lt;li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison&gt;locale-specific string
-      comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric
-      string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric string&lt;/i&gt;,
-      in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+          &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
+          equal, then: return &quot;a before b&quot; if &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier in the
+          following list than &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, otherwise, return &quot;b before a&quot;;
+          then, abort these steps.&lt;/p&gt;
 
-      &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
-      these steps.&lt;/p&gt;
+          &lt;ol class=brief&gt;&lt;li&gt;&lt;a href=#concept-time id=table-sorting-model:concept-time-2&gt;time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-2&gt;yearless date&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-5&gt;local date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime id=table-sorting-model:concept-datetime-2&gt;global date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-2&gt;time-zone offset&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-duration id=table-sorting-model:concept-duration-2&gt;duration&lt;/a&gt;&lt;li&gt;&quot;string&quot;&lt;/ol&gt;
 
-     &lt;li&gt;
+         &lt;li&gt;&lt;p&gt;If &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are
+         equal, then return &quot;equal&quot; and abort these steps.&lt;li&gt;
 
-      &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; both have exactly one &lt;i&gt;number&lt;/i&gt;, then run these
-      substeps:&lt;/p&gt;
+          &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
+          &quot;string&quot;, then: if &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier than &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; then return &quot;a before b&quot; and abort these steps, otherwise,
+          return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;
+          &lt;p&gt;Values sort in their natural order, with the following additional constraints:&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;a before b&quot;.&lt;/p&gt;
+          &lt;p&gt;For &lt;a href=#concept-time id=table-sorting-model:concept-time-3&gt;time&lt;/a&gt; values, 00:00:00.000 is the earliest value and
+          23:59:59.999 is the latest value.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;.&lt;/p&gt;
+          &lt;p&gt;For &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-3&gt;yearless date&lt;/a&gt; values, 01-01 is the earliest
+          value and 12-31 is the latest value; 02-28 is earlier than 02-29 which is earlier than
+          03-01.&lt;/p&gt;
 
-       &lt;li&gt;
+          &lt;p&gt;Values that are &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-6&gt;local date and time&lt;/a&gt; compare as
+          if they were in the same time zone.&lt;/p&gt;
 
-        &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-2&gt;locale-specific string
-        comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
-        string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
-        string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+          
 
-        &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-        abort these steps.&lt;/p&gt;
+          &lt;p&gt;For &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-3&gt;time-zone offset&lt;/a&gt; values, -23:59 is the earliest
+          value and +23:59 is the latest value.&lt;/p&gt;
 
-       &lt;li&gt;
+          
 
-        &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-3&gt;locale-specific string
-        comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt; and
-        &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+         &lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-        abort these steps.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key&gt;parsing the sort
+          key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;/ol&gt;
+          &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key-2&gt;parsing the sort
+          key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Otherwise, run these substeps:&lt;/p&gt;
+          &lt;p&gt;As described below, &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are tuples consisting of a list of &lt;var&gt;n&lt;/var&gt;
+          &lt;i&gt;numbers&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt; &lt;i&gt;number strings&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;non-numeric strings&lt;/i&gt;, and a list of 2&lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;raw
+          strings&lt;/i&gt;, for any non-negative integer value of &lt;var&gt;n&lt;/var&gt; (zero or more).&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;
+         &lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;a before
-        b&quot;.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison&gt;locale-specific string
+          comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric
+          string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric string&lt;/i&gt;,
+          in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;b before
-        a&quot;.&lt;/p&gt;
+          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
+          these steps.&lt;/p&gt;
 
-       &lt;li&gt;
+         &lt;li&gt;
 
-        
+          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; both have exactly one &lt;i&gt;number&lt;/i&gt;, then run these
+          substeps:&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;a before
-        b&quot;.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;b before
-        a&quot;.&lt;/p&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;a before b&quot;.&lt;/p&gt;
 
-       &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;.&lt;/p&gt;
 
-        
+           &lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; have more than one &lt;i&gt;number&lt;/i&gt;, run these substeps:&lt;/p&gt;
+            &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-2&gt;locale-specific string
+            comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
+            string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
+            string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;count&lt;/var&gt; be the smaller of the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;li&gt;&lt;p&gt;For each &lt;i&gt;number&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; from the first to the &lt;var&gt;count&lt;/var&gt;th, in
-         order: if &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, then return &quot;a before b&quot; and abort
-         these steps; otherwise, if &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is
-         less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;
-         and abort these steps.&lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+            abort these steps.&lt;/p&gt;
 
-          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return &quot;a before b&quot; and abort these steps.&lt;/p&gt;
+           &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+            &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-3&gt;locale-specific string
+            comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt; and
+            &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+            abort these steps.&lt;/p&gt;
 
-          &lt;p&gt;&lt;i&gt;String loop&lt;/i&gt;: Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-4&gt;locale-specific
-          string comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt;,
-          in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+           &lt;/ol&gt;
 
-          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-          abort these steps.&lt;/p&gt;
+          &lt;p&gt;Otherwise, run these substeps:&lt;/p&gt;
 
-         &lt;li&gt;
+          &lt;ol&gt;&lt;li&gt;
 
-          &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;a before
+            b&quot;.&lt;/p&gt;
 
-         &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;b before
+            a&quot;.&lt;/p&gt;
 
-          &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-5&gt;locale-specific string
-          comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator
-          string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-          abort these steps.&lt;/p&gt;
+            
 
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;a before
+            b&quot;.&lt;/p&gt;
+
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;b before
+            a&quot;.&lt;/p&gt;
+
+           &lt;li&gt;
+
+            
+
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; have more than one &lt;i&gt;number&lt;/i&gt;, run these substeps:&lt;/p&gt;
+
+            &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;count&lt;/var&gt; be the smaller of the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;li&gt;&lt;p&gt;For each &lt;i&gt;number&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; from the first to the &lt;var&gt;count&lt;/var&gt;th, in
+             order: if &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, then return &quot;a before b&quot; and abort
+             these steps; otherwise, if &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is
+             less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;
+             and abort these steps.&lt;li&gt;
+
+              &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return &quot;a before b&quot; and abort these steps.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+
+             &lt;li&gt;&lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;li&gt;
+
+              &lt;p&gt;&lt;i&gt;String loop&lt;/i&gt;: Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-4&gt;locale-specific
+              string comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt;,
+              in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+              abort these steps.&lt;/p&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-5&gt;locale-specific string
+              comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator
+              string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+              abort these steps.&lt;/p&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, jump back
+              to the step labeled &lt;i&gt;string loop&lt;/i&gt;.&lt;/p&gt;
+
+             &lt;/ol&gt;
+
+           &lt;/ol&gt;
+
          &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return
-          to the step labeled &lt;i&gt;string loop&lt;/i&gt;.&lt;/p&gt;
+          
 
-         &lt;/ol&gt;
+          &lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;
 
-       &lt;/ol&gt;
+         &lt;li&gt;
 
-     &lt;li&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-      
+          &lt;ol&gt;&lt;li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;
+            &lt;p&gt;&lt;i&gt;Final loop:&lt;/i&gt; Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#raw-string-comparison id=table-sorting-model:raw-string-comparison&gt;raw string
+            comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
+            &lt;i&gt;raw string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
+            &lt;i&gt;raw string&lt;/i&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
+            these steps.&lt;/p&gt;
 
-      &lt;p&gt;&lt;i&gt;Final loop:&lt;/i&gt; Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#raw-string-comparison id=table-sorting-model:raw-string-comparison&gt;raw string
-      comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
-      &lt;i&gt;raw string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
-      &lt;i&gt;raw string&lt;/i&gt;.&lt;/p&gt;
+           &lt;li&gt;
 
-      &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
-      these steps.&lt;/p&gt;
+            &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+           &lt;li&gt;
 
-      &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+            &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;raw strings&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, jump back
+            to the step labeled &lt;i&gt;final loop&lt;/i&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+           &lt;/ol&gt;
 
-      &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;raw strings&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return
-      to the step labeled &lt;i&gt;final loop&lt;/i&gt;.&lt;/p&gt;
+         &lt;li&gt;
 
-     &lt;li&gt;
+          &lt;p&gt;Return &quot;equal&quot;.&lt;/p&gt;
 
-      &lt;p&gt;Return &quot;equal&quot;.&lt;/p&gt;
+         &lt;/ol&gt;
 
-     &lt;/ol&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;new order&lt;/var&gt; be a list of &lt;code id=table-sorting-model:the-tr-element-19&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements consisting of the
+       &lt;code id=table-sorting-model:the-tr-element-20&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements of all the groups in the newly ordered &lt;var&gt;groups&lt;/var&gt;, with
+       the &lt;code id=table-sorting-model:the-tr-element-21&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements being in the same order as the groups to which they belong are in
+       &lt;var&gt;groups&lt;/var&gt;, and the &lt;code id=table-sorting-model:the-tr-element-22&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements within each such group themselves
+       being ordered in &lt;a href=#tree-order id=table-sorting-model:tree-order-4&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-remove id=table-sorting-model:concept-node-remove&gt;Remove&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-23&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; from their parents, in &lt;a href=#tree-order id=table-sorting-model:tree-order-5&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-insert id=table-sorting-model:concept-node-insert&gt;Insert&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-24&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; into the DOM at the location of &lt;var&gt;insertion point&lt;/var&gt;, in
+       the order these elements are found in &lt;var&gt;new order&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Remove &lt;var&gt;insertion point&lt;/var&gt; from the DOM.&lt;/ol&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;new order&lt;/var&gt; be a list of &lt;code id=table-sorting-model:the-tr-element-19&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements consisting of the
-   &lt;code id=table-sorting-model:the-tr-element-20&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements of all the groups in the newly ordered &lt;var&gt;groups&lt;/var&gt;, with
-   the &lt;code id=table-sorting-model:the-tr-element-21&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements being in the same order as the groups to which they belong are in
-   &lt;var&gt;groups&lt;/var&gt;, and the &lt;code id=table-sorting-model:the-tr-element-22&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements within each such group themselves
-   being ordered in &lt;a href=#tree-order id=table-sorting-model:tree-order-4&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-remove id=table-sorting-model:concept-node-remove&gt;Remove&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-23&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; from their parents, in &lt;a href=#tree-order id=table-sorting-model:tree-order-5&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-insert id=table-sorting-model:concept-node-insert&gt;Insert&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-24&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; into the DOM at the location of &lt;var&gt;insertion point&lt;/var&gt;, in
-   the order these elements are found in &lt;var&gt;new order&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Remove &lt;var&gt;insertion point&lt;/var&gt; from the DOM.&lt;li&gt;&lt;p&gt;&lt;i&gt;Increment loop&lt;/i&gt;: If there are no &lt;code id=table-sorting-model:the-tr-element-25&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-5&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of
-   &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
-   collection cursor&lt;/var&gt;, then jump to the step labeled &lt;i&gt;end&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-26&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or
-   &lt;code id=table-sorting-model:the-tbody-element-6&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; child of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element
-   pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;row loop&lt;/i&gt; above.&lt;li&gt;&lt;p&gt;&lt;i&gt;End&lt;/i&gt;: Set &lt;var&gt;table&lt;/var&gt;'s &lt;a href=#currently-sorting-flag id=table-sorting-model:currently-sorting-flag-3&gt;currently-sorting flag&lt;/a&gt; to
+     &lt;li&gt;&lt;p&gt;&lt;i&gt;Increment loop&lt;/i&gt;: If there are no &lt;code id=table-sorting-model:the-tr-element-25&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-5&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of
+     &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
+     collection cursor&lt;/var&gt;, then jump to the step labeled &lt;i&gt;end&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-26&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or
+     &lt;code id=table-sorting-model:the-tbody-element-6&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; child of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element
+     pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Jump back to the step labeled &lt;i&gt;row loop&lt;/i&gt; above.&lt;/ol&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;i&gt;End&lt;/i&gt;: Set &lt;var&gt;table&lt;/var&gt;'s &lt;a href=#currently-sorting-flag id=table-sorting-model:currently-sorting-flag-3&gt;currently-sorting flag&lt;/a&gt; to
    false.&lt;/ol&gt;
 
   &lt;p&gt;When a user agent is to &lt;dfn id=parsing-the-sort-key&gt;parse the sort key&lt;/dfn&gt; &lt;var&gt;value&lt;/var&gt;, it must run the following steps. These return a tuple consisting of a list

Modified: index
===================================================================
--- index	2014-09-17 22:43:04 UTC (rev 8783)
+++ index	2014-09-17 22:58:28 UTC (rev 8784)
@@ -29719,365 +29719,407 @@
 
    &lt;li&gt;&lt;p&gt;If &lt;var&gt;table&lt;/var&gt; has no &lt;a href=#concept-row-group id=table-sorting-model:concept-row-group-4&gt;row group&lt;/a&gt;
    corresponding to a &lt;code id=table-sorting-model:the-thead-element-9&gt;&lt;a href=#the-thead-element&gt;thead&lt;/a&gt;&lt;/code&gt; element, then set &lt;var&gt;ignore first group&lt;/var&gt; to
-   true. Otherwise, set it to false.&lt;li&gt;&lt;p&gt;&lt;i&gt;Row loop&lt;/i&gt;: Let &lt;var&gt;rows&lt;/var&gt; be an empty list of &lt;code id=table-sorting-model:the-tr-element-4&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
-   elements.&lt;li&gt;
+   true. Otherwise, set it to false.&lt;li&gt;
 
-    &lt;p&gt;Run the appropriate steps from the following list:&lt;/p&gt;
+    &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tr-element-5&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Row loop&lt;/i&gt;: Let &lt;var&gt;rows&lt;/var&gt; be an empty list of &lt;code id=table-sorting-model:the-tr-element-4&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
+     elements.&lt;li&gt;
 
-     &lt;dd&gt;
+      &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Collect&lt;/i&gt;: Append the element pointed to by &lt;var&gt;row collection
-       cursor&lt;/var&gt; to &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are no &lt;code id=table-sorting-model:the-tr-element-6&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-2&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
-       collection cursor&lt;/var&gt;, or if the next such child is a &lt;code id=table-sorting-model:the-tbody-element-3&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element, then jump
-       to the step labeled &lt;i&gt;group&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-7&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; child
-       of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;collect&lt;/i&gt; above.&lt;/ol&gt;
+      &lt;ol&gt;&lt;li&gt;
 
-     &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tbody-element-4&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element
+        &lt;p&gt;Run the appropriate steps from the following list:&lt;/p&gt;
 
-     &lt;dd&gt;
+        &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tr-element-5&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element
 
-      &lt;ol&gt;&lt;li&gt;&lt;p&gt;Place all the &lt;code id=table-sorting-model:the-tr-element-8&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element children of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt; into &lt;var&gt;rows&lt;/var&gt;, in &lt;a href=#tree-order id=table-sorting-model:tree-order-2&gt;tree
-       order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;rows&lt;/var&gt; is empty, jump to the step labeled &lt;i&gt;increment loop&lt;/i&gt;
-       below.&lt;/ol&gt;
+         &lt;dd&gt;
 
-     &lt;/dl&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Collect&lt;/i&gt;: Append the element pointed to by &lt;var&gt;row collection
+           cursor&lt;/var&gt; to &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are no &lt;code id=table-sorting-model:the-tr-element-6&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-2&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
+           collection cursor&lt;/var&gt;, or if the next such child is a &lt;code id=table-sorting-model:the-tbody-element-3&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element, then jump
+           to the step labeled &lt;i&gt;group&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-7&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; child
+           of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Jump back to the step labeled &lt;i&gt;collect&lt;/i&gt; above.&lt;/ol&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Group&lt;/i&gt;: Let &lt;var&gt;groups&lt;/var&gt; be an empty list of groups of &lt;code id=table-sorting-model:the-tr-element-9&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
-   elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group&lt;/var&gt; be an empty group of &lt;code id=table-sorting-model:the-tr-element-10&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; be a pointer to an element, initially pointing at the
-   first &lt;code id=table-sorting-model:the-tr-element-11&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Start group&lt;/i&gt;: Let &lt;var&gt;pending rows in group&lt;/var&gt; be 1.&lt;li&gt;&lt;p&gt;&lt;i&gt;Group loop&lt;/i&gt;: Append the &lt;code id=table-sorting-model:the-tr-element-12&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element pointed to by &lt;var&gt;group
-   cursor&lt;/var&gt; to &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are any &lt;a href=#concept-cell id=table-sorting-model:concept-cell-11&gt;cells&lt;/a&gt; whose highest &lt;a href=#concept-row id=table-sorting-model:concept-row-3&gt;row&lt;/a&gt;'s element is the one pointed to by &lt;var&gt;group
-   cursor&lt;/var&gt;, then let &lt;var&gt;tallest height&lt;/var&gt; be the number of rows covered by the
-   tallest such &lt;a href=#concept-cell id=table-sorting-model:concept-cell-12&gt;cell&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tallest height&lt;/var&gt; is greater than &lt;var&gt;pending rows in
-   group&lt;/var&gt; then set &lt;var&gt;pending rows in group&lt;/var&gt; to &lt;var&gt;tallest
-   height&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Decrement &lt;var&gt;pending rows in group&lt;/var&gt; by one.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-13&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;, if any; otherwise, let it be null.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null and &lt;var&gt;pending rows in
-   group&lt;/var&gt; is not zero, return to the step labeled &lt;i&gt;group loop&lt;/i&gt;.&lt;li&gt;&lt;p&gt;Append a new group to &lt;var&gt;groups&lt;/var&gt; consisting of the &lt;code id=table-sorting-model:the-tr-element-14&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
-   elements in &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Empty &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null, then return to the step labeled &lt;i&gt;start
-   group&lt;/i&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;ignore first group&lt;/var&gt; is true, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and set &lt;var&gt;ignore first group&lt;/var&gt; to false.&lt;li&gt;&lt;p&gt;&lt;i&gt;Drop leading header groups&lt;/i&gt;: If &lt;var&gt;groups&lt;/var&gt; is now empty, jump to the
-   step labeled &lt;i&gt;increment loop&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;If the first group of &lt;var&gt;groups&lt;/var&gt; consists of &lt;code id=table-sorting-model:the-tr-element-15&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements
-   whose element children are all &lt;code id=table-sorting-model:the-th-element-13&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; elements, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and return to the previous step (labeled &lt;i&gt;drop leading header
-   groups&lt;/i&gt;).&lt;li&gt;&lt;p&gt;Let &lt;var&gt;insertion point&lt;/var&gt; be a placeholder in a DOM tree, which can be used
-   to reinsert nodes at a specific point in the DOM. Insert &lt;var&gt;insertion point&lt;/var&gt; into
-   the parent of the first &lt;code id=table-sorting-model:the-tr-element-16&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element of the first group in &lt;var&gt;groups&lt;/var&gt;,
-   immediately before that &lt;code id=table-sorting-model:the-tr-element-17&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element.&lt;li&gt;
+         &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code id=table-sorting-model:the-tbody-element-4&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; element
 
-    &lt;p&gt;Sort the groups in &lt;var&gt;groups&lt;/var&gt;, using the following algorithm to decide the
-    relative order of any two groups &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; (the algorithm
-    either returns that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;, or that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;):&lt;/p&gt;
+         &lt;dd&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;key index&lt;/var&gt; be an index into &lt;var&gt;key heading
-     cells&lt;/var&gt;, initially denoting the first element in the list.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;direction&lt;/var&gt; be a sort direction, initially &lt;i&gt;ascending&lt;/i&gt;. Its
-     other possible value is &lt;i&gt;descending&lt;/i&gt;. When &lt;var&gt;direction&lt;/var&gt; is
-     &lt;i&gt;toggled&lt;/i&gt;, that means that if its value is &lt;i&gt;ascending&lt;/i&gt;, it must be changed to
-     &lt;i&gt;descending&lt;/i&gt;, and when its value is &lt;i&gt;descending&lt;/i&gt;, it must be changed to
-     &lt;i&gt;ascending&lt;/i&gt;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Column loop&lt;/i&gt;: Let &lt;var&gt;th&lt;/var&gt; be the &lt;var&gt;key index&lt;/var&gt;th
-     &lt;code id=table-sorting-model:the-th-element-14&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; in &lt;var&gt;key heading cells&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;th&lt;/var&gt;'s &lt;code id=table-sorting-model:attr-th-sorted-10&gt;&lt;a href=#attr-th-sorted&gt;sorted&lt;/a&gt;&lt;/code&gt; attribute's
-     &lt;a href=#column-sort-direction id=table-sorting-model:column-sort-direction-3&gt;column sort direction&lt;/a&gt; is &lt;i&gt;reversed&lt;/i&gt;, then toggle &lt;var&gt;direction&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;tentative order&lt;/var&gt; be the result of &lt;a href=#comparing-two-row-groups-using-the-th-element id=table-sorting-model:comparing-two-row-groups-using-the-th-element&gt;comparing two row groups
-     using the &lt;code&gt;th&lt;/code&gt; element&lt;/a&gt; &lt;var&gt;th&lt;/var&gt;, with &lt;var&gt;a&lt;/var&gt; and
-     &lt;var&gt;b&lt;/var&gt; as the rows.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tentative order&lt;/var&gt; is not &quot;equal&quot;, then jump to the step labeled
-     &lt;i&gt;return&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Increment &lt;var&gt;key index&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;key index&lt;/var&gt; still denotes a &lt;code id=table-sorting-model:the-th-element-15&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;key heading cells&lt;/var&gt;, then jump back to the step above labeled &lt;i&gt;column
-     loop&lt;/i&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;a&lt;/var&gt;'s &lt;code id=table-sorting-model:the-tr-element-18&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements precede &lt;var&gt;b&lt;/var&gt;'s in
-     &lt;a href=#tree-order id=table-sorting-model:tree-order-3&gt;tree order&lt;/a&gt;, then let &lt;var&gt;tentative order&lt;/var&gt; be &quot;a before b&quot;.
-     Otherwise, let &lt;var&gt;tentative order&lt;/var&gt; be &quot;b before a&quot;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Return&lt;/i&gt;: Return the relative order given by the matching option from the following
-     list:&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;Place all the &lt;code id=table-sorting-model:the-tr-element-8&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element children of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt; into &lt;var&gt;rows&lt;/var&gt;, in &lt;a href=#tree-order id=table-sorting-model:tree-order-2&gt;tree
+           order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;rows&lt;/var&gt; is empty, jump to the step labeled &lt;i&gt;increment loop&lt;/i&gt;
+           below.&lt;/ol&gt;
 
-      &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dl&gt;
+         &lt;/dl&gt;
 
-     &lt;/ol&gt;
+       &lt;li&gt;&lt;p&gt;&lt;i&gt;Group&lt;/i&gt;: Let &lt;var&gt;groups&lt;/var&gt; be an empty list of groups of &lt;code id=table-sorting-model:the-tr-element-9&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
+       elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group&lt;/var&gt; be an empty group of &lt;code id=table-sorting-model:the-tr-element-10&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; be a pointer to an element, initially pointing at the
+       first &lt;code id=table-sorting-model:the-tr-element-11&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;.&lt;li&gt;
 
-    &lt;p&gt;When the user agent is required to &lt;dfn id=comparing-two-row-groups-using-the-th-element&gt;compare two row groups using the &lt;code&gt;th&lt;/code&gt; element&lt;/dfn&gt; &lt;var&gt;th&lt;/var&gt;,
-    with &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; being the two row groups respectively, the
-    user agent must run the following steps:&lt;/p&gt;
+        &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;x&lt;/var&gt; be the &lt;var&gt;x&lt;/var&gt;-coordinate of the slots that
-     &lt;code id=table-sorting-model:the-th-element-16&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; covers in its &lt;a href=#concept-table id=table-sorting-model:concept-table-7&gt;table&lt;/a&gt;.&lt;li&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Start group&lt;/i&gt;: Let &lt;var&gt;pending rows in group&lt;/var&gt; be 1.&lt;li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-13&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-4&gt;row&lt;/a&gt; of group
-      &lt;var&gt;a&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-5&gt;row&lt;/a&gt; whose
-      &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-14&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-6&gt;row&lt;/a&gt; of group
-      &lt;var&gt;b&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-7&gt;row&lt;/a&gt; whose
-      &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Group loop&lt;/i&gt;: Append the &lt;code id=table-sorting-model:the-tr-element-12&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element pointed to by &lt;var&gt;group
+           cursor&lt;/var&gt; to &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If there are any &lt;a href=#concept-cell id=table-sorting-model:concept-cell-11&gt;cells&lt;/a&gt; whose highest &lt;a href=#concept-row id=table-sorting-model:concept-row-3&gt;row&lt;/a&gt;'s element is the one pointed to by &lt;var&gt;group
+           cursor&lt;/var&gt;, then let &lt;var&gt;tallest height&lt;/var&gt; be the number of rows covered by the
+           tallest such &lt;a href=#concept-cell id=table-sorting-model:concept-cell-12&gt;cell&lt;/a&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tallest height&lt;/var&gt; is greater than &lt;var&gt;pending rows in
+           group&lt;/var&gt; then set &lt;var&gt;pending rows in group&lt;/var&gt; to &lt;var&gt;tallest
+           height&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Decrement &lt;var&gt;pending rows in group&lt;/var&gt; by one.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-13&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;, if any; otherwise, let it be null.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null and &lt;var&gt;pending rows in
+           group&lt;/var&gt; is not zero, jump back to the step labeled &lt;i&gt;group loop&lt;/i&gt;.&lt;/ol&gt;
 
-      
+         &lt;li&gt;&lt;p&gt;Append a new group to &lt;var&gt;groups&lt;/var&gt; consisting of the &lt;code id=table-sorting-model:the-tr-element-14&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
+         elements in &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Empty &lt;var&gt;group&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null, then jump back to the step labeled &lt;i&gt;start
+         group&lt;/i&gt;.&lt;/ol&gt;
 
-      &lt;p&gt;In either case, if there's no &lt;a href=#concept-cell id=table-sorting-model:concept-cell-15&gt;cell&lt;/a&gt; that actually covers
-      the slot, then use the value &lt;i&gt;null&lt;/i&gt; instead.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If &lt;var&gt;ignore first group&lt;/var&gt; is true, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and set &lt;var&gt;ignore first group&lt;/var&gt; to false.&lt;li&gt;
 
-     &lt;li&gt;
+        &lt;p&gt;Run these steps:&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be
-      the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, as defined
-      below.&lt;/p&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Drop leading header groups&lt;/i&gt;: If &lt;var&gt;groups&lt;/var&gt; is now empty, jump to the
+         step labeled &lt;i&gt;increment loop&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;If the first group of &lt;var&gt;groups&lt;/var&gt; consists of &lt;code id=table-sorting-model:the-tr-element-15&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements
+         whose element children are all &lt;code id=table-sorting-model:the-th-element-13&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; elements, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and jump back to the previous step (labeled &lt;i&gt;drop leading header
+         groups&lt;/i&gt;).&lt;/ol&gt;
 
-      &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be
-      the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell-2&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, as defined
-      below.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;insertion point&lt;/var&gt; be a placeholder in a DOM tree, which can be used
+       to reinsert nodes at a specific point in the DOM. Insert &lt;var&gt;insertion point&lt;/var&gt; into
+       the parent of the first &lt;code id=table-sorting-model:the-tr-element-16&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element of the first group in &lt;var&gt;groups&lt;/var&gt;,
+       immediately before that &lt;code id=table-sorting-model:the-tr-element-17&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; element.&lt;li&gt;
 
-      &lt;p&gt;The &lt;dfn id=type-and-value-of-the-cell&gt;type and value of the cell&lt;/dfn&gt; &lt;var&gt;cell&lt;/var&gt; are computed as follows.&lt;/p&gt;
+        &lt;p&gt;Sort the groups in &lt;var&gt;groups&lt;/var&gt;, using the following algorithm to decide the
+        relative order of any two groups &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; (the algorithm
+        either returns that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;, or that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;):&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var&gt;cell&lt;/var&gt; is &lt;i&gt;null&lt;/i&gt;, then the type is &quot;string&quot; and the value is
-       the empty string; abort these steps.&lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-       &lt;a href=#element id=table-sorting-model:element&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code id=table-sorting-model:the-data-element&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
-       &lt;code id=table-sorting-model:the-data-element-2&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-data-value&gt;&lt;a href=#attr-data-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
-       one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;key index&lt;/var&gt; be an index into &lt;var&gt;key heading
+         cells&lt;/var&gt;, initially denoting the first element in the list.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;direction&lt;/var&gt; be a sort direction, initially &lt;i&gt;ascending&lt;/i&gt;. Its
+         other possible value is &lt;i&gt;descending&lt;/i&gt;. When &lt;var&gt;direction&lt;/var&gt; is
+         &lt;i&gt;toggled&lt;/i&gt;, that means that if its value is &lt;i&gt;ascending&lt;/i&gt;, it must be changed to
+         &lt;i&gt;descending&lt;/i&gt;, and when its value is &lt;i&gt;descending&lt;/i&gt;, it must be changed to
+         &lt;i&gt;ascending&lt;/i&gt;.&lt;li&gt;
 
-       &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-2&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-       &lt;a href=#element id=table-sorting-model:element-2&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-2&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code id=table-sorting-model:the-progress-element&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
-       &lt;code id=table-sorting-model:the-progress-element-2&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-progress-value&gt;&lt;a href=#attr-progress-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
-       there is one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-3&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-       &lt;a href=#element id=table-sorting-model:element-3&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-3&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code id=table-sorting-model:the-meter-element&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
-       &lt;code id=table-sorting-model:the-meter-element-2&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-meter-value&gt;&lt;a href=#attr-meter-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
-       one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;i&gt;Column loop&lt;/i&gt;: Let &lt;var&gt;th&lt;/var&gt; be the &lt;var&gt;key index&lt;/var&gt;th
+           &lt;code id=table-sorting-model:the-th-element-14&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; in &lt;var&gt;key heading cells&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;th&lt;/var&gt;'s &lt;code id=table-sorting-model:attr-th-sorted-10&gt;&lt;a href=#attr-th-sorted&gt;sorted&lt;/a&gt;&lt;/code&gt; attribute's
+           &lt;a href=#column-sort-direction id=table-sorting-model:column-sort-direction-3&gt;column sort direction&lt;/a&gt; is &lt;i&gt;reversed&lt;/i&gt;, then toggle &lt;var&gt;direction&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;tentative order&lt;/var&gt; be the result of &lt;a href=#comparing-two-row-groups-using-the-th-element id=table-sorting-model:comparing-two-row-groups-using-the-th-element&gt;comparing two row groups
+           using the &lt;code&gt;th&lt;/code&gt; element&lt;/a&gt; &lt;var&gt;th&lt;/var&gt;, with &lt;var&gt;a&lt;/var&gt; and
+           &lt;var&gt;b&lt;/var&gt; as the rows.&lt;li&gt;&lt;p&gt;If &lt;var&gt;tentative order&lt;/var&gt; is not &quot;equal&quot;, then jump to the step labeled
+           &lt;i&gt;return&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Increment &lt;var&gt;key index&lt;/var&gt;.&lt;li&gt;&lt;p&gt;If &lt;var&gt;key index&lt;/var&gt; still denotes a &lt;code id=table-sorting-model:the-th-element-15&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element in &lt;var&gt;key heading cells&lt;/var&gt;, then jump back to the step above labeled &lt;i&gt;column
+           loop&lt;/i&gt;.&lt;/ol&gt;
 
-       &lt;li&gt;
+         &lt;li&gt;&lt;p&gt;If &lt;var&gt;a&lt;/var&gt;'s &lt;code id=table-sorting-model:the-tr-element-18&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements precede &lt;var&gt;b&lt;/var&gt;'s in
+         &lt;a href=#tree-order id=table-sorting-model:tree-order-3&gt;tree order&lt;/a&gt;, then let &lt;var&gt;tentative order&lt;/var&gt; be &quot;a before b&quot;.
+         Otherwise, let &lt;var&gt;tentative order&lt;/var&gt; be &quot;b before a&quot;.&lt;li&gt;&lt;p&gt;&lt;i&gt;Return&lt;/i&gt;: Return the relative order given by the matching option from the following
+         list:&lt;/p&gt;
 
-        &lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-4&gt;inter-element whitespace&lt;/a&gt; and nodes other than
-        &lt;a href=#element id=table-sorting-model:element-4&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-4&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one
-        child and that child is a &lt;code id=table-sorting-model:the-time-element&gt;&lt;a href=#the-time-element&gt;time&lt;/a&gt;&lt;/code&gt; element, then the value is the
-        &lt;a href=&quot;#machine-readable-equivalent-of-the-element's-contents&quot; id=&quot;table-sorting-model:machine-readable-equivalent-of-the-element's-contents&quot;&gt;machine-readable equivalent of the element's contents&lt;/a&gt;, if any, and the type is
-        the kind of value that is thus obtained
-       (a &lt;a href=#concept-month id=table-sorting-model:concept-month&gt;month&lt;/a&gt;,
-        a &lt;a href=#concept-date id=table-sorting-model:concept-date&gt;date&lt;/a&gt;,
-        a &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date&gt;yearless date&lt;/a&gt;,
-        a &lt;a href=#concept-time id=table-sorting-model:concept-time&gt;time&lt;/a&gt;,
-        a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local&gt;local date and time&lt;/a&gt;,
-        a &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone&gt;time-zone offset&lt;/a&gt;,
-        a &lt;a href=#concept-datetime id=table-sorting-model:concept-datetime&gt;global date and time&lt;/a&gt;,
-        a &lt;a href=#concept-week id=table-sorting-model:concept-week&gt;week&lt;/a&gt;,
-        a year, or
-        a &lt;a href=#concept-duration id=table-sorting-model:concept-duration&gt;duration&lt;/a&gt;);
-        abort these steps after completing this one.&lt;/p&gt;
+          &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;a before b&quot;&lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;b before a&quot;&lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dl&gt;
 
-        &lt;p&gt;If there is no machine-readable equivalent, then the type is &quot;string&quot; and the value is
-        the empty string.&lt;/p&gt;
+         &lt;/ol&gt;
 
-        &lt;p&gt;If the type is
-        a &lt;a href=#concept-month id=table-sorting-model:concept-month-2&gt;month&lt;/a&gt;,
-        a &lt;a href=#concept-date id=table-sorting-model:concept-date-2&gt;date&lt;/a&gt;,
-        a &lt;a href=#concept-week id=table-sorting-model:concept-week-2&gt;week&lt;/a&gt;, or
-        a year,
-        then change the value to be the instant in time (with no time zone) that describes the
-        earliest moment that the value represents, and change the type to be
-        a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-2&gt;local date and time&lt;/a&gt;.&lt;/p&gt;
+        &lt;p&gt;When the user agent is required to &lt;dfn id=comparing-two-row-groups-using-the-th-element&gt;compare two row groups using the &lt;code&gt;th&lt;/code&gt; element&lt;/dfn&gt; &lt;var&gt;th&lt;/var&gt;,
+        with &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; being the two row groups respectively, the
+        user agent must run the following steps:&lt;/p&gt;
 
-        &lt;p class=example&gt;For example, if the cell was &lt;code&gt;&lt;td&gt;&lt;time&gt;2011-11&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is
-        interpreted as &quot;2011-11-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-3&gt;local date and time&lt;/a&gt; rather than a &lt;a href=#concept-month id=table-sorting-model:concept-month-3&gt;month&lt;/a&gt;.&lt;/p&gt;
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;x&lt;/var&gt; be the &lt;var&gt;x&lt;/var&gt;-coordinate of the slots that
+         &lt;code id=table-sorting-model:the-th-element-16&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; covers in its &lt;a href=#concept-table id=table-sorting-model:concept-table-7&gt;table&lt;/a&gt;.&lt;li&gt;
 
-        &lt;p class=example&gt;Similarly, if the cell was &lt;code&gt;&lt;td&gt;&lt;time
-        datetime=&quot;2014&quot;&gt;MMXIV&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is interpreted as
-        &quot;2014-01-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-4&gt;local date and time&lt;/a&gt; rather than a year.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-13&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-4&gt;row&lt;/a&gt; of group
+          &lt;var&gt;a&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-5&gt;row&lt;/a&gt; whose
+          &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;The value is the element's &lt;code id=table-sorting-model:textcontent&gt;&lt;a href=#textcontent&gt;textContent&lt;/a&gt;&lt;/code&gt;. The type is &quot;string&quot;.&lt;/ol&gt;
+          &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;a href=#concept-cell id=table-sorting-model:concept-cell-14&gt;cell&lt;/a&gt; in the first &lt;a href=#concept-row id=table-sorting-model:concept-row-6&gt;row&lt;/a&gt; of group
+          &lt;var&gt;b&lt;/var&gt; that covers the slot in that &lt;a href=#concept-row id=table-sorting-model:concept-row-7&gt;row&lt;/a&gt; whose
+          &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+          
 
-      &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
-      equal, then: return &quot;a before b&quot; if &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier in the
-      following list than &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, otherwise, return &quot;b before a&quot;;
-      then, abort these steps.&lt;/p&gt;
+          &lt;p&gt;In either case, if there's no &lt;a href=#concept-cell id=table-sorting-model:concept-cell-15&gt;cell&lt;/a&gt; that actually covers
+          the slot, then use the value &lt;i&gt;null&lt;/i&gt; instead.&lt;/p&gt;
 
-      &lt;ol class=brief&gt;&lt;li&gt;&lt;a href=#concept-time id=table-sorting-model:concept-time-2&gt;time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-2&gt;yearless date&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-5&gt;local date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime id=table-sorting-model:concept-datetime-2&gt;global date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-2&gt;time-zone offset&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-duration id=table-sorting-model:concept-duration-2&gt;duration&lt;/a&gt;&lt;li&gt;&quot;string&quot;&lt;/ol&gt;
+         &lt;li&gt;
 
-     &lt;li&gt;&lt;p&gt;If &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are
-     equal, then return &quot;equal&quot; and abort these steps.&lt;li&gt;
+          &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be
+          the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, as defined
+          below.&lt;/p&gt;
 
-      &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
-      &quot;string&quot;, then: if &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier than &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; then return &quot;a before b&quot; and abort these steps, otherwise,
-      return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be
+          the &lt;a href=#type-and-value-of-the-cell id=table-sorting-model:type-and-value-of-the-cell-2&gt;type and value of the cell&lt;/a&gt; &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, as defined
+          below.&lt;/p&gt;
 
-      &lt;p&gt;Values sort in their natural order, with the following additional constraints:&lt;/p&gt;
+          &lt;p&gt;The &lt;dfn id=type-and-value-of-the-cell&gt;type and value of the cell&lt;/dfn&gt; &lt;var&gt;cell&lt;/var&gt; are computed as follows.&lt;/p&gt;
 
-      &lt;p&gt;For &lt;a href=#concept-time id=table-sorting-model:concept-time-3&gt;time&lt;/a&gt; values, 00:00:00.000 is the earliest value and
-      23:59:59.999 is the latest value.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;&lt;p&gt;If &lt;var&gt;cell&lt;/var&gt; is &lt;i&gt;null&lt;/i&gt;, then the type is &quot;string&quot; and the value is
+           the empty string; abort these steps.&lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+           &lt;a href=#element id=table-sorting-model:element&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code id=table-sorting-model:the-data-element&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
+           &lt;code id=table-sorting-model:the-data-element-2&gt;&lt;a href=#the-data-element&gt;data&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-data-value&gt;&lt;a href=#attr-data-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
+           one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-      &lt;p&gt;For &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-3&gt;yearless date&lt;/a&gt; values, 01-01 is the earliest
-      value and 12-31 is the latest value; 02-28 is earlier than 02-29 which is earlier than
-      03-01.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-2&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+           &lt;a href=#element id=table-sorting-model:element-2&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-2&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code id=table-sorting-model:the-progress-element&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
+           &lt;code id=table-sorting-model:the-progress-element-2&gt;&lt;a href=#the-progress-element&gt;progress&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-progress-value&gt;&lt;a href=#attr-progress-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if
+           there is one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-      &lt;p&gt;Values that are &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-6&gt;local date and time&lt;/a&gt; compare as
-      if they were in the same time zone.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-3&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+           &lt;a href=#element id=table-sorting-model:element-3&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-3&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code id=table-sorting-model:the-meter-element&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element, then the value is the value of that
+           &lt;code id=table-sorting-model:the-meter-element-2&gt;&lt;a href=#the-meter-element&gt;meter&lt;/a&gt;&lt;/code&gt; element's &lt;code id=table-sorting-model:attr-meter-value&gt;&lt;a href=#attr-meter-value&gt;value&lt;/a&gt;&lt;/code&gt; attribute, if there is
+           one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-      
+           &lt;li&gt;
 
-      &lt;p&gt;For &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-3&gt;time-zone offset&lt;/a&gt; values, -23:59 is the earliest
-      value and +23:59 is the latest value.&lt;/p&gt;
+            &lt;p&gt;If, ignoring &lt;a href=#inter-element-whitespace id=table-sorting-model:inter-element-whitespace-4&gt;inter-element whitespace&lt;/a&gt; and nodes other than
+            &lt;a href=#element id=table-sorting-model:element-4&gt;Element&lt;/a&gt; and &lt;a href=#text id=table-sorting-model:text-4&gt;Text&lt;/a&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one
+            child and that child is a &lt;code id=table-sorting-model:the-time-element&gt;&lt;a href=#the-time-element&gt;time&lt;/a&gt;&lt;/code&gt; element, then the value is the
+            &lt;a href=&quot;#machine-readable-equivalent-of-the-element's-contents&quot; id=&quot;table-sorting-model:machine-readable-equivalent-of-the-element's-contents&quot;&gt;machine-readable equivalent of the element's contents&lt;/a&gt;, if any, and the type is
+            the kind of value that is thus obtained
+           (a &lt;a href=#concept-month id=table-sorting-model:concept-month&gt;month&lt;/a&gt;,
+            a &lt;a href=#concept-date id=table-sorting-model:concept-date&gt;date&lt;/a&gt;,
+            a &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date&gt;yearless date&lt;/a&gt;,
+            a &lt;a href=#concept-time id=table-sorting-model:concept-time&gt;time&lt;/a&gt;,
+            a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local&gt;local date and time&lt;/a&gt;,
+            a &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone&gt;time-zone offset&lt;/a&gt;,
+            a &lt;a href=#concept-datetime id=table-sorting-model:concept-datetime&gt;global date and time&lt;/a&gt;,
+            a &lt;a href=#concept-week id=table-sorting-model:concept-week&gt;week&lt;/a&gt;,
+            a year, or
+            a &lt;a href=#concept-duration id=table-sorting-model:concept-duration&gt;duration&lt;/a&gt;);
+            abort these steps after completing this one.&lt;/p&gt;
 
-      
+            &lt;p&gt;If there is no machine-readable equivalent, then the type is &quot;string&quot; and the value is
+            the empty string.&lt;/p&gt;
 
-     &lt;li&gt;
+            &lt;p&gt;If the type is
+            a &lt;a href=#concept-month id=table-sorting-model:concept-month-2&gt;month&lt;/a&gt;,
+            a &lt;a href=#concept-date id=table-sorting-model:concept-date-2&gt;date&lt;/a&gt;,
+            a &lt;a href=#concept-week id=table-sorting-model:concept-week-2&gt;week&lt;/a&gt;, or
+            a year,
+            then change the value to be the instant in time (with no time zone) that describes the
+            earliest moment that the value represents, and change the type to be
+            a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-2&gt;local date and time&lt;/a&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key&gt;parsing the sort
-      key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
+            &lt;p class=example&gt;For example, if the cell was &lt;code&gt;&lt;td&gt;&lt;time&gt;2011-11&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is
+            interpreted as &quot;2011-11-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-3&gt;local date and time&lt;/a&gt; rather than a &lt;a href=#concept-month id=table-sorting-model:concept-month-3&gt;month&lt;/a&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key-2&gt;parsing the sort
-      key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
+            &lt;p class=example&gt;Similarly, if the cell was &lt;code&gt;&lt;td&gt;&lt;time
+            datetime=&quot;2014&quot;&gt;MMXIV&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is interpreted as
+            &quot;2014-01-01T00:00:00.000&quot; and the type is treated as a &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-4&gt;local date and time&lt;/a&gt; rather than a year.&lt;/p&gt;
 
-      &lt;p&gt;As described below, &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are tuples consisting of a list of &lt;var&gt;n&lt;/var&gt;
-      &lt;i&gt;numbers&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt; &lt;i&gt;number strings&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;non-numeric strings&lt;/i&gt;, and a list of 2&lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;raw
-      strings&lt;/i&gt;, for any non-negative integer value of &lt;var&gt;n&lt;/var&gt; (zero or more).&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;The value is the element's &lt;code id=table-sorting-model:textcontent&gt;&lt;a href=#textcontent&gt;textContent&lt;/a&gt;&lt;/code&gt;. The type is &quot;string&quot;.&lt;/ol&gt;
 
-     &lt;li&gt;
+         &lt;li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison&gt;locale-specific string
-      comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric
-      string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric string&lt;/i&gt;,
-      in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+          &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
+          equal, then: return &quot;a before b&quot; if &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier in the
+          following list than &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, otherwise, return &quot;b before a&quot;;
+          then, abort these steps.&lt;/p&gt;
 
-      &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
-      these steps.&lt;/p&gt;
+          &lt;ol class=brief&gt;&lt;li&gt;&lt;a href=#concept-time id=table-sorting-model:concept-time-2&gt;time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-2&gt;yearless date&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-5&gt;local date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-datetime id=table-sorting-model:concept-datetime-2&gt;global date and time&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-2&gt;time-zone offset&lt;/a&gt;&lt;li&gt;&lt;a href=#concept-duration id=table-sorting-model:concept-duration-2&gt;duration&lt;/a&gt;&lt;li&gt;&quot;string&quot;&lt;/ol&gt;
 
-     &lt;li&gt;
+         &lt;li&gt;&lt;p&gt;If &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are
+         equal, then return &quot;equal&quot; and abort these steps.&lt;li&gt;
 
-      &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; both have exactly one &lt;i&gt;number&lt;/i&gt;, then run these
-      substeps:&lt;/p&gt;
+          &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
+          &quot;string&quot;, then: if &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier than &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; then return &quot;a before b&quot; and abort these steps, otherwise,
+          return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;
+          &lt;p&gt;Values sort in their natural order, with the following additional constraints:&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;a before b&quot;.&lt;/p&gt;
+          &lt;p&gt;For &lt;a href=#concept-time id=table-sorting-model:concept-time-3&gt;time&lt;/a&gt; values, 00:00:00.000 is the earliest value and
+          23:59:59.999 is the latest value.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;.&lt;/p&gt;
+          &lt;p&gt;For &lt;a href=#concept-yearless-date id=table-sorting-model:concept-yearless-date-3&gt;yearless date&lt;/a&gt; values, 01-01 is the earliest
+          value and 12-31 is the latest value; 02-28 is earlier than 02-29 which is earlier than
+          03-01.&lt;/p&gt;
 
-       &lt;li&gt;
+          &lt;p&gt;Values that are &lt;a href=#concept-datetime-local id=table-sorting-model:concept-datetime-local-6&gt;local date and time&lt;/a&gt; compare as
+          if they were in the same time zone.&lt;/p&gt;
 
-        &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-2&gt;locale-specific string
-        comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
-        string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
-        string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+          
 
-        &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-        abort these steps.&lt;/p&gt;
+          &lt;p&gt;For &lt;a href=#concept-timezone id=table-sorting-model:concept-timezone-3&gt;time-zone offset&lt;/a&gt; values, -23:59 is the earliest
+          value and +23:59 is the latest value.&lt;/p&gt;
 
-       &lt;li&gt;
+          
 
-        &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-3&gt;locale-specific string
-        comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt; and
-        &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+         &lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-        abort these steps.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key&gt;parsing the sort
+          key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;/ol&gt;
+          &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the result of &lt;a href=#parsing-the-sort-key id=table-sorting-model:parsing-the-sort-key-2&gt;parsing the sort
+          key&lt;/a&gt; &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Otherwise, run these substeps:&lt;/p&gt;
+          &lt;p&gt;As described below, &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are tuples consisting of a list of &lt;var&gt;n&lt;/var&gt;
+          &lt;i&gt;numbers&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt; &lt;i&gt;number strings&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;non-numeric strings&lt;/i&gt;, and a list of 2&lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;raw
+          strings&lt;/i&gt;, for any non-negative integer value of &lt;var&gt;n&lt;/var&gt; (zero or more).&lt;/p&gt;
 
-      &lt;ol&gt;&lt;li&gt;
+         &lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;a before
-        b&quot;.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison&gt;locale-specific string
+          comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric
+          string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric string&lt;/i&gt;,
+          in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;b before
-        a&quot;.&lt;/p&gt;
+          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
+          these steps.&lt;/p&gt;
 
-       &lt;li&gt;
+         &lt;li&gt;
 
-        
+          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; both have exactly one &lt;i&gt;number&lt;/i&gt;, then run these
+          substeps:&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;a before
-        b&quot;.&lt;/p&gt;
+          &lt;ol&gt;&lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;b before
-        a&quot;.&lt;/p&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;a before b&quot;.&lt;/p&gt;
 
-       &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;.&lt;/p&gt;
 
-        
+           &lt;li&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; have more than one &lt;i&gt;number&lt;/i&gt;, run these substeps:&lt;/p&gt;
+            &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-2&gt;locale-specific string
+            comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
+            string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
+            string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;count&lt;/var&gt; be the smaller of the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;li&gt;&lt;p&gt;For each &lt;i&gt;number&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; from the first to the &lt;var&gt;count&lt;/var&gt;th, in
-         order: if &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, then return &quot;a before b&quot; and abort
-         these steps; otherwise, if &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is
-         less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;
-         and abort these steps.&lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+            abort these steps.&lt;/p&gt;
 
-          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return &quot;a before b&quot; and abort these steps.&lt;/p&gt;
+           &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+            &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-3&gt;locale-specific string
+            comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt; and
+            &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+            abort these steps.&lt;/p&gt;
 
-          &lt;p&gt;&lt;i&gt;String loop&lt;/i&gt;: Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-4&gt;locale-specific
-          string comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt;,
-          in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+           &lt;/ol&gt;
 
-          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-          abort these steps.&lt;/p&gt;
+          &lt;p&gt;Otherwise, run these substeps:&lt;/p&gt;
 
-         &lt;li&gt;
+          &lt;ol&gt;&lt;li&gt;
 
-          &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;a before
+            b&quot;.&lt;/p&gt;
 
-         &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;b before
+            a&quot;.&lt;/p&gt;
 
-          &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-5&gt;locale-specific string
-          comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator
-          string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-          abort these steps.&lt;/p&gt;
+            
 
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;a before
+            b&quot;.&lt;/p&gt;
+
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;b before
+            a&quot;.&lt;/p&gt;
+
+           &lt;li&gt;
+
+            
+
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; have more than one &lt;i&gt;number&lt;/i&gt;, run these substeps:&lt;/p&gt;
+
+            &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var&gt;count&lt;/var&gt; be the smaller of the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;li&gt;&lt;p&gt;For each &lt;i&gt;number&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; from the first to the &lt;var&gt;count&lt;/var&gt;th, in
+             order: if &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, then return &quot;a before b&quot; and abort
+             these steps; otherwise, if &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is
+             less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;
+             and abort these steps.&lt;li&gt;
+
+              &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return &quot;a before b&quot; and abort these steps.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+
+             &lt;li&gt;&lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;li&gt;
+
+              &lt;p&gt;&lt;i&gt;String loop&lt;/i&gt;: Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-4&gt;locale-specific
+              string comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt;,
+              in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+              abort these steps.&lt;/p&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#locale-specific-string-comparison id=table-sorting-model:locale-specific-string-comparison-5&gt;locale-specific string
+              comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator
+              string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+              abort these steps.&lt;/p&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, jump back
+              to the step labeled &lt;i&gt;string loop&lt;/i&gt;.&lt;/p&gt;
+
+             &lt;/ol&gt;
+
+           &lt;/ol&gt;
+
          &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return
-          to the step labeled &lt;i&gt;string loop&lt;/i&gt;.&lt;/p&gt;
+          
 
-         &lt;/ol&gt;
+          &lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;
 
-       &lt;/ol&gt;
+         &lt;li&gt;
 
-     &lt;li&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-      
+          &lt;ol&gt;&lt;li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;
+            &lt;p&gt;&lt;i&gt;Final loop:&lt;/i&gt; Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#raw-string-comparison id=table-sorting-model:raw-string-comparison&gt;raw string
+            comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
+            &lt;i&gt;raw string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
+            &lt;i&gt;raw string&lt;/i&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
+            these steps.&lt;/p&gt;
 
-      &lt;p&gt;&lt;i&gt;Final loop:&lt;/i&gt; Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;a href=#raw-string-comparison id=table-sorting-model:raw-string-comparison&gt;raw string
-      comparison&lt;/a&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
-      &lt;i&gt;raw string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
-      &lt;i&gt;raw string&lt;/i&gt;.&lt;/p&gt;
+           &lt;li&gt;
 
-      &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
-      these steps.&lt;/p&gt;
+            &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+           &lt;li&gt;
 
-      &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+            &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;raw strings&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, jump back
+            to the step labeled &lt;i&gt;final loop&lt;/i&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+           &lt;/ol&gt;
 
-      &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;raw strings&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return
-      to the step labeled &lt;i&gt;final loop&lt;/i&gt;.&lt;/p&gt;
+         &lt;li&gt;
 
-     &lt;li&gt;
+          &lt;p&gt;Return &quot;equal&quot;.&lt;/p&gt;
 
-      &lt;p&gt;Return &quot;equal&quot;.&lt;/p&gt;
+         &lt;/ol&gt;
 
-     &lt;/ol&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;new order&lt;/var&gt; be a list of &lt;code id=table-sorting-model:the-tr-element-19&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements consisting of the
+       &lt;code id=table-sorting-model:the-tr-element-20&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements of all the groups in the newly ordered &lt;var&gt;groups&lt;/var&gt;, with
+       the &lt;code id=table-sorting-model:the-tr-element-21&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements being in the same order as the groups to which they belong are in
+       &lt;var&gt;groups&lt;/var&gt;, and the &lt;code id=table-sorting-model:the-tr-element-22&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements within each such group themselves
+       being ordered in &lt;a href=#tree-order id=table-sorting-model:tree-order-4&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-remove id=table-sorting-model:concept-node-remove&gt;Remove&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-23&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; from their parents, in &lt;a href=#tree-order id=table-sorting-model:tree-order-5&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-insert id=table-sorting-model:concept-node-insert&gt;Insert&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-24&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; into the DOM at the location of &lt;var&gt;insertion point&lt;/var&gt;, in
+       the order these elements are found in &lt;var&gt;new order&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Remove &lt;var&gt;insertion point&lt;/var&gt; from the DOM.&lt;/ol&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;new order&lt;/var&gt; be a list of &lt;code id=table-sorting-model:the-tr-element-19&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements consisting of the
-   &lt;code id=table-sorting-model:the-tr-element-20&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements of all the groups in the newly ordered &lt;var&gt;groups&lt;/var&gt;, with
-   the &lt;code id=table-sorting-model:the-tr-element-21&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements being in the same order as the groups to which they belong are in
-   &lt;var&gt;groups&lt;/var&gt;, and the &lt;code id=table-sorting-model:the-tr-element-22&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements within each such group themselves
-   being ordered in &lt;a href=#tree-order id=table-sorting-model:tree-order-4&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-remove id=table-sorting-model:concept-node-remove&gt;Remove&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-23&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; from their parents, in &lt;a href=#tree-order id=table-sorting-model:tree-order-5&gt;tree order&lt;/a&gt;.&lt;li&gt;&lt;p&gt;&lt;a href=#concept-node-insert id=table-sorting-model:concept-node-insert&gt;Insert&lt;/a&gt; all the &lt;code id=table-sorting-model:the-tr-element-24&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; into the DOM at the location of &lt;var&gt;insertion point&lt;/var&gt;, in
-   the order these elements are found in &lt;var&gt;new order&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Remove &lt;var&gt;insertion point&lt;/var&gt; from the DOM.&lt;li&gt;&lt;p&gt;&lt;i&gt;Increment loop&lt;/i&gt;: If there are no &lt;code id=table-sorting-model:the-tr-element-25&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-5&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of
-   &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
-   collection cursor&lt;/var&gt;, then jump to the step labeled &lt;i&gt;end&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-26&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or
-   &lt;code id=table-sorting-model:the-tbody-element-6&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; child of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element
-   pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;row loop&lt;/i&gt; above.&lt;li&gt;&lt;p&gt;&lt;i&gt;End&lt;/i&gt;: Set &lt;var&gt;table&lt;/var&gt;'s &lt;a href=#currently-sorting-flag id=table-sorting-model:currently-sorting-flag-3&gt;currently-sorting flag&lt;/a&gt; to
+     &lt;li&gt;&lt;p&gt;&lt;i&gt;Increment loop&lt;/i&gt;: If there are no &lt;code id=table-sorting-model:the-tr-element-25&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or &lt;code id=table-sorting-model:the-tbody-element-5&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; children of
+     &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
+     collection cursor&lt;/var&gt;, then jump to the step labeled &lt;i&gt;end&lt;/i&gt; below.&lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code id=table-sorting-model:the-tr-element-26&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; or
+     &lt;code id=table-sorting-model:the-tbody-element-6&gt;&lt;a href=#the-tbody-element&gt;tbody&lt;/a&gt;&lt;/code&gt; child of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element
+     pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;li&gt;&lt;p&gt;Jump back to the step labeled &lt;i&gt;row loop&lt;/i&gt; above.&lt;/ol&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;i&gt;End&lt;/i&gt;: Set &lt;var&gt;table&lt;/var&gt;'s &lt;a href=#currently-sorting-flag id=table-sorting-model:currently-sorting-flag-3&gt;currently-sorting flag&lt;/a&gt; to
    false.&lt;/ol&gt;
 
   &lt;p&gt;When a user agent is to &lt;dfn id=parsing-the-sort-key&gt;parse the sort key&lt;/dfn&gt; &lt;var&gt;value&lt;/var&gt;, it must run the following steps. These return a tuple consisting of a list

Modified: source
===================================================================
--- source	2014-09-17 22:43:04 UTC (rev 8783)
+++ source	2014-09-17 22:58:28 UTC (rev 8784)
@@ -38645,584 +38645,654 @@
    corresponding to a &lt;code&gt;thead&lt;/code&gt; element, then set &lt;var&gt;ignore first group&lt;/var&gt; to
    true. Otherwise, set it to false.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Row loop&lt;/i&gt;: Let &lt;var&gt;rows&lt;/var&gt; be an empty list of &lt;code&gt;tr&lt;/code&gt;
-   elements.&lt;/p&gt;&lt;/li&gt;
-
    &lt;li&gt;
 
-    &lt;p&gt;Run the appropriate steps from the following list:&lt;/p&gt;
+    &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;dl class=&quot;switch&quot;&gt;
+    &lt;ol&gt;
 
-     &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code&gt;tr&lt;/code&gt; element
+     &lt;li&gt;&lt;p&gt;&lt;i&gt;Row loop&lt;/i&gt;: Let &lt;var&gt;rows&lt;/var&gt; be an empty list of &lt;code&gt;tr&lt;/code&gt;
+     elements.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;dd&gt;
+     &lt;li&gt;
 
+      &lt;p&gt;Run these substeps:&lt;/p&gt;
+
       &lt;ol&gt;
 
-       &lt;li&gt;&lt;p&gt;&lt;i&gt;Collect&lt;/i&gt;: Append the element pointed to by &lt;var&gt;row collection
-       cursor&lt;/var&gt; to &lt;var&gt;rows&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;
 
-       &lt;li&gt;&lt;p&gt;If there are no &lt;code&gt;tr&lt;/code&gt; or &lt;code&gt;tbody&lt;/code&gt; children of &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
-       collection cursor&lt;/var&gt;, or if the next such child is a &lt;code&gt;tbody&lt;/code&gt; element, then jump
-       to the step labeled &lt;i&gt;group&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
+        &lt;p&gt;Run the appropriate steps from the following list:&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code&gt;tr&lt;/code&gt; child
-       of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+        &lt;dl class=&quot;switch&quot;&gt;
 
-       &lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;collect&lt;/i&gt; above.&lt;/p&gt;&lt;/li&gt;
+         &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code&gt;tr&lt;/code&gt; element
 
-      &lt;/ol&gt;
+         &lt;dd&gt;
 
-     &lt;/dd&gt;
+          &lt;ol&gt;
 
+           &lt;li&gt;&lt;p&gt;&lt;i&gt;Collect&lt;/i&gt;: Append the element pointed to by &lt;var&gt;row collection
+           cursor&lt;/var&gt; to &lt;var&gt;rows&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code&gt;tbody&lt;/code&gt; element
+           &lt;li&gt;&lt;p&gt;If there are no &lt;code&gt;tr&lt;/code&gt; or &lt;code&gt;tbody&lt;/code&gt; children of &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
+           collection cursor&lt;/var&gt;, or if the next such child is a &lt;code&gt;tbody&lt;/code&gt; element, then jump
+           to the step labeled &lt;i&gt;group&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;dd&gt;
+           &lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code&gt;tr&lt;/code&gt; child
+           of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;ol&gt;
+           &lt;li&gt;&lt;p&gt;Jump back to the step labeled &lt;i&gt;collect&lt;/i&gt; above.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;li&gt;&lt;p&gt;Place all the &lt;code&gt;tr&lt;/code&gt; element children of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt; into &lt;var&gt;rows&lt;/var&gt;, in &lt;span&gt;tree
-       order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+          &lt;/ol&gt;
 
-       &lt;li&gt;&lt;p&gt;If &lt;var&gt;rows&lt;/var&gt; is empty, jump to the step labeled &lt;i&gt;increment loop&lt;/i&gt;
-       below.&lt;/p&gt;&lt;/li&gt;
+         &lt;/dd&gt;
 
-      &lt;/ol&gt;
 
-     &lt;/dd&gt;
+         &lt;dt&gt;If &lt;var&gt;row collection cursor&lt;/var&gt; points to a &lt;code&gt;tbody&lt;/code&gt; element
 
-    &lt;/dl&gt;
+         &lt;dd&gt;
 
-   &lt;/li&gt;
+          &lt;ol&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Group&lt;/i&gt;: Let &lt;var&gt;groups&lt;/var&gt; be an empty list of groups of &lt;code&gt;tr&lt;/code&gt;
-   elements.&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;Place all the &lt;code&gt;tr&lt;/code&gt; element children of the element pointed to by &lt;var&gt;row collection cursor&lt;/var&gt; into &lt;var&gt;rows&lt;/var&gt;, in &lt;span&gt;tree
+           order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;group&lt;/var&gt; be an empty group of &lt;code&gt;tr&lt;/code&gt; elements.&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If &lt;var&gt;rows&lt;/var&gt; is empty, jump to the step labeled &lt;i&gt;increment loop&lt;/i&gt;
+           below.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; be a pointer to an element, initially pointing at the
-   first &lt;code&gt;tr&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+          &lt;/ol&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Start group&lt;/i&gt;: Let &lt;var&gt;pending rows in group&lt;/var&gt; be 1.&lt;/p&gt;&lt;/li&gt;
+         &lt;/dd&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Group loop&lt;/i&gt;: Append the &lt;code&gt;tr&lt;/code&gt; element pointed to by &lt;var&gt;group
-   cursor&lt;/var&gt; to &lt;var&gt;group&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+        &lt;/dl&gt;
 
-   &lt;li&gt;&lt;p&gt;If there are any &lt;span data-x=&quot;concept-cell&quot;&gt;cells&lt;/span&gt; whose highest &lt;span
-   data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt;'s element is the one pointed to by &lt;var&gt;group
-   cursor&lt;/var&gt;, then let &lt;var&gt;tallest height&lt;/var&gt; be the number of rows covered by the
-   tallest such &lt;span data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If &lt;var&gt;tallest height&lt;/var&gt; is greater than &lt;var&gt;pending rows in
-   group&lt;/var&gt; then set &lt;var&gt;pending rows in group&lt;/var&gt; to &lt;var&gt;tallest
-   height&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;&lt;i&gt;Group&lt;/i&gt;: Let &lt;var&gt;groups&lt;/var&gt; be an empty list of groups of &lt;code&gt;tr&lt;/code&gt;
+       elements.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Decrement &lt;var&gt;pending rows in group&lt;/var&gt; by one.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;group&lt;/var&gt; be an empty group of &lt;code&gt;tr&lt;/code&gt; elements.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; point to the next &lt;code&gt;tr&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;, if any; otherwise, let it be null.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; be a pointer to an element, initially pointing at the
+       first &lt;code&gt;tr&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null and &lt;var&gt;pending rows in
-   group&lt;/var&gt; is not zero, return to the step labeled &lt;i&gt;group loop&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;
 
-   &lt;li&gt;&lt;p&gt;Append a new group to &lt;var&gt;groups&lt;/var&gt; consisting of the &lt;code&gt;tr&lt;/code&gt;
-   elements in &lt;var&gt;group&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+        &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;Empty &lt;var&gt;group&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+        &lt;ol&gt;
 
-   &lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null, then return to the step labeled &lt;i&gt;start
-   group&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;p&gt;&lt;i&gt;Start group&lt;/i&gt;: Let &lt;var&gt;pending rows in group&lt;/var&gt; be 1.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If &lt;var&gt;ignore first group&lt;/var&gt; is true, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and set &lt;var&gt;ignore first group&lt;/var&gt; to false.&lt;/p&gt;&lt;/li&gt;
+         &lt;li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Drop leading header groups&lt;/i&gt;: If &lt;var&gt;groups&lt;/var&gt; is now empty, jump to the
-   step labeled &lt;i&gt;increment loop&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-   &lt;!-- if you insert steps here, update the next step --&gt;
+          &lt;ol&gt;
 
-   &lt;li&gt;&lt;p&gt;If the first group of &lt;var&gt;groups&lt;/var&gt; consists of &lt;code&gt;tr&lt;/code&gt; elements
-   whose element children are all &lt;code&gt;th&lt;/code&gt; elements, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and return to the previous step (labeled &lt;i&gt;drop leading header
-   groups&lt;/i&gt;).&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;&lt;i&gt;Group loop&lt;/i&gt;: Append the &lt;code&gt;tr&lt;/code&gt; element pointed to by &lt;var&gt;group
+           cursor&lt;/var&gt; to &lt;var&gt;group&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;insertion point&lt;/var&gt; be a placeholder in a DOM tree, which can be used
-   to reinsert nodes at a specific point in the DOM. Insert &lt;var&gt;insertion point&lt;/var&gt; into
-   the parent of the first &lt;code&gt;tr&lt;/code&gt; element of the first group in &lt;var&gt;groups&lt;/var&gt;,
-   immediately before that &lt;code&gt;tr&lt;/code&gt; element.&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If there are any &lt;span data-x=&quot;concept-cell&quot;&gt;cells&lt;/span&gt; whose highest &lt;span
+           data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt;'s element is the one pointed to by &lt;var&gt;group
+           cursor&lt;/var&gt;, then let &lt;var&gt;tallest height&lt;/var&gt; be the number of rows covered by the
+           tallest such &lt;span data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;
+           &lt;li&gt;&lt;p&gt;If &lt;var&gt;tallest height&lt;/var&gt; is greater than &lt;var&gt;pending rows in
+           group&lt;/var&gt; then set &lt;var&gt;pending rows in group&lt;/var&gt; to &lt;var&gt;tallest
+           height&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-    &lt;p&gt;Sort the groups in &lt;var&gt;groups&lt;/var&gt;, using the following algorithm to decide the
-    relative order of any two groups &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; (the algorithm
-    either returns that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;, or that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;):&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;Decrement &lt;var&gt;pending rows in group&lt;/var&gt; by one.&lt;/p&gt;&lt;/li&gt;
 
-    &lt;ol&gt;
+           &lt;li&gt;&lt;p&gt;Let &lt;var&gt;group cursor&lt;/var&gt; point to the next &lt;code&gt;tr&lt;/code&gt; element in &lt;var&gt;rows&lt;/var&gt;, if any; otherwise, let it be null.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Let &lt;var&gt;key index&lt;/var&gt; be an index into &lt;var&gt;key heading
-     cells&lt;/var&gt;, initially denoting the first element in the list.&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null and &lt;var&gt;pending rows in
+           group&lt;/var&gt; is not zero, jump back to the step labeled &lt;i&gt;group loop&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Let &lt;var&gt;direction&lt;/var&gt; be a sort direction, initially &lt;i&gt;ascending&lt;/i&gt;. Its
-     other possible value is &lt;i&gt;descending&lt;/i&gt;. When &lt;var&gt;direction&lt;/var&gt; is
-     &lt;i&gt;toggled&lt;/i&gt;, that means that if its value is &lt;i&gt;ascending&lt;/i&gt;, it must be changed to
-     &lt;i&gt;descending&lt;/i&gt;, and when its value is &lt;i&gt;descending&lt;/i&gt;, it must be changed to
-     &lt;i&gt;ascending&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
+          &lt;/ol&gt;
 
-     &lt;li&gt;&lt;p&gt;&lt;i&gt;Column loop&lt;/i&gt;: Let &lt;var&gt;th&lt;/var&gt; be the &lt;var&gt;key index&lt;/var&gt;th
-     &lt;code&gt;th&lt;/code&gt; in &lt;var&gt;key heading cells&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+         &lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;If &lt;var&gt;th&lt;/var&gt;'s &lt;code data-x=&quot;attr-th-sorted&quot;&gt;sorted&lt;/code&gt; attribute's
-     &lt;span&gt;column sort direction&lt;/span&gt; is &lt;i&gt;reversed&lt;/i&gt;, then toggle &lt;var&gt;direction&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;p&gt;Append a new group to &lt;var&gt;groups&lt;/var&gt; consisting of the &lt;code&gt;tr&lt;/code&gt;
+         elements in &lt;var&gt;group&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Let &lt;var&gt;tentative order&lt;/var&gt; be the result of &lt;span&gt;comparing two row groups
-     using the &lt;code&gt;th&lt;/code&gt; element&lt;/span&gt; &lt;var&gt;th&lt;/var&gt;, with &lt;var&gt;a&lt;/var&gt; and
-     &lt;var&gt;b&lt;/var&gt; as the rows.&lt;/p&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;p&gt;Empty &lt;var&gt;group&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;If &lt;var&gt;tentative order&lt;/var&gt; is not &quot;equal&quot;, then jump to the step labeled
-     &lt;i&gt;return&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;p&gt;If &lt;var&gt;group cursor&lt;/var&gt; is not null, then jump back to the step labeled &lt;i&gt;start
+         group&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Increment &lt;var&gt;key index&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+        &lt;/ol&gt;
 
-     &lt;li&gt;&lt;p&gt;If &lt;var&gt;key index&lt;/var&gt; still denotes a &lt;code&gt;th&lt;/code&gt; element in &lt;var&gt;key heading cells&lt;/var&gt;, then jump back to the step above labeled &lt;i&gt;column
-     loop&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;If &lt;var&gt;a&lt;/var&gt;'s &lt;code&gt;tr&lt;/code&gt; elements precede &lt;var&gt;b&lt;/var&gt;'s in
-     &lt;span&gt;tree order&lt;/span&gt;, then let &lt;var&gt;tentative order&lt;/var&gt; be &quot;a before b&quot;.
-     Otherwise, let &lt;var&gt;tentative order&lt;/var&gt; be &quot;b before a&quot;.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;If &lt;var&gt;ignore first group&lt;/var&gt; is true, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and set &lt;var&gt;ignore first group&lt;/var&gt; to false.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;&lt;i&gt;Return&lt;/i&gt;: Return the relative order given by the matching option from the following
-     list:&lt;/p&gt;
+       &lt;li&gt;
 
-      &lt;dl class=&quot;switch&quot;&gt;
+        &lt;p&gt;Run these steps:&lt;/p&gt;
 
-       &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;a before b&quot;&lt;/dt&gt;
+        &lt;ol&gt;
 
-       &lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dd&gt;
+         &lt;li&gt;&lt;p&gt;&lt;i&gt;Drop leading header groups&lt;/i&gt;: If &lt;var&gt;groups&lt;/var&gt; is now empty, jump to the
+         step labeled &lt;i&gt;increment loop&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
 
+         &lt;!-- if you insert steps here, update the next step --&gt;
 
-       &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;b before a&quot;&lt;/dt&gt;
+         &lt;li&gt;&lt;p&gt;If the first group of &lt;var&gt;groups&lt;/var&gt; consists of &lt;code&gt;tr&lt;/code&gt; elements
+         whose element children are all &lt;code&gt;th&lt;/code&gt; elements, then drop the first group in &lt;var&gt;groups&lt;/var&gt; and jump back to the previous step (labeled &lt;i&gt;drop leading header
+         groups&lt;/i&gt;).&lt;/p&gt;&lt;/li&gt;
 
-       &lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;/dd&gt;
+        &lt;/ol&gt;
 
+       &lt;/li&gt;
 
-       &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;a before b&quot;&lt;/dt&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;insertion point&lt;/var&gt; be a placeholder in a DOM tree, which can be used
+       to reinsert nodes at a specific point in the DOM. Insert &lt;var&gt;insertion point&lt;/var&gt; into
+       the parent of the first &lt;code&gt;tr&lt;/code&gt; element of the first group in &lt;var&gt;groups&lt;/var&gt;,
+       immediately before that &lt;code&gt;tr&lt;/code&gt; element.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;/dd&gt;
+       &lt;li&gt;
 
+        &lt;p&gt;Sort the groups in &lt;var&gt;groups&lt;/var&gt;, using the following algorithm to decide the
+        relative order of any two groups &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; (the algorithm
+        either returns that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;, or that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;):&lt;/p&gt;
 
-       &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
-       order&lt;/var&gt; is &quot;b before a&quot;&lt;/dt&gt;
+        &lt;ol&gt;
 
-       &lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dd&gt;
+         &lt;li&gt;&lt;p&gt;Let &lt;var&gt;key index&lt;/var&gt; be an index into &lt;var&gt;key heading
+         cells&lt;/var&gt;, initially denoting the first element in the list.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;/dl&gt;
+         &lt;li&gt;&lt;p&gt;Let &lt;var&gt;direction&lt;/var&gt; be a sort direction, initially &lt;i&gt;ascending&lt;/i&gt;. Its
+         other possible value is &lt;i&gt;descending&lt;/i&gt;. When &lt;var&gt;direction&lt;/var&gt; is
+         &lt;i&gt;toggled&lt;/i&gt;, that means that if its value is &lt;i&gt;ascending&lt;/i&gt;, it must be changed to
+         &lt;i&gt;descending&lt;/i&gt;, and when its value is &lt;i&gt;descending&lt;/i&gt;, it must be changed to
+         &lt;i&gt;ascending&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;/li&gt;
+         &lt;li&gt;
 
-    &lt;/ol&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-    &lt;p&gt;When the user agent is required to &lt;dfn data-x=&quot;comparing two row groups using the th
-    element&quot;&gt;compare two row groups using the &lt;code&gt;th&lt;/code&gt; element&lt;/dfn&gt; &lt;var&gt;th&lt;/var&gt;,
-    with &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; being the two row groups respectively, the
-    user agent must run the following steps:&lt;/p&gt;
+          &lt;ol&gt;
 
-    &lt;ol&gt;
+           &lt;li&gt;&lt;p&gt;&lt;i&gt;Column loop&lt;/i&gt;: Let &lt;var&gt;th&lt;/var&gt; be the &lt;var&gt;key index&lt;/var&gt;th
+           &lt;code&gt;th&lt;/code&gt; in &lt;var&gt;key heading cells&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Let &lt;var&gt;x&lt;/var&gt; be the &lt;var&gt;x&lt;/var&gt;-coordinate of the slots that
-     &lt;code&gt;th&lt;/code&gt; covers in its &lt;span data-x=&quot;concept-table&quot;&gt;table&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If &lt;var&gt;th&lt;/var&gt;'s &lt;code data-x=&quot;attr-th-sorted&quot;&gt;sorted&lt;/code&gt; attribute's
+           &lt;span&gt;column sort direction&lt;/span&gt; is &lt;i&gt;reversed&lt;/i&gt;, then toggle &lt;var&gt;direction&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;
+           &lt;li&gt;&lt;p&gt;Let &lt;var&gt;tentative order&lt;/var&gt; be the result of &lt;span&gt;comparing two row groups
+           using the &lt;code&gt;th&lt;/code&gt; element&lt;/span&gt; &lt;var&gt;th&lt;/var&gt;, with &lt;var&gt;a&lt;/var&gt; and
+           &lt;var&gt;b&lt;/var&gt; as the rows.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;span
-      data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; in the first &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; of group
-      &lt;var&gt;a&lt;/var&gt; that covers the slot in that &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; whose
-      &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;If &lt;var&gt;tentative order&lt;/var&gt; is not &quot;equal&quot;, then jump to the step labeled
+           &lt;i&gt;return&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;span
-      data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; in the first &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; of group
-      &lt;var&gt;b&lt;/var&gt; that covers the slot in that &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; whose
-      &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;Increment &lt;var&gt;key index&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;!-- there can't be two cells that cover the slot, unusually, because the only way that can
-      happen is if there's a cell that's extended into this row from above, and the groups, by
-      virtue of the way they are created above, never have cells that extend into them from above.
-      --&gt;
+           &lt;li&gt;&lt;p&gt;If &lt;var&gt;key index&lt;/var&gt; still denotes a &lt;code&gt;th&lt;/code&gt; element in &lt;var&gt;key heading cells&lt;/var&gt;, then jump back to the step above labeled &lt;i&gt;column
+           loop&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;In either case, if there's no &lt;span data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; that actually covers
-      the slot, then use the value &lt;i&gt;null&lt;/i&gt; instead.&lt;/p&gt;
+          &lt;/ol&gt;
 
-     &lt;/li&gt;
+         &lt;/li&gt;
 
-     &lt;li&gt;
+         &lt;li&gt;&lt;p&gt;If &lt;var&gt;a&lt;/var&gt;'s &lt;code&gt;tr&lt;/code&gt; elements precede &lt;var&gt;b&lt;/var&gt;'s in
+         &lt;span&gt;tree order&lt;/span&gt;, then let &lt;var&gt;tentative order&lt;/var&gt; be &quot;a before b&quot;.
+         Otherwise, let &lt;var&gt;tentative order&lt;/var&gt; be &quot;b before a&quot;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be
-      the &lt;span&gt;type and value of the cell&lt;/span&gt; &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, as defined
-      below.&lt;/p&gt;
+         &lt;li&gt;&lt;p&gt;&lt;i&gt;Return&lt;/i&gt;: Return the relative order given by the matching option from the following
+         list:&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be
-      the &lt;span&gt;type and value of the cell&lt;/span&gt; &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, as defined
-      below.&lt;/p&gt;
+          &lt;dl class=&quot;switch&quot;&gt;
 
-      &lt;p&gt;The &lt;dfn&gt;type and value of the cell&lt;/dfn&gt; &lt;var&gt;cell&lt;/var&gt; are computed as follows.&lt;/p&gt;
+           &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;a before b&quot;&lt;/dt&gt;
 
-      &lt;ol&gt;
+           &lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dd&gt;
 
-       &lt;li&gt;&lt;p&gt;If &lt;var&gt;cell&lt;/var&gt; is &lt;i&gt;null&lt;/i&gt;, then the type is &quot;string&quot; and the value is
-       the empty string; abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;li&gt;&lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
-       &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code&gt;data&lt;/code&gt; element, then the value is the value of that
-       &lt;code&gt;data&lt;/code&gt; element's &lt;code data-x=&quot;attr-data-value&quot;&gt;value&lt;/code&gt; attribute, if there is
-       one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+           &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;ascending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;b before a&quot;&lt;/dt&gt;
 
-       &lt;li&gt;&lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
-       &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code&gt;progress&lt;/code&gt; element, then the value is the value of that
-       &lt;code&gt;progress&lt;/code&gt; element's &lt;code data-x=&quot;attr-progress-value&quot;&gt;value&lt;/code&gt; attribute, if
-       there is one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
+           &lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;/dd&gt;
 
-       &lt;li&gt;&lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
-       &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
-       and that child is a &lt;code&gt;meter&lt;/code&gt; element, then the value is the value of that
-       &lt;code&gt;meter&lt;/code&gt; element's &lt;code data-x=&quot;attr-meter-value&quot;&gt;value&lt;/code&gt; attribute, if there is
-       one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-       &lt;li&gt;
+           &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;a before b&quot;&lt;/dt&gt;
 
-        &lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
-        &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one
-        child and that child is a &lt;code&gt;time&lt;/code&gt; element, then the value is the
-        &lt;span&gt;machine-readable equivalent of the element's contents&lt;/span&gt;, if any, and the type is
-        the kind of value that is thus obtained
-       (a &lt;span data-x=&quot;concept-month&quot;&gt;month&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-date&quot;&gt;date&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-yearless-date&quot;&gt;yearless date&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-time&quot;&gt;time&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-timezone&quot;&gt;time-zone offset&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-datetime&quot;&gt;global date and time&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-week&quot;&gt;week&lt;/span&gt;,
-        a year, or
-        a &lt;span data-x=&quot;concept-duration&quot;&gt;duration&lt;/span&gt;);
-        abort these steps after completing this one.&lt;/p&gt;
+           &lt;dd&gt;Return that &lt;var&gt;b&lt;/var&gt; comes before &lt;var&gt;a&lt;/var&gt;.&lt;/dd&gt;
 
-        &lt;p&gt;If there is no machine-readable equivalent, then the type is &quot;string&quot; and the value is
-        the empty string.&lt;/p&gt;
 
-        &lt;p&gt;If the type is
-        a &lt;span data-x=&quot;concept-month&quot;&gt;month&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-date&quot;&gt;date&lt;/span&gt;,
-        a &lt;span data-x=&quot;concept-week&quot;&gt;week&lt;/span&gt;, or
-        a year,
-        then change the value to be the instant in time (with no time zone) that describes the
-        earliest moment that the value represents, and change the type to be
-        a &lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt;.&lt;/p&gt;
+           &lt;dt&gt;If &lt;var&gt;direction&lt;/var&gt; is &lt;i&gt;descending&lt;/i&gt; and &lt;var&gt;tentative
+           order&lt;/var&gt; is &quot;b before a&quot;&lt;/dt&gt;
 
-        &lt;p class=&quot;example&quot;&gt;For example, if the cell was &lt;code
-        data-x=&quot;&quot;&gt;&lt;td&gt;&lt;time&gt;2011-11&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is
-        interpreted as &quot;2011-11-01T00:00:00.000&quot; and the type is treated as a &lt;span
-        data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt; rather than a &lt;span
-        data-x=&quot;concept-month&quot;&gt;month&lt;/span&gt;.&lt;/p&gt;
+           &lt;dd&gt;Return that &lt;var&gt;a&lt;/var&gt; comes before &lt;var&gt;b&lt;/var&gt;.&lt;/dd&gt;
 
-        &lt;p class=&quot;example&quot;&gt;Similarly, if the cell was &lt;code data-x=&quot;&quot;&gt;&lt;td&gt;&lt;time
-        datetime=&quot;2014&quot;&gt;MMXIV&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is interpreted as
-        &quot;2014-01-01T00:00:00.000&quot; and the type is treated as a &lt;span
-        data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt; rather than a year.&lt;/p&gt;
+          &lt;/dl&gt;
 
-       &lt;/li&gt;
+         &lt;/li&gt;
 
-       &lt;li&gt;&lt;p&gt;The value is the element's &lt;code&gt;textContent&lt;/code&gt;. The type is &quot;string&quot;.&lt;/p&gt;&lt;/li&gt;
+        &lt;/ol&gt;
 
-      &lt;/ol&gt;
+        &lt;p&gt;When the user agent is required to &lt;dfn data-x=&quot;comparing two row groups using the th
+        element&quot;&gt;compare two row groups using the &lt;code&gt;th&lt;/code&gt; element&lt;/dfn&gt; &lt;var&gt;th&lt;/var&gt;,
+        with &lt;var&gt;a&lt;/var&gt; and &lt;var&gt;b&lt;/var&gt; being the two row groups respectively, the
+        user agent must run the following steps:&lt;/p&gt;
 
-     &lt;/li&gt;
+        &lt;ol&gt;
 
-     &lt;li&gt;
+         &lt;li&gt;&lt;p&gt;Let &lt;var&gt;x&lt;/var&gt; be the &lt;var&gt;x&lt;/var&gt;-coordinate of the slots that
+         &lt;code&gt;th&lt;/code&gt; covers in its &lt;span data-x=&quot;concept-table&quot;&gt;table&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
-      equal, then: return &quot;a before b&quot; if &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier in the
-      following list than &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, otherwise, return &quot;b before a&quot;;
-      then, abort these steps.&lt;/p&gt;
+         &lt;li&gt;
 
-      &lt;ol class=&quot;brief&quot;&gt;
-       &lt;li&gt;&lt;span data-x=&quot;concept-time&quot;&gt;time&lt;/span&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;span data-x=&quot;concept-yearless-date&quot;&gt;yearless date&lt;/span&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;span data-x=&quot;concept-datetime&quot;&gt;global date and time&lt;/span&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;span data-x=&quot;concept-timezone&quot;&gt;time-zone offset&lt;/span&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;span data-x=&quot;concept-duration&quot;&gt;duration&lt;/span&gt;&lt;/li&gt;
-       &lt;li&gt;&quot;string&quot;&lt;/li&gt;
-      &lt;/ol&gt;
+          &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;span
+          data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; in the first &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; of group
+          &lt;var&gt;a&lt;/var&gt; that covers the slot in that &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; whose
+          &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;/li&gt;
+          &lt;p&gt;Let &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the element corresponding to the &lt;span
+          data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; in the first &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; of group
+          &lt;var&gt;b&lt;/var&gt; that covers the slot in that &lt;span data-x=&quot;concept-row&quot;&gt;row&lt;/span&gt; whose
+          &lt;var&gt;x&lt;/var&gt;-coordinate is &lt;var&gt;x&lt;/var&gt;.&lt;/p&gt;
 
-     &lt;li&gt;&lt;p&gt;If &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are
-     equal, then return &quot;equal&quot; and abort these steps.&lt;/p&gt;&lt;/li&gt;
+          &lt;!-- there can't be two cells that cover the slot, unusually, because the only way that can
+          happen is if there's a cell that's extended into this row from above, and the groups, by
+          virtue of the way they are created above, never have cells that extend into them from above.
+          --&gt;
 
-     &lt;li&gt;
+          &lt;p&gt;In either case, if there's no &lt;span data-x=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; that actually covers
+          the slot, then use the value &lt;i&gt;null&lt;/i&gt; instead.&lt;/p&gt;
 
-      &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
-      &quot;string&quot;, then: if &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier than &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; then return &quot;a before b&quot; and abort these steps, otherwise,
-      return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+         &lt;/li&gt;
 
-      &lt;p&gt;Values sort in their natural order, with the following additional constraints:&lt;/p&gt;
+         &lt;li&gt;
 
-      &lt;p&gt;For &lt;span data-x=&quot;concept-time&quot;&gt;time&lt;/span&gt; values, 00:00:00.000 is the earliest value and
-      23:59:59.999 is the latest value.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be
+          the &lt;span&gt;type and value of the cell&lt;/span&gt; &lt;var&gt;cell&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, as defined
+          below.&lt;/p&gt;
 
-      &lt;p&gt;For &lt;span data-x=&quot;concept-yearless-date&quot;&gt;yearless date&lt;/span&gt; values, 01-01 is the earliest
-      value and 12-31 is the latest value; 02-28 is earlier than 02-29 which is earlier than
-      03-01.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be
+          the &lt;span&gt;type and value of the cell&lt;/span&gt; &lt;var&gt;cell&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, as defined
+          below.&lt;/p&gt;
 
-      &lt;p&gt;Values that are &lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt; compare as
-      if they were in the same time zone.&lt;/p&gt;
+          &lt;p&gt;The &lt;dfn&gt;type and value of the cell&lt;/dfn&gt; &lt;var&gt;cell&lt;/var&gt; are computed as follows.&lt;/p&gt;
 
-      &lt;!-- no ambiguity for &lt;span data-x=&quot;concept-datetime&quot;&gt;global date and time&lt;/span&gt; --&gt;
+          &lt;ol&gt;
 
-      &lt;p&gt;For &lt;span data-x=&quot;concept-timezone&quot;&gt;time-zone offset&lt;/span&gt; values, -23:59 is the earliest
-      value and +23:59 is the latest value.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;If &lt;var&gt;cell&lt;/var&gt; is &lt;i&gt;null&lt;/i&gt;, then the type is &quot;string&quot; and the value is
+           the empty string; abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;!-- MONTHS: &lt;span data-x=&quot;concept-duration&quot;&gt;duration&lt;/span&gt; is unambiguous until we add months --&gt;
+           &lt;li&gt;&lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
+           &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code&gt;data&lt;/code&gt; element, then the value is the value of that
+           &lt;code&gt;data&lt;/code&gt; element's &lt;code data-x=&quot;attr-data-value&quot;&gt;value&lt;/code&gt; attribute, if there is
+           one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-     &lt;/li&gt;
+           &lt;li&gt;&lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
+           &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code&gt;progress&lt;/code&gt; element, then the value is the value of that
+           &lt;code&gt;progress&lt;/code&gt; element's &lt;code data-x=&quot;attr-progress-value&quot;&gt;value&lt;/code&gt; attribute, if
+           there is one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-     &lt;!-- At this point we know that they are both strings and they're not equal. --&gt;
+           &lt;li&gt;&lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
+           &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one child
+           and that child is a &lt;code&gt;meter&lt;/code&gt; element, then the value is the value of that
+           &lt;code&gt;meter&lt;/code&gt; element's &lt;code data-x=&quot;attr-meter-value&quot;&gt;value&lt;/code&gt; attribute, if there is
+           one, or the empty string otherwise; the type is &quot;string&quot;.&lt;/p&gt;
 
-     &lt;li&gt;
+           &lt;li&gt;
 
-      &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the result of &lt;span&gt;parsing the sort
-      key&lt;/span&gt; &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
+            &lt;p&gt;If, ignoring &lt;span&gt;inter-element whitespace&lt;/span&gt; and nodes other than
+            &lt;span&gt;Element&lt;/span&gt; and &lt;span&gt;Text&lt;/span&gt; nodes, &lt;var&gt;cell&lt;/var&gt; has only one
+            child and that child is a &lt;code&gt;time&lt;/code&gt; element, then the value is the
+            &lt;span&gt;machine-readable equivalent of the element's contents&lt;/span&gt;, if any, and the type is
+            the kind of value that is thus obtained
+           (a &lt;span data-x=&quot;concept-month&quot;&gt;month&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-date&quot;&gt;date&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-yearless-date&quot;&gt;yearless date&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-time&quot;&gt;time&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-timezone&quot;&gt;time-zone offset&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-datetime&quot;&gt;global date and time&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-week&quot;&gt;week&lt;/span&gt;,
+            a year, or
+            a &lt;span data-x=&quot;concept-duration&quot;&gt;duration&lt;/span&gt;);
+            abort these steps after completing this one.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the result of &lt;span&gt;parsing the sort
-      key&lt;/span&gt; &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
+            &lt;p&gt;If there is no machine-readable equivalent, then the type is &quot;string&quot; and the value is
+            the empty string.&lt;/p&gt;
 
-      &lt;p&gt;As described below, &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are tuples consisting of a list of &lt;var&gt;n&lt;/var&gt;
-      &lt;i&gt;numbers&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt; &lt;i&gt;number strings&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;non-numeric strings&lt;/i&gt;, and a list of 2&lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;raw
-      strings&lt;/i&gt;, for any non-negative integer value of &lt;var&gt;n&lt;/var&gt; (zero or more).&lt;/p&gt;
+            &lt;p&gt;If the type is
+            a &lt;span data-x=&quot;concept-month&quot;&gt;month&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-date&quot;&gt;date&lt;/span&gt;,
+            a &lt;span data-x=&quot;concept-week&quot;&gt;week&lt;/span&gt;, or
+            a year,
+            then change the value to be the instant in time (with no time zone) that describes the
+            earliest moment that the value represents, and change the type to be
+            a &lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt;.&lt;/p&gt;
 
-     &lt;/li&gt;
+            &lt;p class=&quot;example&quot;&gt;For example, if the cell was &lt;code
+            data-x=&quot;&quot;&gt;&lt;td&gt;&lt;time&gt;2011-11&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is
+            interpreted as &quot;2011-11-01T00:00:00.000&quot; and the type is treated as a &lt;span
+            data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt; rather than a &lt;span
+            data-x=&quot;concept-month&quot;&gt;month&lt;/span&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+            &lt;p class=&quot;example&quot;&gt;Similarly, if the cell was &lt;code data-x=&quot;&quot;&gt;&lt;td&gt;&lt;time
+            datetime=&quot;2014&quot;&gt;MMXIV&lt;/time&gt;&lt;/code&gt; then for sorting purposes the value is interpreted as
+            &quot;2014-01-01T00:00:00.000&quot; and the type is treated as a &lt;span
+            data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt; rather than a year.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
-      comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric
-      string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric string&lt;/i&gt;,
-      in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+           &lt;/li&gt;
 
-      &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
-      these steps.&lt;/p&gt;
+           &lt;li&gt;&lt;p&gt;The value is the element's &lt;code&gt;textContent&lt;/code&gt;. The type is &quot;string&quot;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;/li&gt;
+          &lt;/ol&gt;
 
-     &lt;li&gt;
+         &lt;/li&gt;
 
-      &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; both have exactly one &lt;i&gt;number&lt;/i&gt;, then run these
-      substeps:&lt;/p&gt;
+         &lt;li&gt;
 
-      &lt;ol&gt;
+          &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
+          equal, then: return &quot;a before b&quot; if &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier in the
+          following list than &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, otherwise, return &quot;b before a&quot;;
+          then, abort these steps.&lt;/p&gt;
 
-       &lt;li&gt;
+          &lt;ol class=&quot;brief&quot;&gt;
+           &lt;li&gt;&lt;span data-x=&quot;concept-time&quot;&gt;time&lt;/span&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;span data-x=&quot;concept-yearless-date&quot;&gt;yearless date&lt;/span&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;span data-x=&quot;concept-datetime&quot;&gt;global date and time&lt;/span&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;span data-x=&quot;concept-timezone&quot;&gt;time-zone offset&lt;/span&gt;&lt;/li&gt;
+           &lt;li&gt;&lt;span data-x=&quot;concept-duration&quot;&gt;duration&lt;/span&gt;&lt;/li&gt;
+           &lt;li&gt;&quot;string&quot;&lt;/li&gt;
+          &lt;/ol&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;a before b&quot;.&lt;/p&gt;
+         &lt;/li&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;.&lt;/p&gt;
+         &lt;li&gt;&lt;p&gt;If &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are
+         equal, then return &quot;equal&quot; and abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;/li&gt;
+         &lt;li&gt;
 
-       &lt;li&gt;
+          &lt;p&gt;If &lt;var&gt;type&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;type&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are not
+          &quot;string&quot;, then: if &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; is earlier than &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; then return &quot;a before b&quot; and abort these steps, otherwise,
+          return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
 
-        &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
-        comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
-        string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
-        string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+          &lt;p&gt;Values sort in their natural order, with the following additional constraints:&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-        abort these steps.&lt;/p&gt;
+          &lt;p&gt;For &lt;span data-x=&quot;concept-time&quot;&gt;time&lt;/span&gt; values, 00:00:00.000 is the earliest value and
+          23:59:59.999 is the latest value.&lt;/p&gt;
 
-       &lt;/li&gt;
+          &lt;p&gt;For &lt;span data-x=&quot;concept-yearless-date&quot;&gt;yearless date&lt;/span&gt; values, 01-01 is the earliest
+          value and 12-31 is the latest value; 02-28 is earlier than 02-29 which is earlier than
+          03-01.&lt;/p&gt;
 
-       &lt;li&gt;
+          &lt;p&gt;Values that are &lt;span data-x=&quot;concept-datetime-local&quot;&gt;local date and time&lt;/span&gt; compare as
+          if they were in the same time zone.&lt;/p&gt;
 
-        &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
-        comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt; and
-        &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+          &lt;!-- no ambiguity for &lt;span data-x=&quot;concept-datetime&quot;&gt;global date and time&lt;/span&gt; --&gt;
 
-        &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-        abort these steps.&lt;/p&gt;
+          &lt;p&gt;For &lt;span data-x=&quot;concept-timezone&quot;&gt;time-zone offset&lt;/span&gt; values, -23:59 is the earliest
+          value and +23:59 is the latest value.&lt;/p&gt;
 
-       &lt;/li&gt;
+          &lt;!-- MONTHS: &lt;span data-x=&quot;concept-duration&quot;&gt;duration&lt;/span&gt; is unambiguous until we add months --&gt;
 
-      &lt;/ol&gt;
+         &lt;/li&gt;
 
-      &lt;p&gt;Otherwise, run these substeps:&lt;/p&gt;
+         &lt;!-- At this point we know that they are both strings and they're not equal. --&gt;
 
-      &lt;ol&gt;
+         &lt;li&gt;
 
-       &lt;li&gt;
+          &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; be the result of &lt;span&gt;parsing the sort
+          key&lt;/span&gt; &lt;var&gt;value&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;a before
-        b&quot;.&lt;/p&gt;
+          &lt;p&gt;Let &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; be the result of &lt;span&gt;parsing the sort
+          key&lt;/span&gt; &lt;var&gt;value&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;b before
-        a&quot;.&lt;/p&gt;
+          &lt;p&gt;As described below, &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; are tuples consisting of a list of &lt;var&gt;n&lt;/var&gt;
+          &lt;i&gt;numbers&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt; &lt;i&gt;number strings&lt;/i&gt;, a list of &lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;non-numeric strings&lt;/i&gt;, and a list of 2&lt;var&gt;n&lt;/var&gt;+1 &lt;i&gt;raw
+          strings&lt;/i&gt;, for any non-negative integer value of &lt;var&gt;n&lt;/var&gt; (zero or more).&lt;/p&gt;
 
-       &lt;/li&gt;
+         &lt;/li&gt;
 
-       &lt;li&gt;
+         &lt;li&gt;
 
-        &lt;!-- either an=bn=0, an=1 bn&gt;1, bn=1 an&gt;1, or an and bn &gt; 1. --&gt;
+          &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
+          comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric
+          string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s first &lt;i&gt;non-numeric string&lt;/i&gt;,
+          in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;a before
-        b&quot;.&lt;/p&gt;
+          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
+          these steps.&lt;/p&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;b before
-        a&quot;.&lt;/p&gt;
+         &lt;/li&gt;
 
-       &lt;/li&gt;
+         &lt;li&gt;
 
-       &lt;li&gt;
+          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; both have exactly one &lt;i&gt;number&lt;/i&gt;, then run these
+          substeps:&lt;/p&gt;
 
-        &lt;!-- either an=bn=0, or an and bn &gt; 1. --&gt;
+          &lt;ol&gt;
 
-        &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; have more than one &lt;i&gt;number&lt;/i&gt;, run these substeps:&lt;/p&gt;
+           &lt;li&gt;
 
-        &lt;ol&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;a before b&quot;.&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;Let &lt;var&gt;count&lt;/var&gt; be the smaller of the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;.&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;For each &lt;i&gt;number&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; from the first to the &lt;var&gt;count&lt;/var&gt;th, in
-         order: if &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, then return &quot;a before b&quot; and abort
-         these steps; otherwise, if &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is
-         less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;
-         and abort these steps.&lt;/p&gt;&lt;/li&gt;
+           &lt;/li&gt;
 
-         &lt;li&gt;
+           &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return &quot;a before b&quot; and abort these steps.&lt;/p&gt;
+            &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
+            comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
+            string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s second &lt;i&gt;non-numeric
+            string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-          &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+            abort these steps.&lt;/p&gt;
 
-         &lt;/li&gt;
+           &lt;/li&gt;
 
-         &lt;!-- at this point, we know /a/ and /b/ have the same number of components --&gt;
+           &lt;li&gt;
 
-         &lt;li&gt;&lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;&lt;/li&gt;
+            &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
+            comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt; and
+            &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+            abort these steps.&lt;/p&gt;
 
-          &lt;p&gt;&lt;i&gt;String loop&lt;/i&gt;: Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific
-          string comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt;,
-          in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+           &lt;/li&gt;
 
-          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-          abort these steps.&lt;/p&gt;
+          &lt;/ol&gt;
 
-         &lt;/li&gt;
+          &lt;p&gt;Otherwise, run these substeps:&lt;/p&gt;
 
-         &lt;li&gt;
+          &lt;ol&gt;
 
-          &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+           &lt;li&gt;
 
-         &lt;/li&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;a before
+            b&quot;.&lt;/p&gt;
 
-         &lt;li&gt;
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has zero &lt;i&gt;numbers&lt;/i&gt; but &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has more than zero &lt;i&gt;numbers&lt;/i&gt;, return &quot;b before
+            a&quot;.&lt;/p&gt;
 
-          &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
-          comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator
-          string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+           &lt;/li&gt;
 
-          &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
-          abort these steps.&lt;/p&gt;
+           &lt;li&gt;
 
+            &lt;!-- either an=bn=0, an=1 bn&gt;1, bn=1 an&gt;1, or an and bn &gt; 1. --&gt;
+
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;a before
+            b&quot;.&lt;/p&gt;
+
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has one &lt;i&gt;number&lt;/i&gt;, return &quot;b before
+            a&quot;.&lt;/p&gt;
+
+           &lt;/li&gt;
+
+           &lt;li&gt;
+
+            &lt;!-- either an=bn=0, or an and bn &gt; 1. --&gt;
+
+            &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; have more than one &lt;i&gt;number&lt;/i&gt;, run these substeps:&lt;/p&gt;
+
+            &lt;ol&gt;
+
+             &lt;li&gt;&lt;p&gt;Let &lt;var&gt;count&lt;/var&gt; be the smaller of the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+             &lt;li&gt;&lt;p&gt;For each &lt;i&gt;number&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; from the first to the &lt;var&gt;count&lt;/var&gt;th, in
+             order: if &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is less than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, then return &quot;a before b&quot; and abort
+             these steps; otherwise, if &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt; is
+             less than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;i&gt;number&lt;/i&gt;, return &quot;b before a&quot;
+             and abort these steps.&lt;/p&gt;&lt;/li&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return &quot;a before b&quot; and abort these steps.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt; has fewer &lt;i&gt;numbers&lt;/i&gt; than &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;, return &quot;b before a&quot; and abort these steps.&lt;/p&gt;
+
+             &lt;/li&gt;
+
+             &lt;!-- at this point, we know /a/ and /b/ have the same number of components --&gt;
+
+             &lt;li&gt;&lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;&lt;/li&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;&lt;i&gt;String loop&lt;/i&gt;: Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific
+              string comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;number string&lt;/i&gt;,
+              in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+              abort these steps.&lt;/p&gt;
+
+             &lt;/li&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+
+             &lt;/li&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;locale-specific string
+              comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;index&lt;/var&gt;th &lt;i&gt;separator
+              string&lt;/i&gt;, in the context of &lt;var&gt;th&lt;/var&gt;.&lt;/p&gt;
+
+              &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and
+              abort these steps.&lt;/p&gt;
+
+             &lt;/li&gt;
+
+             &lt;li&gt;
+
+              &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, jump back
+              to the step labeled &lt;i&gt;string loop&lt;/i&gt;.&lt;/p&gt;
+
+             &lt;/li&gt;
+
+            &lt;/ol&gt;
+
+           &lt;/li&gt;
+
+          &lt;/ol&gt;
+
          &lt;/li&gt;
 
          &lt;li&gt;
 
-          &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;numbers&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return
-          to the step labeled &lt;i&gt;string loop&lt;/i&gt;.&lt;/p&gt;
+          &lt;!-- at this point, we know /a/ and /b/ have the same number of components --&gt;
 
+          &lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;
+
          &lt;/li&gt;
 
-        &lt;/ol&gt;
+         &lt;li&gt;
 
-       &lt;/li&gt;
+          &lt;p&gt;Run these substeps:&lt;/p&gt;
 
-      &lt;/ol&gt;
+          &lt;ol&gt;
 
-     &lt;/li&gt;
+           &lt;li&gt;
 
-     &lt;li&gt;
+            &lt;p&gt;&lt;i&gt;Final loop:&lt;/i&gt; Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;raw string
+            comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
+            &lt;i&gt;raw string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
+            &lt;i&gt;raw string&lt;/i&gt;.&lt;/p&gt;
 
-      &lt;!-- at this point, we know /a/ and /b/ have the same number of components --&gt;
+            &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
+            these steps.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var&gt;index&lt;/var&gt; be zero.&lt;/p&gt;
+           &lt;/li&gt;
 
-     &lt;/li&gt;
+           &lt;li&gt;
 
-     &lt;li&gt;
+            &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p&gt;&lt;i&gt;Final loop:&lt;/i&gt; Let &lt;var&gt;order&lt;/var&gt; be the result of a &lt;span&gt;raw string
-      comparison&lt;/span&gt; of &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
-      &lt;i&gt;raw string&lt;/i&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;'s &lt;var&gt;n&lt;/var&gt;th
-      &lt;i&gt;raw string&lt;/i&gt;.&lt;/p&gt;
+           &lt;/li&gt;
 
-      &lt;p&gt;If &lt;var&gt;order&lt;/var&gt; is not &quot;equal&quot; then return &lt;var&gt;order&lt;/var&gt; and abort
-      these steps.&lt;/p&gt;
+           &lt;li&gt;
 
-     &lt;/li&gt;
+            &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;raw strings&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, jump back
+            to the step labeled &lt;i&gt;final loop&lt;/i&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+           &lt;/li&gt;
 
-      &lt;p&gt;Increment &lt;var&gt;index&lt;/var&gt;.&lt;/p&gt;
+          &lt;/ol&gt;
 
-     &lt;/li&gt;
+         &lt;/li&gt;
 
-     &lt;li&gt;
+         &lt;li&gt;
 
-      &lt;p&gt;If &lt;var&gt;index&lt;/var&gt; is less than the number of &lt;i&gt;raw strings&lt;/i&gt; in &lt;var&gt;components&lt;sub&gt;a&lt;/sub&gt;&lt;/var&gt; and &lt;var&gt;components&lt;sub&gt;b&lt;/sub&gt;&lt;/var&gt;, return
-      to the step labeled &lt;i&gt;final loop&lt;/i&gt;.&lt;/p&gt;
+          &lt;p&gt;Return &quot;equal&quot;.&lt;/p&gt;
 
-     &lt;/li&gt;
+         &lt;/li&gt;
 
-     &lt;li&gt;
+        &lt;/ol&gt;
 
-      &lt;p&gt;Return &quot;equal&quot;.&lt;/p&gt;
+       &lt;/li&gt;
 
-     &lt;/li&gt;
 
-    &lt;/ol&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var&gt;new order&lt;/var&gt; be a list of &lt;code&gt;tr&lt;/code&gt; elements consisting of the
+       &lt;code&gt;tr&lt;/code&gt; elements of all the groups in the newly ordered &lt;var&gt;groups&lt;/var&gt;, with
+       the &lt;code&gt;tr&lt;/code&gt; elements being in the same order as the groups to which they belong are in
+       &lt;var&gt;groups&lt;/var&gt;, and the &lt;code&gt;tr&lt;/code&gt; elements within each such group themselves
+       being ordered in &lt;span&gt;tree order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;&lt;span data-x=&quot;concept-node-remove&quot;&gt;Remove&lt;/span&gt; all the &lt;code&gt;tr&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; from their parents, in &lt;span&gt;tree order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
+       &lt;li&gt;&lt;p&gt;&lt;span data-x=&quot;concept-node-insert&quot;&gt;Insert&lt;/span&gt; all the &lt;code&gt;tr&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; into the DOM at the location of &lt;var&gt;insertion point&lt;/var&gt;, in
+       the order these elements are found in &lt;var&gt;new order&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;new order&lt;/var&gt; be a list of &lt;code&gt;tr&lt;/code&gt; elements consisting of the
-   &lt;code&gt;tr&lt;/code&gt; elements of all the groups in the newly ordered &lt;var&gt;groups&lt;/var&gt;, with
-   the &lt;code&gt;tr&lt;/code&gt; elements being in the same order as the groups to which they belong are in
-   &lt;var&gt;groups&lt;/var&gt;, and the &lt;code&gt;tr&lt;/code&gt; elements within each such group themselves
-   being ordered in &lt;span&gt;tree order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;!-- done with this set of rows --&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span data-x=&quot;concept-node-remove&quot;&gt;Remove&lt;/span&gt; all the &lt;code&gt;tr&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; from their parents, in &lt;span&gt;tree order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Remove &lt;var&gt;insertion point&lt;/var&gt; from the DOM.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span data-x=&quot;concept-node-insert&quot;&gt;Insert&lt;/span&gt; all the &lt;code&gt;tr&lt;/code&gt; elements in &lt;var&gt;new order&lt;/var&gt; into the DOM at the location of &lt;var&gt;insertion point&lt;/var&gt;, in
-   the order these elements are found in &lt;var&gt;new order&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+      &lt;/ol&gt;
 
-   &lt;!-- done with this set of rows --&gt;
+     &lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Remove &lt;var&gt;insertion point&lt;/var&gt; from the DOM.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;i&gt;Increment loop&lt;/i&gt;: If there are no &lt;code&gt;tr&lt;/code&gt; or &lt;code&gt;tbody&lt;/code&gt; children of
+     &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
+     collection cursor&lt;/var&gt;, then jump to the step labeled &lt;i&gt;end&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Increment loop&lt;/i&gt;: If there are no &lt;code&gt;tr&lt;/code&gt; or &lt;code&gt;tbody&lt;/code&gt; children of
-   &lt;var&gt;table&lt;/var&gt; that are later siblings of the element pointed to by &lt;var&gt;row
-   collection cursor&lt;/var&gt;, then jump to the step labeled &lt;i&gt;end&lt;/i&gt; below.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code&gt;tr&lt;/code&gt; or
+     &lt;code&gt;tbody&lt;/code&gt; child of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element
+     pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var&gt;row collection cursor&lt;/var&gt; point to the next &lt;code&gt;tr&lt;/code&gt; or
-   &lt;code&gt;tbody&lt;/code&gt; child of &lt;var&gt;table&lt;/var&gt; that is a later sibling of the element
-   pointed to by &lt;var&gt;row collection cursor&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Jump back to the step labeled &lt;i&gt;row loop&lt;/i&gt; above.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;row loop&lt;/i&gt; above.&lt;/p&gt;&lt;/li&gt;
+    &lt;/ol&gt;
 
+   &lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;&lt;i&gt;End&lt;/i&gt;: Set &lt;var&gt;table&lt;/var&gt;'s &lt;span&gt;currently-sorting flag&lt;/span&gt; to
    false.&lt;/p&gt;&lt;/li&gt;
 

</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023387.html">[html5] r8783 - [giow] (1) Fix IDL blocks due to my	misunderstanding what 'optional' meant Fixin [...]
</A></li>
	<LI>Next message: <A HREF="023389.html">[html5] r8785 - [giow] (3) Add the select() method to input types	that might have text fields bu [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23388">[ date ]</a>
              <a href="thread.html#23388">[ thread ]</a>
              <a href="subject.html#23388">[ subject ]</a>
              <a href="author.html#23388">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
