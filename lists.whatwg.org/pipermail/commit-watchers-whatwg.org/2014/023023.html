<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r8406 - [e] (0) Rearrange how Document objects are	initialized and created to make thing [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8406%20-%20%5Be%5D%20%280%29%20Rearrange%20how%20Document%20objects%20are%0A%09initialized%20and%20created%20to%20make%20thing%20%5B...%5D&In-Reply-To=%3C20140117180547.02DAFC3C5954%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r8406 - [e] (0) Rearrange how Document objects are	initialized and created to make thing [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8406%20-%20%5Be%5D%20%280%29%20Rearrange%20how%20Document%20objects%20are%0A%09initialized%20and%20created%20to%20make%20thing%20%5B...%5D&In-Reply-To=%3C20140117180547.02DAFC3C5954%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r8406 - [e] (0) Rearrange how Document objects are	initialized and created to make thing [...]">whatwg at whatwg.org
       </A><BR>
    <I>Fri Jan 17 10:05:47 PST 2014</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23023">[ date ]</a>
              <a href="thread.html#23023">[ thread ]</a>
              <a href="subject.html#23023">[ subject ]</a>
              <a href="author.html#23023">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2014-01-17 10:05:45 -0800 (Fri, 17 Jan 2014)
New Revision: 8406

Modified:
   complete.html
   index
   source
Log:
[e] (0) Rearrange how Document objects are initialized and created to make things a little clearer
Affected topics: HTML, HTML Syntax and Parsing

Modified: complete.html
===================================================================
--- complete.html	2014-01-17 08:12:26 UTC (rev 8405)
+++ complete.html	2014-01-17 18:05:45 UTC (rev 8406)
@@ -67153,10 +67153,11 @@
    (even if it is empty), then &lt;a href=#scroll-to-fragid title=navigate-fragid&gt;navigate to that fragment
    identifier&lt;/a&gt; and abort these steps.&lt;/li&gt;
 
+&lt;!--CLEANUP--&gt;
    &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;gone async&lt;/var&gt; is false, cancel any preexisting but not yet &lt;a href=#concept-navigate-mature title=concept-navigate-mature&gt;mature&lt;/a&gt; attempt to navigate the &lt;a href=#browsing-context&gt;browsing
    context&lt;/a&gt;, including canceling any instances of the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm started by
-   those attempts. If one of those attempts has already &lt;a href=#create-a-document-object title=&quot;create a document
-   object&quot;&gt;created a new &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, &lt;a href=#abort-a-document title=&quot;abort a
+   those attempts. If one of those attempts has already created and &lt;a href=#initialize-the-document-object title=&quot;initialize the document
+   object&quot;&gt;initialized a new &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, &lt;a href=#abort-a-document title=&quot;abort a
    document&quot;&gt;abort&lt;/a&gt; that &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; also. (Navigation attempts that have &lt;a href=#concept-navigate-mature title=concept-navigate-mature&gt;matured&lt;/a&gt; already have session history entries, and are
    therefore handled during the &lt;a href=#update-the-session-history-with-the-new-page&gt;update the session history with the new page&lt;/a&gt; algorithm,
    later.)&lt;/li&gt;
@@ -67427,8 +67428,9 @@
     The user agent may indicate to the user that the original page load failed, and that the page
     used was a previously cached resource.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p class=note&gt;This does not affect the &lt;i&gt;address of the resource from which Request-URIs are
-    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#create-a-document-object&gt;create a Document
+    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt;
     object&lt;/a&gt; steps below; they still use the value as computed by the original
     &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm.&lt;/p&gt;
 
@@ -67461,8 +67463,9 @@
     failed, that the page used was a fallback resource, and what the URL of the fallback resource
     actually is.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p class=note&gt;This does not affect the &lt;i&gt;address of the resource from which Request-URIs are
-    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#create-a-document-object&gt;create a Document
+    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt;
     object&lt;/a&gt; steps below; they still use the value as computed by the original
     &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm.&lt;/p&gt;
 
@@ -67572,9 +67575,9 @@
     &lt;p class=note&gt;An &lt;a href=#override-url title=&quot;override URL&quot;&gt;override URL&lt;/a&gt; is set when &lt;a href=#javascript-protocol title=&quot;javascript protocol&quot;&gt;dereferencing a &lt;code&gt;javascript:&lt;/code&gt; URL&lt;/a&gt; and when
     performing &lt;a href=#an-overridden-reload&gt;an overridden reload&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;&lt;dfn id=create-a-document-object title=&quot;create a Document object&quot;&gt;Creating a new &lt;code&gt;Document&lt;/code&gt; object&lt;/dfn&gt;: when
-    a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is created as part of the above steps, the user agent must additionally
-    run the following algorithm as part of creating the new object:&lt;/p&gt;
+    &lt;p&gt;&lt;dfn id=initialize-the-document-object title=&quot;initialize the Document object&quot;&gt;Initializing a new &lt;code&gt;Document&lt;/code&gt;
+    object&lt;/dfn&gt;: when a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is created as part of the above steps, the user agent
+    will be required to additionally run the following algorithm after creating the new object:&lt;/p&gt;
 
     &lt;ol&gt;&lt;li&gt;&lt;p&gt;Create a new &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object, and associate it with the
      &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, with one exception: if the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s only entry in
@@ -67714,10 +67717,12 @@
 
   &lt;h4 id=read-html&gt;&lt;span class=secno&gt;6.6.2 &lt;/span&gt;&lt;dfn title=navigate-html&gt;Page load processing model for HTML files&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When an HTML document is to be loaded in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent must
-  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being
+  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as being
   an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to &quot;&lt;code title=&quot;&quot;&gt;text/html&lt;/code&gt;&quot;,
-  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, and associate it with the document. Each &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; places on the
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, and finally
+  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt; and associate it with the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;. Each &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; places on the
   &lt;a href=#task-queue&gt;task queue&lt;/a&gt; while the &lt;a href=#fetch title=fetch&gt;fetching algorithm&lt;/a&gt; runs must then
   fill the parser's &lt;a href=#the-input-byte-stream&gt;input byte stream&lt;/a&gt; with the fetched bytes and cause the &lt;a href=#html-parser&gt;HTML
   parser&lt;/a&gt; to perform the appropriate processing of the input stream.&lt;/p&gt;
@@ -67745,10 +67750,17 @@
 
   &lt;h4 id=read-xml&gt;&lt;span class=secno&gt;6.6.3 &lt;/span&gt;&lt;dfn title=navigate-xml&gt;Page load processing model for XML files&lt;/dfn&gt;&lt;/h4&gt;
 
-  &lt;p&gt;When faced with displaying an XML file inline, user agents must first &lt;a href=#create-a-document-object&gt;create a
-  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, following the requirements of the XML and Namespaces in XML
-  recommendations, RFC 3023, DOM, and other relevant specifications. &lt;a href=#refsXML&gt;[XML]&lt;/a&gt; &lt;a href=#refsXMLNS&gt;[XMLNS]&lt;/a&gt; &lt;a href=#refsRFC3023&gt;[RFC3023]&lt;/a&gt; &lt;a href=#refsDOM&gt;[DOM]&lt;/a&gt;&lt;/p&gt;
+&lt;!--CLEANUP--&gt;
+  &lt;p&gt;When faced with displaying an XML file inline, user agents must follow the requirements defined
+  in the XML and Namespaces in XML recommendations, RFC 3023, DOM, and other relevant specifications
+  to create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object and a corresponding &lt;a href=#xml-parser&gt;XML parser&lt;/a&gt;. &lt;a href=#refsXML&gt;[XML]&lt;/a&gt; &lt;a href=#refsXMLNS&gt;[XMLNS]&lt;/a&gt; &lt;a href=#refsRFC3023&gt;[RFC3023]&lt;/a&gt; &lt;a href=#refsDOM&gt;[DOM]&lt;/a&gt;&lt;/p&gt;
 
+  &lt;p class=note&gt;At the time of writing, the XML specification community had not actually yet
+  specified how XML and the DOM interact.&lt;/p&gt; &lt;!--XMLPARSE--&gt;
+
+  &lt;p&gt;After the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is created, the user agent must &lt;a href=#initialize-the-document-object&gt;initialize the
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;.&lt;/p&gt;
+
   &lt;p&gt;The actual HTTP headers and other metadata, not the headers as mutated or implied by the
   algorithms given in this specification, are the ones that must be used when determining the
   character encoding according to the rules given in the above specifications. Once the character
@@ -67789,10 +67801,12 @@
 
   &lt;h4 id=read-text&gt;&lt;span class=secno&gt;6.6.4 &lt;/span&gt;&lt;dfn title=navigate-text&gt;Page load processing model for text files&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a plain text document is to be loaded in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent
-  must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as
+  must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as
   being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to &quot;&lt;code title=&quot;&quot;&gt;text/plain&lt;/code&gt;&quot;,
-  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, associate it with the document, act as if the tokenizer had
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;,
+  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, associate it with the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, act as if the tokenizer had
   emitted a start tag token with the tag name &quot;pre&quot; followed by a single U+000A LINE FEED (LF)
   character&lt;!-- to get eaten, so that a leading LF in the text/plain stream doesn't get eaten
   itself--&gt;, and switch the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT
@@ -67841,10 +67855,11 @@
   &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent must parse the resource using the rules for
   multipart types. &lt;a href=#refsRFC2046&gt;[RFC2046]&lt;/a&gt;&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;For each body part obtained from the resource, the user agent must run a new instance of the
   &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm, starting from the &lt;i&gt;resource handling&lt;/i&gt; step, using the new
   body part as the resource being navigated, with &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt; if a previous
-  body part from the same resource resulted in a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object being &lt;a href=#create-a-document-object title=&quot;create a document object&quot;&gt;created&lt;/a&gt;, and otherwise using the same setup as the
+  body part from the same resource resulted in a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object being created and &lt;a href=#initialize-the-document-object title=&quot;initialize the document object&quot;&gt;initialized&lt;/a&gt;, and otherwise using the same setup as the
   &lt;a href=#navigate&gt;navigate&lt;/a&gt; attempt that caused this section to be invoked in the first place.&lt;/p&gt;
 
   &lt;p&gt;For the purposes of algorithms processing these body parts as if they were complete stand-alone
@@ -67856,9 +67871,11 @@
 
   &lt;h4 id=read-media&gt;&lt;span class=secno&gt;6.6.6 &lt;/span&gt;&lt;dfn title=navigate-media&gt;Page load processing model for media&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When an image, video, or audio resource is to be loaded in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the
-  user agent should &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to the sniffed MIME type of the resource
-  (&lt;var title=&quot;&quot;&gt;type&lt;/var&gt; in the &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm), append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt;
+  user agent should create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to the sniffed MIME type of the resource
+  (&lt;var title=&quot;&quot;&gt;type&lt;/var&gt; in the &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm), &lt;a href=#initialize-the-document-object&gt;initialize the
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt;
   element to the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, append a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt;
   element to the &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append an element &lt;var title=&quot;&quot;&gt;host element&lt;/var&gt; for
   the media, as described below, to the &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set the appropriate attribute
@@ -67898,12 +67915,14 @@
 
   &lt;h4 id=read-plugin&gt;&lt;span class=secno&gt;6.6.7 &lt;/span&gt;&lt;dfn title=navigate-plugin&gt;Page load processing model for content that uses plugins&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a resource that requires an external resource to be rendered is to be loaded in a
-  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent should &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt;
-  object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt; and mark it
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent should create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
+  object, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt; and mark it
   as being a &lt;dfn id=plugin-document&gt;plugin document&lt;/dfn&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content
   type&lt;/a&gt; to the sniffed MIME type of the resource (&lt;var title=&quot;&quot;&gt;type&lt;/var&gt; in the
-  &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm), append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the
+  &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm),
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the
   &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, append a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element to the
   &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; to the &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set
   the &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element to the
@@ -67937,9 +67956,11 @@
   &lt;h4 id=read-ua-inline&gt;&lt;span class=secno&gt;6.6.8 &lt;/span&gt;&lt;dfn title=navigate-ua-inline&gt;Page load processing model for inline
   content that doesn't have a DOM&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When the user agent is to display a user agent page inline in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;,
-  the user agent should &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an
+  the user agent should create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as being an
   &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to &quot;&lt;code title=&quot;&quot;&gt;text/html&lt;/code&gt;&quot;,
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;,
   and then either associate that &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; with a custom rendering that is not rendered
   using the normal &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; rendering rules, or mutate that &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; until
   it represents the content the user agent wants to render.&lt;/p&gt;
@@ -93196,7 +93217,7 @@
   the rules given in the XML specification to map a string of bytes or characters into a
   &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
-  &lt;p class=note&gt;At the time of writing, no such rules actually exist.&lt;/p&gt;
+  &lt;p class=note&gt;At the time of writing, no such rules actually exist.&lt;/p&gt;&lt;!--XMLPARSE--&gt;
 
   &lt;p&gt;An &lt;a href=#xml-parser&gt;XML parser&lt;/a&gt; is either associated with a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object when it is
   created, or creates one implicitly.&lt;/p&gt;

Modified: index
===================================================================
--- index	2014-01-17 08:12:26 UTC (rev 8405)
+++ index	2014-01-17 18:05:45 UTC (rev 8406)
@@ -67153,10 +67153,11 @@
    (even if it is empty), then &lt;a href=#scroll-to-fragid title=navigate-fragid&gt;navigate to that fragment
    identifier&lt;/a&gt; and abort these steps.&lt;/li&gt;
 
+&lt;!--CLEANUP--&gt;
    &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;gone async&lt;/var&gt; is false, cancel any preexisting but not yet &lt;a href=#concept-navigate-mature title=concept-navigate-mature&gt;mature&lt;/a&gt; attempt to navigate the &lt;a href=#browsing-context&gt;browsing
    context&lt;/a&gt;, including canceling any instances of the &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm started by
-   those attempts. If one of those attempts has already &lt;a href=#create-a-document-object title=&quot;create a document
-   object&quot;&gt;created a new &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, &lt;a href=#abort-a-document title=&quot;abort a
+   those attempts. If one of those attempts has already created and &lt;a href=#initialize-the-document-object title=&quot;initialize the document
+   object&quot;&gt;initialized a new &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, &lt;a href=#abort-a-document title=&quot;abort a
    document&quot;&gt;abort&lt;/a&gt; that &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; also. (Navigation attempts that have &lt;a href=#concept-navigate-mature title=concept-navigate-mature&gt;matured&lt;/a&gt; already have session history entries, and are
    therefore handled during the &lt;a href=#update-the-session-history-with-the-new-page&gt;update the session history with the new page&lt;/a&gt; algorithm,
    later.)&lt;/li&gt;
@@ -67427,8 +67428,9 @@
     The user agent may indicate to the user that the original page load failed, and that the page
     used was a previously cached resource.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p class=note&gt;This does not affect the &lt;i&gt;address of the resource from which Request-URIs are
-    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#create-a-document-object&gt;create a Document
+    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt;
     object&lt;/a&gt; steps below; they still use the value as computed by the original
     &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm.&lt;/p&gt;
 
@@ -67461,8 +67463,9 @@
     failed, that the page used was a fallback resource, and what the URL of the fallback resource
     actually is.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p class=note&gt;This does not affect the &lt;i&gt;address of the resource from which Request-URIs are
-    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#create-a-document-object&gt;create a Document
+    obtained&lt;/i&gt;, as used to set &lt;a href=&quot;#the-document's-referrer&quot;&gt;the document's referrer&lt;/a&gt; in the &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt;
     object&lt;/a&gt; steps below; they still use the value as computed by the original
     &lt;a href=#fetch&gt;fetch&lt;/a&gt; algorithm.&lt;/p&gt;
 
@@ -67572,9 +67575,9 @@
     &lt;p class=note&gt;An &lt;a href=#override-url title=&quot;override URL&quot;&gt;override URL&lt;/a&gt; is set when &lt;a href=#javascript-protocol title=&quot;javascript protocol&quot;&gt;dereferencing a &lt;code&gt;javascript:&lt;/code&gt; URL&lt;/a&gt; and when
     performing &lt;a href=#an-overridden-reload&gt;an overridden reload&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;&lt;dfn id=create-a-document-object title=&quot;create a Document object&quot;&gt;Creating a new &lt;code&gt;Document&lt;/code&gt; object&lt;/dfn&gt;: when
-    a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is created as part of the above steps, the user agent must additionally
-    run the following algorithm as part of creating the new object:&lt;/p&gt;
+    &lt;p&gt;&lt;dfn id=initialize-the-document-object title=&quot;initialize the Document object&quot;&gt;Initializing a new &lt;code&gt;Document&lt;/code&gt;
+    object&lt;/dfn&gt;: when a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is created as part of the above steps, the user agent
+    will be required to additionally run the following algorithm after creating the new object:&lt;/p&gt;
 
     &lt;ol&gt;&lt;li&gt;&lt;p&gt;Create a new &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object, and associate it with the
      &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, with one exception: if the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s only entry in
@@ -67714,10 +67717,12 @@
 
   &lt;h4 id=read-html&gt;&lt;span class=secno&gt;6.6.2 &lt;/span&gt;&lt;dfn title=navigate-html&gt;Page load processing model for HTML files&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When an HTML document is to be loaded in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent must
-  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being
+  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as being
   an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to &quot;&lt;code title=&quot;&quot;&gt;text/html&lt;/code&gt;&quot;,
-  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, and associate it with the document. Each &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; places on the
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, and finally
+  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt; and associate it with the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;. Each &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; places on the
   &lt;a href=#task-queue&gt;task queue&lt;/a&gt; while the &lt;a href=#fetch title=fetch&gt;fetching algorithm&lt;/a&gt; runs must then
   fill the parser's &lt;a href=#the-input-byte-stream&gt;input byte stream&lt;/a&gt; with the fetched bytes and cause the &lt;a href=#html-parser&gt;HTML
   parser&lt;/a&gt; to perform the appropriate processing of the input stream.&lt;/p&gt;
@@ -67745,10 +67750,17 @@
 
   &lt;h4 id=read-xml&gt;&lt;span class=secno&gt;6.6.3 &lt;/span&gt;&lt;dfn title=navigate-xml&gt;Page load processing model for XML files&lt;/dfn&gt;&lt;/h4&gt;
 
-  &lt;p&gt;When faced with displaying an XML file inline, user agents must first &lt;a href=#create-a-document-object&gt;create a
-  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, following the requirements of the XML and Namespaces in XML
-  recommendations, RFC 3023, DOM, and other relevant specifications. &lt;a href=#refsXML&gt;[XML]&lt;/a&gt; &lt;a href=#refsXMLNS&gt;[XMLNS]&lt;/a&gt; &lt;a href=#refsRFC3023&gt;[RFC3023]&lt;/a&gt; &lt;a href=#refsDOM&gt;[DOM]&lt;/a&gt;&lt;/p&gt;
+&lt;!--CLEANUP--&gt;
+  &lt;p&gt;When faced with displaying an XML file inline, user agents must follow the requirements defined
+  in the XML and Namespaces in XML recommendations, RFC 3023, DOM, and other relevant specifications
+  to create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object and a corresponding &lt;a href=#xml-parser&gt;XML parser&lt;/a&gt;. &lt;a href=#refsXML&gt;[XML]&lt;/a&gt; &lt;a href=#refsXMLNS&gt;[XMLNS]&lt;/a&gt; &lt;a href=#refsRFC3023&gt;[RFC3023]&lt;/a&gt; &lt;a href=#refsDOM&gt;[DOM]&lt;/a&gt;&lt;/p&gt;
 
+  &lt;p class=note&gt;At the time of writing, the XML specification community had not actually yet
+  specified how XML and the DOM interact.&lt;/p&gt; &lt;!--XMLPARSE--&gt;
+
+  &lt;p&gt;After the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is created, the user agent must &lt;a href=#initialize-the-document-object&gt;initialize the
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;.&lt;/p&gt;
+
   &lt;p&gt;The actual HTTP headers and other metadata, not the headers as mutated or implied by the
   algorithms given in this specification, are the ones that must be used when determining the
   character encoding according to the rules given in the above specifications. Once the character
@@ -67789,10 +67801,12 @@
 
   &lt;h4 id=read-text&gt;&lt;span class=secno&gt;6.6.4 &lt;/span&gt;&lt;dfn title=navigate-text&gt;Page load processing model for text files&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a plain text document is to be loaded in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent
-  must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as
+  must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as
   being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to &quot;&lt;code title=&quot;&quot;&gt;text/plain&lt;/code&gt;&quot;,
-  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, associate it with the document, act as if the tokenizer had
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;,
+  create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, associate it with the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, act as if the tokenizer had
   emitted a start tag token with the tag name &quot;pre&quot; followed by a single U+000A LINE FEED (LF)
   character&lt;!-- to get eaten, so that a leading LF in the text/plain stream doesn't get eaten
   itself--&gt;, and switch the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT
@@ -67841,10 +67855,11 @@
   &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent must parse the resource using the rules for
   multipart types. &lt;a href=#refsRFC2046&gt;[RFC2046]&lt;/a&gt;&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;For each body part obtained from the resource, the user agent must run a new instance of the
   &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm, starting from the &lt;i&gt;resource handling&lt;/i&gt; step, using the new
   body part as the resource being navigated, with &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt; if a previous
-  body part from the same resource resulted in a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object being &lt;a href=#create-a-document-object title=&quot;create a document object&quot;&gt;created&lt;/a&gt;, and otherwise using the same setup as the
+  body part from the same resource resulted in a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object being created and &lt;a href=#initialize-the-document-object title=&quot;initialize the document object&quot;&gt;initialized&lt;/a&gt;, and otherwise using the same setup as the
   &lt;a href=#navigate&gt;navigate&lt;/a&gt; attempt that caused this section to be invoked in the first place.&lt;/p&gt;
 
   &lt;p&gt;For the purposes of algorithms processing these body parts as if they were complete stand-alone
@@ -67856,9 +67871,11 @@
 
   &lt;h4 id=read-media&gt;&lt;span class=secno&gt;6.6.6 &lt;/span&gt;&lt;dfn title=navigate-media&gt;Page load processing model for media&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When an image, video, or audio resource is to be loaded in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the
-  user agent should &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to the sniffed MIME type of the resource
-  (&lt;var title=&quot;&quot;&gt;type&lt;/var&gt; in the &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm), append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt;
+  user agent should create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to the sniffed MIME type of the resource
+  (&lt;var title=&quot;&quot;&gt;type&lt;/var&gt; in the &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm), &lt;a href=#initialize-the-document-object&gt;initialize the
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt;
   element to the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, append a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt;
   element to the &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append an element &lt;var title=&quot;&quot;&gt;host element&lt;/var&gt; for
   the media, as described below, to the &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set the appropriate attribute
@@ -67898,12 +67915,14 @@
 
   &lt;h4 id=read-plugin&gt;&lt;span class=secno&gt;6.6.7 &lt;/span&gt;&lt;dfn title=navigate-plugin&gt;Page load processing model for content that uses plugins&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a resource that requires an external resource to be rendered is to be loaded in a
-  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent should &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt;
-  object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt; and mark it
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent should create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
+  object, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt; and mark it
   as being a &lt;dfn id=plugin-document&gt;plugin document&lt;/dfn&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content
   type&lt;/a&gt; to the sniffed MIME type of the resource (&lt;var title=&quot;&quot;&gt;type&lt;/var&gt; in the
-  &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm), append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the
+  &lt;a href=#navigate&gt;navigate&lt;/a&gt; algorithm),
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the
   &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, append a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element to the
   &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; to the &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set
   the &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element to the
@@ -67937,9 +67956,11 @@
   &lt;h4 id=read-ua-inline&gt;&lt;span class=secno&gt;6.6.8 &lt;/span&gt;&lt;dfn title=navigate-ua-inline&gt;Page load processing model for inline
   content that doesn't have a DOM&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When the user agent is to display a user agent page inline in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;,
-  the user agent should &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an
+  the user agent should create a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object, mark it as being an
   &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, set its &lt;a href=#concept-document-content-type title=concept-document-content-type&gt;content type&lt;/a&gt; to &quot;&lt;code title=&quot;&quot;&gt;text/html&lt;/code&gt;&quot;,
+  &lt;a href=#initialize-the-document-object&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;,
   and then either associate that &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; with a custom rendering that is not rendered
   using the normal &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; rendering rules, or mutate that &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; until
   it represents the content the user agent wants to render.&lt;/p&gt;
@@ -93196,7 +93217,7 @@
   the rules given in the XML specification to map a string of bytes or characters into a
   &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
 
-  &lt;p class=note&gt;At the time of writing, no such rules actually exist.&lt;/p&gt;
+  &lt;p class=note&gt;At the time of writing, no such rules actually exist.&lt;/p&gt;&lt;!--XMLPARSE--&gt;
 
   &lt;p&gt;An &lt;a href=#xml-parser&gt;XML parser&lt;/a&gt; is either associated with a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; object when it is
   created, or creates one implicitly.&lt;/p&gt;

Modified: source
===================================================================
--- source	2014-01-17 08:12:26 UTC (rev 8405)
+++ source	2014-01-17 18:05:45 UTC (rev 8406)
@@ -74860,11 +74860,12 @@
    (even if it is empty), then &lt;span data-x=&quot;navigate-fragid&quot;&gt;navigate to that fragment
    identifier&lt;/span&gt; and abort these steps.&lt;/p&gt;&lt;/li&gt;
 
+&lt;!--CLEANUP--&gt;
    &lt;li&gt;&lt;p&gt;If &lt;var data-x=&quot;&quot;&gt;gone async&lt;/var&gt; is false, cancel any preexisting but not yet &lt;span
    data-x=&quot;concept-navigate-mature&quot;&gt;mature&lt;/span&gt; attempt to navigate the &lt;span&gt;browsing
    context&lt;/span&gt;, including canceling any instances of the &lt;span&gt;fetch&lt;/span&gt; algorithm started by
-   those attempts. If one of those attempts has already &lt;span data-x=&quot;create a document
-   object&quot;&gt;created a new &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, &lt;span data-x=&quot;abort a
+   those attempts. If one of those attempts has already created and &lt;span data-x=&quot;initialize the document
+   object&quot;&gt;initialized a new &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, &lt;span data-x=&quot;abort a
    document&quot;&gt;abort&lt;/span&gt; that &lt;code&gt;Document&lt;/code&gt; also. (Navigation attempts that have &lt;span
    data-x=&quot;concept-navigate-mature&quot;&gt;matured&lt;/span&gt; already have session history entries, and are
    therefore handled during the &lt;span&gt;update the session history with the new page&lt;/span&gt; algorithm,
@@ -75165,8 +75166,9 @@
     The user agent may indicate to the user that the original page load failed, and that the page
     used was a previously cached resource.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p class=&quot;note&quot;&gt;This does not affect the &lt;i&gt;address of the resource from which Request-URIs are
-    obtained&lt;/i&gt;, as used to set &lt;span&gt;the document's referrer&lt;/span&gt; in the &lt;span&gt;create a Document
+    obtained&lt;/i&gt;, as used to set &lt;span&gt;the document's referrer&lt;/span&gt; in the &lt;span&gt;initialize the &lt;code&gt;Document&lt;/code&gt;
     object&lt;/span&gt; steps below; they still use the value as computed by the original
     &lt;span&gt;fetch&lt;/span&gt; algorithm.&lt;/p&gt;
 
@@ -75203,8 +75205,9 @@
     failed, that the page used was a fallback resource, and what the URL of the fallback resource
     actually is.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p class=&quot;note&quot;&gt;This does not affect the &lt;i&gt;address of the resource from which Request-URIs are
-    obtained&lt;/i&gt;, as used to set &lt;span&gt;the document's referrer&lt;/span&gt; in the &lt;span&gt;create a Document
+    obtained&lt;/i&gt;, as used to set &lt;span&gt;the document's referrer&lt;/span&gt; in the &lt;span&gt;initialize the &lt;code&gt;Document&lt;/code&gt;
     object&lt;/span&gt; steps below; they still use the value as computed by the original
     &lt;span&gt;fetch&lt;/span&gt; algorithm.&lt;/p&gt;
 
@@ -75326,9 +75329,9 @@
     data-x=&quot;javascript protocol&quot;&gt;dereferencing a &lt;code&gt;javascript:&lt;/code&gt; URL&lt;/span&gt; and when
     performing &lt;span&gt;an overridden reload&lt;/span&gt;.&lt;/p&gt;
 
-    &lt;p&gt;&lt;dfn data-x=&quot;create a Document object&quot;&gt;Creating a new &lt;code&gt;Document&lt;/code&gt; object&lt;/dfn&gt;: when
-    a &lt;code&gt;Document&lt;/code&gt; is created as part of the above steps, the user agent must additionally
-    run the following algorithm as part of creating the new object:&lt;/p&gt;
+    &lt;p&gt;&lt;dfn data-x=&quot;initialize the Document object&quot;&gt;Initializing a new &lt;code&gt;Document&lt;/code&gt;
+    object&lt;/dfn&gt;: when a &lt;code&gt;Document&lt;/code&gt; is created as part of the above steps, the user agent
+    will be required to additionally run the following algorithm after creating the new object:&lt;/p&gt;
 
     &lt;ol&gt;
 
@@ -75494,11 +75497,13 @@
 
   &lt;h4 id=&quot;read-html&quot;&gt;&lt;dfn data-x=&quot;navigate-html&quot;&gt;Page load processing model for HTML files&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When an HTML document is to be loaded in a &lt;span&gt;browsing context&lt;/span&gt;, the user agent must
-  &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being
+  &lt;span&gt;queue a task&lt;/span&gt; to create a &lt;code&gt;Document&lt;/code&gt; object, mark it as being
   an &lt;span data-x=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, set its &lt;span
   data-x=&quot;concept-document-content-type&quot;&gt;content type&lt;/span&gt; to &quot;&lt;code data-x=&quot;&quot;&gt;text/html&lt;/code&gt;&quot;,
-  create an &lt;span&gt;HTML parser&lt;/span&gt;, and associate it with the document. Each &lt;span
+  &lt;span&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, and finally
+  create an &lt;span&gt;HTML parser&lt;/span&gt; and associate it with the &lt;code&gt;Document&lt;/code&gt;. Each &lt;span
   data-x=&quot;concept-task&quot;&gt;task&lt;/span&gt; that the &lt;span&gt;networking task source&lt;/span&gt; places on the
   &lt;span&gt;task queue&lt;/span&gt; while the &lt;span data-x=&quot;fetch&quot;&gt;fetching algorithm&lt;/span&gt; runs must then
   fill the parser's &lt;span&gt;input byte stream&lt;/span&gt; with the fetched bytes and cause the &lt;span&gt;HTML
@@ -75529,12 +75534,19 @@
 
   &lt;h4 id=&quot;read-xml&quot;&gt;&lt;dfn data-x=&quot;navigate-xml&quot;&gt;Page load processing model for XML files&lt;/dfn&gt;&lt;/h4&gt;
 
-  &lt;p&gt;When faced with displaying an XML file inline, user agents must first &lt;span&gt;create a
-  &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, following the requirements of the XML and Namespaces in XML
-  recommendations, RFC 3023, DOM, and other relevant specifications. &lt;a href=&quot;#refsXML&quot;&gt;[XML]&lt;/a&gt; &lt;a
-  href=&quot;#refsXMLNS&quot;&gt;[XMLNS]&lt;/a&gt; &lt;a href=&quot;#refsRFC3023&quot;&gt;[RFC3023]&lt;/a&gt; &lt;a
+&lt;!--CLEANUP--&gt;
+  &lt;p&gt;When faced with displaying an XML file inline, user agents must follow the requirements defined
+  in the XML and Namespaces in XML recommendations, RFC 3023, DOM, and other relevant specifications
+  to create a &lt;code&gt;Document&lt;/code&gt; object and a corresponding &lt;span&gt;XML parser&lt;/span&gt;. &lt;a
+  href=&quot;#refsXML&quot;&gt;[XML]&lt;/a&gt; &lt;a href=&quot;#refsXMLNS&quot;&gt;[XMLNS]&lt;/a&gt; &lt;a href=&quot;#refsRFC3023&quot;&gt;[RFC3023]&lt;/a&gt; &lt;a
   href=&quot;#refsDOM&quot;&gt;[DOM]&lt;/a&gt;&lt;/p&gt;
 
+  &lt;p class=&quot;note&quot;&gt;At the time of writing, the XML specification community had not actually yet
+  specified how XML and the DOM interact.&lt;/p&gt; &lt;!--XMLPARSE--&gt;
+
+  &lt;p&gt;After the &lt;code&gt;Document&lt;/code&gt; is created, the user agent must &lt;span&gt;initialize the
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;.&lt;/p&gt;
+
   &lt;p&gt;The actual HTTP headers and other metadata, not the headers as mutated or implied by the
   algorithms given in this specification, are the ones that must be used when determining the
   character encoding according to the rules given in the above specifications. Once the character
@@ -75580,11 +75592,13 @@
 
   &lt;h4 id=&quot;read-text&quot;&gt;&lt;dfn data-x=&quot;navigate-text&quot;&gt;Page load processing model for text files&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a plain text document is to be loaded in a &lt;span&gt;browsing context&lt;/span&gt;, the user agent
-  must &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as
+  must &lt;span&gt;queue a task&lt;/span&gt; to create a &lt;code&gt;Document&lt;/code&gt; object, mark it as
   being an &lt;span data-x=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, set its &lt;span
   data-x=&quot;concept-document-content-type&quot;&gt;content type&lt;/span&gt; to &quot;&lt;code data-x=&quot;&quot;&gt;text/plain&lt;/code&gt;&quot;,
-  create an &lt;span&gt;HTML parser&lt;/span&gt;, associate it with the document, act as if the tokenizer had
+  &lt;span&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;,
+  create an &lt;span&gt;HTML parser&lt;/span&gt;, associate it with the &lt;code&gt;Document&lt;/code&gt;, act as if the tokenizer had
   emitted a start tag token with the tag name &quot;pre&quot; followed by a single U+000A LINE FEED (LF)
   character&lt;!-- to get eaten, so that a leading LF in the text/plain stream doesn't get eaten
   itself--&gt;, and switch the &lt;span&gt;HTML parser&lt;/span&gt;'s tokenizer to the &lt;span&gt;PLAINTEXT
@@ -75636,11 +75650,12 @@
   &lt;span&gt;browsing context&lt;/span&gt;, the user agent must parse the resource using the rules for
   multipart types. &lt;a href=&quot;#refsRFC2046&quot;&gt;[RFC2046]&lt;/a&gt;&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;For each body part obtained from the resource, the user agent must run a new instance of the
   &lt;span&gt;navigate&lt;/span&gt; algorithm, starting from the &lt;i&gt;resource handling&lt;/i&gt; step, using the new
   body part as the resource being navigated, with &lt;span&gt;replacement enabled&lt;/span&gt; if a previous
-  body part from the same resource resulted in a &lt;code&gt;Document&lt;/code&gt; object being &lt;span
-  data-x=&quot;create a document object&quot;&gt;created&lt;/span&gt;, and otherwise using the same setup as the
+  body part from the same resource resulted in a &lt;code&gt;Document&lt;/code&gt; object being created and &lt;span
+  data-x=&quot;initialize the document object&quot;&gt;initialized&lt;/span&gt;, and otherwise using the same setup as the
   &lt;span&gt;navigate&lt;/span&gt; attempt that caused this section to be invoked in the first place.&lt;/p&gt;
 
   &lt;p&gt;For the purposes of algorithms processing these body parts as if they were complete stand-alone
@@ -75653,11 +75668,13 @@
 
   &lt;h4 id=&quot;read-media&quot;&gt;&lt;dfn data-x=&quot;navigate-media&quot;&gt;Page load processing model for media&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When an image, video, or audio resource is to be loaded in a &lt;span&gt;browsing context&lt;/span&gt;, the
-  user agent should &lt;span&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being an &lt;span
+  user agent should create a &lt;code&gt;Document&lt;/code&gt; object, mark it as being an &lt;span
   data-x=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, set its &lt;span
   data-x=&quot;concept-document-content-type&quot;&gt;content type&lt;/span&gt; to the sniffed MIME type of the resource
-  (&lt;var data-x=&quot;&quot;&gt;type&lt;/var&gt; in the &lt;span&gt;navigate&lt;/span&gt; algorithm), append an &lt;code&gt;html&lt;/code&gt;
+  (&lt;var data-x=&quot;&quot;&gt;type&lt;/var&gt; in the &lt;span&gt;navigate&lt;/span&gt; algorithm), &lt;span&gt;initialize the
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, append an &lt;code&gt;html&lt;/code&gt;
   element to the &lt;code&gt;Document&lt;/code&gt;, append a &lt;code&gt;head&lt;/code&gt; element and a &lt;code&gt;body&lt;/code&gt;
   element to the &lt;code&gt;html&lt;/code&gt; element, append an element &lt;var data-x=&quot;&quot;&gt;host element&lt;/var&gt; for
   the media, as described below, to the &lt;code&gt;body&lt;/code&gt; element, and set the appropriate attribute
@@ -75704,12 +75721,14 @@
 
   &lt;h4 id=&quot;read-plugin&quot;&gt;&lt;dfn data-x=&quot;navigate-plugin&quot;&gt;Page load processing model for content that uses plugins&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a resource that requires an external resource to be rendered is to be loaded in a
-  &lt;span&gt;browsing context&lt;/span&gt;, the user agent should &lt;span&gt;create a &lt;code&gt;Document&lt;/code&gt;
-  object&lt;/span&gt;, mark it as being an &lt;span data-x=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt; and mark it
+  &lt;span&gt;browsing context&lt;/span&gt;, the user agent should create a &lt;code&gt;Document&lt;/code&gt;
+  object, mark it as being an &lt;span data-x=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt; and mark it
   as being a &lt;dfn&gt;plugin document&lt;/dfn&gt;, set its &lt;span data-x=&quot;concept-document-content-type&quot;&gt;content
   type&lt;/span&gt; to the sniffed MIME type of the resource (&lt;var data-x=&quot;&quot;&gt;type&lt;/var&gt; in the
-  &lt;span&gt;navigate&lt;/span&gt; algorithm), append an &lt;code&gt;html&lt;/code&gt; element to the
+  &lt;span&gt;navigate&lt;/span&gt; algorithm),
+  &lt;span&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, append an &lt;code&gt;html&lt;/code&gt; element to the
   &lt;code&gt;Document&lt;/code&gt;, append a &lt;code&gt;head&lt;/code&gt; element and a &lt;code&gt;body&lt;/code&gt; element to the
   &lt;code&gt;html&lt;/code&gt; element, append an &lt;code&gt;embed&lt;/code&gt; to the &lt;code&gt;body&lt;/code&gt; element, and set
   the &lt;code data-x=&quot;attr-embed-src&quot;&gt;src&lt;/code&gt; attribute of the &lt;code&gt;embed&lt;/code&gt; element to the
@@ -75744,10 +75763,12 @@
   &lt;h4 id=&quot;read-ua-inline&quot;&gt;&lt;dfn data-x=&quot;navigate-ua-inline&quot;&gt;Page load processing model for inline
   content that doesn't have a DOM&lt;/dfn&gt;&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When the user agent is to display a user agent page inline in a &lt;span&gt;browsing context&lt;/span&gt;,
-  the user agent should &lt;span&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being an
+  the user agent should create a &lt;code&gt;Document&lt;/code&gt; object, mark it as being an
   &lt;span data-x=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, set its &lt;span
   data-x=&quot;concept-document-content-type&quot;&gt;content type&lt;/span&gt; to &quot;&lt;code data-x=&quot;&quot;&gt;text/html&lt;/code&gt;&quot;,
+  &lt;span&gt;initialize the &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;,
   and then either associate that &lt;code&gt;Document&lt;/code&gt; with a custom rendering that is not rendered
   using the normal &lt;code&gt;Document&lt;/code&gt; rendering rules, or mutate that &lt;code&gt;Document&lt;/code&gt; until
   it represents the content the user agent wants to render.&lt;/p&gt;
@@ -103939,7 +103960,7 @@
   the rules given in the XML specification to map a string of bytes or characters into a
   &lt;code&gt;Document&lt;/code&gt; object.&lt;/p&gt;
 
-  &lt;p class=&quot;note&quot;&gt;At the time of writing, no such rules actually exist.&lt;/p&gt;
+  &lt;p class=&quot;note&quot;&gt;At the time of writing, no such rules actually exist.&lt;/p&gt;&lt;!--XMLPARSE--&gt;
 
   &lt;p&gt;An &lt;span&gt;XML parser&lt;/span&gt; is either associated with a &lt;code&gt;Document&lt;/code&gt; object when it is
   created, or creates one implicitly.&lt;/p&gt;


</PRE>
<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23023">[ date ]</a>
              <a href="thread.html#23023">[ thread ]</a>
              <a href="subject.html#23023">[ subject ]</a>
              <a href="author.html#23023">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
