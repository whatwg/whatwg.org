<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r1140 - /
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1140%20-%20/&In-Reply-To=%3C20071211011417.E86F413A14C%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008047.html">
   <LINK REL="Next"  HREF="008049.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r1140 - /</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1140%20-%20/&In-Reply-To=%3C20071211011417.E86F413A14C%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r1140 - /">whatwg at whatwg.org
       </A><BR>
    <I>Mon Dec 10 17:14:17 PST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="008047.html">[html5] r1139 - /
</A></li>
        <LI>Next message: <A HREF="008049.html">[html5] r1141 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8048">[ date ]</a>
              <a href="thread.html#8048">[ thread ]</a>
              <a href="subject.html#8048">[ subject ]</a>
              <a href="author.html#8048">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2007-12-10 17:14:16 -0800 (Mon, 10 Dec 2007)
New Revision: 1140

Modified:
   header-whatwg
   index
   source
Log:
[ag] (2) Massive changes to globalStorage to remove the multi-domain security model and replace it with the much simpler same-origin model.

Modified: header-whatwg
===================================================================
--- header-whatwg	2007-12-05 05:48:38 UTC (rev 1139)
+++ header-whatwg	2007-12-11 01:14:16 UTC (rev 1140)
@@ -2,7 +2,7 @@
 &lt;html lang=&quot;en-GB-hixie&quot;&gt;
  &lt;head&gt;
   &lt;title&gt;HTML 5&lt;/title&gt;
-  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/style/specification&quot;&gt;
+  &lt;link rel=&quot;stylesheet&quot; href=&quot;/style/specification&quot;&gt;
   &lt;link rel=&quot;icon&quot; href=&quot;/images/icon&quot;&gt;
   &lt;style type=&quot;text/css&quot;&gt;
    h4 + .element { margin-top: -2.5em; padding-top: 2em; }
@@ -12,8 +12,10 @@
    table.matrix, table.matrix td { border: none; text-align: right; }
    table.matrix { margin-left: 2em; }
   &lt;/style&gt;
+  &lt;link rel=&quot;stylesheet&quot; href=&quot;status.css&quot;&gt;
+  &lt;script src=&quot;status.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
- &lt;body class=&quot;draft&quot;&gt;
+ &lt;body class=&quot;draft&quot; onload=&quot;initAnnotations()&quot;&gt;
 
   &lt;div class=&quot;head&quot;&gt;
    &lt;p&gt;&lt;a rel=&quot;home&quot; href=&quot;<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A>&quot; class=&quot;logo&quot;&gt;&lt;img alt=&quot;WHATWG&quot; src=&quot;/images/logo&quot;&gt;&lt;/a&gt;&lt;/p&gt;
@@ -34,6 +36,7 @@
     &lt;dd&gt;Commit-Watchers mailing list: &lt;a href=&quot;<A HREF="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org</A>&quot;&gt;<A HREF="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org&lt;/a">http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org&lt;/a</A>&gt;&lt;/dd&gt;
     &lt;dd&gt;Interactive Web interface: &lt;a href=&quot;<A HREF="http://html5.org/tools/web-apps-tracker">http://html5.org/tools/web-apps-tracker</A>&quot;&gt;<A HREF="http://html5.org/tools/web-apps-tracker&lt;/a">http://html5.org/tools/web-apps-tracker&lt;/a</A>&gt;&lt;/dd&gt;
     &lt;dd&gt;Subversion interface: &lt;a href=&quot;<A HREF="http://svn.whatwg.org/">http://svn.whatwg.org/</A>&quot;&gt;<A HREF="http://svn.whatwg.org/&lt;/a">http://svn.whatwg.org/&lt;/a</A>&gt;&lt;/dd&gt;
+    &lt;dd&gt;HTML diff with the last version in Subversion: &lt;a href=&quot;index-diff&quot;&gt;<A HREF="http://whatwg.org/specs/web-apps/current-work/index-diff&lt;/a">http://whatwg.org/specs/web-apps/current-work/index-diff&lt;/a</A>&gt;&lt;/dd&gt;
     &lt;dt&gt;Editor:&lt;/dt&gt;
     &lt;dd&gt;Ian Hickson, Google, <A HREF="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">ian at hixie.ch</A>&lt;/dd&gt;
    &lt;/dl&gt;

Modified: index
===================================================================
--- index	2007-12-05 05:48:38 UTC (rev 1139)
+++ index	2007-12-11 01:14:16 UTC (rev 1140)
@@ -3,7 +3,7 @@
 &lt;html lang=en-GB-hixie&gt;
  &lt;head&gt;
   &lt;title&gt;HTML 5&lt;/title&gt;
-  &lt;link href=&quot;/style/specification&quot; rel=stylesheet type=&quot;text/css&quot;&gt;
+  &lt;link href=&quot;/style/specification&quot; rel=stylesheet&gt;
   &lt;link href=&quot;/images/icon&quot; rel=icon&gt;
 
   &lt;style type=&quot;text/css&quot;&gt;
@@ -14,15 +14,18 @@
    table.matrix, table.matrix td { border: none; text-align: right; }
    table.matrix { margin-left: 2em; }
   &lt;/style&gt;
+  &lt;link href=status.css rel=stylesheet&gt;
+  &lt;script src=status.js&gt;&lt;/script&gt;
 
- &lt;body class=draft&gt;
+ &lt;body class=draft onload=&quot;initAnnotations()&quot;&gt;
   &lt;div class=head&gt;
    &lt;p&gt;&lt;a class=logo href=&quot;<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A>&quot; rel=home&gt;&lt;img alt=WHATWG
     src=&quot;/images/logo&quot;&gt;&lt;/a&gt;&lt;/p&gt;
 
    &lt;h1 id=html-5&gt;HTML 5&lt;/h1&gt;
 
-   &lt;h2 class=&quot;no-num no-toc&quot; id=working&gt;Working Draft &mdash; 5 December 2007&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=working&gt;Working Draft &mdash; 11 December
+    2007&lt;/h2&gt;
 
    &lt;p&gt;You can take part in this work. &lt;a
     href=&quot;<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&quot;&gt;Join the working group's
@@ -67,6 +70,9 @@
     &lt;dd&gt;Subversion interface: &lt;a
      href=&quot;<A HREF="http://svn.whatwg.org/">http://svn.whatwg.org/</A>&quot;&gt;<A HREF="http://svn.whatwg.org/&lt;/a">http://svn.whatwg.org/&lt;/a</A>&gt;
 
+    &lt;dd&gt;HTML diff with the last version in Subversion: &lt;a
+     href=index-diff&gt;<A HREF="http://whatwg.org/specs/web-apps/current-work/index-diff&lt;/a">http://whatwg.org/specs/web-apps/current-work/index-diff&lt;/a</A>&gt;
+
     &lt;dt&gt;Editor:
 
     &lt;dd&gt;Ian Hickson, Google, <A HREF="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">ian at hixie.ch</A>
@@ -1151,61 +1157,42 @@
        &lt;li&gt;&lt;a href=&quot;#the-storage&quot;&gt;&lt;span class=secno&gt;4.10.2. &lt;/span&gt;The
         &lt;code&gt;Storage&lt;/code&gt; interface&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-storageitem&quot;&gt;&lt;span class=secno&gt;4.10.3. &lt;/span&gt;The
-        &lt;code&gt;StorageItem&lt;/code&gt; interface&lt;/a&gt;
-
-       &lt;li&gt;&lt;a href=&quot;#the-sessionstorage&quot;&gt;&lt;span class=secno&gt;4.10.4. &lt;/span&gt;The
+       &lt;li&gt;&lt;a href=&quot;#the-sessionstorage&quot;&gt;&lt;span class=secno&gt;4.10.3. &lt;/span&gt;The
         &lt;code title=dom-sessionStorage&gt;sessionStorage&lt;/code&gt; attribute&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-globalstorage&quot;&gt;&lt;span class=secno&gt;4.10.5. &lt;/span&gt;The
+       &lt;li&gt;&lt;a href=&quot;#the-globalstorage&quot;&gt;&lt;span class=secno&gt;4.10.4. &lt;/span&gt;The
         &lt;code title=dom-globalStorage&gt;globalStorage&lt;/code&gt; attribute&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-storage0&quot;&gt;&lt;span class=secno&gt;4.10.6. &lt;/span&gt;The &lt;code
+       &lt;li&gt;&lt;a href=&quot;#the-storage0&quot;&gt;&lt;span class=secno&gt;4.10.5. &lt;/span&gt;The &lt;code
         title=event-storage&gt;storage&lt;/code&gt; event&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#miscellaneous0&quot;&gt;&lt;span class=secno&gt;4.10.7.
+       &lt;li&gt;&lt;a href=&quot;#miscellaneous0&quot;&gt;&lt;span class=secno&gt;4.10.6.
         &lt;/span&gt;Miscellaneous implementation requirements for storage
         areas&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#disk-space&quot;&gt;&lt;span class=secno&gt;4.10.7.1. &lt;/span&gt;Disk
+         &lt;li&gt;&lt;a href=&quot;#disk-space&quot;&gt;&lt;span class=secno&gt;4.10.6.1. &lt;/span&gt;Disk
           space&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#threads0&quot;&gt;&lt;span class=secno&gt;4.10.7.2.
+         &lt;li&gt;&lt;a href=&quot;#threads0&quot;&gt;&lt;span class=secno&gt;4.10.6.2.
           &lt;/span&gt;Threads&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#security5&quot;&gt;&lt;span class=secno&gt;4.10.8. &lt;/span&gt;Security and
+       &lt;li&gt;&lt;a href=&quot;#security5&quot;&gt;&lt;span class=secno&gt;4.10.7. &lt;/span&gt;Security and
         privacy&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#user-tracking&quot;&gt;&lt;span class=secno&gt;4.10.8.1. &lt;/span&gt;User
+         &lt;li&gt;&lt;a href=&quot;#user-tracking&quot;&gt;&lt;span class=secno&gt;4.10.7.1. &lt;/span&gt;User
           tracking&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#cookie&quot;&gt;&lt;span class=secno&gt;4.10.8.2. &lt;/span&gt;Cookie
+         &lt;li&gt;&lt;a href=&quot;#cookie&quot;&gt;&lt;span class=secno&gt;4.10.7.2. &lt;/span&gt;Cookie
           resurrection&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#integrity&quot;&gt;&lt;span class=secno&gt;4.10.8.3.
-          &lt;/span&gt;Integrity of &quot;public&quot; storage areas&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#cross-protocol&quot;&gt;&lt;span class=secno&gt;4.10.8.4.
-          &lt;/span&gt;Cross-protocol and cross-port attacks&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#dns-spoofing&quot;&gt;&lt;span class=secno&gt;4.10.8.5. &lt;/span&gt;DNS
+         &lt;li&gt;&lt;a href=&quot;#dns-spoofing&quot;&gt;&lt;span class=secno&gt;4.10.7.3. &lt;/span&gt;DNS
           spoofing attacks&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#cross-directory&quot;&gt;&lt;span class=secno&gt;4.10.8.6.
+         &lt;li&gt;&lt;a href=&quot;#cross-directory&quot;&gt;&lt;span class=secno&gt;4.10.7.4.
           &lt;/span&gt;Cross-directory attacks&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#public&quot;&gt;&lt;span class=secno&gt;4.10.8.7. &lt;/span&gt;Public
-          storage areas corresponding to hosts&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#storage0&quot;&gt;&lt;span class=secno&gt;4.10.8.8. &lt;/span&gt;Storage
-          areas in the face of untrusted higher-level domains that do not
-          correspond to public storage areas&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#storage1&quot;&gt;&lt;span class=secno&gt;4.10.8.9. &lt;/span&gt;Storage
-          areas in the face of untrusted subdomains&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#implementation&quot;&gt;&lt;span class=secno&gt;4.10.8.10.
+         &lt;li&gt;&lt;a href=&quot;#implementation&quot;&gt;&lt;span class=secno&gt;4.10.7.5.
           &lt;/span&gt;Implementation risks&lt;/a&gt;
         &lt;/ul&gt;
       &lt;/ul&gt;
@@ -24804,8 +24791,8 @@
 
   // the user agent
   readonly attribute &lt;a href=&quot;#clientinformation&quot;&gt;ClientInformation&lt;/a&gt; &lt;a href=&quot;#navigator&quot; title=dom-navigator&gt;navigator&lt;/a&gt;; &lt;!-- XXX IE6 also has window.clientInformation pointing to this same object --&gt;
-  readonly attribute &lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt; &lt;a href=&quot;#sessionstorage&quot; title=dom-sessionStorage&gt;sessionStorage&lt;/a&gt;;
-  readonly attribute &lt;a href=&quot;#storagelist&quot;&gt;StorageList&lt;/a&gt; &lt;a href=&quot;#globalstorage&quot; title=dom-globalStorage&gt;globalStorage&lt;/a&gt;;
+  readonly attribute &lt;a href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt; &lt;a href=&quot;#sessionstorage&quot; title=dom-sessionStorage&gt;sessionStorage&lt;/a&gt;;
+  readonly attribute &lt;a href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt; &lt;a href=&quot;#globalstorage&quot; title=dom-globalStorage&gt;globalStorage&lt;/a&gt;;
   &lt;a href=&quot;#database0&quot;&gt;Database&lt;/a&gt; &lt;a href=&quot;#opendatabase&quot; title=dom-opendatabase&gt;openDatabase&lt;/a&gt;(in DOMString name, in DOMString version, in DOMString displayName, in unsigned long estimatedSize);
 
   // modal user prompts
@@ -29573,7 +29560,7 @@
    title=dom-sessionStorage&gt;&lt;a
    href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; DOM attribute. Sites can
    add data to the session storage, and it will be accessible to any page
-   from that domain opened in that window.
+   from that &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; opened in that window.
 
   &lt;div class=example&gt;
    &lt;p&gt;For example, a page could have a checkbox that the user ticks to
@@ -29617,7 +29604,7 @@
 
   &lt;p&gt;The &lt;code title=dom-globalStorage&gt;&lt;a
    href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt; DOM attribute is used to
-   access the global storage areas.
+   access a page's global storage area.
 
   &lt;div class=example&gt;
    &lt;p&gt;The site at example.com can display a count of how many times the user
@@ -29629,80 +29616,55 @@
   time(s).
 &lt;/p&gt;
 &lt;script&gt;
-  var storage = globalStorage['example.com'];
-  if (!storage.pageLoadCount)
-    storage.pageLoadCount = 0;
-  storage.pageLoadCount = parseInt(storage.pageLoadCount, 10) + 1;
-  document.getElementById('count').textContent = storage.pageLoadCount;
+  if (!globalStorage.pageLoadCount)
+    globalStorage.pageLoadCount = 0;
+  globalStorage.pageLoadCount = parseInt(globalStorage.pageLoadCount, 10) + 1;
+  document.getElementById('count').textContent = globalStorage.pageLoadCount;
 &lt;/script&gt;&lt;/pre&gt;
   &lt;/div&gt;
 
-  &lt;p&gt;Each domain and each subdomain has its own separate storage area.
-   Subdomains can access the storage areas of parent domains, and domains can
-   access the storage areas of subdomains.
+  &lt;p&gt;Each &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; has its own separate storage area.
 
-  &lt;ul class=brief&gt;
-   &lt;li&gt;&lt;code&gt;globalStorage['']&lt;/code&gt; is accessible to all domains.
-
-   &lt;li&gt;&lt;code&gt;globalStorage['com']&lt;/code&gt; is accessible to all .com domains
-
-   &lt;li&gt;&lt;code&gt;globalStorage['example.com']&lt;/code&gt; is accessible to example.com
-    and any of its subdomains
-
-   &lt;li&gt;&lt;code&gt;globalStorage['www.example.com']&lt;/code&gt; is accessible to
-    www.example.com and example.com, but not www2.example.com.
-  &lt;/ul&gt;
-
   &lt;p&gt;Storage areas (both session storage and global storage) store strings.
    To store structured data in a storage area, you must first convert it to a
    string.
 
   &lt;h4 id=the-storage&gt;&lt;span class=secno&gt;4.10.2. &lt;/span&gt;The &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface&lt;/h4&gt;
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface&lt;/h4&gt;
 
   &lt;pre class=idl&gt;
-interface &lt;dfn id=storage2&gt;Storage&lt;/dfn&gt; {
+interface &lt;dfn id=storage0&gt;Storage&lt;/dfn&gt; {
   readonly attribute unsigned long &lt;a href=&quot;#length8&quot; title=dom-Storage-length&gt;length&lt;/a&gt;;
   DOMString &lt;a href=&quot;#keyn&quot; title=dom-Storage-key&gt;key&lt;/a&gt;(in unsigned long index);
-  &lt;a href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt; &lt;a href=&quot;#getitem&quot; title=dom-Storage-getItem&gt;getItem&lt;/a&gt;(in DOMString key);
+  DOMString &lt;a href=&quot;#getitem&quot; title=dom-Storage-getItem&gt;getItem&lt;/a&gt;(in DOMString key);
   void &lt;a href=&quot;#setitem&quot; title=dom-Storage-setItem&gt;setItem&lt;/a&gt;(in DOMString key, in DOMString data);
   void &lt;a href=&quot;#removeitem&quot; title=dom-Storage-removeItem&gt;removeItem&lt;/a&gt;(in DOMString key);
 };&lt;/pre&gt;
 
-  &lt;p&gt;Each &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object provides access
-   to a list of key/value pairs, which are sometimes called items. Keys are
-   strings, and any string (including the empty string) is a valid key.
-   Values are strings with associated metadata, represented by &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; objects.
+  &lt;p&gt;Each &lt;code&gt;&lt;a href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object provides access
+   to a list of key/value pairs, which are sometimes called items. Keys and
+   values are strings. Any string (including the empty string) is a valid
+   key.
 
-  &lt;p&gt;Each &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object is associated
+  &lt;p class=note&gt;To store more structured data, authors may consider using the
+   &lt;a href=&quot;#sql&quot;&gt;SQL interfaces&lt;/a&gt; instead.
+
+  &lt;p&gt;Each &lt;code&gt;&lt;a href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object is associated
    with a list of key/value pairs when it is created, as defined in the
    sections on the &lt;code title=dom-sessionStorage&gt;&lt;a
    href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; and &lt;code
    title=dom-globalStorage&gt;&lt;a href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt;
    attributes. Multiple separate objects implementing the &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface can all be associated with
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface can all be associated with
    the same list of key/value pairs simultaneously.
 
-  &lt;p&gt;Key/value pairs have associated metadata. In particular, a key/value
-   pair can be marked as either &quot;safe only for secure content&quot;, or as &quot;safe
-   for both secure and insecure content&quot;.
-
-  &lt;p&gt;A key/value pair is &lt;dfn id=accessible title=&quot;accessible
-   keys&quot;&gt;accessible&lt;/dfn&gt; if either it is marked as &quot;safe for both secure and
-   insecure content&quot;, or it is marked as &quot;safe only for secure content&quot; and
-   the script in question is running in a &lt;span&gt;secure browsing
-   context&lt;/span&gt;&lt;!-- XXX xref --&gt;.
-
   &lt;p&gt;The &lt;dfn id=length8 title=dom-Storage-length&gt;&lt;code&gt;length&lt;/code&gt;&lt;/dfn&gt;
-   attribute must return the number of key/value pairs currently present and
-   &lt;a href=&quot;#accessible&quot; title=&quot;accessible keys&quot;&gt;accessible&lt;/a&gt; in the list
-   associated with the object.
+   attribute must return the number of key/value pairs currently present in
+   the list associated with the object.
 
   &lt;p&gt;The &lt;dfn id=keyn title=dom-Storage-key&gt;&lt;code&gt;key(&lt;var
    title=&quot;&quot;&gt;n&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the name of the &lt;var
-   title=&quot;&quot;&gt;n&lt;/var&gt;th &lt;a href=&quot;#accessible&quot; title=&quot;accessible
-   keys&quot;&gt;accessible&lt;/a&gt; key in the list. The order of keys is user-agent
+   title=&quot;&quot;&gt;n&lt;/var&gt;th key in the list. The order of keys is user-agent
    defined, but must be consistent within an object between changes to the
    number of keys. (Thus, &lt;a href=&quot;#setitem&quot;
    title=dom-Storage-setItem&gt;adding&lt;/a&gt; or &lt;a href=&quot;#removeitem&quot;
@@ -29717,18 +29679,10 @@
    &lt;code&gt;INDEX_SIZE_ERR&lt;/code&gt; exception.
 
   &lt;p&gt;The &lt;dfn id=getitem title=dom-Storage-getItem&gt;&lt;code&gt;getItem(&lt;var
-   title=&quot;&quot;&gt;key&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; object representing the
-   key/value pair with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt;. If the given &lt;var
-   title=&quot;&quot;&gt;key&lt;/var&gt; does not exist in the list associated with the object,
-   or is not &lt;a href=&quot;#accessible&quot; title=&quot;accessible keys&quot;&gt;accessible&lt;/a&gt;,
-   then this method must return null. Subsequent calls to this method with
-   the same key from scripts running in the same &lt;span&gt;security
-   context&lt;/span&gt; must return the same instance of the &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; interface. (Such instances must
-   not be shared across security contexts, though.)&lt;/p&gt;
-  &lt;!-- XXX define
-  security context --&gt;
+   title=&quot;&quot;&gt;key&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the current value
+   associated with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt;. If the given &lt;var
+   title=&quot;&quot;&gt;key&lt;/var&gt; does not exist in the list associated with the object
+   then this method must return null.
 
   &lt;p&gt;The &lt;dfn id=setitem title=dom-Storage-setItem&gt;&lt;code&gt;setItem(&lt;var
    title=&quot;&quot;&gt;key&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;value&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must
@@ -29736,31 +29690,17 @@
    already exists in the list associated with the object.
 
   &lt;p&gt;If it does not, then a new key/value pair must be added to the list,
-   with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;value&lt;/var&gt;, such
-   that any current or future &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; objects referring to this
-   key/value pair will return the value given in the &lt;var
-   title=&quot;&quot;&gt;value&lt;/var&gt; argument. If the script setting the value is running
-   in a &lt;span&gt;secure browsing context&lt;/span&gt;, then the key/value pair must be
-   marked as &quot;safe only for secure content&quot;, otherwise it must be marked as
-   &quot;safe for both secure and insecure content&quot;.
+   with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;value&lt;/var&gt;.
 
   &lt;p&gt;If the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; &lt;em&gt;does&lt;/em&gt; exist in the list,
-   then, if the key/value pair with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; is &lt;a
-   href=&quot;#accessible&quot; title=&quot;accessible keys&quot;&gt;accessible&lt;/a&gt;, it must have
-   its value updated so that any current or future &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; objects referring to this
-   key/value pair will return the value given in the &lt;var
-   title=&quot;&quot;&gt;value&lt;/var&gt; argument. If it is &lt;em&gt;not&lt;/em&gt; &lt;a href=&quot;#accessible&quot;
-   title=&quot;accessible keys&quot;&gt;accessible&lt;/a&gt;, the method must raise a &lt;a
-   href=&quot;#security8&quot;&gt;security exception&lt;/a&gt;.
+   then it must have its value updated to the value given in the &lt;var
+   title=&quot;&quot;&gt;value&lt;/var&gt; argument.
 
   &lt;p&gt;When the &lt;code title=dom-Storage-setItem&gt;&lt;a
-   href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; method is successfully invoked (i.e.
-   when it doesn't raise an exception), events are fired on other &lt;code&gt;&lt;a
-   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; objects that can access the
-   newly stored data, as defined in the sections on the &lt;code
-   title=dom-sessionStorage&gt;&lt;a
+   href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; method is invoked, events are fired
+   on other &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; objects
+   that can access the newly stored data, as defined in the sections on the
+   &lt;code title=dom-sessionStorage&gt;&lt;a
    href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; and &lt;code
    title=dom-globalStorage&gt;&lt;a href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt;
    attributes.&lt;/p&gt;
@@ -29772,11 +29712,8 @@
    title=dom-Storage-removeItem&gt;&lt;code&gt;removeItem(&lt;var
    title=&quot;&quot;&gt;key&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must cause the key/value pair with
    the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; to be removed from the list associated
-   with the object, if it exists and is &lt;a href=&quot;#accessible&quot;
-   title=&quot;accessible keys&quot;&gt;accessible&lt;/a&gt;. If no item with that key exists,
-   the method must do nothing. If an item with that key exists but is not &lt;a
-   href=&quot;#accessible&quot; title=&quot;accessible keys&quot;&gt;accessible&lt;/a&gt;, the method must
-   raise a &lt;a href=&quot;#security8&quot;&gt;security exception&lt;/a&gt;.
+   with the object, if it exists. If no item with that key exists, the method
+   must do nothing.
 
   &lt;p&gt;The &lt;code title=dom-Storage-setItem&gt;&lt;a
    href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; and &lt;code
@@ -29786,14 +29723,13 @@
    not be changed at all.
 
   &lt;p&gt;In the ECMAScript DOM binding, enumerating a &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object must enumerate through the
-   currently stored and &lt;a href=&quot;#accessible&quot; title=&quot;accessible
-   keys&quot;&gt;accessible&lt;/a&gt; keys in the list the object is associated with. (It
-   must not enumerate the values or the actual members of the interface). In
-   the ECMAScript DOM binding, &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt;
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object must enumerate through the
+   currently stored keys in the list the object is associated with. (It must
+   not enumerate the values or the actual members of the interface). In the
+   ECMAScript DOM binding, &lt;code&gt;&lt;a href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt;
    objects must support dereferencing such that getting a property that is
    not a member of the object (i.e. is neither a member of the &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface nor of &lt;code
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface nor of &lt;code
    title=dom-Object&gt;Object&lt;/code&gt;) must invoke the &lt;code
    title=dom-Storage-getItem&gt;&lt;a href=&quot;#getitem&quot;&gt;getItem()&lt;/a&gt;&lt;/code&gt; method
    with the property's name as the argument, and setting such a property must
@@ -29801,83 +29737,17 @@
    href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; method with the property's name as
    the first argument and the given value as the second argument.
 
-  &lt;h4 id=the-storageitem&gt;&lt;span class=secno&gt;4.10.3. &lt;/span&gt;The &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; interface&lt;/h4&gt;
-
-  &lt;p&gt;Items in &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; objects are
-   represented by objects implementing the &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; interface.
-
-  &lt;pre class=idl&gt;
-interface &lt;dfn id=storageitem&gt;StorageItem&lt;/dfn&gt; {
-           attribute boolean &lt;a href=&quot;#secure&quot; title=dom-StorageItem-secure&gt;secure&lt;/a&gt;;
-           attribute DOMString &lt;a href=&quot;#value7&quot; title=dom-StorageItem-value&gt;value&lt;/a&gt;;
-};&lt;/pre&gt;
-
-  &lt;p&gt;In the ECMAScript DOM binding, &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; objects must stringify to their
-   &lt;code title=dom-StorageItem-value&gt;&lt;a href=&quot;#value7&quot;&gt;value&lt;/a&gt;&lt;/code&gt;
-   attribute's value.
-
-  &lt;p&gt;The &lt;dfn id=value7 title=dom-StorageItem-value&gt;&lt;code&gt;value&lt;/code&gt;&lt;/dfn&gt;
-   attribute must return the current value of the key/value pair represented
-   by the object. When the attribute is set, the user agent must invoke the
-   &lt;code title=dom-Storage-setItem&gt;&lt;a href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt;
-   method of the &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object that the
-   &lt;code&gt;&lt;a href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; object is associated
-   with, with the key that the &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; object is associated with as
-   the first argument, and the new given value of the attribute as the second
-   argument.
-
-  &lt;p&gt;&lt;code&gt;&lt;a href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; objects must be
-   &lt;em&gt;&lt;a href=&quot;#live&quot;&gt;live&lt;/a&gt;&lt;/em&gt;, meaning that as the underlying &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object has its key/value pairs
-   updated, the &lt;code&gt;&lt;a href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; objects
-   must always return the actual value of the key/value pair they represent.
-
-  &lt;p&gt;If the key/value pair has been deleted, the &lt;code&gt;&lt;a
-   href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; object must act as if its value
-   was the empty string. On setting, the key/value pair will be recreated.
-
-  &lt;p&gt;The &lt;dfn id=secure
-   title=dom-StorageItem-secure&gt;&lt;code&gt;secure&lt;/code&gt;&lt;/dfn&gt; attribute must
-   raise an &lt;code&gt;INVALID_ACCESS_ERR&lt;/code&gt; exception when accessed or set
-   from a script whose browsing context is not &lt;span title=&quot;secure browsing
-   context&quot;&gt;considered secure&lt;/span&gt;&lt;!--
-  XXX xref --&gt;. (Basically, if the
-   page is not an SSL page.)
-
-  &lt;p&gt;If the browsing context &lt;em&gt;is&lt;/em&gt; secure, then the &lt;code
-   title=dom-StorageItem-secure&gt;&lt;a href=&quot;#secure&quot;&gt;secure&lt;/a&gt;&lt;/code&gt; attribute
-   must return true if the key/value pair is considered &quot;safe only for secure
-   content&quot;, and false if it is considered &quot;safe for both secure and insecure
-   content&quot;. If it is set to true, then the key/value pair must be flagged as
-   &quot;safe only for secure content&quot;. If it is set to false, then the key/value
-   pair must be flagged as &quot;safe for both secure and insecure content&quot;.
-
-  &lt;p&gt;If a &lt;code&gt;&lt;a href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; object is
-   obtained by a script that is not running in a &lt;span&gt;secure browsing
-   context&lt;/span&gt;, and the item is then marked with the &quot;safe only for secure
-   content&quot; flag by a script that &lt;em&gt;is&lt;/em&gt; running in a secure context,
-   the &lt;code&gt;&lt;a href=&quot;#storageitem&quot;&gt;StorageItem&lt;/a&gt;&lt;/code&gt; object must
-   continue to be available to the first script, who will be able to read the
-   value of the object. However, any attempt to &lt;em&gt;set&lt;/em&gt; the value would
-   then start raising exceptions as described in the previous section, and
-   the key/value pair would no longer appear in the appropriate &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object.
-
-  &lt;h4 id=the-sessionstorage&gt;&lt;span class=secno&gt;4.10.4. &lt;/span&gt;The &lt;code
+  &lt;h4 id=the-sessionstorage&gt;&lt;span class=secno&gt;4.10.3. &lt;/span&gt;The &lt;code
    title=dom-sessionStorage&gt;&lt;a
    href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; attribute&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=sessionstorage
    title=dom-sessionStorage&gt;&lt;code&gt;sessionStorage&lt;/code&gt;&lt;/dfn&gt; attribute
-   represents the storage area specific to the current &lt;a
+   represents the set of storage areas specific to the current &lt;a
    href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt;.
 
   &lt;p&gt;Each &lt;a href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; has a unique
-   set of session storage areas, one for each domain.
+   set of session storage areas, one for each &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt;.
 
   &lt;p&gt;User agents should not expire data from a browsing context's session
    storage areas, but may do so when the user requests that such data be
@@ -29896,14 +29766,15 @@
   &lt;p&gt;When a new &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; is
    created, the user agent must check to see if the document's &lt;a
    href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; has allocated a session
-   storage area for that &lt;a href=&quot;#domain0&quot;&gt;document's domain&lt;/a&gt;. If it has
-   not, a new storage area for that document's domain must be created.
+   storage area for that document's &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt;. If it has
+   not, a new storage area for that document's origin must be created.
 
-  &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object for the
+  &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object for the
    document's associated &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object's
    &lt;code title=dom-sessionStorage&gt;&lt;a
    href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; attribute must then be
-   associated with the domain's session storage area.
+   associated with that &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt;'s session storage area
+   for that &lt;a href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt;.
 
   &lt;p&gt;When a new &lt;a href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; is
    created by cloning an existing &lt;a href=&quot;#browsing0&quot;&gt;browsing context&lt;/a&gt;,
@@ -29917,54 +29788,40 @@
    context, or in some other way related to a specific &lt;code&gt;&lt;a
    href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;, then, if the new context's
    first &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; has the same
-   &lt;a href=&quot;#domain0&quot; title=&quot;document's domain&quot;&gt;domain&lt;/a&gt; as the &lt;code&gt;&lt;a
+   &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; as the &lt;code&gt;&lt;a
    href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; from which the new context
    was created, the new browsing context must start with a single session
-   storage area. That storage area must be a copy of that domain's session
-   storage area in the original browsing context, which from that point on
-   must be considered separate, with the two storage areas not affecting each
-   other in any way.&lt;/p&gt;
+   storage area. That storage area must be a copy of that origin's session
+   storage area in the original top-level browsing context, which from that
+   point on must be considered separate, with the two storage areas not
+   affecting each other in any way.&lt;/p&gt;
   &lt;!-- XXX define the case for window.open() --&gt;
 
   &lt;p id=sessionStorageEvent&gt;When the &lt;code title=dom-Storage-setItem&gt;&lt;a
    href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; method is called on a &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; that is
-   associated with a session storage area, then, if the method does not raise
-   a &lt;a href=&quot;#security8&quot;&gt;security exception&lt;/a&gt;, in every &lt;code&gt;&lt;a
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; that is
+   associated with a session storage area, then in every &lt;code&gt;&lt;a
    href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object whose &lt;code&gt;&lt;a
    href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object's &lt;code
    title=dom-sessionStorage&gt;&lt;a
    href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; attribute's &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object is associated with the same
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object is associated with the same
    storage area, other than &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, a &lt;code
-   title=event-storage&gt;&lt;a href=&quot;#storage3&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event must be
-   fired, as &lt;a href=&quot;#storage3&quot; title=event-storage&gt;described below&lt;/a&gt;.
+   title=event-storage&gt;&lt;a href=&quot;#storage1&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event must be
+   fired, as &lt;a href=&quot;#storage1&quot; title=event-storage&gt;described below&lt;/a&gt;.
 
-  &lt;h4 id=the-globalstorage&gt;&lt;span class=secno&gt;4.10.5. &lt;/span&gt;The &lt;code
+  &lt;h4 id=the-globalstorage&gt;&lt;span class=secno&gt;4.10.4. &lt;/span&gt;The &lt;code
    title=dom-globalStorage&gt;&lt;a href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt;
    attribute&lt;/h4&gt;
 
-  &lt;pre class=idl&gt;interface &lt;dfn id=storagelist&gt;StorageList&lt;/dfn&gt; {
-  &lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt; &lt;a href=&quot;#nameditem2&quot; title=dom-Storagelist-namedItem&gt;namedItem&lt;/a&gt;(in DOMString domain);
-};&lt;/pre&gt;
-
   &lt;p&gt;The &lt;dfn id=globalstorage
    title=dom-globalStorage&gt;&lt;code&gt;globalStorage&lt;/code&gt;&lt;/dfn&gt; object provides a
-   &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object for each domain.
+   &lt;code&gt;&lt;a href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object for &lt;a
+   href=&quot;#origin0&quot;&gt;origin&lt;/a&gt;.
 
-  &lt;p&gt;In the ECMAScript DOM binding, &lt;code&gt;&lt;a
-   href=&quot;#storagelist&quot;&gt;StorageList&lt;/a&gt;&lt;/code&gt; objects must support
-   dereferencing such that getting a property that is not a member of the
-   object (i.e. is neither a member of the &lt;code&gt;&lt;a
-   href=&quot;#storagelist&quot;&gt;StorageList&lt;/a&gt;&lt;/code&gt; interface nor of &lt;code
-   title=dom-Object&gt;Object&lt;/code&gt;) must invoke the &lt;code
-   title=dom-Storagelist-namedItem&gt;&lt;a
-   href=&quot;#nameditem2&quot;&gt;namedItem()&lt;/a&gt;&lt;/code&gt; method with the property's name
-   as the argument.
+  &lt;p&gt;User agents must have a set of global storage areas, one for each &lt;a
+   href=&quot;#origin0&quot;&gt;origin&lt;/a&gt;.
 
-  &lt;p&gt;User agents must have a set of global storage areas, one for each
-   domain.
-
   &lt;p&gt;User agents should only expire data from the global storage areas for
    security reasons or when requested to do so by the user. User agents
    should always avoid deleting data while a script that could access that
@@ -29972,209 +29829,74 @@
    potentially user-critical. It is expected that Web applications will use
    the global storage areas for storing user-written documents.
 
-  &lt;p&gt;The &lt;dfn id=nameditem2
-   title=dom-Storagelist-namedItem&gt;&lt;code&gt;namedItem(&lt;var
-   title=&quot;&quot;&gt;domain&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method tries to returns a &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object associated with the given
-   domain, according to the rules that follow.
+  &lt;p&gt;When the &lt;code title=dom-globalStorage&gt;&lt;a
+   href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt; attribute is accessed, the
+   user agent must check to see if it has allocated global storage area for
+   the &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; of the &lt;a href=&quot;#browsing0&quot;&gt;browsing
+   context&lt;/a&gt; within which the script is running. If it has not, a new
+   storage area for that origin must be created.
 
-  &lt;div id=splitDomain&gt;
-   &lt;p&gt;The &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; must first be split into an array of
-    strings, by splitting the string at &quot;.&quot; characters (U+002E FULL STOP). If
-    the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument is the empty string, then the
-    array is empty as well. If the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument is not
-    empty but has no dots, then the array has one item, which is equal to the
-    &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument. If the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt;
-    argument contains consecutive dots, there will be empty strings in the
-    array (e.g. the string &quot;hello..world&quot; becomes split into the three
-    strings &quot;hello&quot;, &quot;&quot;, and &quot;world&quot;, with the middle one being the empty
-    string).&lt;/p&gt;
-
-   &lt;p&gt;Each component of the array must then have the IDNA ToASCII algorithm
-    applied to it, with both the AllowUnassigned and UseSTD3ASCIIRules flags
-    set. &lt;a href=&quot;#refsRFC3490&quot;&gt;[RFC3490]&lt;/a&gt; If ToASCII fails to convert one
-    of the components of the string, e.g. because it is too long or because
-    it contains invalid characters, then the user agent must raise a
-    &lt;code&gt;SYNTAX_ERR&lt;/code&gt; exception. &lt;a href=&quot;#refsDOM3CORE&quot;&gt;[DOM3CORE]&lt;/a&gt;
-    The components after this step consist of only US-ASCII characters.&lt;/p&gt;
-
-   &lt;p&gt;The components of the array must then be converted to lowercase. Since
-    only US-ASCII is involved at this step, this only requires converting
-    characters in the range A-Z to the corresponding characters in the range
-    a-z.&lt;/p&gt;
-  &lt;/div&gt;
-
-  &lt;p&gt;The resulting array is used in a comparison with another array, as
-   described below. In addition, its components are concatenated together,
-   each part separated by a dot (U+002E), to form the &lt;dfn
-   id=normalised0&gt;normalised requested domain&lt;/dfn&gt;.
-
-  &lt;p class=example&gt;If the original &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; was
-   &quot;&Aring;sg&aring;rd.Example.Com&quot;, then the resulting array would have the
-   three items &quot;xn--sgrd-poac&quot;, &quot;example&quot;, and &quot;com&quot;, and the normalised
-   requested domain would be &quot;xn--sgrd-poac.example.com&quot;.
-
-  &lt;p&gt;Next, the domain part of the tuple forming the calling script's &lt;a
-   href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; is processed to find if it is allowed to access
-   the requested domain.
-
-  &lt;p&gt;If the script's origin has no domain part, e.g. if only the server's IP
-   address is known, and the &lt;a href=&quot;#normalised0&quot;&gt;normalised requested
-   domain&lt;/a&gt; is not the empty string, then the user agent must raise a &lt;a
-   href=&quot;#security8&quot;&gt;security exception&lt;/a&gt;.
-
-  &lt;p class=note&gt;If the &lt;a href=&quot;#normalised0&quot;&gt;normalised requested domain&lt;/a&gt;
-   is the empty string, then the rest of this algorithm can be skipped. This
-   is because in that situation, the comparison of the two arrays below will
-   always find them to be the same &mdash; the first array in such a
-   situation is also empty and so permission to access that storage area will
-   always be given.
-
-  &lt;p&gt;If the domain part of the script's origin contains no dots (U+002E) then
-   the string &quot;&lt;code&gt;.localdomain&lt;/code&gt;&quot; must be appended to the script's
-   domain.
-
-  &lt;p&gt;Then, the domain part of the script's origin must be turned into an
-   array, being split, converted to ASCII, and lowercased as described for
-   the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument &lt;a href=&quot;#splitDomain&quot;&gt;above&lt;/a&gt;.
-
-  &lt;p&gt;Of the two arrays, the longest one must then be shortened to the length
-   of the shorter one, by dropping items from the start of the array.
-
-  &lt;div class=example&gt;
-   &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument is &quot;www.example.com&quot; and the
-    script origin's domain part is &quot;example.com&quot; then the first array will be
-    a three item array (&quot;www&quot;, &quot;example&quot;, &quot;com&quot;), and the second will be a
-    two item array (&quot;example&quot;, &quot;com&quot;). The first array is therefore
-    shortened, dropping the leading parts, making both into the same array
-    (&quot;example&quot;, &quot;com&quot;).&lt;/p&gt;
-  &lt;/div&gt;
-
-  &lt;p&gt;If the two arrays are not component-for-component identical in literal
-   string comparisons, then the user agent must then raise a &lt;a
-   href=&quot;#security8&quot;&gt;security exception&lt;/a&gt;.
-
-  &lt;p&gt;Otherwise, the user agent must check to see if it has allocated global
-   storage area for the &lt;a href=&quot;#normalised0&quot;&gt;normalised requested
-   domain&lt;/a&gt;. If it has not, a new storage area for that domain must be
-   created.
-
   &lt;p&gt;The user agent must then create a &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object associated with that domain's
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object associated with that origin's
    global storage area, and return it.
 
-  &lt;p&gt;When the requested &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; is a top level domain, or
-   the empty string, or a country-specific sub-domain like &quot;co.uk&quot; or
-   &quot;ca.us&quot;, the associated global storage area is known as &lt;dfn
-   id=public0&gt;public storage area&lt;/dfn&gt;
+  &lt;p id=globalStorageEvent&gt;When the &lt;code title=dom-Storage-setItem&gt;&lt;a
+   href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; method is called on a &lt;code&gt;&lt;a
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; that is
+   associated with a global storage area, then in every &lt;code&gt;&lt;a
+   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object whose &lt;code&gt;&lt;a
+   href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object's &lt;code title=dom-globalStorage&gt;&lt;a
+   href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt; attribute's &lt;code&gt;&lt;a
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object is associated with the same
+   storage area, other than &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, a &lt;code
+   title=event-storage&gt;&lt;a href=&quot;#storage1&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event must be
+   fired, as &lt;a href=&quot;#storage1&quot; title=event-storage&gt;described below&lt;/a&gt;.
 
-  &lt;div id=globalStorageEvent&gt;
-   &lt;p&gt;The &lt;code title=dom-Storage-setItem&gt;&lt;a
-    href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; method might be called on a &lt;code&gt;&lt;a
-    href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object that is associated with a
-    global storage area for a domain &lt;var title=&quot;&quot;&gt;d&lt;/var&gt;, created by a
-    &lt;code&gt;&lt;a href=&quot;#storagelist&quot;&gt;StorageList&lt;/a&gt;&lt;/code&gt; object associated
-    with a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object &lt;var
-    title=&quot;&quot;&gt;x&lt;/var&gt;. Whenever this occurs, if the method didn't raise an
-    exception, a &lt;code title=event-storage&gt;&lt;a
-    href=&quot;#storage3&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event must be fired, as described
-    below, in every &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;
-    object that matches the following conditions:&lt;/p&gt;
+  &lt;h4 id=the-storage0&gt;&lt;span class=secno&gt;4.10.5. &lt;/span&gt;The &lt;code
+   title=event-storage&gt;&lt;a href=&quot;#storage1&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event&lt;/h4&gt;
 
-   &lt;ul&gt;
-    &lt;li&gt;Its &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object is not &lt;var
-     title=&quot;&quot;&gt;x&lt;/var&gt;, and
-
-    &lt;li&gt;Its &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object's &lt;code
-     title=dom-sessionStorage&gt;&lt;a
-     href=&quot;#sessionstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt; attribute's &lt;code&gt;&lt;a
-     href=&quot;#storagelist&quot;&gt;StorageList&lt;/a&gt;&lt;/code&gt; object's &lt;code
-     title=dom-Storagelist-namedItem&gt;&lt;a
-     href=&quot;#nameditem2&quot;&gt;namedItem()&lt;/a&gt;&lt;/code&gt; method would not raise a &lt;a
-     href=&quot;#security8&quot;&gt;security exception&lt;/a&gt; according to the rules above if
-     it was invoked with the domain &lt;var title=&quot;&quot;&gt;d&lt;/var&gt;.
-   &lt;/ul&gt;
-
-   &lt;p&gt;In other words, every other document that has access to that domain's
-    global storage area is notified of the change.&lt;/p&gt;
-  &lt;/div&gt;
-
-  &lt;h4 id=the-storage0&gt;&lt;span class=secno&gt;4.10.6. &lt;/span&gt;The &lt;code
-   title=event-storage&gt;&lt;a href=&quot;#storage3&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event&lt;/h4&gt;
-
-  &lt;p&gt;The &lt;dfn id=storage3 title=event-storage&gt;&lt;code&gt;storage&lt;/code&gt;&lt;/dfn&gt;
+  &lt;p&gt;The &lt;dfn id=storage1 title=event-storage&gt;&lt;code&gt;storage&lt;/code&gt;&lt;/dfn&gt;
    event is fired in an &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;
    when a storage area changes, as described in the previous two sections (&lt;a
    href=&quot;#sessionStorageEvent&quot;&gt;for session storage&lt;/a&gt;, &lt;a
    href=&quot;#globalStorageEvent&quot;&gt;for global storage&lt;/a&gt;).
 
-  &lt;p&gt;When this happens, a &lt;code&gt;&lt;a href=&quot;#storage2&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event
-   in no namespace, which bubbles, is not cancelable, has no default action,
-   and which uses the &lt;code&gt;&lt;a href=&quot;#storageevent&quot;&gt;StorageEvent&lt;/a&gt;&lt;/code&gt;
-   interface described below, must be fired on &lt;a href=&quot;#the-body0&quot;&gt;the body
-   element&lt;/a&gt;.
+  &lt;p&gt;When this happens, the user agent must &lt;a href=&quot;#firing2&quot;&gt;fire a simple
+   event&lt;/a&gt; called &lt;code&gt;&lt;a href=&quot;#storage0&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; on &lt;a
+   href=&quot;#the-body0&quot;&gt;the body element&lt;/a&gt;.
 
   &lt;p&gt;However, it is possible (indeed, for session storage areas, likely) that
-   the target &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object is
-   not active at that time. For example, it might not be the &lt;a
-   href=&quot;#current0&quot;&gt;current entry&lt;/a&gt; in the session history; user agents
-   typically stop scripts from running in pages that are in the history. In
-   such cases, the user agent must instead delay the firing of the event
-   until such time as the &lt;code&gt;&lt;a
-   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object in question becomes
-   active again.
+   the target's &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object
+   is not an &lt;a href=&quot;#active&quot;&gt;active document&lt;/a&gt; at that time. In such
+   cases, the user agent must instead delay the firing of the event until
+   such time as the &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;
+   object in question becomes an &lt;a href=&quot;#active&quot;&gt;active document&lt;/a&gt; again.
 
   &lt;p&gt;When there are multiple delayed &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; events for the same &lt;code&gt;&lt;a
-   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object, user agents should
-   coalesce events with the same &lt;code title=dom-Storageevent-domain&gt;&lt;a
-   href=&quot;#domain1&quot;&gt;domain&lt;/a&gt;&lt;/code&gt; value (dropping duplicates).
+   href=&quot;#storage0&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; events for the same &lt;code&gt;&lt;a
+   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object, user agents must
+   coalesce those events such that only one event fires when the document
+   becomes active again.
 
   &lt;p&gt;If the DOM of a page that has delayed &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; events queued up is &lt;a href=&quot;#discard&quot;
-   title=discard&gt;discarded&lt;/a&gt;, then the delayed events are dropped as well.
-
-  &lt;pre class=idl&gt;interface &lt;dfn id=storageevent&gt;StorageEvent&lt;/dfn&gt; : Event {
-  readonly attribute DOMString &lt;a href=&quot;#domain1&quot; title=dom-StorageEvent-domain&gt;domain&lt;/a&gt;;
-  void &lt;a href=&quot;#initstorageevent&quot; title=dom-StorageEvent-initStorageEvent&gt;initStorageEvent&lt;/a&gt;(in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in DOMString domainArg);
-  void &lt;a href=&quot;#initstorageeventns&quot; title=dom-StorageEvent-initStorageEventNS&gt;initStorageEventNS&lt;/a&gt;(in DOMString namespaceURIArg, in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in DOMString domainArg);
-};&lt;/pre&gt;
-
-  &lt;p&gt;The &lt;dfn id=initstorageevent
-   title=dom-StorageEvent-initStorageEvent&gt;&lt;code&gt;initStorageEvent()&lt;/code&gt;&lt;/dfn&gt;
-   and &lt;dfn id=initstorageeventns
-   title=dom-StorageEvent-initStorageEventNS&gt;&lt;code&gt;initStorageEventNS()&lt;/code&gt;&lt;/dfn&gt;
-   methods must initialise the event in a manner analogous to the
-   similarly-named methods in the DOM3 Events interfaces. &lt;a
-   href=&quot;#refsDOM3EVENTS&quot;&gt;[DOM3EVENTS]&lt;/a&gt;
-
-  &lt;p&gt;The &lt;dfn id=domain1
-   title=dom-StorageEvent-domain&gt;&lt;code&gt;domain&lt;/code&gt;&lt;/dfn&gt; attribute of the
-   &lt;code&gt;&lt;a href=&quot;#storageevent&quot;&gt;StorageEvent&lt;/a&gt;&lt;/code&gt; event object must be
-   set to the name of the domain associated with the storage area that
-   changed if that storage area is a global storage area, or the string
-   &quot;&lt;code&gt;#session&lt;/code&gt;&quot; if it was a session storage area.&lt;/p&gt;
+   href=&quot;#storage0&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; events queued up is &lt;a href=&quot;#discard&quot;
+   title=discard&gt;discarded&lt;/a&gt;, then the delayed events are dropped as well.&lt;/p&gt;
   &lt;!-- XXX onstorage should be defined --&gt;
 
-  &lt;h4 id=miscellaneous0&gt;&lt;span class=secno&gt;4.10.7. &lt;/span&gt;Miscellaneous
+  &lt;h4 id=miscellaneous0&gt;&lt;span class=secno&gt;4.10.6. &lt;/span&gt;Miscellaneous
    implementation requirements for storage areas&lt;/h4&gt;
 
-  &lt;h5 id=disk-space&gt;&lt;span class=secno&gt;4.10.7.1. &lt;/span&gt;Disk space&lt;/h5&gt;
+  &lt;h5 id=disk-space&gt;&lt;span class=secno&gt;4.10.6.1. &lt;/span&gt;Disk space&lt;/h5&gt;
 
-  &lt;p&gt;User agents should limit the total amount of space allowed for a domain
-   based on the domain of the page setting the value.
+  &lt;p&gt;User agents should limit the total amount of space allowed for a storage
+   area based on the domain of the page setting the value.
 
   &lt;p&gt;User agents should not limit the total amount of space allowed on a
    per-storage-area basis, otherwise a site could just store data in any
-   number of subdomains, e.g. storing up to the limit in a1.example.com,
-   a2.example.com, a3.example.com, etc, circumventing per-domain limits.
+   number of subdomains or ports, e.g. storing up to the limit in
+   a1.example.com, a2.example.com, a3.example.com, etc, circumventing
+   per-domain limits.
 
-  &lt;p&gt;User agents should consider additional quota mechanisms (for example
-   limiting the amount of space provided to a domain's subdomains as a group)
-   so that hostile authors can't run scripts from multiple subdomains all
-   adding data to the global storage area in an attempted denial-of-service
-   attack.
-
   &lt;p&gt;User agents may prompt the user when per-domain space quotas are
    reached, allowing the user to grant a site more space. This enables sites
    to store many user-created documents on the user's computer, for instance.
@@ -30191,7 +29913,7 @@
    Implementation feedback is welcome and will be used to update this
    suggestion in future.
 
-  &lt;h5 id=threads0&gt;&lt;span class=secno&gt;4.10.7.2. &lt;/span&gt;Threads&lt;/h5&gt;
+  &lt;h5 id=threads0&gt;&lt;span class=secno&gt;4.10.6.2. &lt;/span&gt;Threads&lt;/h5&gt;
 
   &lt;p&gt;Multiple browsing contexts must be able to access the global storage
    areas simultaneously in a predictable manner. Scripts must not be able to
@@ -30199,41 +29921,35 @@
 
   &lt;p&gt;This is required to guarentee that the &lt;code title=dom-Storage-length&gt;&lt;a
    href=&quot;#length8&quot;&gt;length&lt;/a&gt;&lt;/code&gt; attribute of a &lt;code&gt;&lt;a
-   href=&quot;#storage2&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object never changes while a script is
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; object never changes while a script is
    executing, other than in a way that is predictable by the script itself.
 
   &lt;p&gt;There are various ways of implementing this requirement. One is that if
    a script running in one browsing context accesses a global storage area,
    the UA blocks scripts in other browsing contexts when they try to access
-   &lt;em&gt;any&lt;/em&gt; global storage area until the first script has executed to
-   completion. (Similarly, when a script in one browsing context accesses its
-   session storage area, any scripts that have the same top level browsing
-   context and the same domain would block when accessing their session
-   storage area until the first script has executed to completion.) Another
-   (potentially more efficient but probably more complex) implementation
-   strategy is to use optimistic transactional script execution. This
-   specification does not require any particular implementation strategy, so
-   long as the requirement above is met.
+   the global storage area for the same origin until the first script has
+   executed to completion. (Similarly, when a script in one browsing context
+   accesses its session storage area, any scripts that have the same top
+   level browsing context and the same origin would block when accessing
+   their session storage area until the first script has executed to
+   completion.) Another (potentially more efficient but probably more
+   complex) implementation strategy is to use optimistic transactional script
+   execution. This specification does not require any particular
+   implementation strategy, so long as the requirement above is met.
 
-  &lt;h4 id=security5&gt;&lt;span class=secno&gt;4.10.8. &lt;/span&gt;Security and privacy&lt;/h4&gt;
+  &lt;h4 id=security5&gt;&lt;span class=secno&gt;4.10.7. &lt;/span&gt;Security and privacy&lt;/h4&gt;
 
-  &lt;h5 id=user-tracking&gt;&lt;span class=secno&gt;4.10.8.1. &lt;/span&gt;User tracking&lt;/h5&gt;
+  &lt;h5 id=user-tracking&gt;&lt;span class=secno&gt;4.10.7.1. &lt;/span&gt;User tracking&lt;/h5&gt;
 
   &lt;p&gt;A third-party advertiser (or any entity capable of getting content
    distributed to multiple sites) could use a unique identifier stored in its
-   domain's global storage area to track a user across multiple sessions,
-   building a profile of the user's interests to allow for highly targeted
-   advertising. In conjunction with a site that is aware of the user's real
-   identity (for example an e-commerce site that requires authenticated
-   credentials), this could allow oppressive groups to target individuals
-   with greater accuracy than in a world with purely anonymous Web usage.
+   global storage area to track a user across multiple sessions, building a
+   profile of the user's interests to allow for highly targeted advertising.
+   In conjunction with a site that is aware of the user's real identity (for
+   example an e-commerce site that requires authenticated credentials), this
+   could allow oppressive groups to target individuals with greater accuracy
+   than in a world with purely anonymous Web usage.
 
-  &lt;p&gt;The &lt;code title=dom-globalStorage&gt;&lt;a
-   href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt; object also introduces a
-   way for sites to cooperate to track users over multiple domains, by
-   storing identifying data in &quot;&lt;a href=&quot;#public0&quot; title=&quot;public storage
-   area&quot;&gt;public&lt;/a&gt;&quot; top-level domain storage area, accessible by any domain.
-
   &lt;p&gt;There are a number of techniques that can be used to mitigate the risk
    of user tracking:
 
@@ -30245,56 +29961,26 @@
      originating at the domain of the top-level document of the &lt;a
      href=&quot;#browsing0&quot;&gt;browsing context&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;This blocks a third-party site from using its private storage area for
-     tracking a user, but top-level sites could still cooperate with third
-     parties to perferm user tracking by using the &quot;&lt;a href=&quot;#public0&quot;
-     title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot; storage area.&lt;/p&gt;
-
    &lt;li&gt;
     &lt;p&gt;Expiring stored data: user agents may automatically delete stored data
      after a period of time.&lt;/p&gt;
 
-    &lt;p&gt;For example, a user agent could treat the global storage area as
-     session-only storage, deleting the data once the user had closed all the
-     &lt;span&gt;browsing contexts&lt;/span&gt; that could access it.&lt;/p&gt;
+    &lt;p&gt;For example, a user agent could treat third-party global storage areas
+     as session-only storage, deleting the data once the user had closed all
+     the &lt;span&gt;browsing contexts&lt;/span&gt; that could access it.&lt;/p&gt;
 
     &lt;p&gt;This can restrict the ability of a site to track a user, as the site
      would then only be able to track the user across multiple sessions when
      he authenticates with the site itself (e.g. by making a purchase or
      logging in to a service).&lt;/p&gt;
+
+    &lt;p&gt;However, this also puts the user's data at risk.&lt;/p&gt;
     &lt;!-- XXX should there be an explicit way for sites to state when
     data should expire? as in
-    globalStorage['example.com'].expireData(365); ? --&gt;
+    globalStorage.expireData(365); ? --&gt;
     
 
    &lt;li&gt;
-    &lt;p&gt;Blocking access to the top-level domain (&quot;&lt;a href=&quot;#public0&quot;
-     title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot;) storage areas: user agents may
-     prevent domains from storing data in and reading data from the top-level
-     domain entries in the &lt;code title=dom-globalStorage&gt;&lt;a
-     href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
-
-    &lt;p&gt;In practice this requires a detailed list of all the &quot;public&quot;
-     second-level (and third-level) domains. For example, content at the
-     domain &lt;code&gt;www.example.com&lt;/code&gt; would be allowed to access
-     &lt;code&gt;example.com&lt;/code&gt; data but not &lt;code&gt;com&lt;/code&gt; data; content at
-     the domain &lt;code&gt;example.co.uk&lt;/code&gt; would be allowed access to
-     &lt;code&gt;example.co.uk&lt;/code&gt; but not &lt;code&gt;co.uk&lt;/code&gt; or
-     &lt;code&gt;uk&lt;/code&gt;; and content at &lt;code&gt;example.chiyoda.tokyo.jp&lt;/code&gt;
-     would be allowed access to &lt;code&gt;example.chiyoda.tokyo.jp&lt;/code&gt; but not
-     &lt;code&gt;chiyoda.tokyo.jp&lt;/code&gt;, &lt;code&gt;tokyo.jp&lt;/code&gt;, or
-     &lt;code&gt;jp&lt;/code&gt;, while content at &lt;code&gt;example.metro.tokyo.jp&lt;/code&gt;
-     would be allowed access to both &lt;code&gt;example.metro.tokyo.jp&lt;/code&gt; and
-     &lt;code&gt;metro.tokyo.jp&lt;/code&gt; but not &lt;code&gt;tokyo.jp&lt;/code&gt; or
-     &lt;code&gt;jp&lt;/code&gt;. The problem is even more convoluted when one considers
-     private domains with third-party subdomains such as
-     &lt;code&gt;dyndns.org&lt;/code&gt; or &lt;code&gt;uk.com&lt;/code&gt;.&lt;/p&gt;
-
-    &lt;p&gt;Blocking access to the &quot;&lt;a href=&quot;#public0&quot; title=&quot;public storage
-     area&quot;&gt;public&lt;/a&gt;&quot; storage areas can also prevent innocent sites from
-     cooperating to provide services beneficial to the user.&lt;/p&gt;
-
-   &lt;li&gt;
     &lt;p&gt;Treating persistent storage as cookies: user agents may present the
      persistent storage feature to the user in a way that does not
      distinguish it from HTTP session cookies. &lt;a
@@ -30304,21 +29990,15 @@
      suspicion.&lt;/p&gt;
 
    &lt;li&gt;
-    &lt;p&gt;Site-specific white-listing of access to &quot;&lt;a href=&quot;#public0&quot;
-     title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot; storage area: user agents may
-     allow sites to access persistent storage for their own domain and
-     subdomains in an unrestricted manner, but require the user to authorise
-     access to the storage area of higher-level domains.&lt;/p&gt;
+    &lt;p&gt;Site-specific white-listing of access to global storage areas: user
+     agents may allow sites to access session storage areas in an
+     unrestricted manner, but require the user to authorise access to global
+     storage areas.&lt;/p&gt;
 
-    &lt;p&gt;For example, code at &lt;code&gt;example.com&lt;/code&gt; would be always allowed
-     to read and write data for &lt;code&gt;www.example.com&lt;/code&gt; and
-     &lt;code&gt;example.com&lt;/code&gt;, but if it tried to access &lt;code&gt;com&lt;/code&gt;,
-     the user agent could display a non-modal message informing the user that
-     the page requested access to &lt;code&gt;com&lt;/code&gt; and offering to allow it.&lt;/p&gt;
-
    &lt;li&gt;
     &lt;p&gt;Origin-tracking of persistent storage data: user agents may record the
-     domain of the script that caused data to be stored.&lt;/p&gt;
+     origins of sites that contained content from third-party origins that
+     caused data to be stored.&lt;/p&gt;
 
     &lt;p&gt;If this information is then used to present the view of data currently
      in persistent storage, it would allow the user to make informed
@@ -30336,11 +30016,11 @@
 
   &lt;p&gt;While these suggestions prevent trivial use of this API for user
    tracking, they do not block it altogether. Within a single domain, a site
-   can continue to track the user across multiple sessions, and can then pass
-   all this information to the third party along with any identifying
-   information (names, credit card numbers, addresses) obtained by the site.
-   If a third party cooperates with multiple sites to obtain such
-   information, a profile can still be created.
+   can continue to track the user during a session, and can then pass all
+   this information to the third party along with any identifying information
+   (names, credit card numbers, addresses) obtained by the site. If a third
+   party cooperates with multiple sites to obtain such information, a profile
+   can still be created.
 
   &lt;p&gt;However, user tracking is to some extent possible even with no
    cooperation from the user agent whatsoever, for instance by using session
@@ -30351,7 +30031,7 @@
    headers and configuration settings) to combine separate sessions into
    coherent user profiles.
 
-  &lt;h5 id=cookie&gt;&lt;span class=secno&gt;4.10.8.2. &lt;/span&gt;Cookie resurrection&lt;/h5&gt;
+  &lt;h5 id=cookie&gt;&lt;span class=secno&gt;4.10.7.2. &lt;/span&gt;Cookie resurrection&lt;/h5&gt;
 
   &lt;p&gt;If the user interface for persistent storage presents data in the
    persistent storage feature separately from data in HTTP session cookies,
@@ -30359,75 +30039,15 @@
    allow sites to use the two features as redundant backup for each other,
    defeating a user's attempts to protect his privacy.
 
-  &lt;h5 id=integrity&gt;&lt;span class=secno&gt;4.10.8.3. &lt;/span&gt;Integrity of &quot;public&quot;
-   storage areas&lt;/h5&gt;
+  &lt;h5 id=dns-spoofing&gt;&lt;span class=secno&gt;4.10.7.3. &lt;/span&gt;DNS spoofing attacks&lt;/h5&gt;
 
-  &lt;p&gt;Since the &quot;&lt;a href=&quot;#public0&quot; title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot;
-   global storage areas are accessible by content from many different
-   parties, it is possible for third-party sites to delete or change
-   information stored in those areas in ways that the originating sites may
-   not expect.
-
-  &lt;p&gt;Authors must not use the &quot;&lt;a href=&quot;#public0&quot; title=&quot;public storage
-   area&quot;&gt;public&lt;/a&gt;&quot; global storage areas for storing sensitive data. Authors
-   must not trust information stored in &quot;&lt;a href=&quot;#public0&quot; title=&quot;public
-   storage area&quot;&gt;public&lt;/a&gt;&quot; global storage areas.
-
-  &lt;h5 id=cross-protocol&gt;&lt;span class=secno&gt;4.10.8.4. &lt;/span&gt;Cross-protocol and
-   cross-port attacks&lt;/h5&gt;
-
-  &lt;p&gt;This API makes no distinction between content served over HTTP, FTP, or
-   other host-based protocols, and does not distinguish between content
-   served from different ports at the same host.
-
-  &lt;p&gt;Thus, for example, data stored in the global persistent storage for
-   domain &quot;www.example.com&quot; by a page served from HTTP port 80 will be
-   available to a page served in &lt;code&gt;<A HREF="http://example.com:18080/&lt;/code">http://example.com:18080/&lt;/code</A>&gt;, even
-   if the latter is an experimental server under the control of a different
-   user.
-
-  &lt;p&gt;Since the data is not sent over the wire by the user agent, this is not
-   a security risk in its own right. However, authors must take proper steps
-   to ensure that all hosts that have fully qualified host names that are
-   subsets of hosts dealing with sensitive information are as secure as the
-   originating hosts themselves.
-
-  &lt;p&gt;Similarly, authors must ensure that all Web servers on a host,
-   regardless of the port, are equally trusted if any of them are to use
-   persistent storage. For instance, if a Web server runs a production
-   service that makes use of the persistent storage feature, then other users
-   that have access to that machine and that can run a Web server on another
-   port will be able to access the persistent storage added by the production
-   service (assuming they can trick a user into visiting their page).
-
-  &lt;p&gt;However, if one is able to trick users into visiting a Web server with
-   the same host name but on a different port as a production service used by
-   these users, then one could just as easily fake the look of the site and
-   thus trick users into authenticating with the fake site directly,
-   forwarding the request to the real site and stealing the credentials in
-   the process. Thus, the persistent storage feature is considered to only
-   minimally increase the risk involved.
-
-  &lt;p class=big-issue&gt;What about if someone is able to get a server up on a
-   port, and can then send people to that URI? They could steal all the data
-   with no further interaction. How about putting the port number at the end
-   of the string being compared? (Implicitly.)
-
-  &lt;h5 id=dns-spoofing&gt;&lt;span class=secno&gt;4.10.8.5. &lt;/span&gt;DNS spoofing attacks&lt;/h5&gt;
-
   &lt;p&gt;Because of the potential for DNS spoofing attacks, one cannot guarentee
    that a host claiming to be in a certain domain really is from that domain.
-   The &lt;code title=dom-StorageItem-secure&gt;&lt;a href=&quot;#secure&quot;&gt;secure&lt;/a&gt;&lt;/code&gt;
-   attribute is provided to mark certain key/value pairs as only being
-   accessible to pages that have been authenticated using secure certificates
-   (or similar mechanisms).
+   To mitigate this, pages can use SSL. Pages using SSL can be sure that only
+   pages using SSL that have certificates identifying them as being from the
+   same domain can access their global storage areas.
 
-  &lt;p&gt;Authors must ensure that they do not mark sensitive items as &quot;safe for
-   both secure and insecure content&quot;. (To prevent the risk of a race
-   condition, data stored by scripts in secure contexts default to being
-   marked as &quot;safe only for secure content&quot;.)
-
-  &lt;h5 id=cross-directory&gt;&lt;span class=secno&gt;4.10.8.6. &lt;/span&gt;Cross-directory
+  &lt;h5 id=cross-directory&gt;&lt;span class=secno&gt;4.10.7.4. &lt;/span&gt;Cross-directory
    attacks&lt;/h5&gt;
 
   &lt;p&gt;Different authors sharing one host name, for example users hosting
@@ -30441,47 +30061,7 @@
    usual DOM scripting security model would make it trivial to bypass this
    protection and access the data from any path.
 
-  &lt;h5 id=public&gt;&lt;span class=secno&gt;4.10.8.7. &lt;/span&gt;Public storage areas
-   corresponding to hosts&lt;/h5&gt;
-
-  &lt;p&gt;If a &quot;&lt;a href=&quot;#public0&quot; title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot; global
-   storage area corresponds to a host, as it typically does if for private
-   domains with third-party subdomains such as dyndns.org or uk.com, the host
-   corresponding to the &quot;public&quot; domain has access to all the storage areas
-   of its third-party subdomains. In general, authors are discouraged from
-   using the &lt;code title=dom-globalStorage&gt;&lt;a
-   href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt; API for sensitive data
-   unless the operators of all the domains involved are trusted.
-
-  &lt;p&gt;User agents may mitigate this problem by preventing hosts corresponding
-   to &quot;&lt;a href=&quot;#public0&quot; title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot; global
-   storage areas from accessing any storage areas other than their own.
-
-  &lt;h5 id=storage0&gt;&lt;span class=secno&gt;4.10.8.8. &lt;/span&gt;Storage areas in the
-   face of untrusted higher-level domains that do not correspond to public
-   storage areas&lt;/h5&gt;
-
-  &lt;p&gt;Authors should not store sensitive data using the global storage APIs if
-   there are hosts with fully-qualified domain names that are subsets of
-   their own which they do not trust. For example, an author at
-   &lt;code&gt;finance.members.example.net&lt;/code&gt; should not store sensitive
-   financial user data in the &lt;code&gt;finance.members.example.net&lt;/code&gt;
-   storage area if he does not trust the host that runs
-   &lt;code&gt;example.net&lt;/code&gt;.
-
-  &lt;h5 id=storage1&gt;&lt;span class=secno&gt;4.10.8.9. &lt;/span&gt;Storage areas in the
-   face of untrusted subdomains&lt;/h5&gt;
-
-  &lt;p&gt;If an author publishing content on one host, e.g.
-   &lt;code&gt;example.com&lt;/code&gt;, wishes to use the &lt;code
-   title=dom-globalStorage&gt;&lt;a href=&quot;#globalstorage&quot;&gt;globalStorage&lt;/a&gt;&lt;/code&gt;
-   API but does not wish any content on the host's subdomains to access the
-   data, the author should use an otherwise non-existent subdomain name,
-   e.g., &lt;code&gt;private.example.com&lt;/code&gt;, to store the data. This will be
-   accessible only to that host (and its parent domains), and not to any of
-   the real subdomains (e.g. &lt;code&gt;upload.example.com&lt;/code&gt;).
-
-  &lt;h5 id=implementation&gt;&lt;span class=secno&gt;4.10.8.10. &lt;/span&gt;Implementation
+  &lt;h5 id=implementation&gt;&lt;span class=secno&gt;4.10.7.5. &lt;/span&gt;Implementation
    risks&lt;/h5&gt;
 
   &lt;p&gt;The two primary risks when implementing this persistent storage feature
@@ -30502,25 +30082,9 @@
    known ID that the hostile site can then use to track the user's actions on
    the victim site.
 
-  &lt;p&gt;A risk is also presented by servers on local domains having host names
-   matching top-level domain names, for instance having a host called &quot;com&quot;
-   or &quot;net&quot;. Such hosts might, if implementations fail to correctly implement
-   the &lt;code&gt;.localdomain&lt;/code&gt; suffixing, &lt;!-- XXX cross ref --&gt; have full
-   access to all the data stored in a UA's persistent storage for that top
-   level domain.
-
   &lt;p&gt;Thus, strictly following the model described in this specification is
    important for user security.
 
-  &lt;p&gt;In addition, a number of optional restrictions related to the &quot;&lt;a
-   href=&quot;#public0&quot; title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot; global storage
-   areas are suggested in the previous sections. The design of this API is
-   intended to be such that not supporting these restrictions, or supporting
-   them less than perfectly, does not result in critical security problems.
-   However, implementations are still encouraged to create and maintain a
-   list of &quot;&lt;a href=&quot;#public0&quot; title=&quot;public storage area&quot;&gt;public&lt;/a&gt;&quot;
-   domains, and apply the restrictions described above.
-
   &lt;h3 id=sql&gt;&lt;span class=secno&gt;4.11. &lt;/span&gt;Client-side database storage&lt;/h3&gt;
   &lt;!-- Feature requests for future versions (v2):
         * deleting databases
@@ -34816,7 +34380,7 @@
 
   &lt;pre class=idl&gt;interface &lt;dfn id=messageevent&gt;MessageEvent&lt;/dfn&gt; : Event {
   readonly attribute DOMString &lt;a href=&quot;#data4&quot; title=dom-MessageEvent-data&gt;data&lt;/a&gt;;
-  readonly attribute DOMString &lt;a href=&quot;#domain2&quot; title=dom-MessageEvent-domain&gt;domain&lt;/a&gt;;
+  readonly attribute DOMString &lt;a href=&quot;#domain1&quot; title=dom-MessageEvent-domain&gt;domain&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=&quot;#uri&quot; title=dom-MessageEvent-uri&gt;uri&lt;/a&gt;;
   readonly attribute &lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt; &lt;a href=&quot;#source1&quot; title=dom-MessageEvent-source&gt;source&lt;/a&gt;;
   void &lt;a href=&quot;#initmessageevent&quot; title=dom-MessageEvent-initMessageEvent&gt;initMessageEvent&lt;/a&gt;(in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in DOMString dataArg, in DOMString domainArg, in DOMString uriArg, in Window sourceArg);
@@ -34834,7 +34398,7 @@
   &lt;p&gt;The &lt;dfn id=data4 title=dom-MessageEvent-data&gt;&lt;code&gt;data&lt;/code&gt;&lt;/dfn&gt;
    attribute represents the message being sent.
 
-  &lt;p&gt;The &lt;dfn id=domain2
+  &lt;p&gt;The &lt;dfn id=domain1
    title=dom-MessageEvent-domain&gt;&lt;code&gt;domain&lt;/code&gt;&lt;/dfn&gt; attribute
    represents, in &lt;a href=&quot;#cross-document&quot;&gt;cross-document messaging&lt;/a&gt;, the
    domain of the document from which the message came.
@@ -36287,7 +35851,7 @@
    the &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; argument to the &lt;code
    title=dom-window-postMessage&gt;&lt;a
    href=&quot;#postmessage&quot;&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, the &lt;code
-   title=dom-MessageEvent-domain&gt;&lt;a href=&quot;#domain2&quot;&gt;domain&lt;/a&gt;&lt;/code&gt;
+   title=dom-MessageEvent-domain&gt;&lt;a href=&quot;#domain1&quot;&gt;domain&lt;/a&gt;&lt;/code&gt;
    attribute must be set to the domain of the document that the script that
    invoked the methods is associated with, the &lt;code
    title=dom-MessageEvent-uri&gt;&lt;a href=&quot;#uri&quot;&gt;uri&lt;/a&gt;&lt;/code&gt; attribute must be
@@ -36311,7 +35875,7 @@
    and event listeners have been executed as appropriate).
 
   &lt;p class=warning&gt;Authors should check the &lt;code
-   title=dom-MessageEvent-domain&gt;&lt;a href=&quot;#domain2&quot;&gt;domain&lt;/a&gt;&lt;/code&gt;
+   title=dom-MessageEvent-domain&gt;&lt;a href=&quot;#domain1&quot;&gt;domain&lt;/a&gt;&lt;/code&gt;
    attribute to ensure that messages are only accepted from domains that they
    expect to receive messages from. Otherwise, bugs in the author's message
    handling code could be exploited by hostile sites.
@@ -47077,5 +46641,3 @@
     0x12 ('foo')
 
 --&gt;
-  &lt;script src=&quot;<A HREF="http://status.whatwg.org/annotate-web-apps.js">http://status.whatwg.org/annotate-web-apps.js</A>&quot;
-  type=&quot;text/javascript&quot;&gt;&lt;/script&gt;

Modified: source
===================================================================
--- source	2007-12-05 05:48:38 UTC (rev 1139)
+++ source	2007-12-11 01:14:16 UTC (rev 1140)
@@ -22340,7 +22340,7 @@
   // the user agent
   readonly attribute &lt;span&gt;ClientInformation&lt;/span&gt; &lt;span title=&quot;dom-navigator&quot;&gt;navigator&lt;/span&gt;; &lt;!-- XXX IE6 also has window.clientInformation pointing to this same object --&gt;
   readonly attribute &lt;span&gt;Storage&lt;/span&gt; &lt;span title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/span&gt;;
-  readonly attribute &lt;span&gt;StorageList&lt;/span&gt; &lt;span title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/span&gt;;
+  readonly attribute &lt;span&gt;Storage&lt;/span&gt; &lt;span title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/span&gt;;
   &lt;span&gt;Database&lt;/span&gt; &lt;span title=&quot;dom-opendatabase&quot;&gt;openDatabase&lt;/span&gt;(in DOMString name, in DOMString version, in DOMString displayName, in unsigned long estimatedSize);
 
   // modal user prompts
@@ -27103,7 +27103,7 @@
   &lt;p&gt;To address this, this specification introduces the &lt;code
   title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; DOM attribute.
   Sites can add data to the session storage, and it will be accessible
-  to any page from that domain opened in that window.&lt;/p&gt;
+  to any page from that &lt;span&gt;origin&lt;/span&gt; opened in that window.&lt;/p&gt;
 
   &lt;div class=&quot;example&quot;&gt;
 
@@ -27149,7 +27149,7 @@
   transmitted with every request.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; DOM
-  attribute is used to access the global storage areas.&lt;/p&gt;
+  attribute is used to access a page's global storage area.&lt;/p&gt;
 
   &lt;div class=&quot;example&quot;&gt;
 
@@ -27163,26 +27163,16 @@
   time(s).
 &lt;/p&gt;
 &lt;script&gt;
-  var storage = globalStorage['example.com'];
-  if (!storage.pageLoadCount)
-    storage.pageLoadCount = 0;
-  storage.pageLoadCount = parseInt(storage.pageLoadCount, 10) + 1;
-  document.getElementById('count').textContent = storage.pageLoadCount;
+  if (!globalStorage.pageLoadCount)
+    globalStorage.pageLoadCount = 0;
+  globalStorage.pageLoadCount = parseInt(globalStorage.pageLoadCount, 10) + 1;
+  document.getElementById('count').textContent = globalStorage.pageLoadCount;
 &lt;/script&gt;&lt;/pre&gt;
 
   &lt;/div&gt;
 
-  &lt;p&gt;Each domain and each subdomain has its own separate storage area.
-  Subdomains can access the storage areas of parent domains, and
-  domains can access the storage areas of subdomains.&lt;/p&gt;
+  &lt;p&gt;Each &lt;span&gt;origin&lt;/span&gt; has its own separate storage area.&lt;/p&gt;
 
-  &lt;ul class=&quot;brief&quot;&gt;
-   &lt;li&gt;&lt;code&gt;globalStorage['']&lt;/code&gt; is accessible to all domains.&lt;/li&gt;
-   &lt;li&gt;&lt;code&gt;globalStorage['com']&lt;/code&gt; is accessible to all .com domains&lt;/li&gt;
-   &lt;li&gt;&lt;code&gt;globalStorage['example.com']&lt;/code&gt; is accessible to example.com and any of its subdomains&lt;/li&gt;
-   &lt;li&gt;&lt;code&gt;globalStorage['www.example.com']&lt;/code&gt; is accessible to www.example.com and example.com, but not www2.example.com.&lt;/li&gt;
-  &lt;/ul&gt;
-
   &lt;p&gt;Storage areas (both session storage and global storage) store
   strings. To store structured data in a storage area, you must first
   convert it to a string.&lt;/p&gt;
@@ -27194,17 +27184,19 @@
 interface &lt;dfn&gt;Storage&lt;/dfn&gt; {
   readonly attribute unsigned long &lt;span title=&quot;dom-Storage-length&quot;&gt;length&lt;/span&gt;;
   DOMString &lt;span title=&quot;dom-Storage-key&quot;&gt;key&lt;/span&gt;(in unsigned long index);
-  &lt;span&gt;StorageItem&lt;/span&gt; &lt;span title=&quot;dom-Storage-getItem&quot;&gt;getItem&lt;/span&gt;(in DOMString key);
+  DOMString &lt;span title=&quot;dom-Storage-getItem&quot;&gt;getItem&lt;/span&gt;(in DOMString key);
   void &lt;span title=&quot;dom-Storage-setItem&quot;&gt;setItem&lt;/span&gt;(in DOMString key, in DOMString data);
   void &lt;span title=&quot;dom-Storage-removeItem&quot;&gt;removeItem&lt;/span&gt;(in DOMString key);
 };&lt;/pre&gt;
 
   &lt;p&gt;Each &lt;code&gt;Storage&lt;/code&gt; object provides access to a list of
-  key/value pairs, which are sometimes called items. Keys are strings,
-  and any string (including the empty string) is a valid key. Values
-  are strings with associated metadata, represented by
-  &lt;code&gt;StorageItem&lt;/code&gt; objects.&lt;/p&gt;
+  key/value pairs, which are sometimes called items. Keys and values
+  are strings. Any string (including the empty string) is a valid
+  key.&lt;/p&gt;
 
+  &lt;p class=&quot;note&quot;&gt;To store more structured data, authors may consider
+  using the &lt;a href=&quot;#sql&quot;&gt;SQL interfaces&lt;/a&gt; instead.&lt;/p&gt;
+
   &lt;p&gt;Each &lt;code&gt;Storage&lt;/code&gt; object is associated with a list of
   key/value pairs when it is created, as defined in the sections on
   the &lt;code title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; and &lt;code
@@ -27213,25 +27205,13 @@
   all be associated with the same list of key/value pairs
   simultaneously.&lt;/p&gt;
 
-  &lt;p&gt;Key/value pairs have associated metadata. In particular, a
-  key/value pair can be marked as either &quot;safe only for secure
-  content&quot;, or as &quot;safe for both secure and insecure content&quot;.&lt;/p&gt;
-
-  &lt;p&gt;A key/value pair is &lt;dfn title=&quot;accessible keys&quot;&gt;accessible&lt;/dfn&gt;
-  if either it is marked as &quot;safe for both secure and insecure
-  content&quot;, or it is marked as &quot;safe only for secure content&quot; and the
-  script in question is running in a &lt;span&gt;secure browsing
-  context&lt;/span&gt;&lt;!-- XXX xref --&gt;.&lt;/p&gt;
-
   &lt;p&gt;The &lt;dfn title=&quot;dom-Storage-length&quot;&gt;&lt;code&gt;length&lt;/code&gt;&lt;/dfn&gt;
   attribute must return the number of key/value pairs currently
-  present and &lt;span title=&quot;accessible keys&quot;&gt;accessible&lt;/span&gt; in the
-  list associated with the object.&lt;/p&gt;
+  present in the list associated with the object.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-Storage-key&quot;&gt;&lt;code&gt;key(&lt;var
   title=&quot;&quot;&gt;n&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the name of the
-  &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th &lt;span title=&quot;accessible
-  keys&quot;&gt;accessible&lt;/span&gt; key in the list. The order of keys is
+  &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th key in the list. The order of keys is
   user-agent defined, but must be consistent within an object between
   changes to the number of keys. (Thus, &lt;span
   title=&quot;dom-Storage-setItem&quot;&gt;adding&lt;/span&gt; or &lt;span
@@ -27245,17 +27225,10 @@
   method must raise an &lt;code&gt;INDEX_SIZE_ERR&lt;/code&gt; exception.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-Storage-getItem&quot;&gt;&lt;code&gt;getItem(&lt;var
-  title=&quot;&quot;&gt;key&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the
-  &lt;code&gt;StorageItem&lt;/code&gt; object representing the key/value pair with
-  the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt;. If the given &lt;var
-  title=&quot;&quot;&gt;key&lt;/var&gt; does not exist in the list associated with the
-  object, or is not &lt;span title=&quot;accessible keys&quot;&gt;accessible&lt;/span&gt;,
-  then this method must return null. Subsequent calls to this method
-  with the same key from scripts running in the same &lt;span&gt;security
-  context&lt;/span&gt; must return the same instance of the
-  &lt;code&gt;StorageItem&lt;/code&gt; interface. (Such instances must not be
-  shared across security contexts, though.)&lt;/p&gt; &lt;!-- XXX define
-  security context --&gt;
+  title=&quot;&quot;&gt;key&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the current
+  value associated with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt;. If the
+  given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; does not exist in the list associated
+  with the object then this method must return null.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-Storage-setItem&quot;&gt;&lt;code&gt;setItem(&lt;var
   title=&quot;&quot;&gt;key&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;value&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method
@@ -27265,29 +27238,16 @@
 
   &lt;p&gt;If it does not, then a new key/value pair must be added to the
   list, with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; and &lt;var
-  title=&quot;&quot;&gt;value&lt;/var&gt;, such that any current or future
-  &lt;code&gt;StorageItem&lt;/code&gt; objects referring to this key/value pair
-  will return the value given in the &lt;var title=&quot;&quot;&gt;value&lt;/var&gt;
-  argument. If the script setting the value is running in a
-  &lt;span&gt;secure browsing context&lt;/span&gt;, then the key/value pair must
-  be marked as &quot;safe only for secure content&quot;, otherwise it must be
-  marked as &quot;safe for both secure and insecure content&quot;.&lt;/p&gt;
+  title=&quot;&quot;&gt;value&lt;/var&gt;.&lt;/p&gt;
 
   &lt;p&gt;If the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; &lt;em&gt;does&lt;/em&gt; exist in the
-  list, then, if the key/value pair with the given &lt;var
-  title=&quot;&quot;&gt;key&lt;/var&gt; is &lt;span title=&quot;accessible
-  keys&quot;&gt;accessible&lt;/span&gt;, it must have its value updated so that any
-  current or future &lt;code&gt;StorageItem&lt;/code&gt; objects referring to this
-  key/value pair will return the value given in the &lt;var
-  title=&quot;&quot;&gt;value&lt;/var&gt; argument. If it is &lt;em&gt;not&lt;/em&gt; &lt;span
-  title=&quot;accessible keys&quot;&gt;accessible&lt;/span&gt;, the method must raise a
-  &lt;span&gt;security exception&lt;/span&gt;.&lt;/p&gt;
+  list, then it must have its value updated to the value given in the
+  &lt;var title=&quot;&quot;&gt;value&lt;/var&gt; argument.&lt;/p&gt;
 
   &lt;p&gt;When the &lt;code title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt;
-  method is successfully invoked (i.e. when it doesn't raise an
-  exception), events are fired on other &lt;code&gt;HTMLDocument&lt;/code&gt;
-  objects that can access the newly stored data, as defined in the
-  sections on the &lt;code
+  method is invoked, events are fired on other
+  &lt;code&gt;HTMLDocument&lt;/code&gt; objects that can access the newly stored
+  data, as defined in the sections on the &lt;code
   title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; and &lt;code
   title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; attributes.&lt;/p&gt; &lt;!--
   not normative, see the sections below for the normative statement
@@ -27296,11 +27256,8 @@
   &lt;p&gt;The &lt;dfn title=&quot;dom-Storage-removeItem&quot;&gt;&lt;code&gt;removeItem(&lt;var
   title=&quot;&quot;&gt;key&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must cause the key/value
   pair with the given &lt;var title=&quot;&quot;&gt;key&lt;/var&gt; to be removed from the
-  list associated with the object, if it exists and is &lt;span
-  title=&quot;accessible keys&quot;&gt;accessible&lt;/span&gt;. If no item with that key
-  exists, the method must do nothing. If an item with that key exists
-  but is not &lt;span title=&quot;accessible keys&quot;&gt;accessible&lt;/span&gt;, the
-  method must raise a &lt;span&gt;security exception&lt;/span&gt;.&lt;/p&gt;
+  list associated with the object, if it exists. If no item with that
+  key exists, the method must do nothing.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt; and &lt;code
   title=&quot;dom-Storage-removeItem&quot;&gt;removeItem()&lt;/code&gt; methods must be
@@ -27309,10 +27266,9 @@
   changed at all.&lt;/p&gt;
 
   &lt;p&gt;In the ECMAScript DOM binding, enumerating a &lt;code&gt;Storage&lt;/code&gt;
-  object must enumerate through the currently stored and &lt;span
-  title=&quot;accessible keys&quot;&gt;accessible&lt;/span&gt; keys in the list the
-  object is associated with. (It must not enumerate the values or the
-  actual members of the interface). In the ECMAScript DOM binding,
+  object must enumerate through the currently stored keys in the list
+  the object is associated with. (It must not enumerate the values or
+  the actual members of the interface). In the ECMAScript DOM binding,
   &lt;code&gt;Storage&lt;/code&gt; objects must support dereferencing such that
   getting a property that is not a member of the object (i.e. is
   neither a member of the &lt;code&gt;Storage&lt;/code&gt; interface nor of &lt;code
@@ -27324,76 +27280,15 @@
   as the second argument.&lt;/p&gt;
 
 
-  &lt;h4&gt;The &lt;code&gt;StorageItem&lt;/code&gt; interface&lt;/h4&gt;
-
-  &lt;p&gt;Items in &lt;code&gt;Storage&lt;/code&gt; objects are represented by objects
-  implementing the &lt;code&gt;StorageItem&lt;/code&gt; interface.&lt;/p&gt;
-
-  &lt;pre class=&quot;idl&quot;&gt;
-interface &lt;dfn&gt;StorageItem&lt;/dfn&gt; {
-           attribute boolean &lt;span title=&quot;dom-StorageItem-secure&quot;&gt;secure&lt;/span&gt;;
-           attribute DOMString &lt;span title=&quot;dom-StorageItem-value&quot;&gt;value&lt;/span&gt;;
-};&lt;/pre&gt;
-
-  &lt;p&gt;In the ECMAScript DOM binding, &lt;code&gt;StorageItem&lt;/code&gt; objects must
-  stringify to their &lt;code title=&quot;dom-StorageItem-value&quot;&gt;value&lt;/code&gt;
-  attribute's value.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn title=&quot;dom-StorageItem-value&quot;&gt;&lt;code&gt;value&lt;/code&gt;&lt;/dfn&gt;
-  attribute must return the current value of the key/value pair
-  represented by the object. When the attribute is set, the user agent
-  must invoke the &lt;code title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt;
-  method of the &lt;code&gt;Storage&lt;/code&gt; object that the
-  &lt;code&gt;StorageItem&lt;/code&gt; object is associated with, with the key
-  that the &lt;code&gt;StorageItem&lt;/code&gt; object is associated with as the
-  first argument, and the new given value of the attribute as the
-  second argument.&lt;/p&gt;
-
-  &lt;p&gt;&lt;code&gt;StorageItem&lt;/code&gt; objects must be &lt;em&gt;live&lt;/em&gt;, meaning
-  that as the underlying &lt;code&gt;Storage&lt;/code&gt; object has its key/value
-  pairs updated, the &lt;code&gt;StorageItem&lt;/code&gt; objects must always
-  return the actual value of the key/value pair they represent.&lt;/p&gt;
-
-  &lt;p&gt;If the key/value pair has been deleted, the
-  &lt;code&gt;StorageItem&lt;/code&gt; object must act as if its value was the
-  empty string. On setting, the key/value pair will be recreated.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn title=&quot;dom-StorageItem-secure&quot;&gt;&lt;code&gt;secure&lt;/code&gt;&lt;/dfn&gt;
-  attribute must raise an &lt;code&gt;INVALID_ACCESS_ERR&lt;/code&gt; exception
-  when accessed or set from a script whose browsing context is not
-  &lt;span title=&quot;secure browsing context&quot;&gt;considered secure&lt;/span&gt;&lt;!--
-  XXX xref --&gt;. (Basically, if the page is not an SSL page.)&lt;/p&gt;
-
-  &lt;p&gt;If the browsing context &lt;em&gt;is&lt;/em&gt; secure, then the &lt;code
-  title=&quot;dom-StorageItem-secure&quot;&gt;secure&lt;/code&gt; attribute must return
-  true if the key/value pair is considered &quot;safe only for secure
-  content&quot;, and false if it is considered &quot;safe for both secure and
-  insecure content&quot;. If it is set to true, then the key/value pair
-  must be flagged as &quot;safe only for secure content&quot;. If it is set to
-  false, then the key/value pair must be flagged as &quot;safe for both
-  secure and insecure content&quot;.&lt;/p&gt;
-
-  &lt;p&gt;If a &lt;code&gt;StorageItem&lt;/code&gt; object is obtained by a script that
-  is not running in a &lt;span&gt;secure browsing context&lt;/span&gt;, and the
-  item is then marked with the &quot;safe only for secure content&quot; flag by
-  a script that &lt;em&gt;is&lt;/em&gt; running in a secure context, the
-  &lt;code&gt;StorageItem&lt;/code&gt; object must continue to be available to the
-  first script, who will be able to read the value of the
-  object. However, any attempt to &lt;em&gt;set&lt;/em&gt; the value would then
-  start raising exceptions as described in the previous section, and
-  the key/value pair would no longer appear in the appropriate
-  &lt;code&gt;Storage&lt;/code&gt; object.&lt;/p&gt;
-
-
   &lt;h4&gt;The &lt;code title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; attribute&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn
   title=&quot;dom-sessionStorage&quot;&gt;&lt;code&gt;sessionStorage&lt;/code&gt;&lt;/dfn&gt;
-  attribute represents the storage area specific to the current
-  &lt;span&gt;top-level browsing context&lt;/span&gt;.&lt;/p&gt;
+  attribute represents the set of storage areas specific to the
+  current &lt;span&gt;top-level browsing context&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;Each &lt;span&gt;top-level browsing context&lt;/span&gt; has a unique set of
-  session storage areas, one for each domain.&lt;/p&gt;
+  session storage areas, one for each &lt;span&gt;origin&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;User agents should not expire data from a browsing context's
   session storage areas, but may do so when the user requests that
@@ -27413,13 +27308,14 @@
   &lt;p&gt;When a new &lt;code&gt;HTMLDocument&lt;/code&gt; is created, the user agent
   must check to see if the document's &lt;span&gt;top-level browsing
   context&lt;/span&gt; has allocated a session storage area for that
-  &lt;span&gt;document's domain&lt;/span&gt;. If it has not, a new storage area
-  for that document's domain must be created.&lt;/p&gt;
+  document's &lt;span&gt;origin&lt;/span&gt;. If it has not, a new storage area
+  for that document's origin must be created.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code&gt;Storage&lt;/code&gt; object for the document's associated
   &lt;code&gt;Window&lt;/code&gt; object's &lt;code
   title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; attribute must then
-  be associated with the domain's session storage area.&lt;/p&gt;
+  be associated with that &lt;span&gt;origin&lt;/span&gt;'s session storage area
+  for that &lt;span&gt;top-level browsing context&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;When a new &lt;span&gt;top-level browsing context&lt;/span&gt; is created by
   cloning an existing &lt;span&gt;browsing context&lt;/span&gt;, the new browsing
@@ -27430,23 +27326,22 @@
   &lt;p&gt;When a new &lt;span&gt;top-level browsing context&lt;/span&gt; is created by
   a script in an existing &lt;span&gt;browsing context&lt;/span&gt;, or by the
   user following a link in an existing browsing context, or in some
-  other way related to a specific &lt;code&gt;HTMLDocument&lt;/code&gt;, then,
-  if the new context's first &lt;code&gt;HTMLDocument&lt;/code&gt; has the same
-  &lt;span title=&quot;document's domain&quot;&gt;domain&lt;/span&gt; as the
-  &lt;code&gt;HTMLDocument&lt;/code&gt; from which the new context was created,
-  the new browsing context must start with a single session storage
-  area. That storage area must be a copy of that domain's session
-  storage area in the original browsing context, which from that point
-  on must be considered separate, with the two storage areas not
-  affecting each other in any way.&lt;/p&gt;
+  other way related to a specific &lt;code&gt;HTMLDocument&lt;/code&gt;, then, if
+  the new context's first &lt;code&gt;HTMLDocument&lt;/code&gt; has the same
+  &lt;span&gt;origin&lt;/span&gt; as the &lt;code&gt;HTMLDocument&lt;/code&gt; from which the
+  new context was created, the new browsing context must start with a
+  single session storage area. That storage area must be a copy of
+  that origin's session storage area in the original top-level
+  browsing context, which from that point on must be considered
+  separate, with the two storage areas not affecting each other in any
+  way.&lt;/p&gt;
 
   &lt;!-- XXX define the case for window.open() --&gt;
 
   &lt;p id=&quot;sessionStorageEvent&quot;&gt;When the &lt;code
   title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt; method is called on a
   &lt;code&gt;Storage&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; that is associated
-  with a session storage area, then, if the method does not raise a
-  &lt;span&gt;security exception&lt;/span&gt;, in every &lt;code&gt;HTMLDocument&lt;/code&gt;
+  with a session storage area, then in every &lt;code&gt;HTMLDocument&lt;/code&gt;
   object whose &lt;code&gt;Window&lt;/code&gt; object's &lt;code
   title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; attribute's
   &lt;code&gt;Storage&lt;/code&gt; object is associated with the same storage
@@ -27457,24 +27352,12 @@
 
   &lt;h4&gt;The &lt;code title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; attribute&lt;/h4&gt;
 
-  &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;StorageList&lt;/dfn&gt; {
-  &lt;span&gt;Storage&lt;/span&gt; &lt;span title=&quot;dom-Storagelist-namedItem&quot;&gt;namedItem&lt;/span&gt;(in DOMString domain);
-};&lt;/pre&gt;
-
   &lt;p&gt;The &lt;dfn
-  title=&quot;dom-globalStorage&quot;&gt;&lt;code&gt;globalStorage&lt;/code&gt;&lt;/dfn&gt;
-  object provides a &lt;code&gt;Storage&lt;/code&gt; object for each domain.&lt;/p&gt;
+  title=&quot;dom-globalStorage&quot;&gt;&lt;code&gt;globalStorage&lt;/code&gt;&lt;/dfn&gt; object
+  provides a &lt;code&gt;Storage&lt;/code&gt; object for &lt;span&gt;origin&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;In the ECMAScript DOM binding, &lt;code&gt;StorageList&lt;/code&gt; objects
-  must support dereferencing such that getting a property that is not
-  a member of the object (i.e. is neither a member of the
-  &lt;code&gt;StorageList&lt;/code&gt; interface nor of &lt;code
-  title=&quot;dom-Object&quot;&gt;Object&lt;/code&gt;) must invoke the &lt;code
-  title=&quot;dom-Storagelist-namedItem&quot;&gt;namedItem()&lt;/code&gt; method with the
-  property's name as the argument.&lt;/p&gt;
-
   &lt;p&gt;User agents must have a set of global storage areas, one for each
-  domain.&lt;/p&gt;
+  &lt;span&gt;origin&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;User agents should only expire data from the global storage areas
   for security reasons or when requested to do so by the user. User
@@ -27484,144 +27367,28 @@
   Web applications will use the global storage areas for storing
   user-written documents.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn title=&quot;dom-Storagelist-namedItem&quot;&gt;&lt;code&gt;namedItem(&lt;var
-  title=&quot;&quot;&gt;domain&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method tries to returns a
-  &lt;code&gt;Storage&lt;/code&gt; object associated with the given domain,
-  according to the rules that follow.&lt;/p&gt;
+  &lt;p&gt;When the &lt;code title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt;
+  attribute is accessed, the user agent must check to see if it has
+  allocated global storage area for the &lt;span&gt;origin&lt;/span&gt; of the
+  &lt;span&gt;browsing context&lt;/span&gt; within which the script is running. If
+  it has not, a new storage area for that origin must be created.&lt;/p&gt;
 
-  &lt;div id=&quot;splitDomain&quot;&gt;
-
-   &lt;p&gt;The &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; must first be split into an array
-   of strings, by splitting the string at &quot;.&quot; characters (U+002E FULL
-   STOP). If the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument is the empty
-   string, then the array is empty as well. If the &lt;var
-   title=&quot;&quot;&gt;domain&lt;/var&gt; argument is not empty but has no dots, then
-   the array has one item, which is equal to the &lt;var
-   title=&quot;&quot;&gt;domain&lt;/var&gt; argument. If the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt;
-   argument contains consecutive dots, there will be empty strings in
-   the array (e.g. the string &quot;hello..world&quot; becomes split into the
-   three strings &quot;hello&quot;, &quot;&quot;, and &quot;world&quot;, with the middle one being
-   the empty string).&lt;/p&gt;
-
-   &lt;p&gt;Each component of the array must then have the IDNA ToASCII
-   algorithm applied to it, with both the AllowUnassigned and
-   UseSTD3ASCIIRules flags set. &lt;a href=&quot;#refsRFC3490&quot;&gt;[RFC3490]&lt;/a&gt;
-   If ToASCII fails to convert one of the components of the string,
-   e.g. because it is too long or because it contains invalid
-   characters, then the user agent must raise a
-   &lt;code&gt;SYNTAX_ERR&lt;/code&gt; exception. &lt;a
-   href=&quot;#refsDOM3CORE&quot;&gt;[DOM3CORE]&lt;/a&gt; The components after this step
-   consist of only US-ASCII characters.&lt;/p&gt;
-
-   &lt;p&gt;The components of the array must then be converted to lowercase.
-   Since only US-ASCII is involved at this step, this only requires
-   converting characters in the range A-Z to the corresponding
-   characters in the range a-z.&lt;/p&gt;
-
-  &lt;/div&gt;
-
-  &lt;p&gt;The resulting array is used in a comparison with another array,
-  as described below. In addition, its components are concatenated
-  together, each part separated by a dot (U+002E), to form the
-  &lt;dfn&gt;normalised requested domain&lt;/dfn&gt;.&lt;/p&gt;
-
-  &lt;p class=&quot;example&quot;&gt;If the original &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; was
-  &quot;&Aring;sg&aring;rd.Example.Com&quot;, then the resulting array would
-  have the three items &quot;xn--sgrd-poac&quot;, &quot;example&quot;, and &quot;com&quot;, and the
-  normalised requested domain would be
-  &quot;xn--sgrd-poac.example.com&quot;.&lt;/p&gt;
-
-  &lt;p&gt;Next, the domain part of the tuple forming the calling script's
-  &lt;span&gt;origin&lt;/span&gt; is processed to find if it is allowed to access
-  the requested domain.&lt;/p&gt;
-
-  &lt;p&gt;If the script's origin has no domain part, e.g. if only the
-  server's IP address is known, and the &lt;span&gt;normalised requested
-  domain&lt;/span&gt; is not the empty string, then the user agent must
-  raise a &lt;span&gt;security exception&lt;/span&gt;.&lt;/p&gt;
-
-  &lt;p class=&quot;note&quot;&gt;If the &lt;span&gt;normalised requested domain&lt;/span&gt; is
-  the empty string, then the rest of this algorithm can be skipped.
-  This is because in that situation, the comparison of the two arrays
-  below will always find them to be the same &mdash; the first array
-  in such a situation is also empty and so permission to access that
-  storage area will always be given.&lt;/p&gt;
-
-  &lt;p&gt;If the domain part of the script's origin contains no dots
-  (U+002E) then the string &quot;&lt;code&gt;.localdomain&lt;/code&gt;&quot; must be
-  appended to the script's domain.&lt;/p&gt;
-
-  &lt;p&gt;Then, the domain part of the script's origin must be turned into
-  an array, being split, converted to ASCII, and lowercased as
-  described for the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument &lt;a
-  href=&quot;#splitDomain&quot;&gt;above&lt;/a&gt;.&lt;/p&gt;
-
-  &lt;p&gt;Of the two arrays, the longest one must then be shortened to the
-  length of the shorter one, by dropping items from the start of the
-  array.&lt;/p&gt;
-
-  &lt;div class=&quot;example&quot;&gt;
-
-   &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; argument is &quot;www.example.com&quot;
-   and the script origin's domain part is &quot;example.com&quot; then the first
-   array will be a three item array (&quot;www&quot;, &quot;example&quot;, &quot;com&quot;), and the
-   second will be a two item array (&quot;example&quot;, &quot;com&quot;). The first array
-   is therefore shortened, dropping the leading parts, making both
-   into the same array (&quot;example&quot;, &quot;com&quot;).&lt;/p&gt;
-
-  &lt;/div&gt;
-
-  &lt;p&gt;If the two arrays are not component-for-component identical in
-  literal string comparisons, then the user agent must then raise a
-  &lt;span&gt;security exception&lt;/span&gt;.&lt;/p&gt;
-
-  &lt;p&gt;Otherwise, the user agent must check to see if it has allocated
-  global storage area for the &lt;span&gt;normalised requested
-  domain&lt;/span&gt;. If it has not, a new storage area for that domain
-  must be created.&lt;/p&gt;
-
   &lt;p&gt;The user agent must then create a &lt;code&gt;Storage&lt;/code&gt; object
-  associated with that domain's global storage area, and return
+  associated with that origin's global storage area, and return
   it.&lt;/p&gt;
 
-  &lt;p&gt;When the requested &lt;var title=&quot;&quot;&gt;domain&lt;/var&gt; is a top level
-  domain, or the empty string, or a country-specific sub-domain like
-  &quot;co.uk&quot; or &quot;ca.us&quot;, the associated global storage area is known as
-  &lt;dfn&gt;public storage area&lt;/dfn&gt;&lt;/p&gt;
+  &lt;p id=&quot;globalStorageEvent&quot;&gt;When the &lt;code
+  title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt; method is called on a
+  &lt;code&gt;Storage&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; that is associated
+  with a global storage area, then in every &lt;code&gt;HTMLDocument&lt;/code&gt;
+  object whose &lt;code&gt;Window&lt;/code&gt; object's &lt;code
+  title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; attribute's
+  &lt;code&gt;Storage&lt;/code&gt; object is associated with the same storage
+  area, other than &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, a &lt;code
+  title=&quot;event-storage&quot;&gt;storage&lt;/code&gt; event must be fired, as &lt;span
+  title=&quot;event-storage&quot;&gt;described below&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;div id=&quot;globalStorageEvent&quot;&gt;
 
-   &lt;p&gt;The &lt;code title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt; method
-   might be called on a &lt;code&gt;Storage&lt;/code&gt; object that is associated
-   with a global storage area for a domain &lt;var title=&quot;&quot;&gt;d&lt;/var&gt;,
-   created by a &lt;code&gt;StorageList&lt;/code&gt; object associated with a
-   &lt;code&gt;Window&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;. Whenever this
-   occurs, if the method didn't raise an exception, a &lt;code
-   title=&quot;event-storage&quot;&gt;storage&lt;/code&gt; event must be fired, as
-   described below, in every &lt;code&gt;HTMLDocument&lt;/code&gt; object that
-   matches the following conditions:&lt;/p&gt;
-
-   &lt;ul&gt;
-
-    &lt;li&gt;Its &lt;code&gt;Window&lt;/code&gt; object is not &lt;var
-    title=&quot;&quot;&gt;x&lt;/var&gt;, and&lt;/li&gt;
-
-    &lt;li&gt;Its &lt;code&gt;Window&lt;/code&gt; object's &lt;code
-    title=&quot;dom-sessionStorage&quot;&gt;globalStorage&lt;/code&gt; attribute's
-    &lt;code&gt;StorageList&lt;/code&gt; object's &lt;code
-    title=&quot;dom-Storagelist-namedItem&quot;&gt;namedItem()&lt;/code&gt; method would
-    not raise a &lt;span&gt;security exception&lt;/span&gt; according to the rules
-    above if it was invoked with the domain &lt;var
-    title=&quot;&quot;&gt;d&lt;/var&gt;.&lt;/li&gt;
-
-   &lt;/ul&gt;
-
-   &lt;p&gt;In other words, every other document that has access to that
-   domain's global storage area is notified of the change.&lt;/p&gt;
-
-  &lt;/div&gt;
-
-
   &lt;h4&gt;The &lt;code title=&quot;event-storage&quot;&gt;storage&lt;/code&gt; event&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;event-storage&quot;&gt;&lt;code&gt;storage&lt;/code&gt;&lt;/dfn&gt; event
@@ -27630,51 +27397,26 @@
   href=&quot;#sessionStorageEvent&quot;&gt;for session storage&lt;/a&gt;, &lt;a
   href=&quot;#globalStorageEvent&quot;&gt;for global storage&lt;/a&gt;).&lt;/p&gt;
 
-  &lt;p&gt;When this happens, a &lt;code&gt;storage&lt;/code&gt; event in no namespace,
-  which bubbles, is not cancelable, has no default action, and which
-  uses the &lt;code&gt;StorageEvent&lt;/code&gt; interface described below, must
-  be fired on &lt;span&gt;the body element&lt;/span&gt;.&lt;/p&gt;
+  &lt;p&gt;When this happens, the user agent must &lt;span&gt;fire a simple
+  event&lt;/span&gt; called &lt;code&gt;storage&lt;/code&gt; on &lt;span&gt;the body
+  element&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;However, it is possible (indeed, for session storage areas,
-  likely) that the target &lt;code&gt;HTMLDocument&lt;/code&gt; object is not
-  active at that time. For example, it might not be the &lt;span&gt;current
-  entry&lt;/span&gt; in the session history; user agents typically stop
-  scripts from running in pages that are in the history. In such
-  cases, the user agent must instead delay the firing of the event
-  until such time as the &lt;code&gt;HTMLDocument&lt;/code&gt; object in
-  question becomes active again.&lt;/p&gt;
+  likely) that the target's &lt;code&gt;HTMLDocument&lt;/code&gt; object is not an
+  &lt;span&gt;active document&lt;/span&gt; at that time. In such cases, the user
+  agent must instead delay the firing of the event until such time as
+  the &lt;code&gt;HTMLDocument&lt;/code&gt; object in question becomes an
+  &lt;span&gt;active document&lt;/span&gt; again.&lt;/p&gt;
 
   &lt;p&gt;When there are multiple delayed &lt;code&gt;storage&lt;/code&gt; events for
-  the same &lt;code&gt;HTMLDocument&lt;/code&gt; object, user agents should
-  coalesce events with the same &lt;code
-  title=&quot;dom-Storageevent-domain&quot;&gt;domain&lt;/code&gt; value (dropping
-  duplicates).&lt;/p&gt;
+  the same &lt;code&gt;HTMLDocument&lt;/code&gt; object, user agents must coalesce
+  those events such that only one event fires when the document
+  becomes active again.&lt;/p&gt;
 
   &lt;p&gt;If the DOM of a page that has delayed &lt;code&gt;storage&lt;/code&gt; events
   queued up is &lt;span title=&quot;discard&quot;&gt;discarded&lt;/span&gt;, then the
   delayed events are dropped as well.&lt;/p&gt;
 
-  &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;StorageEvent&lt;/dfn&gt; : Event {
-  readonly attribute DOMString &lt;span title=&quot;dom-StorageEvent-domain&quot;&gt;domain&lt;/span&gt;;
-  void &lt;span title=&quot;dom-StorageEvent-initStorageEvent&quot;&gt;initStorageEvent&lt;/span&gt;(in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in DOMString domainArg);
-  void &lt;span title=&quot;dom-StorageEvent-initStorageEventNS&quot;&gt;initStorageEventNS&lt;/span&gt;(in DOMString namespaceURIArg, in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in DOMString domainArg);
-};&lt;/pre&gt;
-
-  &lt;p&gt;The &lt;dfn
-  title=&quot;dom-StorageEvent-initStorageEvent&quot;&gt;&lt;code&gt;initStorageEvent()&lt;/code&gt;&lt;/dfn&gt;
-  and &lt;dfn
-  title=&quot;dom-StorageEvent-initStorageEventNS&quot;&gt;&lt;code&gt;initStorageEventNS()&lt;/code&gt;&lt;/dfn&gt;
-  methods must initialise the event in a manner analogous to the
-  similarly-named methods in the DOM3 Events interfaces. &lt;a
-  href=&quot;#refsDOM3EVENTS&quot;&gt;[DOM3EVENTS]&lt;/a&gt;&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn
-  title=&quot;dom-StorageEvent-domain&quot;&gt;&lt;code&gt;domain&lt;/code&gt;&lt;/dfn&gt; attribute
-  of the &lt;code&gt;StorageEvent&lt;/code&gt; event object must be set to the
-  name of the domain associated with the storage area that changed if
-  that storage area is a global storage area, or the string
-  &quot;&lt;code&gt;#session&lt;/code&gt;&quot; if it was a session storage area.&lt;/p&gt;
-
   &lt;!-- XXX onstorage should be defined --&gt;
 
 
@@ -27683,20 +27425,14 @@
   &lt;h5&gt;Disk space&lt;/h5&gt;
 
   &lt;p&gt;User agents should limit the total amount of space allowed for a
-  domain based on the domain of the page setting the value.&lt;/p&gt;
+  storage area based on the domain of the page setting the value.&lt;/p&gt;
 
   &lt;p&gt;User agents should not limit the total amount of space allowed on
   a per-storage-area basis, otherwise a site could just store data in
-  any number of subdomains, e.g. storing up to the limit in
+  any number of subdomains or ports, e.g. storing up to the limit in
   a1.example.com, a2.example.com, a3.example.com, etc, circumventing
   per-domain limits.&lt;/p&gt;
 
-  &lt;p&gt;User agents should consider additional quota mechanisms (for
-  example limiting the amount of space provided to a domain's
-  subdomains as a group) so that hostile authors can't run scripts
-  from multiple subdomains all adding data to the global storage area
-  in an attempted denial-of-service attack.&lt;/p&gt;
-
   &lt;p&gt;User agents may prompt the user when per-domain space quotas are
   reached, allowing the user to grant a site more space. This enables
   sites to store many user-created documents on the user's computer,
@@ -27729,16 +27465,17 @@
   &lt;p&gt;There are various ways of implementing this requirement. One is
   that if a script running in one browsing context accesses a global
   storage area, the UA blocks scripts in other browsing contexts when
-  they try to access &lt;em&gt;any&lt;/em&gt; global storage area until the first
-  script has executed to completion. (Similarly, when a script in one
-  browsing context accesses its session storage area, any scripts that
-  have the same top level browsing context and the same domain would
-  block when accessing their session storage area until the first
-  script has executed to completion.) Another (potentially more
-  efficient but probably more complex) implementation strategy is to
-  use optimistic transactional script execution. This specification
-  does not require any particular implementation strategy, so long as
-  the requirement above is met.&lt;/p&gt;
+  they try to access the global storage area for the same origin until
+  the first script has executed to completion. (Similarly, when a
+  script in one browsing context accesses its session storage area,
+  any scripts that have the same top level browsing context and the
+  same origin would block when accessing their session storage area
+  until the first script has executed to completion.) Another
+  (potentially more efficient but probably more complex)
+  implementation strategy is to use optimistic transactional script
+  execution. This specification does not require any particular
+  implementation strategy, so long as the requirement above is
+  met.&lt;/p&gt;
 
 
   &lt;h4&gt;Security and privacy&lt;/h4&gt;
@@ -27747,20 +27484,14 @@
 
   &lt;p&gt;A third-party advertiser (or any entity capable of getting
   content distributed to multiple sites) could use a unique identifier
-  stored in its domain's global storage area to track a user across
-  multiple sessions, building a profile of the user's interests to
-  allow for highly targeted advertising. In conjunction with a site
-  that is aware of the user's real identity (for example an e-commerce
-  site that requires authenticated credentials), this could allow
+  stored in its global storage area to track a user across multiple
+  sessions, building a profile of the user's interests to allow for
+  highly targeted advertising. In conjunction with a site that is
+  aware of the user's real identity (for example an e-commerce site
+  that requires authenticated credentials), this could allow
   oppressive groups to target individuals with greater accuracy than
   in a world with purely anonymous Web usage.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; object
-  also introduces a way for sites to cooperate to track users over
-  multiple domains, by storing identifying data in &quot;&lt;span
-  title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; top-level domain storage
-  area, accessible by any domain.&lt;/p&gt;
-
   &lt;p&gt;There are a number of techniques that can be used to mitigate the
   risk of user tracking:&lt;/p&gt;
 
@@ -27773,11 +27504,6 @@
     to scripts originating at the domain of the top-level document of
     the &lt;span&gt;browsing context&lt;/span&gt;.&lt;/p&gt;
 
-    &lt;p&gt;This blocks a third-party site from using its private storage
-    area for tracking a user, but top-level sites could still
-    cooperate with third parties to perferm user tracking by using the
-    &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; storage area.&lt;/p&gt;
-
    &lt;/li&gt;
  
    &lt;li&gt;
@@ -27785,55 +27511,26 @@
     &lt;p&gt;Expiring stored data: user agents may automatically delete
     stored data after a period of time.&lt;/p&gt;
 
-    &lt;p&gt;For example, a user agent could treat the global storage area
-    as session-only storage, deleting the data once the user had
-    closed all the &lt;span&gt;browsing contexts&lt;/span&gt; that could access
-    it.&lt;/p&gt;
+    &lt;p&gt;For example, a user agent could treat third-party global
+    storage areas as session-only storage, deleting the data once the
+    user had closed all the &lt;span&gt;browsing contexts&lt;/span&gt; that could
+    access it.&lt;/p&gt;
 
     &lt;p&gt;This can restrict the ability of a site to track a user, as the
     site would then only be able to track the user across multiple
     sessions when he authenticates with the site itself (e.g. by
     making a purchase or logging in to a service).&lt;/p&gt;
 
+    &lt;p&gt;However, this also puts the user's data at risk.&lt;/p&gt;
+
     &lt;!-- XXX should there be an explicit way for sites to state when
     data should expire? as in
-    globalStorage['example.com'].expireData(365); ? --&gt;
+    globalStorage.expireData(365); ? --&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;Blocking access to the top-level domain (&quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot;) storage
-    areas: user agents may prevent domains from storing data in and
-    reading data from the top-level domain entries in the &lt;code
-    title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; object.&lt;/p&gt;
-
-    &lt;p&gt;In practice this requires a detailed list of all the &quot;public&quot;
-    second-level (and third-level) domains. For example, content at
-    the domain &lt;code&gt;www.example.com&lt;/code&gt; would be allowed to access
-    &lt;code&gt;example.com&lt;/code&gt; data but not &lt;code&gt;com&lt;/code&gt; data;
-    content at the domain &lt;code&gt;example.co.uk&lt;/code&gt; would be allowed
-    access to &lt;code&gt;example.co.uk&lt;/code&gt; but not &lt;code&gt;co.uk&lt;/code&gt; or
-    &lt;code&gt;uk&lt;/code&gt;; and content at
-    &lt;code&gt;example.chiyoda.tokyo.jp&lt;/code&gt; would be allowed access to
-    &lt;code&gt;example.chiyoda.tokyo.jp&lt;/code&gt; but not
-    &lt;code&gt;chiyoda.tokyo.jp&lt;/code&gt;, &lt;code&gt;tokyo.jp&lt;/code&gt;, or
-    &lt;code&gt;jp&lt;/code&gt;, while content at
-    &lt;code&gt;example.metro.tokyo.jp&lt;/code&gt; would be allowed access to
-    both &lt;code&gt;example.metro.tokyo.jp&lt;/code&gt; and
-    &lt;code&gt;metro.tokyo.jp&lt;/code&gt; but not &lt;code&gt;tokyo.jp&lt;/code&gt; or
-    &lt;code&gt;jp&lt;/code&gt;. The problem is even more convoluted when one
-    considers private domains with third-party subdomains such as
-    &lt;code&gt;dyndns.org&lt;/code&gt; or &lt;code&gt;uk.com&lt;/code&gt;.&lt;/p&gt;
-
-    &lt;p&gt;Blocking access to the &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; storage areas can also prevent
-    innocent sites from cooperating to provide services beneficial to
-    the user.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
     &lt;p&gt;Treating persistent storage as cookies: user agents may present
     the persistent storage feature to the user in a way that does not
     distinguish it from HTTP session cookies. &lt;a
@@ -27846,25 +27543,18 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Site-specific white-listing of access to &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; storage
-    area: user agents may allow sites to access persistent storage
-    for their own domain and subdomains in an unrestricted manner, but
-    require the user to authorise access to the storage area of
-    higher-level domains.&lt;/p&gt;
+    &lt;p&gt;Site-specific white-listing of access to global storage areas:
+    user agents may allow sites to access session storage areas in an
+    unrestricted manner, but require the user to authorise access to
+    global storage areas.&lt;/p&gt;
 
-    &lt;p&gt;For example, code at &lt;code&gt;example.com&lt;/code&gt; would be always
-    allowed to read and write data for &lt;code&gt;www.example.com&lt;/code&gt;
-    and &lt;code&gt;example.com&lt;/code&gt;, but if it tried to access
-    &lt;code&gt;com&lt;/code&gt;, the user agent could display a non-modal message
-    informing the user that the page requested access to
-    &lt;code&gt;com&lt;/code&gt; and offering to allow it.&lt;/p&gt;
-
    &lt;/li&gt;
 
    &lt;li&gt;
 
     &lt;p&gt;Origin-tracking of persistent storage data: user agents may
-    record the domain of the script that caused data to be stored.&lt;/p&gt;
+    record the origins of sites that contained content from
+    third-party origins that caused data to be stored.&lt;/p&gt;
 
     &lt;p&gt;If this information is then used to present the view of data
     currently in persistent storage, it would allow the user to make
@@ -27889,11 +27579,12 @@
 
   &lt;p&gt;While these suggestions prevent trivial use of this API for user
   tracking, they do not block it altogether. Within a single domain, a
-  site can continue to track the user across multiple sessions, and
-  can then pass all this information to the third party along with any
+  site can continue to track the user during a session, and can then
+  pass all this information to the third party along with any
   identifying information (names, credit card numbers, addresses)
   obtained by the site. If a third party cooperates with multiple
-  sites to obtain such information, a profile can still be created.&lt;/p&gt;
+  sites to obtain such information, a profile can still be
+  created.&lt;/p&gt;
 
   &lt;p&gt;However, user tracking is to some extent possible even with no
   cooperation from the user agent whatsoever, for instance by using
@@ -27904,6 +27595,7 @@
   data (e.g. user-agent headers and configuration settings) to combine
   separate sessions into coherent user profiles.&lt;/p&gt;
 
+
   &lt;h5&gt;Cookie resurrection&lt;/h5&gt;
 
   &lt;p&gt;If the user interface for persistent storage presents data in the
@@ -27913,72 +27605,16 @@
   backup for each other, defeating a user's attempts to protect his
   privacy.&lt;/p&gt;
 
-  &lt;h5&gt;Integrity of &quot;public&quot; storage areas&lt;/h5&gt;
 
-  &lt;p&gt;Since the &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; global storage areas are accessible by content
-  from many different parties, it is possible for third-party sites to
-  delete or change information stored in those areas in ways that the
-  originating sites may not expect.&lt;/p&gt;
-
-  &lt;p&gt;Authors must not use the &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; global storage areas for
-  storing sensitive data. Authors must not trust information stored in
-  &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; global storage areas.&lt;/p&gt;
-
-  &lt;h5&gt;Cross-protocol and cross-port attacks&lt;/h5&gt;
-
-  &lt;p&gt;This API makes no distinction between content served over HTTP,
-  FTP, or other host-based protocols, and does not distinguish between
-  content served from different ports at the same host.&lt;/p&gt;
-
-  &lt;p&gt;Thus, for example, data stored in the global persistent storage
-  for domain &quot;www.example.com&quot; by a page served from HTTP port 80 will
-  be available to a  page served in
-  &lt;code&gt;<A HREF="http://example.com:18080/&lt;/code">http://example.com:18080/&lt;/code</A>&gt;, even if the latter is an
-  experimental server under the control of a different user.&lt;/p&gt;
-
-  &lt;p&gt;Since the data is not sent over the wire by the user agent, this
-  is not a security risk in its own right. However, authors must take
-  proper steps to ensure that all hosts that have fully qualified host
-  names that are subsets of hosts dealing with sensitive information
-  are as secure as the originating hosts themselves.&lt;/p&gt;
-
-  &lt;p&gt;Similarly, authors must ensure that all Web servers on a host,
-  regardless of the port, are equally trusted if any of them are to
-  use persistent storage. For instance, if a Web server runs a
-  production service that makes use of the persistent storage feature,
-  then other users that have access to that machine and that can run a
-  Web server on another port will be able to access the persistent
-  storage added by the production service (assuming they can trick a
-  user into visiting their page).&lt;/p&gt;
-
-  &lt;p&gt;However, if one is able to trick users into visiting a Web server
-  with the same host name but on a different port as a production
-  service used by these users, then one could just as easily fake the
-  look of the site and thus trick users into authenticating with the
-  fake site directly, forwarding the request to the real site and
-  stealing the credentials in the process. Thus, the persistent
-  storage feature is considered to only minimally increase the
-  risk involved.&lt;/p&gt;
-
-  &lt;p class=&quot;big-issue&quot;&gt;What about if someone is able to get a server
-  up on a port, and can then send people to that URI? They could steal
-  all the data with no further interaction. How about putting the port
-  number at the end of the string being compared? (Implicitly.)&lt;/p&gt;
-
   &lt;h5&gt;DNS spoofing attacks&lt;/h5&gt;
 
   &lt;p&gt;Because of the potential for DNS spoofing attacks, one cannot
   guarentee that a host claiming to be in a certain domain really is
-  from that domain. The &lt;code
-  title=&quot;dom-StorageItem-secure&quot;&gt;secure&lt;/code&gt; attribute is provided
-  to mark certain key/value pairs as only being accessible to pages
-  that have been authenticated using secure certificates (or similar
-  mechanisms).&lt;/p&gt;
+  from that domain. To mitigate this, pages can use SSL. Pages using
+  SSL can be sure that only pages using SSL that have certificates
+  identifying them as being from the same domain can access their
+  global storage areas.&lt;/p&gt;
 
-  &lt;p&gt;Authors must ensure that they do not mark sensitive items as
-  &quot;safe for both secure and insecure content&quot;. (To prevent the risk of
-  a race condition, data stored by scripts in secure contexts default
-  to being marked as &quot;safe only for secure content&quot;.)&lt;/p&gt;
 
   &lt;h5&gt;Cross-directory attacks&lt;/h5&gt;
 
@@ -27996,48 +27632,6 @@
   path.&lt;/p&gt;
 
 
-  &lt;h5&gt;Public storage areas corresponding to hosts&lt;/h5&gt;
-
-  &lt;p&gt;If a &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; global
-  storage area corresponds to a host, as it typically does if for
-  private domains with third-party subdomains such as dyndns.org or
-  uk.com, the host corresponding to the &quot;public&quot; domain has access to
-  all the storage areas of its third-party subdomains. In general,
-  authors are discouraged from using the &lt;code
-  title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; API for sensitive
-  data unless the operators of all the domains involved are
-  trusted.&lt;/p&gt;
-
-  &lt;p&gt;User agents may mitigate this problem by preventing hosts
-  corresponding to &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot;
-  global storage areas from accessing any storage areas other than
-  their own.&lt;/p&gt;
-
-
-  &lt;h5&gt;Storage areas in the face of untrusted higher-level domains that do not correspond to public storage areas&lt;/h5&gt;
-
-  &lt;p&gt;Authors should not store sensitive data using the global storage
-  APIs if there are hosts with fully-qualified domain names that are
-  subsets of their own which they do not trust. For example, an author
-  at &lt;code&gt;finance.members.example.net&lt;/code&gt; should not store
-  sensitive financial user data in the
-  &lt;code&gt;finance.members.example.net&lt;/code&gt; storage area if he does not
-  trust the host that runs &lt;code&gt;example.net&lt;/code&gt;.&lt;/p&gt;
-
-
-  &lt;h5&gt;Storage areas in the face of untrusted subdomains&lt;/h5&gt;
-
-  &lt;p&gt;If an author publishing content on one host,
-  e.g. &lt;code&gt;example.com&lt;/code&gt;, wishes to use the &lt;code
-  title=&quot;dom-globalStorage&quot;&gt;globalStorage&lt;/code&gt; API but does not wish
-  any content on the host's subdomains to access the data, the author
-  should use an otherwise non-existent subdomain name, e.g.,
-  &lt;code&gt;private.example.com&lt;/code&gt;, to store the data. This will be
-  accessible only to that host (and its parent domains), and not to
-  any of the real subdomains
-  (e.g. &lt;code&gt;upload.example.com&lt;/code&gt;).&lt;/p&gt;
-
-
   &lt;h5&gt;Implementation risks&lt;/h5&gt;
 
   &lt;p&gt;The two primary risks when implementing this persistent storage
@@ -28059,28 +27653,11 @@
   identifier to a known ID that the hostile site can then use to track
   the user's actions on the victim site.&lt;/p&gt;
 
-  &lt;p&gt;A risk is also presented by servers on local domains having
-  host names matching top-level domain names, for instance having a
-  host called &quot;com&quot; or &quot;net&quot;. Such hosts might, if implementations
-  fail to correctly implement the &lt;code&gt;.localdomain&lt;/code&gt; suffixing,
-  &lt;!-- XXX cross ref --&gt; have full access to all the data stored in a
-  UA's persistent storage for that top level domain.&lt;/p&gt;
-
   &lt;p&gt;Thus, strictly following the model described in this
   specification is important for user security.&lt;/p&gt;
 
-  &lt;p&gt;In addition, a number of optional restrictions related to the
-  &quot;&lt;span title=&quot;public storage area&quot;&gt;public&lt;/span&gt;&quot; global storage
-  areas are suggested in the previous sections. The design of this API
-  is intended to be such that not supporting these restrictions, or
-  supporting them less than perfectly, does not result in critical
-  security problems. However, implementations are still encouraged to
-  create and maintain a list of &quot;&lt;span title=&quot;public storage
-  area&quot;&gt;public&lt;/span&gt;&quot; domains, and apply the restrictions described
-  above.&lt;/p&gt;
 
 
-
   &lt;h3 id=&quot;sql&quot;&gt;Client-side database storage&lt;/h3&gt;
 
   &lt;!-- Feature requests for future versions (v2):
@@ -42930,6 +42507,5 @@
 
 --&gt;
 
-  &lt;script src=&quot;<A HREF="http://status.whatwg.org/annotate-web-apps.js">http://status.whatwg.org/annotate-web-apps.js</A>&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
 &lt;/html&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008047.html">[html5] r1139 - /
</A></li>
	<LI>Next message: <A HREF="008049.html">[html5] r1141 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8048">[ date ]</a>
              <a href="thread.html#8048">[ thread ]</a>
              <a href="subject.html#8048">[ subject ]</a>
              <a href="author.html#8048">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
