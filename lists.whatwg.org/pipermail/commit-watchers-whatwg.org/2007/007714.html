<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r792 - /
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r792%20-%20/&In-Reply-To=%3C20070501065318.0F0961228CE%40looneymail-a5.g.dreamhost.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="007713.html">
   <LINK REL="Next"  HREF="007715.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r792 - /</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r792%20-%20/&In-Reply-To=%3C20070501065318.0F0961228CE%40looneymail-a5.g.dreamhost.com%3E"
       TITLE="[html5] r792 - /">whatwg at whatwg.org
       </A><BR>
    <I>Mon Apr 30 23:53:18 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="007713.html">[html5] r791 - /
</A></li>
        <LI>Next message: <A HREF="007715.html">[html5] r793 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7714">[ date ]</a>
              <a href="thread.html#7714">[ thread ]</a>
              <a href="subject.html#7714">[ subject ]</a>
              <a href="author.html#7714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2007-04-30 23:53:16 -0700 (Mon, 30 Apr 2007)
New Revision: 792

Modified:
   index
   source
Log:
[acgiow] (2) Address known &lt;base&gt; element issues.

Modified: index
===================================================================
--- index	2007-04-30 02:07:30 UTC (rev 791)
+++ index	2007-05-01 06:53:16 UTC (rev 792)
@@ -22,7 +22,7 @@
 
    &lt;h1 id=web-applications&gt;Web Applications 1.0&lt;/h1&gt;
 
-   &lt;h2 class=&quot;no-num no-toc&quot; id=working&gt;Working Draft &mdash; 30 April 2007&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=working&gt;Working Draft &mdash; 1 May 2007&lt;/h2&gt;
 
    &lt;p&gt;You can take part in this work. &lt;a
     href=&quot;<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&quot;&gt;Join the working group's
@@ -1940,13 +1940,14 @@
 
    &lt;dd&gt;
     &lt;p id=xmlBase&gt;User agents must follow the rules given by XML Base to
-     resolve relative URIs in HTML and XHTML fragments, because that is the
-     mechanism used in this specification for resolving relative URIs in DOM
-     trees. &lt;a href=&quot;#refsXMLBASE&quot;&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
+     resolve relative URIs in HTML and XHTML fragments. That is the mechanism
+     used in this specification for resolving relative URIs in DOM trees. &lt;a
+     href=&quot;#refsXMLBASE&quot;&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
 
-    &lt;p class=note&gt;It is possible for &lt;code&gt;xml:base&lt;/code&gt; attributes to be
-     present even in HTML fragments, as such attributes can be added
-     dynamically using script.&lt;/p&gt;
+    &lt;p class=note&gt;It is possible for &lt;code
+     title=attr-xml-base&gt;xml:base&lt;/code&gt; attributes to be present even in
+     HTML fragments, as such attributes can be added dynamically using
+     script.&lt;/p&gt;
 
    &lt;dt&gt;DOM
 
@@ -6966,12 +6967,12 @@
 
    &lt;dt&gt;Content model:
 
-   &lt;dd&gt;In any order, optionally one &lt;code&gt;&lt;a href=&quot;#meta0&quot;&gt;meta&lt;/a&gt;&lt;/code&gt;
-    element with a &lt;code title=attr-meta-charset&gt;&lt;a
-    href=&quot;#charset0&quot;&gt;charset&lt;/a&gt;&lt;/code&gt; attribute, exactly one &lt;code&gt;&lt;a
-    href=&quot;#title1&quot;&gt;title&lt;/a&gt;&lt;/code&gt; element, optionally one &lt;code&gt;&lt;a
-    href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element, and zero or more other &lt;a
-    href=&quot;#metadata&quot;&gt;metadata elements&lt;/a&gt; (in particular, &lt;code&gt;&lt;a
+   &lt;dd&gt;In any order unless otherwise specified: optionally one &lt;code&gt;&lt;a
+    href=&quot;#meta0&quot;&gt;meta&lt;/a&gt;&lt;/code&gt; element with a &lt;code
+    title=attr-meta-charset&gt;&lt;a href=&quot;#charset0&quot;&gt;charset&lt;/a&gt;&lt;/code&gt; attribute,
+    exactly one &lt;code&gt;&lt;a href=&quot;#title1&quot;&gt;title&lt;/a&gt;&lt;/code&gt; element, optionally
+    one &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element, and zero or more other
+    &lt;a href=&quot;#metadata&quot;&gt;metadata elements&lt;/a&gt; (in particular, &lt;code&gt;&lt;a
     href=&quot;#link&quot;&gt;link&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#meta0&quot;&gt;meta&lt;/a&gt;&lt;/code&gt;,
     &lt;code&gt;&lt;a href=&quot;#style&quot;&gt;style&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;&lt;a
     href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt;).
@@ -7070,8 +7071,7 @@
    &lt;dd&gt;In a &lt;code&gt;&lt;a href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt; element, after the &lt;code&gt;&lt;a
     href=&quot;#meta0&quot;&gt;meta&lt;/a&gt;&lt;/code&gt; element with the &lt;code
     title=attr-meta-charset&gt;&lt;a href=&quot;#charset0&quot;&gt;charset&lt;/a&gt;&lt;/code&gt; attribute,
-    if any, but before any other elements, and only if there are no other
-    &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; elements in the document.
+    if any, but before any other elements.
 
    &lt;dt&gt;Content model:
 
@@ -7079,7 +7079,7 @@
 
    &lt;dt&gt;Element-specific attributes:
 
-   &lt;dd&gt;&lt;code title=attr-base-href&gt;&lt;a href=&quot;#href&quot;&gt;href&lt;/a&gt;&lt;/code&gt; (HTML only)
+   &lt;dd&gt;&lt;code title=attr-base-href&gt;&lt;a href=&quot;#href&quot;&gt;href&lt;/a&gt;&lt;/code&gt;
 
    &lt;dd&gt;&lt;code title=attr-base-target&gt;&lt;a href=&quot;#target&quot;&gt;target&lt;/a&gt;&lt;/code&gt;
 
@@ -7109,26 +7109,28 @@
   &lt;p&gt;The &lt;dfn id=href title=attr-base-href&gt;&lt;code&gt;href&lt;/code&gt;&lt;/dfn&gt; content
    attribute, if specified, must contain a URI (or IRI).
 
-  &lt;p&gt;Authors must not use the &lt;code title=att-base-href&gt;href&lt;/code&gt; attribute
-   on the &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element in &lt;a
-   href=&quot;#xml-documents&quot;&gt;XML documents&lt;/a&gt;. Authors should instead use the
-   &lt;code&gt;xml:base&lt;/code&gt; attribute. &lt;a href=&quot;#refsXMLBASE&quot;&gt;[XMLBASE]&lt;/a&gt;
-
   &lt;p&gt;User agents must use the value of the &lt;code
-   title=att-base-href&gt;href&lt;/code&gt; attribute on the first &lt;code&gt;&lt;a
-   href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element with an &lt;code
-   title=att-base-href&gt;href&lt;/code&gt; attribute in the document as the document
-   entity's base URI for the purposes of section 5.1.1 of RFC 2396
-   (&quot;Establishing a Base URI&quot;: &quot;Base URI within Document Content&quot;). &lt;a
-   href=&quot;#refsRFC2396&quot;&gt;[RFC2396]&lt;/a&gt; Note that this base URI from RFC 2396 is
-   referred to by the algorithm given in XML Base, which &lt;a
-   href=&quot;#xmlBase&quot;&gt;is a normative part of this specification&lt;/a&gt;.
+   title=att-base-href&gt;href&lt;/code&gt; attribute of the first &lt;code&gt;&lt;a
+   href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element that is both a child of &lt;a
+   href=&quot;#the-head0&quot;&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/a&gt; and has an &lt;code
+   title=att-base-href&gt;href&lt;/code&gt; attribute, if there is such an element, as
+   the document entity's base URI for the purposes of section 5.1.1 of RFC
+   2396 (&quot;Establishing a Base URI&quot;: &quot;Base URI within Document Content&quot;). This
+   base URI from RFC 2396 is referred to by the algorithm given in XML Base,
+   which &lt;a href=&quot;#xmlBase&quot;&gt;is a normative part of this specification&lt;/a&gt;. &lt;a
+   href=&quot;#refsRFC2396&quot;&gt;[RFC2396]&lt;/a&gt;
 
   &lt;p&gt;If the base URI given by this attribute is a relative URI, it must be
    resolved relative to the higher-level base URIs (i.e. the base URI from
    the encapsulating entity or the URI used to retrieve the entity) to obtain
-   an absolute base URI.
+   an absolute base URI. All &lt;code title=attr-xml-base&gt;xml:base&lt;/code&gt;
+   attributes must be ignored when resolving relative URIs in this &lt;code
+   title=attr-base-href&gt;&lt;a href=&quot;#href&quot;&gt;href&lt;/a&gt;&lt;/code&gt; attribute.
 
+  &lt;p class=note&gt;If there are multiple &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt;
+   elements with &lt;code title=att-base-href&gt;href&lt;/code&gt; attributes, all but
+   the first are ignored.
+
   &lt;p&gt;The &lt;dfn id=target title=attr-base-target&gt;&lt;code&gt;target&lt;/code&gt;&lt;/dfn&gt;
    attribute, if specified, must contain a &lt;a href=&quot;#valid8&quot;&gt;valid browsing
    context name&lt;/a&gt;. User agents use this name when &lt;a
@@ -7139,6 +7141,17 @@
    must &lt;a href=&quot;#reflect&quot;&gt;reflect&lt;/a&gt; the content attributes of the same
    name.
 
+  &lt;p class=note&gt;Pages with multiple &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt;
+   elements have all but their first &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt;
+   element with an &lt;code title=attr-base-href&gt;&lt;a href=&quot;#href&quot;&gt;href&lt;/a&gt;&lt;/code&gt;
+   attribute ignored for the purposes of URI resolution, and all but their
+   first &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element with a &lt;code
+   title=attr-base-target&gt;&lt;a href=&quot;#target&quot;&gt;target&lt;/a&gt;&lt;/code&gt; attribute
+   ignored for the purposes of default browsing context name resolution.&lt;/p&gt;
+  &lt;!-- XXX the former is for compat with IE7. The latter is not
+  actually exactly compatible with anything. We'll see if it breaks
+  anything. --&gt;
+
   &lt;h4 id=the-link&gt;&lt;span class=secno&gt;3.7.4. &lt;/span&gt;The &lt;dfn
    id=link&gt;&lt;code&gt;link&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
@@ -7364,8 +7377,9 @@
    were given in the HTTP entity header. Relative URIs in these headers must
    be resolved according to the rules given in HTTP, not relative to base
    URIs set by the document (e.g. using a &lt;code&gt;&lt;a
-   href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element or &lt;code&gt;xml:base&lt;/code&gt; attributes).
-   &lt;a href=&quot;#refsRFC2616&quot;&gt;[RFC2616]&lt;/a&gt; &lt;a href=&quot;#refsRFC2068&quot;&gt;[RFC2068]&lt;/a&gt;
+   href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element or &lt;code
+   title=attr-xml-base&gt;xml:base&lt;/code&gt; attributes). &lt;a
+   href=&quot;#refsRFC2616&quot;&gt;[RFC2616]&lt;/a&gt; &lt;a href=&quot;#refsRFC2068&quot;&gt;[RFC2068]&lt;/a&gt;
 
   &lt;p&gt;The DOM attributes &lt;dfn id=href2
    title=dom-link-href&gt;&lt;code&gt;href&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=rel0
@@ -23835,12 +23849,13 @@
   &lt;p&gt;Otherwise, if the hyperlink element is an &lt;code&gt;&lt;a
    href=&quot;#a&quot;&gt;a&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a href=&quot;#area&quot;&gt;area&lt;/a&gt;&lt;/code&gt; element
    with no &lt;code title=attr-hyperlink-target&gt;&lt;a
-   href=&quot;#target3&quot;&gt;target&lt;/a&gt;&lt;/code&gt; attribute, but there is a &lt;code&gt;&lt;a
+   href=&quot;#target3&quot;&gt;target&lt;/a&gt;&lt;/code&gt; attribute, but one of the child nodes of
+   &lt;a href=&quot;#the-head0&quot;&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/a&gt; is a &lt;code&gt;&lt;a
    href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element with a &lt;code
-   title=attr-base-target&gt;&lt;a href=&quot;#target&quot;&gt;target&lt;/a&gt;&lt;/code&gt; attribute in
-   the document, then the browsing context that is navigated must be chosen
-   by applying &lt;a href=&quot;#the-rules&quot;&gt;the rules for chosing a browsing context
-   given a browsing context name&lt;/a&gt;, using the value of the &lt;code
+   title=attr-base-target&gt;&lt;a href=&quot;#target&quot;&gt;target&lt;/a&gt;&lt;/code&gt; attribute, then
+   the browsing context that is navigated must be chosen by applying &lt;a
+   href=&quot;#the-rules&quot;&gt;the rules for chosing a browsing context given a
+   browsing context name&lt;/a&gt;, using the value of the &lt;code
    title=attr-base-target&gt;&lt;a href=&quot;#target&quot;&gt;target&lt;/a&gt;&lt;/code&gt; attribute of
    the first such &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; element as the
    browsing context name. If these rules result in the creation of a new &lt;a
@@ -35290,10 +35305,6 @@
          or, if that is null (&lt;a href=&quot;#innerhtml1&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt;
          case&lt;/a&gt;), to the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt;.&lt;/p&gt;
 
-        &lt;p class=big-issue&gt;Need to cope with second and subsequent &lt;code&gt;&lt;a
-         href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt; elements affecting subsequent elements
-         magically.&lt;/p&gt;
-
        &lt;dt&gt;An end tag with the tag name &quot;head&quot;
 
        &lt;dd&gt;
@@ -38998,40 +39009,42 @@
 
   &lt;h2 class=no-num id=acknowledgements&gt;Acknowledgements&lt;/h2&gt;
 
-  &lt;p&gt;Thanks to Aankhen, Aaron Leventhal, Alexey Feldgendler, Andrew Gove,
-   Anne van Kesteren, Anthony Hickson, Asbj&oslash;rn Ulsberg, Ben Godfrey,
-   Ben Meadowcroft, Benjamin Hawkes-Lewis, Bert Bos, Bjoern Hoehrmann, Boris
-   Zbarsky, Brad Fults, Brad Neuberg, Brendan Eich, Brett Wilson, Chao Cai,
-   Channy Yun, Charl van Niekerk&lt;!--status.whatwg.org maintainer--&gt;, Charles
-   Iliya Krempeaux, Charles McCathieNevile, Christian Biesinger, Christian
-   Johansen, Chriswa, Daniel Peng, Daniel Sp&aring;ng, Darin Fisher, Dave
+  &lt;p&gt;Thanks to Aankhen, Aaron Leventhal, Adrian Sutton, Alexey Feldgendler,
+   Andrew Gove, Anne van Kesteren, Anthony Hickson, Asbj&oslash;rn Ulsberg,
+   Ben Godfrey, Ben Meadowcroft, Benjamin Hawkes-Lewis, Bert Bos, Bjoern
+   Hoehrmann, Boris Zbarsky, Brad Fults, Brad Neuberg, Brendan Eich, Brett
+   Wilson, Chao Cai, Channy Yun, Charl van
+   Niekerk&lt;!--status.whatwg.org maintainer--&gt;, Charles Iliya Krempeaux,
+   Charles McCathieNevile, Christian Biesinger, Christian Johansen, Chriswa,
+   Daniel Peng, Daniel Sp&aring;ng, Darin Fisher, Dave
    Townsend&lt;!-- Mossop on moz irc --&gt;, David Baron, David Flanagan, David
    H&aring;s&auml;ther, David Hyatt, Derek Featherstone, Dimitri Glazkov,
    dolphinling, Doron Rosenberg, Eira Monstad, Elliotte Harold, Erik
-   Arvidsson, fantasai, Franck 'Shift' Qu&eacute;lain, H&aring;kon Wium Lie,
-   Henri Sivonen, Henrik Lied, Ignacio Javier, J. King, James Graham, James M
-   Snell, James Perrett, Jan-Klaas Kollhof, Jasper Bryant-Greene, Jeff
-   Cutsinger, Jens Bannmann, Joel Spolsky, John Harding, Johnny Stenback, Jon
-   Perlow, Jonathan Worent, Jorgen Horstink, Joshua Randall, Jukka K.
-   Korpela, Kai Hendry, Kornel Lesinski, &amp;#x9ed2;&amp;#x6fa4;&amp;#x525b;&amp;#x5fd7;
-   (KUROSAWA Takeshi), Lachlan Hunt, Larry Page, Laurens Holst, Lenny
-   Domnitser, L&eacute;onard Bouchet, Leons Petrazickis,
-   Logan&lt;!-- on moz irc --&gt;, Maciej Stachowiak, Malcolm Rowe, Mark
-   Nottingham, Mark Schenk, Martijn Wargers, Martin Atkins, Martin Honnen,
-   Mathieu Henri, Matthew Mastracci, Matthew Raymond, Matthew Thomas, Mattias
-   Waldau, Max Romantschuk, Michael 'Ratt' Iannarelli, Michael A. Nachbaur,
-   Michael Gratton, Michael Powers, Michel Fortin, Mihai
-   &amp;#x015E;ucan&lt;!-- from ROBO Design --&gt;, Mike Dierken&lt;!-- S. Mike
-  Dierken --&gt;,
-   Mike Dixon, Mike Schinkel, Mike Shaver, Mikko Rantalainen, Neil Deakin,
-   Olav Junker Kj&aelig;r, Philip Taylor, Rajas Moonka, Rimantas Liubertas,
-   Robert O'Callahan, Robert Sayre, Roman Ivanov, S. Mike Dierken, Sam Ruby,
-   Sean Knapp, Shadow2531, Shaun Inman, Simon Pieters, Stefan Haustein,
-   Stephen Ma, Steve Runyon, Steven Garrity, Stewart Brodie, Stuart
-   Parmenter, Tantek &Ccedil;elik, Thomas Broyer, Thomas O'Connor, Tim
-   Altman, Vladimir Vuki&amp;#x0107;evi&amp;#x0107;, Wakaba, William Swanson, and
-   everyone on the WHATWG mailing list for their useful and substantial
-   comments.
+   Arvidsson, fantasai, Franck 'Shift' Qu&eacute;lain, Geoffrey Sneddon,
+   H&aring;kon Wium Lie, Henri Sivonen, Henrik Lied, Ignacio Javier, J. King,
+   James Graham, James M Snell, James Perrett, Jan-Klaas Kollhof, Jasper
+   Bryant-Greene, Jeff Cutsinger, Jens Bannmann, Joel Spolsky, John Harding,
+   Johnny Stenback, Jon Perlow, Jonathan Worent, Jorgen Horstink, Joshua
+   Randall, Jukka K. Korpela, Kai Hendry, &lt;!-- Keryx Web, = Lars
+  Gunther --&gt;
+   Kornel Lesinski, &amp;#x9ed2;&amp;#x6fa4;&amp;#x525b;&amp;#x5fd7; (KUROSAWA Takeshi),
+   Lachlan Hunt, Larry Page, Lars Gunther, Laurens Holst, Lenny Domnitser,
+   L&eacute;onard Bouchet, Leons Petrazickis, Logan&lt;!-- on moz irc --&gt;,
+   Maciej Stachowiak, Malcolm Rowe, Mark Nottingham, Mark Schenk, Martijn
+   Wargers, Martin Atkins, Martin Honnen, Mathieu Henri, Matthew Mastracci,
+   Matthew Raymond, Matthew Thomas, Mattias Waldau, Max Romantschuk, Michael
+   'Ratt' Iannarelli, Michael A. Nachbaur, Michael Gratton, Michael Powers,
+   Michel Fortin, Mihai &amp;#x015E;ucan&lt;!-- from ROBO Design --&gt;, Mike
+   Dierken&lt;!--
+  S. Mike Dierken --&gt;, Mike Dixon, Mike Schinkel, Mike Shaver,
+   Mikko Rantalainen, Neil Deakin, Olav Junker Kj&aelig;r, Philip Taylor,
+   Rajas Moonka, Rimantas Liubertas, Robert O'Callahan, Robert Sayre, Roman
+   Ivanov, S. Mike Dierken, Sam Ruby, Sean Knapp, Shadow2531, Shaun Inman,
+   Simon Pieters, Stefan Haustein, Stephen Ma, Steve Runyon, Steven Garrity,
+   Stewart Brodie, Stuart Parmenter, Tantek &Ccedil;elik, Thomas Broyer,
+   Thomas O'Connor, Tim Altman, Vladimir Vuki&amp;#x0107;evi&amp;#x0107;, Wakaba,
+   William Swanson, and everyone on the WHATWG mailing list for their useful
+   and substantial comments.
 
   &lt;p&gt;Special thanks to Richard Williamson for creating the first
    implementation of &lt;code&gt;&lt;a href=&quot;#canvas&quot;&gt;canvas&lt;/a&gt;&lt;/code&gt; in Safari,

Modified: source
===================================================================
--- source	2007-04-30 02:07:30 UTC (rev 791)
+++ source	2007-05-01 06:53:16 UTC (rev 792)
@@ -519,14 +519,14 @@
    &lt;dd&gt;
 
     &lt;p id=&quot;xmlBase&quot;&gt;User agents must follow the rules given by XML
-    Base to resolve relative URIs in HTML and XHTML fragments, because
-    that is the mechanism used in this specification for resolving
-    relative URIs in DOM trees. &lt;a
-    href=&quot;#refsXMLBASE&quot;&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
+    Base to resolve relative URIs in HTML and XHTML fragments. That
+    is the mechanism used in this specification for resolving relative
+    URIs in DOM trees. &lt;a href=&quot;#refsXMLBASE&quot;&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
 
-    &lt;p class=&quot;note&quot;&gt;It is possible for &lt;code&gt;xml:base&lt;/code&gt; attributes
-    to be present even in HTML fragments, as such attributes can be
-    added dynamically using script.&lt;/p&gt;
+    &lt;p class=&quot;note&quot;&gt;It is possible for &lt;code
+    title=&quot;attr-xml-base&quot;&gt;xml:base&lt;/code&gt; attributes to be present
+    even in HTML fragments, as such attributes can be added
+    dynamically using script.&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -5716,9 +5716,10 @@
    &lt;dt&gt;Contexts in which this element may be used:&lt;/dt&gt;
    &lt;dd&gt;As the first element in an &lt;code&gt;html&lt;/code&gt; element.&lt;/dd&gt;
    &lt;dt&gt;Content model:&lt;/dt&gt;
-   &lt;dd&gt;In any order, optionally one &lt;code&gt;meta&lt;/code&gt; element with a
-   &lt;code title=&quot;attr-meta-charset&quot;&gt;charset&lt;/code&gt; attribute, exactly
-   one &lt;code&gt;title&lt;/code&gt; element, optionally one &lt;code&gt;base&lt;/code&gt;
+   &lt;dd&gt;In any order unless otherwise specified: optionally one
+   &lt;code&gt;meta&lt;/code&gt; element with a &lt;code
+   title=&quot;attr-meta-charset&quot;&gt;charset&lt;/code&gt; attribute, exactly one
+   &lt;code&gt;title&lt;/code&gt; element, optionally one &lt;code&gt;base&lt;/code&gt;
    element, and zero or more other &lt;span&gt;metadata elements&lt;/span&gt; (in
    particular, &lt;code&gt;link&lt;/code&gt;, &lt;code&gt;meta&lt;/code&gt;,
    &lt;code&gt;style&lt;/code&gt;, and &lt;code&gt;script&lt;/code&gt;).&lt;/dd&gt;
@@ -5798,12 +5799,11 @@
    &lt;dt&gt;Contexts in which this element may be used:&lt;/dt&gt;
    &lt;dd&gt;In a &lt;code&gt;head&lt;/code&gt; element, after the &lt;code&gt;meta&lt;/code&gt;
    element with the &lt;code title=&quot;attr-meta-charset&quot;&gt;charset&lt;/code&gt;
-   attribute, if any, but before any other elements, and only if there
-   are no other &lt;code&gt;base&lt;/code&gt; elements in the document.&lt;/dd&gt;
+   attribute, if any, but before any other elements.&lt;/dd&gt;
    &lt;dt&gt;Content model:&lt;/dt&gt;
    &lt;dd&gt;Empty.&lt;/dd&gt;
    &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
-   &lt;dd&gt;&lt;code title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; (HTML only)&lt;/dd&gt;
+   &lt;dd&gt;&lt;code title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt;&lt;/dd&gt;
    &lt;dd&gt;&lt;code title=&quot;attr-base-target&quot;&gt;target&lt;/code&gt;&lt;/dd&gt;
    &lt;dt&gt;Predefined classes that apply to this element:&lt;/dt&gt;
    &lt;dd&gt;None.&lt;/dd&gt;
@@ -5827,28 +5827,30 @@
   &lt;p&gt;The &lt;dfn title=&quot;attr-base-href&quot;&gt;&lt;code&gt;href&lt;/code&gt;&lt;/dfn&gt; content
   attribute, if specified, must contain a URI (or IRI).&lt;/p&gt;
 
-  &lt;p&gt;Authors must not use the &lt;code title=&quot;att-base-href&quot;&gt;href&lt;/code&gt;
-  attribute on the &lt;code&gt;base&lt;/code&gt; element in &lt;span&gt;XML
-  documents&lt;/span&gt;. Authors should instead use the
-  &lt;code&gt;xml:base&lt;/code&gt; attribute. &lt;a
-  href=&quot;#refsXMLBASE&quot;&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
-
   &lt;p&gt;User agents must use the value of the &lt;code
-  title=&quot;att-base-href&quot;&gt;href&lt;/code&gt; attribute on the first
-  &lt;code&gt;base&lt;/code&gt; element with an &lt;code
-  title=&quot;att-base-href&quot;&gt;href&lt;/code&gt; attribute in the document as the
-  document entity's base URI for the purposes of section 5.1.1 of RFC
-  2396 (&quot;Establishing a Base URI&quot;: &quot;Base URI within Document
-  Content&quot;). &lt;a href=&quot;#refsRFC2396&quot;&gt;[RFC2396]&lt;/a&gt; Note that this base
-  URI from RFC 2396 is referred to by the algorithm given in XML Base,
-  which &lt;a href=&quot;#xmlBase&quot;&gt;is a normative part of this
-  specification&lt;/a&gt;.&lt;/p&gt;
+  title=&quot;att-base-href&quot;&gt;href&lt;/code&gt; attribute of the first
+  &lt;code&gt;base&lt;/code&gt; element that is both a child of &lt;span&gt;the
+  &lt;code&gt;head&lt;/code&gt; element&lt;/span&gt; and has an &lt;code
+  title=&quot;att-base-href&quot;&gt;href&lt;/code&gt; attribute, if there is such an
+  element, as the document entity's base URI for the purposes of
+  section 5.1.1 of RFC 2396 (&quot;Establishing a Base URI&quot;: &quot;Base URI
+  within Document Content&quot;). This base URI from RFC 2396 is referred
+  to by the algorithm given in XML Base, which &lt;a href=&quot;#xmlBase&quot;&gt;is a
+  normative part of this specification&lt;/a&gt;. &lt;a
+  href=&quot;#refsRFC2396&quot;&gt;[RFC2396]&lt;/a&gt;&lt;/p&gt;
 
   &lt;p&gt;If the base URI given by this attribute is a relative URI, it
   must be resolved relative to the higher-level base URIs (i.e. the
   base URI from the encapsulating entity or the URI used to retrieve
-  the entity) to obtain an absolute base URI.&lt;/p&gt;
+  the entity) to obtain an absolute base URI. All &lt;code
+  title=&quot;attr-xml-base&quot;&gt;xml:base&lt;/code&gt; attributes must be ignored
+  when resolving relative URIs in this &lt;code
+  title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute.&lt;/p&gt;
 
+  &lt;p class=&quot;note&quot;&gt;If there are multiple &lt;code&gt;base&lt;/code&gt; elements
+  with &lt;code title=&quot;att-base-href&quot;&gt;href&lt;/code&gt; attributes, all but the
+  first are ignored.&lt;/p&gt;
+
   &lt;p&gt;The &lt;dfn title=&quot;attr-base-target&quot;&gt;&lt;code&gt;target&lt;/code&gt;&lt;/dfn&gt;
   attribute, if specified, must contain a &lt;span&gt;valid browsing context
   name&lt;/span&gt;. User agents use this name when &lt;span&gt;following
@@ -5859,7 +5861,18 @@
   must &lt;span&gt;reflect&lt;/span&gt; the content attributes of the same
   name.&lt;/p&gt;
 
+  &lt;p class=&quot;note&quot;&gt;Pages with multiple &lt;code&gt;base&lt;/code&gt; elements have
+  all but their first &lt;code&gt;base&lt;/code&gt; element with an &lt;code
+  title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute ignored for the
+  purposes of URI resolution, and all but their first
+  &lt;code&gt;base&lt;/code&gt; element with a &lt;code
+  title=&quot;attr-base-target&quot;&gt;target&lt;/code&gt; attribute ignored for the
+  purposes of default browsing context name resolution.&lt;/p&gt;
+  &lt;!-- XXX the former is for compat with IE7. The latter is not
+  actually exactly compatible with anything. We'll see if it breaks
+  anything. --&gt;
 
+
   &lt;h4&gt;The &lt;dfn&gt;&lt;code&gt;link&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
   &lt;p&gt;&lt;span title=&quot;metadata elements&quot;&gt;Metadata element&lt;/span&gt;.&lt;/p&gt;
@@ -6071,7 +6084,8 @@
   order that they were given in the HTTP entity header. Relative URIs
   in these headers must be resolved according to the rules given in
   HTTP, not relative to base URIs set by the document (e.g. using a
-  &lt;code&gt;base&lt;/code&gt; element or &lt;code&gt;xml:base&lt;/code&gt; attributes). &lt;a
+  &lt;code&gt;base&lt;/code&gt; element or &lt;code
+  title=&quot;attr-xml-base&quot;&gt;xml:base&lt;/code&gt; attributes). &lt;a
   href=&quot;#refsRFC2616&quot;&gt;[RFC2616]&lt;/a&gt; &lt;a
   href=&quot;#refsRFC2068&quot;&gt;[RFC2068]&lt;/a&gt;&lt;/p&gt;
 
@@ -21425,16 +21439,17 @@
 
   &lt;p&gt;Otherwise, if the hyperlink element is an &lt;code&gt;a&lt;/code&gt; or
   &lt;code&gt;area&lt;/code&gt; element with no &lt;code
-  title=&quot;attr-hyperlink-target&quot;&gt;target&lt;/code&gt; attribute, but there is
-  a &lt;code&gt;base&lt;/code&gt; element with a &lt;code
-  title=&quot;attr-base-target&quot;&gt;target&lt;/code&gt; attribute in the document,
-  then the browsing context that is navigated must be chosen by
-  applying &lt;span&gt;the rules for chosing a browsing context given a
-  browsing context name&lt;/span&gt;, using the value of the &lt;code
-  title=&quot;attr-base-target&quot;&gt;target&lt;/code&gt; attribute of the first such
-  &lt;code&gt;base&lt;/code&gt; element as the browsing context name. If these
-  rules result in the creation of a new &lt;span&gt;browsing context&lt;/span&gt;,
-  it must be navigated with &lt;span&gt;replacement enabled&lt;/span&gt;.&lt;/p&gt;
+  title=&quot;attr-hyperlink-target&quot;&gt;target&lt;/code&gt; attribute, but one of
+  the child nodes of &lt;span&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/span&gt; is a
+  &lt;code&gt;base&lt;/code&gt; element with a &lt;code
+  title=&quot;attr-base-target&quot;&gt;target&lt;/code&gt; attribute, then the browsing
+  context that is navigated must be chosen by applying &lt;span&gt;the rules
+  for chosing a browsing context given a browsing context name&lt;/span&gt;,
+  using the value of the &lt;code title=&quot;attr-base-target&quot;&gt;target&lt;/code&gt;
+  attribute of the first such &lt;code&gt;base&lt;/code&gt; element as the
+  browsing context name. If these rules result in the creation of a
+  new &lt;span&gt;browsing context&lt;/span&gt;, it must be navigated with
+  &lt;span&gt;replacement enabled&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;Otherwise, the browsing context that must be navigated is the
   same browsing context as the one which the hyperlink element itself
@@ -32744,10 +32759,6 @@
         if that is null (&lt;span&gt;&lt;code&gt;innerHTML&lt;/code&gt; case&lt;/span&gt;), to
         the &lt;span&gt;current node&lt;/span&gt;.&lt;/p&gt;
 
-        &lt;p class=&quot;big-issue&quot;&gt;Need to cope with second and subsequent
-        &lt;code&gt;base&lt;/code&gt; elements affecting subsequent elements
-        magically.&lt;/p&gt;
-
        &lt;/dd&gt;
 
        &lt;dt&gt;An end tag with the tag name &quot;head&quot;&lt;/dt&gt;
@@ -35549,33 +35560,34 @@
 
   &lt;h2 class=&quot;no-num&quot;&gt;Acknowledgements&lt;/h2&gt;
 
-  &lt;p&gt;Thanks to Aankhen, Aaron Leventhal, Alexey Feldgendler, Andrew
-  Gove, Anne van Kesteren, Anthony Hickson, Asbj&oslash;rn Ulsberg,
-  Ben Godfrey, Ben Meadowcroft, Benjamin Hawkes-Lewis, Bert Bos,
-  Bjoern Hoehrmann, Boris Zbarsky, Brad Fults, Brad Neuberg, Brendan
-  Eich, Brett Wilson, Chao Cai, Channy Yun, Charl van
-  Niekerk&lt;!--status.whatwg.org maintainer--&gt;, Charles Iliya Krempeaux,
-  Charles McCathieNevile, Christian Biesinger, Christian Johansen,
-  Chriswa, Daniel Peng, Daniel Sp&aring;ng, Darin Fisher, Dave
-  Townsend&lt;!-- Mossop on moz irc --&gt;, David Baron, David Flanagan,
-  David H&aring;s&auml;ther, David Hyatt, Derek Featherstone, Dimitri
-  Glazkov, dolphinling, Doron Rosenberg, Eira Monstad, Elliotte
-  Harold, Erik Arvidsson, fantasai, Franck 'Shift' Qu&eacute;lain,
-  H&aring;kon Wium Lie, Henri Sivonen, Henrik Lied, Ignacio Javier,
-  J. King, James Graham, James M Snell, James Perrett, Jan-Klaas
-  Kollhof, Jasper Bryant-Greene, Jeff Cutsinger, Jens Bannmann, Joel
-  Spolsky, John Harding, Johnny Stenback, Jon Perlow, Jonathan Worent,
-  Jorgen Horstink, Joshua Randall, Jukka K. Korpela, Kai Hendry,
-  Kornel Lesinski, &amp;#x9ed2;&amp;#x6fa4;&amp;#x525b;&amp;#x5fd7; (KUROSAWA
-  Takeshi), Lachlan Hunt, Larry Page, Laurens Holst, Lenny Domnitser,
-  L&eacute;onard Bouchet, Leons Petrazickis, Logan&lt;!-- on moz irc --&gt;,
-  Maciej Stachowiak, Malcolm Rowe, Mark Nottingham, Mark Schenk,
-  Martijn Wargers, Martin Atkins, Martin Honnen, Mathieu Henri,
-  Matthew Mastracci, Matthew Raymond, Matthew Thomas, Mattias Waldau,
-  Max Romantschuk, Michael 'Ratt' Iannarelli, Michael A. Nachbaur,
-  Michael Gratton, Michael Powers, Michel Fortin, Mihai
-  &amp;#x015E;ucan&lt;!-- from ROBO Design --&gt;, Mike Dierken&lt;!-- S. Mike
-  Dierken --&gt;, Mike Dixon, Mike Schinkel, Mike Shaver, Mikko
+  &lt;p&gt;Thanks to Aankhen, Aaron Leventhal, Adrian Sutton, Alexey
+  Feldgendler, Andrew Gove, Anne van Kesteren, Anthony Hickson,
+  Asbj&oslash;rn Ulsberg, Ben Godfrey, Ben Meadowcroft, Benjamin
+  Hawkes-Lewis, Bert Bos, Bjoern Hoehrmann, Boris Zbarsky, Brad Fults,
+  Brad Neuberg, Brendan Eich, Brett Wilson, Chao Cai, Channy Yun,
+  Charl van Niekerk&lt;!--status.whatwg.org maintainer--&gt;, Charles Iliya
+  Krempeaux, Charles McCathieNevile, Christian Biesinger, Christian
+  Johansen, Chriswa, Daniel Peng, Daniel Sp&aring;ng, Darin Fisher,
+  Dave Townsend&lt;!-- Mossop on moz irc --&gt;, David Baron, David
+  Flanagan, David H&aring;s&auml;ther, David Hyatt, Derek
+  Featherstone, Dimitri Glazkov, dolphinling, Doron Rosenberg, Eira
+  Monstad, Elliotte Harold, Erik Arvidsson, fantasai, Franck 'Shift'
+  Qu&eacute;lain, Geoffrey Sneddon, H&aring;kon Wium Lie, Henri
+  Sivonen, Henrik Lied, Ignacio Javier, J. King, James Graham, James M
+  Snell, James Perrett, Jan-Klaas Kollhof, Jasper Bryant-Greene, Jeff
+  Cutsinger, Jens Bannmann, Joel Spolsky, John Harding, Johnny
+  Stenback, Jon Perlow, Jonathan Worent, Jorgen Horstink, Joshua
+  Randall, Jukka K. Korpela, Kai Hendry, &lt;!-- Keryx Web, = Lars
+  Gunther --&gt; Kornel Lesinski, &amp;#x9ed2;&amp;#x6fa4;&amp;#x525b;&amp;#x5fd7;
+  (KUROSAWA Takeshi), Lachlan Hunt, Larry Page, Lars Gunther, Laurens
+  Holst, Lenny Domnitser, L&eacute;onard Bouchet, Leons Petrazickis,
+  Logan&lt;!-- on moz irc --&gt;, Maciej Stachowiak, Malcolm Rowe, Mark
+  Nottingham, Mark Schenk, Martijn Wargers, Martin Atkins, Martin
+  Honnen, Mathieu Henri, Matthew Mastracci, Matthew Raymond, Matthew
+  Thomas, Mattias Waldau, Max Romantschuk, Michael 'Ratt' Iannarelli,
+  Michael A. Nachbaur, Michael Gratton, Michael Powers, Michel Fortin,
+  Mihai &amp;#x015E;ucan&lt;!-- from ROBO Design --&gt;, Mike Dierken&lt;!--
+  S. Mike Dierken --&gt;, Mike Dixon, Mike Schinkel, Mike Shaver, Mikko
   Rantalainen, Neil Deakin, Olav Junker Kj&aelig;r, Philip Taylor,
   Rajas Moonka, Rimantas Liubertas, Robert O'Callahan, Robert Sayre,
   Roman Ivanov, S. Mike Dierken, Sam Ruby, Sean Knapp, Shadow2531,


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="007713.html">[html5] r791 - /
</A></li>
	<LI>Next message: <A HREF="007715.html">[html5] r793 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7714">[ date ]</a>
              <a href="thread.html#7714">[ thread ]</a>
              <a href="subject.html#7714">[ subject ]</a>
              <a href="author.html#7714">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
