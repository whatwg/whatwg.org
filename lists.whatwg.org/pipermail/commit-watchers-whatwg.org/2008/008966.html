<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2080 - [] (0) More poking around getting the media element	section to use the new event [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2080%20-%20%5B%5D%20%280%29%20More%20poking%20around%20getting%20the%20media%20element%0A%09section%20to%20use%20the%20new%20event%20%5B...%5D&In-Reply-To=%3C20080819005749.4813238E6FA%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008965.html">
   <LINK REL="Next"  HREF="008967.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2080 - [] (0) More poking around getting the media element	section to use the new event [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2080%20-%20%5B%5D%20%280%29%20More%20poking%20around%20getting%20the%20media%20element%0A%09section%20to%20use%20the%20new%20event%20%5B...%5D&In-Reply-To=%3C20080819005749.4813238E6FA%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2080 - [] (0) More poking around getting the media element	section to use the new event [...]">whatwg at whatwg.org
       </A><BR>
    <I>Mon Aug 18 17:57:49 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008965.html">[html5] r2079 - [] (0) Make it so that multiple pending load()s are	coallesced into one. (credit: pj)
</A></li>
        <LI>Next message: <A HREF="008967.html">[html5] r2081 - [] (0) Further work on the event loop front. Also,	make 'will' link to the actua [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8966">[ date ]</a>
              <a href="thread.html#8966">[ thread ]</a>
              <a href="subject.html#8966">[ subject ]</a>
              <a href="author.html#8966">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-08-18 17:57:47 -0700 (Mon, 18 Aug 2008)
New Revision: 2080

Modified:
   index
   source
Log:
[] (0) More poking around getting the media element section to use the new event loop stuff.

Modified: index
===================================================================
--- index	2008-08-18 21:27:22 UTC (rev 2079)
+++ index	2008-08-19 00:57:47 UTC (rev 2080)
@@ -28,7 +28,7 @@
 
    &lt;h1 id=html-5&gt;HTML 5&lt;/h1&gt;
 
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft&gt;Draft Recommendation &mdash; 18 August
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft&gt;Draft Recommendation &mdash; 19 August
     2008&lt;/h2&gt;
 
    &lt;p&gt;You can take part in this work. &lt;a
@@ -13046,7 +13046,7 @@
 
    &lt;dd&gt;&lt;code title=attr-hyperlink-rel&gt;&lt;a href=&quot;#rel3&quot;&gt;rel&lt;/a&gt;&lt;/code&gt;
 
-   &lt;dd&gt;&lt;code title=attr-hyperlink-media&gt;&lt;a href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;
+   &lt;dd&gt;&lt;code title=attr-hyperlink-media&gt;&lt;a href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;
 
    &lt;dd&gt;&lt;code title=attr-hyperlink-hreflang&gt;&lt;a
     href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;
@@ -13085,7 +13085,7 @@
    href=&quot;#target3&quot;&gt;target&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-ping&gt;&lt;a
    href=&quot;#ping&quot;&gt;ping&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-rel&gt;&lt;a
    href=&quot;#rel3&quot;&gt;rel&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-media&gt;&lt;a
-   href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
+   href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
    href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;, and &lt;code
    title=attr-hyperlink-type&gt;&lt;a href=&quot;#type20&quot;&gt;type&lt;/a&gt;&lt;/code&gt; attributes
    must be omitted if the &lt;code title=attr-hyperlink-href&gt;&lt;a
@@ -13114,7 +13114,7 @@
    title=attr-hyperlink-ping&gt;&lt;a href=&quot;#ping&quot;&gt;ping&lt;/a&gt;&lt;/code&gt; attributes
    decide how the link is followed. The &lt;code title=attr-hyperlink-rel&gt;&lt;a
    href=&quot;#rel3&quot;&gt;rel&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-media&gt;&lt;a
-   href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
+   href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
    href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;, and &lt;code
    title=attr-hyperlink-type&gt;&lt;a href=&quot;#type20&quot;&gt;type&lt;/a&gt;&lt;/code&gt; attributes may
    be used to indicate to the user the likely nature of the target resource
@@ -18689,8 +18689,8 @@
    &lt;code title=dom-media-load&gt;&lt;a href=&quot;#load&quot;&gt;load()&lt;/a&gt;&lt;/code&gt; method on the
    &lt;a href=&quot;#media7&quot;&gt;media element&lt;/a&gt;, and ignores any resulting exceptions.
    The &lt;a href=&quot;#task-source&quot;&gt;task source&lt;/a&gt; for this task is the &lt;a
-   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s own &lt;a href=&quot;#new-resource&quot;&gt;new
-   resource task source&lt;/a&gt;.
+   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s own &lt;a href=&quot;#media12&quot;&gt;media element
+   new resource task source&lt;/a&gt;.
 
   &lt;p&gt;The DOM attributes &lt;dfn id=src6
    title=dom-source-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=type9
@@ -18821,6 +18821,15 @@
    resource&lt;/dfn&gt; is used to refer to the complete set of media data, e.g.
    the complete video file, or complete audio file.
 
+  &lt;p&gt;&lt;a href=&quot;#media7&quot; title=&quot;media element&quot;&gt;Media elements&lt;/a&gt; use two &lt;a
+   href=&quot;#task-queues&quot; title=&quot;task queue&quot;&gt;task queues&lt;/a&gt;, the &lt;dfn
+   id=media11&gt;media element event task source&lt;/dfn&gt; for asynchronous events
+   and callbacks, and the &lt;dfn id=media12&gt;media element new resource task
+   source&lt;/dfn&gt; for handling implicit loads. Unless otherwise specified, all
+   the tasks &lt;a href=&quot;#queue&quot; title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; in this section
+   and its subsections use the &lt;a href=&quot;#media11&quot;&gt;media element event task
+   source&lt;/a&gt;.
+
   &lt;h5 id=error&gt;&lt;span class=secno&gt;4.7.10.1. &lt;/span&gt;Error codes&lt;/h5&gt;
 
   &lt;p&gt;All &lt;a href=&quot;#media7&quot; title=&quot;media element&quot;&gt;media elements&lt;/a&gt; have an
@@ -18883,8 +18892,8 @@
    href=&quot;#load&quot;&gt;load()&lt;/a&gt;&lt;/code&gt; method on the &lt;a href=&quot;#media7&quot;&gt;media
    element&lt;/a&gt;, and ignores any resulting exceptions. The &lt;a
    href=&quot;#task-source&quot;&gt;task source&lt;/a&gt; for this task is the &lt;a
-   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s own &lt;a href=&quot;#new-resource&quot;&gt;new
-   resource task source&lt;/a&gt;.
+   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s own &lt;a href=&quot;#media12&quot;&gt;media element
+   new resource task source&lt;/a&gt;.
 
   &lt;p class=note&gt;If a &lt;code title=attr-media-src&gt;&lt;a
    href=&quot;#src7&quot;&gt;src&lt;/a&gt;&lt;/code&gt; attribute is specified, the resource it
@@ -19072,10 +19081,15 @@
   &lt;ol&gt;
    &lt;li&gt;
     &lt;p&gt;If there are any &lt;a href=&quot;#tasks&quot; title=concept-task&gt;tasks&lt;/a&gt; from
-     the &lt;a href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s own &lt;dfn id=new-resource&gt;new
-     resource task source&lt;/dfn&gt; in one of the &lt;a href=&quot;#task-queues&quot;
-     title=&quot;task queue&quot;&gt;task queues&lt;/a&gt;, then remove those tasks.
+     the &lt;a href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s &lt;a href=&quot;#media12&quot;&gt;media
+     element new resource task source&lt;/a&gt; or its &lt;a href=&quot;#media11&quot;&gt;media
+     element event task source&lt;/a&gt; in one of the &lt;a href=&quot;#task-queues&quot;
+     title=&quot;task queue&quot;&gt;task queues&lt;/a&gt;, then remove those tasks.&lt;/p&gt;
 
+    &lt;p class=note&gt;Basically, pending events, callbacks, and loads for the
+     media element are discarded when the media element starts loading a new
+     resource.&lt;/p&gt;
+
    &lt;li&gt;
     &lt;p&gt;Any already-running instance of this algorithm for this element must
      be aborted. If those method calls have not yet returned, they must
@@ -19458,8 +19472,8 @@
    href=&quot;#load&quot;&gt;load()&lt;/a&gt;&lt;/code&gt; method on the &lt;a href=&quot;#media7&quot;&gt;media
    element&lt;/a&gt;, and ignores any resulting exceptions. The &lt;a
    href=&quot;#task-source&quot;&gt;task source&lt;/a&gt; for this task is the &lt;a
-   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s own &lt;a href=&quot;#new-resource&quot;&gt;new
-   resource task source&lt;/a&gt;.
+   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;'s own &lt;a href=&quot;#media12&quot;&gt;media element
+   new resource task source&lt;/a&gt;.
 
   &lt;p&gt;The &lt;dfn id=bufferingrate
    title=dom-media-bufferingRate&gt;&lt;code&gt;bufferingRate&lt;/code&gt;&lt;/dfn&gt; attribute
@@ -19523,12 +19537,11 @@
 
   &lt;p&gt;When the length of the &lt;a href=&quot;#media10&quot;&gt;media resource&lt;/a&gt; changes
    (e.g. from being unknown to known, or from indeterminate to known, or from
-   a previously established length to a new length) the user agent must, once
-   any running scripts have finished, &lt;a href=&quot;#firing2&quot;&gt;fire a simple
+   a previously established length to a new length) the user agent must &lt;a
+   href=&quot;#queue&quot;&gt;queue a task&lt;/a&gt; to &lt;a href=&quot;#firing2&quot;&gt;fire a simple
    event&lt;/a&gt; called &lt;code title=event-durationchange&gt;&lt;a
    href=&quot;#durationchange&quot;&gt;durationchange&lt;/a&gt;&lt;/code&gt; at the &lt;a
-   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;.&lt;/p&gt;
-  &lt;!-- xxx queue --&gt;
+   href=&quot;#media7&quot;&gt;media element&lt;/a&gt;.
 
   &lt;p&gt;&lt;a href=&quot;#media7&quot; title=&quot;media element&quot;&gt;Media elements&lt;/a&gt; have a &lt;dfn
    id=current0&gt;current playback position&lt;/dfn&gt;, which must initially be zero.
@@ -19967,20 +19980,19 @@
    href=&quot;#stopped&quot;&gt;stopped due to errors&lt;/a&gt;, or playback having &lt;a
    href=&quot;#paused0&quot;&gt;paused for user interaction&lt;/a&gt;, or the &lt;a href=&quot;#seek&quot;
    title=dom-media-seek&gt;seeking algorithm&lt;/a&gt; being invoked, the user agent
-   must &lt;a href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called &lt;code
-   title=event-timeupdate&gt;&lt;a href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt; at the
-   element, and then must &lt;a href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called
-   &lt;code title=event-waiting&gt;&lt;a href=&quot;#waiting&quot;&gt;waiting&lt;/a&gt;&lt;/code&gt; at the
-   element.&lt;/p&gt;
-  &lt;!-- xxx queue --&gt;
+   must &lt;a href=&quot;#queue&quot;&gt;queue a task&lt;/a&gt; to &lt;a href=&quot;#firing2&quot;&gt;fire a simple
+   event&lt;/a&gt; called &lt;code title=event-timeupdate&gt;&lt;a
+   href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt; at the element, and &lt;a
+   href=&quot;#queue&quot;&gt;queue a task&lt;/a&gt; to &lt;a href=&quot;#firing2&quot;&gt;fire a simple
+   event&lt;/a&gt; called &lt;code title=event-waiting&gt;&lt;a
+   href=&quot;#waiting&quot;&gt;waiting&lt;/a&gt;&lt;/code&gt; at the element.
 
   &lt;p&gt;When a &lt;a href=&quot;#media7&quot;&gt;media element&lt;/a&gt; that is &lt;a
    href=&quot;#actively&quot;&gt;actively playing&lt;/a&gt; stops playing because it has &lt;a
    href=&quot;#paused0&quot;&gt;paused for user interaction&lt;/a&gt;, the user agent must &lt;a
-   href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called &lt;code
-   title=event-timeupdate&gt;&lt;a href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt; at the
-   element.&lt;/p&gt;
-  &lt;!-- xxx queue --&gt;
+   href=&quot;#queue&quot;&gt;queue a task&lt;/a&gt; to &lt;a href=&quot;#firing2&quot;&gt;fire a simple
+   event&lt;/a&gt; called &lt;code title=event-timeupdate&gt;&lt;a
+   href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt; at the element.
 
   &lt;p&gt;When &lt;code title=dom-media-currentLoop&gt;&lt;a
    href=&quot;#currentloop&quot;&gt;currentLoop&lt;/a&gt;&lt;/code&gt; is less than &lt;span&gt;&lt;code
@@ -19988,12 +20000,12 @@
    href=&quot;#playcount0&quot;&gt;playCount&lt;/a&gt;&lt;/code&gt;-1&lt;/span&gt; and the &lt;a
    href=&quot;#current0&quot;&gt;current playback position&lt;/a&gt; reaches the &lt;var&gt;&lt;a
    href=&quot;#effective1&quot;&gt;effective loop end&lt;/a&gt;&lt;/var&gt;, then the user agent must
-   &lt;a href=&quot;#seek&quot; title=dom-media-seek&gt;seek&lt;/a&gt; to the &lt;var&gt;&lt;a
-   href=&quot;#effective0&quot;&gt;effective loop start&lt;/a&gt;&lt;/var&gt;, increase &lt;code
-   title=dom-media-currentLoop&gt;&lt;a href=&quot;#currentloop&quot;&gt;currentLoop&lt;/a&gt;&lt;/code&gt;
-   by 1, and &lt;a href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called &lt;code
-   title=event-timeupdate&gt;&lt;a href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
-  &lt;!-- xxx queue --&gt;
+   increase &lt;code title=dom-media-currentLoop&gt;&lt;a
+   href=&quot;#currentloop&quot;&gt;currentLoop&lt;/a&gt;&lt;/code&gt; by 1, &lt;a href=&quot;#queue&quot;&gt;queue a
+   task&lt;/a&gt; to &lt;a href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called &lt;code
+   title=event-timeupdate&gt;&lt;a href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt;, and &lt;a
+   href=&quot;#seek&quot; title=dom-media-seek&gt;seek&lt;/a&gt; to the &lt;var&gt;&lt;a
+   href=&quot;#effective0&quot;&gt;effective loop start&lt;/a&gt;&lt;/var&gt;.
 
   &lt;p&gt;When &lt;code title=dom-media-currentLoop&gt;&lt;a
    href=&quot;#currentloop&quot;&gt;currentLoop&lt;/a&gt;&lt;/code&gt; is equal to the &lt;span&gt;&lt;code
@@ -20012,16 +20024,15 @@
      href=&quot;#ended0&quot;&gt;ended&lt;/a&gt;&lt;/code&gt; attribute becomes true.
 
    &lt;li&gt;
-    &lt;p&gt;The user agent must &lt;a href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called
-     &lt;code title=event-timeupdate&gt;&lt;a href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt;
-     at the element.
-   &lt;/li&gt;
-   &lt;!-- xxx queue --&gt;
+    &lt;p&gt;The user agent must &lt;a href=&quot;#queue&quot;&gt;queue a task&lt;/a&gt; to &lt;a
+     href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called &lt;code
+     title=event-timeupdate&gt;&lt;a href=&quot;#timeupdate&quot;&gt;timeupdate&lt;/a&gt;&lt;/code&gt; at
+     the element.
 
    &lt;li&gt;
-    &lt;p&gt;The user agent must &lt;a href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called
-     &lt;code title=event-ended&gt;&lt;a href=&quot;#ended1&quot;&gt;ended&lt;/a&gt;&lt;/code&gt; at the
-     element.
+    &lt;p&gt;The user agent must &lt;a href=&quot;#queue&quot;&gt;queue a task&lt;/a&gt; to &lt;a
+     href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt; called &lt;code
+     title=event-ended&gt;&lt;a href=&quot;#ended1&quot;&gt;ended&lt;/a&gt;&lt;/code&gt; at the element.
   &lt;/ol&gt;
 
   &lt;p&gt;The &lt;dfn id=defaultplaybackrate
@@ -20050,13 +20061,14 @@
    title=dom-media-playbackRate&gt;&lt;a
    href=&quot;#playbackrate&quot;&gt;playbackRate&lt;/a&gt;&lt;/code&gt; attributes change value
    (either by being set by script or by being changed directly by the user
-   agent, e.g. in response to user control) the user agent must, once any
-   running scripts have finished, &lt;a href=&quot;#firing2&quot;&gt;fire a simple event&lt;/a&gt;
-   called &lt;code title=event-ratechange&gt;&lt;a
+   agent, e.g. in response to user control) the user agent must &lt;a
+   href=&quot;#queue&quot;&gt;queue a task&lt;/a&gt; to &lt;a href=&quot;#firing2&quot;&gt;fire a simple
+   event&lt;/a&gt; called &lt;code title=event-ratechange&gt;&lt;a
    href=&quot;#ratechange&quot;&gt;ratechange&lt;/a&gt;&lt;/code&gt; at the &lt;a href=&quot;#media7&quot;&gt;media
-   element&lt;/a&gt;.&lt;/p&gt;
-  &lt;!-- xxx queue --&gt;
+   element&lt;/a&gt;.
 
+  &lt;hr&gt;
+
   &lt;p&gt;When the &lt;dfn id=play title=dom-media-play&gt;&lt;code&gt;play()&lt;/code&gt;&lt;/dfn&gt;
    method on a &lt;a href=&quot;#media7&quot;&gt;media element&lt;/a&gt; is invoked, the user agent
    must run the following steps.
@@ -23746,7 +23758,7 @@
 
    &lt;dd&gt;&lt;code title=attr-hyperlink-rel&gt;&lt;a href=&quot;#rel3&quot;&gt;rel&lt;/a&gt;&lt;/code&gt;
 
-   &lt;dd&gt;&lt;code title=attr-hyperlink-media&gt;&lt;a href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;
+   &lt;dd&gt;&lt;code title=attr-hyperlink-media&gt;&lt;a href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;
 
    &lt;dd&gt;&lt;code title=attr-hyperlink-hreflang&gt;&lt;a
     href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;
@@ -23766,7 +23778,7 @@
            attribute DOMString &lt;a href=&quot;#ping1&quot; title=dom-area-ping&gt;ping&lt;/a&gt;;
            attribute DOMString &lt;a href=&quot;#rel2&quot; title=dom-area-rel&gt;rel&lt;/a&gt;;
   readonly attribute DOMTokenList &lt;a href=&quot;#rellist1&quot; title=dom-area-relList&gt;relList&lt;/a&gt;;
-           attribute DOMString &lt;a href=&quot;#media11&quot; title=dom-area-media&gt;media&lt;/a&gt;;
+           attribute DOMString &lt;a href=&quot;#media13&quot; title=dom-area-media&gt;media&lt;/a&gt;;
            attribute DOMString &lt;a href=&quot;#hreflang2&quot; title=dom-area-hreflang&gt;hreflang&lt;/a&gt;;
            attribute DOMString &lt;a href=&quot;#type10&quot; title=dom-area-type&gt;type&lt;/a&gt;;
 };&lt;/pre&gt;
@@ -23925,7 +23937,7 @@
    &lt;code title=attr-hyperlink-ping&gt;&lt;a href=&quot;#ping&quot;&gt;ping&lt;/a&gt;&lt;/code&gt; attributes
    decide how the link is followed. The &lt;code title=attr-hyperlink-rel&gt;&lt;a
    href=&quot;#rel3&quot;&gt;rel&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-media&gt;&lt;a
-   href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
+   href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
    href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;, and &lt;code
    title=attr-hyperlink-type&gt;&lt;a href=&quot;#type20&quot;&gt;type&lt;/a&gt;&lt;/code&gt; attributes may
    be used to indicate to the user the likely nature of the target resource
@@ -23935,7 +23947,7 @@
    href=&quot;#target3&quot;&gt;target&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-ping&gt;&lt;a
    href=&quot;#ping&quot;&gt;ping&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-rel&gt;&lt;a
    href=&quot;#rel3&quot;&gt;rel&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-media&gt;&lt;a
-   href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
+   href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
    href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;, and &lt;code
    title=attr-hyperlink-type&gt;&lt;a href=&quot;#type20&quot;&gt;type&lt;/a&gt;&lt;/code&gt; attributes
    must be omitted if the &lt;code title=attr-hyperlink-href&gt;&lt;a
@@ -23972,7 +23984,7 @@
    title=dom-area-href&gt;&lt;code&gt;href&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=target2
    title=dom-area-target&gt;&lt;code&gt;target&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=ping1
    title=dom-area-ping&gt;&lt;code&gt;ping&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=rel2
-   title=dom-area-rel&gt;&lt;code&gt;rel&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=media11
+   title=dom-area-rel&gt;&lt;code&gt;rel&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=media13
    title=dom-area-media&gt;&lt;code&gt;media&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=hreflang2
    title=dom-area-hreflang&gt;&lt;code&gt;hreflang&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn id=type10
    title=dom-area-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, each must &lt;a
@@ -38432,11 +38444,11 @@
    with the destination resource other than there being a hyperlink between
    the two.
 
-  &lt;p&gt;The &lt;dfn id=media12 title=attr-hyperlink-media&gt;&lt;code&gt;media&lt;/code&gt;&lt;/dfn&gt;
+  &lt;p&gt;The &lt;dfn id=media14 title=attr-hyperlink-media&gt;&lt;code&gt;media&lt;/code&gt;&lt;/dfn&gt;
    attribute describes for which media the target document was designed. It
    is purely advisory. The value must be a valid &lt;a href=&quot;#mq&quot;&gt;media
    query&lt;/a&gt;. &lt;a href=&quot;#refsMQ&quot;&gt;[MQ]&lt;/a&gt; The default, if the &lt;code
-   title=attr-hyperlink-media&gt;&lt;a href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt; attribute
+   title=attr-hyperlink-media&gt;&lt;a href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt; attribute
    is omitted, is &lt;code&gt;all&lt;/code&gt;.
 
   &lt;p&gt;The &lt;dfn id=hreflang3
@@ -38974,14 +38986,14 @@
    representation of the current document.
 
   &lt;p&gt;The nature of the referenced document is given by the &lt;code
-   title=attr-hyperlink-media&gt;&lt;a href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code
+   title=attr-hyperlink-media&gt;&lt;a href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code
    title=attr-hyperlink-hreflang&gt;&lt;a href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;,
    and &lt;code title=attr-hyperlink-type&gt;&lt;a href=&quot;#type20&quot;&gt;type&lt;/a&gt;&lt;/code&gt;
    attributes.
 
   &lt;p&gt;If the &lt;code title=rel-alternate&gt;&lt;a
    href=&quot;#alternate&quot;&gt;alternate&lt;/a&gt;&lt;/code&gt; keyword is used with the &lt;code
-   title=attr-hyperlink-media&gt;&lt;a href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt; attribute,
+   title=attr-hyperlink-media&gt;&lt;a href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt; attribute,
    it indicates that the referenced document is intended for use with the
    media specified.
 
@@ -38999,7 +39011,7 @@
    document in the specified format.
 
   &lt;p&gt;The &lt;code title=attr-hyperlink-media&gt;&lt;a
-   href=&quot;#media12&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
+   href=&quot;#media14&quot;&gt;media&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-hyperlink-hreflang&gt;&lt;a
    href=&quot;#hreflang3&quot;&gt;hreflang&lt;/a&gt;&lt;/code&gt;, and &lt;code
    title=attr-hyperlink-type&gt;&lt;a href=&quot;#type20&quot;&gt;type&lt;/a&gt;&lt;/code&gt; attributes can
    be combined when specified with the &lt;code title=rel-alternate&gt;&lt;a

Modified: source
===================================================================
--- source	2008-08-18 21:27:22 UTC (rev 2079)
+++ source	2008-08-19 00:57:47 UTC (rev 2080)
@@ -16202,7 +16202,7 @@
   title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method on the &lt;span&gt;media
   element&lt;/span&gt;, and ignores any resulting exceptions. The &lt;span&gt;task
   source&lt;/span&gt; for this task is the &lt;span&gt;media element&lt;/span&gt;'s own
-  &lt;span&gt;new resource task source&lt;/span&gt;.&lt;/p&gt;
+  &lt;span&gt;media element new resource task source&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;The DOM attributes &lt;dfn
   title=&quot;dom-source-src&quot;&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn
@@ -16336,8 +16336,17 @@
   resource&lt;/dfn&gt; is used to refer to the complete set of media data,
   e.g. the complete video file, or complete audio file.&lt;/p&gt;
 
+  &lt;p&gt;&lt;span title=&quot;media element&quot;&gt;Media elements&lt;/span&gt; use two &lt;span
+  title=&quot;task queue&quot;&gt;task queues&lt;/span&gt;, the &lt;dfn&gt;media element event
+  task source&lt;/dfn&gt; for asynchronous events and callbacks, and the
+  &lt;dfn&gt;media element new resource task source&lt;/dfn&gt; for handling
+  implicit loads. Unless otherwise specified, all the tasks &lt;span
+  title=&quot;queue a task&quot;&gt;queued&lt;/span&gt; in this section and its
+  subsections use the &lt;span&gt;media element event task
+  source&lt;/span&gt;.&lt;/p&gt;
 
 
+
   &lt;h5&gt;Error codes&lt;/h5&gt;
 
   &lt;p&gt;All &lt;span title=&quot;media element&quot;&gt;media elements&lt;/span&gt; have an
@@ -16395,8 +16404,8 @@
   implicitly invokes the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
   method on the &lt;span&gt;media element&lt;/span&gt;, and ignores any resulting
   exceptions. The &lt;span&gt;task source&lt;/span&gt; for this task is the
-  &lt;span&gt;media element&lt;/span&gt;'s own &lt;span&gt;new resource task
-  source&lt;/span&gt;.&lt;/p&gt;
+  &lt;span&gt;media element&lt;/span&gt;'s own &lt;span&gt;media element new resource
+  task source&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p class=&quot;note&quot;&gt;If a &lt;code title=&quot;attr-media-src&quot;&gt;src&lt;/code&gt;
   attribute is specified, the resource it specifies is the &lt;span&gt;media
@@ -16578,11 +16587,20 @@
 
   &lt;ol&gt;
 
-   &lt;li&gt;&lt;p&gt;If there are any &lt;span title=&quot;concept-task&quot;&gt;tasks&lt;/span&gt;
-   from the &lt;span&gt;media element&lt;/span&gt;'s own &lt;dfn&gt;new resource task
-   source&lt;/dfn&gt; in one of the &lt;span title=&quot;task queue&quot;&gt;task
-   queues&lt;/span&gt;, then remove those tasks.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;If there are any &lt;span title=&quot;concept-task&quot;&gt;tasks&lt;/span&gt; from
+    the &lt;span&gt;media element&lt;/span&gt;'s &lt;span&gt;media element new resource
+    task source&lt;/span&gt; or its &lt;span&gt;media element event task
+    source&lt;/span&gt; in one of the &lt;span title=&quot;task queue&quot;&gt;task
+    queues&lt;/span&gt;, then remove those tasks.&lt;/p&gt;
+
+    &lt;p class=&quot;note&quot;&gt;Basically, pending events, callbacks, and loads
+    for the media element are discarded when the media element starts
+    loading a new resource.&lt;/p&gt;
+
+   &lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;Any already-running instance of this algorithm for this
    element must be aborted. If those method calls have not yet
    returned, they must finish the step they are on, and then
@@ -16969,8 +16987,8 @@
   implicitly invokes the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
   method on the &lt;span&gt;media element&lt;/span&gt;, and ignores any resulting
   exceptions. The &lt;span&gt;task source&lt;/span&gt; for this task is the
-  &lt;span&gt;media element&lt;/span&gt;'s own &lt;span&gt;new resource task
-  source&lt;/span&gt;.&lt;/p&gt;
+  &lt;span&gt;media element&lt;/span&gt;'s own &lt;span&gt;media element new resource
+  task source&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn
   title=&quot;dom-media-bufferingRate&quot;&gt;&lt;code&gt;bufferingRate&lt;/code&gt;&lt;/dfn&gt;
@@ -17034,10 +17052,10 @@
   &lt;p&gt;When the length of the &lt;span&gt;media resource&lt;/span&gt; changes
   (e.g. from being unknown to known, or from indeterminate to known,
   or from a previously established length to a new length) the user
-  agent must, once any running scripts have finished, &lt;span&gt;fire a
-  simple event&lt;/span&gt; called &lt;code
+  agent must &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
+  event&lt;/span&gt; called &lt;code
   title=&quot;event-durationchange&quot;&gt;durationchange&lt;/code&gt; at the
-  &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;&lt;!-- xxx queue --&gt;
+  &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;&lt;span title=&quot;media element&quot;&gt;Media elements&lt;/span&gt; have a
   &lt;dfn&gt;current playback position&lt;/dfn&gt;, which must initially be
@@ -17441,28 +17459,28 @@
   having &lt;span&gt;ended playback&lt;/span&gt;, or playback having &lt;span&gt;stopped
   due to errors&lt;/span&gt;, or playback having &lt;span&gt;paused for user
   interaction&lt;/span&gt;, or the &lt;span title=&quot;dom-media-seek&quot;&gt;seeking
-  algorithm&lt;/span&gt; being invoked, the user agent must &lt;span&gt;fire a
-  simple event&lt;/span&gt; called &lt;code
-  title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt; at the element, and then
-  must &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
-  title=&quot;event-waiting&quot;&gt;waiting&lt;/code&gt; at the element.&lt;/p&gt;&lt;!-- xxx queue --&gt;
+  algorithm&lt;/span&gt; being invoked, the user agent must &lt;span&gt;queue a
+  task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
+  title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt; at the element, and
+  &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt; called
+  &lt;code title=&quot;event-waiting&quot;&gt;waiting&lt;/code&gt; at the element.&lt;/p&gt;
 
   &lt;p&gt;When a &lt;span&gt;media element&lt;/span&gt; that is &lt;span&gt;actively
   playing&lt;/span&gt; stops playing because it has &lt;span&gt;paused for user
-  interaction&lt;/span&gt;, the user agent must &lt;span&gt;fire a simple
-  event&lt;/span&gt; called &lt;code title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt;
-  at the element.&lt;/p&gt;&lt;!-- xxx queue --&gt;
+  interaction&lt;/span&gt;, the user agent must &lt;span&gt;queue a task&lt;/span&gt; to
+  &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
+  title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt; at the element.&lt;/p&gt;
 
   &lt;p&gt;When &lt;code title=&quot;dom-media-currentLoop&quot;&gt;currentLoop&lt;/code&gt; is
   less than &lt;span&gt;&lt;code
   title=&quot;dom-media-playCount&quot;&gt;playCount&lt;/code&gt;-1&lt;/span&gt; and the
   &lt;span&gt;current playback position&lt;/span&gt; reaches the &lt;var&gt;effective
-  loop end&lt;/var&gt;, then the user agent must &lt;span
+  loop end&lt;/var&gt;, then the user agent must increase &lt;code
+  title=&quot;dom-media-currentLoop&quot;&gt;currentLoop&lt;/code&gt; by 1, &lt;span&gt;queue a
+  task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
+  title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt;, and &lt;span
   title=&quot;dom-media-seek&quot;&gt;seek&lt;/span&gt; to the &lt;var&gt;effective loop
-  start&lt;/var&gt;, increase &lt;code
-  title=&quot;dom-media-currentLoop&quot;&gt;currentLoop&lt;/code&gt; by 1, and
-  &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
-  title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt;.&lt;/p&gt;&lt;!-- xxx queue --&gt;
+  start&lt;/var&gt;.&lt;/p&gt;
 
   &lt;p&gt;When &lt;code title=&quot;dom-media-currentLoop&quot;&gt;currentLoop&lt;/code&gt; is
   equal to the &lt;span&gt;&lt;code
@@ -17477,12 +17495,13 @@
    &lt;li&gt;&lt;p class=&quot;note&quot;&gt;The &lt;code title=&quot;dom-media-ended&quot;&gt;ended&lt;/code&gt;
    attribute becomes true.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;The user agent must &lt;span&gt;fire a simple event&lt;/span&gt; called
-   &lt;code title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt; at the
-   element.&lt;/p&gt;&lt;/li&gt;&lt;!-- xxx queue --&gt;
+   &lt;li&gt;&lt;p&gt;The user agent must &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire
+   a simple event&lt;/span&gt; called &lt;code
+   title=&quot;event-timeupdate&quot;&gt;timeupdate&lt;/code&gt; at the element.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;The user agent must &lt;span&gt;fire a simple event&lt;/span&gt; called
-   &lt;code title=&quot;event-ended&quot;&gt;ended&lt;/code&gt; at the element.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;The user agent must &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire
+   a simple event&lt;/span&gt; called &lt;code title=&quot;event-ended&quot;&gt;ended&lt;/code&gt;
+   at the element.&lt;/p&gt;&lt;/li&gt;
 
   &lt;/ol&gt;
 
@@ -17514,14 +17533,14 @@
   &lt;code title=&quot;dom-media-playbackRate&quot;&gt;playbackRate&lt;/code&gt; attributes
   change value (either by being set by script or by being changed
   directly by the user agent, e.g. in response to user control) the
-  user agent must, once any running scripts have finished, &lt;span&gt;fire
+  user agent must &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire
   a simple event&lt;/span&gt; called &lt;code
   title=&quot;event-ratechange&quot;&gt;ratechange&lt;/code&gt; at the &lt;span&gt;media
-  element&lt;/span&gt;.&lt;/p&gt;&lt;!-- xxx queue --&gt;
+  element&lt;/span&gt;.&lt;/p&gt;
 
 
+  &lt;hr&gt;
 
-
   &lt;p&gt;When the &lt;dfn title=&quot;dom-media-play&quot;&gt;&lt;code&gt;play()&lt;/code&gt;&lt;/dfn&gt;
   method on a &lt;span&gt;media element&lt;/span&gt; is invoked, the user agent
   must run the following steps.&lt;/p&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008965.html">[html5] r2079 - [] (0) Make it so that multiple pending load()s are	coallesced into one. (credit: pj)
</A></li>
	<LI>Next message: <A HREF="008967.html">[html5] r2081 - [] (0) Further work on the event loop front. Also,	make 'will' link to the actua [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8966">[ date ]</a>
              <a href="thread.html#8966">[ thread ]</a>
              <a href="subject.html#8966">[ subject ]</a>
              <a href="author.html#8966">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
