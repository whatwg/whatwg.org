<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2404 - [gw] (2) Make &lt;source type&gt; optional. Move	canPlayType from navigator to HTMLMed [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2404%20-%20%5Bgw%5D%20%282%29%20Make%20%3Csource%20type%3E%20optional.%20Move%0A%09canPlayType%20from%20navigator%20to%20HTMLMed%20%5B...%5D&In-Reply-To=%3C20081115192846.02102141AE6%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009287.html">
   <LINK REL="Next"  HREF="009289.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2404 - [gw] (2) Make &lt;source type&gt; optional. Move	canPlayType from navigator to HTMLMed [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2404%20-%20%5Bgw%5D%20%282%29%20Make%20%3Csource%20type%3E%20optional.%20Move%0A%09canPlayType%20from%20navigator%20to%20HTMLMed%20%5B...%5D&In-Reply-To=%3C20081115192846.02102141AE6%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2404 - [gw] (2) Make &lt;source type&gt; optional. Move	canPlayType from navigator to HTMLMed [...]">whatwg at whatwg.org
       </A><BR>
    <I>Sat Nov 15 11:28:46 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="009287.html">[html5] r2403 - [gow] (2) Revamp the load() algorithm so that it	tries each possible file in turn.
</A></li>
        <LI>Next message: <A HREF="009289.html">[html5] r2405 - [] (0) Remove bufferedBytes and totalBytes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9288">[ date ]</a>
              <a href="thread.html#9288">[ thread ]</a>
              <a href="subject.html#9288">[ subject ]</a>
              <a href="author.html#9288">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-11-15 11:28:46 -0800 (Sat, 15 Nov 2008)
New Revision: 2404

Modified:
   index
   source
Log:
[gw] (2) Make &lt;source type&gt; optional. Move canPlayType from navigator to HTMLMediaElement. Make it return a string instead of an integer. Fix up the candidate URL list generation. Make loadstart/play event sequencing deterministic.

Modified: index
===================================================================
--- index	2008-11-14 06:50:23 UTC (rev 2403)
+++ index	2008-11-15 19:28:46 UTC (rev 2404)
@@ -17,7 +17,7 @@
   &lt;div class=head&gt;
    &lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;h1&gt;HTML 5&lt;/h1&gt;
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 14 November 2008&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 15 November 2008&lt;/h2&gt;
    &lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;dl&gt;&lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -437,18 +437,19 @@
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#error-codes&gt;&lt;span class=secno&gt;4.8.10.1 &lt;/span&gt;Error codes&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#location-of-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.2 &lt;/span&gt;Location of the media resource&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#network-states&gt;&lt;span class=secno&gt;4.8.10.3 &lt;/span&gt;Network states&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#loading-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.4 &lt;/span&gt;Loading the media resource&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#offsets-into-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.5 &lt;/span&gt;Offsets into the media resource&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#the-ready-states&gt;&lt;span class=secno&gt;4.8.10.6 &lt;/span&gt;The ready states&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#cue-ranges&gt;&lt;span class=secno&gt;4.8.10.7 &lt;/span&gt;Cue ranges&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#playing-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.8 &lt;/span&gt;Playing the media resource&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#seeking&gt;&lt;span class=secno&gt;4.8.10.9 &lt;/span&gt;Seeking&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#user-interface&gt;&lt;span class=secno&gt;4.8.10.10 &lt;/span&gt;User interface&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#time-ranges&gt;&lt;span class=secno&gt;4.8.10.11 &lt;/span&gt;Time ranges&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#byte-ranges&gt;&lt;span class=secno&gt;4.8.10.12 &lt;/span&gt;Byte ranges&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#mediaevents&gt;&lt;span class=secno&gt;4.8.10.13 &lt;/span&gt;Event summary&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#security-and-privacy-considerations&gt;&lt;span class=secno&gt;4.8.10.14 &lt;/span&gt;Security and privacy considerations&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#media-types&gt;&lt;span class=secno&gt;4.8.10.3 &lt;/span&gt;Media types&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#network-states&gt;&lt;span class=secno&gt;4.8.10.4 &lt;/span&gt;Network states&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#loading-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.5 &lt;/span&gt;Loading the media resource&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#offsets-into-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.6 &lt;/span&gt;Offsets into the media resource&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#the-ready-states&gt;&lt;span class=secno&gt;4.8.10.7 &lt;/span&gt;The ready states&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#cue-ranges&gt;&lt;span class=secno&gt;4.8.10.8 &lt;/span&gt;Cue ranges&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#playing-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.9 &lt;/span&gt;Playing the media resource&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#seeking&gt;&lt;span class=secno&gt;4.8.10.10 &lt;/span&gt;Seeking&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#user-interface&gt;&lt;span class=secno&gt;4.8.10.11 &lt;/span&gt;User interface&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#time-ranges&gt;&lt;span class=secno&gt;4.8.10.12 &lt;/span&gt;Time ranges&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#byte-ranges&gt;&lt;span class=secno&gt;4.8.10.13 &lt;/span&gt;Byte ranges&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#mediaevents&gt;&lt;span class=secno&gt;4.8.10.14 &lt;/span&gt;Event summary&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#security-and-privacy-considerations&gt;&lt;span class=secno&gt;4.8.10.15 &lt;/span&gt;Security and privacy considerations&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-canvas-element&gt;&lt;span class=secno&gt;4.8.11 &lt;/span&gt;The &lt;code&gt;canvas&lt;/code&gt; element&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#the-2d-context&gt;&lt;span class=secno&gt;4.8.11.1 &lt;/span&gt;The 2D context&lt;/a&gt;
@@ -657,8 +658,7 @@
      &lt;li&gt;&lt;a href=#custom-handlers&gt;&lt;span class=secno&gt;5.6.2 &lt;/span&gt;Custom protocol and content handlers&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#security-and-privacy&gt;&lt;span class=secno&gt;5.6.2.1 &lt;/span&gt;Security and privacy&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#sample-handler-impl&gt;&lt;span class=secno&gt;5.6.2.2 &lt;/span&gt;Sample user interface&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#client-abilities&gt;&lt;span class=secno&gt;5.6.3 &lt;/span&gt;Client abilities&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#sample-handler-impl&gt;&lt;span class=secno&gt;5.6.2.2 &lt;/span&gt;Sample user interface&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#offline&gt;&lt;span class=secno&gt;5.7 &lt;/span&gt;Offline Web applications&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-0&gt;&lt;span class=secno&gt;5.7.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
@@ -16698,10 +16698,10 @@
   &lt;p&gt;The &lt;dfn id=attr-source-type title=attr-source-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;
   attribute gives the type of the &lt;a href=#media-resource&gt;media resource&lt;/a&gt;, to help
   the user agent determine if it can play this &lt;a href=#media-resource&gt;media
-  resource&lt;/a&gt; before fetching it. Its value must be a MIME
-  type. The &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter may be specified
-  and might be necessary to specify exactly how the resource is
-  encoded. &lt;a href=#refsRFC2046&gt;[RFC2046]&lt;/a&gt; &lt;a href=#refsRFC4281&gt;[RFC4281]&lt;/a&gt;&lt;/p&gt;
+  resource&lt;/a&gt; before fetching it. If specified, its value must be
+  a MIME type. The &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter may be
+  specified and might be necessary to specify exactly how the resource
+  is encoded. &lt;a href=#refsRFC2046&gt;[RFC2046]&lt;/a&gt; &lt;a href=#refsRFC4281&gt;[RFC4281]&lt;/a&gt;&lt;/p&gt;
 
   &lt;div class=example&gt;
 
@@ -16796,11 +16796,6 @@
   &lt;a href=#media-resource&gt;media resource&lt;/a&gt; is useful to the user before fetching
   it. Its value must be a valid &lt;a href=#mq&gt;media query&lt;/a&gt;. &lt;a href=#refsMQ&gt;[MQ]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;Either the &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute,
-  the &lt;code title=attr-source-media&gt;&lt;a href=#attr-source-media&gt;media&lt;/a&gt;&lt;/code&gt; attribute or both,
-  must be specified, unless this is the last &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt;
-  element child of the parent element.&lt;/p&gt;
-
   &lt;p&gt;The &lt;dfn id=attr-source-pixelratio title=attr-source-pixelratio&gt;&lt;code&gt;pixelratio&lt;/code&gt;&lt;/dfn&gt;
   attribute allows the author to specify the pixel ratio of anamorphic
   &lt;a href=#media-resource title=&quot;media resource&quot;&gt;media resources&lt;/a&gt; that do not
@@ -16861,6 +16856,7 @@
   readonly attribute &lt;a href=#byteranges&gt;ByteRanges&lt;/a&gt; &lt;a href=#dom-media-bufferedbytes title=dom-media-bufferedBytes&gt;bufferedBytes&lt;/a&gt;;
   readonly attribute unsigned long &lt;a href=#dom-media-totalbytes title=dom-media-totalBytes&gt;totalBytes&lt;/a&gt;;
   void &lt;a href=#dom-media-load title=dom-media-load&gt;load&lt;/a&gt;();
+  DOMString &lt;a href=#dom-navigator-canplaytype title=dom-navigator-canPlayType&gt;canPlayType&lt;/a&gt;(in DOMString type);
 
   // ready state
   const unsigned short &lt;a href=#dom-media-have_nothing title=dom-media-HAVE_NOTHING&gt;HAVE_NOTHING&lt;/a&gt; = 0;
@@ -16949,11 +16945,7 @@
   task&quot;&gt;queued&lt;/a&gt; in this section and its subsections is the
   &lt;a href=#media-element-event-task-source&gt;media element event task source&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code title=dom-navigator-canPlayType&gt;&lt;a href=#dom-navigator-canplaytype&gt;canPlayType()&lt;/a&gt;&lt;/code&gt;
-  method can be used to probe the user agent to determine what types
-  are supported.&lt;/p&gt;
 
-
   &lt;h5 id=error-codes&gt;&lt;span class=secno&gt;4.8.10.1 &lt;/span&gt;Error codes&lt;/h5&gt;
 
   &lt;p&gt;All &lt;a href=#media-element title=&quot;media element&quot;&gt;media elements&lt;/a&gt; have an
@@ -17086,21 +17078,22 @@
 
     &lt;p&gt;If all the following conditions are true:&lt;/p&gt;
 
-    &lt;ul&gt;&lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute&lt;/li&gt;
+    &lt;ul&gt;&lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute.&lt;/li&gt;
 
      &lt;li&gt;&lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;Resolving&lt;/a&gt; the
      &lt;a href=#url&gt;URL&lt;/a&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
      element's &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute does
-     not fail&lt;/li&gt;
+     not fail.&lt;/li&gt;
 
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute and that
-     attribute's value, when parsed as a MIME type (including any
-     codecs described by the &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter),
-     does not represent a type that the user agent knows it cannot
-     render &lt;a href=#refsRFC2046&gt;[RFC2046]&lt;/a&gt; &lt;a href=#refsRFC4281&gt;[RFC4281]&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, or its &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute's value, when
+     parsed as a MIME type (including any codecs described by the
+     &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter), does not represent
+     &lt;a href=#a-type-that-the-user-agent-knows-it-cannot-render&gt;a type that the user agent knows it cannot
+     render&lt;/a&gt;.&lt;/li&gt;
 
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code title=attr-source-media&gt;&lt;a href=#attr-source-media&gt;media&lt;/a&gt;&lt;/code&gt; attribute and that
-     attribute's value, when processed according to the rules for &lt;a href=#mq&gt;media queries&lt;/a&gt;, matches the current environment &lt;a href=#refsMQ&gt;[MQ]&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code title=attr-source-media&gt;&lt;a href=#attr-source-media&gt;media&lt;/a&gt;&lt;/code&gt; attribute, or its &lt;code title=attr-source-media&gt;&lt;a href=#attr-source-media&gt;media&lt;/a&gt;&lt;/code&gt; attribute's value, when
+     processed according to the rules for &lt;a href=#mq&gt;media
+     queries&lt;/a&gt;, matches the current environment. &lt;a href=#refsMQ&gt;[MQ]&lt;/a&gt;&lt;/li&gt;
 
     &lt;/ul&gt;&lt;p&gt;...then append an item to the &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; list
     consisting of the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; resulting from &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolving&lt;/a&gt; the &lt;a href=#url&gt;URL&lt;/a&gt; given
@@ -17120,8 +17113,77 @@
 
    &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;h5 id=network-states&gt;&lt;span class=secno&gt;4.8.10.3 &lt;/span&gt;Network states&lt;/h5&gt;
+  &lt;/ol&gt;&lt;h5 id=media-types&gt;&lt;span class=secno&gt;4.8.10.3 &lt;/span&gt;Media types&lt;/h5&gt;
 
+  &lt;p&gt;A &lt;a href=#media-resource&gt;media resource&lt;/a&gt; can be described in terms of its
+  &lt;em&gt;type&lt;/em&gt;, specifically a MIME type, optionally with a &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter. &lt;a href=#refsRFC2046&gt;[RFC2046]&lt;/a&gt; &lt;a href=#refsRFC4281&gt;[RFC4281]&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;Types are usually somewhat incomplete descriptions; for example
+  &quot;&lt;code title=&quot;&quot;&gt;video/mpeg&lt;/code&gt;&quot; doesn't say anything except what
+  the container type is, and even a type like &quot;&lt;code title=&quot;&quot;&gt;video/mp4; codecs=&quot;avc1.42E01E,
+  mp4a.40.2&quot;&lt;/code&gt;&quot; doesn't include information like the actual
+  bitrate (only the maximum bitrate). Thus, given a type, a user agent
+  can often only know whether it &lt;em&gt;might&lt;/em&gt; be able to play
+  media of that type (with varying levels of confidence), or whether
+  it definitely &lt;em&gt;cannot&lt;/em&gt; play media of that type.&lt;/p&gt;
+
+  &lt;p&gt;&lt;dfn id=a-type-that-the-user-agent-knows-it-cannot-render&gt;A type that the user agent knows it cannot render&lt;/dfn&gt; is
+  one that describes a resource that the user agent definitely does
+  not support, for example because it doesn't recognise the container
+  type, or it doesn't support the listed codecs.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-navigator-canplaytype title=dom-navigator-canPlayType&gt;&lt;code&gt;canPlayType(&lt;var title=&quot;&quot;&gt;type&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the string
+  &quot;&lt;code title=&quot;&quot;&gt;no&lt;/code&gt;&quot; if &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; is &lt;a href=#a-type-that-the-user-agent-knows-it-cannot-render&gt;a
+  type that the user agent knows it cannot render&lt;/a&gt;; it must
+  return &quot;&lt;code title=&quot;&quot;&gt;probably&lt;/code&gt;&quot; if the user agent is
+  confident that the type represents a &lt;a href=#media-resource&gt;media resource&lt;/a&gt;
+  that it can render if used in with this &lt;code&gt;&lt;a href=#audio&gt;audio&lt;/a&gt;&lt;/code&gt; or
+  &lt;code&gt;&lt;a href=#video&gt;video&lt;/a&gt;&lt;/code&gt; element; and it must return &quot;&lt;code title=&quot;&quot;&gt;maybe&lt;/code&gt;&quot; otherwise. Implementors are encouraged to
+  return &quot;&lt;code title=&quot;&quot;&gt;maybe&lt;/code&gt;&quot; unless the type can be
+  confidently established as being supported or not. Generally, a user
+  agent should never return &quot;&lt;code title=&quot;&quot;&gt;probably&lt;/code&gt;&quot; if the
+  type doesn't have a &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter.&lt;/p&gt;
+
+  &lt;div class=example&gt;
+
+   &lt;p&gt;This script tests to see if the user agent supports a
+   (fictional) new format to dynamically decide whether to use a
+   &lt;code&gt;&lt;a href=#video&gt;video&lt;/a&gt;&lt;/code&gt; element or a plugin:&lt;/p&gt;
+
+   &lt;pre&gt;&lt;section id=&quot;video&quot;&gt;
+ &lt;p&gt;&lt;a href=&quot;playing-cats.nfv&quot;&gt;Download video&lt;/a&gt;&lt;/p&gt;
+&lt;/section&gt;
+&lt;script&gt;
+ var videoSection = document.getElementById('video');
+ var videoElement = document.createElement('video');
+ var support = videoElement.canPlayType('video/x-new-fictional-format;codecs=&quot;kittens,bunnies&quot;');
+ if (support != &quot;probably&quot; &amp;&amp; &quot;New Fictional Video Plug-in&quot; in navigator.plugins) {
+   // not confident of browser support
+   // but we have a plugin
+   // so use plugin instead
+   videoElement = document.createElement(&quot;embed&quot;);
+ } else if (support == &quot;no&quot;) {
+   // no support from browser and no plugin
+   // do nothing
+   videoElement = null;
+ }
+ if (videoElement) {
+   while (videoSection.hasChildNodes())
+     videoSection.removeChild(videoSection.firstChild);
+   videoElement.setAttribute(&quot;src&quot;, &quot;playing-cats.nfv&quot;);
+   videoSection.appendChild(videoElement);
+ }
+&lt;/script&gt;&lt;/pre&gt;
+
+  &lt;/div&gt;
+
+  &lt;p class=note&gt;To express the type of a &lt;a href=#media-resource&gt;media resource&lt;/a&gt;
+  to allow the user agent to avoid downloading resources it can't
+  render, authors can use the &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; element's &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute.&lt;/p&gt;
+
+
+  &lt;h5 id=network-states&gt;&lt;span class=secno&gt;4.8.10.4 &lt;/span&gt;Network states&lt;/h5&gt;
+
   &lt;p&gt;As &lt;a href=#media-element title=&quot;media element&quot;&gt;media elements&lt;/a&gt; interact
   with the network, their current network activity is represented by
   the &lt;dfn id=dom-media-networkstate title=dom-media-networkState&gt;&lt;code&gt;networkState&lt;/code&gt;&lt;/dfn&gt;
@@ -17157,7 +17219,7 @@
   reach the &lt;code title=dom-media-NETWORK_LOADED&gt;&lt;a href=#dom-media-network_loaded&gt;NETWORK_LOADED&lt;/a&gt;&lt;/code&gt; state.&lt;/p&gt;
 
 
-  &lt;h5 id=loading-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.4 &lt;/span&gt;Loading the media resource&lt;/h5&gt;
+  &lt;h5 id=loading-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.5 &lt;/span&gt;Loading the media resource&lt;/h5&gt;
 
   &lt;p&gt;All &lt;a href=#media-element title=&quot;media element&quot;&gt;media elements&lt;/a&gt; have a
   &lt;dfn id=begun-flag&gt;begun flag&lt;/dfn&gt;, which must begin in the false state, and an
@@ -17247,6 +17309,10 @@
 
    &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Set the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to true and &lt;a href=#queue-a-task&gt;queue a
+   task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-loadstart&gt;&lt;a href=#event-loadstart&gt;loadstart&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
+   element&lt;/a&gt;.&lt;/li&gt;
+
    &lt;li&gt;
 
     &lt;p&gt;The method must return, but these steps must continue.&lt;/p&gt;
@@ -17260,10 +17326,6 @@
    &lt;!-- SYNCHRONOUS / ASYNCHRONOUS BOUNDARY FOR EVENT DISPATCH --&gt;
 
 
-   &lt;li&gt;&lt;p&gt;Set the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to true and &lt;a href=#queue-a-task&gt;queue a
-   task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-loadstart&gt;&lt;a href=#event-loadstart&gt;loadstart&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
-   element&lt;/a&gt;.&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;&lt;i&gt;Candidate loop&lt;/i&gt;: For each item in &lt;var title=&quot;&quot;&gt;candidates&lt;/var&gt;, if any, and in the same order as they
@@ -17598,7 +17660,7 @@
 
 
 
-  &lt;h5 id=offsets-into-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.5 &lt;/span&gt;Offsets into the media resource&lt;/h5&gt;
+  &lt;h5 id=offsets-into-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.6 &lt;/span&gt;Offsets into the media resource&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-media-duration title=dom-media-duration&gt;&lt;code&gt;duration&lt;/code&gt;&lt;/dfn&gt;
   attribute must return the length of the &lt;a href=#media-resource&gt;media resource&lt;/a&gt;,
@@ -17649,7 +17711,7 @@
 
 
 
-  &lt;h5 id=the-ready-states&gt;&lt;span class=secno&gt;4.8.10.6 &lt;/span&gt;The ready states&lt;/h5&gt;
+  &lt;h5 id=the-ready-states&gt;&lt;span class=secno&gt;4.8.10.7 &lt;/span&gt;The ready states&lt;/h5&gt;
 
   &lt;p&gt;&lt;a href=#media-element title=&quot;media element&quot;&gt;Media elements&lt;/a&gt; have a
   &lt;i&gt;ready state&lt;/i&gt;, which describes to what degree they are ready
@@ -17807,7 +17869,7 @@
 
 
 
-  &lt;h5 id=cue-ranges&gt;&lt;span class=secno&gt;4.8.10.7 &lt;/span&gt;Cue ranges&lt;/h5&gt;
+  &lt;h5 id=cue-ranges&gt;&lt;span class=secno&gt;4.8.10.8 &lt;/span&gt;Cue ranges&lt;/h5&gt;
 
   &lt;p&gt;&lt;a href=#media-element title=&quot;media element&quot;&gt;Media elements&lt;/a&gt; have a set of
   &lt;dfn id=cue-range title=&quot;cue range&quot;&gt;cue ranges&lt;/dfn&gt;. Each cue range is made up
@@ -17856,7 +17918,7 @@
 
 
 
-  &lt;h5 id=playing-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.8 &lt;/span&gt;Playing the media resource&lt;/h5&gt;
+  &lt;h5 id=playing-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.9 &lt;/span&gt;Playing the media resource&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-media-paused title=dom-media-paused&gt;&lt;code&gt;paused&lt;/code&gt;&lt;/dfn&gt;
   attribute represents whether the &lt;a href=#media-element&gt;media element&lt;/a&gt; is
@@ -18019,7 +18081,7 @@
 
    &lt;li&gt;&lt;p&gt;If the fourth step above changed the value of &lt;code title=dom-media-paused&gt;&lt;a href=#dom-media-paused&gt;paused&lt;/a&gt;&lt;/code&gt;, the user agent must
    &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt;
-   called &lt;code title=event-pause&gt;&lt;a href=#event-pause&gt;play&lt;/a&gt;&lt;/code&gt; at the
+   called &lt;code title=event-play&gt;&lt;a href=#event-play&gt;play&lt;/a&gt;&lt;/code&gt; at the
    element.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;hr&gt;&lt;p&gt;When the &lt;dfn id=dom-media-pause title=dom-media-pause&gt;&lt;code&gt;pause()&lt;/code&gt;&lt;/dfn&gt;
@@ -18163,7 +18225,7 @@
 
 
 
-  &lt;h5 id=seeking&gt;&lt;span class=secno&gt;4.8.10.9 &lt;/span&gt;Seeking&lt;/h5&gt;
+  &lt;h5 id=seeking&gt;&lt;span class=secno&gt;4.8.10.10 &lt;/span&gt;Seeking&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-media-seeking title=dom-media-seeking&gt;&lt;code&gt;seeking&lt;/code&gt;&lt;/dfn&gt;
   attribute must initially have the value false.&lt;/p&gt;
@@ -18258,7 +18320,7 @@
 
 
 
-  &lt;h5 id=user-interface&gt;&lt;span class=secno&gt;4.8.10.10 &lt;/span&gt;User interface&lt;/h5&gt;
+  &lt;h5 id=user-interface&gt;&lt;span class=secno&gt;4.8.10.11 &lt;/span&gt;User interface&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=attr-media-controls title=attr-media-controls&gt;&lt;code&gt;controls&lt;/code&gt;&lt;/dfn&gt;
   attribute is a &lt;a href=#boolean-attribute&gt;boolean attribute&lt;/a&gt;. If the attribute is
@@ -18327,7 +18389,7 @@
 
 
 
-  &lt;h5 id=time-ranges&gt;&lt;span class=secno&gt;4.8.10.11 &lt;/span&gt;Time ranges&lt;/h5&gt;
+  &lt;h5 id=time-ranges&gt;&lt;span class=secno&gt;4.8.10.12 &lt;/span&gt;Time ranges&lt;/h5&gt;
 
   &lt;p&gt;Objects implementing the &lt;code&gt;&lt;a href=#timeranges&gt;TimeRanges&lt;/a&gt;&lt;/code&gt; interface
   represent a list of ranges (periods) of time.&lt;/p&gt;
@@ -18374,7 +18436,7 @@
 
 
 
-  &lt;h5 id=byte-ranges&gt;&lt;span class=secno&gt;4.8.10.12 &lt;/span&gt;Byte ranges&lt;/h5&gt;
+  &lt;h5 id=byte-ranges&gt;&lt;span class=secno&gt;4.8.10.13 &lt;/span&gt;Byte ranges&lt;/h5&gt;
 
   &lt;p&gt;Objects implementing the &lt;code&gt;&lt;a href=#byteranges&gt;ByteRanges&lt;/a&gt;&lt;/code&gt; interface
   represent a list of ranges of bytes.&lt;/p&gt;
@@ -18420,7 +18482,7 @@
 
 
 
-  &lt;h5 id=mediaevents&gt;&lt;span class=secno&gt;4.8.10.13 &lt;/span&gt;Event summary&lt;/h5&gt;
+  &lt;h5 id=mediaevents&gt;&lt;span class=secno&gt;4.8.10.14 &lt;/span&gt;Event summary&lt;/h5&gt;
 
   &lt;p&gt;The following events fire on &lt;a href=#media-element title=&quot;media element&quot;&gt;media
   elements&lt;/a&gt; as part of the processing model described above:&lt;/p&gt;
@@ -18524,7 +18586,7 @@
      &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
      &lt;td&gt;Either the &lt;code title=dom-media-volume&gt;&lt;a href=#dom-media-volume&gt;volume&lt;/a&gt;&lt;/code&gt; attribute or the &lt;code title=dom-media-muted&gt;&lt;a href=#dom-media-muted&gt;muted&lt;/a&gt;&lt;/code&gt; attribute has changed. Fired after the relevant attribute's setter has returned.
      &lt;td&gt;
-  &lt;/table&gt;&lt;h5 id=security-and-privacy-considerations&gt;&lt;span class=secno&gt;4.8.10.14 &lt;/span&gt;Security and privacy considerations&lt;/h5&gt;
+  &lt;/table&gt;&lt;h5 id=security-and-privacy-considerations&gt;&lt;span class=secno&gt;4.8.10.15 &lt;/span&gt;Security and privacy considerations&lt;/h5&gt;
 
   &lt;p class=XXX&gt;Talk about making sure interactive media files
   (e.g. SVG) don't have access to the container DOM (XSS potential);
@@ -33878,20 +33940,20 @@
   readonly attribute boolean &lt;a href=#dom-navigator-online title=dom-navigator-onLine&gt;onLine&lt;/a&gt;;
 };
 
-[NoInterfaceObject] interface &lt;dfn id=navigatorbrowsingcontextabilities&gt;NavigatorBrowsingContextAbilities&lt;/dfn&gt; {
+[NoInterfaceObject] interface &lt;dfn id=navigatorabilities&gt;NavigatorAbilities&lt;/dfn&gt; {
   // content handler registration
   void &lt;a href=#dom-navigator-registerprotocolhandler title=dom-navigator-registerProtocolHandler&gt;registerProtocolHandler&lt;/a&gt;(in DOMString protocol, in DOMString url, in DOMString title);
   void &lt;a href=#dom-navigator-registercontenthandler title=dom-navigator-registerContentHandler&gt;registerContentHandler&lt;/a&gt;(in DOMString mimeType, in DOMString url, in DOMString title);
-&lt;!--  XXX cookieEnabled geolocator javaEnabled mozIsLocallyAvailable plugins preference
-  readonly attribute &lt;span&gt;MimeTypeArray&lt;/span&gt; &lt;span title=&quot;dom-navigator-mimeTypes&quot;&gt;mimeTypes&lt;/span&gt;;--&gt;
-  // abilities
-  short &lt;a href=#dom-navigator-canplaytype title=dom-navigator-canPlayType&gt;canPlayType&lt;/a&gt;(in DOMString type);
-};&lt;/pre&gt;
+&lt;!--  XXX cookieEnabled geolocator javaEnabled mozIsLocallyAvailable preference
+  readonly attribute &lt;span&gt;MimeTypeArray&lt;/span&gt; &lt;span title=&quot;dom-navigator-mimeTypes&quot;&gt;mimeTypes&lt;/span&gt;;
+  readonly attribute &lt;span&gt;PluginArray&lt;/span&gt; &lt;span title=&quot;dom-navigator-plugins&quot;&gt;plugins&lt;/span&gt;;
+  (the latter is used in a &lt;video&gt; element demo now)
+--&gt;};&lt;/pre&gt;
 
   &lt;p&gt;Objects implementing the &lt;code&gt;&lt;a href=#navigator&gt;Navigator&lt;/a&gt;&lt;/code&gt; interface must
   also implement the &lt;a href=#navigatorid&gt;NavigatorID&lt;/a&gt;,
   &lt;a href=#navigatoronline&gt;NavigatorOnLine&lt;/a&gt;, and
-  &lt;a href=#navigatorbrowsingcontextabilities&gt;NavigatorBrowsingContextAbilities&lt;/a&gt; interfaces. (These
+  &lt;a href=#navigatorabilities&gt;NavigatorAbilities&lt;/a&gt; interfaces. (These
   interfaces are defined separately so that other specifications can
   re-use parts of the &lt;code&gt;&lt;a href=#navigator&gt;Navigator&lt;/a&gt;&lt;/code&gt; interface.)&lt;/p&gt;
 
@@ -34264,18 +34326,6 @@
 
 
 
-
-  &lt;h4 id=client-abilities&gt;&lt;span class=secno&gt;5.6.3 &lt;/span&gt;Client abilities&lt;/h4&gt;
-
-  &lt;p&gt;The &lt;dfn id=dom-navigator-canplaytype title=dom-navigator-canPlayType&gt;&lt;code&gt;canPlayType(&lt;var title=&quot;&quot;&gt;type&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return 1 if &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; is a MIME type that the user agent is confident
-  represents a &lt;a href=#media-resource&gt;media resource&lt;/a&gt; that it can render if used
-  in a &lt;code&gt;&lt;a href=#audio&gt;audio&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a href=#video&gt;video&lt;/a&gt;&lt;/code&gt; element, 0 if it
-  cannot determine whether it could do so, and &minus;1 if it is
-  confident that it would not be able to render resources of that
-  type.&lt;/p&gt;
-
-
-
   &lt;h3 id=offline&gt;&lt;span class=secno&gt;5.7 &lt;/span&gt;Offline Web applications&lt;/h3&gt;
 
   &lt;h4 id=introduction-0&gt;&lt;span class=secno&gt;5.7.1 &lt;/span&gt;Introduction&lt;/h4&gt;

Modified: source
===================================================================
--- source	2008-11-14 06:50:23 UTC (rev 2403)
+++ source	2008-11-15 19:28:46 UTC (rev 2404)
@@ -17906,10 +17906,10 @@
   &lt;p&gt;The &lt;dfn title=&quot;attr-source-type&quot;&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;
   attribute gives the type of the &lt;span&gt;media resource&lt;/span&gt;, to help
   the user agent determine if it can play this &lt;span&gt;media
-  resource&lt;/span&gt; before fetching it. Its value must be a MIME
-  type. The &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter may be specified
-  and might be necessary to specify exactly how the resource is
-  encoded. &lt;a href=&quot;#refsRFC2046&quot;&gt;[RFC2046]&lt;/a&gt; &lt;a
+  resource&lt;/span&gt; before fetching it. If specified, its value must be
+  a MIME type. The &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter may be
+  specified and might be necessary to specify exactly how the resource
+  is encoded. &lt;a href=&quot;#refsRFC2046&quot;&gt;[RFC2046]&lt;/a&gt; &lt;a
   href=&quot;#refsRFC4281&quot;&gt;[RFC4281]&lt;/a&gt;&lt;/p&gt;
 
   &lt;div class=&quot;example&quot;&gt;
@@ -18014,11 +18014,6 @@
   it. Its value must be a valid &lt;a href=&quot;#mq&quot;&gt;media query&lt;/a&gt;. &lt;a
   href=&quot;#refsMQ&quot;&gt;[MQ]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;Either the &lt;code title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute,
-  the &lt;code title=&quot;attr-source-media&quot;&gt;media&lt;/code&gt; attribute or both,
-  must be specified, unless this is the last &lt;code&gt;source&lt;/code&gt;
-  element child of the parent element.&lt;/p&gt;
-
   &lt;p&gt;The &lt;dfn
   title=&quot;attr-source-pixelratio&quot;&gt;&lt;code&gt;pixelratio&lt;/code&gt;&lt;/dfn&gt;
   attribute allows the author to specify the pixel ratio of anamorphic
@@ -18090,6 +18085,7 @@
   readonly attribute &lt;span&gt;ByteRanges&lt;/span&gt; &lt;span title=&quot;dom-media-bufferedBytes&quot;&gt;bufferedBytes&lt;/span&gt;;
   readonly attribute unsigned long &lt;span title=&quot;dom-media-totalBytes&quot;&gt;totalBytes&lt;/span&gt;;
   void &lt;span title=&quot;dom-media-load&quot;&gt;load&lt;/span&gt;();
+  DOMString &lt;span title=&quot;dom-navigator-canPlayType&quot;&gt;canPlayType&lt;/span&gt;(in DOMString type);
 
   // ready state
   const unsigned short &lt;span title=&quot;dom-media-HAVE_NOTHING&quot;&gt;HAVE_NOTHING&lt;/span&gt; = 0;
@@ -18184,11 +18180,7 @@
   task&quot;&gt;queued&lt;/span&gt; in this section and its subsections is the
   &lt;span&gt;media element event task source&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code title=&quot;dom-navigator-canPlayType&quot;&gt;canPlayType()&lt;/code&gt;
-  method can be used to probe the user agent to determine what types
-  are supported.&lt;/p&gt;
 
-
   &lt;h5&gt;Error codes&lt;/h5&gt;
 
   &lt;p&gt;All &lt;span title=&quot;media element&quot;&gt;media elements&lt;/span&gt; have an
@@ -18341,25 +18333,26 @@
     &lt;ul&gt;
 
      &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code
-     title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute&lt;/li&gt;
+     title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute.&lt;/li&gt;
 
      &lt;li&gt;&lt;span title=&quot;resolve a url&quot;&gt;Resolving&lt;/span&gt; the
      &lt;span&gt;URL&lt;/span&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
      element's &lt;code title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute does
-     not fail&lt;/li&gt;
+     not fail.&lt;/li&gt;
 
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code
-     title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute and that
-     attribute's value, when parsed as a MIME type (including any
-     codecs described by the &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter),
-     does not represent a type that the user agent knows it cannot
-     render &lt;a href=&quot;#refsRFC2046&quot;&gt;[RFC2046]&lt;/a&gt; &lt;a
-     href=&quot;#refsRFC4281&quot;&gt;[RFC4281]&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code
+     title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute, or its &lt;code
+     title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute's value, when
+     parsed as a MIME type (including any codecs described by the
+     &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter), does not represent
+     &lt;span&gt;a type that the user agent knows it cannot
+     render&lt;/span&gt;.&lt;/li&gt;
 
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code
-     title=&quot;attr-source-media&quot;&gt;media&lt;/code&gt; attribute and that
-     attribute's value, when processed according to the rules for &lt;a
-     href=&quot;#mq&quot;&gt;media queries&lt;/a&gt;, matches the current environment &lt;a
+     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code
+     title=&quot;attr-source-media&quot;&gt;media&lt;/code&gt; attribute, or its &lt;code
+     title=&quot;attr-source-media&quot;&gt;media&lt;/code&gt; attribute's value, when
+     processed according to the rules for &lt;a href=&quot;#mq&quot;&gt;media
+     queries&lt;/a&gt;, matches the current environment. &lt;a
      href=&quot;#refsMQ&quot;&gt;[MQ]&lt;/a&gt;&lt;/li&gt;
 
     &lt;/ul&gt;
@@ -18388,6 +18381,82 @@
 
 
 
+  &lt;h5&gt;Media types&lt;/h5&gt;
+
+  &lt;p&gt;A &lt;span&gt;media resource&lt;/span&gt; can be described in terms of its
+  &lt;em&gt;type&lt;/em&gt;, specifically a MIME type, optionally with a &lt;code
+  title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter. &lt;a
+  href=&quot;#refsRFC2046&quot;&gt;[RFC2046]&lt;/a&gt; &lt;a
+  href=&quot;#refsRFC4281&quot;&gt;[RFC4281]&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;Types are usually somewhat incomplete descriptions; for example
+  &quot;&lt;code title=&quot;&quot;&gt;video/mpeg&lt;/code&gt;&quot; doesn't say anything except what
+  the container type is, and even a type like &quot;&lt;code
+  title=&quot;&quot;&gt;video/mp4; codecs=&quot;avc1.42E01E,
+  mp4a.40.2&quot;&lt;/code&gt;&quot; doesn't include information like the actual
+  bitrate (only the maximum bitrate). Thus, given a type, a user agent
+  can often only know whether it &lt;em&gt;might&lt;/em&gt; be able to play
+  media of that type (with varying levels of confidence), or whether
+  it definitely &lt;em&gt;cannot&lt;/em&gt; play media of that type.&lt;/p&gt;
+
+  &lt;p&gt;&lt;dfn&gt;A type that the user agent knows it cannot render&lt;/dfn&gt; is
+  one that describes a resource that the user agent definitely does
+  not support, for example because it doesn't recognise the container
+  type, or it doesn't support the listed codecs.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;dom-navigator-canPlayType&quot;&gt;&lt;code&gt;canPlayType(&lt;var
+  title=&quot;&quot;&gt;type&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return the string
+  &quot;&lt;code title=&quot;&quot;&gt;no&lt;/code&gt;&quot; if &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; is &lt;span&gt;a
+  type that the user agent knows it cannot render&lt;/span&gt;; it must
+  return &quot;&lt;code title=&quot;&quot;&gt;probably&lt;/code&gt;&quot; if the user agent is
+  confident that the type represents a &lt;span&gt;media resource&lt;/span&gt;
+  that it can render if used in with this &lt;code&gt;audio&lt;/code&gt; or
+  &lt;code&gt;video&lt;/code&gt; element; and it must return &quot;&lt;code
+  title=&quot;&quot;&gt;maybe&lt;/code&gt;&quot; otherwise. Implementors are encouraged to
+  return &quot;&lt;code title=&quot;&quot;&gt;maybe&lt;/code&gt;&quot; unless the type can be
+  confidently established as being supported or not. Generally, a user
+  agent should never return &quot;&lt;code title=&quot;&quot;&gt;probably&lt;/code&gt;&quot; if the
+  type doesn't have a &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter.&lt;/p&gt;
+
+  &lt;div class=&quot;example&quot;&gt;
+
+   &lt;p&gt;This script tests to see if the user agent supports a
+   (fictional) new format to dynamically decide whether to use a
+   &lt;code&gt;video&lt;/code&gt; element or a plugin:&lt;/p&gt;
+
+   &lt;pre&gt;&lt;section id=&quot;video&quot;&gt;
+ &lt;p&gt;&lt;a href=&quot;playing-cats.nfv&quot;&gt;Download video&lt;/a&gt;&lt;/p&gt;
+&lt;/section&gt;
+&lt;script&gt;
+ var videoSection = document.getElementById('video');
+ var videoElement = document.createElement('video');
+ var support = videoElement.canPlayType('video/x-new-fictional-format;codecs=&quot;kittens,bunnies&quot;');
+ if (support != &quot;probably&quot; &amp;&amp; &quot;New Fictional Video Plug-in&quot; in navigator.plugins) {
+   // not confident of browser support
+   // but we have a plugin
+   // so use plugin instead
+   videoElement = document.createElement(&quot;embed&quot;);
+ } else if (support == &quot;no&quot;) {
+   // no support from browser and no plugin
+   // do nothing
+   videoElement = null;
+ }
+ if (videoElement) {
+   while (videoSection.hasChildNodes())
+     videoSection.removeChild(videoSection.firstChild);
+   videoElement.setAttribute(&quot;src&quot;, &quot;playing-cats.nfv&quot;);
+   videoSection.appendChild(videoElement);
+ }
+&lt;/script&gt;&lt;/pre&gt;
+
+  &lt;/div&gt;
+
+  &lt;p class=&quot;note&quot;&gt;To express the type of a &lt;span&gt;media resource&lt;/span&gt;
+  to allow the user agent to avoid downloading resources it can't
+  render, authors can use the &lt;code&gt;source&lt;/code&gt; element's &lt;code
+  title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute.&lt;/p&gt;
+
+
   &lt;h5&gt;Network states&lt;/h5&gt;
 
   &lt;p&gt;As &lt;span title=&quot;media element&quot;&gt;media elements&lt;/span&gt; interact
@@ -18541,6 +18610,11 @@
    title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; to &lt;code
    title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Set the &lt;span&gt;begun flag&lt;/span&gt; to true and &lt;span&gt;queue a
+   task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
+   title=&quot;event-loadstart&quot;&gt;loadstart&lt;/code&gt; at the &lt;span&gt;media
+   element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;
 
     &lt;p&gt;The method must return, but these steps must continue.&lt;/p&gt;
@@ -18554,11 +18628,6 @@
    &lt;!-- SYNCHRONOUS / ASYNCHRONOUS BOUNDARY FOR EVENT DISPATCH --&gt;
 
 
-   &lt;li&gt;&lt;p&gt;Set the &lt;span&gt;begun flag&lt;/span&gt; to true and &lt;span&gt;queue a
-   task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
-   title=&quot;event-loadstart&quot;&gt;loadstart&lt;/code&gt; at the &lt;span&gt;media
-   element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;&lt;i&gt;Candidate loop&lt;/i&gt;: For each item in &lt;var
@@ -19501,7 +19570,7 @@
    &lt;li&gt;&lt;p&gt;If the fourth step above changed the value of &lt;code
    title=&quot;dom-media-paused&quot;&gt;paused&lt;/code&gt;, the user agent must
    &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt;
-   called &lt;code title=&quot;event-pause&quot;&gt;play&lt;/code&gt; at the
+   called &lt;code title=&quot;event-play&quot;&gt;play&lt;/code&gt; at the
    element.&lt;/p&gt;&lt;/li&gt;
 
   &lt;/ol&gt;
@@ -38529,20 +38598,20 @@
   readonly attribute boolean &lt;span title=&quot;dom-navigator-onLine&quot;&gt;onLine&lt;/span&gt;;
 };
 
-[NoInterfaceObject] interface &lt;dfn&gt;NavigatorBrowsingContextAbilities&lt;/dfn&gt; {
+[NoInterfaceObject] interface &lt;dfn&gt;NavigatorAbilities&lt;/dfn&gt; {
   // content handler registration
   void &lt;span title=&quot;dom-navigator-registerProtocolHandler&quot;&gt;registerProtocolHandler&lt;/span&gt;(in DOMString protocol, in DOMString url, in DOMString title);
   void &lt;span title=&quot;dom-navigator-registerContentHandler&quot;&gt;registerContentHandler&lt;/span&gt;(in DOMString mimeType, in DOMString url, in DOMString title);
-&lt;!--  XXX cookieEnabled geolocator javaEnabled mozIsLocallyAvailable plugins preference
-  readonly attribute &lt;span&gt;MimeTypeArray&lt;/span&gt; &lt;span title=&quot;dom-navigator-mimeTypes&quot;&gt;mimeTypes&lt;/span&gt;;--&gt;
-  // abilities
-  short &lt;span title=&quot;dom-navigator-canPlayType&quot;&gt;canPlayType&lt;/span&gt;(in DOMString type);
-};&lt;/pre&gt;
+&lt;!--  XXX cookieEnabled geolocator javaEnabled mozIsLocallyAvailable preference
+  readonly attribute &lt;span&gt;MimeTypeArray&lt;/span&gt; &lt;span title=&quot;dom-navigator-mimeTypes&quot;&gt;mimeTypes&lt;/span&gt;;
+  readonly attribute &lt;span&gt;PluginArray&lt;/span&gt; &lt;span title=&quot;dom-navigator-plugins&quot;&gt;plugins&lt;/span&gt;;
+  (the latter is used in a &lt;video&gt; element demo now)
+--&gt;};&lt;/pre&gt;
 
   &lt;p&gt;Objects implementing the &lt;code&gt;Navigator&lt;/code&gt; interface must
   also implement the &lt;span&gt;NavigatorID&lt;/span&gt;,
   &lt;span&gt;NavigatorOnLine&lt;/span&gt;, and
-  &lt;span&gt;NavigatorBrowsingContextAbilities&lt;/span&gt; interfaces. (These
+  &lt;span&gt;NavigatorAbilities&lt;/span&gt; interfaces. (These
   interfaces are defined separately so that other specifications can
   re-use parts of the &lt;code&gt;Navigator&lt;/code&gt; interface.)&lt;/p&gt;
 
@@ -38946,20 +39015,6 @@
 
 
 
-
-  &lt;h4&gt;Client abilities&lt;/h4&gt;
-
-  &lt;p&gt;The &lt;dfn title=&quot;dom-navigator-canPlayType&quot;&gt;&lt;code&gt;canPlayType(&lt;var
-  title=&quot;&quot;&gt;type&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must return 1 if &lt;var
-  title=&quot;&quot;&gt;type&lt;/var&gt; is a MIME type that the user agent is confident
-  represents a &lt;span&gt;media resource&lt;/span&gt; that it can render if used
-  in a &lt;code&gt;audio&lt;/code&gt; or &lt;code&gt;video&lt;/code&gt; element, 0 if it
-  cannot determine whether it could do so, and &amp;#x2212;1 if it is
-  confident that it would not be able to render resources of that
-  type.&lt;/p&gt;
-
-
-
   &lt;h3 id=&quot;offline&quot;&gt;Offline Web applications&lt;/h3&gt;
 
   &lt;h4&gt;Introduction&lt;/h4&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009287.html">[html5] r2403 - [gow] (2) Revamp the load() algorithm so that it	tries each possible file in turn.
</A></li>
	<LI>Next message: <A HREF="009289.html">[html5] r2405 - [] (0) Remove bufferedBytes and totalBytes.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9288">[ date ]</a>
              <a href="thread.html#9288">[ thread ]</a>
              <a href="subject.html#9288">[ subject ]</a>
              <a href="author.html#9288">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
