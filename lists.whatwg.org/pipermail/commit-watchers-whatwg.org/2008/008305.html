<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r1403 - /
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1403%20-%20/&In-Reply-To=%3C20080405111454.25B9A139FD5%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008304.html">
   <LINK REL="Next"  HREF="008306.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r1403 - /</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1403%20-%20/&In-Reply-To=%3C20080405111454.25B9A139FD5%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r1403 - /">whatwg at whatwg.org
       </A><BR>
    <I>Sat Apr  5 04:14:54 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008304.html">[html5] r1402 - /
</A></li>
        <LI>Next message: <A HREF="008306.html">[html5] r1404 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8305">[ date ]</a>
              <a href="thread.html#8305">[ thread ]</a>
              <a href="subject.html#8305">[ subject ]</a>
              <a href="author.html#8305">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-04-05 04:14:50 -0700 (Sat, 05 Apr 2008)
New Revision: 1403

Modified:
   index
   source
Log:
[e] (0) Move some of the tree construction state to before the tokeniser.

Modified: index
===================================================================
--- index	2008-04-05 10:50:19 UTC (rev 1402)
+++ index	2008-04-05 11:14:50 UTC (rev 1403)
@@ -1623,98 +1623,101 @@
           the encoding while parsing&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#tokenisation&quot;&gt;&lt;span class=secno&gt;8.2.3
+       &lt;li&gt;&lt;a href=&quot;#parse&quot;&gt;&lt;span class=secno&gt;8.2.3 &lt;/span&gt;Parse state&lt;/a&gt;
+        &lt;ul class=toc&gt;
+         &lt;li&gt;&lt;a href=&quot;#the-insertion&quot;&gt;&lt;span class=secno&gt;8.2.3.1. &lt;/span&gt;The
+          insertion mode&lt;/a&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#the-stack&quot;&gt;&lt;span class=secno&gt;8.2.3.2. &lt;/span&gt;The stack
+          of open elements&lt;/a&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#the-list&quot;&gt;&lt;span class=secno&gt;8.2.3.3. &lt;/span&gt;The list
+          of active formatting elements&lt;/a&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#the-element&quot;&gt;&lt;span class=secno&gt;8.2.3.4. &lt;/span&gt;The
+          element pointers&lt;/a&gt;
+        &lt;/ul&gt;
+
+       &lt;li&gt;&lt;a href=&quot;#tokenisation&quot;&gt;&lt;span class=secno&gt;8.2.4
         &lt;/span&gt;Tokenisation&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#tokenising&quot;&gt;&lt;span class=secno&gt;8.2.3.1.
+         &lt;li&gt;&lt;a href=&quot;#tokenising&quot;&gt;&lt;span class=secno&gt;8.2.4.1.
           &lt;/span&gt;Tokenising entities&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#tree-construction&quot;&gt;&lt;span class=secno&gt;8.2.4 &lt;/span&gt;Tree
+       &lt;li&gt;&lt;a href=&quot;#tree-construction&quot;&gt;&lt;span class=secno&gt;8.2.5 &lt;/span&gt;Tree
         construction&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#the-stack&quot;&gt;&lt;span class=secno&gt;8.2.4.1. &lt;/span&gt;The stack
-          of open elements&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#the-list&quot;&gt;&lt;span class=secno&gt;8.2.4.2. &lt;/span&gt;The list
-          of active formatting elements&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#creating&quot;&gt;&lt;span class=secno&gt;8.2.4.3. &lt;/span&gt;Creating
+         &lt;li&gt;&lt;a href=&quot;#creating&quot;&gt;&lt;span class=secno&gt;8.2.5.1. &lt;/span&gt;Creating
           and inserting HTML elements&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#closing&quot;&gt;&lt;span class=secno&gt;8.2.4.4. &lt;/span&gt;Closing
+         &lt;li&gt;&lt;a href=&quot;#closing&quot;&gt;&lt;span class=secno&gt;8.2.5.2. &lt;/span&gt;Closing
           elements that have implied end tags&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#the-element&quot;&gt;&lt;span class=secno&gt;8.2.4.5. &lt;/span&gt;The
-          element pointers&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#resetting&quot;&gt;&lt;span class=secno&gt;8.2.4.6. &lt;/span&gt;Resetting
-          the insertion mode&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#the-initial&quot;&gt;&lt;span class=secno&gt;8.2.4.7. &lt;/span&gt;The
+         &lt;li&gt;&lt;a href=&quot;#the-initial&quot;&gt;&lt;span class=secno&gt;8.2.5.3. &lt;/span&gt;The
           &quot;initial&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#the-before&quot;&gt;&lt;span class=secno&gt;8.2.4.8. &lt;/span&gt;The
+         &lt;li&gt;&lt;a href=&quot;#the-before&quot;&gt;&lt;span class=secno&gt;8.2.5.4. &lt;/span&gt;The
           &quot;before html&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#the-before0&quot;&gt;&lt;span class=secno&gt;8.2.4.9. &lt;/span&gt;The
+         &lt;li&gt;&lt;a href=&quot;#the-before0&quot;&gt;&lt;span class=secno&gt;8.2.5.5. &lt;/span&gt;The
           &quot;before head&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-inhead&quot;&gt;&lt;span class=secno&gt;8.2.4.10.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-inhead&quot;&gt;&lt;span class=secno&gt;8.2.5.6.
           &lt;/span&gt;The &quot;in head&quot; insertion mode&lt;/a&gt;
 
          &lt;li&gt;&lt;a href=&quot;#parsing-main-inheadnoscript&quot;&gt;&lt;span
-          class=secno&gt;8.2.4.11. &lt;/span&gt;The &quot;in head noscript&quot; insertion
+          class=secno&gt;8.2.5.7. &lt;/span&gt;The &quot;in head noscript&quot; insertion
           mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#the-after&quot;&gt;&lt;span class=secno&gt;8.2.4.12. &lt;/span&gt;The
+         &lt;li&gt;&lt;a href=&quot;#the-after&quot;&gt;&lt;span class=secno&gt;8.2.5.8. &lt;/span&gt;The
           &quot;after head&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-inbody&quot;&gt;&lt;span class=secno&gt;8.2.4.13.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-inbody&quot;&gt;&lt;span class=secno&gt;8.2.5.9.
           &lt;/span&gt;The &quot;in body&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-intable&quot;&gt;&lt;span class=secno&gt;8.2.4.14.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-intable&quot;&gt;&lt;span class=secno&gt;8.2.5.10.
           &lt;/span&gt;The &quot;in table&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-incaption&quot;&gt;&lt;span class=secno&gt;8.2.4.15.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-incaption&quot;&gt;&lt;span class=secno&gt;8.2.5.11.
           &lt;/span&gt;The &quot;in caption&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-incolgroup&quot;&gt;&lt;span class=secno&gt;8.2.4.16.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-incolgroup&quot;&gt;&lt;span class=secno&gt;8.2.5.12.
           &lt;/span&gt;The &quot;in column group&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-intbody&quot;&gt;&lt;span class=secno&gt;8.2.4.17.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-intbody&quot;&gt;&lt;span class=secno&gt;8.2.5.13.
           &lt;/span&gt;The &quot;in table body&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-intr&quot;&gt;&lt;span class=secno&gt;8.2.4.18.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-intr&quot;&gt;&lt;span class=secno&gt;8.2.5.14.
           &lt;/span&gt;The &quot;in row&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-intd&quot;&gt;&lt;span class=secno&gt;8.2.4.19.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-intd&quot;&gt;&lt;span class=secno&gt;8.2.5.15.
           &lt;/span&gt;The &quot;in cell&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-inselect&quot;&gt;&lt;span class=secno&gt;8.2.4.20.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-inselect&quot;&gt;&lt;span class=secno&gt;8.2.5.16.
           &lt;/span&gt;The &quot;in select&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-inselect&quot;&gt;&lt;span class=secno&gt;8.2.4.21.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-inselect&quot;&gt;&lt;span class=secno&gt;8.2.5.17.
           &lt;/span&gt;The &quot;in select in table&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-afterbody&quot;&gt;&lt;span class=secno&gt;8.2.4.22.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-afterbody&quot;&gt;&lt;span class=secno&gt;8.2.5.18.
           &lt;/span&gt;The &quot;after body&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#parsing-main-inframeset&quot;&gt;&lt;span class=secno&gt;8.2.4.23.
+         &lt;li&gt;&lt;a href=&quot;#parsing-main-inframeset&quot;&gt;&lt;span class=secno&gt;8.2.5.19.
           &lt;/span&gt;The &quot;in frameset&quot; insertion mode&lt;/a&gt;
 
          &lt;li&gt;&lt;a href=&quot;#parsing-main-afterframeset&quot;&gt;&lt;span
-          class=secno&gt;8.2.4.24. &lt;/span&gt;The &quot;after frameset&quot; insertion
+          class=secno&gt;8.2.5.20. &lt;/span&gt;The &quot;after frameset&quot; insertion
           mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#the-after0&quot;&gt;&lt;span class=secno&gt;8.2.4.25. &lt;/span&gt;The
+         &lt;li&gt;&lt;a href=&quot;#the-after0&quot;&gt;&lt;span class=secno&gt;8.2.5.21. &lt;/span&gt;The
           &quot;after after body&quot; insertion mode&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#the-after1&quot;&gt;&lt;span class=secno&gt;8.2.4.26. &lt;/span&gt;The
+         &lt;li&gt;&lt;a href=&quot;#the-after1&quot;&gt;&lt;span class=secno&gt;8.2.5.22. &lt;/span&gt;The
           &quot;after after frameset&quot; insertion mode&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-end&quot;&gt;&lt;span class=secno&gt;8.2.5 &lt;/span&gt;The end&lt;/a&gt;
+       &lt;li&gt;&lt;a href=&quot;#the-end&quot;&gt;&lt;span class=secno&gt;8.2.6 &lt;/span&gt;The end&lt;/a&gt;
       &lt;/ul&gt;
 
      &lt;li&gt;&lt;a href=&quot;#namespaces&quot;&gt;&lt;span class=secno&gt;8.3 &lt;/span&gt;Namespaces&lt;/a&gt;
@@ -21762,7 +21765,7 @@
    conforming document with no &lt;code&gt;&lt;a href=&quot;#noscript&quot;&gt;noscript&lt;/a&gt;&lt;/code&gt;
    elements and no &lt;code&gt;&lt;a href=&quot;#script0&quot;&gt;script&lt;/a&gt;&lt;/code&gt; elements, and
    such that no step in the algorithm causes an &lt;a href=&quot;#html-0&quot;&gt;HTML
-   parser&lt;/a&gt; to flag a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;:
+   parser&lt;/a&gt; to flag a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;:
 
   &lt;ol&gt;
    &lt;li&gt;Remove every &lt;code&gt;&lt;a href=&quot;#script0&quot;&gt;script&lt;/a&gt;&lt;/code&gt; element from
@@ -28123,7 +28126,7 @@
 
   &lt;h5 id=parsing0&gt;&lt;span class=secno&gt;4.6.3.2. &lt;/span&gt;Parsing cache manifests&lt;/h5&gt;
 
-  &lt;p&gt;When a user agent is to &lt;dfn id=parse&gt;parse a manifest&lt;/dfn&gt;, it means
+  &lt;p&gt;When a user agent is to &lt;dfn id=parse0&gt;parse a manifest&lt;/dfn&gt;, it means
    that the user agent must run the following steps:
 
   &lt;ol&gt;
@@ -28411,7 +28414,7 @@
 
     &lt;p&gt;If the resource is labelled with the MIME type &lt;code
      title=&quot;&quot;&gt;text/cache-manifest&lt;/code&gt;, parse &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt;
-     according to the &lt;a href=&quot;#parse&quot; title=&quot;parse a manifest&quot;&gt;rules for
+     according to the &lt;a href=&quot;#parse0&quot; title=&quot;parse a manifest&quot;&gt;rules for
      parsing manifests&lt;/a&gt;, obtaining a list of &lt;a href=&quot;#explicit&quot;
      title=concept-appcache-explicit&gt;explicit entries&lt;/a&gt;, &lt;a
      href=&quot;#fallback0&quot; title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt;
@@ -38822,7 +38825,7 @@
 
   &lt;p&gt;This specification defines the parsing rules for HTML documents, whether
    they are syntactically valid or not. Certain points in the parsing
-   algorithm are said to be &lt;dfn id=parse0 title=&quot;parse error&quot;&gt;parse
+   algorithm are said to be &lt;dfn id=parse1 title=&quot;parse error&quot;&gt;parse
    errors&lt;/dfn&gt;. The error handling for parse errors is well-defined: user
    agents must either act as described below when encountering such problems,
    or must abort processing at the first error that they encounter for which
@@ -39339,7 +39342,7 @@
    use the ISO-8859-11 encoding, it must instead use the Windows-874
    encoding. In both cases, any bytes in the range 0x80 to 0x9F must, in
    addition to being interpreted as per the Windows encoding instead of as a
-   control character, be considered &lt;a href=&quot;#parse0&quot; title=&quot;parse
+   control character, be considered &lt;a href=&quot;#parse1&quot; title=&quot;parse
    error&quot;&gt;parse errors&lt;/a&gt;.
 
   &lt;p class=note&gt;The requirement to treat certain ISO-8859 encodings as
@@ -39379,7 +39382,7 @@
 
   &lt;p&gt;All U+0000 NULL characters in the input must be replaced by U+FFFD
    REPLACEMENT CHARACTERs. Any occurrences of such characters is a &lt;a
-   href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+   href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
   &lt;p&gt;Any occurrences of any characters in the ranges U+0001 to U+0008,
    &lt;!-- space characters allowed --&gt; U+000E to U+001F, &lt;!-- ASCII
@@ -39392,7 +39395,7 @@
    U+3FFFF, U+4FFFE, U+4FFFF, U+5FFFE, U+5FFFF, U+6FFFE, U+6FFFF, U+7FFFE,
    U+7FFFF, U+8FFFE, U+8FFFF, U+9FFFE, U+9FFFF, U+AFFFE, U+AFFFF, U+BFFFE,
    U+BFFFF, U+CFFFE, U+CFFFF, U+DFFFE, U+DFFFF, U+EFFFE, U+EFFFF, U+FFFFE,
-   U+FFFFF, U+10FFFE, and U+10FFFF are &lt;a href=&quot;#parse0&quot; title=&quot;parse
+   U+FFFFF, U+10FFFE, and U+10FFFF are &lt;a href=&quot;#parse1&quot; title=&quot;parse
    error&quot;&gt;parse errors&lt;/a&gt;. (These are all control characters or permanently
    undefined Unicode characters.)
 
@@ -39468,7 +39471,449 @@
   &lt;p class=note&gt;While the invocation of this algorithm is not a parse error,
    it is &lt;a href=&quot;#charset&quot;&gt;still indicative of non-conforming content&lt;/a&gt;.
 
-  &lt;h4 id=tokenisation&gt;&lt;span class=secno&gt;8.2.3 &lt;/span&gt;&lt;dfn
+  &lt;h4 id=parse&gt;&lt;span class=secno&gt;8.2.3 &lt;/span&gt;Parse state&lt;/h4&gt;
+
+  &lt;h5 id=the-insertion&gt;&lt;span class=secno&gt;8.2.3.1. &lt;/span&gt;The insertion mode&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#initial&quot;
+   title=&quot;insertion mode: initial&quot;&gt;initial&lt;/a&gt;&quot;. It can change to &quot;&lt;a
+   href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot;, &quot;&lt;a
+   href=&quot;#before5&quot; title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;, &quot;&lt;a
+   href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;, &quot;&lt;a
+   href=&quot;#in-head0&quot; title=&quot;insertion mode: in head noscript&quot;&gt;in head
+   noscript&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#after4&quot; title=&quot;insertion mode: after head&quot;&gt;after
+   head&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in
+   body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in
+   table&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-caption&quot; title=&quot;insertion mode: in caption&quot;&gt;in
+   caption&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-column&quot; title=&quot;insertion mode: in column
+   group&quot;&gt;in column group&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table0&quot; title=&quot;insertion mode:
+   in table body&quot;&gt;in table body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-row&quot; title=&quot;insertion
+   mode: in row&quot;&gt;in row&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-cell&quot; title=&quot;insertion mode: in
+   cell&quot;&gt;in cell&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-select&quot; title=&quot;insertion mode: in
+   select&quot;&gt;in select&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-select0&quot; title=&quot;insertion mode: in
+   select in table&quot;&gt;in select in table&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#after5&quot;
+   title=&quot;insertion mode: after body&quot;&gt;after body&lt;/a&gt;&quot;, &quot;&lt;a
+   href=&quot;#in-frameset&quot; title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot;,
+   &quot;&lt;a href=&quot;#after6&quot; title=&quot;insertion mode: after frameset&quot;&gt;after
+   frameset&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#after7&quot; title=&quot;insertion mode: after after
+   body&quot;&gt;after after body&lt;/a&gt;&quot;, and &quot;&lt;a href=&quot;#after8&quot; title=&quot;insertion mode:
+   after after frameset&quot;&gt;after after frameset&lt;/a&gt;&quot; during the course of the
+   parsing, as described in the &lt;a href=&quot;#tree-construction0&quot;&gt;tree
+   construction&lt;/a&gt; stage. The insertion mode affects how tokens are
+   processed and whether CDATA blocks are supported.
+
+  &lt;p&gt;Seven of these modes, namely &quot;&lt;a href=&quot;#in-head&quot; title=&quot;insertion mode:
+   in head&quot;&gt;in head&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in
+   body&quot;&gt;in body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table&quot; title=&quot;insertion mode: in
+   table&quot;&gt;in table&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table0&quot; title=&quot;insertion mode: in
+   table body&quot;&gt;in table body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-row&quot; title=&quot;insertion mode:
+   in row&quot;&gt;in row&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-cell&quot; title=&quot;insertion mode: in
+   cell&quot;&gt;in cell&lt;/a&gt;&quot;, and &quot;&lt;a href=&quot;#in-select&quot; title=&quot;insertion mode: in
+   select&quot;&gt;in select&lt;/a&gt;&quot;, are special, in that the other modes defer to them
+   at various times. When the algorithm below says that the user agent is to
+   do something &quot;&lt;dfn id=using8&gt;using the rules for&lt;/dfn&gt; the &lt;var
+   title=&quot;&quot;&gt;m&lt;/var&gt; insertion mode&quot;, where &lt;var title=&quot;&quot;&gt;m&lt;/var&gt; is one of
+   these modes, the user agent must use the rules described under that
+   &lt;span&gt;insertion mode&lt;/span&gt;'s section, but must leave the &lt;span&gt;insertion
+   mode&lt;/span&gt; unchanged (unless the rules in that section themselves switch
+   the &lt;span&gt;insertion mode&lt;/span&gt;).
+
+  &lt;p&gt;When the steps below require the UA to &lt;dfn id=reset&gt;reset the insertion
+   mode appropriately&lt;/dfn&gt;, it means the UA must follow these steps:
+
+  &lt;ol&gt;
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; be false.
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; be the last node in the &lt;a
+    href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the first node in the stack of open
+    elements, then set &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; to true; if, in addition, the
+    &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element of the &lt;a href=&quot;#html-fragment0&quot;&gt;HTML
+    fragment parsing algorithm&lt;/a&gt; is neither a &lt;code&gt;&lt;a
+    href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; element nor a &lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt;
+    element, then set &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to the &lt;var
+    title=&quot;&quot;&gt;context&lt;/var&gt; element. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;select&lt;/code&gt; element, then
+    switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-select&quot;
+    title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot; and abort these steps.
+    (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; or
+    &lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt; element, then switch the
+    &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-cell&quot; title=&quot;insertion mode:
+    in cell&quot;&gt;in cell&lt;/a&gt;&quot; and abort these steps.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt;
+    element, then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
+    href=&quot;#in-row&quot; title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot; and abort these
+    steps.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
+    href=&quot;#tbody&quot;&gt;tbody&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#thead0&quot;&gt;thead&lt;/a&gt;&lt;/code&gt;,
+    or &lt;code&gt;&lt;a href=&quot;#tfoot0&quot;&gt;tfoot&lt;/a&gt;&lt;/code&gt; element, then switch the
+    &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-table0&quot; title=&quot;insertion
+    mode: in table body&quot;&gt;in table body&lt;/a&gt;&quot; and abort these steps.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
+    href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt; element, then switch the
+    &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-caption&quot; title=&quot;insertion
+    mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot; and abort these steps.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
+    href=&quot;#colgroup&quot;&gt;colgroup&lt;/a&gt;&lt;/code&gt; element, then switch the
+    &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-column&quot; title=&quot;insertion
+    mode: in column group&quot;&gt;in column group&lt;/a&gt;&quot; and abort these steps. (&lt;a
+    href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
+    href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;span&gt;insertion
+    mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in
+    table&lt;/a&gt;&quot; and abort these steps.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt;
+    element, then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
+    href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; (&quot;&lt;a
+    href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;! &lt;em&gt; not
+    &quot;&lt;a href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;&lt;/em&gt;!)
+    and abort these steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/li&gt;
+   &lt;!-- This is only
+   here for now in case people think that the spec accidentally
+   omitted it and try to &quot;fix&quot; it. Note that noscript-in-head is also
+   handled this way. This is all intentional. The only thing it
+   doesn't handle is the scripting-enabled fragment parsing case for a
+   &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
+   something other than a &lt;link&gt; or a &lt;style&gt; element; you'd expect
+   that to break out of the &lt;noscript&gt; but it doesn't. This is an edge
+   case that doesn't affect the spec, since the algorithm for fragment
+   parsing is only used for innerHTML, where we know scripting is
+   enabled. --&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
+    href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;span&gt;insertion
+    mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in
+    body&lt;/a&gt;&quot; and abort these steps.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;frameset&lt;/code&gt; element, then
+    switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-frameset&quot;
+    title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot; and abort these
+    steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;&lt;a
+    href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then: if the &lt;a
+    href=&quot;#head-element&quot;&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element pointer&lt;/a&gt; is
+    null, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#before5&quot;
+    title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;, otherwise, switch
+    the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#after4&quot; title=&quot;insertion
+    mode: after head&quot;&gt;after head&lt;/a&gt;&quot;. In either case, abort these steps. (&lt;a
+    href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/li&gt;
+   &lt;!-- XXX
+   can the head element pointer ever be non-null when we're going
+   through these steps? --&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; is true, then switch the &lt;span&gt;insertion
+    mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in
+    body&lt;/a&gt;&quot; and abort these steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; now be the node before &lt;var
+    title=&quot;&quot;&gt;node&lt;/var&gt; in the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;.
+
+   &lt;li&gt;Return to step 3.
+  &lt;/ol&gt;
+
+  &lt;h5 id=the-stack&gt;&lt;span class=secno&gt;8.2.3.2. &lt;/span&gt;The stack of open
+   elements&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;dfn id=stack&gt;stack of open elements&lt;/dfn&gt; is empty. The
+   stack grows downwards; the topmost node on the stack is the first one
+   added to the stack, and the bottommost node of the stack is the most
+   recently added node in the stack (notwithstanding when the stack is
+   manipulated in a random access fashion as part of &lt;a
+   href=&quot;#adoptionAgency&quot;&gt;the handling for misnested tags&lt;/a&gt;).
+
+  &lt;p&gt;The &quot;&lt;a href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before
+   html&lt;/a&gt;&quot; &lt;span&gt;insertion mode&lt;/span&gt; creates the &lt;code&gt;&lt;a
+   href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; root element node, which is then added to the
+   stack.
+
+  &lt;p&gt;In the &lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;, the &lt;a href=&quot;#stack&quot;&gt;stack
+   of open elements&lt;/a&gt; is initialised to contain an &lt;code&gt;&lt;a
+   href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element that is created as part of &lt;a
+   href=&quot;#html-fragment0&quot; title=&quot;html fragment parsing algorithm&quot;&gt;that
+   algorithm&lt;/a&gt;. (The &lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt; skips the &quot;&lt;a
+   href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot;
+   &lt;span&gt;insertion mode&lt;/span&gt;.)
+
+  &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; node, however it is created,
+   is the topmost node of the stack. It never gets popped off the stack.
+
+  &lt;p&gt;The &lt;dfn id=current4&gt;current node&lt;/dfn&gt; is the bottommost node in this
+   stack.
+
+  &lt;p&gt;The &lt;dfn id=current5&gt;current table&lt;/dfn&gt; is the last &lt;code&gt;&lt;a
+   href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element in the &lt;a href=&quot;#stack&quot;&gt;stack of
+   open elements&lt;/a&gt;, if there is one. If there is no &lt;code&gt;&lt;a
+   href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element in the &lt;a href=&quot;#stack&quot;&gt;stack of
+   open elements&lt;/a&gt; (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;), then the &lt;a
+   href=&quot;#current5&quot;&gt;current table&lt;/a&gt; is the first element in the &lt;a
+   href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; (the &lt;code&gt;&lt;a
+   href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element).
+
+  &lt;p&gt;Elements in the stack fall into the following categories:
+
+  &lt;dl&gt;
+   &lt;dt&gt;&lt;dfn id=special&gt;Special&lt;/dfn&gt;
+
+   &lt;dd&gt;
+    &lt;p&gt;The following HTML elements have varying levels of special parsing
+     rules: &lt;code&gt;&lt;a href=&quot;#address&quot;&gt;address&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#area&quot;&gt;area&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;basefont&lt;/code&gt;, &lt;code&gt;bgsound&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#blockquote&quot;&gt;blockquote&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#br&quot;&gt;br&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;center&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#col&quot;&gt;col&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#colgroup&quot;&gt;colgroup&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#dd&quot;&gt;dd&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;dir&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#div&quot;&gt;div&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#dl&quot;&gt;dl&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#dt&quot;&gt;dt&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#embed&quot;&gt;embed&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;fieldset&lt;/code&gt;,
+     &lt;code&gt;form&lt;/code&gt;, &lt;code&gt;frame&lt;/code&gt;, &lt;code&gt;frameset&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#h1&quot;&gt;h1&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#h2&quot;&gt;h2&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#h3&quot;&gt;h3&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#h4&quot;&gt;h4&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#h5&quot;&gt;h5&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#h6&quot;&gt;h6&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#hr&quot;&gt;hr&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;&lt;a href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;image&lt;/code&gt;&lt;!-- XXX ? this isn't an element that can end up
+   on the stack--&gt;,
+     &lt;code&gt;&lt;a href=&quot;#img&quot;&gt;img&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;input&lt;/code&gt;,
+     &lt;code&gt;isindex&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#li&quot;&gt;li&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#link&quot;&gt;link&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;listing&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#menu&quot;&gt;menu&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#meta0&quot;&gt;meta&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;noembed&lt;/code&gt;, &lt;code&gt;noframes&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#noscript&quot;&gt;noscript&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#ol&quot;&gt;ol&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;optgroup&lt;/code&gt;, &lt;code&gt;option&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#p&quot;&gt;p&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#param&quot;&gt;param&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;plaintext&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#pre&quot;&gt;pre&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#script0&quot;&gt;script&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;select&lt;/code&gt;,
+     &lt;code&gt;spacer&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#style&quot;&gt;style&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#tbody&quot;&gt;tbody&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;textarea&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#tfoot0&quot;&gt;tfoot&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#thead0&quot;&gt;thead&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#title1&quot;&gt;title&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;&lt;a href=&quot;#ul&quot;&gt;ul&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;wbr&lt;/code&gt;.
+
+   &lt;dt&gt;&lt;dfn id=scoping&gt;Scoping&lt;/dfn&gt;
+
+   &lt;dd&gt;
+    &lt;p&gt;The following HTML elements introduce new &lt;a href=&quot;#have-an&quot;
+     title=&quot;has an element in scope&quot;&gt;scopes&lt;/a&gt; for various parts of the
+     parsing: &lt;code&gt;applet&lt;/code&gt;, &lt;code&gt;button&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;marquee&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; and
+     &lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt;.
+
+   &lt;dt&gt;&lt;dfn id=formatting&gt;Formatting&lt;/dfn&gt;
+
+   &lt;dd&gt;
+    &lt;p&gt;The following HTML elements are those that end up in the &lt;a
+     href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt;: &lt;code&gt;&lt;a
+     href=&quot;#a&quot;&gt;a&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#b&quot;&gt;b&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;big&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#em&quot;&gt;em&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#font&quot;&gt;font&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#i&quot;&gt;i&lt;/a&gt;&lt;/code&gt;,
+     &lt;code&gt;nobr&lt;/code&gt;, &lt;code&gt;s&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#small&quot;&gt;small&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;strike&lt;/code&gt;, &lt;code&gt;&lt;a
+     href=&quot;#strong&quot;&gt;strong&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;tt&lt;/code&gt;, and &lt;code&gt;u&lt;/code&gt;.
+
+   &lt;dt&gt;&lt;dfn id=phrasing1&gt;Phrasing&lt;/dfn&gt;
+
+   &lt;dd&gt;
+    &lt;p&gt;All other elements found while parsing an HTML document.
+  &lt;/dl&gt;
+
+  &lt;p class=big-issue&gt;Still need to add these new elements to the lists:
+   &lt;code&gt;&lt;a href=&quot;#event-source&quot;&gt;event-source&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+   href=&quot;#section&quot;&gt;section&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#nav&quot;&gt;nav&lt;/a&gt;&lt;/code&gt;,
+   &lt;code&gt;&lt;a href=&quot;#article&quot;&gt;article&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+   href=&quot;#aside&quot;&gt;aside&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#header&quot;&gt;header&lt;/a&gt;&lt;/code&gt;,
+   &lt;code&gt;&lt;a href=&quot;#footer&quot;&gt;footer&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+   href=&quot;#datagrid0&quot;&gt;datagrid&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
+   href=&quot;#command0&quot;&gt;command&lt;/a&gt;&lt;/code&gt;
+
+  &lt;p&gt;The &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; is said to &lt;dfn
+   id=have-an title=&quot;has an element in scope&quot;&gt;have an element in scope&lt;/dfn&gt;
+   or &lt;dfn id=have-an0 title=&quot;has an element in table scope&quot;&gt;have an element
+   in &lt;em&gt;table scope&lt;/em&gt;&lt;/dfn&gt; when the following algorithm terminates in a
+   match state:
+
+  &lt;ol&gt;
+   &lt;li&gt;
+    &lt;p&gt;Initialise &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to be the &lt;a
+     href=&quot;#current4&quot;&gt;current node&lt;/a&gt; (the bottommost node of the stack).
+
+   &lt;li&gt;
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the target node, terminate in a match
+     state.
+
+   &lt;li&gt;
+    &lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
+     href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element, terminate in a failure state.
+
+   &lt;li&gt;
+    &lt;p&gt;Otherwise, if the algorithm is the &quot;has an element in scope&quot; variant
+     (rather than the &quot;has an element in table scope&quot; variant), and &lt;var
+     title=&quot;&quot;&gt;node&lt;/var&gt; is one of the following, terminate in a failure
+     state:&lt;/p&gt;
+
+    &lt;ul class=brief&gt;
+     &lt;li&gt;&lt;code&gt;applet&lt;/code&gt;
+
+     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt;
+
+     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt;
+
+     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt;
+
+     &lt;li&gt;&lt;code&gt;button&lt;/code&gt;
+
+     &lt;li&gt;&lt;code&gt;marquee&lt;/code&gt;
+
+     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt;
+    &lt;/ul&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;&lt;a
+     href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, terminate in a failure state.
+     (This can only happen if the &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the topmost
+     node of the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;, and prevents
+     the next step from being invoked if there are no more elements in the
+     stack.)
+
+   &lt;li&gt;
+    &lt;p&gt;Otherwise, set &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to the previous entry in the
+     &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; and return to step 2. (This
+     will never fail, since the loop will always terminate in the previous
+     step if the top of the stack is reached.)
+  &lt;/ol&gt;
+
+  &lt;p&gt;Nothing happens if at any time any of the elements in the &lt;a
+   href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; are moved to a new location in,
+   or removed from, the &lt;code&gt;Document&lt;/code&gt; tree. In particular, the stack
+   is not changed in this situation. This can cause, amongst other strange
+   effects, content to be appended to nodes that are no longer in the DOM.
+
+  &lt;p class=note&gt;In some cases (namely, when &lt;a href=&quot;#adoptionAgency&quot;&gt;closing
+   misnested formatting elements&lt;/a&gt;), the stack is manipulated in a
+   random-access fashion.
+
+  &lt;h5 id=the-list&gt;&lt;span class=secno&gt;8.2.3.3. &lt;/span&gt;The list of active
+   formatting elements&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;dfn id=list-of4&gt;list of active formatting elements&lt;/dfn&gt;
+   is empty. It is used to handle mis-nested &lt;a href=&quot;#formatting&quot;
+   title=formatting&gt;formatting element tags&lt;/a&gt;.
+
+  &lt;p&gt;The list contains elements in the &lt;a href=&quot;#formatting&quot;&gt;formatting&lt;/a&gt;
+   category, and scope markers. The scope markers are inserted when entering
+   &lt;code&gt;applet&lt;/code&gt; elements, buttons, &lt;code&gt;&lt;a
+   href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt; elements, marquees, table cells, and
+   table captions, and are used to prevent formatting from &quot;leaking&quot; into
+   &lt;code&gt;applet&lt;/code&gt; elements, buttons, &lt;code&gt;&lt;a
+   href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt; elements, marquees, and tables.
+
+  &lt;p&gt;When the steps below require the UA to &lt;dfn id=reconstruct&gt;reconstruct
+   the active formatting elements&lt;/dfn&gt;, the UA must perform the following
+   steps:
+
+  &lt;ol&gt;
+   &lt;li&gt;If there are no entries in the &lt;a href=&quot;#list-of4&quot;&gt;list of active
+    formatting elements&lt;/a&gt;, then there is nothing to reconstruct; stop this
+    algorithm.
+
+   &lt;li&gt;If the last (most recently added) entry in the &lt;a
+    href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt; is a marker, or
+    if it is an element that is in the &lt;a href=&quot;#stack&quot;&gt;stack of open
+    elements&lt;/a&gt;, then there is nothing to reconstruct; stop this algorithm.
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added)
+    element in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
+    elements&lt;/a&gt;.
+
+   &lt;li&gt;If there are no entries before &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;a
+    href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt;, then jump to
+    step 8.
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the entry one earlier than &lt;var
+    title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
+    elements&lt;/a&gt;.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; is neither a marker nor an element that
+    is also in the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;, go to step 4.
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the element one later than &lt;var
+    title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
+    elements&lt;/a&gt;.
+
+   &lt;li&gt;Perform a shallow clone of the element &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; to
+    obtain &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;. &lt;a href=&quot;#refsDOM3CORE&quot;&gt;[DOM3CORE]&lt;/a&gt;
+
+   &lt;li&gt;Append &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; to the &lt;a href=&quot;#current4&quot;&gt;current
+    node&lt;/a&gt; and push it onto the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;
+    so that it is the new &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt;.
+
+   &lt;li&gt;Replace the entry for &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the list with an
+    entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;.
+
+   &lt;li&gt;If the entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; in the &lt;a
+    href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt; is not the last
+    entry in the list, return to step 7.
+  &lt;/ol&gt;
+
+  &lt;p&gt;This has the effect of reopening all the formatting elements that were
+   opened in the current body, cell, or caption (whichever is youngest) that
+   haven't been explicitly closed.
+
+  &lt;p class=note&gt;The way this specification is written, the &lt;a
+   href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt; always consists of
+   elements in chronological order with the least recently added element
+   first and the most recently added element last (except for while steps 8
+   to 11 of the above algorithm are being executed, of course).
+
+  &lt;p&gt;When the steps below require the UA to &lt;dfn id=clear0&gt;clear the list of
+   active formatting elements up to the last marker&lt;/dfn&gt;, the UA must
+   perform the following steps:
+
+  &lt;ol&gt;
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added) entry
+    in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt;.
+
+   &lt;li&gt;Remove &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; from the &lt;a href=&quot;#list-of4&quot;&gt;list of
+    active formatting elements&lt;/a&gt;.
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; was a marker, then stop the algorithm at
+    this point. The list has been cleared up to the last marker.
+
+   &lt;li&gt;Go to step 1.
+  &lt;/ol&gt;
+
+  &lt;h5 id=the-element&gt;&lt;span class=secno&gt;8.2.3.4. &lt;/span&gt;The element pointers&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;dfn id=head-element&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
+   pointer&lt;/dfn&gt; and the &lt;dfn id=form-element&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt;
+   element pointer&lt;/dfn&gt; are both null.
+
+  &lt;p&gt;Once a &lt;code&gt;&lt;a href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt; element has been parsed
+   (whether implicitly or explicitly) the &lt;a href=&quot;#head-element&quot;&gt;&lt;code
+   title=&quot;&quot;&gt;head&lt;/code&gt; element pointer&lt;/a&gt; gets set to point to this node.
+
+  &lt;p&gt;The &lt;a href=&quot;#form-element&quot;&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element
+   pointer&lt;/a&gt; points to the last &lt;code&gt;form&lt;/code&gt; element that was opened
+   and whose end tag has not yet been seen. It is used to make form controls
+   associate with forms in the face of dramatically bad markup, for
+   historical reasons.
+
+  &lt;h4 id=tokenisation&gt;&lt;span class=secno&gt;8.2.4 &lt;/span&gt;&lt;dfn
    id=tokenisation0&gt;Tokenisation&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;Implementations must act as if they used the following state machine to
@@ -39512,7 +39957,7 @@
    flag&lt;/a&gt; must be switched to the PCDATA state.
 
   &lt;p&gt;When an end tag token is emitted with attributes, that is a &lt;a
-   href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+   href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
   &lt;p&gt;A &lt;dfn id=permitted&gt;permitted slash&lt;/dfn&gt; is a U+002F SOLIDUS character
    that is immediately followed by a U+003E GREATER-THAN SIGN, if, and only
@@ -39666,18 +40111,18 @@
 
        &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-       &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
+       &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
         character token and a U+003E GREATER-THAN SIGN character token.
         Switch to the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
        &lt;dt&gt;U+003F QUESTION MARK (?)
 
-       &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
+       &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
         href=&quot;#bogus&quot;&gt;bogus comment state&lt;/a&gt;.
 
        &lt;dt&gt;Anything else
 
-       &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
+       &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
         character token and reconsume the current input character in the &lt;a
         href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
       &lt;/dl&gt;
@@ -39739,18 +40184,18 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
       href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
       character token and a U+002F SOLIDUS character token. Reconsume the EOF
       character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
       href=&quot;#bogus&quot;&gt;bogus comment state&lt;/a&gt;.
     &lt;/dl&gt;
 
@@ -39787,13 +40232,13 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
      &lt;dt&gt;U+002F SOLIDUS (/)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
       href=&quot;#permitted&quot;&gt;permitted slash&lt;/a&gt;. Switch to the &lt;a
       href=&quot;#before&quot;&gt;before attribute name state&lt;/a&gt;.
 
@@ -39837,7 +40282,7 @@
 
      &lt;dt&gt;U+002F SOLIDUS (/)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
       href=&quot;#permitted&quot;&gt;permitted slash&lt;/a&gt;. Stay in the &lt;a
       href=&quot;#before&quot;&gt;before attribute name state&lt;/a&gt;.
 
@@ -39847,12 +40292,12 @@
 
      &lt;dt&gt;U+003D EQUALS SIGN (=)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
       else&quot; entry below.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
@@ -39900,7 +40345,7 @@
 
      &lt;dt&gt;U+002F SOLIDUS (/)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
       href=&quot;#permitted&quot;&gt;permitted slash&lt;/a&gt;. Switch to the &lt;a
       href=&quot;#before&quot;&gt;before attribute name state&lt;/a&gt;.
 
@@ -39908,12 +40353,12 @@
 
      &lt;dt&gt;U+0027 APOSTROPHE (')
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
       else&quot; entry below.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
@@ -39927,7 +40372,7 @@
      emitting the tag token, if appropriate), the complete attribute's name
      must be compared to the other attributes on the same token; if there is
      already an attribute on the token with the exact same name, then this is
-     a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt; and the new attribute must be
+     a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt; and the new attribute must be
      dropped, along with the value that gets associated with it (if any).&lt;/p&gt;
 
    &lt;dt&gt;&lt;dfn id=after&gt;After attribute name state&lt;/dfn&gt;
@@ -39968,13 +40413,13 @@
 
      &lt;dt&gt;U+002F SOLIDUS (/)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
       href=&quot;#permitted&quot;&gt;permitted slash&lt;/a&gt;. Switch to the &lt;a
       href=&quot;#before&quot;&gt;before attribute name state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
@@ -40026,12 +40471,12 @@
 
      &lt;dt&gt;U+003D EQUALS SIGN (=)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
       else&quot; entry below.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
@@ -40060,7 +40505,7 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
@@ -40089,7 +40534,7 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
@@ -40135,12 +40580,12 @@
 
      &lt;dt&gt;U+003D EQUALS SIGN (=)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Treat it as per the &quot;anything
       else&quot; entry below.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the current tag token.
       Reconsume the character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
@@ -40189,13 +40634,13 @@
 
      &lt;dt&gt;U+002F SOLIDUS (/)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt; unless this is a &lt;a
       href=&quot;#permitted&quot;&gt;permitted slash&lt;/a&gt;. Switch to the &lt;a
       href=&quot;#before&quot;&gt;before attribute name state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Reconsume the character in the &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Reconsume the character in the &lt;a
       href=&quot;#before&quot;&gt;before attribute name state&lt;/a&gt;.
     &lt;/dl&gt;
 
@@ -40234,7 +40679,7 @@
      word &quot;DOCTYPE&quot;, then consume those characters and switch to the &lt;a
      href=&quot;#doctype0&quot;&gt;DOCTYPE state&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Switch to the
+    &lt;p&gt;Otherwise, this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Switch to the
      &lt;a href=&quot;#bogus&quot;&gt;bogus comment state&lt;/a&gt;. The next character that is
      consumed, if any, is the first character that will be in the comment.&lt;/p&gt;
 
@@ -40250,12 +40695,12 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Switch to
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Switch to
       the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
       the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
@@ -40276,12 +40721,12 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Switch to
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Switch to
       the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
       the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
@@ -40303,7 +40748,7 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
       the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.&lt;/dd&gt;
      &lt;!-- For
      security reasons: otherwise, hostile user could put a &lt;script&gt; in
@@ -40329,7 +40774,7 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
       the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.&lt;/dd&gt;
      &lt;!-- For
      security reasons: otherwise, hostile user could put a &lt;script&gt; in
@@ -40357,13 +40802,13 @@
 
      &lt;dt&gt;U+002D HYPHEN-MINUS (-)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Append a U+002D HYPHEN-MINUS (-)
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Append a U+002D HYPHEN-MINUS (-)
       character to the comment token's data. Stay in the &lt;a
       href=&quot;#comment3&quot;&gt;comment end state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the comment token. Reconsume
       the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.&lt;/dd&gt;
      &lt;!-- For
      security reasons: otherwise, hostile user could put a &lt;script&gt; in
@@ -40373,7 +40818,7 @@
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Append two U+002D HYPHEN-MINUS
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Append two U+002D HYPHEN-MINUS
       (-) characters and the input character to the comment token's data.
       Switch to the &lt;a href=&quot;#comment&quot;&gt;comment state&lt;/a&gt;.
     &lt;/dl&gt;
@@ -40399,7 +40844,7 @@
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Reconsume the current character
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Reconsume the current character
       in the &lt;a href=&quot;#before1&quot;&gt;before DOCTYPE name state&lt;/a&gt;.
     &lt;/dl&gt;
 
@@ -40424,13 +40869,13 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Create a new DOCTYPE token. Set
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Create a new DOCTYPE token. Set
       its &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit the token. Switch to
       the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Create a new DOCTYPE token. Set
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Create a new DOCTYPE token. Set
       its &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit the token. Reconsume
       the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
@@ -40467,7 +40912,7 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
@@ -40504,7 +40949,7 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
@@ -40522,7 +40967,7 @@
        the word &quot;SYSTEM&quot;, then consume those characters and switch to the &lt;a
        href=&quot;#before3&quot;&gt;before DOCTYPE system identifier state&lt;/a&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Otherwise, this is the &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Set the
+      &lt;p&gt;Otherwise, this is the &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Set the
        DOCTYPE token's &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the
        &lt;a href=&quot;#bogus0&quot;&gt;bogus DOCTYPE state&lt;/a&gt;.&lt;/p&gt;
     &lt;/dl&gt;
@@ -40561,20 +41006,20 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token. Switch
       to the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a
       href=&quot;#bogus0&quot;&gt;bogus DOCTYPE state&lt;/a&gt;.
     &lt;/dl&gt;
@@ -40592,13 +41037,13 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token. Switch
       to the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
@@ -40623,13 +41068,13 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token. Switch
       to the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
@@ -40680,14 +41125,14 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a
       href=&quot;#bogus0&quot;&gt;bogus DOCTYPE state&lt;/a&gt;.
     &lt;/dl&gt;
@@ -40726,20 +41171,20 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token. Switch
       to the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a
       href=&quot;#bogus0&quot;&gt;bogus DOCTYPE state&lt;/a&gt;.
     &lt;/dl&gt;
@@ -40757,13 +41202,13 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token. Switch
       to the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
@@ -40788,13 +41233,13 @@
 
      &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token. Switch
       to the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
@@ -40833,14 +41278,14 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
       &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Emit that DOCTYPE token.
       Reconsume the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data
       state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Switch to the &lt;a
       href=&quot;#bogus0&quot;&gt;bogus DOCTYPE state&lt;/a&gt;. (This does &lt;em&gt;not&lt;/em&gt; set the
       DOCTYPE token's &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;.)
     &lt;/dl&gt;
@@ -40858,7 +41303,7 @@
 
      &lt;dt&gt;EOF
 
-     &lt;dd&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Emit the DOCTYPE token. Reconsume
+     &lt;dd&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Emit the DOCTYPE token. Reconsume
       the EOF character in the &lt;a href=&quot;#data-state&quot;&gt;data state&lt;/a&gt;.
 
      &lt;dt&gt;Anything else
@@ -40867,7 +41312,7 @@
     &lt;/dl&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=tokenising&gt;&lt;span class=secno&gt;8.2.3.1. &lt;/span&gt;Tokenising entities&lt;/h5&gt;
+  &lt;h5 id=tokenising&gt;&lt;span class=secno&gt;8.2.4.1. &lt;/span&gt;Tokenising entities&lt;/h5&gt;
 
   &lt;p&gt;This section defines how to &lt;dfn id=consume&gt;consume an entity&lt;/dfn&gt;.
    This definition is used when parsing entities &lt;a href=&quot;#entity&quot;
@@ -40941,18 +41386,18 @@
 
     &lt;p&gt;If no characters match the range, then don't consume any characters
      (and unconsume the U+0023 NUMBER SIGN character and, if appropriate, the
-     X character). This is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;; nothing is
+     X character). This is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;; nothing is
      returned.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, if the next character is a U+003B SEMICOLON, consume that
-     too. If it isn't, there is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     too. If it isn't, there is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;If one or more characters match the range, then take them all and
      interpret the string of characters as a number (either hexadecimal or
      decimal as appropriate).&lt;/p&gt;
 
     &lt;p&gt;If that number is one of the numbers in the first column of the
-     following table, then this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Find
+     following table, then this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Find
      the row with that number in the first column, and return a character
      token for the Unicode character given in the second column of that row.&lt;/p&gt;
 
@@ -41198,7 +41643,7 @@
 
     &lt;p&gt;Otherwise, if the number is zero, if the number is higher than
      0x10FFFF, or if it's one of the surrogate characters (characters in the
-     range 0xD800 to 0xDFFF), then this is a &lt;a href=&quot;#parse0&quot;&gt;parse
+     range 0xD800 to 0xDFFF), then this is a &lt;a href=&quot;#parse1&quot;&gt;parse
      error&lt;/a&gt;; return a character token for the U+FFFD REPLACEMENT CHARACTER
      character instead.&lt;/p&gt;
 
@@ -41212,11 +41657,11 @@
      characters case-sensitively matching one of the identifiers in the first
      column of the &lt;a href=&quot;#entities0&quot;&gt;entities&lt;/a&gt; table.&lt;/p&gt;
 
-    &lt;p&gt;If no match can be made, then this is a &lt;a href=&quot;#parse0&quot;&gt;parse
+    &lt;p&gt;If no match can be made, then this is a &lt;a href=&quot;#parse1&quot;&gt;parse
      error&lt;/a&gt;. No characters are consumed, and nothing is returned.&lt;/p&gt;
 
     &lt;p&gt;If the last character matched is not a U+003B SEMICOLON (&lt;code
-     title=&quot;&quot;&gt;;&lt;/code&gt;), there is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     title=&quot;&quot;&gt;;&lt;/code&gt;), there is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;If the entity is being consumed &lt;a href=&quot;#entity0&quot; title=&quot;entity in
      attribute value state&quot;&gt;as part of an attribute&lt;/a&gt;, and the last
@@ -41240,7 +41685,7 @@
     &lt;/div&gt;
   &lt;/dl&gt;
 
-  &lt;h4 id=tree-construction&gt;&lt;span class=secno&gt;8.2.4 &lt;/span&gt;&lt;dfn
+  &lt;h4 id=tree-construction&gt;&lt;span class=secno&gt;8.2.5 &lt;/span&gt;&lt;dfn
    id=tree-construction0&gt;Tree construction&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;The input to the tree construction stage is a sequence of tokens from
@@ -41253,6 +41698,10 @@
    render the &lt;code&gt;Document&lt;/code&gt; so that it is available to the user, or
    when it has to begin accepting user input.
 
+  &lt;p&gt;As each token is emitted from the tokeniser, the user agent must process
+   the token according to the rules given in the section corresponding to the
+   current &lt;span&gt;insertion mode&lt;/span&gt;.
+
   &lt;p&gt;When the steps below require the UA to &lt;dfn id=insert&gt;insert a
    character&lt;/dfn&gt; into a node, if that node has a child immediately before
    where the character is to be inserted, and that child is a
@@ -41284,331 +41733,7 @@
    href=&quot;#hardwareLimitations&quot;&gt;practical concerns&lt;/a&gt; will likely force user
    agents to impose nesting depths.
 
-  &lt;p&gt;As each token is emitted from the tokeniser, the user agent must process
-   the token according to the rules given in the section corresponding to the
-   current &lt;dfn id=insertion0&gt;insertion mode&lt;/dfn&gt;.
-
-  &lt;p&gt;Initially the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#initial&quot; title=&quot;insertion mode: initial&quot;&gt;initial&lt;/a&gt;&quot;. It can
-   change to &quot;&lt;a href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before
-   html&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#before5&quot; title=&quot;insertion mode: before head&quot;&gt;before
-   head&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in
-   head&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-head0&quot; title=&quot;insertion mode: in head
-   noscript&quot;&gt;in head noscript&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#after4&quot; title=&quot;insertion mode:
-   after head&quot;&gt;after head&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in
-   body&quot;&gt;in body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table&quot; title=&quot;insertion mode: in
-   table&quot;&gt;in table&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-caption&quot; title=&quot;insertion mode: in
-   caption&quot;&gt;in caption&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-column&quot; title=&quot;insertion mode: in
-   column group&quot;&gt;in column group&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table0&quot; title=&quot;insertion
-   mode: in table body&quot;&gt;in table body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-row&quot;
-   title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-cell&quot;
-   title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-select&quot;
-   title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-select0&quot;
-   title=&quot;insertion mode: in select in table&quot;&gt;in select in table&lt;/a&gt;&quot;, &quot;&lt;a
-   href=&quot;#after5&quot; title=&quot;insertion mode: after body&quot;&gt;after body&lt;/a&gt;&quot;, &quot;&lt;a
-   href=&quot;#in-frameset&quot; title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot;,
-   &quot;&lt;a href=&quot;#after6&quot; title=&quot;insertion mode: after frameset&quot;&gt;after
-   frameset&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#after7&quot; title=&quot;insertion mode: after after
-   body&quot;&gt;after after body&lt;/a&gt;&quot;, and &quot;&lt;a href=&quot;#after8&quot; title=&quot;insertion mode:
-   after after frameset&quot;&gt;after after frameset&lt;/a&gt;&quot; during the course of the
-   parsing, as described below. It affects how certain tokens are processed.
-
-  &lt;p&gt;Four of these modes, namely &quot;&lt;a href=&quot;#in-head&quot; title=&quot;insertion mode:
-   in head&quot;&gt;in head&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in
-   body&quot;&gt;in body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table&quot; title=&quot;insertion mode: in
-   table&quot;&gt;in table&lt;/a&gt;&quot;, and &quot;&lt;a href=&quot;#in-select&quot; title=&quot;insertion mode: in
-   select&quot;&gt;in select&lt;/a&gt;&quot;, are special, in that the other modes defer to them
-   at various times. When the algorithm below says that the user agent is to
-   do something &quot;&lt;dfn id=using8&gt;using the rules for&lt;/dfn&gt; the &lt;var
-   title=&quot;&quot;&gt;m&lt;/var&gt; insertion mode&quot;, where &lt;var title=&quot;&quot;&gt;m&lt;/var&gt; is one of
-   these modes, the user agent must use the rules described under that &lt;a
-   href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;'s section, but must leave the &lt;a
-   href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; unchanged (unless the rules in that
-   section themselves switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;).
-
-  &lt;p&gt;In addition to the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;, the tree
-   construction stage has several pieces of state: a &lt;a href=&quot;#stack&quot;&gt;stack
-   of open elements&lt;/a&gt;, a &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
-   elements&lt;/a&gt;, a &lt;a href=&quot;#head-element&quot;&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
-   pointer&lt;/a&gt;, and a &lt;a href=&quot;#form-element&quot;&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt;
-   element pointer&lt;/a&gt;.
-
-  &lt;h5 id=the-stack&gt;&lt;span class=secno&gt;8.2.4.1. &lt;/span&gt;The stack of open
-   elements&lt;/h5&gt;
-
-  &lt;p&gt;Initially the &lt;dfn id=stack&gt;stack of open elements&lt;/dfn&gt; is empty. The
-   stack grows downwards; the topmost node on the stack is the first one
-   added to the stack, and the bottommost node of the stack is the most
-   recently added node in the stack (notwithstanding when the stack is
-   manipulated in a random access fashion as part of &lt;a
-   href=&quot;#adoptionAgency&quot;&gt;the handling for misnested tags&lt;/a&gt;).
-
-  &lt;p&gt;The &quot;&lt;a href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before
-   html&lt;/a&gt;&quot; &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; creates the &lt;code&gt;&lt;a
-   href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; root element node, which is then added to the
-   stack.
-
-  &lt;p&gt;In the &lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;, the &lt;a href=&quot;#stack&quot;&gt;stack
-   of open elements&lt;/a&gt; is initialised to contain an &lt;code&gt;&lt;a
-   href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element that is created as part of &lt;a
-   href=&quot;#html-fragment0&quot; title=&quot;html fragment parsing algorithm&quot;&gt;that
-   algorithm&lt;/a&gt;. (The &lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt; skips the &quot;&lt;a
-   href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot; &lt;a
-   href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.)
-
-  &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; node, however it is created,
-   is the topmost node of the stack. It never gets popped off the stack.
-
-  &lt;p&gt;The &lt;dfn id=current4&gt;current node&lt;/dfn&gt; is the bottommost node in this
-   stack.
-
-  &lt;p&gt;The &lt;dfn id=current5&gt;current table&lt;/dfn&gt; is the last &lt;code&gt;&lt;a
-   href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element in the &lt;a href=&quot;#stack&quot;&gt;stack of
-   open elements&lt;/a&gt;, if there is one. If there is no &lt;code&gt;&lt;a
-   href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element in the &lt;a href=&quot;#stack&quot;&gt;stack of
-   open elements&lt;/a&gt; (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;), then the &lt;a
-   href=&quot;#current5&quot;&gt;current table&lt;/a&gt; is the first element in the &lt;a
-   href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; (the &lt;code&gt;&lt;a
-   href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element).
-
-  &lt;p&gt;Elements in the stack fall into the following categories:
-
-  &lt;dl&gt;
-   &lt;dt&gt;&lt;dfn id=special&gt;Special&lt;/dfn&gt;
-
-   &lt;dd&gt;
-    &lt;p&gt;The following HTML elements have varying levels of special parsing
-     rules: &lt;code&gt;&lt;a href=&quot;#address&quot;&gt;address&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#area&quot;&gt;area&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#base&quot;&gt;base&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;basefont&lt;/code&gt;, &lt;code&gt;bgsound&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#blockquote&quot;&gt;blockquote&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#br&quot;&gt;br&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;center&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#col&quot;&gt;col&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#colgroup&quot;&gt;colgroup&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#dd&quot;&gt;dd&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;dir&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#div&quot;&gt;div&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#dl&quot;&gt;dl&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#dt&quot;&gt;dt&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#embed&quot;&gt;embed&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;fieldset&lt;/code&gt;,
-     &lt;code&gt;form&lt;/code&gt;, &lt;code&gt;frame&lt;/code&gt;, &lt;code&gt;frameset&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#h1&quot;&gt;h1&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#h2&quot;&gt;h2&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#h3&quot;&gt;h3&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#h4&quot;&gt;h4&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#h5&quot;&gt;h5&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#h6&quot;&gt;h6&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#hr&quot;&gt;hr&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;&lt;a href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;image&lt;/code&gt;&lt;!-- XXX ? this isn't an element that can end up
-   on the stack--&gt;,
-     &lt;code&gt;&lt;a href=&quot;#img&quot;&gt;img&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;input&lt;/code&gt;,
-     &lt;code&gt;isindex&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#li&quot;&gt;li&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#link&quot;&gt;link&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;listing&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#menu&quot;&gt;menu&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#meta0&quot;&gt;meta&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;noembed&lt;/code&gt;, &lt;code&gt;noframes&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#noscript&quot;&gt;noscript&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#ol&quot;&gt;ol&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;optgroup&lt;/code&gt;, &lt;code&gt;option&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#p&quot;&gt;p&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#param&quot;&gt;param&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;plaintext&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#pre&quot;&gt;pre&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#script0&quot;&gt;script&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;select&lt;/code&gt;,
-     &lt;code&gt;spacer&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#style&quot;&gt;style&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#tbody&quot;&gt;tbody&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;textarea&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#tfoot0&quot;&gt;tfoot&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#thead0&quot;&gt;thead&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#title1&quot;&gt;title&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;&lt;a href=&quot;#ul&quot;&gt;ul&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;wbr&lt;/code&gt;.
-
-   &lt;dt&gt;&lt;dfn id=scoping&gt;Scoping&lt;/dfn&gt;
-
-   &lt;dd&gt;
-    &lt;p&gt;The following HTML elements introduce new &lt;a href=&quot;#have-an&quot;
-     title=&quot;has an element in scope&quot;&gt;scopes&lt;/a&gt; for various parts of the
-     parsing: &lt;code&gt;applet&lt;/code&gt;, &lt;code&gt;button&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;marquee&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; and
-     &lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt;.
-
-   &lt;dt&gt;&lt;dfn id=formatting&gt;Formatting&lt;/dfn&gt;
-
-   &lt;dd&gt;
-    &lt;p&gt;The following HTML elements are those that end up in the &lt;a
-     href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt;: &lt;code&gt;&lt;a
-     href=&quot;#a&quot;&gt;a&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#b&quot;&gt;b&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;big&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#em&quot;&gt;em&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#font&quot;&gt;font&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#i&quot;&gt;i&lt;/a&gt;&lt;/code&gt;,
-     &lt;code&gt;nobr&lt;/code&gt;, &lt;code&gt;s&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#small&quot;&gt;small&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;strike&lt;/code&gt;, &lt;code&gt;&lt;a
-     href=&quot;#strong&quot;&gt;strong&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;tt&lt;/code&gt;, and &lt;code&gt;u&lt;/code&gt;.
-
-   &lt;dt&gt;&lt;dfn id=phrasing1&gt;Phrasing&lt;/dfn&gt;
-
-   &lt;dd&gt;
-    &lt;p&gt;All other elements found while parsing an HTML document.
-  &lt;/dl&gt;
-
-  &lt;p class=big-issue&gt;Still need to add these new elements to the lists:
-   &lt;code&gt;&lt;a href=&quot;#event-source&quot;&gt;event-source&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-   href=&quot;#section&quot;&gt;section&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#nav&quot;&gt;nav&lt;/a&gt;&lt;/code&gt;,
-   &lt;code&gt;&lt;a href=&quot;#article&quot;&gt;article&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-   href=&quot;#aside&quot;&gt;aside&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#header&quot;&gt;header&lt;/a&gt;&lt;/code&gt;,
-   &lt;code&gt;&lt;a href=&quot;#footer&quot;&gt;footer&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-   href=&quot;#datagrid0&quot;&gt;datagrid&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
-   href=&quot;#command0&quot;&gt;command&lt;/a&gt;&lt;/code&gt;
-
-  &lt;p&gt;The &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; is said to &lt;dfn
-   id=have-an title=&quot;has an element in scope&quot;&gt;have an element in scope&lt;/dfn&gt;
-   or &lt;dfn id=have-an0 title=&quot;has an element in table scope&quot;&gt;have an element
-   in &lt;em&gt;table scope&lt;/em&gt;&lt;/dfn&gt; when the following algorithm terminates in a
-   match state:
-
-  &lt;ol&gt;
-   &lt;li&gt;
-    &lt;p&gt;Initialise &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to be the &lt;a
-     href=&quot;#current4&quot;&gt;current node&lt;/a&gt; (the bottommost node of the stack).
-
-   &lt;li&gt;
-    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the target node, terminate in a match
-     state.
-
-   &lt;li&gt;
-    &lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
-     href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element, terminate in a failure state.
-
-   &lt;li&gt;
-    &lt;p&gt;Otherwise, if the algorithm is the &quot;has an element in scope&quot; variant
-     (rather than the &quot;has an element in table scope&quot; variant), and &lt;var
-     title=&quot;&quot;&gt;node&lt;/var&gt; is one of the following, terminate in a failure
-     state:&lt;/p&gt;
-
-    &lt;ul class=brief&gt;
-     &lt;li&gt;&lt;code&gt;applet&lt;/code&gt;
-
-     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt;
-
-     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt;
-
-     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt;
-
-     &lt;li&gt;&lt;code&gt;button&lt;/code&gt;
-
-     &lt;li&gt;&lt;code&gt;marquee&lt;/code&gt;
-
-     &lt;li&gt;&lt;code&gt;&lt;a href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt;
-    &lt;/ul&gt;
-
-   &lt;li&gt;
-    &lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;&lt;a
-     href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, terminate in a failure state.
-     (This can only happen if the &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the topmost
-     node of the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;, and prevents
-     the next step from being invoked if there are no more elements in the
-     stack.)
-
-   &lt;li&gt;
-    &lt;p&gt;Otherwise, set &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to the previous entry in the
-     &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; and return to step 2. (This
-     will never fail, since the loop will always terminate in the previous
-     step if the top of the stack is reached.)
-  &lt;/ol&gt;
-
-  &lt;p&gt;Nothing happens if at any time any of the elements in the &lt;a
-   href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; are moved to a new location in,
-   or removed from, the &lt;code&gt;Document&lt;/code&gt; tree. In particular, the stack
-   is not changed in this situation. This can cause, amongst other strange
-   effects, content to be appended to nodes that are no longer in the DOM.
-
-  &lt;p class=note&gt;In some cases (namely, when &lt;a href=&quot;#adoptionAgency&quot;&gt;closing
-   misnested formatting elements&lt;/a&gt;), the stack is manipulated in a
-   random-access fashion.
-
-  &lt;h5 id=the-list&gt;&lt;span class=secno&gt;8.2.4.2. &lt;/span&gt;The list of active
-   formatting elements&lt;/h5&gt;
-
-  &lt;p&gt;Initially the &lt;dfn id=list-of4&gt;list of active formatting elements&lt;/dfn&gt;
-   is empty. It is used to handle mis-nested &lt;a href=&quot;#formatting&quot;
-   title=formatting&gt;formatting element tags&lt;/a&gt;.
-
-  &lt;p&gt;The list contains elements in the &lt;a href=&quot;#formatting&quot;&gt;formatting&lt;/a&gt;
-   category, and scope markers. The scope markers are inserted when entering
-   &lt;code&gt;applet&lt;/code&gt; elements, buttons, &lt;code&gt;&lt;a
-   href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt; elements, marquees, table cells, and
-   table captions, and are used to prevent formatting from &quot;leaking&quot; into
-   &lt;code&gt;applet&lt;/code&gt; elements, buttons, &lt;code&gt;&lt;a
-   href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt; elements, marquees, and tables.
-
-  &lt;p&gt;When the steps below require the UA to &lt;dfn id=reconstruct&gt;reconstruct
-   the active formatting elements&lt;/dfn&gt;, the UA must perform the following
-   steps:
-
-  &lt;ol&gt;
-   &lt;li&gt;If there are no entries in the &lt;a href=&quot;#list-of4&quot;&gt;list of active
-    formatting elements&lt;/a&gt;, then there is nothing to reconstruct; stop this
-    algorithm.
-
-   &lt;li&gt;If the last (most recently added) entry in the &lt;a
-    href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt; is a marker, or
-    if it is an element that is in the &lt;a href=&quot;#stack&quot;&gt;stack of open
-    elements&lt;/a&gt;, then there is nothing to reconstruct; stop this algorithm.
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added)
-    element in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
-    elements&lt;/a&gt;.
-
-   &lt;li&gt;If there are no entries before &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;a
-    href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt;, then jump to
-    step 8.
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the entry one earlier than &lt;var
-    title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
-    elements&lt;/a&gt;.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; is neither a marker nor an element that
-    is also in the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;, go to step 4.
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the element one later than &lt;var
-    title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
-    elements&lt;/a&gt;.
-
-   &lt;li&gt;Perform a shallow clone of the element &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; to
-    obtain &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;. &lt;a href=&quot;#refsDOM3CORE&quot;&gt;[DOM3CORE]&lt;/a&gt;
-
-   &lt;li&gt;Append &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; to the &lt;a href=&quot;#current4&quot;&gt;current
-    node&lt;/a&gt; and push it onto the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;
-    so that it is the new &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt;.
-
-   &lt;li&gt;Replace the entry for &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the list with an
-    entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;.
-
-   &lt;li&gt;If the entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; in the &lt;a
-    href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt; is not the last
-    entry in the list, return to step 7.
-  &lt;/ol&gt;
-
-  &lt;p&gt;This has the effect of reopening all the formatting elements that were
-   opened in the current body, cell, or caption (whichever is youngest) that
-   haven't been explicitly closed.
-
-  &lt;p class=note&gt;The way this specification is written, the &lt;a
-   href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt; always consists of
-   elements in chronological order with the least recently added element
-   first and the most recently added element last (except for while steps 8
-   to 11 of the above algorithm are being executed, of course).
-
-  &lt;p&gt;When the steps below require the UA to &lt;dfn id=clear0&gt;clear the list of
-   active formatting elements up to the last marker&lt;/dfn&gt;, the UA must
-   perform the following steps:
-
-  &lt;ol&gt;
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added) entry
-    in the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt;.
-
-   &lt;li&gt;Remove &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; from the &lt;a href=&quot;#list-of4&quot;&gt;list of
-    active formatting elements&lt;/a&gt;.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; was a marker, then stop the algorithm at
-    this point. The list has been cleared up to the last marker.
-
-   &lt;li&gt;Go to step 1.
-  &lt;/ol&gt;
-
-  &lt;h5 id=creating&gt;&lt;span class=secno&gt;8.2.4.3. &lt;/span&gt;Creating and inserting
+  &lt;h5 id=creating&gt;&lt;span class=secno&gt;8.2.5.1. &lt;/span&gt;Creating and inserting
    HTML elements&lt;/h5&gt;
 
   &lt;p&gt;When the steps below require the UA to &lt;dfn id=create title=&quot;create an
@@ -41675,10 +41800,10 @@
    &lt;li&gt;
     &lt;p&gt;If the next token is an end tag token with the same tag name as the
      start tag token, ignore it. Otherwise, it's an end-of-file token, and
-     this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+     this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
   &lt;/ol&gt;
 
-  &lt;h5 id=closing&gt;&lt;span class=secno&gt;8.2.4.4. &lt;/span&gt;Closing elements that have
+  &lt;h5 id=closing&gt;&lt;span class=secno&gt;8.2.5.2. &lt;/span&gt;Closing elements that have
    implied end tags&lt;/h5&gt;
 
   &lt;p&gt;When the steps below require the UA to &lt;dfn id=generate&gt;generate implied
@@ -41693,178 +41818,10 @@
    element to exclude from the process, then the UA must perform the above
    steps as if that element was not in the above list.
 
-  &lt;h5 id=the-element&gt;&lt;span class=secno&gt;8.2.4.5. &lt;/span&gt;The element pointers&lt;/h5&gt;
-
-  &lt;p&gt;Initially the &lt;dfn id=head-element&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
-   pointer&lt;/dfn&gt; and the &lt;dfn id=form-element&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt;
-   element pointer&lt;/dfn&gt; are both null.
-
-  &lt;p&gt;Once a &lt;code&gt;&lt;a href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt; element has been parsed
-   (whether implicitly or explicitly) the &lt;a href=&quot;#head-element&quot;&gt;&lt;code
-   title=&quot;&quot;&gt;head&lt;/code&gt; element pointer&lt;/a&gt; gets set to point to this node.
-
-  &lt;p&gt;The &lt;a href=&quot;#form-element&quot;&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element
-   pointer&lt;/a&gt; points to the last &lt;code&gt;form&lt;/code&gt; element that was opened
-   and whose end tag has not yet been seen. It is used to make form controls
-   associate with forms in the face of dramatically bad markup, for
-   historical reasons.
-
-  &lt;h5 id=resetting&gt;&lt;span class=secno&gt;8.2.4.6. &lt;/span&gt;Resetting the insertion
-   mode&lt;/h5&gt;
-
-  &lt;p&gt;When the steps below require the UA to &lt;dfn id=reset&gt;reset the insertion
-   mode appropriately&lt;/dfn&gt;, it means the UA must follow these steps:
-
-  &lt;ol&gt;
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; be false.
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; be the last node in the &lt;a
-    href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the first node in the stack of open
-    elements, then set &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; to true; if, in addition, the
-    &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element of the &lt;a href=&quot;#html-fragment0&quot;&gt;HTML
-    fragment parsing algorithm&lt;/a&gt; is neither a &lt;code&gt;&lt;a
-    href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; element nor a &lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt;
-    element, then set &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to the &lt;var
-    title=&quot;&quot;&gt;context&lt;/var&gt; element. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;select&lt;/code&gt; element, then
-    switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-    href=&quot;#in-select&quot; title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot; and
-    abort these steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; or
-    &lt;code&gt;&lt;a href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;a
-    href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-cell&quot;
-    title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/a&gt;&quot; and abort these steps.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt;
-    element, then switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-    href=&quot;#in-row&quot; title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot; and abort these
-    steps.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
-    href=&quot;#tbody&quot;&gt;tbody&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#thead0&quot;&gt;thead&lt;/a&gt;&lt;/code&gt;,
-    or &lt;code&gt;&lt;a href=&quot;#tfoot0&quot;&gt;tfoot&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;a
-    href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-table0&quot;
-    title=&quot;insertion mode: in table body&quot;&gt;in table body&lt;/a&gt;&quot; and abort these
-    steps.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
-    href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;a
-    href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-caption&quot;
-    title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot; and abort these steps.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
-    href=&quot;#colgroup&quot;&gt;colgroup&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;a
-    href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-column&quot;
-    title=&quot;insertion mode: in column group&quot;&gt;in column group&lt;/a&gt;&quot; and abort
-    these steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
-    href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;a
-    href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-table&quot;
-    title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot; and abort these steps.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt;
-    element, then switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-    href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; (&quot;&lt;a
-    href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;! &lt;em&gt; not
-    &quot;&lt;a href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;&lt;/em&gt;!)
-    and abort these steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/li&gt;
-   &lt;!-- This is only
-   here for now in case people think that the spec accidentally
-   omitted it and try to &quot;fix&quot; it. Note that noscript-in-head is also
-   handled this way. This is all intentional. The only thing it
-   doesn't handle is the scripting-enabled fragment parsing case for a
-   &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
-   something other than a &lt;link&gt; or a &lt;style&gt; element; you'd expect
-   that to break out of the &lt;noscript&gt; but it doesn't. This is an edge
-   case that doesn't affect the spec, since the algorithm for fragment
-   parsing is only used for innerHTML, where we know scripting is
-   enabled. --&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
-    href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;a
-    href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-body&quot;
-    title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; and abort these steps.
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;frameset&lt;/code&gt; element, then
-    switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-    href=&quot;#in-frameset&quot; title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot;
-    and abort these steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;&lt;a
-    href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then: if the &lt;a
-    href=&quot;#head-element&quot;&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element pointer&lt;/a&gt; is
-    null, switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-    href=&quot;#before5&quot; title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;,
-    otherwise, switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-    href=&quot;#after4&quot; title=&quot;insertion mode: after head&quot;&gt;after head&lt;/a&gt;&quot;. In
-    either case, abort these steps. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/li&gt;
-   &lt;!-- XXX
-   can the head element pointer ever be non-null when we're going
-   through these steps? --&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; is true, then switch the &lt;a
-    href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-body&quot;
-    title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; and abort these steps. (&lt;a
-    href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; now be the node before &lt;var
-    title=&quot;&quot;&gt;node&lt;/var&gt; in the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;.
-
-   &lt;li&gt;Return to step 3.
-  &lt;/ol&gt;
-  &lt;!--When you don't have to handle the fragment case, you can use this
-simplified explanation instead:
-
-  &lt;ol&gt;
-
-   &lt;li&gt;&lt;p&gt;If the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span title=&quot;has
-   an element in table scope&quot;&gt;has a &lt;code&gt;td&lt;/code&gt; or &lt;code&gt;th&lt;/code&gt;
-   element in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion
-   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in cell&quot;&gt;in
-   cell&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;tr&lt;/code&gt; element
-   in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion mode&lt;/span&gt;
-   to &quot;&lt;span title=&quot;insertion mode: in row&quot;&gt;in row&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;tbody&lt;/code&gt;,
-   &lt;code&gt;tfoot&lt;/code&gt;, or &lt;code&gt;thead&lt;/code&gt; element in table
-   scope&lt;/span&gt;, then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in table body&quot;&gt;in table
-   body&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;caption&lt;/code&gt;
-   element in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion
-   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in caption&quot;&gt;in
-   caption&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   ( you can't reach this point with a colgroup element on the
-   stack )
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;table&lt;/code&gt;
-   element in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion
-   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in table&quot;&gt;in
-   table&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-  &lt;/ol&gt;
---&gt;
-
-  &lt;h5 id=the-initial&gt;&lt;span class=secno&gt;8.2.4.7. &lt;/span&gt;The &quot;&lt;dfn id=initial
+  &lt;h5 id=the-initial&gt;&lt;span class=secno&gt;8.2.5.3. &lt;/span&gt;The &quot;&lt;dfn id=initial
    title=&quot;insertion mode: initial&quot;&gt;initial&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#initial&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#initial&quot;
    title=&quot;insertion mode: initial&quot;&gt;initial&lt;/a&gt;&quot;, tokens must be handled as
    follows:
 
@@ -41889,7 +41846,7 @@
     &lt;p&gt;If the DOCTYPE token's &lt;code title=&quot;&quot;&gt;name&lt;/code&gt; does not
      case-insensitively match the string &quot;&lt;code title=&quot;&quot;&gt;HTML&lt;/code&gt;&quot;, or if
      the token's public identifier is not missing, or if the token's system
-     identifier is not missing, then there is a &lt;a href=&quot;#parse0&quot;&gt;parse
+     identifier is not missing, then there is a &lt;a href=&quot;#parse1&quot;&gt;parse
      error&lt;/a&gt;. Conformance checkers may, instead of reporting this error,
      switch to a conformance checking mode for another language (e.g. based
      on the DOCTYPE token a conformance checker could recognise that the
@@ -42168,25 +42125,25 @@
      compared to the values given in the lists above in a
      case-insensitive&lt;!-- ASCII --&gt; manner.&lt;/p&gt;
 
-    &lt;p&gt;Then, switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Then, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#before4&quot;
+     title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Set the document to &lt;a href=&quot;#quirks&quot;&gt;quirks mode&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#before4&quot; title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot;,
-     then reprocess the current token.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#before4&quot;
+     title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot;, then reprocess the
+     current token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=the-before&gt;&lt;span class=secno&gt;8.2.4.8. &lt;/span&gt;The &quot;&lt;dfn id=before4
+  &lt;h5 id=the-before&gt;&lt;span class=secno&gt;8.2.5.4. &lt;/span&gt;The &quot;&lt;dfn id=before4
    title=&quot;insertion mode: before html&quot;&gt;before html&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#before4&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#before4&quot;
    title=&quot;insertion mode: before html&quot;&gt;before html&lt;/a&gt;&quot;, tokens must be
    handled as follows:
 
@@ -42194,7 +42151,7 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A comment token
 
@@ -42225,8 +42182,8 @@
      title=concept-appcache-init-no-attribute&gt;application cache selection
      algorithm&lt;/a&gt; with no manifest.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#before5&quot; title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#before5&quot;
+     title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;Anything else
 
@@ -42241,9 +42198,9 @@
      title=concept-appcache-init-no-attribute&gt;application cache selection
      algorithm&lt;/a&gt; with no manifest.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#before5&quot; title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;,
-     then reprocess the current token.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#before5&quot;
+     title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;, then reprocess the
+     current token.&lt;/p&gt;
 
     &lt;p class=big-issue&gt;Should probably make end tags be ignored, so that
      &quot;&lt;/head&gt;&lt;!-- --&gt;&lt;html&gt;&quot; puts the comment before the root node
@@ -42255,10 +42212,10 @@
    content continues being appended to the nodes as described in the next
    section.
 
-  &lt;h5 id=the-before0&gt;&lt;span class=secno&gt;8.2.4.9. &lt;/span&gt;The &quot;&lt;dfn id=before5
+  &lt;h5 id=the-before0&gt;&lt;span class=secno&gt;8.2.5.5. &lt;/span&gt;The &quot;&lt;dfn id=before5
    title=&quot;insertion mode: before head&quot;&gt;before head&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#before5&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#before5&quot;
    title=&quot;insertion mode: before head&quot;&gt;before head&lt;/a&gt;&quot;, tokens must be
    handled as follows:
 
@@ -42281,14 +42238,14 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;head&quot;
 
@@ -42301,8 +42258,8 @@
     &lt;p&gt;Append the new element to the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; and
      push it onto the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-head&quot;
+     title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is one of: &quot;head&quot;, &quot;body&quot;, &quot;html&quot;, &quot;p&quot;, &quot;br&quot;
 
@@ -42313,7 +42270,7 @@
    &lt;dt&gt;Any other end tag
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
     &lt;p class=big-issue&gt;Do we really want to ignore end tags here?&lt;/p&gt;
 
@@ -42326,13 +42283,13 @@
     &lt;p class=note&gt;This will result in an empty &lt;code&gt;&lt;a
      href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt; element being generated, with the current
      token being reprocessed in the &quot;&lt;a href=&quot;#after4&quot; title=&quot;insertion mode:
-     after head&quot;&gt;after head&lt;/a&gt;&quot; &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     after head&quot;&gt;after head&lt;/a&gt;&quot; &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-inhead&gt;&lt;span class=secno&gt;8.2.4.10. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-inhead&gt;&lt;span class=secno&gt;8.2.5.6. &lt;/span&gt;The &quot;&lt;dfn
    id=in-head title=&quot;insertion mode: in head&quot;&gt;in head&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#in-head&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-head&quot;
    title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;, tokens must be handled as
    follows:
 
@@ -42355,14 +42312,14 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;base&quot;, &quot;link&quot;
 
@@ -42415,9 +42372,8 @@
    &lt;dd&gt;
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-head0&quot; title=&quot;insertion mode: in head noscript&quot;&gt;in head
-     noscript&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-head0&quot;
+     title=&quot;insertion mode: in head noscript&quot;&gt;in head noscript&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt id=scriptTag&gt;A start tag whose tag name is &quot;script&quot;
 
@@ -42447,7 +42403,7 @@
      switched back to the PCDATA state.&lt;/p&gt;
 
     &lt;p&gt;If the next token is not an end tag token with the tag name &quot;script&quot;,
-     then this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;; mark the &lt;code&gt;&lt;a
+     then this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;; mark the &lt;code&gt;&lt;a
      href=&quot;#script0&quot;&gt;script&lt;/a&gt;&lt;/code&gt; element as &lt;a href=&quot;#already&quot;&gt;&quot;already
      executed&quot;&lt;/a&gt;. Otherwise, the token is the &lt;code&gt;&lt;a
      href=&quot;#script0&quot;&gt;script&lt;/a&gt;&lt;/code&gt; element's end tag, so ignore it.&lt;/p&gt;
@@ -42545,8 +42501,8 @@
      &lt;code&gt;&lt;a href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt; element) off the &lt;a
      href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#after4&quot; title=&quot;insertion mode: after head&quot;&gt;after head&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#after4&quot;
+     title=&quot;insertion mode: after head&quot;&gt;after head&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is one of: &quot;body&quot;, &quot;html&quot;, &quot;p&quot;, &quot;br&quot;
 
@@ -42558,7 +42514,7 @@
    &lt;dt&gt;Any other end tag
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;Anything else
 
@@ -42572,26 +42528,26 @@
      get put into the head. Do we want to copy that?&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-inheadnoscript&gt;&lt;span class=secno&gt;8.2.4.11. &lt;/span&gt;The
+  &lt;h5 id=parsing-main-inheadnoscript&gt;&lt;span class=secno&gt;8.2.5.7. &lt;/span&gt;The
    &quot;&lt;dfn id=in-head0 title=&quot;insertion mode: in head noscript&quot;&gt;in head
    noscript&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-head0&quot; title=&quot;insertion mode: in head noscript&quot;&gt;in head
-   noscript&lt;/a&gt;&quot;, tokens must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-head0&quot;
+   title=&quot;insertion mode: in head noscript&quot;&gt;in head noscript&lt;/a&gt;&quot;, tokens
+   must be handled as follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;noscript&quot;
 
@@ -42602,8 +42558,8 @@
      href=&quot;#current4&quot;&gt;current node&lt;/a&gt; will be a &lt;code&gt;&lt;a
      href=&quot;#head&quot;&gt;head&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-head&quot;
+     title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A character token that is one of one of U+0009 CHARACTER TABULATION,
     U+000A LINE FEED (LF), U+000B LINE TABULATION, U+000C FORM FEED (FF),
@@ -42615,8 +42571,8 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is one of: &quot;p&quot;, &quot;br&quot;
 
@@ -42628,19 +42584,19 @@
    &lt;dt&gt;Any other end tag
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;Anything else
 
    &lt;dd&gt; &lt;!-- can't get here with an EOF and a fragment case --&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
      name &quot;noscript&quot; had been seen and reprocess the current token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=the-after&gt;&lt;span class=secno&gt;8.2.4.12. &lt;/span&gt;The &quot;&lt;dfn id=after4
+  &lt;h5 id=the-after&gt;&lt;span class=secno&gt;8.2.5.8. &lt;/span&gt;The &quot;&lt;dfn id=after4
    title=&quot;insertion mode: after head&quot;&gt;after head&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#after4&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#after4&quot;
    title=&quot;insertion mode: after head&quot;&gt;after head&lt;/a&gt;&quot;, tokens must be handled
    as follows:
 
@@ -42663,45 +42619,44 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;body&quot;
 
    &lt;dd&gt;
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-body&quot;
+     title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;frameset&quot;
 
    &lt;dd&gt;
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-frameset&quot; title=&quot;insertion mode: in frameset&quot;&gt;in
-     frameset&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-frameset&quot;
+     title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag token whose tag name is one of: &quot;base&quot;, &quot;link&quot;, &quot;meta&quot;,
     &quot;script&quot;, &quot;style&quot;, &quot;title&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Push the node pointed to by the &lt;a href=&quot;#head-element&quot;&gt;&lt;code
      title=&quot;&quot;&gt;head&lt;/code&gt; element pointer&lt;/a&gt; onto the &lt;a href=&quot;#stack&quot;&gt;stack
      of open elements&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
     &lt;p&gt;Pop the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; (which will be the node
      pointed to by the &lt;a href=&quot;#head-element&quot;&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt;
@@ -42715,10 +42670,10 @@
      had been seen, and then reprocess the current token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-inbody&gt;&lt;span class=secno&gt;8.2.4.13. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-inbody&gt;&lt;span class=secno&gt;8.2.5.9. &lt;/span&gt;The &quot;&lt;dfn
    id=in-body title=&quot;insertion mode: in body&quot;&gt;in body&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#in-body&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-body&quot;
    title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;, tokens must be handled as
    follows:
 
@@ -42742,12 +42697,12 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. For each attribute on the token,
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. For each attribute on the token,
      check to see if the attribute is already present on the top element of
      the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;. If it is not, add the
      attribute and its corresponding value to that element.&lt;/p&gt;
@@ -42757,13 +42712,13 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;body&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;If the second element on the &lt;a href=&quot;#stack&quot;&gt;stack of open
      elements&lt;/a&gt; is not a &lt;code&gt;&lt;a href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt; element,
@@ -42791,7 +42746,7 @@
      href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt; element, the &lt;code&gt;&lt;a
      href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt; element, or the &lt;code&gt;&lt;a
      href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
     &lt;!-- (some of those are
     fragment cases) --&gt;
     &lt;p&gt;&lt;a href=&quot;#stops&quot;&gt;Stop parsing&lt;/a&gt;.&lt;/p&gt;
@@ -42801,7 +42756,7 @@
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;have a &lt;code&gt;body&lt;/code&gt;
-     element in scope&lt;/a&gt;, this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;;
+     element in scope&lt;/a&gt;, this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;;
      ignore the token.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, if there is a node in the &lt;a href=&quot;#stack&quot;&gt;stack of open
@@ -42816,12 +42771,12 @@
      href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt; element, the &lt;code&gt;&lt;a
      href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt; element, or the &lt;code&gt;&lt;a
      href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
     &lt;!-- (some of those are fragment cases) --&gt;
     &lt;!-- the insertion mode here is forcibly &quot;in body&quot;. --&gt;
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#after5&quot; title=&quot;insertion mode: after body&quot;&gt;after body&lt;/a&gt;&quot;.
-     Otherwise, ignore the token.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#after5&quot;
+     title=&quot;insertion mode: after body&quot;&gt;after body&lt;/a&gt;&quot;. Otherwise, ignore
+     the token.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;html&quot;
 
@@ -42879,7 +42834,7 @@
 
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#form-element&quot;&gt;&lt;code title=form&gt;form&lt;/code&gt; element
-     pointer&lt;/a&gt; is not null, ignore the token with a &lt;a href=&quot;#parse0&quot;&gt;parse
+     pointer&lt;/a&gt; is not null, ignore the token with a &lt;a href=&quot;#parse1&quot;&gt;parse
      error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
@@ -42913,7 +42868,7 @@
        element, then pop all the nodes from the &lt;a href=&quot;#current4&quot;&gt;current
        node&lt;/a&gt; up to &lt;var title=&quot;&quot;&gt;node&lt;/var&gt;, including &lt;var
        title=&quot;&quot;&gt;node&lt;/var&gt;, then stop this algorithm. If more than one node
-       is popped, then this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+       is popped, then this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
      &lt;li&gt;
       &lt;p&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is not in the &lt;a
@@ -42959,7 +42914,7 @@
        from the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; up to &lt;var
        title=&quot;&quot;&gt;node&lt;/var&gt;, including &lt;var title=&quot;&quot;&gt;node&lt;/var&gt;, then stop
        this algorithm. If more than one node is popped, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
      &lt;li&gt;
       &lt;p&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is not in the &lt;a
@@ -43010,7 +42965,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;have an element in
      scope&lt;/a&gt; with the same tag name as that of the token, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, run these steps:&lt;/p&gt;
 
@@ -43021,7 +42976,7 @@
      &lt;li&gt;
       &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not an element with
        the same tag name as that of the token, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
      &lt;li&gt;
       &lt;p&gt;Pop elements from the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;
@@ -43038,7 +42993,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;have an element in
      scope&lt;/a&gt; with the same tag name as that of the token, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, run these steps:&lt;/p&gt;
 
@@ -43049,7 +43004,7 @@
      &lt;li&gt;
       &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not an element with
        the same tag name as that of the token, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
      &lt;li&gt;
       &lt;p&gt;Pop elements from the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;
@@ -43061,7 +43016,7 @@
 
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not a &lt;code&gt;&lt;a
-     href=&quot;#p&quot;&gt;p&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a href=&quot;#parse0&quot;&gt;parse
+     href=&quot;#p&quot;&gt;p&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a href=&quot;#parse1&quot;&gt;parse
      error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; &lt;a href=&quot;#have-an&quot;
@@ -43079,7 +43034,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;have an element in
      scope&lt;/a&gt; with the same tag name as that of the token, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, run these steps:&lt;/p&gt;
 
@@ -43091,7 +43046,7 @@
      &lt;li&gt;
       &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not an element with
        the same tag name as that of the token, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
      &lt;li&gt;
       &lt;p&gt;Pop elements from the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;
@@ -43106,7 +43061,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;have an element in
      scope&lt;/a&gt; whose tag name is one of &quot;h1&quot;, &quot;h2&quot;, &quot;h3&quot;, &quot;h4&quot;, &quot;h5&quot;, or
-     &quot;h6&quot;, then this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+     &quot;h6&quot;, then this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
      &lt;!-- XXX quirk: Act as if
     a start tag with the tag name given in the token had been seen,
     then reprocess the current token. --&gt;&lt;/p&gt;
@@ -43120,7 +43075,7 @@
      &lt;li&gt;
       &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not an element with
        the same tag name as that of the token, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
      &lt;li&gt;
       &lt;p&gt;Pop elements from the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;
@@ -43139,7 +43094,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting elements&lt;/a&gt;
      contains an element whose tag name is &quot;a&quot; between the end of the list
      and the last marker on the list (or the start of the list if there is no
-     marker on the list), then this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;;
+     marker on the list), then this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;;
      act as if an end tag with the tag name &quot;a&quot; had been seen, then remove
      that element from the &lt;a href=&quot;#list-of4&quot;&gt;list of active formatting
      elements&lt;/a&gt; and the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; if the
@@ -43182,7 +43137,7 @@
 
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; &lt;a href=&quot;#have-an&quot;
      title=&quot;has an element in scope&quot;&gt;has a &lt;code&gt;nobr&lt;/code&gt; element in
-     scope&lt;/a&gt;, then this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Act as if
+     scope&lt;/a&gt;, then this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Act as if
      an end tag with the tag name &lt;code&gt;nobr&lt;/code&gt; had been seen, then once
      again &lt;a href=&quot;#reconstruct&quot;&gt;reconstruct the active formatting
      elements&lt;/a&gt;, if any.&lt;/p&gt;
@@ -43214,19 +43169,19 @@
       &lt;p&gt;If there is no such node, or, if that node is also in the &lt;a
        href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; but the element is not &lt;a
        href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;in scope&lt;/a&gt;, then
-       this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Abort these steps. The
+       this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Abort these steps. The
        token is ignored.&lt;/p&gt;
 
       &lt;p&gt;Otherwise, if there is such a node, but that node is not in the &lt;a
        href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;; remove the element from the list, and
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;; remove the element from the list, and
        abort these steps.&lt;/p&gt;
 
       &lt;p&gt;Otherwise, there is a &lt;var title=&quot;&quot;&gt;formatting element&lt;/var&gt; and
        that element is in &lt;a href=&quot;#stack&quot; title=&quot;stack of open elements&quot;&gt;the
        stack&lt;/a&gt; and is &lt;a href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;in
        scope&lt;/a&gt;. If the element is not the &lt;a href=&quot;#current4&quot;&gt;current
-       node&lt;/a&gt;, this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. In any case,
+       node&lt;/a&gt;, this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. In any case,
        proceed with the algorithm as written in the following steps.&lt;/p&gt;
 
      &lt;li&gt;
@@ -43370,7 +43325,7 @@
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; &lt;a href=&quot;#have-an&quot;
      title=&quot;has an element in scope&quot;&gt;has a &lt;code&gt;button&lt;/code&gt; element in
-     scope&lt;/a&gt;, then this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;; act as if
+     scope&lt;/a&gt;, then this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;; act as if
      an end tag with the tag name &quot;button&quot; had been seen, then reprocess the
      token.&lt;/p&gt;
 
@@ -43409,7 +43364,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an&quot; title=&quot;has an element in scope&quot;&gt;have an element in
      scope&lt;/a&gt; with the same tag name as that of the token, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, run these steps:&lt;/p&gt;
 
@@ -43420,7 +43375,7 @@
      &lt;li&gt;
       &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not an element with
        the same tag name as that of the token, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
      &lt;li&gt;
       &lt;p&gt;Pop elements from the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;
@@ -43449,8 +43404,8 @@
     &lt;!-- XXX quirks: don't do this --&gt;
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-table&quot;
+     title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;area&quot;, &quot;basefont&quot;, &quot;bgsound&quot;,
     &quot;br&quot;, &quot;embed&quot;, &quot;img&quot;, &quot;param&quot;, &quot;spacer&quot;, &quot;wbr&quot;
@@ -43478,7 +43433,7 @@
    &lt;dt&gt;A start tag whose tag name is &quot;image&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Change the token's tag name to
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Change the token's tag name to
      &quot;img&quot; and reprocess it. (Don't ask.)&lt;/p&gt;
     &lt;!-- As of
     2005-12, studies showed that around 0.2% of pages used the
@@ -43506,7 +43461,7 @@
    &lt;dt id=isindex&gt;A start tag whose tag name is &quot;isindex&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;If the &lt;a href=&quot;#form-element&quot;&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element
      pointer&lt;/a&gt; is not null, then ignore the token.&lt;/p&gt;
@@ -43599,7 +43554,7 @@
      switched back to the PCDATA state.&lt;/p&gt;
 
     &lt;p&gt;If the next token is an end tag token with the tag name &quot;textarea&quot;,
-     ignore it. Otherwise, this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     ignore it. Otherwise, this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;iframe&quot;, &quot;noembed&quot;, &quot;noframes&quot;
 
@@ -43623,23 +43578,22 @@
      pointed to by the &lt;a href=&quot;#form-element&quot;&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt;
      element pointer&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;If the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is one of &lt;a
-     href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;, &quot;&lt;a
-     href=&quot;#in-caption&quot; title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot;,
-     &quot;&lt;a href=&quot;#in-column&quot; title=&quot;insertion mode: in column group&quot;&gt;in column
+    &lt;p&gt;If the &lt;span&gt;insertion mode&lt;/span&gt; is one of &lt;a href=&quot;#in-table&quot;
+     title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-caption&quot;
+     title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot;, &quot;&lt;a
+     href=&quot;#in-column&quot; title=&quot;insertion mode: in column group&quot;&gt;in column
      group&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-table0&quot; title=&quot;insertion mode: in table
      body&quot;&gt;in table body&lt;/a&gt;&quot;, &quot;&lt;a href=&quot;#in-row&quot; title=&quot;insertion mode: in
      row&quot;&gt;in row&lt;/a&gt;&quot;, or &quot;&lt;a href=&quot;#in-cell&quot; title=&quot;insertion mode: in
-     cell&quot;&gt;in cell&lt;/a&gt;&quot;, then switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion
-     mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-select0&quot; title=&quot;insertion mode: in select in
-     table&quot;&gt;in select in table&lt;/a&gt;&quot;. Otherwise, switch the &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-select&quot;
-     title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot;.&lt;/p&gt;
+     cell&quot;&gt;in cell&lt;/a&gt;&quot;, then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
+     href=&quot;#in-select0&quot; title=&quot;insertion mode: in select in table&quot;&gt;in select
+     in table&lt;/a&gt;&quot;. Otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
+     href=&quot;#in-select&quot; title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;br&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if a start tag token with
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if a start tag token with
      the tag name &quot;br&quot; had been seen. Ignore the end tag token.&lt;/p&gt;
 
    &lt;dt&gt;A start or end tag whose tag name is one of: &quot;caption&quot;, &quot;col&quot;,
@@ -43656,7 +43610,7 @@
     href=&quot;#scripting2&quot;&gt;scripting is enabled&lt;/a&gt;:
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start or end tag whose tag name is one of: &quot;event-source&quot;,
     &quot;section&quot;, &quot;nav&quot;, &quot;article&quot;, &quot;aside&quot;, &quot;header&quot;, &quot;footer&quot;, &quot;datagrid&quot;,
@@ -43705,7 +43659,7 @@
        &lt;li&gt;
         &lt;p&gt;If the tag name of the end tag token does not match the tag name
          of the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt;, this is a &lt;a
-         href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.
+         href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.
 
        &lt;li&gt;
         &lt;p&gt;Pop all the nodes from the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; up
@@ -43717,7 +43671,7 @@
       &lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is in neither the &lt;a
        href=&quot;#formatting&quot;&gt;formatting&lt;/a&gt; category nor the &lt;a
        href=&quot;#phrasing1&quot;&gt;phrasing&lt;/a&gt; category, then this is a &lt;a
-       href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Stop this algorithm. The end tag token
+       href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Stop this algorithm. The end tag token
        is ignored.
 
      &lt;li&gt;
@@ -43729,13 +43683,13 @@
     &lt;/ol&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-intable&gt;&lt;span class=secno&gt;8.2.4.14. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-intable&gt;&lt;span class=secno&gt;8.2.5.10. &lt;/span&gt;The &quot;&lt;dfn
    id=in-table title=&quot;insertion mode: in table&quot;&gt;in table&lt;/dfn&gt;&quot; insertion
    mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;, tokens
-   must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-table&quot;
+   title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;, tokens must be handled as
+   follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;A character token that is one of one of U+0009 CHARACTER TABULATION,
@@ -43760,7 +43714,7 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;caption&quot;
 
@@ -43772,8 +43726,8 @@
      formatting elements&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token, then
-     switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-caption&quot; title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot;.&lt;/p&gt;
+     switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-caption&quot;
+     title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;colgroup&quot;
 
@@ -43782,9 +43736,8 @@
      below.)&lt;/p&gt;
 
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token, then
-     switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-column&quot; title=&quot;insertion mode: in column group&quot;&gt;in column
-     group&lt;/a&gt;&quot;.&lt;/p&gt;
+     switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-column&quot;
+     title=&quot;insertion mode: in column group&quot;&gt;in column group&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;col&quot;
 
@@ -43799,9 +43752,8 @@
      below.)&lt;/p&gt;
 
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token, then
-     switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-table0&quot; title=&quot;insertion mode: in table body&quot;&gt;in table
-     body&lt;/a&gt;&quot;.&lt;/p&gt;
+     switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-table0&quot;
+     title=&quot;insertion mode: in table body&quot;&gt;in table body&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;td&quot;, &quot;th&quot;, &quot;tr&quot;
 
@@ -43812,7 +43764,7 @@
    &lt;dt&gt;A start tag whose tag name is &quot;table&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag token with the
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag token with the
      tag name &quot;table&quot; had been seen, then, if that token wasn't ignored,
      reprocess the current token.&lt;/p&gt;
 
@@ -43825,7 +43777,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have an element
      in table scope&lt;/a&gt; with the same tag name as the token, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
@@ -43839,7 +43791,7 @@
     &quot;colgroup&quot;, &quot;html&quot;, &quot;tbody&quot;, &quot;td&quot;, &quot;tfoot&quot;, &quot;th&quot;, &quot;thead&quot;, &quot;tr&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;style&quot;, &quot;script&quot;
 
@@ -43849,8 +43801,8 @@
      entry below.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt;
-     the &quot;&lt;a href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     the &quot;&lt;a href=&quot;#in-head&quot; title=&quot;insertion mode: in head&quot;&gt;in head&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;input&quot;
 
@@ -43863,7 +43815,7 @@
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
 
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
 
@@ -43882,7 +43834,7 @@
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not the root &lt;code&gt;&lt;a
      href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error.&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error.&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p class=note&gt;It can only be the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; in
      the &lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;.&lt;/p&gt;
@@ -43892,10 +43844,10 @@
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Process the token &lt;a
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Process the token &lt;a
      href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a href=&quot;#in-body&quot;
-     title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;, with the following exception:&lt;/p&gt;
+     title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;span&gt;insertion
+     mode&lt;/span&gt;, with the following exception:&lt;/p&gt;
 
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is a &lt;code&gt;&lt;a
      href=&quot;#table&quot;&gt;table&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=&quot;#tbody&quot;&gt;tbody&lt;/a&gt;&lt;/code&gt;,
@@ -43948,13 +43900,13 @@
    href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element after this process is a &lt;a
    href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;.
 
-  &lt;h5 id=parsing-main-incaption&gt;&lt;span class=secno&gt;8.2.4.15. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-incaption&gt;&lt;span class=secno&gt;8.2.5.11. &lt;/span&gt;The &quot;&lt;dfn
    id=in-caption title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/dfn&gt;&quot;
    insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-caption&quot; title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot;,
-   tokens must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-caption&quot;
+   title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/a&gt;&quot;, tokens must be handled
+   as follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;An end tag whose tag name is &quot;caption&quot;
@@ -43963,7 +43915,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have an element
      in table scope&lt;/a&gt; with the same tag name as the token, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
@@ -43972,7 +43924,7 @@
 
     &lt;p&gt;Now, if the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not a &lt;code&gt;&lt;a
      href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Pop elements from this stack until a &lt;code&gt;&lt;a
      href=&quot;#caption0&quot;&gt;caption&lt;/a&gt;&lt;/code&gt; element has been popped from the
@@ -43981,8 +43933,8 @@
     &lt;p&gt;&lt;a href=&quot;#clear0&quot;&gt;Clear the list of active formatting elements up to
      the last marker&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-table&quot;
+     title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;caption&quot;, &quot;col&quot;, &quot;colgroup&quot;,
     &quot;tbody&quot;, &quot;td&quot;, &quot;tfoot&quot;, &quot;th&quot;, &quot;thead&quot;, &quot;tr&quot;
@@ -43990,7 +43942,7 @@
    &lt;dt&gt;An end tag whose tag name is &quot;table&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
      name &quot;caption&quot; had been seen, then, if that token wasn't ignored,
      reprocess the current token.&lt;/p&gt;
 
@@ -44001,23 +43953,23 @@
     &quot;html&quot;, &quot;tbody&quot;, &quot;td&quot;, &quot;tfoot&quot;, &quot;th&quot;, &quot;thead&quot;, &quot;tr&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-incolgroup&gt;&lt;span class=secno&gt;8.2.4.16. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-incolgroup&gt;&lt;span class=secno&gt;8.2.5.12. &lt;/span&gt;The &quot;&lt;dfn
    id=in-column title=&quot;insertion mode: in column group&quot;&gt;in column
    group&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-column&quot; title=&quot;insertion mode: in column group&quot;&gt;in column
-   group&lt;/a&gt;&quot;, tokens must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-column&quot;
+   title=&quot;insertion mode: in column group&quot;&gt;in column group&lt;/a&gt;&quot;, tokens must
+   be handled as follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;A character token that is one of one of U+0009 CHARACTER TABULATION,
@@ -44038,14 +43990,14 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;col&quot;
 
@@ -44059,19 +44011,19 @@
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is the root &lt;code&gt;&lt;a
      href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;, ignore the token. (&lt;a
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;, ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise, pop the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; (which will be
      a &lt;code&gt;&lt;a href=&quot;#colgroup&quot;&gt;colgroup&lt;/a&gt;&lt;/code&gt; element) from the &lt;a
-     href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;. Switch the &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-table&quot;
-     title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;.&lt;/p&gt;
+     href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;. Switch the &lt;span&gt;insertion
+     mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in
+     table&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;col&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;An end-of-file token
 
@@ -44092,13 +44044,13 @@
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-intbody&gt;&lt;span class=secno&gt;8.2.4.17. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-intbody&gt;&lt;span class=secno&gt;8.2.5.13. &lt;/span&gt;The &quot;&lt;dfn
    id=in-table0 title=&quot;insertion mode: in table body&quot;&gt;in table body&lt;/dfn&gt;&quot;
    insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-table0&quot; title=&quot;insertion mode: in table body&quot;&gt;in table
-   body&lt;/a&gt;&quot;, tokens must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-table0&quot;
+   title=&quot;insertion mode: in table body&quot;&gt;in table body&lt;/a&gt;&quot;, tokens must be
+   handled as follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;A start tag whose tag name is &quot;tr&quot;
@@ -44108,13 +44060,13 @@
      (See below.)&lt;/p&gt;
 
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token, then
-     switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-row&quot; title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot;.&lt;/p&gt;
+     switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-row&quot;
+     title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;th&quot;, &quot;td&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if a start tag with the tag
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if a start tag with the tag
      name &quot;tr&quot; had been seen, then reprocess the current token.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is one of: &quot;tbody&quot;, &quot;tfoot&quot;, &quot;thead&quot;
@@ -44123,7 +44075,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have an element
      in table scope&lt;/a&gt; with the same tag name as the token, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
 
@@ -44131,9 +44083,9 @@
      (See below.)&lt;/p&gt;
 
     &lt;p&gt;Pop the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; from the &lt;a
-     href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;. Switch the &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-table&quot;
-     title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;.&lt;/p&gt;
+     href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;. Switch the &lt;span&gt;insertion
+     mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in
+     table&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;caption&quot;, &quot;col&quot;, &quot;colgroup&quot;,
     &quot;tbody&quot;, &quot;tfoot&quot;, &quot;thead&quot;
@@ -44144,7 +44096,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have a
      &lt;code&gt;tbody&lt;/code&gt;, &lt;code&gt;thead&lt;/code&gt;, or &lt;code&gt;tfoot&lt;/code&gt; element in
-     table scope&lt;/a&gt;, this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Ignore the
+     table scope&lt;/a&gt;, this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Ignore the
      token. (&lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
@@ -44160,14 +44112,14 @@
     &quot;colgroup&quot;, &quot;html&quot;, &quot;td&quot;, &quot;th&quot;, &quot;tr&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
   &lt;/dl&gt;
 
   &lt;p&gt;When the steps above require the UA to &lt;dfn id=clear2&gt;clear the stack
@@ -44182,10 +44134,10 @@
    href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element after this process is a &lt;a
    href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;.
 
-  &lt;h5 id=parsing-main-intr&gt;&lt;span class=secno&gt;8.2.4.18. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-intr&gt;&lt;span class=secno&gt;8.2.5.14. &lt;/span&gt;The &quot;&lt;dfn
    id=in-row title=&quot;insertion mode: in row&quot;&gt;in row&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#in-row&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-row&quot;
    title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot;, tokens must be handled as
    follows:
 
@@ -44197,8 +44149,8 @@
      (See below.)&lt;/p&gt;
 
     &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token, then
-     switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-cell&quot; title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/a&gt;&quot;.&lt;/p&gt;
+     switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-cell&quot;
+     title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/a&gt;&quot;.&lt;/p&gt;
 
     &lt;p&gt;Insert a marker at the end of the &lt;a href=&quot;#list-of4&quot;&gt;list of active
      formatting elements&lt;/a&gt;.&lt;/p&gt;
@@ -44209,7 +44161,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have an element
      in table scope&lt;/a&gt; with the same tag name as the token, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
@@ -44219,8 +44171,8 @@
 
     &lt;p&gt;Pop the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; (which will be a &lt;code&gt;&lt;a
      href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt; element) from the &lt;a href=&quot;#stack&quot;&gt;stack of
-     open elements&lt;/a&gt;. Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;
-     to &quot;&lt;a href=&quot;#in-table0&quot; title=&quot;insertion mode: in table body&quot;&gt;in table
+     open elements&lt;/a&gt;. Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
+     href=&quot;#in-table0&quot; title=&quot;insertion mode: in table body&quot;&gt;in table
      body&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is one of: &quot;caption&quot;, &quot;col&quot;, &quot;colgroup&quot;,
@@ -44241,7 +44193,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have an element
      in table scope&lt;/a&gt; with the same tag name as the token, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, act as if an end tag with the tag name &quot;tr&quot; had been seen,
      then reprocess the current token.&lt;/p&gt;
@@ -44250,14 +44202,14 @@
     &quot;colgroup&quot;, &quot;html&quot;, &quot;td&quot;, &quot;th&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-table&quot; title=&quot;insertion mode: in table&quot;&gt;in table&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
   &lt;/dl&gt;
 
   &lt;p&gt;When the steps above require the UA to &lt;dfn id=clear3&gt;clear the stack
@@ -44271,10 +44223,10 @@
    href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element after this process is a &lt;a
    href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;.
 
-  &lt;h5 id=parsing-main-intd&gt;&lt;span class=secno&gt;8.2.4.19. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-intd&gt;&lt;span class=secno&gt;8.2.5.15. &lt;/span&gt;The &quot;&lt;dfn
    id=in-cell title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#in-cell&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-cell&quot;
    title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/a&gt;&quot;, tokens must be handled as
    follows:
 
@@ -44285,7 +44237,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have an element
      in table scope&lt;/a&gt; with the same tag name as that of the token, then
-     this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt; and the token must be
+     this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt; and the token must be
      ignored.&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
@@ -44294,7 +44246,7 @@
 
     &lt;p&gt;Now, if the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not an element
      with the same tag name as the token, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;Pop elements from this stack until an element with the same tag name
      as the token has been popped from the stack.&lt;/p&gt;
@@ -44302,8 +44254,8 @@
     &lt;p&gt;&lt;a href=&quot;#clear0&quot;&gt;Clear the list of active formatting elements up to
      the last marker&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#in-row&quot; title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot;. (The &lt;a
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-row&quot;
+     title=&quot;insertion mode: in row&quot;&gt;in row&lt;/a&gt;&quot;. (The &lt;a
      href=&quot;#current4&quot;&gt;current node&lt;/a&gt; will be a &lt;code&gt;&lt;a
      href=&quot;#tr&quot;&gt;tr&lt;/a&gt;&lt;/code&gt; element at this point.)&lt;/p&gt;
 
@@ -44314,7 +44266,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does &lt;em&gt;not&lt;/em&gt;
      &lt;a href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have a
      &lt;code&gt;td&lt;/code&gt; or &lt;code&gt;th&lt;/code&gt; element in table scope&lt;/a&gt;, then this
-     is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;; ignore the token. (&lt;a
+     is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;; ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise, &lt;a href=&quot;#close2&quot;&gt;close the cell&lt;/a&gt; (see below) and
@@ -44324,7 +44276,7 @@
     &quot;colgroup&quot;, &quot;html&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is one of: &quot;table&quot;, &quot;tbody&quot;, &quot;tfoot&quot;,
     &quot;thead&quot;, &quot;tr&quot;
@@ -44335,7 +44287,7 @@
      in table scope&lt;/a&gt; with the same tag name as that of the token (which
      can only happen for &quot;tbody&quot;, &quot;tfoot&quot; and &quot;thead&quot;, or, in the &lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;), then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt; and the token must be ignored.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt; and the token must be ignored.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, &lt;a href=&quot;#close2&quot;&gt;close the cell&lt;/a&gt; (see below) and
      reprocess the current token.&lt;/p&gt;
@@ -44344,8 +44296,8 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
   &lt;/dl&gt;
 
   &lt;p&gt;Where the steps above say to &lt;dfn id=close2&gt;close the cell&lt;/dfn&gt;, they
@@ -44369,16 +44321,16 @@
    both a &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; and a &lt;code&gt;&lt;a
    href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt; element &lt;a href=&quot;#have-an0&quot; title=&quot;has an element
    in table scope&quot;&gt;in table scope&lt;/a&gt; at the same time, nor can it have
-   neither when the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-cell&quot; title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/a&gt;&quot;.
+   neither when the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-cell&quot;
+   title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/a&gt;&quot;.
 
-  &lt;h5 id=parsing-main-inselect&gt;&lt;span class=secno&gt;8.2.4.20. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-inselect&gt;&lt;span class=secno&gt;8.2.5.16. &lt;/span&gt;The &quot;&lt;dfn
    id=in-select title=&quot;insertion mode: in select&quot;&gt;in select&lt;/dfn&gt;&quot; insertion
    mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-select&quot; title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot;, tokens
-   must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-select&quot;
+   title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot;, tokens must be handled
+   as follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;A character token
@@ -44397,14 +44349,14 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;option&quot;
 
@@ -44438,14 +44390,14 @@
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is an
      &lt;code&gt;optgroup&lt;/code&gt; element, then pop that node from the &lt;a
      href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;. Otherwise, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;, ignore the token.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;, ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;option&quot;
 
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is an &lt;code&gt;option&lt;/code&gt;
      element, then pop that node from the &lt;a href=&quot;#stack&quot;&gt;stack of open
-     elements&lt;/a&gt;. Otherwise, this is a &lt;a href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;,
+     elements&lt;/a&gt;. Otherwise, this is a &lt;a href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;,
      ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;select&quot;
@@ -44454,7 +44406,7 @@
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; does not &lt;a
      href=&quot;#have-an0&quot; title=&quot;has an element in table scope&quot;&gt;have an element
      in table scope&lt;/a&gt; with the same tag name as the token, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;. Ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise:&lt;/p&gt;
@@ -44467,13 +44419,13 @@
    &lt;dt&gt;A start tag whose tag name is &quot;select&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if the token had been an end
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if the token had been an end
      tag with the tag name &quot;select&quot; instead.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;input&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
      name &quot;select&quot; had been seen, and reprocess the token.&lt;/p&gt;
 
    &lt;dt&gt;An end-of-file token
@@ -44481,7 +44433,7 @@
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not the root &lt;code&gt;&lt;a
      href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error.&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error.&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p class=note&gt;It can only be the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; in
      the &lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;.&lt;/p&gt;
@@ -44491,30 +44443,30 @@
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-inselect&gt;&lt;span class=secno&gt;8.2.4.21. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-inselect&gt;&lt;span class=secno&gt;8.2.5.17. &lt;/span&gt;The &quot;&lt;dfn
    id=in-select0 title=&quot;insertion mode: in select in table&quot;&gt;in select in
    table&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-select0&quot; title=&quot;insertion mode: in select in table&quot;&gt;in select in
-   table&lt;/a&gt;&quot;, tokens must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-select0&quot;
+   title=&quot;insertion mode: in select in table&quot;&gt;in select in table&lt;/a&gt;&quot;, tokens
+   must be handled as follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;A start tag whose tag name is one of: &quot;caption&quot;, &quot;table&quot;, &quot;tbody&quot;,
     &quot;tfoot&quot;, &quot;thead&quot;, &quot;tr&quot;, &quot;td&quot;, &quot;th&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Act as if an end tag with the tag
      name &quot;select&quot; had been seen, and reprocess the token.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is one of: &quot;caption&quot;, &quot;table&quot;, &quot;tbody&quot;,
     &quot;tfoot&quot;, &quot;thead&quot;, &quot;tr&quot;, &quot;td&quot;, &quot;th&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; &lt;a
      href=&quot;#have-an0&quot;&gt;has an element in table scope&lt;/a&gt; with the same tag
@@ -44526,15 +44478,15 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-select&quot; title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-select&quot; title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-afterbody&gt;&lt;span class=secno&gt;8.2.4.22. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-afterbody&gt;&lt;span class=secno&gt;8.2.5.18. &lt;/span&gt;The &quot;&lt;dfn
    id=after5 title=&quot;insertion mode: after body&quot;&gt;after body&lt;/dfn&gt;&quot; insertion
    mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#after5&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#after5&quot;
    title=&quot;insertion mode: after body&quot;&gt;after body&lt;/a&gt;&quot;, tokens must be handled
    as follows:
 
@@ -44545,8 +44497,8 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A comment token
 
@@ -44560,24 +44512,24 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;If the parser was originally created as part of the &lt;a
      href=&quot;#html-fragment0&quot;&gt;HTML fragment parsing algorithm&lt;/a&gt;, this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;; ignore the token. (&lt;a
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;; ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
     &lt;!-- can only happen for &lt;html&gt;'s own innerHTML --&gt;
-    &lt;p&gt;Otherwise, switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
+    &lt;p&gt;Otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
      href=&quot;#after7&quot; title=&quot;insertion mode: after after body&quot;&gt;after after
      body&lt;/a&gt;&quot;.&lt;/p&gt;
 
@@ -44589,18 +44541,18 @@
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Switch the &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-body&quot;
-     title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; and reprocess the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Switch the &lt;span&gt;insertion
+     mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in
+     body&lt;/a&gt;&quot; and reprocess the token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-inframeset&gt;&lt;span class=secno&gt;8.2.4.23. &lt;/span&gt;The &quot;&lt;dfn
+  &lt;h5 id=parsing-main-inframeset&gt;&lt;span class=secno&gt;8.2.5.19. &lt;/span&gt;The &quot;&lt;dfn
    id=in-frameset title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/dfn&gt;&quot;
    insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a
-   href=&quot;#in-frameset&quot; title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot;,
-   tokens must be handled as follows:
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#in-frameset&quot;
+   title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot;, tokens must be
+   handled as follows:
 
   &lt;dl class=switch&gt;
    &lt;dt&gt;A character token that is one of one of U+0009 CHARACTER TABULATION,
@@ -44621,14 +44573,14 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;frameset&quot;
 
@@ -44640,7 +44592,7 @@
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is the root &lt;code&gt;&lt;a
      href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error&lt;/a&gt;; ignore the token. (&lt;a
+     href=&quot;#parse1&quot;&gt;parse error&lt;/a&gt;; ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
 
     &lt;p&gt;Otherwise, pop the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; from the &lt;a
@@ -44650,8 +44602,8 @@
      href=&quot;#html-fragment0&quot;&gt;HTML fragment parsing algorithm&lt;/a&gt; (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;), and the &lt;a href=&quot;#current4&quot;&gt;current
      node&lt;/a&gt; is no longer a &lt;code&gt;frameset&lt;/code&gt; element, then switch the
-     &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#after6&quot;
-     title=&quot;insertion mode: after frameset&quot;&gt;after frameset&lt;/a&gt;&quot;.&lt;/p&gt;
+     &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#after6&quot; title=&quot;insertion mode:
+     after frameset&quot;&gt;after frameset&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;frame&quot;
 
@@ -44664,15 +44616,15 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;An end-of-file token
 
    &lt;dd&gt;
     &lt;p&gt;If the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; is not the root &lt;code&gt;&lt;a
      href=&quot;#html&quot;&gt;html&lt;/a&gt;&lt;/code&gt; element, then this is a &lt;a
-     href=&quot;#parse0&quot;&gt;parse error.&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#parse1&quot;&gt;parse error.&lt;/a&gt;.&lt;/p&gt;
 
     &lt;p class=note&gt;It can only be the &lt;a href=&quot;#current4&quot;&gt;current node&lt;/a&gt; in
      the &lt;a href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;.&lt;/p&gt;
@@ -44682,14 +44634,14 @@
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=parsing-main-afterframeset&gt;&lt;span class=secno&gt;8.2.4.24. &lt;/span&gt;The
+  &lt;h5 id=parsing-main-afterframeset&gt;&lt;span class=secno&gt;8.2.5.20. &lt;/span&gt;The
    &quot;&lt;dfn id=after6 title=&quot;insertion mode: after frameset&quot;&gt;after
    frameset&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#after6&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#after6&quot;
    title=&quot;insertion mode: after frameset&quot;&gt;after frameset&lt;/a&gt;&quot;, tokens must be
    handled as follows:&lt;/p&gt;
   &lt;!-- due to rules in the &quot;in frameset&quot; mode, this can't be entered in the fragment case --&gt;
@@ -44713,7 +44665,7 @@
    &lt;dt&gt;A DOCTYPE token
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
 
    &lt;dt&gt;A start tag whose tag name is &quot;html&quot;
 
@@ -44721,15 +44673,14 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;An end tag whose tag name is &quot;html&quot;
 
    &lt;dd&gt;
-    &lt;p&gt;Switch the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a
-     href=&quot;#after8&quot; title=&quot;insertion mode: after after frameset&quot;&gt;after after
-     frameset&lt;/a&gt;&quot;.&lt;/p&gt;
+    &lt;p&gt;Switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a href=&quot;#after8&quot;
+     title=&quot;insertion mode: after after frameset&quot;&gt;after after frameset&lt;/a&gt;&quot;.&lt;/p&gt;
 
    &lt;dt&gt;An end-of-file token
 
@@ -44739,18 +44690,18 @@
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Ignore the token.&lt;/p&gt;
   &lt;/dl&gt;
 
   &lt;p class=big-issue&gt;This doesn't handle UAs that don't support frames, or
    that do support frames but want to show the NOFRAMES content. Supporting
    the former is easy; supporting the latter is harder.
 
-  &lt;h5 id=the-after0&gt;&lt;span class=secno&gt;8.2.4.25. &lt;/span&gt;The &quot;&lt;dfn id=after7
+  &lt;h5 id=the-after0&gt;&lt;span class=secno&gt;8.2.5.21. &lt;/span&gt;The &quot;&lt;dfn id=after7
    title=&quot;insertion mode: after after body&quot;&gt;after after body&lt;/dfn&gt;&quot; insertion
    mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#after7&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#after7&quot;
    title=&quot;insertion mode: after after body&quot;&gt;after after body&lt;/a&gt;&quot;, tokens
    must be handled as follows:
 
@@ -44772,8 +44723,8 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;An end-of-file token
 
@@ -44783,16 +44734,16 @@
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Switch the &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-body&quot;
-     title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; and reprocess the token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Switch the &lt;span&gt;insertion
+     mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in
+     body&lt;/a&gt;&quot; and reprocess the token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h5 id=the-after1&gt;&lt;span class=secno&gt;8.2.4.26. &lt;/span&gt;The &quot;&lt;dfn id=after8
+  &lt;h5 id=the-after1&gt;&lt;span class=secno&gt;8.2.5.22. &lt;/span&gt;The &quot;&lt;dfn id=after8
    title=&quot;insertion mode: after after frameset&quot;&gt;after after frameset&lt;/dfn&gt;&quot;
    insertion mode&lt;/h5&gt;
 
-  &lt;p&gt;When the &lt;a href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; is &quot;&lt;a href=&quot;#after8&quot;
+  &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;a href=&quot;#after8&quot;
    title=&quot;insertion mode: after after frameset&quot;&gt;after after frameset&lt;/a&gt;&quot;,
    tokens must be handled as follows:
 
@@ -44814,8 +44765,8 @@
 
    &lt;dd&gt;
     &lt;p&gt;Process the token &lt;a href=&quot;#using8&quot;&gt;using the rules for&lt;/a&gt; the &quot;&lt;a
-     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot; &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
+     href=&quot;#in-body&quot; title=&quot;insertion mode: in body&quot;&gt;in body&lt;/a&gt;&quot;
+     &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
 
    &lt;dt&gt;An end-of-file token
 
@@ -44825,13 +44776,12 @@
    &lt;dt&gt;Anything else
 
    &lt;dd&gt;
-    &lt;p&gt;&lt;a href=&quot;#parse0&quot;&gt;Parse error&lt;/a&gt;. Switch the &lt;a
-     href=&quot;#insertion0&quot;&gt;insertion mode&lt;/a&gt; to &quot;&lt;a href=&quot;#in-frameset&quot;
-     title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/a&gt;&quot; and reprocess the
-     token.&lt;/p&gt;
+    &lt;p&gt;&lt;a href=&quot;#parse1&quot;&gt;Parse error&lt;/a&gt;. Switch the &lt;span&gt;insertion
+     mode&lt;/span&gt; to &quot;&lt;a href=&quot;#in-frameset&quot; title=&quot;insertion mode: in
+     frameset&quot;&gt;in frameset&lt;/a&gt;&quot; and reprocess the token.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;h4 id=the-end&gt;&lt;span class=secno&gt;8.2.5 &lt;/span&gt;The end&lt;/h4&gt;
+  &lt;h4 id=the-end&gt;&lt;span class=secno&gt;8.2.6 &lt;/span&gt;The end&lt;/h4&gt;
 
   &lt;p&gt;Once the user agent &lt;dfn id=stops title=&quot;stop parsing&quot;&gt;stops
    parsing&lt;/dfn&gt; the document, the user agent must follow the steps in this

Modified: source
===================================================================
--- source	2008-04-05 10:50:19 UTC (rev 1402)
+++ source	2008-04-05 11:14:50 UTC (rev 1403)
@@ -37015,6 +37015,421 @@
 
 
 
+  &lt;h4&gt;Parse state&lt;/h4&gt;
+
+  &lt;h5&gt;The insertion mode&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;span
+  title=&quot;insertion mode: initial&quot;&gt;initial&lt;/span&gt;&quot;. It can change to
+  &quot;&lt;span title=&quot;insertion mode: before html&quot;&gt;before html&lt;/span&gt;&quot;,
+  &quot;&lt;span title=&quot;insertion mode: before head&quot;&gt;before head&lt;/span&gt;&quot;,
+  &quot;&lt;span title=&quot;insertion mode: in head&quot;&gt;in head&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in head noscript&quot;&gt;in head noscript&lt;/span&gt;&quot;,
+  &quot;&lt;span title=&quot;insertion mode: after head&quot;&gt;after head&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in table&quot;&gt;in table&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in column group&quot;&gt;in column group&lt;/span&gt;&quot;,
+  &quot;&lt;span title=&quot;insertion mode: in table body&quot;&gt;in table body&lt;/span&gt;&quot;,
+  &quot;&lt;span title=&quot;insertion mode: in row&quot;&gt;in row&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in select&quot;&gt;in select&lt;/span&gt;&quot;, &quot;&lt;span
+  title=&quot;insertion mode: in select in table&quot;&gt;in select in
+  table&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: after body&quot;&gt;after
+  body&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in frameset&quot;&gt;in
+  frameset&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: after
+  frameset&quot;&gt;after frameset&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode:
+  after after body&quot;&gt;after after body&lt;/span&gt;&quot;, and &quot;&lt;span
+  title=&quot;insertion mode: after after frameset&quot;&gt;after after
+  frameset&lt;/span&gt;&quot; during the course of the parsing, as described in
+  the &lt;span&gt;tree construction&lt;/span&gt; stage. The insertion mode affects
+  how tokens are processed and whether CDATA blocks are supported.&lt;/p&gt;
+
+  &lt;p&gt;Seven of these modes, namely &quot;&lt;span title=&quot;insertion mode: in
+  head&quot;&gt;in head&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in body&quot;&gt;in
+  body&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in table&quot;&gt;in
+  table&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in table body&quot;&gt;in table
+  body&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in row&quot;&gt;in row&lt;/span&gt;&quot;,
+  &quot;&lt;span title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/span&gt;&quot;, and &quot;&lt;span
+  title=&quot;insertion mode: in select&quot;&gt;in select&lt;/span&gt;&quot;, are special, in
+  that the other modes defer to them at various times. When the
+  algorithm below says that the user agent is to do something
+  &quot;&lt;dfn&gt;using the rules for&lt;/dfn&gt; the &lt;var title=&quot;&quot;&gt;m&lt;/var&gt; insertion
+  mode&quot;, where &lt;var title=&quot;&quot;&gt;m&lt;/var&gt; is one of these modes, the user
+  agent must use the rules described under that &lt;span&gt;insertion
+  mode&lt;/span&gt;'s section, but must leave the &lt;span&gt;insertion
+  mode&lt;/span&gt; unchanged (unless the rules in that section themselves
+  switch the &lt;span&gt;insertion mode&lt;/span&gt;).&lt;/p&gt;
+
+
+  &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;reset the insertion
+  mode appropriately&lt;/dfn&gt;, it means the UA must follow these
+  steps:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; be false.&lt;/li&gt;
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; be the last node in the
+   &lt;span&gt;stack of open elements&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the first node in the stack of
+   open elements, then set &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; to true; if, in
+   addition, the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element of the &lt;span&gt;HTML
+   fragment parsing algorithm&lt;/span&gt; is neither a &lt;code&gt;td&lt;/code&gt;
+   element nor a &lt;code&gt;th&lt;/code&gt; element, then set &lt;var
+   title=&quot;&quot;&gt;node&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt;
+   element. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;select&lt;/code&gt; element,
+   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: in select&quot;&gt;in select&lt;/span&gt;&quot; and abort these
+   steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;td&lt;/code&gt; or
+   &lt;code&gt;th&lt;/code&gt; element, then switch the &lt;span&gt;insertion
+   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in cell&quot;&gt;in
+   cell&lt;/span&gt;&quot; and abort these steps.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;tr&lt;/code&gt; element, then
+   switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion
+   mode: in row&quot;&gt;in row&lt;/span&gt;&quot; and abort these steps.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;tbody&lt;/code&gt;,
+   &lt;code&gt;thead&lt;/code&gt;, or &lt;code&gt;tfoot&lt;/code&gt; element, then switch the
+   &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in
+   table body&quot;&gt;in table body&lt;/span&gt;&quot; and abort these steps.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;caption&lt;/code&gt; element,
+   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/span&gt;&quot; and abort
+   these steps.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;colgroup&lt;/code&gt; element,
+   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: in column group&quot;&gt;in column group&lt;/span&gt;&quot; and
+   abort these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;table&lt;/code&gt; element,
+   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: in table&quot;&gt;in table&lt;/span&gt;&quot; and abort these
+   steps.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;head&lt;/code&gt; element,
+   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot; (&quot;&lt;span
+   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot;! &lt;em&gt; not &quot;&lt;span
+   title=&quot;insertion mode: in head&quot;&gt;in head&lt;/span&gt;&quot;&lt;/em&gt;!) and abort
+   these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt; &lt;!-- This is only
+   here for now in case people think that the spec accidentally
+   omitted it and try to &quot;fix&quot; it. Note that noscript-in-head is also
+   handled this way. This is all intentional. The only thing it
+   doesn't handle is the scripting-enabled fragment parsing case for a
+   &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
+   something other than a &lt;link&gt; or a &lt;style&gt; element; you'd expect
+   that to break out of the &lt;noscript&gt; but it doesn't. This is an edge
+   case that doesn't affect the spec, since the algorithm for fragment
+   parsing is only used for innerHTML, where we know scripting is
+   enabled. --&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;body&lt;/code&gt; element,
+   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot; and abort these
+   steps.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;frameset&lt;/code&gt; element,
+   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/span&gt;&quot; and abort
+   these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;html&lt;/code&gt; element,
+   then: if the &lt;span&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
+   pointer&lt;/span&gt; is null, switch the &lt;span&gt;insertion mode&lt;/span&gt; to
+   &quot;&lt;span title=&quot;insertion mode: before head&quot;&gt;before head&lt;/span&gt;&quot;,
+   otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
+   title=&quot;insertion mode: after head&quot;&gt;after head&lt;/span&gt;&quot;. In either
+   case, abort these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt; &lt;!-- XXX
+   can the head element pointer ever be non-null when we're going
+   through these steps? --&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; is true, then switch the
+   &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in
+   body&quot;&gt;in body&lt;/span&gt;&quot; and abort these steps. (&lt;span&gt;fragment
+   case&lt;/span&gt;)&lt;/li&gt;
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; now be the node before &lt;var
+   title=&quot;&quot;&gt;node&lt;/var&gt; in the &lt;span&gt;stack of open
+   elements&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;Return to step 3.&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+
+  &lt;h5&gt;The stack of open elements&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;dfn&gt;stack of open elements&lt;/dfn&gt; is empty. The
+  stack grows downwards; the topmost node on the stack is the first
+  one added to the stack, and the bottommost node of the stack is the
+  most recently added node in the stack (notwithstanding when the
+  stack is manipulated in a random access fashion as part of &lt;a
+  href=&quot;#adoptionAgency&quot;&gt;the handling for misnested tags&lt;/a&gt;).&lt;/p&gt;
+
+  &lt;p&gt;The &quot;&lt;span title=&quot;insertion mode: before html&quot;&gt;before
+  html&lt;/span&gt;&quot; &lt;span&gt;insertion mode&lt;/span&gt; creates the
+  &lt;code&gt;html&lt;/code&gt; root element node, which is then added to the
+  stack.&lt;/p&gt;
+
+  &lt;p&gt;In the &lt;span&gt;fragment case&lt;/span&gt;, the &lt;span&gt;stack of open
+  elements&lt;/span&gt; is initialised to contain an &lt;code&gt;html&lt;/code&gt;
+  element that is created as part of &lt;span title=&quot;html fragment
+  parsing algorithm&quot;&gt;that algorithm&lt;/span&gt;. (The &lt;span&gt;fragment
+  case&lt;/span&gt; skips the &quot;&lt;span title=&quot;insertion mode: before
+  html&quot;&gt;before html&lt;/span&gt;&quot; &lt;span&gt;insertion mode&lt;/span&gt;.)&lt;/p&gt;
+
+  &lt;p&gt;The &lt;code&gt;html&lt;/code&gt; node, however it is created, is the topmost
+  node of the stack. It never gets popped off the stack.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn&gt;current node&lt;/dfn&gt; is the bottommost node in this
+  stack.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn&gt;current table&lt;/dfn&gt; is the last &lt;code&gt;table&lt;/code&gt;
+  element in the &lt;span&gt;stack of open elements&lt;/span&gt;, if there is
+  one. If there is no &lt;code&gt;table&lt;/code&gt; element in the &lt;span&gt;stack of
+  open elements&lt;/span&gt; (&lt;span&gt;fragment case&lt;/span&gt;), then the
+  &lt;span&gt;current table&lt;/span&gt; is the first element in the &lt;span&gt;stack
+  of open elements&lt;/span&gt; (the &lt;code&gt;html&lt;/code&gt; element).&lt;/p&gt;
+
+  &lt;p&gt;Elements in the stack fall into the following categories:&lt;/p&gt;
+
+  &lt;dl&gt;
+
+   &lt;dt&gt;&lt;dfn&gt;Special&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt;&lt;p&gt;The following HTML elements have varying levels of special
+   parsing rules: &lt;code&gt;address&lt;/code&gt;, &lt;code&gt;area&lt;/code&gt;,
+   &lt;code&gt;base&lt;/code&gt;, &lt;code&gt;basefont&lt;/code&gt;, &lt;code&gt;bgsound&lt;/code&gt;,
+   &lt;code&gt;blockquote&lt;/code&gt;, &lt;code&gt;body&lt;/code&gt;, &lt;code&gt;br&lt;/code&gt;,
+   &lt;code&gt;center&lt;/code&gt;, &lt;code&gt;col&lt;/code&gt;, &lt;code&gt;colgroup&lt;/code&gt;,
+   &lt;code&gt;dd&lt;/code&gt;, &lt;code&gt;dir&lt;/code&gt;, &lt;code&gt;div&lt;/code&gt;,
+   &lt;code&gt;dl&lt;/code&gt;, &lt;code&gt;dt&lt;/code&gt;, &lt;code&gt;embed&lt;/code&gt;,
+   &lt;code&gt;fieldset&lt;/code&gt;, &lt;code&gt;form&lt;/code&gt;, &lt;code&gt;frame&lt;/code&gt;,
+   &lt;code&gt;frameset&lt;/code&gt;, &lt;code&gt;h1&lt;/code&gt;, &lt;code&gt;h2&lt;/code&gt;,
+   &lt;code&gt;h3&lt;/code&gt;, &lt;code&gt;h4&lt;/code&gt;, &lt;code&gt;h5&lt;/code&gt;, &lt;code&gt;h6&lt;/code&gt;,
+   &lt;code&gt;head&lt;/code&gt;, &lt;code&gt;hr&lt;/code&gt;, &lt;code&gt;iframe&lt;/code&gt;,
+   &lt;code&gt;image&lt;/code&gt;&lt;!-- XXX ? this isn't an element that can end up
+   on the stack--&gt;, &lt;code&gt;img&lt;/code&gt;, &lt;code&gt;input&lt;/code&gt;,
+   &lt;code&gt;isindex&lt;/code&gt;, &lt;code&gt;li&lt;/code&gt;, &lt;code&gt;link&lt;/code&gt;,
+   &lt;code&gt;listing&lt;/code&gt;, &lt;code&gt;menu&lt;/code&gt;, &lt;code&gt;meta&lt;/code&gt;,
+   &lt;code&gt;noembed&lt;/code&gt;, &lt;code&gt;noframes&lt;/code&gt;, &lt;code&gt;noscript&lt;/code&gt;,
+   &lt;code&gt;ol&lt;/code&gt;, &lt;code&gt;optgroup&lt;/code&gt;, &lt;code&gt;option&lt;/code&gt;,
+   &lt;code&gt;p&lt;/code&gt;, &lt;code&gt;param&lt;/code&gt;, &lt;code&gt;plaintext&lt;/code&gt;,
+   &lt;code&gt;pre&lt;/code&gt;, &lt;code&gt;script&lt;/code&gt;, &lt;code&gt;select&lt;/code&gt;,
+   &lt;code&gt;spacer&lt;/code&gt;, &lt;code&gt;style&lt;/code&gt;, &lt;code&gt;tbody&lt;/code&gt;,
+   &lt;code&gt;textarea&lt;/code&gt;, &lt;code&gt;tfoot&lt;/code&gt;, &lt;code&gt;thead&lt;/code&gt;,
+   &lt;code&gt;title&lt;/code&gt;, &lt;code&gt;tr&lt;/code&gt;, &lt;code&gt;ul&lt;/code&gt;, and
+   &lt;code&gt;wbr&lt;/code&gt;.&lt;/p&gt;&lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn&gt;Scoping&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt;&lt;p&gt;The following HTML elements introduce new &lt;span title=&quot;has
+   an element in scope&quot;&gt;scopes&lt;/span&gt; for various parts of the
+   parsing: &lt;code&gt;applet&lt;/code&gt;, &lt;code&gt;button&lt;/code&gt;,
+   &lt;code&gt;caption&lt;/code&gt;, &lt;code&gt;html&lt;/code&gt;, &lt;code&gt;marquee&lt;/code&gt;,
+   &lt;code&gt;object&lt;/code&gt;, &lt;code&gt;table&lt;/code&gt;, &lt;code&gt;td&lt;/code&gt; and
+   &lt;code&gt;th&lt;/code&gt;.&lt;/p&gt;&lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn&gt;Formatting&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt;&lt;p&gt;The following HTML elements are those that end up in the
+   &lt;span&gt;list of active formatting elements&lt;/span&gt;: &lt;code&gt;a&lt;/code&gt;,
+   &lt;code&gt;b&lt;/code&gt;, &lt;code&gt;big&lt;/code&gt;, &lt;code&gt;em&lt;/code&gt;,
+   &lt;code&gt;font&lt;/code&gt;, &lt;code&gt;i&lt;/code&gt;, &lt;code&gt;nobr&lt;/code&gt;,
+   &lt;code&gt;s&lt;/code&gt;, &lt;code&gt;small&lt;/code&gt;, &lt;code&gt;strike&lt;/code&gt;,
+   &lt;code&gt;strong&lt;/code&gt;, &lt;code&gt;tt&lt;/code&gt;, and &lt;code&gt;u&lt;/code&gt;.&lt;/p&gt;&lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn&gt;Phrasing&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt;&lt;p&gt;All other elements found while parsing an HTML
+   document.&lt;/p&gt;&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+  &lt;p class=&quot;big-issue&quot;&gt;Still need to add these new elements to the
+  lists: &lt;code&gt;event-source&lt;/code&gt;, &lt;code&gt;section&lt;/code&gt;,
+  &lt;code&gt;nav&lt;/code&gt;, &lt;code&gt;article&lt;/code&gt;, &lt;code&gt;aside&lt;/code&gt;,
+  &lt;code&gt;header&lt;/code&gt;, &lt;code&gt;footer&lt;/code&gt;, &lt;code&gt;datagrid&lt;/code&gt;,
+  &lt;code&gt;command&lt;/code&gt;&lt;/p&gt;
+
+  &lt;p&gt;The &lt;span&gt;stack of open elements&lt;/span&gt; is said to &lt;dfn
+  title=&quot;has an element in scope&quot;&gt;have an element in scope&lt;/dfn&gt; or
+  &lt;dfn title=&quot;has an element in table scope&quot;&gt;have an element in
+  &lt;em&gt;table scope&lt;/em&gt;&lt;/dfn&gt; when the following algorithm terminates
+  in a match state:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;Initialise &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to be the &lt;span&gt;current
+   node&lt;/span&gt; (the bottommost node of the stack).&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the target node, terminate in a match
+   state.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;table&lt;/code&gt;
+   element, terminate in a failure state.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Otherwise, if the algorithm is the &quot;has an element in scope&quot;
+   variant (rather than the &quot;has an element in table scope&quot; variant),
+   and &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is one of the following, terminate in a failure
+   state:&lt;/p&gt;
+    &lt;ul class=&quot;brief&quot;&gt;
+     &lt;li&gt;&lt;code&gt;applet&lt;/code&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;code&gt;caption&lt;/code&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;code&gt;td&lt;/code&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;code&gt;th&lt;/code&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;code&gt;button&lt;/code&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;code&gt;marquee&lt;/code&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;code&gt;object&lt;/code&gt;&lt;/li&gt;
+    &lt;/ul&gt;
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;html&lt;/code&gt;
+   element, terminate in a failure state. (This can only happen if the
+   &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the topmost node of the &lt;span&gt;stack of open
+   elements&lt;/span&gt;, and prevents the next step from being invoked if
+   there are no more elements in the stack.)&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Otherwise, set &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to the previous entry in the
+   &lt;span&gt;stack of open elements&lt;/span&gt; and return to step 2. (This
+   will never fail, since the loop will always terminate in the
+   previous step if the top of the stack is reached.)&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;p&gt;Nothing happens if at any time any of the elements in the
+  &lt;span&gt;stack of open elements&lt;/span&gt; are moved to a new location in,
+  or removed from, the &lt;code&gt;Document&lt;/code&gt; tree. In particular, the
+  stack is not changed in this situation. This can cause, amongst
+  other strange effects, content to be appended to nodes that are no
+  longer in the DOM.&lt;/p&gt;
+
+  &lt;p class=&quot;note&quot;&gt;In some cases (namely, when &lt;a
+  href=&quot;#adoptionAgency&quot;&gt;closing misnested formatting elements&lt;/a&gt;),
+  the stack is manipulated in a random-access fashion.&lt;/p&gt;
+
+
+  &lt;h5&gt;The list of active formatting elements&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;dfn&gt;list of active formatting elements&lt;/dfn&gt; is
+  empty. It is used to handle mis-nested &lt;span
+  title=&quot;formatting&quot;&gt;formatting element tags&lt;/span&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The list contains elements in the &lt;span&gt;formatting&lt;/span&gt;
+  category, and scope markers. The scope markers are inserted when
+  entering &lt;code&gt;applet&lt;/code&gt; elements, buttons, &lt;code&gt;object&lt;/code&gt;
+  elements, marquees, table cells, and table captions, and are used to
+  prevent formatting from &quot;leaking&quot; into &lt;code&gt;applet&lt;/code&gt; elements,
+  buttons, &lt;code&gt;object&lt;/code&gt; elements, marquees, and tables.&lt;/p&gt;
+
+  &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;reconstruct the
+  active formatting elements&lt;/dfn&gt;, the UA must perform the following
+  steps:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;If there are no entries in the &lt;span&gt;list of active formatting
+   elements&lt;/span&gt;, then there is nothing to reconstruct; stop this
+   algorithm.&lt;/li&gt;
+
+   &lt;li&gt;If the last (most recently added) entry in the &lt;span&gt;list of
+   active formatting elements&lt;/span&gt; is a marker, or if it is an
+   element that is in the &lt;span&gt;stack of open elements&lt;/span&gt;, then
+   there is nothing to reconstruct; stop this algorithm.&lt;/li&gt;
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added)
+   element in the &lt;span&gt;list of active formatting
+   elements&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;If there are no entries before &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the
+   &lt;span&gt;list of active formatting elements&lt;/span&gt;, then jump to step
+   8.&lt;/li&gt;
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the entry one earlier than
+   &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;span&gt;list of active formatting
+   elements&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; is neither a marker nor an element
+   that is also in the &lt;span&gt;stack of open elements&lt;/span&gt;, go to step
+   4.&lt;/li&gt;
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the element one later than
+   &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;span&gt;list of active formatting
+   elements&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;Perform a shallow clone of the element &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; to
+   obtain &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;. &lt;a
+   href=&quot;#refsDOM3CORE&quot;&gt;[DOM3CORE]&lt;/a&gt;&lt;/li&gt;
+
+   &lt;li&gt;Append &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; to the &lt;span&gt;current
+   node&lt;/span&gt; and push it onto the &lt;span&gt;stack of open
+   elements&lt;/span&gt; so that it is the new &lt;span&gt;current
+   node&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;Replace the entry for &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the list
+   with an entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;If the entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; in the &lt;span&gt;list of
+   active formatting elements&lt;/span&gt; is not the last entry in the
+   list, return to step 7.&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;p&gt;This has the effect of reopening all the formatting elements that
+  were opened in the current body, cell, or caption (whichever is
+  youngest) that haven't been explicitly closed.&lt;/p&gt;
+
+  &lt;p class=&quot;note&quot;&gt;The way this specification is written, the
+  &lt;span&gt;list of active formatting elements&lt;/span&gt; always consists of
+  elements in chronological order with the least recently added
+  element first and the most recently added element last (except for
+  while steps 8 to 11 of the above algorithm are being executed, of
+  course).&lt;/p&gt;
+
+  &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;clear the list of
+  active formatting elements up to the last marker&lt;/dfn&gt;, the UA must
+  perform the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added)
+   entry in the &lt;span&gt;list of active formatting elements&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;Remove &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; from the &lt;span&gt;list of active
+   formatting elements&lt;/span&gt;.&lt;/li&gt;
+
+   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; was a marker, then stop the
+   algorithm at this point. The list has been cleared up to the last
+   marker.&lt;/li&gt;
+
+   &lt;li&gt;Go to step 1.&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+
+  &lt;h5&gt;The element pointers&lt;/h5&gt;
+
+  &lt;p&gt;Initially the &lt;dfn&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
+  pointer&lt;/dfn&gt; and the &lt;dfn&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element
+  pointer&lt;/dfn&gt; are both null.&lt;/p&gt;
+
+  &lt;p&gt;Once a &lt;code&gt;head&lt;/code&gt; element has been parsed (whether
+  implicitly or explicitly) the &lt;span&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt;
+  element pointer&lt;/span&gt; gets set to point to this node.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;span&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element pointer&lt;/span&gt;
+  points to the last &lt;code&gt;form&lt;/code&gt; element that was opened and
+  whose end tag has not yet been seen. It is used to make form
+  controls associate with forms in the face of dramatically bad
+  markup, for historical reasons.&lt;/p&gt;
+
+
+
   &lt;h4&gt;&lt;dfn&gt;Tokenisation&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;Implementations must act as if they used the following state
@@ -38570,6 +38985,10 @@
   has to render the &lt;code&gt;Document&lt;/code&gt; so that it is available to
   the user, or when it has to begin accepting user input.&lt;/p&gt;
 
+  &lt;p&gt;As each token is emitted from the tokeniser, the user agent must
+  process the token according to the rules given in the section
+  corresponding to the current &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
+
   &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;insert a
   character&lt;/dfn&gt; into a node, if that node has a child immediately
   before where the character is to be inserted, and that child is a
@@ -38600,302 +39019,7 @@
   concerns&lt;/a&gt; will likely force user agents to impose nesting
   depths.&lt;/p&gt;
 
-  &lt;p&gt;As each token is emitted from the tokeniser, the user agent must
-  process the token according to the rules given in the section
-  corresponding to the current &lt;dfn&gt;insertion mode&lt;/dfn&gt;.&lt;/p&gt;
 
-  &lt;p&gt;Initially the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;span
-  title=&quot;insertion mode: initial&quot;&gt;initial&lt;/span&gt;&quot;. It can change to
-  &quot;&lt;span title=&quot;insertion mode: before html&quot;&gt;before html&lt;/span&gt;&quot;,
-  &quot;&lt;span title=&quot;insertion mode: before head&quot;&gt;before head&lt;/span&gt;&quot;,
-  &quot;&lt;span title=&quot;insertion mode: in head&quot;&gt;in head&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in head noscript&quot;&gt;in head noscript&lt;/span&gt;&quot;,
-  &quot;&lt;span title=&quot;insertion mode: after head&quot;&gt;after head&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in table&quot;&gt;in table&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in column group&quot;&gt;in column group&lt;/span&gt;&quot;,
-  &quot;&lt;span title=&quot;insertion mode: in table body&quot;&gt;in table body&lt;/span&gt;&quot;,
-  &quot;&lt;span title=&quot;insertion mode: in row&quot;&gt;in row&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in cell&quot;&gt;in cell&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in select&quot;&gt;in select&lt;/span&gt;&quot;, &quot;&lt;span
-  title=&quot;insertion mode: in select in table&quot;&gt;in select in
-  table&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: after body&quot;&gt;after
-  body&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in frameset&quot;&gt;in
-  frameset&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: after
-  frameset&quot;&gt;after frameset&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode:
-  after after body&quot;&gt;after after body&lt;/span&gt;&quot;, and &quot;&lt;span
-  title=&quot;insertion mode: after after frameset&quot;&gt;after after
-  frameset&lt;/span&gt;&quot; during the course of the parsing, as described
-  below. It affects how certain tokens are processed.&lt;/p&gt;
-
-  &lt;p&gt;Four of these modes, namely &quot;&lt;span title=&quot;insertion mode: in
-  head&quot;&gt;in head&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in body&quot;&gt;in
-  body&lt;/span&gt;&quot;, &quot;&lt;span title=&quot;insertion mode: in table&quot;&gt;in
-  table&lt;/span&gt;&quot;, and &quot;&lt;span title=&quot;insertion mode: in select&quot;&gt;in
-  select&lt;/span&gt;&quot;, are special, in that the other modes defer to them
-  at various times. When the algorithm below says that the user agent
-  is to do something &quot;&lt;dfn&gt;using the rules for&lt;/dfn&gt; the &lt;var
-  title=&quot;&quot;&gt;m&lt;/var&gt; insertion mode&quot;, where &lt;var title=&quot;&quot;&gt;m&lt;/var&gt; is one
-  of these modes, the user agent must use the rules described under
-  that &lt;span&gt;insertion mode&lt;/span&gt;'s section, but must leave the
-  &lt;span&gt;insertion mode&lt;/span&gt; unchanged (unless the rules in that
-  section themselves switch the &lt;span&gt;insertion mode&lt;/span&gt;).&lt;/p&gt;
-
-  &lt;p&gt;In addition to the &lt;span&gt;insertion mode&lt;/span&gt;, the tree
-  construction stage has several pieces of state: a &lt;span&gt;stack of
-  open elements&lt;/span&gt;, a &lt;span&gt;list of active formatting
-  elements&lt;/span&gt;, a &lt;span&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
-  pointer&lt;/span&gt;, and a &lt;span&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element
-  pointer&lt;/span&gt;.&lt;/p&gt;
-
-
-  &lt;h5&gt;The stack of open elements&lt;/h5&gt;
-
-  &lt;p&gt;Initially the &lt;dfn&gt;stack of open elements&lt;/dfn&gt; is empty. The
-  stack grows downwards; the topmost node on the stack is the first
-  one added to the stack, and the bottommost node of the stack is the
-  most recently added node in the stack (notwithstanding when the
-  stack is manipulated in a random access fashion as part of &lt;a
-  href=&quot;#adoptionAgency&quot;&gt;the handling for misnested tags&lt;/a&gt;).&lt;/p&gt;
-
-  &lt;p&gt;The &quot;&lt;span title=&quot;insertion mode: before html&quot;&gt;before
-  html&lt;/span&gt;&quot; &lt;span&gt;insertion mode&lt;/span&gt; creates the
-  &lt;code&gt;html&lt;/code&gt; root element node, which is then added to the
-  stack.&lt;/p&gt;
-
-  &lt;p&gt;In the &lt;span&gt;fragment case&lt;/span&gt;, the &lt;span&gt;stack of open
-  elements&lt;/span&gt; is initialised to contain an &lt;code&gt;html&lt;/code&gt;
-  element that is created as part of &lt;span title=&quot;html fragment
-  parsing algorithm&quot;&gt;that algorithm&lt;/span&gt;. (The &lt;span&gt;fragment
-  case&lt;/span&gt; skips the &quot;&lt;span title=&quot;insertion mode: before
-  html&quot;&gt;before html&lt;/span&gt;&quot; &lt;span&gt;insertion mode&lt;/span&gt;.)&lt;/p&gt;
-
-  &lt;p&gt;The &lt;code&gt;html&lt;/code&gt; node, however it is created, is the topmost
-  node of the stack. It never gets popped off the stack.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn&gt;current node&lt;/dfn&gt; is the bottommost node in this
-  stack.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;dfn&gt;current table&lt;/dfn&gt; is the last &lt;code&gt;table&lt;/code&gt;
-  element in the &lt;span&gt;stack of open elements&lt;/span&gt;, if there is
-  one. If there is no &lt;code&gt;table&lt;/code&gt; element in the &lt;span&gt;stack of
-  open elements&lt;/span&gt; (&lt;span&gt;fragment case&lt;/span&gt;), then the
-  &lt;span&gt;current table&lt;/span&gt; is the first element in the &lt;span&gt;stack
-  of open elements&lt;/span&gt; (the &lt;code&gt;html&lt;/code&gt; element).&lt;/p&gt;
-
-  &lt;p&gt;Elements in the stack fall into the following categories:&lt;/p&gt;
-
-  &lt;dl&gt;
-
-   &lt;dt&gt;&lt;dfn&gt;Special&lt;/dfn&gt;&lt;/dt&gt;
-   &lt;dd&gt;&lt;p&gt;The following HTML elements have varying levels of special
-   parsing rules: &lt;code&gt;address&lt;/code&gt;, &lt;code&gt;area&lt;/code&gt;,
-   &lt;code&gt;base&lt;/code&gt;, &lt;code&gt;basefont&lt;/code&gt;, &lt;code&gt;bgsound&lt;/code&gt;,
-   &lt;code&gt;blockquote&lt;/code&gt;, &lt;code&gt;body&lt;/code&gt;, &lt;code&gt;br&lt;/code&gt;,
-   &lt;code&gt;center&lt;/code&gt;, &lt;code&gt;col&lt;/code&gt;, &lt;code&gt;colgroup&lt;/code&gt;,
-   &lt;code&gt;dd&lt;/code&gt;, &lt;code&gt;dir&lt;/code&gt;, &lt;code&gt;div&lt;/code&gt;,
-   &lt;code&gt;dl&lt;/code&gt;, &lt;code&gt;dt&lt;/code&gt;, &lt;code&gt;embed&lt;/code&gt;,
-   &lt;code&gt;fieldset&lt;/code&gt;, &lt;code&gt;form&lt;/code&gt;, &lt;code&gt;frame&lt;/code&gt;,
-   &lt;code&gt;frameset&lt;/code&gt;, &lt;code&gt;h1&lt;/code&gt;, &lt;code&gt;h2&lt;/code&gt;,
-   &lt;code&gt;h3&lt;/code&gt;, &lt;code&gt;h4&lt;/code&gt;, &lt;code&gt;h5&lt;/code&gt;, &lt;code&gt;h6&lt;/code&gt;,
-   &lt;code&gt;head&lt;/code&gt;, &lt;code&gt;hr&lt;/code&gt;, &lt;code&gt;iframe&lt;/code&gt;,
-   &lt;code&gt;image&lt;/code&gt;&lt;!-- XXX ? this isn't an element that can end up
-   on the stack--&gt;, &lt;code&gt;img&lt;/code&gt;, &lt;code&gt;input&lt;/code&gt;,
-   &lt;code&gt;isindex&lt;/code&gt;, &lt;code&gt;li&lt;/code&gt;, &lt;code&gt;link&lt;/code&gt;,
-   &lt;code&gt;listing&lt;/code&gt;, &lt;code&gt;menu&lt;/code&gt;, &lt;code&gt;meta&lt;/code&gt;,
-   &lt;code&gt;noembed&lt;/code&gt;, &lt;code&gt;noframes&lt;/code&gt;, &lt;code&gt;noscript&lt;/code&gt;,
-   &lt;code&gt;ol&lt;/code&gt;, &lt;code&gt;optgroup&lt;/code&gt;, &lt;code&gt;option&lt;/code&gt;,
-   &lt;code&gt;p&lt;/code&gt;, &lt;code&gt;param&lt;/code&gt;, &lt;code&gt;plaintext&lt;/code&gt;,
-   &lt;code&gt;pre&lt;/code&gt;, &lt;code&gt;script&lt;/code&gt;, &lt;code&gt;select&lt;/code&gt;,
-   &lt;code&gt;spacer&lt;/code&gt;, &lt;code&gt;style&lt;/code&gt;, &lt;code&gt;tbody&lt;/code&gt;,
-   &lt;code&gt;textarea&lt;/code&gt;, &lt;code&gt;tfoot&lt;/code&gt;, &lt;code&gt;thead&lt;/code&gt;,
-   &lt;code&gt;title&lt;/code&gt;, &lt;code&gt;tr&lt;/code&gt;, &lt;code&gt;ul&lt;/code&gt;, and
-   &lt;code&gt;wbr&lt;/code&gt;.&lt;/p&gt;&lt;/dd&gt;
-
-   &lt;dt&gt;&lt;dfn&gt;Scoping&lt;/dfn&gt;&lt;/dt&gt;
-   &lt;dd&gt;&lt;p&gt;The following HTML elements introduce new &lt;span title=&quot;has
-   an element in scope&quot;&gt;scopes&lt;/span&gt; for various parts of the
-   parsing: &lt;code&gt;applet&lt;/code&gt;, &lt;code&gt;button&lt;/code&gt;,
-   &lt;code&gt;caption&lt;/code&gt;, &lt;code&gt;html&lt;/code&gt;, &lt;code&gt;marquee&lt;/code&gt;,
-   &lt;code&gt;object&lt;/code&gt;, &lt;code&gt;table&lt;/code&gt;, &lt;code&gt;td&lt;/code&gt; and
-   &lt;code&gt;th&lt;/code&gt;.&lt;/p&gt;&lt;/dd&gt;
-
-   &lt;dt&gt;&lt;dfn&gt;Formatting&lt;/dfn&gt;&lt;/dt&gt;
-   &lt;dd&gt;&lt;p&gt;The following HTML elements are those that end up in the
-   &lt;span&gt;list of active formatting elements&lt;/span&gt;: &lt;code&gt;a&lt;/code&gt;,
-   &lt;code&gt;b&lt;/code&gt;, &lt;code&gt;big&lt;/code&gt;, &lt;code&gt;em&lt;/code&gt;,
-   &lt;code&gt;font&lt;/code&gt;, &lt;code&gt;i&lt;/code&gt;, &lt;code&gt;nobr&lt;/code&gt;,
-   &lt;code&gt;s&lt;/code&gt;, &lt;code&gt;small&lt;/code&gt;, &lt;code&gt;strike&lt;/code&gt;,
-   &lt;code&gt;strong&lt;/code&gt;, &lt;code&gt;tt&lt;/code&gt;, and &lt;code&gt;u&lt;/code&gt;.&lt;/p&gt;&lt;/dd&gt;
-
-   &lt;dt&gt;&lt;dfn&gt;Phrasing&lt;/dfn&gt;&lt;/dt&gt;
-   &lt;dd&gt;&lt;p&gt;All other elements found while parsing an HTML
-   document.&lt;/p&gt;&lt;/dd&gt;
-
-  &lt;/dl&gt;
-
-  &lt;p class=&quot;big-issue&quot;&gt;Still need to add these new elements to the
-  lists: &lt;code&gt;event-source&lt;/code&gt;, &lt;code&gt;section&lt;/code&gt;,
-  &lt;code&gt;nav&lt;/code&gt;, &lt;code&gt;article&lt;/code&gt;, &lt;code&gt;aside&lt;/code&gt;,
-  &lt;code&gt;header&lt;/code&gt;, &lt;code&gt;footer&lt;/code&gt;, &lt;code&gt;datagrid&lt;/code&gt;,
-  &lt;code&gt;command&lt;/code&gt;&lt;/p&gt;
-
-  &lt;p&gt;The &lt;span&gt;stack of open elements&lt;/span&gt; is said to &lt;dfn
-  title=&quot;has an element in scope&quot;&gt;have an element in scope&lt;/dfn&gt; or
-  &lt;dfn title=&quot;has an element in table scope&quot;&gt;have an element in
-  &lt;em&gt;table scope&lt;/em&gt;&lt;/dfn&gt; when the following algorithm terminates
-  in a match state:&lt;/p&gt;
-
-  &lt;ol&gt;
-
-   &lt;li&gt;&lt;p&gt;Initialise &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to be the &lt;span&gt;current
-   node&lt;/span&gt; (the bottommost node of the stack).&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the target node, terminate in a match
-   state.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;table&lt;/code&gt;
-   element, terminate in a failure state.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the algorithm is the &quot;has an element in scope&quot;
-   variant (rather than the &quot;has an element in table scope&quot; variant),
-   and &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is one of the following, terminate in a failure
-   state:&lt;/p&gt;
-    &lt;ul class=&quot;brief&quot;&gt;
-     &lt;li&gt;&lt;code&gt;applet&lt;/code&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;code&gt;caption&lt;/code&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;code&gt;td&lt;/code&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;code&gt;th&lt;/code&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;code&gt;button&lt;/code&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;code&gt;marquee&lt;/code&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;code&gt;object&lt;/code&gt;&lt;/li&gt;
-    &lt;/ul&gt;
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;html&lt;/code&gt;
-   element, terminate in a failure state. (This can only happen if the
-   &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the topmost node of the &lt;span&gt;stack of open
-   elements&lt;/span&gt;, and prevents the next step from being invoked if
-   there are no more elements in the stack.)&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, set &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; to the previous entry in the
-   &lt;span&gt;stack of open elements&lt;/span&gt; and return to step 2. (This
-   will never fail, since the loop will always terminate in the
-   previous step if the top of the stack is reached.)&lt;/p&gt;&lt;/li&gt;
-
-  &lt;/ol&gt;
-
-  &lt;p&gt;Nothing happens if at any time any of the elements in the
-  &lt;span&gt;stack of open elements&lt;/span&gt; are moved to a new location in,
-  or removed from, the &lt;code&gt;Document&lt;/code&gt; tree. In particular, the
-  stack is not changed in this situation. This can cause, amongst
-  other strange effects, content to be appended to nodes that are no
-  longer in the DOM.&lt;/p&gt;
-
-  &lt;p class=&quot;note&quot;&gt;In some cases (namely, when &lt;a
-  href=&quot;#adoptionAgency&quot;&gt;closing misnested formatting elements&lt;/a&gt;),
-  the stack is manipulated in a random-access fashion.&lt;/p&gt;
-
-
-  &lt;h5&gt;The list of active formatting elements&lt;/h5&gt;
-
-  &lt;p&gt;Initially the &lt;dfn&gt;list of active formatting elements&lt;/dfn&gt; is
-  empty. It is used to handle mis-nested &lt;span
-  title=&quot;formatting&quot;&gt;formatting element tags&lt;/span&gt;.&lt;/p&gt;
-
-  &lt;p&gt;The list contains elements in the &lt;span&gt;formatting&lt;/span&gt;
-  category, and scope markers. The scope markers are inserted when
-  entering &lt;code&gt;applet&lt;/code&gt; elements, buttons, &lt;code&gt;object&lt;/code&gt;
-  elements, marquees, table cells, and table captions, and are used to
-  prevent formatting from &quot;leaking&quot; into &lt;code&gt;applet&lt;/code&gt; elements,
-  buttons, &lt;code&gt;object&lt;/code&gt; elements, marquees, and tables.&lt;/p&gt;
-
-  &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;reconstruct the
-  active formatting elements&lt;/dfn&gt;, the UA must perform the following
-  steps:&lt;/p&gt;
-
-  &lt;ol&gt;
-
-   &lt;li&gt;If there are no entries in the &lt;span&gt;list of active formatting
-   elements&lt;/span&gt;, then there is nothing to reconstruct; stop this
-   algorithm.&lt;/li&gt;
-
-   &lt;li&gt;If the last (most recently added) entry in the &lt;span&gt;list of
-   active formatting elements&lt;/span&gt; is a marker, or if it is an
-   element that is in the &lt;span&gt;stack of open elements&lt;/span&gt;, then
-   there is nothing to reconstruct; stop this algorithm.&lt;/li&gt;
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added)
-   element in the &lt;span&gt;list of active formatting
-   elements&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;If there are no entries before &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the
-   &lt;span&gt;list of active formatting elements&lt;/span&gt;, then jump to step
-   8.&lt;/li&gt;
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the entry one earlier than
-   &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;span&gt;list of active formatting
-   elements&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; is neither a marker nor an element
-   that is also in the &lt;span&gt;stack of open elements&lt;/span&gt;, go to step
-   4.&lt;/li&gt;
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the element one later than
-   &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the &lt;span&gt;list of active formatting
-   elements&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;Perform a shallow clone of the element &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; to
-   obtain &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;. &lt;a
-   href=&quot;#refsDOM3CORE&quot;&gt;[DOM3CORE]&lt;/a&gt;&lt;/li&gt;
-
-   &lt;li&gt;Append &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; to the &lt;span&gt;current
-   node&lt;/span&gt; and push it onto the &lt;span&gt;stack of open
-   elements&lt;/span&gt; so that it is the new &lt;span&gt;current
-   node&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;Replace the entry for &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; in the list
-   with an entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt;.&lt;/li&gt;
-
-   &lt;li&gt;If the entry for &lt;var title=&quot;&quot;&gt;clone&lt;/var&gt; in the &lt;span&gt;list of
-   active formatting elements&lt;/span&gt; is not the last entry in the
-   list, return to step 7.&lt;/li&gt;
-
-  &lt;/ol&gt;
-
-  &lt;p&gt;This has the effect of reopening all the formatting elements that
-  were opened in the current body, cell, or caption (whichever is
-  youngest) that haven't been explicitly closed.&lt;/p&gt;
-
-  &lt;p class=&quot;note&quot;&gt;The way this specification is written, the
-  &lt;span&gt;list of active formatting elements&lt;/span&gt; always consists of
-  elements in chronological order with the least recently added
-  element first and the most recently added element last (except for
-  while steps 8 to 11 of the above algorithm are being executed, of
-  course).&lt;/p&gt;
-
-  &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;clear the list of
-  active formatting elements up to the last marker&lt;/dfn&gt;, the UA must
-  perform the following steps:&lt;/p&gt;
-
-  &lt;ol&gt;
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; be the last (most recently added)
-   entry in the &lt;span&gt;list of active formatting elements&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;Remove &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; from the &lt;span&gt;list of active
-   formatting elements&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;entry&lt;/var&gt; was a marker, then stop the
-   algorithm at this point. The list has been cleared up to the last
-   marker.&lt;/li&gt;
-
-   &lt;li&gt;Go to step 1.&lt;/li&gt;
-
-  &lt;/ol&gt;
-
-
   &lt;h5&gt;Creating and inserting HTML elements&lt;/h5&gt;
 
   &lt;p&gt;When the steps below require the UA to &lt;dfn title=&quot;create an
@@ -38977,173 +39101,6 @@
   above steps as if that element was not in the above list.&lt;/p&gt;
 
 
-  &lt;h5&gt;The element pointers&lt;/h5&gt;
-
-  &lt;p&gt;Initially the &lt;dfn&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
-  pointer&lt;/dfn&gt; and the &lt;dfn&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element
-  pointer&lt;/dfn&gt; are both null.&lt;/p&gt;
-
-  &lt;p&gt;Once a &lt;code&gt;head&lt;/code&gt; element has been parsed (whether
-  implicitly or explicitly) the &lt;span&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt;
-  element pointer&lt;/span&gt; gets set to point to this node.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;span&gt;&lt;code title=&quot;&quot;&gt;form&lt;/code&gt; element pointer&lt;/span&gt;
-  points to the last &lt;code&gt;form&lt;/code&gt; element that was opened and
-  whose end tag has not yet been seen. It is used to make form
-  controls associate with forms in the face of dramatically bad
-  markup, for historical reasons.&lt;/p&gt;
-
-
-  &lt;h5&gt;Resetting the insertion mode&lt;/h5&gt;
-
-  &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;reset the insertion
-  mode appropriately&lt;/dfn&gt;, it means the UA must follow these
-  steps:&lt;/p&gt;
-
-  &lt;ol&gt;
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; be false.&lt;/li&gt;
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; be the last node in the
-   &lt;span&gt;stack of open elements&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is the first node in the stack of
-   open elements, then set &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; to true; if, in
-   addition, the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element of the &lt;span&gt;HTML
-   fragment parsing algorithm&lt;/span&gt; is neither a &lt;code&gt;td&lt;/code&gt;
-   element nor a &lt;code&gt;th&lt;/code&gt; element, then set &lt;var
-   title=&quot;&quot;&gt;node&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt;
-   element. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;select&lt;/code&gt; element,
-   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in select&quot;&gt;in select&lt;/span&gt;&quot; and abort these
-   steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;td&lt;/code&gt; or
-   &lt;code&gt;th&lt;/code&gt; element, then switch the &lt;span&gt;insertion
-   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in cell&quot;&gt;in
-   cell&lt;/span&gt;&quot; and abort these steps.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;tr&lt;/code&gt; element, then
-   switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion
-   mode: in row&quot;&gt;in row&lt;/span&gt;&quot; and abort these steps.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;tbody&lt;/code&gt;,
-   &lt;code&gt;thead&lt;/code&gt;, or &lt;code&gt;tfoot&lt;/code&gt; element, then switch the
-   &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in
-   table body&quot;&gt;in table body&lt;/span&gt;&quot; and abort these steps.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;caption&lt;/code&gt; element,
-   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in caption&quot;&gt;in caption&lt;/span&gt;&quot; and abort
-   these steps.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;colgroup&lt;/code&gt; element,
-   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in column group&quot;&gt;in column group&lt;/span&gt;&quot; and
-   abort these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;table&lt;/code&gt; element,
-   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in table&quot;&gt;in table&lt;/span&gt;&quot; and abort these
-   steps.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;head&lt;/code&gt; element,
-   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot; (&quot;&lt;span
-   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot;! &lt;em&gt; not &quot;&lt;span
-   title=&quot;insertion mode: in head&quot;&gt;in head&lt;/span&gt;&quot;&lt;/em&gt;!) and abort
-   these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt; &lt;!-- This is only
-   here for now in case people think that the spec accidentally
-   omitted it and try to &quot;fix&quot; it. Note that noscript-in-head is also
-   handled this way. This is all intentional. The only thing it
-   doesn't handle is the scripting-enabled fragment parsing case for a
-   &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
-   something other than a &lt;link&gt; or a &lt;style&gt; element; you'd expect
-   that to break out of the &lt;noscript&gt; but it doesn't. This is an edge
-   case that doesn't affect the spec, since the algorithm for fragment
-   parsing is only used for innerHTML, where we know scripting is
-   enabled. --&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;body&lt;/code&gt; element,
-   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot; and abort these
-   steps.&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;frameset&lt;/code&gt; element,
-   then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in frameset&quot;&gt;in frameset&lt;/span&gt;&quot; and abort
-   these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is an &lt;code&gt;html&lt;/code&gt; element,
-   then: if the &lt;span&gt;&lt;code title=&quot;&quot;&gt;head&lt;/code&gt; element
-   pointer&lt;/span&gt; is null, switch the &lt;span&gt;insertion mode&lt;/span&gt; to
-   &quot;&lt;span title=&quot;insertion mode: before head&quot;&gt;before head&lt;/span&gt;&quot;,
-   otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: after head&quot;&gt;after head&lt;/span&gt;&quot;. In either
-   case, abort these steps. (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/li&gt; &lt;!-- XXX
-   can the head element pointer ever be non-null when we're going
-   through these steps? --&gt;
-
-   &lt;li&gt;If &lt;var title=&quot;&quot;&gt;last&lt;/var&gt; is true, then switch the
-   &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in
-   body&quot;&gt;in body&lt;/span&gt;&quot; and abort these steps. (&lt;span&gt;fragment
-   case&lt;/span&gt;)&lt;/li&gt;
-
-   &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; now be the node before &lt;var
-   title=&quot;&quot;&gt;node&lt;/var&gt; in the &lt;span&gt;stack of open
-   elements&lt;/span&gt;.&lt;/li&gt;
-
-   &lt;li&gt;Return to step 3.&lt;/li&gt;
-
-  &lt;/ol&gt;
-
-&lt;!--When you don't have to handle the fragment case, you can use this
-simplified explanation instead:
-
-  &lt;ol&gt;
-
-   &lt;li&gt;&lt;p&gt;If the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span title=&quot;has
-   an element in table scope&quot;&gt;has a &lt;code&gt;td&lt;/code&gt; or &lt;code&gt;th&lt;/code&gt;
-   element in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion
-   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in cell&quot;&gt;in
-   cell&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;tr&lt;/code&gt; element
-   in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion mode&lt;/span&gt;
-   to &quot;&lt;span title=&quot;insertion mode: in row&quot;&gt;in row&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;tbody&lt;/code&gt;,
-   &lt;code&gt;tfoot&lt;/code&gt;, or &lt;code&gt;thead&lt;/code&gt; element in table
-   scope&lt;/span&gt;, then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in table body&quot;&gt;in table
-   body&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;caption&lt;/code&gt;
-   element in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion
-   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in caption&quot;&gt;in
-   caption&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   ( you can't reach this point with a colgroup element on the
-   stack )
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span
-   title=&quot;has an element in table scope&quot;&gt;has a &lt;code&gt;table&lt;/code&gt;
-   element in table scope&lt;/span&gt;, then switch the &lt;span&gt;insertion
-   mode&lt;/span&gt; to &quot;&lt;span title=&quot;insertion mode: in table&quot;&gt;in
-   table&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
-   title=&quot;insertion mode: in body&quot;&gt;in body&lt;/span&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
-
-  &lt;/ol&gt;
---&gt;
-
-
   &lt;h5&gt;The &quot;&lt;dfn title=&quot;insertion mode: initial&quot;&gt;initial&lt;/dfn&gt;&quot; insertion mode&lt;/h5&gt;
 
   &lt;p&gt;When the &lt;span&gt;insertion mode&lt;/span&gt; is &quot;&lt;span title=&quot;insertion


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008304.html">[html5] r1402 - /
</A></li>
	<LI>Next message: <A HREF="008306.html">[html5] r1404 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8305">[ date ]</a>
              <a href="thread.html#8305">[ thread ]</a>
              <a href="subject.html#8305">[ subject ]</a>
              <a href="author.html#8305">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
