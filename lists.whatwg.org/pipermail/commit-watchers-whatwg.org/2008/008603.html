<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r1704 - /
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1704%20-%20/&In-Reply-To=%3C20080526101210.EB8F9152F95%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008602.html">
   <LINK REL="Next"  HREF="008604.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r1704 - /</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1704%20-%20/&In-Reply-To=%3C20080526101210.EB8F9152F95%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r1704 - /">whatwg at whatwg.org
       </A><BR>
    <I>Mon May 26 03:12:10 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008602.html">[html5] r1703 - /
</A></li>
        <LI>Next message: <A HREF="008604.html">[html5] r1705 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8603">[ date ]</a>
              <a href="thread.html#8603">[ thread ]</a>
              <a href="subject.html#8603">[ subject ]</a>
              <a href="author.html#8603">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-05-26 03:12:10 -0700 (Mon, 26 May 2008)
New Revision: 1704

Modified:
   index
   source
Log:
[cit] (2) &lt;ruby&gt; support. This isn't very compatible with IE, but it seems to be relatively compatible with the Web's usage of ruby.

Modified: index
===================================================================
--- index	2008-05-25 09:17:08 UTC (rev 1703)
+++ index	2008-05-26 10:12:10 UTC (rev 1704)
@@ -25,7 +25,7 @@
 
    &lt;h1 id=html-5&gt;HTML 5&lt;/h1&gt;
 
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft&gt;Draft Recommendation &mdash; 25 May
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft&gt;Draft Recommendation &mdash; 26 May
     2008&lt;/h2&gt;
 
    &lt;p&gt;You can take part in this work. &lt;a
@@ -600,10 +600,19 @@
        &lt;li&gt;&lt;a href=&quot;#the-bdo&quot;&gt;&lt;span class=secno&gt;3.10.21 &lt;/span&gt;The
         &lt;code&gt;bdo&lt;/code&gt; element&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#usage&quot;&gt;&lt;span class=secno&gt;3.10.22 &lt;/span&gt;Usage
+       &lt;li&gt;&lt;a href=&quot;#the-ruby&quot;&gt;&lt;span class=secno&gt;3.10.22 &lt;/span&gt;The
+        &lt;code&gt;ruby&lt;/code&gt; element&lt;/a&gt;
+
+       &lt;li&gt;&lt;a href=&quot;#the-rt&quot;&gt;&lt;span class=secno&gt;3.10.23 &lt;/span&gt;The
+        &lt;code&gt;rt&lt;/code&gt; element&lt;/a&gt;
+
+       &lt;li&gt;&lt;a href=&quot;#the-rp&quot;&gt;&lt;span class=secno&gt;3.10.24 &lt;/span&gt;The
+        &lt;code&gt;rp&lt;/code&gt; element&lt;/a&gt;
+
+       &lt;li&gt;&lt;a href=&quot;#usage&quot;&gt;&lt;span class=secno&gt;3.10.25 &lt;/span&gt;Usage
         summary&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#footnotes&quot;&gt;&lt;span class=secno&gt;3.10.23
+       &lt;li&gt;&lt;a href=&quot;#footnotes&quot;&gt;&lt;span class=secno&gt;3.10.26
         &lt;/span&gt;Footnotes&lt;/a&gt;
       &lt;/ul&gt;
 
@@ -10794,7 +10803,6 @@
 
   &lt;h3 id=text-level&gt;&lt;span class=secno&gt;3.10 &lt;/span&gt;Text-level semantics&lt;/h3&gt;
   &lt;!-- XXX ew, find a better section name --&gt;
-  &lt;!-- XXX ruby (delayed until someone can define it with error handling rules) --&gt;
 
   &lt;h4 id=the-a&gt;&lt;span class=secno&gt;3.10.1 &lt;/span&gt;The &lt;dfn
    id=a&gt;&lt;code&gt;a&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
@@ -12995,14 +13003,171 @@
    &lt;a href=&quot;#refsCSS21&quot;&gt;[CSS21]&lt;/a&gt;&lt;/p&gt;
   &lt;!-- XXX need examples --&gt;
 
-  &lt;h4 id=usage&gt;&lt;span class=secno&gt;3.10.22 &lt;/span&gt;Usage summary&lt;/h4&gt;
+  &lt;h4 id=the-ruby&gt;&lt;span class=secno&gt;3.10.22 &lt;/span&gt;The &lt;dfn
+   id=ruby&gt;&lt;code&gt;ruby&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
+  &lt;dl class=element&gt;
+   &lt;dt&gt;Categories
+
+   &lt;dd&gt;&lt;a href=&quot;#phrasing0&quot;&gt;Phrasing content&lt;/a&gt;.
+
+   &lt;dt&gt;Contexts in which this element may be used:
+
+   &lt;dd&gt;Where &lt;a href=&quot;#phrasing0&quot;&gt;phrasing content&lt;/a&gt; is expected.
+
+   &lt;dt&gt;Content model:
+
+   &lt;dd&gt;One or more groups of: &lt;a href=&quot;#phrasing0&quot;&gt;phrasing content&lt;/a&gt;
+    followed either by a single &lt;code&gt;&lt;a href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element, or
+    an &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; element, an &lt;code&gt;&lt;a
+    href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element, and another &lt;code&gt;&lt;a
+    href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; element.
+
+   &lt;dt&gt;Element-specific attributes:
+
+   &lt;dd&gt;None.
+
+   &lt;dt&gt;DOM interface:
+
+   &lt;dd&gt;Uses &lt;code&gt;&lt;a href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt;.
+  &lt;/dl&gt;
+
+  &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element allows one or more
+   spans of phrasing content to be marked with ruby annotations.
+
+  &lt;p&gt;A &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element represents the spans of
+   phrasing content it contains, ignoring all the child &lt;code&gt;&lt;a
+   href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; elements
+   and their descendants. Those spans of phrasing content have associated
+   annotations created using the &lt;code&gt;&lt;a href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element.
+
+  &lt;div class=example&gt;
+   &lt;p&gt;In this example, each ideograph in the text &lt;span
+    lang=ja&gt;&amp;#x658e;&amp;#x85e4;&amp;#x4fe1;&amp;#x7537;&lt;/span&gt; is annotated with its
+    reading.&lt;/p&gt;
+
+   &lt;pre lang=ja&gt;... &lt;ruby&gt;
+ &amp;#x658e; &lt;rt&gt; &amp;#x3055;&amp;#x3044; &lt;/rt&gt;
+ &amp;#x85e4; &lt;rt&gt; &amp;#x3068;&amp;#x3046; &lt;/rt&gt;
+ &amp;#x4fe1; &lt;rt&gt; &amp;#x306e;&amp;#x3076; &lt;/rt&gt;
+ &amp;#x7537; &lt;rt&gt; &amp;#x304a;         &lt;/rt&gt;
+&lt;/ruby&gt; ...&lt;/pre&gt;
+
+   &lt;p&gt;This might be rendered as:&lt;/p&gt;
+
+   &lt;p&gt;&lt;img alt=&quot;The four main ideographs, each with its reading annotation
+    rendered in a smaller font above it.&quot; src=&quot;images/sample-ruby.png&quot;&gt;&lt;/p&gt;
+  &lt;/div&gt;
+
+  &lt;h4 id=the-rt&gt;&lt;span class=secno&gt;3.10.23 &lt;/span&gt;The &lt;dfn
+   id=rt&gt;&lt;code&gt;rt&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
+
+  &lt;dl class=element&gt;
+   &lt;dt&gt;Categories
+
+   &lt;dd&gt;None.
+
+   &lt;dt&gt;Contexts in which this element may be used:
+
+   &lt;dd&gt;As a child of a &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element.
+
+   &lt;dt&gt;Content model:
+
+   &lt;dd&gt;&lt;a href=&quot;#phrasing0&quot;&gt;Phrasing content&lt;/a&gt;.
+
+   &lt;dt&gt;Element-specific attributes:
+
+   &lt;dd&gt;None.
+
+   &lt;dt&gt;DOM interface:
+
+   &lt;dd&gt;Uses &lt;code&gt;&lt;a href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt;.
+  &lt;/dl&gt;
+
+  &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element marks the ruby text
+   component of a ruby annotation.
+
+  &lt;p&gt;An &lt;code&gt;&lt;a href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element that is a child of a
+   &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element represents an annotation
+   (given by its children) for the zero or more nodes of phrasing content
+   that immediately precedes it in the &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt;
+   element, ignoring &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; elements.
+
+  &lt;p&gt;An &lt;code&gt;&lt;a href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element that is not a child of a
+   &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element represents the same thing as
+   its children.
+
+  &lt;h4 id=the-rp&gt;&lt;span class=secno&gt;3.10.24 &lt;/span&gt;The &lt;dfn
+   id=rp&gt;&lt;code&gt;rp&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
+
+  &lt;dl class=element&gt;
+   &lt;dt&gt;Categories
+
+   &lt;dd&gt;None.
+
+   &lt;dt&gt;Contexts in which this element may be used:
+
+   &lt;dd&gt;As a child of a &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element, either
+    immediately before or immediately after an &lt;code&gt;&lt;a
+    href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element.
+
+   &lt;dt&gt;Content model:
+
+   &lt;dd&gt;If the &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; element is immediately after
+    an &lt;code&gt;&lt;a href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt; element that is immediately preceded
+    by another &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; element: a single character
+    from Unicode character class Pe.
+
+   &lt;dd&gt;Otherwise: a single character from Unicode character class Ps.
+
+   &lt;dt&gt;Element-specific attributes:
+
+   &lt;dd&gt;None.
+
+   &lt;dt&gt;DOM interface:
+
+   &lt;dd&gt;Uses &lt;code&gt;&lt;a href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt;.
+  &lt;/dl&gt;
+
+  &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; element can be used to provide
+   parentheses around a ruby text component of a ruby annotation, to be shown
+   by user agents that don't support ruby annotations.
+
+  &lt;p&gt;An &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; element that is a child of a
+   &lt;code&gt;&lt;a href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element represents nothing and it
+   and its contents must be ignored. An &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt;
+   element whose parent element is not a &lt;code&gt;&lt;a
+   href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element represents the same thing as its
+   children.
+
+  &lt;div class=example&gt;
+   &lt;p&gt;The example above, in which each ideograph in the text &lt;span
+    lang=ja&gt;&amp;#x658e;&amp;#x85e4;&amp;#x4fe1;&amp;#x7537;&lt;/span&gt; is annotated with its
+    reading, could be expanded to use &lt;code&gt;&lt;a href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; so
+    that in legacy user agentthe readings are in parentheses:&lt;/p&gt;
+
+   &lt;pre lang=ja&gt;... &lt;ruby&gt;
+ &amp;#x658e; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x3055;&amp;#x3044;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+ &amp;#x85e4; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x3068;&amp;#x3046;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+ &amp;#x4fe1; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x306e;&amp;#x3076;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+ &amp;#x7537; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x304a;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+&lt;/ruby&gt; ...&lt;/pre&gt;
+
+   &lt;p&gt;In conforming user agents the rendering would be as above, but in user
+    agents that do not support ruby, the rendering would be:&lt;/p&gt;
+
+   &lt;pre
+    lang=ja&gt;... &amp;#x658e; (&amp;#x3055;&amp;#x3044;) &amp;#x85e4; (&amp;#x3068;&amp;#x3046;) &amp;#x4fe1; (&amp;#x306e;&amp;#x3076;) &amp;#x7537; (&amp;#x304a;) ...&lt;/pre&gt;
+  &lt;/div&gt;
+
+  &lt;h4 id=usage&gt;&lt;span class=secno&gt;3.10.25 &lt;/span&gt;Usage summary&lt;/h4&gt;
+
   &lt;p class=big-issue&gt;We need to summarize the various elements, in particular
    to distinguish b/i/em/strong/var/q/mark/cite.&lt;/p&gt;
   &lt;!-- XXX when you do this, also reorder the elements in this section
   to bring the related ones closer together. --&gt;
 
-  &lt;h4 id=footnotes&gt;&lt;span class=secno&gt;3.10.23 &lt;/span&gt;Footnotes&lt;/h4&gt;
+  &lt;h4 id=footnotes&gt;&lt;span class=secno&gt;3.10.26 &lt;/span&gt;Footnotes&lt;/h4&gt;
 
   &lt;p&gt;HTML does not have a dedicated mechanism for marking up footnotes. Here
    are the recommended alternatives.
@@ -44997,9 +45162,10 @@
    end tags&lt;/dfn&gt;, then, while the &lt;a href=&quot;#current5&quot;&gt;current node&lt;/a&gt; is a
    &lt;code&gt;&lt;a href=&quot;#dd&quot;&gt;dd&lt;/a&gt;&lt;/code&gt; element, a &lt;code&gt;&lt;a
    href=&quot;#dt&quot;&gt;dt&lt;/a&gt;&lt;/code&gt; element, an &lt;code&gt;&lt;a href=&quot;#li&quot;&gt;li&lt;/a&gt;&lt;/code&gt;
-   element, or a &lt;code&gt;&lt;a href=&quot;#p&quot;&gt;p&lt;/a&gt;&lt;/code&gt; element, the UA must pop the
-   &lt;a href=&quot;#current5&quot;&gt;current node&lt;/a&gt; off the &lt;a href=&quot;#stack&quot;&gt;stack of
-   open elements&lt;/a&gt;.
+   element, a &lt;code&gt;&lt;a href=&quot;#p&quot;&gt;p&lt;/a&gt;&lt;/code&gt; element, an &lt;code&gt;&lt;a
+   href=&quot;#rp&quot;&gt;rp&lt;/a&gt;&lt;/code&gt; element, or an &lt;code&gt;&lt;a href=&quot;#rt&quot;&gt;rt&lt;/a&gt;&lt;/code&gt;
+   element, the UA must pop the &lt;a href=&quot;#current5&quot;&gt;current node&lt;/a&gt; off the
+   &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt;.
 
   &lt;p&gt;If a step requires the UA to generate implied end tags but lists an
    element to exclude from the process, then the UA must perform the above
@@ -46823,6 +46989,38 @@
      in table&lt;/a&gt;&quot;. Otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
      href=&quot;#in-select&quot; title=&quot;insertion mode: in select&quot;&gt;in select&lt;/a&gt;&quot;.&lt;/p&gt;
 
+   &lt;dt&gt;A start tag whose tag name is one of: &quot;rp&quot;, &quot;rt&quot;
+
+   &lt;dd&gt; &lt;!-- the parsing rules for ruby really don't match IE much at all,
+         but in practice the markup used is very simple and so strict
+         compatibility with IE isn't required. For example, as defined
+         here we get very, very different behaviour than IE for
+         pathological cases like:
+
+           &lt;ruby&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;a&lt;rt&gt;b
+           &lt;ruby&gt;a&lt;rt&gt;b&lt;p&gt;c
+
+         But in practice most ruby markup falls into these cases:
+
+           &lt;ruby&gt;a&lt;rt&gt;b&lt;/ruby&gt;
+           &lt;ruby&gt;a&lt;rp&gt;b&lt;rt&gt;c&lt;rp&gt;d&lt;/ruby&gt;
+           &lt;ruby&gt;a&lt;rt&gt;b&lt;/rt&gt;&lt;/ruby&gt;
+           &lt;ruby&gt;a&lt;rp&gt;b&lt;/rp&gt;&lt;rt&gt;c&lt;/rt&gt;&lt;rp&gt;d&lt;/rp&gt;&lt;/ruby&gt;
+
+    --&gt;
+    
+    &lt;p&gt;If the &lt;a href=&quot;#stack&quot;&gt;stack of open elements&lt;/a&gt; &lt;a href=&quot;#have-an&quot;
+     title=&quot;has an element in scope&quot;&gt;has a &lt;code&gt;ruby&lt;/code&gt; element in
+     scope&lt;/a&gt;, then &lt;a href=&quot;#generate&quot;&gt;generate implied end tags&lt;/a&gt;. If
+     the &lt;a href=&quot;#current5&quot;&gt;current node&lt;/a&gt; is not then a &lt;code&gt;&lt;a
+     href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element, this is a &lt;a href=&quot;#parse1&quot;&gt;parse
+     error&lt;/a&gt;; pop all the nodes from the &lt;a href=&quot;#current5&quot;&gt;current
+     node&lt;/a&gt; up to the node immediately before the bottommost &lt;code&gt;&lt;a
+     href=&quot;#ruby&quot;&gt;ruby&lt;/a&gt;&lt;/code&gt; element on the &lt;a href=&quot;#stack&quot;&gt;stack of
+     open elements&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;p&gt;&lt;a href=&quot;#insert0&quot;&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
+
    &lt;dt&gt;An end tag whose tag name is &quot;br&quot;
 
    &lt;dd&gt;

Modified: source
===================================================================
--- source	2008-05-25 09:17:08 UTC (rev 1703)
+++ source	2008-05-26 10:12:10 UTC (rev 1704)
@@ -8956,8 +8956,6 @@
 
   &lt;h3&gt;Text-level semantics&lt;/h3&gt;&lt;!-- XXX ew, find a better section name --&gt;
 
-  &lt;!-- XXX ruby (delayed until someone can define it with error handling rules) --&gt;
-
   &lt;h4&gt;The &lt;dfn&gt;&lt;code&gt;a&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
   &lt;dl class=&quot;element&quot;&gt;
@@ -10999,6 +10997,129 @@
 
 
 
+  &lt;h4&gt;The &lt;dfn&gt;&lt;code&gt;ruby&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
+
+  &lt;dl class=&quot;element&quot;&gt;
+   &lt;dt&gt;Categories&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Phrasing content&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dt&gt;Contexts in which this element may be used:&lt;/dt&gt;
+   &lt;dd&gt;Where &lt;span&gt;phrasing content&lt;/span&gt; is expected.&lt;/dd&gt;
+   &lt;dt&gt;Content model:&lt;/dt&gt;
+   &lt;dd&gt;One or more groups of: &lt;span&gt;phrasing content&lt;/span&gt; followed either by a single &lt;code&gt;rt&lt;/code&gt; element, or an &lt;code&gt;rp&lt;/code&gt; element, an &lt;code&gt;rt&lt;/code&gt; element, and another &lt;code&gt;rp&lt;/code&gt; element.&lt;/dd&gt;
+   &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
+   &lt;dd&gt;None.&lt;/dd&gt;
+   &lt;dt&gt;DOM interface:&lt;/dt&gt;
+   &lt;dd&gt;Uses &lt;code&gt;HTMLElement&lt;/code&gt;.&lt;/dd&gt;
+  &lt;/dl&gt;
+
+  &lt;p&gt;The &lt;code&gt;ruby&lt;/code&gt; element allows one or more spans of
+  phrasing content to be marked with ruby annotations.&lt;/p&gt;
+
+  &lt;p&gt;A &lt;code&gt;ruby&lt;/code&gt; element represents the spans of phrasing
+  content it contains, ignoring all the child &lt;code&gt;rt&lt;/code&gt; and
+  &lt;code&gt;rp&lt;/code&gt; elements and their descendants. Those spans of
+  phrasing content have associated annotations created using the
+  &lt;code&gt;rt&lt;/code&gt; element.&lt;/p&gt;
+
+  &lt;div class=&quot;example&quot;&gt;
+
+   &lt;p&gt;In this example, each ideograph in the text &lt;span
+   lang=&quot;ja&quot;&gt;&amp;#x658e;&amp;#x85e4;&amp;#x4fe1;&amp;#x7537;&lt;/span&gt; is annotated with
+   its reading.&lt;/p&gt;
+
+   &lt;pre lang=&quot;ja&quot;&gt;... &lt;ruby&gt;
+ &amp;#x658e; &lt;rt&gt; &amp;#x3055;&amp;#x3044; &lt;/rt&gt;
+ &amp;#x85e4; &lt;rt&gt; &amp;#x3068;&amp;#x3046; &lt;/rt&gt;
+ &amp;#x4fe1; &lt;rt&gt; &amp;#x306e;&amp;#x3076; &lt;/rt&gt;
+ &amp;#x7537; &lt;rt&gt; &amp;#x304a;         &lt;/rt&gt;
+&lt;/ruby&gt; ...&lt;/pre&gt;
+
+   &lt;p&gt;This might be rendered as:&lt;/p&gt;
+
+   &lt;p&gt;&lt;img src=&quot;images/sample-ruby.png&quot;
+           alt=&quot;The four main ideographs, each with its reading annotation rendered in a smaller font above it.&quot;&gt;&lt;/p&gt;
+
+  &lt;/div&gt;
+
+
+  &lt;h4&gt;The &lt;dfn&gt;&lt;code&gt;rt&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
+
+  &lt;dl class=&quot;element&quot;&gt;
+   &lt;dt&gt;Categories&lt;/dt&gt;
+   &lt;dd&gt;None.&lt;/dd&gt;
+   &lt;dt&gt;Contexts in which this element may be used:&lt;/dt&gt;
+   &lt;dd&gt;As a child of a &lt;code&gt;ruby&lt;/code&gt; element.&lt;/dd&gt;
+   &lt;dt&gt;Content model:&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Phrasing content&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
+   &lt;dd&gt;None.&lt;/dd&gt;
+   &lt;dt&gt;DOM interface:&lt;/dt&gt;
+   &lt;dd&gt;Uses &lt;code&gt;HTMLElement&lt;/code&gt;.&lt;/dd&gt;
+  &lt;/dl&gt;
+
+  &lt;p&gt;The &lt;code&gt;rt&lt;/code&gt; element marks the ruby text component of a
+  ruby annotation.&lt;/p&gt;
+
+  &lt;p&gt;An &lt;code&gt;rt&lt;/code&gt; element that is a child of a &lt;code&gt;ruby&lt;/code&gt;
+  element represents an annotation (given by its children) for the
+  zero or more nodes of phrasing content that immediately precedes it
+  in the &lt;code&gt;ruby&lt;/code&gt; element, ignoring &lt;code&gt;rp&lt;/code&gt;
+  elements.&lt;/p&gt;
+
+  &lt;p&gt;An &lt;code&gt;rt&lt;/code&gt; element that is not a child of a
+  &lt;code&gt;ruby&lt;/code&gt; element represents the same thing as its
+  children.&lt;/p&gt;
+
+
+  &lt;h4&gt;The &lt;dfn&gt;&lt;code&gt;rp&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
+
+  &lt;dl class=&quot;element&quot;&gt;
+   &lt;dt&gt;Categories&lt;/dt&gt;
+   &lt;dd&gt;None.&lt;/dd&gt;
+   &lt;dt&gt;Contexts in which this element may be used:&lt;/dt&gt;
+   &lt;dd&gt;As a child of a &lt;code&gt;ruby&lt;/code&gt; element, either immediately before or immediately after an &lt;code&gt;rt&lt;/code&gt; element.&lt;/dd&gt;
+   &lt;dt&gt;Content model:&lt;/dt&gt;
+   &lt;dd&gt;If the &lt;code&gt;rp&lt;/code&gt; element is immediately after an &lt;code&gt;rt&lt;/code&gt; element that is immediately preceded by another &lt;code&gt;rp&lt;/code&gt; element: a single character from Unicode character class Pe.&lt;/dd&gt;
+   &lt;dd&gt;Otherwise: a single character from Unicode character class Ps.&lt;/dd&gt;
+   &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
+   &lt;dd&gt;None.&lt;/dd&gt;
+   &lt;dt&gt;DOM interface:&lt;/dt&gt;
+   &lt;dd&gt;Uses &lt;code&gt;HTMLElement&lt;/code&gt;.&lt;/dd&gt;
+  &lt;/dl&gt;
+
+  &lt;p&gt;The &lt;code&gt;rp&lt;/code&gt; element can be used to provide parentheses
+  around a ruby text component of a ruby annotation, to be shown by
+  user agents that don't support ruby annotations.&lt;/p&gt;
+
+  &lt;p&gt;An &lt;code&gt;rp&lt;/code&gt; element that is a child of a &lt;code&gt;ruby&lt;/code&gt;
+  element represents nothing and it and its contents must be
+  ignored. An &lt;code&gt;rp&lt;/code&gt; element whose parent element is not a
+  &lt;code&gt;ruby&lt;/code&gt; element represents the same thing as its
+  children.&lt;/p&gt;
+
+  &lt;div class=&quot;example&quot;&gt;
+
+   &lt;p&gt;The example above, in which each ideograph in the text &lt;span
+   lang=&quot;ja&quot;&gt;&amp;#x658e;&amp;#x85e4;&amp;#x4fe1;&amp;#x7537;&lt;/span&gt; is annotated with
+   its reading, could be expanded to use &lt;code&gt;rp&lt;/code&gt; so that in
+   legacy user agentthe readings are in parentheses:&lt;/p&gt;
+
+   &lt;pre lang=&quot;ja&quot;&gt;... &lt;ruby&gt;
+ &amp;#x658e; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x3055;&amp;#x3044;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+ &amp;#x85e4; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x3068;&amp;#x3046;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+ &amp;#x4fe1; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x306e;&amp;#x3076;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+ &amp;#x7537; &lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;&amp;#x304a;&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;
+&lt;/ruby&gt; ...&lt;/pre&gt;
+
+   &lt;p&gt;In conforming user agents the rendering would be as above, but
+   in user agents that do not support ruby, the rendering would
+   be:&lt;/p&gt;
+
+   &lt;pre lang=&quot;ja&quot;&gt;... &amp;#x658e; (&amp;#x3055;&amp;#x3044;) &amp;#x85e4; (&amp;#x3068;&amp;#x3046;) &amp;#x4fe1; (&amp;#x306e;&amp;#x3076;) &amp;#x7537; (&amp;#x304a;) ...&lt;/pre&gt;
+
+  &lt;/div&gt;
+
+
   &lt;h4&gt;Usage summary&lt;/h4&gt;
 
   &lt;p class=&quot;big-issue&quot;&gt;We need to summarize the various elements, in
@@ -42227,7 +42348,8 @@
   &lt;p&gt;When the steps below require the UA to &lt;dfn&gt;generate implied end
   tags&lt;/dfn&gt;, then, while the &lt;span&gt;current node&lt;/span&gt; is a
   &lt;code&gt;dd&lt;/code&gt; element, a &lt;code&gt;dt&lt;/code&gt; element, an
-  &lt;code&gt;li&lt;/code&gt; element, or a &lt;code&gt;p&lt;/code&gt; element, the UA must
+  &lt;code&gt;li&lt;/code&gt; element, a &lt;code&gt;p&lt;/code&gt; element, an
+  &lt;code&gt;rp&lt;/code&gt; element, or an &lt;code&gt;rt&lt;/code&gt; element, the UA must
   pop the &lt;span&gt;current node&lt;/span&gt; off the &lt;span&gt;stack of open
   elements&lt;/span&gt;.&lt;/p&gt;
 
@@ -44022,6 +44144,40 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;A start tag whose tag name is one of: &quot;rp&quot;, &quot;rt&quot;&lt;/dt&gt;
+   &lt;dd&gt;
+
+    &lt;!-- the parsing rules for ruby really don't match IE much at all,
+         but in practice the markup used is very simple and so strict
+         compatibility with IE isn't required. For example, as defined
+         here we get very, very different behaviour than IE for
+         pathological cases like:
+
+           &lt;ruby&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;a&lt;rt&gt;b
+           &lt;ruby&gt;a&lt;rt&gt;b&lt;p&gt;c
+
+         But in practice most ruby markup falls into these cases:
+
+           &lt;ruby&gt;a&lt;rt&gt;b&lt;/ruby&gt;
+           &lt;ruby&gt;a&lt;rp&gt;b&lt;rt&gt;c&lt;rp&gt;d&lt;/ruby&gt;
+           &lt;ruby&gt;a&lt;rt&gt;b&lt;/rt&gt;&lt;/ruby&gt;
+           &lt;ruby&gt;a&lt;rp&gt;b&lt;/rp&gt;&lt;rt&gt;c&lt;/rt&gt;&lt;rp&gt;d&lt;/rp&gt;&lt;/ruby&gt;
+
+    --&gt;
+
+    &lt;p&gt;If the &lt;span&gt;stack of open elements&lt;/span&gt; &lt;span title=&quot;has an
+    element in scope&quot;&gt;has a &lt;code&gt;ruby&lt;/code&gt; element in scope&lt;/span&gt;,
+    then &lt;span&gt;generate implied end tags&lt;/span&gt;. If the &lt;span&gt;current
+    node&lt;/span&gt; is not then a &lt;code&gt;ruby&lt;/code&gt; element, this is a
+    &lt;span&gt;parse error&lt;/span&gt;; pop all the nodes from the &lt;span&gt;current
+    node&lt;/span&gt; up to the node immediately before the bottommost
+    &lt;code&gt;ruby&lt;/code&gt; element on the &lt;span&gt;stack of open
+    elements&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;p&gt;&lt;span&gt;Insert an HTML element&lt;/span&gt; for the token.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;An end tag whose tag name is &quot;br&quot;&lt;/dt&gt;
    &lt;dd&gt;
     &lt;p&gt;&lt;span&gt;Parse error&lt;/span&gt;. Act as if a start tag token with


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008602.html">[html5] r1703 - /
</A></li>
	<LI>Next message: <A HREF="008604.html">[html5] r1705 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8603">[ date ]</a>
              <a href="thread.html#8603">[ thread ]</a>
              <a href="subject.html#8603">[ subject ]</a>
              <a href="author.html#8603">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
