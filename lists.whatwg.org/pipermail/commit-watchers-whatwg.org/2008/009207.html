<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2322 - [] (0) WF2: Form submission encoding algorithms and	related fallout. Also, chang [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2322%20-%20%5B%5D%20%280%29%20WF2%3A%20Form%20submission%20encoding%20algorithms%20and%0A%09related%20fallout.%20Also%2C%20chang%20%5B...%5D&In-Reply-To=%3C20081011013739.903BC38E9E1%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009206.html">
   <LINK REL="Next"  HREF="009208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2322 - [] (0) WF2: Form submission encoding algorithms and	related fallout. Also, chang [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2322%20-%20%5B%5D%20%280%29%20WF2%3A%20Form%20submission%20encoding%20algorithms%20and%0A%09related%20fallout.%20Also%2C%20chang%20%5B...%5D&In-Reply-To=%3C20081011013739.903BC38E9E1%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2322 - [] (0) WF2: Form submission encoding algorithms and	related fallout. Also, chang [...]">whatwg at whatwg.org
       </A><BR>
    <I>Fri Oct 10 18:37:39 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="009206.html">[html5] r2321 - [] (0) WF2: constraint validation API
</A></li>
        <LI>Next message: <A HREF="009208.html">[html5] r2323 - [e] (0) Clean up some stuff around the forms.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9207">[ date ]</a>
              <a href="thread.html#9207">[ thread ]</a>
              <a href="subject.html#9207">[ subject ]</a>
              <a href="author.html#9207">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-10-10 18:37:38 -0700 (Fri, 10 Oct 2008)
New Revision: 2322

Modified:
   index
   source
Log:
[] (0) WF2: Form submission encoding algorithms and related fallout. Also, change 'int' to 'long' in IDL blocks.

Modified: index
===================================================================
--- index	2008-10-10 04:32:32 UTC (rev 2321)
+++ index	2008-10-11 01:37:38 UTC (rev 2322)
@@ -16,7 +16,7 @@
   &lt;div class=head&gt;
    &lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;h1&gt;HTML 5&lt;/h1&gt;
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 10 October 2008&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 11 October 2008&lt;/h2&gt;
    &lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;dl&gt;&lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -18572,8 +18572,8 @@
 };
 
 interface &lt;dfn id=imagedata&gt;ImageData&lt;/dfn&gt; {
-  readonly attribute unsigned long int &lt;a href=#dom-imagedata-width title=dom-imagedata-width&gt;width&lt;/a&gt;;
-  readonly attribute unsigned long int &lt;a href=#dom-imagedata-height title=dom-imagedata-height&gt;height&lt;/a&gt;;
+  readonly attribute unsigned long &lt;a href=#dom-imagedata-width title=dom-imagedata-width&gt;width&lt;/a&gt;;
+  readonly attribute unsigned long &lt;a href=#dom-imagedata-height title=dom-imagedata-height&gt;height&lt;/a&gt;;
   readonly attribute &lt;a href=#canvaspixelarray&gt;CanvasPixelArray&lt;/a&gt; &lt;a href=#dom-imagedata-data title=dom-imagedata-data&gt;data&lt;/a&gt;;
 };
 
@@ -22998,8 +22998,8 @@
            attribute float &lt;a href=#dom-input-valueasnumber title=dom-input-valueAsNumber&gt;valueAsNumber&lt;/a&gt;;
   readonly attribute &lt;a href=#htmloptionelement&gt;HTMLOptionElement&lt;/a&gt; &lt;a href=#dom-input-selectedoption title=dom-input-selectedOption&gt;selectedOption&lt;/a&gt;;
 
-  void &lt;a href=#dom-input-stepup title=dom-input-stepUp&gt;stepUp&lt;/a&gt;(in int n);
-  void &lt;a href=#dom-input-stepdown title=dom-input-stepDown&gt;stepDown&lt;/a&gt;(in int n);
+  void &lt;a href=#dom-input-stepup title=dom-input-stepUp&gt;stepUp&lt;/a&gt;(in long n);
+  void &lt;a href=#dom-input-stepdown title=dom-input-stepDown&gt;stepDown&lt;/a&gt;(in long n);
 
   readonly attribute boolean &lt;a href=#dom-cva-willvalidate title=dom-cva-willValidate&gt;willValidate&lt;/a&gt;;
   readonly attribute &lt;a href=#validitystate&gt;ValidityState&lt;/a&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
@@ -27640,7 +27640,7 @@
    order&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; be a list of
-   name/value pairs, initially empty.&lt;/li&gt;
+   name-value-type tuples, initially empty.&lt;/li&gt;
 
    &lt;li id=constructing-form-data-set&gt;
 
@@ -27678,6 +27678,8 @@
 
      &lt;/li&gt;
 
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; be the value of the &lt;code title=&quot;&quot;&gt;type&lt;/code&gt; DOM attribute of &lt;var title=&quot;&quot;&gt;field&lt;/var&gt;.&lt;/li&gt;
+
      &lt;li&gt;
 
       &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;field&lt;/var&gt; element is an
@@ -27705,12 +27707,12 @@
        user.&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
-       with the name &lt;var title=&quot;&quot;&gt;name&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt; and
-       the value &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;.&lt;/li&gt;
+       with the name &lt;var title=&quot;&quot;&gt;name&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;,
+       the value &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, and the type &lt;var title=&quot;&quot;&gt;type&lt;/var&gt;.&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
        with the name &lt;var title=&quot;&quot;&gt;name&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt; and
-       the value &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;.&lt;/li&gt;
+       the value &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;, and the type &lt;var title=&quot;&quot;&gt;type&lt;/var&gt;.&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Skip the remaining substeps for this element: if there
        are any more elements in &lt;var title=&quot;&quot;&gt;controls&lt;/var&gt;, return
@@ -27735,8 +27737,8 @@
      &lt;code&gt;&lt;a href=#the-select-element&gt;select&lt;/a&gt;&lt;/code&gt; element, then for each &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt;
      element in the &lt;code&gt;&lt;a href=#the-select-element&gt;select&lt;/a&gt;&lt;/code&gt; element whose &lt;a href=#concept-option-selectedness title=concept-option-selectedness&gt;selectedness&lt;/a&gt; is true,
      append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; with the
-     &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name and the &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt; of the
-     &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element as the value.&lt;/li&gt;
+     &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name, the &lt;a href=#concept-option-value title=concept-option-value&gt;value&lt;/a&gt; of the
+     &lt;code&gt;&lt;a href=#the-option-element&gt;option&lt;/a&gt;&lt;/code&gt; element as the value, and &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; as the type.&lt;/li&gt;
 
      &lt;li&gt;
 
@@ -27751,7 +27753,8 @@
        &quot;&lt;code title=&quot;&quot;&gt;on&lt;/code&gt;&quot;.&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
-       with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name and &lt;var title=&quot;&quot;&gt;value&lt;/var&gt; as the value.&lt;/li&gt;
+       with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name, &lt;var title=&quot;&quot;&gt;value&lt;/var&gt; as the value, and &lt;var title=&quot;&quot;&gt;type&lt;/var&gt;
+       as the type.&lt;/li&gt;
 
       &lt;/ol&gt;&lt;/li&gt;
 
@@ -27759,11 +27762,12 @@
      &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element whose &lt;code title=attr-input-type&gt;&lt;a href=#attr-input-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is in the &lt;a href=#file-upload-state title=attr-input-type-file&gt;File Upload&lt;/a&gt; state, then for
      each file &lt;a href=#concept-input-type-file-selected title=concept-input-type-file-selected&gt;selected&lt;/a&gt; in the
      &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element, append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; with the &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as
-     the name and the file (consisting of the name, the type, and the
-     body) as the value.&lt;/li&gt;
+     the name, the file (consisting of the name, the type, and the
+     body) as the value, and &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; as the
+     type.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Otherwise, append an entry in the &lt;var title=&quot;&quot;&gt;form data
-     set&lt;/var&gt; with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name and the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the &lt;var title=&quot;&quot;&gt;field&lt;/var&gt; element as the value.&lt;/li&gt;
+     set&lt;/var&gt; with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name, the &lt;a href=#concept-fe-value title=concept-fe-value&gt;value&lt;/a&gt; of the &lt;var title=&quot;&quot;&gt;field&lt;/var&gt; element as the value, and &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; as the type.&lt;/li&gt;
 
     &lt;/ol&gt;&lt;/li&gt;
 
@@ -27843,9 +27847,9 @@
     &lt;dl&gt;&lt;dt&gt;&lt;dfn id=submit-mutate-action title=submit-mutate-action&gt;Mutate action&lt;/dfn&gt;
      &lt;dd&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;query&lt;/var&gt; be the resulting encoding the
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;query&lt;/var&gt; be the result of encoding the
       &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; using the &lt;a href=#application/x-www-form-urlencoded-encoding-algorithm&gt;&lt;code title=&quot;&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt; encoding
-      algorithm&lt;/a&gt;.&lt;/p&gt;
+      algorithm&lt;/a&gt;, interpreted as a US-ASCII string.&lt;/p&gt;
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt; be a new &lt;a href=#url&gt;URL&lt;/a&gt;
       that is equal to the &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; except that its
@@ -27873,11 +27877,27 @@
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target browsing context&lt;/var&gt; be &lt;a href=#the-form-submission-target-browsing-context&gt;the
       form submission target browsing context&lt;/a&gt;.&lt;/p&gt;
 
-      &lt;p&gt;&lt;a href=#navigate&gt;Navigate&lt;/a&gt; &lt;var title=&quot;&quot;&gt;target browsing
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be determined as
+      follows:&lt;/p&gt;
+
+      &lt;dl&gt;&lt;dt&gt;If &lt;var title=&quot;&quot;&gt;enctype&lt;/var&gt; is &lt;code title=attr-fs-enctype-urlencoded&gt;&lt;a href=#attr-fs-enctype-urlencoded&gt;application/x-www-form-urlencoded&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be &quot;&lt;code title=&quot;&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt;&quot;.&lt;/dd&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;enctype&lt;/var&gt; is &lt;code title=attr-fs-enctype-formdata&gt;&lt;a href=#attr-fs-enctype-formdata&gt;multpart/form-data&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be &quot;&lt;code title=&quot;&quot;&gt;multipart/form-data&lt;/code&gt;&quot;.&lt;/dd&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;enctype&lt;/var&gt; is &lt;code title=attr-fs-enctype-text&gt;&lt;a href=#attr-fs-enctype-text&gt;text/plain&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be &quot;&lt;code title=&quot;&quot;&gt;text/plain&lt;/code&gt;&quot;.&lt;/dd&gt;
+
+      &lt;/dl&gt;&lt;p&gt;&lt;a href=#navigate&gt;Navigate&lt;/a&gt; &lt;var title=&quot;&quot;&gt;target browsing
       context&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; using the HTTP
-      method given by &lt;var title=&quot;&quot;&gt;method&lt;/var&gt; and with &lt;var title=&quot;&quot;&gt;entity body&lt;/var&gt; as the entity body. If &lt;var title=&quot;&quot;&gt;target browsing context&lt;/var&gt; was newly created for
-      this purpose by the steps above, then it must be navigated with
-      &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt;.&lt;/p&gt;
+      method given by &lt;var title=&quot;&quot;&gt;method&lt;/var&gt; and with &lt;var title=&quot;&quot;&gt;entity body&lt;/var&gt; as the entity body, of type &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt;. If &lt;var title=&quot;&quot;&gt;target browsing
+      context&lt;/var&gt; was newly created for this purpose by the steps
+      above, then it must be navigated with &lt;a href=#replacement-enabled&gt;replacement
+      enabled&lt;/a&gt;.&lt;/p&gt;
 
      &lt;/dd&gt;
 
@@ -27916,18 +27936,20 @@
       form encoding algorithm&lt;/a&gt;.&lt;/p&gt;
 
       &lt;p&gt;If &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; contains the string &quot;&lt;code title=&quot;&quot;&gt;%%%%&lt;/code&gt;&quot; (four U+0025 PERCENT SIGN characters),
-      then %-escape all characters in &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; that do
-      not match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the
-      URI Generic Syntax, and then further %-escape all the U+0025
-      PERCENT SIGN characters in the resulting string, and replace the
-      first occurance of &quot;&lt;code title=&quot;&quot;&gt;%%%%&lt;/code&gt;&quot; in &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; with the resulting double-escaped
-      string. &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
+      then %-escape all bytes in &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; that, if
+      interpreted as US-ASCII, do not match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI Generic Syntax,
+      and then, treating the result as a US-ASCII string, further
+      %-escape all the U+0025 PERCENT SIGN characters in the resulting
+      string and replace the first occurance of &quot;&lt;code title=&quot;&quot;&gt;%%%%&lt;/code&gt;&quot; in &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; with the
+      resulting double-escaped string. &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
 
       &lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; contains the string
       &quot;&lt;code title=&quot;&quot;&gt;%%&lt;/code&gt;&quot; (two U+0025 PERCENT SIGN characters
-      in a row, but not four), then %-escape all characters in &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; that do not match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI Generic Syntax,
-      and replace the first occurance of &quot;&lt;code title=&quot;&quot;&gt;%%&lt;/code&gt;&quot; in
-      &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; with the resulting escaped string. &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
+      in a row, but not four), then %-escape all characters in &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; that, if interpreted as US-ASCII, do not
+      match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI
+      Generic Syntax, and then, treating the result as a US-ASCII
+      string, replace the first occurance of &quot;&lt;code title=&quot;&quot;&gt;%%&lt;/code&gt;&quot; in &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; with the
+      resulting escaped string. &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target browsing context&lt;/var&gt; be &lt;a href=#the-form-submission-target-browsing-context&gt;the
       form submission target browsing context&lt;/a&gt;.&lt;/p&gt;
@@ -27988,7 +28010,7 @@
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;headers&lt;/var&gt; be the resulting encoding the
       &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; using the &lt;a href=#application/x-www-form-urlencoded-encoding-algorithm&gt;&lt;code title=&quot;&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt; encoding
-      algorithm&lt;/a&gt;.&lt;/p&gt;
+      algorithm&lt;/a&gt;, interpreted as a US-ASCII string.&lt;/p&gt;
 
       &lt;p&gt;Replace occurances of U+002B PLUS SIGN characters (+) in &lt;var title=&quot;&quot;&gt;headers&lt;/var&gt; with the string &quot;&lt;code title=&quot;&quot;&gt;%20&lt;/code&gt;&quot;.&lt;/p&gt;
 
@@ -28016,9 +28038,10 @@
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;body&lt;/var&gt; be the resulting encoding the
       &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; using the &lt;a href=#appropriate-form-encoding-algorithm&gt;appropriate
-      form encoding algorithm&lt;/a&gt; and then %-escaping all the
-      characters in the resulting string that do not match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI Generic
-      Syntax. &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
+      form encoding algorithm&lt;/a&gt; and then %-escaping all the bytes
+      in the resulting byte string that, when interpreted as US-ASCII,
+      do not match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in
+      the URI Generic Syntax. &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
       
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt; have the same value as
       &lt;var title=&quot;&quot;&gt;action&lt;/var&gt;.&lt;/p&gt;
@@ -28030,7 +28053,8 @@
 
       &lt;p&gt;Append the string &quot;&lt;code title=&quot;&quot;&gt;body=&lt;/code&gt;&quot; to &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Append &lt;var title=&quot;&quot;&gt;body&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt;.&lt;/p&gt;
+      &lt;p&gt;Append &lt;var title=&quot;&quot;&gt;body&lt;/var&gt;, interpreted as a US-ASCII
+      string, to &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt;.&lt;/p&gt;
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target browsing context&lt;/var&gt; be &lt;a href=#the-form-submission-target-browsing-context&gt;the
       form submission target browsing context&lt;/a&gt;.&lt;/p&gt;
@@ -28078,34 +28102,164 @@
   &lt;p&gt;The &lt;dfn id=application/x-www-form-urlencoded-encoding-algorithm&gt;&lt;code title=&quot;&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt; encoding
   algorithm&lt;/dfn&gt; is as follows:&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p class=XXX&gt;...&lt;/li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the empty string.&lt;/li&gt;
 
-   &lt;!-- During this step, the form data set is examined to ensure all
-   the characters are representable in the submission character
-   encoding. --&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;If the &lt;code&gt;&lt;a href=#the-form-element&gt;form&lt;/a&gt;&lt;/code&gt; element has an &lt;code title=attr-form-accept-charset&gt;&lt;a href=#attr-form-accept-charset&gt;accept-charset&lt;/a&gt;&lt;/code&gt; attribute,
+    then, taking into account the characters found in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;'s names and values, and the character
+    encodings supported by the user agent, select a character encoding
+    from the list given in the &lt;code&gt;&lt;a href=#the-form-element&gt;form&lt;/a&gt;&lt;/code&gt;'s &lt;code title=attr-form-accept-charset&gt;&lt;a href=#attr-form-accept-charset&gt;accept-charset&lt;/a&gt;&lt;/code&gt; attribute
+    that is an &lt;a href=#ascii-compatible-character-encoding&gt;ASCII-compatible character encoding&lt;/a&gt;. If
+    none of the encodings are supported, then let the selected
+    character encoding be UTF-8.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, if the &lt;a href=&quot;#document's-character-encoding&quot;&gt;document's character encoding&lt;/a&gt; is
+    an &lt;a href=#ascii-compatible-character-encoding&gt;ASCII-compatible character encoding&lt;/a&gt;, then that is
+    the selected character encoding.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, let the selected character encoding be UTF-8.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt; be the preferred MIME name
+   of the selected character encoding.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's name is &quot;&lt;code title=&quot;&quot;&gt;_charset_&lt;/code&gt;&quot; and
+   its type is &quot;&lt;code title=&quot;&quot;&gt;hidden&lt;/code&gt;&quot;, replace its value with
+   &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's type is &quot;&lt;code title=&quot;&quot;&gt;file&lt;/code&gt;&quot;, replace
+   its value with the file's filename only.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;For each entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;,
+    perform these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;For each character in the entry's name and value that
+     cannot be expressed using the selected character encoding,
+     replace the character by a string consisting of a U+0026
+     AMPERSAND character (&amp;), one of more characters in the range
+     U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9) representing the
+     Unicode codepoint of the character in base ten, and finally a
+     U+003B SEMICOLON character (;).&lt;/li&gt;
+
+     &lt;li&gt;
+
+      &lt;p&gt;For each character in the entry's name and value, apply the
+      following subsubsteps:&lt;/p&gt;
+
+      &lt;ol&gt;&lt;!-- * - . _ 0-9 a-z A-Z --&gt;&lt;li&gt;&lt;p&gt;If the character isn't in the range U+0020, U+002A,
+       U+002D, U+002E, U+0030 .. U+0039, U+0041 .. U+005A, U+005F,
+       U+0061 .. U+007A then replace the character with a string
+       formed as follows: Start with the empty string, and then,
+       taking each byte of the character when expressed in the
+       selected character encoding in turn, append to the string a
+       U+0025 PERCENT SIGN character (%) followed by two characters in
+       the ranges U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9) and
+       U+0041 LATIN CAPITAL LETTER A to U+005A LATIN CAPITAL LETTER Z
+       representing the hexadecimal value of the byte (zero-padded if
+       necessary).&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;If the character is a U+0020 SPACE character, replace it
+       with a single U+002B PLUS SIGN character (+).&lt;/li&gt;
+
+      &lt;/ol&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If the entry's name is &quot;&lt;code title=&quot;&quot;&gt;isindex&lt;/code&gt;&quot;,
+     its type is &quot;&lt;code title=&quot;&quot;&gt;text&lt;/code&gt;&quot;, and this is the first
+     entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;, then append the
+     value to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; and skip the rest of the
+     substeps for this entry, moving on to the next entry, if any, or
+     the next step in the overall algorithm otherwise.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If this is not the first entry, append a single U+0026
+     AMPERSAND character (&amp;) to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append the entry's name to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append a single U+003D EQUALS SIGN character (=) to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append the entry's value to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Encode &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; as US-ASCII and return the
+   resulting byte stream.&lt;/li&gt;
+
   &lt;/ol&gt;&lt;h5 id=multipart-form-data&gt;&lt;span class=secno&gt;4.10.15.2 &lt;/span&gt;Multipart form data&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=multipart/form-data-encoding-algorithm&gt;&lt;code title=&quot;&quot;&gt;multipart/form-data&lt;/code&gt; encoding
-  algorithm&lt;/dfn&gt; is as follows:&lt;/p&gt;
+  algorithm&lt;/dfn&gt; is to encode the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
+  using the rules described by RFC2388, &lt;cite&gt;Returning Values from
+  Forms: &lt;code title=&quot;&quot;&gt;multipart/form-data&lt;/code&gt;&lt;/cite&gt;, and return
+  the resulting byte stream. &lt;a href=#refsRFC2388&gt;[RFC2388]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p class=XXX&gt;...&lt;/li&gt;
+  &lt;p&gt;Each entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; is a
+  &lt;i&gt;field&lt;/i&gt;, the name of the entry is the &lt;i&gt;field name&lt;/i&gt; and the
+  value of the entry is the &lt;i&gt;field value&lt;/i&gt;.&lt;/p&gt;
 
-   &lt;!-- During this step, the form data set is examined to ensure all
-   the characters are representable in the submission character
-   encoding. --&gt;
+  &lt;p&gt;The order of parts must be the same as the order of fields in the
+  &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;. Multiple entries with the same
+  name must be treated as distinct fields.&lt;/p&gt;
 
-  &lt;/ol&gt;&lt;h5 id=plain-text-form-data&gt;&lt;span class=secno&gt;4.10.15.3 &lt;/span&gt;Plain text form data&lt;/h5&gt;
+  &lt;!-- XXX define default encoding? --&gt;
 
+
+  &lt;h5 id=plain-text-form-data&gt;&lt;span class=secno&gt;4.10.15.3 &lt;/span&gt;Plain text form data&lt;/h5&gt;
+
   &lt;p&gt;The &lt;dfn id=text/plain-encoding-algorithm&gt;&lt;code title=&quot;&quot;&gt;text/plain&lt;/code&gt; encoding
   algorithm&lt;/dfn&gt; is as follows:&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p class=XXX&gt;...&lt;/li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the empty string.&lt;/li&gt;
 
-   &lt;!-- During this step, the form data set is examined to ensure all
-   the characters are representable in the submission character
-   encoding. --&gt;
+   &lt;li&gt;
 
+    &lt;!-- this is different from application/x-www-form-urlencoded in
+    that it isn't limited to ASCII-compatible encodings --&gt;
+
+    &lt;p&gt;If the &lt;code&gt;&lt;a href=#the-form-element&gt;form&lt;/a&gt;&lt;/code&gt; element has an &lt;code title=attr-form-accept-charset&gt;&lt;a href=#attr-form-accept-charset&gt;accept-charset&lt;/a&gt;&lt;/code&gt; attribute,
+    then, taking into account the characters found in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;'s names and values, and the character
+    encodings supported by the user agent, select a character encoding
+    from the list given in the &lt;code&gt;&lt;a href=#the-form-element&gt;form&lt;/a&gt;&lt;/code&gt;'s &lt;code title=attr-form-accept-charset&gt;&lt;a href=#attr-form-accept-charset&gt;accept-charset&lt;/a&gt;&lt;/code&gt;
+    attribute. If none of the encodings are supported, then let the
+    selected character encoding be UTF-8.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, the selected character encoding is the
+    &lt;a href=&quot;#document's-character-encoding&quot;&gt;document's character encoding&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt; be the preferred MIME name
+   of the selected character encoding.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's name is &quot;&lt;code title=&quot;&quot;&gt;_charset_&lt;/code&gt;&quot; and
+   its type is &quot;&lt;code title=&quot;&quot;&gt;hidden&lt;/code&gt;&quot;, replace its value with
+   &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's type is &quot;&lt;code title=&quot;&quot;&gt;file&lt;/code&gt;&quot;, replace
+   its value with the file's filename only.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;For each entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;,
+    perform these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Append the entry's name to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append a single U+003D EQUALS SIGN character (=) to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append the entry's value to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append a U+000D CARRIAGE RETURN (CR) U+000A LINE FEED (LF)
+     character pair to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Encode &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; using the selected
+   character encoding and return the resulting byte stream.&lt;/li&gt;
+
   &lt;/ol&gt;&lt;h4 id=resetting-a-form&gt;&lt;span class=secno&gt;4.10.16 &lt;/span&gt;Resetting a form&lt;/h4&gt;
 
   &lt;p&gt;When a form &lt;var title=&quot;&quot;&gt;form&lt;/var&gt; is &lt;dfn id=concept-form-reset title=concept-form-reset&gt;reset&lt;/dfn&gt;, the user agent must invoke
@@ -36736,8 +36890,8 @@
   as an argument.&lt;/p&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=sqlresultset&gt;SQLResultSet&lt;/dfn&gt; {
-  readonly attribute int &lt;a href=#dom-sqlresultset-insertid title=dom-SQLResultSet-insertId&gt;insertId&lt;/a&gt;;
-  readonly attribute int &lt;a href=#dom-sqlresultset-rowsaffected title=dom-SQLResultSet-rowsAffected&gt;rowsAffected&lt;/a&gt;;
+  readonly attribute long &lt;a href=#dom-sqlresultset-insertid title=dom-SQLResultSet-insertId&gt;insertId&lt;/a&gt;;
+  readonly attribute long &lt;a href=#dom-sqlresultset-rowsaffected title=dom-SQLResultSet-rowsAffected&gt;rowsAffected&lt;/a&gt;;
   readonly attribute &lt;a href=#sqlresultsetrowlist&gt;SQLResultSetRowList&lt;/a&gt; &lt;a href=#dom-sqlresultset-rows title=dom-SQLResultSet-rows&gt;rows&lt;/a&gt;;
 };&lt;/pre&gt;
 
@@ -36791,7 +36945,7 @@
   a &lt;code&gt;&lt;a href=#sqlerror&gt;SQLError&lt;/a&gt;&lt;/code&gt; object as one of their arguments.&lt;/p&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=sqlerror&gt;SQLError&lt;/dfn&gt; {
-  readonly attribute unsigned int &lt;a href=#dom-sqlerror-code title=dom-SQLError-code&gt;code&lt;/a&gt;;
+  readonly attribute unsigned long &lt;a href=#dom-sqlerror-code title=dom-SQLError-code&gt;code&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-sqlerror-message title=dom-SQLError-message&gt;message&lt;/a&gt;;
 };&lt;/pre&gt;
 
@@ -41347,7 +41501,7 @@
   const unsigned short &lt;a href=#dom-websocket-connecting title=dom-WebSocket-CONNECTING&gt;CONNECTING&lt;/a&gt; = 0;
   const unsigned short &lt;a href=#dom-websocket-open title=dom-WebSocket-OPEN&gt;OPEN&lt;/a&gt; = 1;
   const unsigned short &lt;a href=#dom-websocket-closed title=dom-WebSocket-CLOSED&gt;CLOSED&lt;/a&gt; = 2;
-  readonly attribute int &lt;a href=#dom-websocket-readystate title=dom-WebSocket-readyState&gt;readyState&lt;/a&gt;;
+  readonly attribute long &lt;a href=#dom-websocket-readystate title=dom-WebSocket-readyState&gt;readyState&lt;/a&gt;;
 
   // networking
            attribute EventListener &lt;a href=#handler-websocket-onopen title=handler-WebSocket-onopen&gt;onopen&lt;/a&gt;;
@@ -47732,11 +47886,6 @@
     keywords here: (input field)&quot; in the user's preferred
     language.&lt;/p&gt;
 
-    &lt;p class=XXX&gt; Then need to specify that if the form
-    submission causes just a single form control, whose name is
-    &quot;isindex&quot;, to be submitted, then we submit just the value part,
-    not the &quot;isindex=&quot; part.  &lt;/p&gt;
-
    &lt;/dd&gt;
 
 &lt;!-- XXX keygen support; don't forget form element pointer!
@@ -52664,7 +52813,6 @@
        (&quot;&lt;code title=&quot;&quot;&gt;foo&lt;/code&gt;&quot; vs &lt;code&gt;foo&lt;/code&gt;)
  XXX * need to properly xref events throughout, mark up DOMActivate, etc
  XXX * onclick=&quot;&quot; only fires if it is a MouseEvent ?
- XXX * &lt;isindex&gt; needs some prose in the form submission section
  XXX * hsivonen makes the following suggestions:
        &gt; To make document conformance a more useful concept for the purpose of catching
        &gt; author errors, I suggest that the following attributes be made required:

Modified: source
===================================================================
--- source	2008-10-10 04:32:32 UTC (rev 2321)
+++ source	2008-10-11 01:37:38 UTC (rev 2322)
@@ -20082,8 +20082,8 @@
 };
 
 interface &lt;dfn&gt;ImageData&lt;/dfn&gt; {
-  readonly attribute unsigned long int &lt;span title=&quot;dom-imagedata-width&quot;&gt;width&lt;/span&gt;;
-  readonly attribute unsigned long int &lt;span title=&quot;dom-imagedata-height&quot;&gt;height&lt;/span&gt;;
+  readonly attribute unsigned long &lt;span title=&quot;dom-imagedata-width&quot;&gt;width&lt;/span&gt;;
+  readonly attribute unsigned long &lt;span title=&quot;dom-imagedata-height&quot;&gt;height&lt;/span&gt;;
   readonly attribute &lt;span&gt;CanvasPixelArray&lt;/span&gt; &lt;span title=&quot;dom-imagedata-data&quot;&gt;data&lt;/span&gt;;
 };
 
@@ -25545,8 +25545,8 @@
            attribute float &lt;span title=&quot;dom-input-valueAsNumber&quot;&gt;valueAsNumber&lt;/span&gt;;
   readonly attribute &lt;span&gt;HTMLOptionElement&lt;/span&gt; &lt;span title=&quot;dom-input-selectedOption&quot;&gt;selectedOption&lt;/span&gt;;
 
-  void &lt;span title=&quot;dom-input-stepUp&quot;&gt;stepUp&lt;/span&gt;(in int n);
-  void &lt;span title=&quot;dom-input-stepDown&quot;&gt;stepDown&lt;/span&gt;(in int n);
+  void &lt;span title=&quot;dom-input-stepUp&quot;&gt;stepUp&lt;/span&gt;(in long n);
+  void &lt;span title=&quot;dom-input-stepDown&quot;&gt;stepDown&lt;/span&gt;(in long n);
 
   readonly attribute boolean &lt;span title=&quot;dom-cva-willValidate&quot;&gt;willValidate&lt;/span&gt;;
   readonly attribute &lt;span&gt;ValidityState&lt;/span&gt; &lt;span title=&quot;dom-cva-validity&quot;&gt;validity&lt;/span&gt;;
@@ -31100,7 +31100,7 @@
    order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; be a list of
-   name/value pairs, initially empty.&lt;/p&gt;&lt;/li&gt;
+   name-value-type tuples, initially empty.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li id=&quot;constructing-form-data-set&quot;&gt;
 
@@ -31153,6 +31153,10 @@
 
      &lt;/li&gt;
 
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; be the value of the &lt;code
+     title=&quot;&quot;&gt;type&lt;/code&gt; DOM attribute of &lt;var
+     title=&quot;&quot;&gt;field&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
      &lt;li&gt;
 
       &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;field&lt;/var&gt; element is an
@@ -31191,12 +31195,14 @@
        user.&lt;/p&gt;&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
-       with the name &lt;var title=&quot;&quot;&gt;name&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt; and
-       the value &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+       with the name &lt;var title=&quot;&quot;&gt;name&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;,
+       the value &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, and the type &lt;var
+       title=&quot;&quot;&gt;type&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
        with the name &lt;var title=&quot;&quot;&gt;name&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt; and
-       the value &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+       the value &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;, and the type &lt;var
+       title=&quot;&quot;&gt;type&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Skip the remaining substeps for this element: if there
        are any more elements in &lt;var title=&quot;&quot;&gt;controls&lt;/var&gt;, return
@@ -31227,9 +31233,10 @@
      element in the &lt;code&gt;select&lt;/code&gt; element whose &lt;span
      title=&quot;concept-option-selectedness&quot;&gt;selectedness&lt;/span&gt; is true,
      append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; with the
-     &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name and the &lt;span
+     &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name, the &lt;span
      title=&quot;concept-option-value&quot;&gt;value&lt;/span&gt; of the
-     &lt;code&gt;option&lt;/code&gt; element as the value.&lt;/p&gt;&lt;/li&gt;
+     &lt;code&gt;option&lt;/code&gt; element as the value, and &lt;var
+     title=&quot;&quot;&gt;type&lt;/var&gt; as the type.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;
 
@@ -31249,8 +31256,9 @@
        &quot;&lt;code title=&quot;&quot;&gt;on&lt;/code&gt;&quot;.&lt;/p&gt;&lt;/li&gt;
 
        &lt;li&gt;&lt;p&gt;Append an entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
-       with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name and &lt;var
-       title=&quot;&quot;&gt;value&lt;/var&gt; as the value.&lt;/p&gt;&lt;/li&gt;
+       with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name, &lt;var
+       title=&quot;&quot;&gt;value&lt;/var&gt; as the value, and &lt;var title=&quot;&quot;&gt;type&lt;/var&gt;
+       as the type.&lt;/p&gt;&lt;/li&gt;
 
       &lt;/ol&gt;
 
@@ -31264,13 +31272,15 @@
      title=&quot;concept-input-type-file-selected&quot;&gt;selected&lt;/span&gt; in the
      &lt;code&gt;input&lt;/code&gt; element, append an entry in the &lt;var
      title=&quot;&quot;&gt;form data set&lt;/var&gt; with the &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as
-     the name and the file (consisting of the name, the type, and the
-     body) as the value.&lt;/p&gt;&lt;/li&gt;
+     the name, the file (consisting of the name, the type, and the
+     body) as the value, and &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; as the
+     type.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Otherwise, append an entry in the &lt;var title=&quot;&quot;&gt;form data
-     set&lt;/var&gt; with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name and the &lt;span
+     set&lt;/var&gt; with &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; as the name, the &lt;span
      title=&quot;concept-fe-value&quot;&gt;value&lt;/span&gt; of the &lt;var
-     title=&quot;&quot;&gt;field&lt;/var&gt; element as the value.&lt;/p&gt;&lt;/li&gt;
+     title=&quot;&quot;&gt;field&lt;/var&gt; element as the value, and &lt;var
+     title=&quot;&quot;&gt;type&lt;/var&gt; as the type.&lt;/p&gt;&lt;/li&gt;
 
     &lt;/ol&gt;
 
@@ -31374,10 +31384,10 @@
      &lt;dt&gt;&lt;dfn title=&quot;submit-mutate-action&quot;&gt;Mutate action&lt;/dfn&gt;
      &lt;dd&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;query&lt;/var&gt; be the resulting encoding the
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;query&lt;/var&gt; be the result of encoding the
       &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; using the &lt;span&gt;&lt;code
       title=&quot;&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt; encoding
-      algorithm&lt;/span&gt;.&lt;/p&gt;
+      algorithm&lt;/span&gt;, interpreted as a US-ASCII string.&lt;/p&gt;
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt; be a new &lt;span&gt;URL&lt;/span&gt;
       that is equal to the &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; except that its
@@ -31406,13 +31416,35 @@
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target browsing context&lt;/var&gt; be &lt;span&gt;the
       form submission target browsing context&lt;/span&gt;.&lt;/p&gt;
 
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be determined as
+      follows:&lt;/p&gt;
+
+      &lt;dl&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;enctype&lt;/var&gt; is &lt;code title=&quot;attr-fs-enctype-urlencoded&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be &quot;&lt;code
+       title=&quot;&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt;&quot;.&lt;/dd&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;enctype&lt;/var&gt; is &lt;code title=&quot;attr-fs-enctype-formdata&quot;&gt;multpart/form-data&lt;/code&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be &quot;&lt;code
+       title=&quot;&quot;&gt;multipart/form-data&lt;/code&gt;&quot;.&lt;/dd&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;enctype&lt;/var&gt; is &lt;code title=&quot;attr-fs-enctype-text&quot;&gt;text/plain&lt;/code&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;MIME type&lt;/var&gt; be &quot;&lt;code title=&quot;&quot;&gt;text/plain&lt;/code&gt;&quot;.&lt;/dd&gt;
+
+      &lt;/dl&gt;
+
       &lt;p&gt;&lt;span&gt;Navigate&lt;/span&gt; &lt;var title=&quot;&quot;&gt;target browsing
       context&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; using the HTTP
       method given by &lt;var title=&quot;&quot;&gt;method&lt;/var&gt; and with &lt;var
-      title=&quot;&quot;&gt;entity body&lt;/var&gt; as the entity body. If &lt;var
-      title=&quot;&quot;&gt;target browsing context&lt;/var&gt; was newly created for
-      this purpose by the steps above, then it must be navigated with
-      &lt;span&gt;replacement enabled&lt;/span&gt;.&lt;/p&gt;
+      title=&quot;&quot;&gt;entity body&lt;/var&gt; as the entity body, of type &lt;var
+      title=&quot;&quot;&gt;MIME type&lt;/var&gt;. If &lt;var title=&quot;&quot;&gt;target browsing
+      context&lt;/var&gt; was newly created for this purpose by the steps
+      above, then it must be navigated with &lt;span&gt;replacement
+      enabled&lt;/span&gt;.&lt;/p&gt;
 
      &lt;/dd&gt;
 
@@ -31453,21 +31485,25 @@
 
       &lt;p&gt;If &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; contains the string &quot;&lt;code
       title=&quot;&quot;&gt;%%%%&lt;/code&gt;&quot; (four U+0025 PERCENT SIGN characters),
-      then %-escape all characters in &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; that do
-      not match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the
-      URI Generic Syntax, and then further %-escape all the U+0025
-      PERCENT SIGN characters in the resulting string, and replace the
-      first occurance of &quot;&lt;code title=&quot;&quot;&gt;%%%%&lt;/code&gt;&quot; in &lt;var
-      title=&quot;&quot;&gt;action&lt;/var&gt; with the resulting double-escaped
-      string. &lt;a href=&quot;#refsRFC3986&quot;&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
+      then %-escape all bytes in &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; that, if
+      interpreted as US-ASCII, do not match the &lt;code
+      title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI Generic Syntax,
+      and then, treating the result as a US-ASCII string, further
+      %-escape all the U+0025 PERCENT SIGN characters in the resulting
+      string and replace the first occurance of &quot;&lt;code
+      title=&quot;&quot;&gt;%%%%&lt;/code&gt;&quot; in &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; with the
+      resulting double-escaped string. &lt;a
+      href=&quot;#refsRFC3986&quot;&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
 
       &lt;p&gt;Otherwise, if &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; contains the string
       &quot;&lt;code title=&quot;&quot;&gt;%%&lt;/code&gt;&quot; (two U+0025 PERCENT SIGN characters
       in a row, but not four), then %-escape all characters in &lt;var
-      title=&quot;&quot;&gt;data&lt;/var&gt; that do not match the &lt;code
-      title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI Generic Syntax,
-      and replace the first occurance of &quot;&lt;code title=&quot;&quot;&gt;%%&lt;/code&gt;&quot; in
-      &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; with the resulting escaped string. &lt;a
+      title=&quot;&quot;&gt;data&lt;/var&gt; that, if interpreted as US-ASCII, do not
+      match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI
+      Generic Syntax, and then, treating the result as a US-ASCII
+      string, replace the first occurance of &quot;&lt;code
+      title=&quot;&quot;&gt;%%&lt;/code&gt;&quot; in &lt;var title=&quot;&quot;&gt;action&lt;/var&gt; with the
+      resulting escaped string. &lt;a
       href=&quot;#refsRFC3986&quot;&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target browsing context&lt;/var&gt; be &lt;span&gt;the
@@ -31543,7 +31579,7 @@
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;headers&lt;/var&gt; be the resulting encoding the
       &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; using the &lt;span&gt;&lt;code
       title=&quot;&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt; encoding
-      algorithm&lt;/span&gt;.&lt;/p&gt;
+      algorithm&lt;/span&gt;, interpreted as a US-ASCII string.&lt;/p&gt;
 
       &lt;p&gt;Replace occurances of U+002B PLUS SIGN characters (+) in &lt;var
       title=&quot;&quot;&gt;headers&lt;/var&gt; with the string &quot;&lt;code
@@ -31577,10 +31613,10 @@
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;body&lt;/var&gt; be the resulting encoding the
       &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; using the &lt;span&gt;appropriate
-      form encoding algorithm&lt;/span&gt; and then %-escaping all the
-      characters in the resulting string that do not match the &lt;code
-      title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in the URI Generic
-      Syntax. &lt;a href=&quot;#refsRFC3986&quot;&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
+      form encoding algorithm&lt;/span&gt; and then %-escaping all the bytes
+      in the resulting byte string that, when interpreted as US-ASCII,
+      do not match the &lt;code title=&quot;&quot;&gt;unreserved&lt;/code&gt; production in
+      the URI Generic Syntax. &lt;a href=&quot;#refsRFC3986&quot;&gt;[RFC3986]&lt;/a&gt;&lt;/p&gt;
       
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt; have the same value as
       &lt;var title=&quot;&quot;&gt;action&lt;/var&gt;.&lt;/p&gt;
@@ -31594,8 +31630,8 @@
       &lt;p&gt;Append the string &quot;&lt;code title=&quot;&quot;&gt;body=&lt;/code&gt;&quot; to &lt;var
       title=&quot;&quot;&gt;destination&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Append &lt;var title=&quot;&quot;&gt;body&lt;/var&gt; to &lt;var
-      title=&quot;&quot;&gt;destination&lt;/var&gt;.&lt;/p&gt;
+      &lt;p&gt;Append &lt;var title=&quot;&quot;&gt;body&lt;/var&gt;, interpreted as a US-ASCII
+      string, to &lt;var title=&quot;&quot;&gt;destination&lt;/var&gt;.&lt;/p&gt;
 
       &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target browsing context&lt;/var&gt; be &lt;span&gt;the
       form submission target browsing context&lt;/span&gt;.&lt;/p&gt;
@@ -31658,31 +31694,131 @@
 
   &lt;ol&gt;
 
-   &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;...&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the empty string.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;!-- During this step, the form data set is examined to ensure all
-   the characters are representable in the submission character
-   encoding. --&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;If the &lt;code&gt;form&lt;/code&gt; element has an &lt;code
+    title=&quot;attr-form-accept-charset&quot;&gt;accept-charset&lt;/code&gt; attribute,
+    then, taking into account the characters found in the &lt;var
+    title=&quot;&quot;&gt;form data set&lt;/var&gt;'s names and values, and the character
+    encodings supported by the user agent, select a character encoding
+    from the list given in the &lt;code&gt;form&lt;/code&gt;'s &lt;code
+    title=&quot;attr-form-accept-charset&quot;&gt;accept-charset&lt;/code&gt; attribute
+    that is an &lt;span&gt;ASCII-compatible character encoding&lt;/span&gt;. If
+    none of the encodings are supported, then let the selected
+    character encoding be UTF-8.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, if the &lt;span&gt;document's character encoding&lt;/span&gt; is
+    an &lt;span&gt;ASCII-compatible character encoding&lt;/span&gt;, then that is
+    the selected character encoding.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, let the selected character encoding be UTF-8.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt; be the preferred MIME name
+   of the selected character encoding.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's name is &quot;&lt;code title=&quot;&quot;&gt;_charset_&lt;/code&gt;&quot; and
+   its type is &quot;&lt;code title=&quot;&quot;&gt;hidden&lt;/code&gt;&quot;, replace its value with
+   &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's type is &quot;&lt;code title=&quot;&quot;&gt;file&lt;/code&gt;&quot;, replace
+   its value with the file's filename only.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;For each entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;,
+    perform these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;
+
+     &lt;li&gt;&lt;p&gt;For each character in the entry's name and value that
+     cannot be expressed using the selected character encoding,
+     replace the character by a string consisting of a U+0026
+     AMPERSAND character (&amp;), one of more characters in the range
+     U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9) representing the
+     Unicode codepoint of the character in base ten, and finally a
+     U+003B SEMICOLON character (;).&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;
+
+      &lt;p&gt;For each character in the entry's name and value, apply the
+      following subsubsteps:&lt;/p&gt;
+
+      &lt;ol&gt;
+
+       &lt;!-- * - . _ 0-9 a-z A-Z --&gt;
+
+       &lt;li&gt;&lt;p&gt;If the character isn't in the range U+0020, U+002A,
+       U+002D, U+002E, U+0030 .. U+0039, U+0041 .. U+005A, U+005F,
+       U+0061 .. U+007A then replace the character with a string
+       formed as follows: Start with the empty string, and then,
+       taking each byte of the character when expressed in the
+       selected character encoding in turn, append to the string a
+       U+0025 PERCENT SIGN character (%) followed by two characters in
+       the ranges U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE (9) and
+       U+0041 LATIN CAPITAL LETTER A to U+005A LATIN CAPITAL LETTER Z
+       representing the hexadecimal value of the byte (zero-padded if
+       necessary).&lt;/p&gt;&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;If the character is a U+0020 SPACE character, replace it
+       with a single U+002B PLUS SIGN character (+).&lt;/p&gt;&lt;/li&gt;
+
+      &lt;/ol&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If the entry's name is &quot;&lt;code title=&quot;&quot;&gt;isindex&lt;/code&gt;&quot;,
+     its type is &quot;&lt;code title=&quot;&quot;&gt;text&lt;/code&gt;&quot;, and this is the first
+     entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;, then append the
+     value to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; and skip the rest of the
+     substeps for this entry, moving on to the next entry, if any, or
+     the next step in the overall algorithm otherwise.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If this is not the first entry, append a single U+0026
+     AMPERSAND character (&amp;) to &lt;var
+     title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append the entry's name to &lt;var
+     title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append a single U+003D EQUALS SIGN character (=) to &lt;var
+     title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append the entry's value to &lt;var
+     title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Encode &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; as US-ASCII and return the
+   resulting byte stream.&lt;/p&gt;&lt;/li&gt;
+
   &lt;/ol&gt;
 
 
   &lt;h5&gt;Multipart form data&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn&gt;&lt;code title=&quot;&quot;&gt;multipart/form-data&lt;/code&gt; encoding
-  algorithm&lt;/dfn&gt; is as follows:&lt;/p&gt;
+  algorithm&lt;/dfn&gt; is to encode the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;
+  using the rules described by RFC2388, &lt;cite&gt;Returning Values from
+  Forms: &lt;code title=&quot;&quot;&gt;multipart/form-data&lt;/code&gt;&lt;/cite&gt;, and return
+  the resulting byte stream. &lt;a href=&quot;#refsRFC2388&quot;&gt;[RFC2388]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;ol&gt;
+  &lt;p&gt;Each entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt; is a
+  &lt;i&gt;field&lt;/i&gt;, the name of the entry is the &lt;i&gt;field name&lt;/i&gt; and the
+  value of the entry is the &lt;i&gt;field value&lt;/i&gt;.&lt;/p&gt;
 
-   &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;...&lt;/p&gt;&lt;/li&gt;
+  &lt;p&gt;The order of parts must be the same as the order of fields in the
+  &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;. Multiple entries with the same
+  name must be treated as distinct fields.&lt;/p&gt;
 
-   &lt;!-- During this step, the form data set is examined to ensure all
-   the characters are representable in the submission character
-   encoding. --&gt;
+  &lt;!-- XXX define default encoding? --&gt;
 
-  &lt;/ol&gt;
 
-
   &lt;h5&gt;Plain text form data&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn&gt;&lt;code title=&quot;&quot;&gt;text/plain&lt;/code&gt; encoding
@@ -31690,12 +31826,64 @@
 
   &lt;ol&gt;
 
-   &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;...&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the empty string.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;!-- During this step, the form data set is examined to ensure all
-   the characters are representable in the submission character
-   encoding. --&gt;
+   &lt;li&gt;
 
+    &lt;!-- this is different from application/x-www-form-urlencoded in
+    that it isn't limited to ASCII-compatible encodings --&gt;
+
+    &lt;p&gt;If the &lt;code&gt;form&lt;/code&gt; element has an &lt;code
+    title=&quot;attr-form-accept-charset&quot;&gt;accept-charset&lt;/code&gt; attribute,
+    then, taking into account the characters found in the &lt;var
+    title=&quot;&quot;&gt;form data set&lt;/var&gt;'s names and values, and the character
+    encodings supported by the user agent, select a character encoding
+    from the list given in the &lt;code&gt;form&lt;/code&gt;'s &lt;code
+    title=&quot;attr-form-accept-charset&quot;&gt;accept-charset&lt;/code&gt;
+    attribute. If none of the encodings are supported, then let the
+    selected character encoding be UTF-8.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, the selected character encoding is the
+    &lt;span&gt;document's character encoding&lt;/span&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt; be the preferred MIME name
+   of the selected character encoding.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's name is &quot;&lt;code title=&quot;&quot;&gt;_charset_&lt;/code&gt;&quot; and
+   its type is &quot;&lt;code title=&quot;&quot;&gt;hidden&lt;/code&gt;&quot;, replace its value with
+   &lt;var title=&quot;&quot;&gt;charset&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the entry's type is &quot;&lt;code title=&quot;&quot;&gt;file&lt;/code&gt;&quot;, replace
+   its value with the file's filename only.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;For each entry in the &lt;var title=&quot;&quot;&gt;form data set&lt;/var&gt;,
+    perform these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;
+
+     &lt;li&gt;&lt;p&gt;Append the entry's name to &lt;var
+     title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append a single U+003D EQUALS SIGN character (=) to &lt;var
+     title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append the entry's value to &lt;var
+     title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Append a U+000D CARRIAGE RETURN (CR) U+000A LINE FEED (LF)
+     character pair to &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Encode &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; using the selected
+   character encoding and return the resulting byte stream.&lt;/p&gt;&lt;/li&gt;
+
   &lt;/ol&gt;
 
 
@@ -41741,8 +41929,8 @@
   as an argument.&lt;/p&gt;
 
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;SQLResultSet&lt;/dfn&gt; {
-  readonly attribute int &lt;span title=&quot;dom-SQLResultSet-insertId&quot;&gt;insertId&lt;/span&gt;;
-  readonly attribute int &lt;span title=&quot;dom-SQLResultSet-rowsAffected&quot;&gt;rowsAffected&lt;/span&gt;;
+  readonly attribute long &lt;span title=&quot;dom-SQLResultSet-insertId&quot;&gt;insertId&lt;/span&gt;;
+  readonly attribute long &lt;span title=&quot;dom-SQLResultSet-rowsAffected&quot;&gt;rowsAffected&lt;/span&gt;;
   readonly attribute &lt;span&gt;SQLResultSetRowList&lt;/span&gt; &lt;span title=&quot;dom-SQLResultSet-rows&quot;&gt;rows&lt;/span&gt;;
 };&lt;/pre&gt;
 
@@ -41800,7 +41988,7 @@
   a &lt;code&gt;SQLError&lt;/code&gt; object as one of their arguments.&lt;/p&gt;
 
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;SQLError&lt;/dfn&gt; {
-  readonly attribute unsigned int &lt;span title=&quot;dom-SQLError-code&quot;&gt;code&lt;/span&gt;;
+  readonly attribute unsigned long &lt;span title=&quot;dom-SQLError-code&quot;&gt;code&lt;/span&gt;;
   readonly attribute DOMString &lt;span title=&quot;dom-SQLError-message&quot;&gt;message&lt;/span&gt;;
 };&lt;/pre&gt;
 
@@ -47072,7 +47260,7 @@
   const unsigned short &lt;span title=&quot;dom-WebSocket-CONNECTING&quot;&gt;CONNECTING&lt;/span&gt; = 0;
   const unsigned short &lt;span title=&quot;dom-WebSocket-OPEN&quot;&gt;OPEN&lt;/span&gt; = 1;
   const unsigned short &lt;span title=&quot;dom-WebSocket-CLOSED&quot;&gt;CLOSED&lt;/span&gt; = 2;
-  readonly attribute int &lt;span title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/span&gt;;
+  readonly attribute long &lt;span title=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/span&gt;;
 
   // networking
            attribute EventListener &lt;span title=&quot;handler-WebSocket-onopen&quot;&gt;onopen&lt;/span&gt;;
@@ -54314,11 +54502,6 @@
     keywords here: (input field)&quot; in the user's preferred
     language.&lt;/p&gt;
 
-    &lt;p class=&quot;XXX&quot;&gt; Then need to specify that if the form
-    submission causes just a single form control, whose name is
-    &quot;isindex&quot;, to be submitted, then we submit just the value part,
-    not the &quot;isindex=&quot; part.  &lt;/p&gt;
-
    &lt;/dd&gt;
 
 &lt;!-- XXX keygen support; don't forget form element pointer!
@@ -57334,7 +57517,6 @@
        (&quot;&lt;code title=&quot;&quot;&gt;foo&lt;/code&gt;&quot; vs &lt;code&gt;foo&lt;/code&gt;)
  XXX * need to properly xref events throughout, mark up DOMActivate, etc
  XXX * onclick=&quot;&quot; only fires if it is a MouseEvent ?
- XXX * &lt;isindex&gt; needs some prose in the form submission section
  XXX * hsivonen makes the following suggestions:
        &gt; To make document conformance a more useful concept for the purpose of catching
        &gt; author errors, I suggest that the following attributes be made required:


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009206.html">[html5] r2321 - [] (0) WF2: constraint validation API
</A></li>
	<LI>Next message: <A HREF="009208.html">[html5] r2323 - [e] (0) Clean up some stuff around the forms.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9207">[ date ]</a>
              <a href="thread.html#9207">[ thread ]</a>
              <a href="subject.html#9207">[ subject ]</a>
              <a href="author.html#9207">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
