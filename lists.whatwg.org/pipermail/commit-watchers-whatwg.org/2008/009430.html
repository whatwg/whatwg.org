<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2547 - [act] (1) * Header cells can now themselves have	headers. * Reversed the way the [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2547%20-%20%5Bact%5D%20%281%29%20%2A%20Header%20cells%20can%20now%20themselves%20have%0A%09headers.%20%2A%20Reversed%20the%20way%20the%20%5B...%5D&In-Reply-To=%3C20081220092143.048BC141AE9%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009429.html">
   <LINK REL="Next"  HREF="009431.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2547 - [act] (1) * Header cells can now themselves have	headers. * Reversed the way the [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2547%20-%20%5Bact%5D%20%281%29%20%2A%20Header%20cells%20can%20now%20themselves%20have%0A%09headers.%20%2A%20Reversed%20the%20way%20the%20%5B...%5D&In-Reply-To=%3C20081220092143.048BC141AE9%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2547 - [act] (1) * Header cells can now themselves have	headers. * Reversed the way the [...]">whatwg at whatwg.org
       </A><BR>
    <I>Sat Dec 20 01:21:43 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="009429.html">[html5] r2546 - [e] (0) fix ack to use full name
</A></li>
        <LI>Next message: <A HREF="009431.html">[html5] r2548 - [] (0) Define how to register new http-equiv	values. (credit: ma)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9430">[ date ]</a>
              <a href="thread.html#9430">[ thread ]</a>
              <a href="subject.html#9430">[ subject ]</a>
              <a href="author.html#9430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-12-20 01:21:43 -0800 (Sat, 20 Dec 2008)
New Revision: 2547

Modified:
   index
   source
Log:
[act] (1) * Header cells can now themselves have headers.

* Reversed the way the header association algorithm is presented, such
  that it starts from a cell and reports the headers rather than
  generating the list of headers for each cell on a header-by-header
  basis.

* Made it so that if headers=&quot;&quot; points to a &lt;td&gt; element, the
  association is now set up, despite being non-conforming.

* Header cells that are automatically associating now no longer stop
  associating when they hit equivalent cells until they have also hit
  a data cell.

* The &quot;col&quot; and &quot;row&quot; scope values now act like the implied auto value
  except that they force the direction.

* Empty header cells no longer get automatically associated.

* Removed the wide header cell heuristic.

* Made headers=&quot;&quot; use the same ID discovery mechanism as
  getElementById() (namely, first match), to avoid implementations
  having to support multiple such mechanisms.

* Made the spec define if a header is a column header or a row header
  in the case where scope=&quot;&quot; is omitted.

* Made scope=rowgroup and scope=colgroup non-conforming when not in an
  appropriate group.

Modified: index
===================================================================
--- index	2008-12-19 06:38:56 UTC (rev 2546)
+++ index	2008-12-20 09:21:43 UTC (rev 2547)
@@ -21,7 +21,7 @@
   &lt;div class=head&gt;
    &lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;h1&gt;HTML 5&lt;/h1&gt;
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 19 December 2008&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 20 December 2008&lt;/h2&gt;
    &lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;dl&gt;&lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -22195,38 +22195,18 @@
    &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
    &lt;dd&gt;&lt;code title=attr-tdth-colspan&gt;&lt;a href=#attr-tdth-colspan&gt;colspan&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
    &lt;dd&gt;&lt;code title=attr-tdth-rowspan&gt;&lt;a href=#attr-tdth-rowspan&gt;rowspan&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
-   &lt;dd&gt;&lt;code title=attr-td-headers&gt;&lt;a href=#attr-td-headers&gt;headers&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
-   &lt;!-- XXXv2 char, to specify the decimal character used in numeric cells --&gt;
+   &lt;dd&gt;&lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
+   &lt;!-- v2 char, to specify the decimal character used in numeric cells --&gt;
    &lt;dt&gt;DOM interface:&lt;/dt&gt;
    &lt;dd&gt;
-    &lt;pre class=idl&gt;interface &lt;dfn id=htmltabledatacellelement&gt;HTMLTableDataCellElement&lt;/dfn&gt; : &lt;a href=#htmltablecellelement&gt;HTMLTableCellElement&lt;/a&gt; {
-           attribute DOMString &lt;a href=#dom-td-headers title=dom-td-headers&gt;headers&lt;/a&gt;;
-};&lt;/pre&gt;
+    &lt;pre class=idl&gt;interface &lt;dfn id=htmltabledatacellelement&gt;HTMLTableDataCellElement&lt;/dfn&gt; : &lt;a href=#htmltablecellelement&gt;HTMLTableCellElement&lt;/a&gt; {};&lt;/pre&gt;
    &lt;/dd&gt;
   &lt;/dl&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; element represents a data &lt;a href=#concept-cell title=concept-cell&gt;cell&lt;/a&gt; in a table.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; element may have a &lt;dfn id=attr-td-headers title=attr-td-headers&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; content attribute
-  specified. The &lt;code title=attr-td-headers&gt;&lt;a href=#attr-td-headers&gt;headers&lt;/a&gt;&lt;/code&gt;
-  attribute, if specified, must contain a string consisting of an
-  &lt;a href=#unordered-set-of-unique-space-separated-tokens&gt;unordered set of unique space-separated tokens&lt;/a&gt;, each of
-  which must have the value of an ID of a &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element
-  taking part in the same &lt;a href=#concept-table title=concept-table&gt;table&lt;/a&gt; as
-  the &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; element (as defined by the &lt;a href=#table-model&gt;table
-  model&lt;/a&gt;).&lt;/p&gt;
-
-  &lt;p&gt;The exact effect of the attribute is described in detail in the
-  &lt;a href=#algorithm-for-assigning-header-cells-to-data-cells&gt;algorithm for assigning header cells to data cells&lt;/a&gt;,
-  which user agents must apply to determine the relationships between
-  data cells and header cells.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; element and its &lt;code title=attr-tdth-colspan&gt;&lt;a href=#attr-tdth-colspan&gt;colspan&lt;/a&gt;&lt;/code&gt; and &lt;code title=attr-tdth-rowspan&gt;&lt;a href=#attr-tdth-rowspan&gt;rowspan&lt;/a&gt;&lt;/code&gt; attributes take part in the
+  &lt;p class=note&gt;The &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; element and its &lt;code title=attr-tdth-colspan&gt;&lt;a href=#attr-tdth-colspan&gt;colspan&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-tdth-rowspan&gt;&lt;a href=#attr-tdth-rowspan&gt;rowspan&lt;/a&gt;&lt;/code&gt;, and &lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attributes take part in the
   &lt;a href=#table-model&gt;table model&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn id=dom-td-headers title=dom-td-headers&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; DOM
-  attribute must &lt;a href=#reflect&gt;reflect&lt;/a&gt; the content attribute of the
-  same name.&lt;/p&gt;
 
-
   &lt;h4 id=the-th-element&gt;&lt;span class=secno&gt;4.9.11 &lt;/span&gt;The &lt;dfn&gt;&lt;code&gt;th&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
   &lt;dl class=element&gt;&lt;dt&gt;Categories&lt;/dt&gt;
@@ -22238,6 +22218,7 @@
    &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
    &lt;dd&gt;&lt;code title=attr-tdth-colspan&gt;&lt;a href=#attr-tdth-colspan&gt;colspan&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
    &lt;dd&gt;&lt;code title=attr-tdth-rowspan&gt;&lt;a href=#attr-tdth-rowspan&gt;rowspan&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
+   &lt;dd&gt;&lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
    &lt;dd&gt;&lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt;&lt;/dd&gt;
    &lt;dt&gt;DOM interface:&lt;/dt&gt;
    &lt;dd&gt;
@@ -22255,28 +22236,34 @@
   &lt;dl&gt;&lt;dt&gt;The &lt;dfn id=attr-th-scope-row title=attr-th-scope-row&gt;&lt;code&gt;row&lt;/code&gt;&lt;/dfn&gt;
    keyword, which maps to the &lt;i&gt;row&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;row&lt;/i&gt; state means the header cell applies to all the
-   remaining cells in the row.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;row&lt;/i&gt; state means the header cell applies to some of
+   the subsequent cells in the same row(s).&lt;/dd&gt;
 
    &lt;dt&gt;The &lt;dfn id=attr-th-scope-col title=attr-th-scope-col&gt;&lt;code&gt;col&lt;/code&gt;&lt;/dfn&gt;
    keyword, which maps to the &lt;i&gt;column&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;column&lt;/i&gt; state means the header cell applies to all
-   the remaining cells in the column.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;column&lt;/i&gt; state means the header cell applies to some
+   of the subsequent cells in the same column(s).&lt;/dd&gt;
 
    &lt;dt&gt;The &lt;dfn id=attr-th-scope-rowgroup title=attr-th-scope-rowgroup&gt;&lt;code&gt;rowgroup&lt;/code&gt;&lt;/dfn&gt; keyword,
    which maps to the &lt;i&gt;row group&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;row group&lt;/i&gt; state means the header cell applies to
-   all the remaining cells in the row group.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;row group&lt;/i&gt; state means the header cell applies to all
+   the remaining cells in the row group. A &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element's
+   &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute must not be in
+   the &lt;a href=#attr-th-scope-rowgroup title=attr-th-scope-rowgroup&gt;row group&lt;/a&gt; state if
+   the element is not anchored in a &lt;a href=#concept-row-group title=concept-row-group&gt;row group&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;The &lt;dfn id=attr-th-scope-colgroup title=attr-th-scope-colgroup&gt;&lt;code&gt;colgroup&lt;/code&gt;&lt;/dfn&gt; keyword,
    which maps to the &lt;i&gt;column group&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;column group&lt;/i&gt; state means the header cell applies
-   to all the remaining cells in the column group.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;column group&lt;/i&gt; state means the header cell applies to
+   all the remaining cells in the column group. A &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt;
+   element's &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute must
+   not be in the &lt;a href=#attr-th-scope-colgroup title=attr-th-scope-colgroup&gt;column
+   group&lt;/a&gt; state if the element is not anchored in a &lt;a href=#concept-column-group title=concept-column-group&gt;column group&lt;/a&gt;.&lt;/dd&gt;
 
-   &lt;dt&gt;The &lt;i&gt;auto&lt;/i&gt; state&lt;/dt&gt;
+   &lt;dt&gt;The &lt;dfn id=attr-th-scope-auto title=attr-th-scope-auto&gt;auto&lt;/dfn&gt; state&lt;/dt&gt;
 
    &lt;dd&gt;The &lt;i&gt;auto&lt;/i&gt; state makes the header cell apply to a set of
    cells selected based on context.&lt;/dd&gt;
@@ -22284,12 +22271,7 @@
   &lt;/dl&gt;&lt;p&gt;The &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute's
   &lt;i&gt;missing value default&lt;/i&gt; is the &lt;i&gt;auto&lt;/i&gt; state.&lt;/p&gt;
 
-  &lt;p&gt;The exact effect of these values is described in detail in the
-  &lt;a href=#algorithm-for-assigning-header-cells-to-data-cells&gt;algorithm for assigning header cells to data cells&lt;/a&gt;,
-  which user agents must apply to determine the relationships between
-  data cells and header cells.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element and its &lt;code title=attr-tdth-colspan&gt;&lt;a href=#attr-tdth-colspan&gt;colspan&lt;/a&gt;&lt;/code&gt; and &lt;code title=attr-tdth-rowspan&gt;&lt;a href=#attr-tdth-rowspan&gt;rowspan&lt;/a&gt;&lt;/code&gt; attributes take part in the
+  &lt;p class=note&gt;The &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element and its &lt;code title=attr-tdth-colspan&gt;&lt;a href=#attr-tdth-colspan&gt;colspan&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-tdth-rowspan&gt;&lt;a href=#attr-tdth-rowspan&gt;rowspan&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt;, and &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attributes take part in the
   &lt;a href=#table-model&gt;table model&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-th-scope title=dom-th-scope&gt;&lt;code&gt;scope&lt;/code&gt;&lt;/dfn&gt; DOM
@@ -22308,6 +22290,18 @@
   attribute specified, whose value must be a &lt;a href=#valid-non-negative-integer&gt;valid non-negative
   integer&lt;/a&gt;.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element may have a &lt;dfn id=attr-tdth-headers title=attr-tdth-headers&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; content
+  attribute specified. The &lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attribute, if specified,
+  must contain a string consisting of an &lt;a href=#unordered-set-of-unique-space-separated-tokens&gt;unordered set of unique
+  space-separated tokens&lt;/a&gt;, each of which must have the value of
+  an ID of a &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element taking part in the same &lt;a href=#concept-table title=concept-table&gt;table&lt;/a&gt; as the &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; or
+  &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element (as defined by the &lt;a href=#table-model&gt;table
+  model&lt;/a&gt;).&lt;/p&gt;
+
+  &lt;p class=note&gt;The &lt;code title=attr-tdth-colspan&gt;&lt;a href=#attr-tdth-colspan&gt;colspan&lt;/a&gt;&lt;/code&gt;,
+  &lt;code title=attr-tdth-rowspan&gt;&lt;a href=#attr-tdth-rowspan&gt;rowspan&lt;/a&gt;&lt;/code&gt;, and &lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attributes take part in the
+  &lt;a href=#table-model&gt;table model&lt;/a&gt;.&lt;/p&gt;
+
   &lt;p&gt;The &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; elements implement
   interfaces that inherit from the &lt;code&gt;&lt;a href=#htmltablecellelement&gt;HTMLTableCellElement&lt;/a&gt;&lt;/code&gt;
   interface:&lt;/p&gt;
@@ -22315,6 +22309,7 @@
   &lt;pre class=idl&gt;interface &lt;dfn id=htmltablecellelement&gt;HTMLTableCellElement&lt;/dfn&gt; : &lt;a href=#htmlelement&gt;HTMLElement&lt;/a&gt; {
            attribute long &lt;a href=#dom-tdth-colspan title=dom-tdth-colSpan&gt;colSpan&lt;/a&gt;;
            attribute long &lt;a href=#dom-tdth-rowspan title=dom-tdth-rowSpan&gt;rowSpan&lt;/a&gt;;
+           attribute DOMString &lt;a href=#dom-tdth-headers title=dom-tdth-headers&gt;headers&lt;/a&gt;;
   readonly attribute long &lt;a href=#dom-tdth-cellindex title=dom-tdth-cellIndex&gt;cellIndex&lt;/a&gt;;
 };&lt;/pre&gt;
 
@@ -22329,6 +22324,10 @@
   attribute as a non-negative integer&lt;/a&gt; returns an error, is also
   1.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;dfn id=dom-tdth-headers title=dom-tdth-headers&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; DOM
+  attribute must &lt;a href=#reflect&gt;reflect&lt;/a&gt; the content attribute of the
+  same name.&lt;/p&gt;
+
   &lt;p&gt;The &lt;dfn id=dom-tdth-cellindex title=dom-tdth-cellIndex&gt;&lt;code&gt;cellIndex&lt;/code&gt;&lt;/dfn&gt;
   DOM attribute must, if the element has a parent &lt;code&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt;
   element, return the index of the cell's element in the parent
@@ -22356,10 +22355,13 @@
   the cell covers all the slots with coordinates (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;) where &lt;span&gt;&lt;var title=&quot;&quot;&gt;cell&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;cell&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;width&lt;/var&gt;&lt;/span&gt; and
   &lt;span&gt;&lt;var title=&quot;&quot;&gt;cell&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;cell&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;height&lt;/var&gt;&lt;/span&gt;. Cells can
   either be &lt;em&gt;data cells&lt;/em&gt; or &lt;em&gt;header cells&lt;/em&gt;. Data cells
-  correspond to &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; elements, and have zero or more
-  associated header cells. Header cells correspond to &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt;
-  elements.&lt;/p&gt;
+  correspond to &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; elements, and header cells correspond
+  to &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; elements. Cells of both types can have zero or
+  more associated header cells.&lt;/p&gt;
 
+  &lt;p&gt;It is possible, in certain error cases, for two cells to occupy
+  the same slot.&lt;/p&gt;
+
   &lt;p&gt;A &lt;dfn id=concept-row title=concept-row&gt;row&lt;/dfn&gt; is a complete set of slots
   from &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;=0&lt;/span&gt; to &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;=&lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt;, for a particular value of &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;. Rows correspond to &lt;code&gt;&lt;a href=#the-tr-element&gt;tr&lt;/a&gt;&lt;/code&gt; elements.&lt;/p&gt;
 
@@ -22925,11 +22927,11 @@
 
     &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; element is a
     &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element, let this new cell &lt;var title=&quot;&quot;&gt;c&lt;/var&gt;
-    be a header cell; otherwise, let it be a data cell. To establish
-    what header cells apply to a data cell, use the &lt;a href=#algorithm-for-assigning-header-cells-to-data-cells&gt;algorithm
-    for assigning header cells to data cells&lt;/a&gt; described in the
-    next section.&lt;/p&gt;
+    be a header cell; otherwise, let it be a data cell.&lt;/p&gt;
 
+    &lt;p&gt;To establish which header cells apply to the &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; element, use the &lt;a href=#algorithm-for-assigning-header-cells&gt;algorithm for
+    assigning header cells&lt;/a&gt; described in the next section.&lt;/p&gt;
+
     &lt;p&gt;If any of the slots involved already had a &lt;a href=#concept-cell title=concept-cell&gt;cell&lt;/a&gt; covering them, then this is a
     &lt;a href=#table-model-error&gt;table model error&lt;/a&gt;. Those slots now have two cells
     overlapping.&lt;/p&gt;
@@ -22986,290 +22988,343 @@
 
   &lt;h5 id=header-and-data-cell-semantics&gt;&lt;span class=secno&gt;4.9.13.2 &lt;/span&gt;Forming relationships between data cells and header cells&lt;/h5&gt;
 
-  &lt;p&gt;Each data cell can be assigned zero or more header cells. The
-  &lt;dfn id=algorithm-for-assigning-header-cells-to-data-cells&gt;algorithm for assigning header cells to data cells&lt;/dfn&gt; is as
-  follows.&lt;/p&gt;
+  &lt;p&gt;Each cell can be assigned zero or more header cells. The
+  &lt;dfn id=algorithm-for-assigning-header-cells&gt;algorithm for assigning header cells&lt;/dfn&gt; to a cell &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is as follows.&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;
+  &lt;ol&gt;&lt;!-- INITIALIZATION --&gt;&lt;li&gt;
 
-    &lt;p&gt;For each header cell in the table, in &lt;a href=#tree-order&gt;tree order&lt;/a&gt;,
-    run these substeps:&lt;/p&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt; be an empty list of
+    cells.&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;
+   &lt;/li&gt;
 
-      &lt;p&gt;Let (&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) be the coordinate of
-      the slot to which the header cell is anchored.&lt;/p&gt;
+   &lt;li&gt;
 
-     &lt;/li&gt;
+    &lt;p&gt;Let (&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) be the coordinate
+    of the slot to which the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is
+    anchored.&lt;/p&gt;
 
-     &lt;li&gt;
+   &lt;/li&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt; be
-      the width of the header cell.&lt;/p&gt;
+   &lt;li&gt;
 
-     &lt;/li&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; has a &lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attribute specified&lt;/dt&gt;
 
-     &lt;li&gt;
+     &lt;dd&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt; be
-      the height of the header cell.&lt;/p&gt;
+      &lt;!-- HEADERS=&quot;&quot; --&gt;
 
-     &lt;/li&gt;
+      &lt;ol&gt;&lt;li&gt;
 
-     &lt;li&gt;
+        &lt;p&gt;Take the value of the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;'s
+        &lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attribute and
+        &lt;a href=#split-a-string-on-spaces title=&quot;split a string on spaces&quot;&gt;split it on
+        spaces&lt;/a&gt;, letting &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt; be the list
+        of tokens obtained.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; be a list of data cells,
-      initially empty.&lt;/p&gt;
+       &lt;/li&gt;
 
-     &lt;/li&gt;
+       &lt;li&gt;
 
-     &lt;li&gt;
+        &lt;!-- support headers=&quot;&quot; to &lt;td&gt; for legacy compat --&gt;
+        &lt;!-- note that it's not conforming though --&gt;
+        &lt;p&gt;For each token in the &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt;, if the
+        first element in the &lt;code&gt;Document&lt;/code&gt; with an ID equal to
+        the token is a cell in the same &lt;a href=#concept-table title=concept-table&gt;table&lt;/a&gt;, and that cell is not the
+        &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;, then add that cell to &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p&gt;Examine the &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt;
-      attribute of the &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element corresponding to the
-      header cell, and, based on its state, apply the appropriate
-      substep:&lt;/p&gt;
+       &lt;/li&gt;
 
-      &lt;dl class=switch&gt;&lt;dt&gt;If it is in the &lt;i title=attr-th-scope-row&gt;&lt;a href=#attr-th-scope-row&gt;row&lt;/a&gt;&lt;/i&gt; state&lt;/dt&gt;
+      &lt;/ol&gt;&lt;/dd&gt;
 
-       &lt;dd&gt;
 
-        &lt;p&gt;Add all the data cells that cover slots with coordinates
-        (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and
-        &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-        cells&lt;/var&gt; list.&lt;/p&gt;
+     &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; does not have a &lt;code title=attr-tdth-headers&gt;&lt;a href=#attr-tdth-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attribute specified&lt;/dt&gt;
 
-       &lt;/dd&gt;
+     &lt;dd&gt;
 
-       &lt;dt&gt;If it is in the &lt;i title=attr-th-scope-col&gt;&lt;a href=#attr-th-scope-col&gt;column&lt;/a&gt;&lt;/i&gt; state&lt;/dt&gt;
+      &lt;ol&gt;&lt;li&gt;
 
-       &lt;dd&gt;
+        &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;
+        be the width of the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;p&gt;Add all the data cells that cover slots with coordinates
-        (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and
-        &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;y&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; list.&lt;/p&gt;
+       &lt;/li&gt;
 
-       &lt;/dd&gt;
+       &lt;li&gt;
 
-       &lt;dt&gt;If it is in the &lt;i title=attr-th-scope-rowgroup&gt;&lt;a href=#attr-th-scope-rowgroup&gt;row group&lt;/a&gt;&lt;/i&gt; state&lt;/dt&gt;
+        &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;
+        be the height of the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;dd&gt;
+       &lt;/li&gt;
 
-        &lt;p&gt;If the header cell is not in a &lt;a href=#concept-row-group title=concept-row-group&gt;row group&lt;/a&gt;, then do
-        nothing.&lt;/p&gt;
 
-        &lt;p&gt;Otherwise, let (0, &lt;var title=&quot;&quot;&gt;group&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) be the slot at which the row group is
-        anchored, let &lt;var title=&quot;&quot;&gt;height&lt;/var&gt; be the number of rows
-        in the row group, and add all the data cells that cover slots
-        with coordinates (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;group&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;height&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-        cells&lt;/var&gt; list.&lt;/p&gt;
+       &lt;!-- HORIZONTAL --&gt;
 
-       &lt;/dd&gt;
+       &lt;li&gt;
 
-       &lt;dt&gt;If it is in the &lt;i title=attr-th-scope-colgroup&gt;&lt;a href=#attr-th-scope-colgroup&gt;column group&lt;/a&gt;&lt;/i&gt; state&lt;/dt&gt;
+        &lt;p&gt;For each value of &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; from &lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt; to &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt;,
+        run the &lt;a href=#internal-algorithm-for-scanning-and-assigning-header-cells&gt;internal algorithm for scanning and assigning
+        header cells&lt;/a&gt;, with the &lt;var title=&quot;&quot;&gt;principal
+        cell&lt;/var&gt;, the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;, the initial
+        coordinate (&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;,&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;), and the
+        increments &lt;span&gt;&Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;=&minus;1&lt;/span&gt;
+        and &lt;span&gt;&Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;=0&lt;/span&gt;.&lt;/p&gt;
 
-       &lt;dd&gt;
+       &lt;/li&gt;
 
-        &lt;p&gt;If the header cell is not anchored in a &lt;a href=#concept-column-group title=concept-column-group&gt;column group&lt;/a&gt;, then do
-        nothing.&lt;/p&gt;
 
-        &lt;p&gt;Otherwise, let (&lt;var title=&quot;&quot;&gt;group&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, 0) be the slot at which that column
-        group is anchored, let &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; be the number
-        of columns in the column group, and add all the data cells
-        that cover slots with coordinates (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;group&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;width&lt;/var&gt;&lt;/span&gt; and
-        &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;y&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-        cells&lt;/var&gt; list.&lt;/p&gt;
+       &lt;!-- VERTICAL --&gt;
 
-       &lt;/dd&gt;
+       &lt;li&gt;
 
-       &lt;dt&gt;Otherwise, it is in the &lt;i title=&quot;&quot;&gt;auto&lt;/i&gt; state&lt;/dt&gt;
+        &lt;p&gt;For each value of &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; from &lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt; to &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt;,
+        run the &lt;a href=#internal-algorithm-for-scanning-and-assigning-header-cells&gt;internal algorithm for scanning and assigning
+        header cells&lt;/a&gt;, with the &lt;var title=&quot;&quot;&gt;principal
+        cell&lt;/var&gt;, the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;, the initial
+        coordinate (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;,&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), and the increments &lt;span&gt;&Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;=0&lt;/span&gt; and &lt;span&gt;&Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;=&minus;1&lt;/span&gt;.&lt;/p&gt;
 
-       &lt;dd&gt;
+       &lt;/li&gt;
 
-        &lt;p&gt;Run these steps:&lt;/p&gt;
 
-        &lt;ol&gt;&lt;li&gt;
+       &lt;!-- ROW GROUP HEADERS --&gt;
 
-          &lt;p&gt;If the header cell is &lt;a href=#equivalent-to-a-wide-cell&gt;equivalent to a wide
-          cell&lt;/a&gt;, let &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt; equal &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;.&lt;/p&gt;
+       &lt;li&gt;
 
-         &lt;/li&gt;
+        &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is anchored in a
+        &lt;a href=#concept-row-group title=concept-row-group&gt;row group&lt;/a&gt;, then add all
+        header cells that are &lt;a href=#row-group-header title=&quot;row group header&quot;&gt;row group
+        headers&lt;/a&gt; and are anchored in the same row group with an
+        &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;-coordinate less than or equal to
+        &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; and
+        a &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;-coordinate less than or equal to
+        &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; to
+        &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+       &lt;/li&gt;
 
-          &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; equal &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;.&lt;/p&gt;
 
-         &lt;/li&gt;
+       &lt;!-- COLUMN GROUP HEADERS --&gt;
 
-         &lt;li&gt;
+       &lt;li&gt;
 
-          &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; equal &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;.&lt;/p&gt;
+        &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is anchored in a
+        &lt;a href=#concept-column-group title=concept-column-group&gt;column group&lt;/a&gt;, then
+        add all header cells that are &lt;a href=#column-group-header title=&quot;column group
+        header&quot;&gt;column group headers&lt;/a&gt; and are anchored in the
+        same column group with an &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;-coordinate
+        less than or equal to &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; and a &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;-coordinate less than or equal to &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; to
+        &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;/li&gt;
+       &lt;/li&gt;
 
-         &lt;li&gt;
+      &lt;/ol&gt;&lt;/dd&gt;
 
-          &lt;p&gt;&lt;i&gt;Horizontal&lt;/i&gt;: If &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; is equal to
-          &lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;, then jump
-          down to the step below labeled &lt;i&gt;vertical&lt;/i&gt;.&lt;/p&gt;
+    &lt;/dl&gt;&lt;/li&gt;
 
-         &lt;/li&gt;
 
-         &lt;li&gt;
+   &lt;!-- CLEANUP --&gt;
 
-          &lt;p&gt;If there is a header cell anchored at (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) with height &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;, then jump down to the step
-          below labeled &lt;i&gt;vertical&lt;/i&gt;.&lt;/p&gt;
+   &lt;li&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;Remove all the &lt;a href=#empty-cell title=&quot;empty cell&quot;&gt;empty cells&lt;/a&gt; from
+    the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+   &lt;/li&gt;
 
-          &lt;p&gt;Add all the data cells that cover slots with coordinates
-          (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;=&nbsp;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;&lt;/span&gt; and &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to
-          the &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; list.&lt;/p&gt;
+   &lt;li&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;Remove any duplicates from the &lt;var title=&quot;&quot;&gt;header
+    list&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+   &lt;/li&gt;
 
-          &lt;p&gt;Increase &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; by 1.&lt;/p&gt;
+   &lt;li&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;Assign the headers in the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt; to
+    the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+   &lt;/li&gt;
 
-          &lt;p&gt;Jump up to the step above labeled &lt;i&gt;horizontal&lt;/i&gt;.&lt;/p&gt;
+  &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=internal-algorithm-for-scanning-and-assigning-header-cells&gt;internal algorithm for scanning and assigning header
+  cells&lt;/dfn&gt;, given a &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;, a &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;, a (&lt;var title=&quot;&quot;&gt;initial&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;initial&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) initial coordinate, and &Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt; increments, is as
+  follows:&lt;/p&gt;
 
-         &lt;/li&gt;
+  &lt;ol&gt;&lt;li&gt;
 
-         &lt;li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; equal &lt;var title=&quot;&quot;&gt;initial&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-          &lt;p&gt;&lt;i&gt;Vertical&lt;/i&gt;: If &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; is equal to
-          &lt;var title=&quot;&quot;&gt;y&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;, then jump
-          to the step below labeled &lt;i&gt;end&lt;/i&gt;.&lt;/p&gt;
+   &lt;/li&gt;
 
-         &lt;/li&gt;
+   &lt;li&gt;
 
-         &lt;li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; equal &lt;var title=&quot;&quot;&gt;initial&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-          &lt;p&gt;If there is a header cell &lt;var title=&quot;&quot;&gt;cell&lt;/var&gt;
-          anchored at (&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;), then follow
-          these substeps:&lt;/p&gt;
+   &lt;/li&gt;
 
-          &lt;ol&gt;&lt;li&gt;
+   &lt;li&gt;
 
-            &lt;p&gt;If the header cell &lt;var title=&quot;&quot;&gt;cell&lt;/var&gt; is
-            &lt;a href=#equivalent-to-a-wide-cell&gt;equivalent to a wide cell&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; be &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;. Otherwise, let &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; be the width of the header cell &lt;var title=&quot;&quot;&gt;cell&lt;/var&gt;.&lt;/p&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;opaque headers&lt;/var&gt; be an empty list of
+    cells.&lt;/p&gt;
 
-           &lt;/li&gt;
+   &lt;/li&gt;
 
-           &lt;li&gt;
+   &lt;li&gt;
 
-            &lt;p&gt;If &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; is equal to &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;, then jump
-            to the step below labeled &lt;i&gt;end&lt;/i&gt;.&lt;/p&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is a header cell&lt;/dt&gt;
 
-           &lt;/li&gt;
+     &lt;dd&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; be true, and let
+     &lt;var title=&quot;&quot;&gt;headers from current header block&lt;/var&gt; be a list
+     of cells containing just the &lt;var title=&quot;&quot;&gt;principal
+     cell&lt;/var&gt;.&lt;/dd&gt;
 
-          &lt;/ol&gt;&lt;/li&gt;
+     &lt;dt&gt;Otherwise&lt;/dt&gt;
 
-         &lt;li&gt;
+     &lt;dd&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; be false and let
+     &lt;var title=&quot;&quot;&gt;headers from current header block&lt;/var&gt; be an
+     empty list of cells.&lt;/p&gt;
 
-          &lt;p&gt;Add all the data cells that cover slots with coordinates
-          (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and
-          &lt;span&gt;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;=&nbsp;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-          cells&lt;/var&gt; list.&lt;/p&gt;
+    &lt;/dl&gt;&lt;/li&gt;
 
-         &lt;/li&gt;
+   &lt;li&gt;
 
-         &lt;li&gt;
+    &lt;p&gt;&lt;i&gt;Loop&lt;/i&gt;: Increment &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; by &Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;; increment &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; by &Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;.&lt;/p&gt;
 
-          &lt;p&gt;Increase &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; by 1.&lt;/p&gt;
+    &lt;p class=note&gt;For each invocation of this algorithm, one of
+    &Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt; will
+    be &minus;1, and the other will be 0.&lt;/p&gt;
 
-         &lt;/li&gt;
+   &lt;/li&gt;
 
-         &lt;li&gt;
+   &lt;li&gt;
 
-          &lt;p&gt;Jump up to the step above labeled &lt;i&gt;vertical&lt;/i&gt;.&lt;/p&gt;
+    &lt;p&gt;If either &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; or &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; is
+    less than 0, then abort this internal algorithm.&lt;/p&gt;
 
-         &lt;/li&gt;
+   &lt;/li&gt;
 
-         &lt;li&gt;
+   &lt;li&gt;
 
-          &lt;p&gt;&lt;i&gt;End&lt;/i&gt;: Coalesce all the duplicate entries in the
-          &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; list, so that each data cell
-          is only present once, in tree order.&lt;/p&gt;
+    &lt;p&gt;If there is no cell covering slot (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;,
+    &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;), or if there is more than one cell
+    covering slot (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;),
+    return to the substep marked &lt;i&gt;loop&lt;/i&gt;.&lt;/p&gt;
 
-         &lt;/li&gt;
+   &lt;/li&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+   &lt;li&gt;
 
-      &lt;/dl&gt;&lt;/li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; be the cell covering
+    slot (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;).&lt;/p&gt;
 
-     &lt;li&gt;
+   &lt;/li&gt;
 
-      &lt;p&gt;Assign the header cell to all the data cells in the &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; list that correspond to
-      &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; elements that do not have a &lt;code title=attr-td-headers&gt;&lt;a href=#attr-td-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attribute specified.&lt;/p&gt;
+   &lt;li&gt;
 
-     &lt;/li&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is a header cell&lt;/dt&gt;
 
-    &lt;/ol&gt;&lt;/li&gt;
+     &lt;dd&gt;
 
-   &lt;li&gt;
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;Set &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; to
+       true.&lt;/li&gt;
 
-    &lt;p&gt;For each data cell in the table, in &lt;a href=#tree-order&gt;tree order&lt;/a&gt;,
-    run these substeps:&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Add &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;headers from current header block&lt;/var&gt;.&lt;/li&gt;
 
-    &lt;ol&gt;&lt;li&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; be false.&lt;/li&gt;
 
-      &lt;p&gt;If the data cell corresponds to a &lt;code&gt;&lt;a href=#the-td-element&gt;td&lt;/a&gt;&lt;/code&gt; element
-      that does not have a &lt;code title=attr-td-headers&gt;&lt;a href=#attr-td-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attribute specified, then
-      skip these substeps and move on to the next data cell (if
-      any).&lt;/p&gt;
+       &lt;li&gt;
 
-     &lt;/li&gt;
+        &lt;dl class=switch&gt;&lt;dt&gt;If &Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt; is 0&lt;/dt&gt;
 
-     &lt;li&gt;
+         &lt;dd&gt;
 
-      &lt;p&gt;Otherwise, take the value of the &lt;code title=attr-td-headers&gt;&lt;a href=#attr-td-headers&gt;headers&lt;/a&gt;&lt;/code&gt; attribute and &lt;a href=#split-a-string-on-spaces title=&quot;split a string on spaces&quot;&gt;split it on spaces&lt;/a&gt;,
-      letting &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt; be the list of tokens
-      obtained.&lt;/p&gt;
+          &lt;p&gt;If there is no cell in the &lt;var title=&quot;&quot;&gt;opaque
+          headers&lt;/var&gt; list anchored with the same &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;-coordinate as the &lt;var title=&quot;&quot;&gt;current
+          cell&lt;/var&gt;, and with the same width as &lt;var title=&quot;&quot;&gt;current
+          cell&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; be
+          true.&lt;/p&gt;
 
-     &lt;/li&gt;
+          &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is not a
+          &lt;a href=#column-header&gt;column header&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; be true.&lt;/p&gt;
 
-     &lt;li&gt;
+         &lt;/dd&gt;
 
-      &lt;!-- XXX if nothing was added to this subalgorithm, then make it
-      a single paragraph instead of a nested list. --&gt;
+         &lt;dt&gt;If &Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt; is 0&lt;/dt&gt;
 
-      &lt;p&gt;For each token in the &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt;, run the
-      following steps:&lt;/p&gt;
+         &lt;dd&gt;
 
-      &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;id&lt;/var&gt; be the token.&lt;/li&gt;
+          &lt;p&gt;If there is no cell in the &lt;var title=&quot;&quot;&gt;opaque
+          headers&lt;/var&gt; list anchored with the same &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;-coordinate as the &lt;var title=&quot;&quot;&gt;current
+          cell&lt;/var&gt;, and with the same height as &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; be true.&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;If there is a header cell in the &lt;a href=#concept-table title=concept-table&gt;table&lt;/a&gt; whose corresponding
-       &lt;code&gt;&lt;a href=#the-th-element&gt;th&lt;/a&gt;&lt;/code&gt; element has an ID that is equal to the value of
-       &lt;var title=&quot;&quot;&gt;id&lt;/var&gt;, then assign the first such header cell
-       in tree order to the data cell.&lt;/li&gt;
+          &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is not a
+          &lt;a href=#row-header&gt;row header&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; be true.&lt;/p&gt;
 
-      &lt;/ol&gt;&lt;/li&gt;
+         &lt;/dd&gt;
 
-    &lt;/ol&gt;&lt;/li&gt;
+        &lt;/dl&gt;&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p&gt;A header cell anchored at (&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) with width &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt; is said to be &lt;dfn id=equivalent-to-a-wide-cell&gt;equivalent to a wide
-  cell&lt;/dfn&gt; if all the slots with coordinates (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, are all either empty or covered
-  by &lt;a href=#empty-data-cell title=&quot;empty data cell&quot;&gt;empty data cells&lt;/a&gt;.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; is false, then add the
+       &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;headers
+       list&lt;/var&gt;.&lt;/li&gt;
 
-  &lt;p&gt;A data cell is said to be an &lt;dfn id=empty-data-cell&gt;empty data cell&lt;/dfn&gt; if it
-  contains no elements and its text content, if any, consists only of
+      &lt;/ol&gt;&lt;/dd&gt;
+
+     &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is a data cell and &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; is true&lt;/dt&gt;
+
+     &lt;dd&gt;&lt;p&gt;Set &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; to false. Add
+     all the cells in &lt;var title=&quot;&quot;&gt;headers from current header
+     block&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;opaque headers&lt;/var&gt; list, and
+     empty the &lt;var title=&quot;&quot;&gt;headers from current header block&lt;/var&gt;
+     list.&lt;/p&gt;
+
+    &lt;/dl&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Return to the step marked &lt;i&gt;loop&lt;/i&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;A header cell anchored at the slot with coordinate (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;) with width &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;height&lt;/var&gt; is said
+  to be a &lt;dfn id=column-header&gt;column header&lt;/dfn&gt; if any of the following conditions
+  are true:&lt;/p&gt;
+
+  &lt;ul&gt;&lt;li&gt;The cell's &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute
+   is in the &lt;a href=#attr-th-scope-col title=attr-th-scope-col&gt;column&lt;/a&gt; state&lt;/li&gt;
+
+   &lt;li&gt;The cell's &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute
+   is in the &lt;a href=#attr-th-scope-auto title=attr-th-scope-auto&gt;auto&lt;/a&gt; state, and
+   there are no data cells in any of the cells covering slots with
+   &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;-coordinates &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;
+   .. &lt;span&gt;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;height&lt;/var&gt;-1&lt;/span&gt;.&lt;/li&gt;
+
+  &lt;/ul&gt;&lt;p&gt;A header cell anchored at the slot with coordinate (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;) with width &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;height&lt;/var&gt; is said
+  to be a &lt;dfn id=row-header&gt;row header&lt;/dfn&gt; if any of the following conditions
+  are true:&lt;/p&gt;
+
+  &lt;ul&gt;&lt;li&gt;The cell's &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute
+   is in the &lt;a href=#attr-th-scope-row title=attr-th-scope-row&gt;row&lt;/a&gt; state&lt;/li&gt;
+
+   &lt;li&gt;The cell's &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute
+   is in the &lt;a href=#attr-th-scope-auto title=attr-th-scope-auto&gt;auto&lt;/a&gt; state, and
+   the cells is not a &lt;a href=#column-header&gt;column header&lt;/a&gt;, and there are no
+   data cells in any of the cells covering slots with &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;-coordinates &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; .. &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;width&lt;/var&gt;-1&lt;/span&gt;.&lt;/li&gt;
+
+  &lt;/ul&gt;&lt;p&gt;A header cell is said to be a &lt;dfn id=column-group-header&gt;column group header&lt;/dfn&gt; if
+  its &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute is in the
+  &lt;a href=#attr-th-scope-colgroup title=attr-th-scope-colgroup&gt;column group&lt;/a&gt; state.&lt;/p&gt;
+
+  &lt;p&gt;A header cell is said to be a &lt;dfn id=row-group-header&gt;row group header&lt;/dfn&gt; if
+  its &lt;code title=attr-th-scope&gt;&lt;a href=#attr-th-scope&gt;scope&lt;/a&gt;&lt;/code&gt; attribute is in the
+  &lt;a href=#attr-th-scope-rowgroup title=attr-th-scope-rowgroup&gt;row group&lt;/a&gt; state.&lt;/p&gt;
+
+  &lt;p&gt;A cell is said to be an &lt;dfn id=empty-cell&gt;empty cell&lt;/dfn&gt; if it contains no
+  elements and its text content, if any, consists only of
   &lt;a href=#white_space&gt;White_Space&lt;/a&gt; characters.&lt;/p&gt;
 
-  &lt;p&gt;User agents may remove &lt;a href=#empty-data-cell title=&quot;empty data cell&quot;&gt;empty data
-  cells&lt;/a&gt; when analyzing data in a &lt;a href=#concept-table title=concept-table&gt;table&lt;/a&gt;.&lt;/p&gt;
 
 
 
 
-
   &lt;h3 id=forms&gt;&lt;span class=secno&gt;4.10 &lt;/span&gt;Forms&lt;/h3&gt;
 
   &lt;p&gt;Forms allow unscripted client-server interaction: given a form, a

Modified: source
===================================================================
--- source	2008-12-19 06:38:56 UTC (rev 2546)
+++ source	2008-12-20 09:21:43 UTC (rev 2547)
@@ -24531,44 +24531,24 @@
    &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
    &lt;dd&gt;&lt;code title=&quot;attr-tdth-colspan&quot;&gt;colspan&lt;/code&gt;&lt;/dd&gt;
    &lt;dd&gt;&lt;code title=&quot;attr-tdth-rowspan&quot;&gt;rowspan&lt;/code&gt;&lt;/dd&gt;
-   &lt;dd&gt;&lt;code title=&quot;attr-td-headers&quot;&gt;headers&lt;/code&gt;&lt;/dd&gt;
-   &lt;!-- XXXv2 char, to specify the decimal character used in numeric cells --&gt;
+   &lt;dd&gt;&lt;code title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt;&lt;/dd&gt;
+   &lt;!-- v2 char, to specify the decimal character used in numeric cells --&gt;
    &lt;dt&gt;DOM interface:&lt;/dt&gt;
    &lt;dd&gt;
-    &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;HTMLTableDataCellElement&lt;/dfn&gt; : &lt;span&gt;HTMLTableCellElement&lt;/span&gt; {
-           attribute DOMString &lt;span title=&quot;dom-td-headers&quot;&gt;headers&lt;/span&gt;;
-};&lt;/pre&gt;
+    &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;HTMLTableDataCellElement&lt;/dfn&gt; : &lt;span&gt;HTMLTableCellElement&lt;/span&gt; {};&lt;/pre&gt;
    &lt;/dd&gt;
   &lt;/dl&gt;
 
   &lt;p&gt;The &lt;code&gt;td&lt;/code&gt; element represents a data &lt;span
   title=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; in a table.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code&gt;td&lt;/code&gt; element may have a &lt;dfn
-  title=&quot;attr-td-headers&quot;&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; content attribute
-  specified. The &lt;code title=&quot;attr-td-headers&quot;&gt;headers&lt;/code&gt;
-  attribute, if specified, must contain a string consisting of an
-  &lt;span&gt;unordered set of unique space-separated tokens&lt;/span&gt;, each of
-  which must have the value of an ID of a &lt;code&gt;th&lt;/code&gt; element
-  taking part in the same &lt;span title=&quot;concept-table&quot;&gt;table&lt;/span&gt; as
-  the &lt;code&gt;td&lt;/code&gt; element (as defined by the &lt;span&gt;table
-  model&lt;/span&gt;).&lt;/p&gt;
-
-  &lt;p&gt;The exact effect of the attribute is described in detail in the
-  &lt;span&gt;algorithm for assigning header cells to data cells&lt;/span&gt;,
-  which user agents must apply to determine the relationships between
-  data cells and header cells.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;code&gt;td&lt;/code&gt; element and its &lt;code
-  title=&quot;attr-tdth-colspan&quot;&gt;colspan&lt;/code&gt; and &lt;code
-  title=&quot;attr-tdth-rowspan&quot;&gt;rowspan&lt;/code&gt; attributes take part in the
+  &lt;p class=&quot;note&quot;&gt;The &lt;code&gt;td&lt;/code&gt; element and its &lt;code
+  title=&quot;attr-tdth-colspan&quot;&gt;colspan&lt;/code&gt;, &lt;code
+  title=&quot;attr-tdth-rowspan&quot;&gt;rowspan&lt;/code&gt;, and &lt;code
+  title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt; attributes take part in the
   &lt;span&gt;table model&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn title=&quot;dom-td-headers&quot;&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; DOM
-  attribute must &lt;span&gt;reflect&lt;/span&gt; the content attribute of the
-  same name.&lt;/p&gt;
 
-
   &lt;h4&gt;The &lt;dfn&gt;&lt;code&gt;th&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
   &lt;dl class=&quot;element&quot;&gt;
@@ -24581,6 +24561,7 @@
    &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
    &lt;dd&gt;&lt;code title=&quot;attr-tdth-colspan&quot;&gt;colspan&lt;/code&gt;&lt;/dd&gt;
    &lt;dd&gt;&lt;code title=&quot;attr-tdth-rowspan&quot;&gt;rowspan&lt;/code&gt;&lt;/dd&gt;
+   &lt;dd&gt;&lt;code title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt;&lt;/dd&gt;
    &lt;dd&gt;&lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt;&lt;/dd&gt;
    &lt;dt&gt;DOM interface:&lt;/dt&gt;
    &lt;dd&gt;
@@ -24604,30 +24585,38 @@
    &lt;dt&gt;The &lt;dfn title=&quot;attr-th-scope-row&quot;&gt;&lt;code&gt;row&lt;/code&gt;&lt;/dfn&gt;
    keyword, which maps to the &lt;i&gt;row&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;row&lt;/i&gt; state means the header cell applies to all the
-   remaining cells in the row.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;row&lt;/i&gt; state means the header cell applies to some of
+   the subsequent cells in the same row(s).&lt;/dd&gt;
 
    &lt;dt&gt;The &lt;dfn title=&quot;attr-th-scope-col&quot;&gt;&lt;code&gt;col&lt;/code&gt;&lt;/dfn&gt;
    keyword, which maps to the &lt;i&gt;column&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;column&lt;/i&gt; state means the header cell applies to all
-   the remaining cells in the column.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;column&lt;/i&gt; state means the header cell applies to some
+   of the subsequent cells in the same column(s).&lt;/dd&gt;
 
    &lt;dt&gt;The &lt;dfn
    title=&quot;attr-th-scope-rowgroup&quot;&gt;&lt;code&gt;rowgroup&lt;/code&gt;&lt;/dfn&gt; keyword,
    which maps to the &lt;i&gt;row group&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;row group&lt;/i&gt; state means the header cell applies to
-   all the remaining cells in the row group.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;row group&lt;/i&gt; state means the header cell applies to all
+   the remaining cells in the row group. A &lt;code&gt;th&lt;/code&gt; element's
+   &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute must not be in
+   the &lt;span title=&quot;attr-th-scope-rowgroup&quot;&gt;row group&lt;/span&gt; state if
+   the element is not anchored in a &lt;span
+   title=&quot;concept-row-group&quot;&gt;row group&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;The &lt;dfn
    title=&quot;attr-th-scope-colgroup&quot;&gt;&lt;code&gt;colgroup&lt;/code&gt;&lt;/dfn&gt; keyword,
    which maps to the &lt;i&gt;column group&lt;/i&gt; state&lt;/dt&gt;
 
-   &lt;dd&gt;The &lt;i&gt;column group&lt;/i&gt; state means the header cell applies
-   to all the remaining cells in the column group.&lt;/dd&gt;
+   &lt;dd&gt;The &lt;i&gt;column group&lt;/i&gt; state means the header cell applies to
+   all the remaining cells in the column group. A &lt;code&gt;th&lt;/code&gt;
+   element's &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute must
+   not be in the &lt;span title=&quot;attr-th-scope-colgroup&quot;&gt;column
+   group&lt;/span&gt; state if the element is not anchored in a &lt;span
+   title=&quot;concept-column-group&quot;&gt;column group&lt;/span&gt;.&lt;/dd&gt;
 
-   &lt;dt&gt;The &lt;i&gt;auto&lt;/i&gt; state&lt;/dt&gt;
+   &lt;dt&gt;The &lt;dfn title=&quot;attr-th-scope-auto&quot;&gt;auto&lt;/dfn&gt; state&lt;/dt&gt;
 
    &lt;dd&gt;The &lt;i&gt;auto&lt;/i&gt; state makes the header cell apply to a set of
    cells selected based on context.&lt;/dd&gt;
@@ -24637,14 +24626,11 @@
   &lt;p&gt;The &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute's
   &lt;i&gt;missing value default&lt;/i&gt; is the &lt;i&gt;auto&lt;/i&gt; state.&lt;/p&gt;
 
-  &lt;p&gt;The exact effect of these values is described in detail in the
-  &lt;span&gt;algorithm for assigning header cells to data cells&lt;/span&gt;,
-  which user agents must apply to determine the relationships between
-  data cells and header cells.&lt;/p&gt;
-
-  &lt;p&gt;The &lt;code&gt;th&lt;/code&gt; element and its &lt;code
-  title=&quot;attr-tdth-colspan&quot;&gt;colspan&lt;/code&gt; and &lt;code
-  title=&quot;attr-tdth-rowspan&quot;&gt;rowspan&lt;/code&gt; attributes take part in the
+  &lt;p class=&quot;note&quot;&gt;The &lt;code&gt;th&lt;/code&gt; element and its &lt;code
+  title=&quot;attr-tdth-colspan&quot;&gt;colspan&lt;/code&gt;, &lt;code
+  title=&quot;attr-tdth-rowspan&quot;&gt;rowspan&lt;/code&gt;, &lt;code
+  title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt;, and &lt;code
+  title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attributes take part in the
   &lt;span&gt;table model&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-th-scope&quot;&gt;&lt;code&gt;scope&lt;/code&gt;&lt;/dfn&gt; DOM
@@ -24664,6 +24650,22 @@
   attribute specified, whose value must be a &lt;span&gt;valid non-negative
   integer&lt;/span&gt;.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;code&gt;td&lt;/code&gt; and &lt;code&gt;th&lt;/code&gt; element may have a &lt;dfn
+  title=&quot;attr-tdth-headers&quot;&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; content
+  attribute specified. The &lt;code
+  title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt; attribute, if specified,
+  must contain a string consisting of an &lt;span&gt;unordered set of unique
+  space-separated tokens&lt;/span&gt;, each of which must have the value of
+  an ID of a &lt;code&gt;th&lt;/code&gt; element taking part in the same &lt;span
+  title=&quot;concept-table&quot;&gt;table&lt;/span&gt; as the &lt;code&gt;td&lt;/code&gt; or
+  &lt;code&gt;th&lt;/code&gt; element (as defined by the &lt;span&gt;table
+  model&lt;/span&gt;).&lt;/p&gt;
+
+  &lt;p class=&quot;note&quot;&gt;The &lt;code title=&quot;attr-tdth-colspan&quot;&gt;colspan&lt;/code&gt;,
+  &lt;code title=&quot;attr-tdth-rowspan&quot;&gt;rowspan&lt;/code&gt;, and &lt;code
+  title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt; attributes take part in the
+  &lt;span&gt;table model&lt;/span&gt;.&lt;/p&gt;
+
   &lt;p&gt;The &lt;code&gt;td&lt;/code&gt; and &lt;code&gt;th&lt;/code&gt; elements implement
   interfaces that inherit from the &lt;code&gt;HTMLTableCellElement&lt;/code&gt;
   interface:&lt;/p&gt;
@@ -24671,6 +24673,7 @@
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;HTMLTableCellElement&lt;/dfn&gt; : &lt;span&gt;HTMLElement&lt;/span&gt; {
            attribute long &lt;span title=&quot;dom-tdth-colSpan&quot;&gt;colSpan&lt;/span&gt;;
            attribute long &lt;span title=&quot;dom-tdth-rowSpan&quot;&gt;rowSpan&lt;/span&gt;;
+           attribute DOMString &lt;span title=&quot;dom-tdth-headers&quot;&gt;headers&lt;/span&gt;;
   readonly attribute long &lt;span title=&quot;dom-tdth-cellIndex&quot;&gt;cellIndex&lt;/span&gt;;
 };&lt;/pre&gt;
 
@@ -24686,6 +24689,10 @@
   attribute as a non-negative integer&lt;/span&gt; returns an error, is also
   1.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;dfn title=&quot;dom-tdth-headers&quot;&gt;&lt;code&gt;headers&lt;/code&gt;&lt;/dfn&gt; DOM
+  attribute must &lt;span&gt;reflect&lt;/span&gt; the content attribute of the
+  same name.&lt;/p&gt;
+
   &lt;p&gt;The &lt;dfn title=&quot;dom-tdth-cellIndex&quot;&gt;&lt;code&gt;cellIndex&lt;/code&gt;&lt;/dfn&gt;
   DOM attribute must, if the element has a parent &lt;code&gt;tr&lt;/code&gt;
   element, return the index of the cell's element in the parent
@@ -24729,10 +24736,13 @@
   title=&quot;&quot;&gt;y&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;cell&lt;sub
   title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;height&lt;/var&gt;&lt;/span&gt;. Cells can
   either be &lt;em&gt;data cells&lt;/em&gt; or &lt;em&gt;header cells&lt;/em&gt;. Data cells
-  correspond to &lt;code&gt;td&lt;/code&gt; elements, and have zero or more
-  associated header cells. Header cells correspond to &lt;code&gt;th&lt;/code&gt;
-  elements.&lt;/p&gt;
+  correspond to &lt;code&gt;td&lt;/code&gt; elements, and header cells correspond
+  to &lt;code&gt;th&lt;/code&gt; elements. Cells of both types can have zero or
+  more associated header cells.&lt;/p&gt;
 
+  &lt;p&gt;It is possible, in certain error cases, for two cells to occupy
+  the same slot.&lt;/p&gt;
+
   &lt;p&gt;A &lt;dfn title=&quot;concept-row&quot;&gt;row&lt;/dfn&gt; is a complete set of slots
   from &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;=0&lt;/span&gt; to &lt;span&gt;&lt;var
   title=&quot;&quot;&gt;x&lt;/var&gt;=&lt;var title=&quot;&quot;&gt;x&lt;sub
@@ -25437,11 +25447,12 @@
 
     &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; element is a
     &lt;code&gt;th&lt;/code&gt; element, let this new cell &lt;var title=&quot;&quot;&gt;c&lt;/var&gt;
-    be a header cell; otherwise, let it be a data cell. To establish
-    what header cells apply to a data cell, use the &lt;span&gt;algorithm
-    for assigning header cells to data cells&lt;/span&gt; described in the
-    next section.&lt;/p&gt;
+    be a header cell; otherwise, let it be a data cell.&lt;/p&gt;
 
+    &lt;p&gt;To establish which header cells apply to the &lt;var
+    title=&quot;&quot;&gt;current cell&lt;/var&gt; element, use the &lt;span&gt;algorithm for
+    assigning header cells&lt;/span&gt; described in the next section.&lt;/p&gt;
+
     &lt;p&gt;If any of the slots involved already had a &lt;span
     title=&quot;concept-cell&quot;&gt;cell&lt;/span&gt; covering them, then this is a
     &lt;span&gt;table model error&lt;/span&gt;. Those slots now have two cells
@@ -25510,413 +25521,435 @@
 
   &lt;h5 id=&quot;header-and-data-cell-semantics&quot;&gt;Forming relationships between data cells and header cells&lt;/h5&gt;
 
-  &lt;p&gt;Each data cell can be assigned zero or more header cells. The
-  &lt;dfn&gt;algorithm for assigning header cells to data cells&lt;/dfn&gt; is as
-  follows.&lt;/p&gt;
+  &lt;p&gt;Each cell can be assigned zero or more header cells. The
+  &lt;dfn&gt;algorithm for assigning header cells&lt;/dfn&gt; to a cell &lt;var
+  title=&quot;&quot;&gt;principal cell&lt;/var&gt; is as follows.&lt;/p&gt;
 
   &lt;ol&gt;
 
+
+   &lt;!-- INITIALIZATION --&gt;
+
    &lt;li&gt;
 
-    &lt;p&gt;For each header cell in the table, in &lt;span&gt;tree order&lt;/span&gt;,
-    run these substeps:&lt;/p&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt; be an empty list of
+    cells.&lt;/p&gt;
 
-    &lt;ol&gt;
+   &lt;/li&gt;
 
-     &lt;li&gt;
+   &lt;li&gt;
 
-      &lt;p&gt;Let (&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var
-      title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) be the coordinate of
-      the slot to which the header cell is anchored.&lt;/p&gt;
+    &lt;p&gt;Let (&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var
+    title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) be the coordinate
+    of the slot to which the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is
+    anchored.&lt;/p&gt;
 
-     &lt;/li&gt;
+   &lt;/li&gt;
 
-     &lt;li&gt;
+   &lt;li&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt; be
-      the width of the header cell.&lt;/p&gt;
+    &lt;dl class=&quot;switch&quot;&gt;
 
-     &lt;/li&gt;
+     &lt;dt&gt;If the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; has a &lt;code
+     title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt; attribute specified&lt;/dt&gt;
 
-     &lt;li&gt;
+     &lt;dd&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt; be
-      the height of the header cell.&lt;/p&gt;
+      &lt;!-- HEADERS=&quot;&quot; --&gt;
 
-     &lt;/li&gt;
+      &lt;ol&gt;
 
-     &lt;li&gt;
+       &lt;li&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; be a list of data cells,
-      initially empty.&lt;/p&gt;
+        &lt;p&gt;Take the value of the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;'s
+        &lt;code title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt; attribute and
+        &lt;span title=&quot;split a string on spaces&quot;&gt;split it on
+        spaces&lt;/span&gt;, letting &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt; be the list
+        of tokens obtained.&lt;/p&gt;
 
-     &lt;/li&gt;
+       &lt;/li&gt;
 
-     &lt;li&gt;
+       &lt;li&gt;
 
-      &lt;p&gt;Examine the &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt;
-      attribute of the &lt;code&gt;th&lt;/code&gt; element corresponding to the
-      header cell, and, based on its state, apply the appropriate
-      substep:&lt;/p&gt;
+        &lt;!-- support headers=&quot;&quot; to &lt;td&gt; for legacy compat --&gt;
+        &lt;!-- note that it's not conforming though --&gt;
+        &lt;p&gt;For each token in the &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt;, if the
+        first element in the &lt;code&gt;Document&lt;/code&gt; with an ID equal to
+        the token is a cell in the same &lt;span
+        title=&quot;concept-table&quot;&gt;table&lt;/span&gt;, and that cell is not the
+        &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;, then add that cell to &lt;var
+        title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;dl class=&quot;switch&quot;&gt;
+       &lt;/li&gt;
 
-       &lt;dt&gt;If it is in the &lt;i title=&quot;attr-th-scope-row&quot;&gt;row&lt;/i&gt; state&lt;/dt&gt;
+      &lt;/ol&gt;
 
-       &lt;dd&gt;
+     &lt;/dd&gt;
 
-        &lt;p&gt;Add all the data cells that cover slots with coordinates
-        (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var
-        title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var
-        title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var
-        title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var
-        title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var
-        title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and
-        &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-        cells&lt;/var&gt; list.&lt;/p&gt;
 
-       &lt;/dd&gt;
+     &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; does not have a &lt;code
+     title=&quot;attr-tdth-headers&quot;&gt;headers&lt;/code&gt; attribute specified&lt;/dt&gt;
 
-       &lt;dt&gt;If it is in the &lt;i title=&quot;attr-th-scope-col&quot;&gt;column&lt;/i&gt; state&lt;/dt&gt;
+     &lt;dd&gt;
 
-       &lt;dd&gt;
+      &lt;ol&gt;
 
-        &lt;p&gt;Add all the data cells that cover slots with coordinates
-        (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var
-        title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var
-        title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var
-        title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var
-        title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var
-        title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and
-        &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var
-        title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var
-        title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var
-        title=&quot;&quot;&gt;y&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to the &lt;var
-        title=&quot;&quot;&gt;data cells&lt;/var&gt; list.&lt;/p&gt;
+       &lt;li&gt;
 
-       &lt;/dd&gt;
+        &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;
+        be the width of the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;.&lt;/p&gt;
 
-       &lt;dt&gt;If it is in the &lt;i title=&quot;attr-th-scope-rowgroup&quot;&gt;row group&lt;/i&gt; state&lt;/dt&gt;
+       &lt;/li&gt;
 
-       &lt;dd&gt;
+       &lt;li&gt;
 
-        &lt;p&gt;If the header cell is not in a &lt;span
-        title=&quot;concept-row-group&quot;&gt;row group&lt;/span&gt;, then do
-        nothing.&lt;/p&gt;
+        &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;
+        be the height of the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;p&gt;Otherwise, let (0, &lt;var title=&quot;&quot;&gt;group&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) be the slot at which the row group is
-        anchored, let &lt;var title=&quot;&quot;&gt;height&lt;/var&gt; be the number of rows
-        in the row group, and add all the data cells that cover slots
-        with coordinates (&lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;x&lt;sub
-        title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and &lt;span&gt;&lt;var
-        title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var
-        title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var
-        title=&quot;&quot;&gt;group&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var
-        title=&quot;&quot;&gt;height&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-        cells&lt;/var&gt; list.&lt;/p&gt;
+       &lt;/li&gt;
 
-       &lt;/dd&gt;
 
-       &lt;dt&gt;If it is in the &lt;i title=&quot;attr-th-scope-colgroup&quot;&gt;column group&lt;/i&gt; state&lt;/dt&gt;
+       &lt;!-- HORIZONTAL --&gt;
 
-       &lt;dd&gt;
+       &lt;li&gt;
 
-        &lt;p&gt;If the header cell is not anchored in a &lt;span
-        title=&quot;concept-column-group&quot;&gt;column group&lt;/span&gt;, then do
-        nothing.&lt;/p&gt;
+        &lt;p&gt;For each value of &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; from &lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt; to &lt;span&gt;&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt;,
+        run the &lt;span&gt;internal algorithm for scanning and assigning
+        header cells&lt;/span&gt;, with the &lt;var title=&quot;&quot;&gt;principal
+        cell&lt;/var&gt;, the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;, the initial
+        coordinate (&lt;var title=&quot;&quot;&gt;principal&lt;sub
+        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;,&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;), and the
+        increments &lt;span&gt;&Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;=&amp;#x2212;1&lt;/span&gt;
+        and &lt;span&gt;&Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;=0&lt;/span&gt;.&lt;/p&gt;
 
-        &lt;p&gt;Otherwise, let (&lt;var title=&quot;&quot;&gt;group&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, 0) be the slot at which that column
-        group is anchored, let &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; be the number
-        of columns in the column group, and add all the data cells
-        that cover slots with coordinates (&lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;group&lt;sub
-        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;width&lt;/var&gt;&lt;/span&gt; and
-        &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;y&lt;sub
-        title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-        cells&lt;/var&gt; list.&lt;/p&gt;
+       &lt;/li&gt;
 
-       &lt;/dd&gt;
 
-       &lt;dt&gt;Otherwise, it is in the &lt;i title=&quot;&quot;&gt;auto&lt;/i&gt; state&lt;/dt&gt;
+       &lt;!-- VERTICAL --&gt;
 
-       &lt;dd&gt;
+       &lt;li&gt;
 
-        &lt;p&gt;Run these steps:&lt;/p&gt;
+        &lt;p&gt;For each value of &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; from &lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt; to &lt;span&gt;&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt;,
+        run the &lt;span&gt;internal algorithm for scanning and assigning
+        header cells&lt;/span&gt;, with the &lt;var title=&quot;&quot;&gt;principal
+        cell&lt;/var&gt;, the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;, the initial
+        coordinate (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;,&lt;var title=&quot;&quot;&gt;principal&lt;sub
+        title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), and the increments &lt;span&gt;&Delta;&lt;var
+        title=&quot;&quot;&gt;x&lt;/var&gt;=0&lt;/span&gt; and &lt;span&gt;&Delta;&lt;var
+        title=&quot;&quot;&gt;y&lt;/var&gt;=&amp;#x2212;1&lt;/span&gt;.&lt;/p&gt;
 
-        &lt;ol&gt;
+       &lt;/li&gt;
 
-         &lt;li&gt;
 
-          &lt;p&gt;If the header cell is &lt;span&gt;equivalent to a wide
-          cell&lt;/span&gt;, let &lt;var title=&quot;&quot;&gt;header&lt;sub
-          title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt; equal &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;sub
-          title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-&lt;var title=&quot;&quot;&gt;header&lt;sub
-          title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;.&lt;/p&gt;
+       &lt;!-- ROW GROUP HEADERS --&gt;
 
-         &lt;/li&gt;
+       &lt;li&gt;
 
-         &lt;li&gt;
+        &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is anchored in a
+        &lt;span title=&quot;concept-row-group&quot;&gt;row group&lt;/span&gt;, then add all
+        header cells that are &lt;span title=&quot;row group header&quot;&gt;row group
+        headers&lt;/span&gt; and are anchored in the same row group with an
+        &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;-coordinate less than or equal to
+        &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; and
+        a &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;-coordinate less than or equal to
+        &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; to
+        &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-          &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; equal &lt;span&gt;&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;.&lt;/p&gt;
+       &lt;/li&gt;
 
-         &lt;/li&gt;
 
-         &lt;li&gt;
+       &lt;!-- COLUMN GROUP HEADERS --&gt;
 
-          &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; equal &lt;span&gt;&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;.&lt;/p&gt;
+       &lt;li&gt;
 
-         &lt;/li&gt;
+        &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is anchored in a
+        &lt;span title=&quot;concept-column-group&quot;&gt;column group&lt;/span&gt;, then
+        add all header cells that are &lt;span title=&quot;column group
+        header&quot;&gt;column group headers&lt;/span&gt; and are anchored in the
+        same column group with an &lt;var title=&quot;&quot;&gt;x&lt;/var&gt;-coordinate
+        less than or equal to &lt;span&gt;&lt;var title=&quot;&quot;&gt;principal&lt;sub
+        title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;principal&lt;sub
+        title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; and a &lt;var
+        title=&quot;&quot;&gt;y&lt;/var&gt;-coordinate less than or equal to &lt;span&gt;&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var
+        title=&quot;&quot;&gt;principal&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;-1&lt;/span&gt; to
+        &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+       &lt;/li&gt;
 
-          &lt;p&gt;&lt;i&gt;Horizontal&lt;/i&gt;: If &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; is equal to
-          &lt;var title=&quot;&quot;&gt;x&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;, then jump
-          down to the step below labeled &lt;i&gt;vertical&lt;/i&gt;.&lt;/p&gt;
+      &lt;/ol&gt;
 
-         &lt;/li&gt;
+     &lt;/dd&gt;
 
-         &lt;li&gt;
+    &lt;/dl&gt;
 
-          &lt;p&gt;If there is a header cell anchored at (&lt;var
-          title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;header&lt;sub
-          title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) with height &lt;var title=&quot;&quot;&gt;header&lt;sub
-          title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;, then jump down to the step
-          below labeled &lt;i&gt;vertical&lt;/i&gt;.&lt;/p&gt;
+   &lt;/li&gt;
 
-         &lt;/li&gt;
 
-         &lt;li&gt;
+   &lt;!-- CLEANUP --&gt;
 
-          &lt;p&gt;Add all the data cells that cover slots with coordinates
-          (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var
-          title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var
-          title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;=&nbsp;&lt;var
-          title=&quot;&quot;&gt;x&lt;/var&gt;&lt;/span&gt; and &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub
-          title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-          title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, to
-          the &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; list.&lt;/p&gt;
+   &lt;li&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;Remove all the &lt;span title=&quot;empty cell&quot;&gt;empty cells&lt;/span&gt; from
+    the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+   &lt;/li&gt;
 
-          &lt;p&gt;Increase &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; by 1.&lt;/p&gt;
+   &lt;li&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;Remove any duplicates from the &lt;var title=&quot;&quot;&gt;header
+    list&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+   &lt;/li&gt;
 
-          &lt;p&gt;Jump up to the step above labeled &lt;i&gt;horizontal&lt;/i&gt;.&lt;/p&gt;
+   &lt;li&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;Assign the headers in the &lt;var title=&quot;&quot;&gt;header list&lt;/var&gt; to
+    the &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+   &lt;/li&gt;
 
-          &lt;p&gt;&lt;i&gt;Vertical&lt;/i&gt;: If &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; is equal to
-          &lt;var title=&quot;&quot;&gt;y&lt;sub title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;, then jump
-          to the step below labeled &lt;i&gt;end&lt;/i&gt;.&lt;/p&gt;
+  &lt;/ol&gt;
 
-         &lt;/li&gt;
+  &lt;p&gt;The &lt;dfn&gt;internal algorithm for scanning and assigning header
+  cells&lt;/dfn&gt;, given a &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt;, a &lt;var
+  title=&quot;&quot;&gt;header list&lt;/var&gt;, a (&lt;var title=&quot;&quot;&gt;initial&lt;sub
+  title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;initial&lt;sub
+  title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) initial coordinate, and &Delta;&lt;var
+  title=&quot;&quot;&gt;x&lt;/var&gt; and &Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt; increments, is as
+  follows:&lt;/p&gt;
 
-         &lt;li&gt;
+  &lt;ol&gt;
 
-          &lt;p&gt;If there is a header cell &lt;var title=&quot;&quot;&gt;cell&lt;/var&gt;
-          anchored at (&lt;var title=&quot;&quot;&gt;header&lt;sub
-          title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;), then follow
-          these substeps:&lt;/p&gt;
+   &lt;li&gt;
 
-          &lt;ol&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; equal &lt;var title=&quot;&quot;&gt;initial&lt;sub
+    title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-           &lt;li&gt;
+   &lt;/li&gt;
 
-            &lt;p&gt;If the header cell &lt;var title=&quot;&quot;&gt;cell&lt;/var&gt; is
-            &lt;span&gt;equivalent to a wide cell&lt;/span&gt;, then let &lt;var
-            title=&quot;&quot;&gt;width&lt;/var&gt; be &lt;span&gt;&lt;var title=&quot;&quot;&gt;x&lt;sub
-            title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;-&lt;var title=&quot;&quot;&gt;header&lt;sub
-            title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;. Otherwise, let &lt;var
-            title=&quot;&quot;&gt;width&lt;/var&gt; be the width of the header cell &lt;var
-            title=&quot;&quot;&gt;cell&lt;/var&gt;.&lt;/p&gt;
+   &lt;li&gt;
 
-           &lt;/li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; equal &lt;var title=&quot;&quot;&gt;initial&lt;sub
+    title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;.&lt;/p&gt;
 
-           &lt;li&gt;
+   &lt;/li&gt;
 
-            &lt;p&gt;If &lt;var title=&quot;&quot;&gt;width&lt;/var&gt; is equal to &lt;var
-            title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;, then jump
-            to the step below labeled &lt;i&gt;end&lt;/i&gt;.&lt;/p&gt;
+   &lt;li&gt;
 
-           &lt;/li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;opaque headers&lt;/var&gt; be an empty list of
+    cells.&lt;/p&gt;
 
-          &lt;/ol&gt;
+   &lt;/li&gt;
 
-         &lt;/li&gt;
+   &lt;li&gt;
 
-         &lt;li&gt;
+    &lt;dl class=&quot;switch&quot;&gt;
 
-          &lt;p&gt;Add all the data cells that cover slots with coordinates
-          (&lt;var title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var
-          title=&quot;&quot;&gt;slot&lt;sub title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var
-          title=&quot;&quot;&gt;header&lt;sub
-          title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-          title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var
-          title=&quot;&quot;&gt;header&lt;sub title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and
-          &lt;span&gt;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-          title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;=&nbsp;&lt;var
-          title=&quot;&quot;&gt;y&lt;/var&gt;&lt;/span&gt;, to the &lt;var title=&quot;&quot;&gt;data
-          cells&lt;/var&gt; list.&lt;/p&gt;
+     &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;principal cell&lt;/var&gt; is a header cell&lt;/dt&gt;
 
-         &lt;/li&gt;
+     &lt;dd&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; be true, and let
+     &lt;var title=&quot;&quot;&gt;headers from current header block&lt;/var&gt; be a list
+     of cells containing just the &lt;var title=&quot;&quot;&gt;principal
+     cell&lt;/var&gt;.&lt;/p&gt;&lt;/dd&gt;
 
-         &lt;li&gt;
+     &lt;dt&gt;Otherwise&lt;/dt&gt;
 
-          &lt;p&gt;Increase &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; by 1.&lt;/p&gt;
+     &lt;dd&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; be false and let
+     &lt;var title=&quot;&quot;&gt;headers from current header block&lt;/var&gt; be an
+     empty list of cells.&lt;/p&gt;
 
-         &lt;/li&gt;
+    &lt;/dl&gt;
 
-         &lt;li&gt;
+   &lt;/li&gt;
 
-          &lt;p&gt;Jump up to the step above labeled &lt;i&gt;vertical&lt;/i&gt;.&lt;/p&gt;
+   &lt;li&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;&lt;i&gt;Loop&lt;/i&gt;: Increment &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; by &Delta;&lt;var
+    title=&quot;&quot;&gt;x&lt;/var&gt;; increment &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; by &Delta;&lt;var
+    title=&quot;&quot;&gt;y&lt;/var&gt;.&lt;/p&gt;
 
-         &lt;li&gt;
+    &lt;p class=&quot;note&quot;&gt;For each invocation of this algorithm, one of
+    &Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt; and &Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt; will
+    be &amp;#x2212;1, and the other will be 0.&lt;/p&gt;
 
-          &lt;p&gt;&lt;i&gt;End&lt;/i&gt;: Coalesce all the duplicate entries in the
-          &lt;var title=&quot;&quot;&gt;data cells&lt;/var&gt; list, so that each data cell
-          is only present once, in tree order.&lt;/p&gt;
+   &lt;/li&gt;
 
-         &lt;/li&gt;
+   &lt;li&gt;
 
-        &lt;/ol&gt;
+    &lt;p&gt;If either &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; or &lt;var title=&quot;&quot;&gt;y&lt;/var&gt; is
+    less than 0, then abort this internal algorithm.&lt;/p&gt;
 
-       &lt;/dd&gt;
+   &lt;/li&gt;
 
-      &lt;/dl&gt;
+   &lt;li&gt;
 
-     &lt;/li&gt;
+    &lt;p&gt;If there is no cell covering slot (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;,
+    &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;), or if there is more than one cell
+    covering slot (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;),
+    return to the substep marked &lt;i&gt;loop&lt;/i&gt;.&lt;/p&gt;
 
-     &lt;li&gt;
+   &lt;/li&gt;
 
-      &lt;p&gt;Assign the header cell to all the data cells in the &lt;var
-      title=&quot;&quot;&gt;data cells&lt;/var&gt; list that correspond to
-      &lt;code&gt;td&lt;/code&gt; elements that do not have a &lt;code
-      title=&quot;attr-td-headers&quot;&gt;headers&lt;/code&gt; attribute specified.&lt;/p&gt;
+   &lt;li&gt;
 
-     &lt;/li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; be the cell covering
+    slot (&lt;var title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;).&lt;/p&gt;
 
-    &lt;/ol&gt;
-
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;For each data cell in the table, in &lt;span&gt;tree order&lt;/span&gt;,
-    run these substeps:&lt;/p&gt;
+    &lt;dl class=&quot;switch&quot;&gt;
 
-    &lt;ol&gt;
+     &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is a header cell&lt;/dt&gt;
 
-     &lt;li&gt;
+     &lt;dd&gt;
 
-      &lt;p&gt;If the data cell corresponds to a &lt;code&gt;td&lt;/code&gt; element
-      that does not have a &lt;code
-      title=&quot;attr-td-headers&quot;&gt;headers&lt;/code&gt; attribute specified, then
-      skip these substeps and move on to the next data cell (if
-      any).&lt;/p&gt;
+      &lt;ol&gt;
 
-     &lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; to
+       true.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;
+       &lt;li&gt;&lt;p&gt;Add &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; to &lt;var
+       title=&quot;&quot;&gt;headers from current header block&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;Otherwise, take the value of the &lt;code
-      title=&quot;attr-td-headers&quot;&gt;headers&lt;/code&gt; attribute and &lt;span
-      title=&quot;split a string on spaces&quot;&gt;split it on spaces&lt;/span&gt;,
-      letting &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt; be the list of tokens
-      obtained.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; be false.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;/li&gt;
+       &lt;li&gt;
 
-     &lt;li&gt;
+        &lt;dl class=&quot;switch&quot;&gt;
 
-      &lt;!-- XXX if nothing was added to this subalgorithm, then make it
-      a single paragraph instead of a nested list. --&gt;
+         &lt;dt&gt;If &Delta;&lt;var title=&quot;&quot;&gt;x&lt;/var&gt; is 0&lt;/dt&gt;
 
-      &lt;p&gt;For each token in the &lt;var title=&quot;&quot;&gt;id list&lt;/var&gt;, run the
-      following steps:&lt;/p&gt;
+         &lt;dd&gt;
 
-      &lt;ol&gt;
+          &lt;p&gt;If there is no cell in the &lt;var title=&quot;&quot;&gt;opaque
+          headers&lt;/var&gt; list anchored with the same &lt;var
+          title=&quot;&quot;&gt;x&lt;/var&gt;-coordinate as the &lt;var title=&quot;&quot;&gt;current
+          cell&lt;/var&gt;, and with the same width as &lt;var title=&quot;&quot;&gt;current
+          cell&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; be
+          true.&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;id&lt;/var&gt; be the token.&lt;/p&gt;&lt;/li&gt;
+          &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is not a
+          &lt;span&gt;column header&lt;/span&gt;, then let &lt;var
+          title=&quot;&quot;&gt;blocked&lt;/var&gt; be true.&lt;/p&gt;
 
-       &lt;li&gt;&lt;p&gt;If there is a header cell in the &lt;span
-       title=&quot;concept-table&quot;&gt;table&lt;/span&gt; whose corresponding
-       &lt;code&gt;th&lt;/code&gt; element has an ID that is equal to the value of
-       &lt;var title=&quot;&quot;&gt;id&lt;/var&gt;, then assign the first such header cell
-       in tree order to the data cell.&lt;/p&gt;&lt;/li&gt;
+         &lt;/dd&gt;
 
+         &lt;dt&gt;If &Delta;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt; is 0&lt;/dt&gt;
+
+         &lt;dd&gt;
+
+          &lt;p&gt;If there is no cell in the &lt;var title=&quot;&quot;&gt;opaque
+          headers&lt;/var&gt; list anchored with the same &lt;var
+          title=&quot;&quot;&gt;y&lt;/var&gt;-coordinate as the &lt;var title=&quot;&quot;&gt;current
+          cell&lt;/var&gt;, and with the same height as &lt;var
+          title=&quot;&quot;&gt;current cell&lt;/var&gt;, then let &lt;var
+          title=&quot;&quot;&gt;blocked&lt;/var&gt; be true.&lt;/p&gt;
+
+          &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is not a
+          &lt;span&gt;row header&lt;/span&gt;, then let &lt;var
+          title=&quot;&quot;&gt;blocked&lt;/var&gt; be true.&lt;/p&gt;
+
+         &lt;/dd&gt;
+
+        &lt;/dl&gt;
+
+       &lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;blocked&lt;/var&gt; is false, then add the
+       &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;headers
+       list&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
       &lt;/ol&gt;
 
-     &lt;/li&gt;
+     &lt;/dd&gt;
 
-    &lt;/ol&gt;
+     &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;current cell&lt;/var&gt; is a data cell and &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; is true&lt;/dt&gt;
 
+     &lt;dd&gt;&lt;p&gt;Set &lt;var title=&quot;&quot;&gt;in header block&lt;/var&gt; to false. Add
+     all the cells in &lt;var title=&quot;&quot;&gt;headers from current header
+     block&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;opaque headers&lt;/var&gt; list, and
+     empty the &lt;var title=&quot;&quot;&gt;headers from current header block&lt;/var&gt;
+     list.&lt;/p&gt;
+
+    &lt;/dl&gt;
+
    &lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;Return to the step marked &lt;i&gt;loop&lt;/i&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
   &lt;/ol&gt;
 
-  &lt;p&gt;A header cell anchored at (&lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;) with width &lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt; is said to be &lt;dfn&gt;equivalent to a wide
-  cell&lt;/dfn&gt; if all the slots with coordinates (&lt;var title=&quot;&quot;&gt;slot&lt;sub
-  title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;slot&lt;sub
-  title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;), where &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-  title=&quot;&quot;&gt;x&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;x&lt;sub
-  title=&quot;&quot;&gt;width&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt; and &lt;span&gt;&lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&le;&nbsp;&lt;var title=&quot;&quot;&gt;slot&lt;sub
-  title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;&nbsp;&lt;&nbsp;&lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;y&lt;/sub&gt;&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;header&lt;sub
-  title=&quot;&quot;&gt;height&lt;/sub&gt;&lt;/var&gt;&lt;/span&gt;, are all either empty or covered
-  by &lt;span title=&quot;empty data cell&quot;&gt;empty data cells&lt;/span&gt;.&lt;/p&gt;
+  &lt;p&gt;A header cell anchored at the slot with coordinate (&lt;var
+  title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;) with width &lt;var
+  title=&quot;&quot;&gt;width&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;height&lt;/var&gt; is said
+  to be a &lt;dfn&gt;column header&lt;/dfn&gt; if any of the following conditions
+  are true:&lt;/p&gt;
 
-  &lt;p&gt;A data cell is said to be an &lt;dfn&gt;empty data cell&lt;/dfn&gt; if it
-  contains no elements and its text content, if any, consists only of
+  &lt;ul&gt;
+
+   &lt;li&gt;The cell's &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute
+   is in the &lt;span title=&quot;attr-th-scope-col&quot;&gt;column&lt;/span&gt; state&lt;/li&gt;
+
+   &lt;li&gt;The cell's &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute
+   is in the &lt;span title=&quot;attr-th-scope-auto&quot;&gt;auto&lt;/span&gt; state, and
+   there are no data cells in any of the cells covering slots with
+   &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;-coordinates &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;
+   .. &lt;span&gt;&lt;var title=&quot;&quot;&gt;y&lt;/var&gt;+&lt;var
+   title=&quot;&quot;&gt;height&lt;/var&gt;-1&lt;/span&gt;.&lt;/li&gt;
+
+  &lt;/ul&gt;
+
+  &lt;p&gt;A header cell anchored at the slot with coordinate (&lt;var
+  title=&quot;&quot;&gt;x&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;y&lt;/var&gt;) with width &lt;var
+  title=&quot;&quot;&gt;width&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;height&lt;/var&gt; is said
+  to be a &lt;dfn&gt;row header&lt;/dfn&gt; if any of the following conditions
+  are true:&lt;/p&gt;
+
+  &lt;ul&gt;
+
+   &lt;li&gt;The cell's &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute
+   is in the &lt;span title=&quot;attr-th-scope-row&quot;&gt;row&lt;/span&gt; state&lt;/li&gt;
+
+   &lt;li&gt;The cell's &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute
+   is in the &lt;span title=&quot;attr-th-scope-auto&quot;&gt;auto&lt;/span&gt; state, and
+   the cells is not a &lt;span&gt;column header&lt;/span&gt;, and there are no
+   data cells in any of the cells covering slots with &lt;var
+   title=&quot;&quot;&gt;x&lt;/var&gt;-coordinates &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; .. &lt;span&gt;&lt;var
+   title=&quot;&quot;&gt;x&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;width&lt;/var&gt;-1&lt;/span&gt;.&lt;/li&gt;
+
+  &lt;/ul&gt;
+
+  &lt;p&gt;A header cell is said to be a &lt;dfn&gt;column group header&lt;/dfn&gt; if
+  its &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute is in the
+  &lt;span title=&quot;attr-th-scope-colgroup&quot;&gt;column group&lt;/span&gt; state.&lt;/p&gt;
+
+  &lt;p&gt;A header cell is said to be a &lt;dfn&gt;row group header&lt;/dfn&gt; if
+  its &lt;code title=&quot;attr-th-scope&quot;&gt;scope&lt;/code&gt; attribute is in the
+  &lt;span title=&quot;attr-th-scope-rowgroup&quot;&gt;row group&lt;/span&gt; state.&lt;/p&gt;
+
+  &lt;p&gt;A cell is said to be an &lt;dfn&gt;empty cell&lt;/dfn&gt; if it contains no
+  elements and its text content, if any, consists only of
   &lt;span&gt;White_Space&lt;/span&gt; characters.&lt;/p&gt;
 
-  &lt;p&gt;User agents may remove &lt;span title=&quot;empty data cell&quot;&gt;empty data
-  cells&lt;/span&gt; when analyzing data in a &lt;span
-  title=&quot;concept-table&quot;&gt;table&lt;/span&gt;.&lt;/p&gt;
 
 
 
 
-
   &lt;h3 id=&quot;forms&quot;&gt;Forms&lt;/h3&gt;
 
   &lt;p&gt;Forms allow unscripted client-server interaction: given a form, a


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009429.html">[html5] r2546 - [e] (0) fix ack to use full name
</A></li>
	<LI>Next message: <A HREF="009431.html">[html5] r2548 - [] (0) Define how to register new http-equiv	values. (credit: ma)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9430">[ date ]</a>
              <a href="thread.html#9430">[ thread ]</a>
              <a href="subject.html#9430">[ subject ]</a>
              <a href="author.html#9430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
