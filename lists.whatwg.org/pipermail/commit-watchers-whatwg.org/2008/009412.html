<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2529 - [cgiowrt] (2) MAJOR CHANGES: Revamp the way scripts	are specified, along with th [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2529%20-%20%5Bcgiowrt%5D%20%282%29%20MAJOR%20CHANGES%3A%20Revamp%20the%20way%20scripts%0A%09are%20specified%2C%20along%20with%20th%20%5B...%5D&In-Reply-To=%3C20081212084625.14500143AF0%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009411.html">
   <LINK REL="Next"  HREF="009413.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2529 - [cgiowrt] (2) MAJOR CHANGES: Revamp the way scripts	are specified, along with th [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2529%20-%20%5Bcgiowrt%5D%20%282%29%20MAJOR%20CHANGES%3A%20Revamp%20the%20way%20scripts%0A%09are%20specified%2C%20along%20with%20th%20%5B...%5D&In-Reply-To=%3C20081212084625.14500143AF0%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2529 - [cgiowrt] (2) MAJOR CHANGES: Revamp the way scripts	are specified, along with th [...]">whatwg at whatwg.org
       </A><BR>
    <I>Fri Dec 12 00:46:25 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="009411.html">[html5] r2528 - [giow] (2) WF2: Change &lt;legend&gt; to be treated more	like &lt;option&gt; than like a ful [...]
</A></li>
        <LI>Next message: <A HREF="009413.html">[html5] r2530 - [e] (0) Update terminology to help Workers	specification.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9412">[ date ]</a>
              <a href="thread.html#9412">[ thread ]</a>
              <a href="subject.html#9412">[ subject ]</a>
              <a href="author.html#9412">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-12-12 00:46:24 -0800 (Fri, 12 Dec 2008)
New Revision: 2529

Modified:
   index
   source
Log:
[cgiowrt] (2) MAJOR CHANGES: Revamp the way scripts are specified, along with their interaction with resolving relative URLs, etc. Give enough detail to justify objects in the DOM not being garbage collected randomly when still in use. Define script groups, to handle scripts going away during document.open() and session history navigation. Define why and how setTimeout(), database transactions, etc, handle page transitions. Drop the terms 'with' and 'without' script, use script is 'enabled'/'disabled' instead. Define 'unload' and 'beforeunload'. Rework how onfoo='' and .onfoo event handler attributes are defined. Rework how the content model of &lt;noscript&gt; is defined. Reword the way javascript: is defined to use the new terminology. Add a few notes of things that came up while I was doing all that.

Modified: index
===================================================================
--- index	2008-12-03 01:27:37 UTC (rev 2528)
+++ index	2008-12-12 08:46:24 UTC (rev 2529)
@@ -17,7 +17,7 @@
   &lt;div class=head&gt;
    &lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;h1&gt;HTML 5&lt;/h1&gt;
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 3 December 2008&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 12 December 2008&lt;/h2&gt;
    &lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;dl&gt;&lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -270,7 +270,8 @@
      &lt;li&gt;&lt;a href=#domtokenlist&gt;&lt;span class=secno&gt;2.8.3 &lt;/span&gt;DOMTokenList&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#domstringmap&gt;&lt;span class=secno&gt;2.8.4 &lt;/span&gt;DOMStringMap&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#dom-feature-strings&gt;&lt;span class=secno&gt;2.8.5 &lt;/span&gt;DOM feature strings&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#exceptions&gt;&lt;span class=secno&gt;2.8.6 &lt;/span&gt;Exceptions&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#exceptions&gt;&lt;span class=secno&gt;2.8.6 &lt;/span&gt;Exceptions&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#garbage-collection&gt;&lt;span class=secno&gt;2.8.7 &lt;/span&gt;Garbage collection&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=#dom&gt;&lt;span class=secno&gt;3 &lt;/span&gt;Semantics and structure of HTML documents&lt;/a&gt;
   &lt;ol&gt;
    &lt;li&gt;&lt;a href=#semantics-intro&gt;&lt;span class=secno&gt;3.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
@@ -636,23 +637,30 @@
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#security-2&gt;&lt;span class=secno&gt;5.2.1 &lt;/span&gt;Security&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#apis-for-creating-and-navigating-browsing-contexts-by-name&gt;&lt;span class=secno&gt;5.2.2 &lt;/span&gt;APIs for creating and navigating browsing contexts by name&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#accessing-other-browsing-contexts&gt;&lt;span class=secno&gt;5.2.3 &lt;/span&gt;Accessing other browsing contexts&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#accessing-other-browsing-contexts&gt;&lt;span class=secno&gt;5.2.3 &lt;/span&gt;Accessing other browsing contexts&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#garbage-collection-and-browsing-contexts&gt;&lt;span class=secno&gt;5.2.4 &lt;/span&gt;Garbage collection and browsing contexts&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#origin&gt;&lt;span class=secno&gt;5.3 &lt;/span&gt;Origin&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#relaxing-the-same-origin-restriction&gt;&lt;span class=secno&gt;5.3.1 &lt;/span&gt;Relaxing the same-origin restriction&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#scripting&gt;&lt;span class=secno&gt;5.4 &lt;/span&gt;Scripting&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#script-execution-contexts&gt;&lt;span class=secno&gt;5.4.1 &lt;/span&gt;Script execution contexts&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#event-loops&gt;&lt;span class=secno&gt;5.4.2 &lt;/span&gt;Event loops&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#introduction-0&gt;&lt;span class=secno&gt;5.4.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#enabling-and-disabling-scripting&gt;&lt;span class=secno&gt;5.4.2 &lt;/span&gt;Enabling and disabling scripting&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#processing-model-1&gt;&lt;span class=secno&gt;5.4.3 &lt;/span&gt;Processing model&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#generic-task-sources&gt;&lt;span class=secno&gt;5.4.2.1 &lt;/span&gt;Generic task sources&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#javascript-protocol&gt;&lt;span class=secno&gt;5.4.3 &lt;/span&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#events&gt;&lt;span class=secno&gt;5.4.4 &lt;/span&gt;Events&lt;/a&gt;
+       &lt;li&gt;&lt;a href=#definitions-0&gt;&lt;span class=secno&gt;5.4.3.1 &lt;/span&gt;Definitions&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#calling-scripts&gt;&lt;span class=secno&gt;5.4.3.2 &lt;/span&gt;Calling scripts&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#creating-scripts&gt;&lt;span class=secno&gt;5.4.3.3 &lt;/span&gt;Creating scripts&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#event-loops&gt;&lt;span class=secno&gt;5.4.4 &lt;/span&gt;Event loops&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#event-handler-attributes&gt;&lt;span class=secno&gt;5.4.4.1 &lt;/span&gt;Event handler attributes&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#event-firing&gt;&lt;span class=secno&gt;5.4.4.2 &lt;/span&gt;Event firing&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#events-and-the-window-object&gt;&lt;span class=secno&gt;5.4.4.3 &lt;/span&gt;Events and the &lt;code&gt;Window&lt;/code&gt; object&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#runtime-script-errors&gt;&lt;span class=secno&gt;5.4.4.4 &lt;/span&gt;Runtime script errors&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#generic-task-sources&gt;&lt;span class=secno&gt;5.4.4.1 &lt;/span&gt;Generic task sources&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#javascript-protocol&gt;&lt;span class=secno&gt;5.4.5 &lt;/span&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#events&gt;&lt;span class=secno&gt;5.4.6 &lt;/span&gt;Events&lt;/a&gt;
+      &lt;ol&gt;
+       &lt;li&gt;&lt;a href=#event-handler-attributes&gt;&lt;span class=secno&gt;5.4.6.1 &lt;/span&gt;Event handler attributes&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#event-firing&gt;&lt;span class=secno&gt;5.4.6.2 &lt;/span&gt;Event firing&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#events-and-the-window-object&gt;&lt;span class=secno&gt;5.4.6.3 &lt;/span&gt;Events and the &lt;code&gt;Window&lt;/code&gt; object&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#runtime-script-errors&gt;&lt;span class=secno&gt;5.4.6.4 &lt;/span&gt;Runtime script errors&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#user-prompts&gt;&lt;span class=secno&gt;5.5 &lt;/span&gt;User prompts&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#simple-dialogs&gt;&lt;span class=secno&gt;5.5.1 &lt;/span&gt;Simple dialogs&lt;/a&gt;&lt;/li&gt;
@@ -668,7 +676,7 @@
        &lt;li&gt;&lt;a href=#sample-handler-impl&gt;&lt;span class=secno&gt;5.6.2.2 &lt;/span&gt;Sample user interface&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#offline&gt;&lt;span class=secno&gt;5.7 &lt;/span&gt;Offline Web applications&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#introduction-0&gt;&lt;span class=secno&gt;5.7.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#introduction-1&gt;&lt;span class=secno&gt;5.7.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#appcache&gt;&lt;span class=secno&gt;5.7.2 &lt;/span&gt;Application caches&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#manifests&gt;&lt;span class=secno&gt;5.7.3 &lt;/span&gt;The cache manifest syntax&lt;/a&gt;
       &lt;ol&gt;
@@ -676,7 +684,7 @@
        &lt;li&gt;&lt;a href=#writing-cache-manifests&gt;&lt;span class=secno&gt;5.7.3.2 &lt;/span&gt;Writing cache manifests&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#parsing-cache-manifests&gt;&lt;span class=secno&gt;5.7.3.3 &lt;/span&gt;Parsing cache manifests&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#updating-an-application-cache&gt;&lt;span class=secno&gt;5.7.4 &lt;/span&gt;Updating an application cache&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#processing-model-1&gt;&lt;span class=secno&gt;5.7.5 &lt;/span&gt;Processing model&lt;/a&gt;
+     &lt;li&gt;&lt;a href=#processing-model-2&gt;&lt;span class=secno&gt;5.7.5 &lt;/span&gt;Processing model&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#changesToNetworkingModel&gt;&lt;span class=secno&gt;5.7.5.1 &lt;/span&gt;Changes to the networking model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#application-cache-api&gt;&lt;span class=secno&gt;5.7.6 &lt;/span&gt;Application cache API&lt;/a&gt;&lt;/li&gt;
@@ -701,27 +709,29 @@
      &lt;li&gt;&lt;a href=#read-ua-inline&gt;&lt;span class=secno&gt;5.9.7 &lt;/span&gt;Page load processing model for inline content that doesn't have a DOM&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#scroll-to-fragid&gt;&lt;span class=secno&gt;5.9.8 &lt;/span&gt;Navigating to a fragment identifier&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#history-traversal&gt;&lt;span class=secno&gt;5.9.9 &lt;/span&gt;History traversal&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#closing-a-browsing-context&gt;&lt;span class=secno&gt;5.9.10 &lt;/span&gt;Closing a browsing context&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#unloading-documents&gt;&lt;span class=secno&gt;5.9.10 &lt;/span&gt;Unloading documents&lt;/a&gt;
+      &lt;ol&gt;
+       &lt;li&gt;&lt;a href=#event-definition&gt;&lt;span class=secno&gt;5.9.10.1 &lt;/span&gt;Event definition&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#structured-client-side-storage&gt;&lt;span class=secno&gt;5.10 &lt;/span&gt;Structured client-side storage&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#storage&gt;&lt;span class=secno&gt;5.10.1 &lt;/span&gt;Storing name/value pairs&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#introduction-1&gt;&lt;span class=secno&gt;5.10.1.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#introduction-2&gt;&lt;span class=secno&gt;5.10.1.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#the-storage-interface&gt;&lt;span class=secno&gt;5.10.1.2 &lt;/span&gt;The &lt;code&gt;Storage&lt;/code&gt; interface&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#the-sessionstorage-attribute&gt;&lt;span class=secno&gt;5.10.1.3 &lt;/span&gt;The &lt;code title=dom-sessionStorage&gt;sessionStorage&lt;/code&gt; attribute&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#the-localstorage-attribute&gt;&lt;span class=secno&gt;5.10.1.4 &lt;/span&gt;The &lt;code title=dom-localStorage&gt;localStorage&lt;/code&gt; attribute&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#the-storage-event&gt;&lt;span class=secno&gt;5.10.1.5 &lt;/span&gt;The &lt;code title=event-storage&gt;storage&lt;/code&gt; event&lt;/a&gt;
         &lt;ol&gt;
-         &lt;li&gt;&lt;a href=#event-definition&gt;&lt;span class=secno&gt;5.10.1.5.1 &lt;/span&gt;Event definition&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+         &lt;li&gt;&lt;a href=#event-definition-0&gt;&lt;span class=secno&gt;5.10.1.5.1 &lt;/span&gt;Event definition&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#threads&gt;&lt;span class=secno&gt;5.10.1.6 &lt;/span&gt;Threads&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#sql&gt;&lt;span class=secno&gt;5.10.2 &lt;/span&gt;Database storage&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#introduction-2&gt;&lt;span class=secno&gt;5.10.2.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#introduction-3&gt;&lt;span class=secno&gt;5.10.2.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#databases&gt;&lt;span class=secno&gt;5.10.2.2 &lt;/span&gt;Databases&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#executing-sql-statements&gt;&lt;span class=secno&gt;5.10.2.3 &lt;/span&gt;Executing SQL statements&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#database-query-results&gt;&lt;span class=secno&gt;5.10.2.4 &lt;/span&gt;Database query results&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#errors&gt;&lt;span class=secno&gt;5.10.2.5 &lt;/span&gt;Errors&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#processing-model-2&gt;&lt;span class=secno&gt;5.10.2.6 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#processing-model-3&gt;&lt;span class=secno&gt;5.10.2.6 &lt;/span&gt;Processing model&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#disk-space&gt;&lt;span class=secno&gt;5.10.3 &lt;/span&gt;Disk space&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#privacy&gt;&lt;span class=secno&gt;5.10.4 &lt;/span&gt;Privacy&lt;/a&gt;
       &lt;ol&gt;
@@ -792,7 +802,7 @@
      &lt;li&gt;&lt;a href=#making-entire-documents-editable&gt;&lt;span class=secno&gt;6.7.2 &lt;/span&gt;Making entire documents editable&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#dnd&gt;&lt;span class=secno&gt;6.8 &lt;/span&gt;Drag and drop&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#introduction-3&gt;&lt;span class=secno&gt;6.8.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#introduction-4&gt;&lt;span class=secno&gt;6.8.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#the-dragevent-and-datatransfer-interfaces&gt;&lt;span class=secno&gt;6.8.2 &lt;/span&gt;The &lt;code&gt;DragEvent&lt;/code&gt; and &lt;code&gt;DataTransfer&lt;/code&gt; interfaces&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#events-fired-during-a-drag-and-drop-action&gt;&lt;span class=secno&gt;6.8.3 &lt;/span&gt;Events fired during a drag-and-drop action&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#drag-and-drop-processing-model&gt;&lt;span class=secno&gt;6.8.4 &lt;/span&gt;Drag-and-drop processing model&lt;/a&gt;
@@ -846,7 +856,7 @@
        &lt;li&gt;&lt;a href=#closing-the-connection&gt;&lt;span class=secno&gt;7.3.4.3 &lt;/span&gt;Closing the connection&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#crossDocumentMessages&gt;&lt;span class=secno&gt;7.4 &lt;/span&gt;Cross-document messaging&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#introduction-4&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#introduction-5&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#security-5&gt;&lt;span class=secno&gt;7.4.2 &lt;/span&gt;Security&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#authors&gt;&lt;span class=secno&gt;7.4.2.1 &lt;/span&gt;Authors&lt;/a&gt;&lt;/li&gt;
@@ -856,11 +866,11 @@
      &lt;li&gt;&lt;a href=#posting-structured-data&gt;&lt;span class=secno&gt;7.4.5 &lt;/span&gt;Posting structured data&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#channel-messaging&gt;&lt;span class=secno&gt;7.5 &lt;/span&gt;Channel messaging&lt;/a&gt;
     &lt;ol&gt;
-     &lt;li&gt;&lt;a href=#introduction-5&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#introduction-6&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#message-channels&gt;&lt;span class=secno&gt;7.5.2 &lt;/span&gt;Message channels&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#message-ports&gt;&lt;span class=secno&gt;7.5.3 &lt;/span&gt;Message ports&lt;/a&gt;
       &lt;ol&gt;
-       &lt;li&gt;&lt;a href=#ports-and-browsing-contexts&gt;&lt;span class=secno&gt;7.5.3.1 &lt;/span&gt;Ports and browsing contexts&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#message-port-discarding&gt;&lt;span class=secno&gt;7.5.3.1 &lt;/span&gt;Ports and browsing contexts&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#ports-and-garbage-collection&gt;&lt;span class=secno&gt;7.5.3.2 &lt;/span&gt;Ports and garbage collection&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=#syntax&gt;&lt;span class=secno&gt;8 &lt;/span&gt;The HTML syntax&lt;/a&gt;
   &lt;ol&gt;
@@ -1389,7 +1399,7 @@
   that no scripts execute (e.g. no event handlers, no timers,
   etc). User agents should remain responsive to user input while
   paused, however, albeit without letting the user interact with Web
-  pages where that would involve invoking any script.&lt;/p&gt;
+  pages where that would involve invoking any &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;.&lt;/p&gt;
 
 
   &lt;h4 id=xml&gt;&lt;span class=secno&gt;2.1.1 &lt;/span&gt;XML&lt;/h4&gt;
@@ -3764,12 +3774,7 @@
 
   &lt;h4 id=terminology-0&gt;&lt;span class=secno&gt;2.5.1 &lt;/span&gt;Terminology&lt;/h4&gt;
 
-  &lt;p&gt;A &lt;dfn id=url&gt;URL&lt;/dfn&gt; is a string used to identify a resource. &lt;span id=urldoc&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is always associated with a
-  &lt;code&gt;Document&lt;/code&gt;, either explicitly when the URL is created or
-  defined; or through a DOM node, in which case the associated
-  &lt;code&gt;Document&lt;/code&gt; is the node's &lt;code&gt;Document&lt;/code&gt;; or
-  through a script, in which case the associated &lt;code&gt;Document&lt;/code&gt;
-  is the script's &lt;a href=#script-document-context&gt;script document context&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;
+  &lt;p&gt;A &lt;dfn id=url&gt;URL&lt;/dfn&gt; is a string used to identify a resource.&lt;/p&gt;
 
   &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-url&gt;valid URL&lt;/dfn&gt; if at least one of
   the following conditions holds:&lt;/p&gt;
@@ -3785,7 +3790,26 @@
    &lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid IRI reference and the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character encoding&quot;&gt;character encoding&lt;/a&gt; of
    the URL's &lt;code&gt;Document&lt;/code&gt; is UTF-8 or UTF-16. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
 
-  &lt;/ul&gt;&lt;p class=note&gt;The term &quot;URL&quot; in this specification is used in a
+  &lt;/ul&gt;&lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; has an associated &lt;dfn id=url-character-encoding&gt;URL character
+  encoding&lt;/dfn&gt;, determined as follows:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;If the URL came from a script (e.g. as an argument to a
+   method)&lt;/dt&gt;
+
+   &lt;dd&gt;The URL character encoding is the &lt;a href=&quot;#script's-character-encoding&quot;&gt;script's character
+   encoding&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;If the URL came from a DOM node (e.g. from an element)&lt;/dt&gt;
+
+   &lt;dd&gt;The node has a &lt;code&gt;Document&lt;/code&gt;, and the URL character
+   encoding is the &lt;a href=&quot;#document's-character-encoding&quot;&gt;document's character encoding&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;If the URL had a character encoding defined when the URL was
+   created or defined&lt;/dt&gt;
+
+   &lt;dd&gt;The URL character encoding is as defined.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p class=note&gt;The term &quot;URL&quot; in this specification is used in a
   manner distinct from the precise technical meaning it is given in
   RFC 3986. Readers familiar with that RFC will find it easier to read
   &lt;em&gt;this&lt;/em&gt; specification if they pretend the term &quot;URL&quot; as used
@@ -3922,8 +3946,7 @@
 
   &lt;dl class=switch&gt;&lt;dt&gt;If the URL to be resolved was passed to an API&lt;/dt&gt;
 
-   &lt;dd&gt;&lt;p&gt;The base URL is the &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the
-   script's &lt;a href=#script-document-context&gt;script document context&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;&lt;p&gt;The base URL is the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;If the URL to be resolved is from the value of a content
    attribute&lt;/dt&gt;
@@ -3982,12 +4005,9 @@
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the &lt;a href=#url&gt;URL&lt;/a&gt; being
    resolved.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; be the
-   &lt;code&gt;Document&lt;/code&gt; &lt;a href=#urldoc&gt;associated with&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; be the &lt;a href=#url-character-encoding&gt;URL character
+   encoding&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; be the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character encoding&quot;&gt;character encoding&lt;/a&gt; of
-   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/li&gt;
-
    &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; is UTF-16, then change it to
    UTF-8.&lt;/li&gt;
 
@@ -5628,10 +5648,30 @@
    &lt;li value=20&gt;&lt;dfn id=abort_err&gt;&lt;code&gt;ABORT_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually in XHR for now --&gt;
    &lt;li value=21&gt;&lt;dfn id=url_mismatch_err&gt;&lt;code&gt;URL_MISMATCH_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually in workers for now --&gt;
    &lt;li value=22&gt;&lt;dfn id=quota_exceeded_err&gt;&lt;code&gt;QUOTA_EXCEEDED_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined right here for now --&gt;
+   &lt;li value=23&gt;&lt;dfn id=unavailable_script_err&gt;&lt;code&gt;UNAVAILABLE_SCRIPT_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined right here for now --&gt;
    &lt;li value=81&gt;&lt;dfn id=parse_err&gt;&lt;code&gt;PARSE_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined in dom3ls --&gt;
    &lt;li value=82&gt;&lt;dfn id=serialise_err&gt;&lt;code&gt;SERIALISE_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined in dom3ls --&gt;
-  &lt;/ol&gt;&lt;h2 id=dom&gt;&lt;span class=secno&gt;3 &lt;/span&gt;Semantics and structure of HTML documents&lt;/h2&gt;
+  &lt;/ol&gt;&lt;h4 id=garbage-collection&gt;&lt;span class=secno&gt;2.8.7 &lt;/span&gt;Garbage collection&lt;/h4&gt;
 
+  &lt;p&gt;There is an &lt;dfn id=implied-strong-reference&gt;implied strong reference&lt;/dfn&gt; from any DOM
+  attribute that returns a pre-existing object to that object.&lt;/p&gt;
+
+  &lt;div class=example&gt;
+
+   &lt;p&gt;For example, the &lt;code&gt;document.defaultView&lt;/code&gt; attribute
+   means that there is a strong reference from a &lt;code&gt;Document&lt;/code&gt;
+   object to its &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object. Similarly, there is
+   always a strong reference from a &lt;code&gt;Document&lt;/code&gt; to any
+   descendant nodes, and from any node to its owner
+   &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+
+
+
+  &lt;h2 id=dom&gt;&lt;span class=secno&gt;3 &lt;/span&gt;Semantics and structure of HTML documents&lt;/h2&gt;
+
   &lt;h3 id=semantics-intro&gt;&lt;span class=secno&gt;3.1 &lt;/span&gt;Introduction&lt;/h3&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
@@ -5647,10 +5687,10 @@
   &lt;p&gt;&lt;dfn id=&quot;the-document's-address&quot;&gt;The document's address&lt;/dfn&gt; is an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
   that is set when the &lt;code&gt;Document&lt;/code&gt; is created.&lt;/p&gt;
 
-  &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is created by a script using the
-  &lt;code title=&quot;&quot;&gt;createDocument()&lt;/code&gt; API, &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
+  &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is created by a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; using the &lt;code title=&quot;&quot;&gt;createDocument()&lt;/code&gt; API, &lt;a href=&quot;#the-document's-address&quot;&gt;the document's
   address&lt;/a&gt; is the same as &lt;a href=&quot;#the-document's-address&quot;&gt;the document's address&lt;/a&gt; of
-  the &lt;a href=#script-document-context&gt;script document context&lt;/a&gt; of that script.&lt;/p&gt;
+  the &lt;a href=#active-document&gt;active document&lt;/a&gt; of the &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing
+  context&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;&lt;code&gt;Document&lt;/code&gt; objects are assumed to be &lt;dfn id=xml-documents&gt;XML
   documents&lt;/dfn&gt; unless they are flagged as being &lt;dfn id=html-documents&gt;HTML
@@ -5662,8 +5702,14 @@
   &lt;code&gt;DOMImplementation&lt;/code&gt; object is initially an &lt;a href=#xml-documents title=&quot;XML documents&quot;&gt;XML document&lt;/a&gt;, but can be made into an
   &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt; by calling &lt;code title=dom-document-open&gt;&lt;a href=#dom-document-open&gt;document.open()&lt;/a&gt;&lt;/code&gt; on it.&lt;/p&gt;
 
+  &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is first created, a new &lt;a href=#script-group&gt;script
+  group&lt;/a&gt; must be created. This is the &lt;code&gt;Document&lt;/code&gt;'s
+  &lt;dfn id=current-script-group&gt;current script group&lt;/dfn&gt; until the script group is changed
+  (which can happen if &lt;code title=dom-document-open&gt;&lt;a href=#dom-document-open&gt;document.open()&lt;/a&gt;&lt;/code&gt; is invoked on the
+  &lt;code&gt;Document&lt;/code&gt;).&lt;/p&gt;
 
 
+
   &lt;h4 id=documents-in-the-dom&gt;&lt;span class=secno&gt;3.2.1 &lt;/span&gt;Documents in the DOM&lt;/h4&gt;
 
   &lt;p&gt;All &lt;code&gt;Document&lt;/code&gt; objects (in user agents implementing
@@ -7300,8 +7346,8 @@
   with the parser, and thus their behavior varies depending on whether
   they are used with &lt;a href=#html-documents&gt;HTML documents&lt;/a&gt; (and the &lt;a href=#html-parser&gt;HTML
   parser&lt;/a&gt;) or XHTML in &lt;a href=#xml-documents&gt;XML documents&lt;/a&gt; (and the
-  &lt;span&gt;XML parser&lt;/span&gt;). The following table cross-references the
-  various versions of these APIs.&lt;/p&gt;
+  &lt;span&gt;XML parser&lt;/span&gt;&lt;!-- XXX xref --&gt;). The following table
+  cross-references the various versions of these APIs.&lt;/p&gt;
 
   &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;
      &lt;th&gt;For documents that are &lt;a href=#html-documents&gt;HTML documents&lt;/a&gt;&lt;/th&gt;
@@ -7371,8 +7417,11 @@
 
    &lt;/li&gt;
 
-   &lt;li&gt;&lt;p class=XXX&gt;onbeforeunload, onunload, reset timers, empty event queue, kill any pending transactions, XMLHttpRequests, etc&lt;/li&gt;
-   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(</A>)%20{%20f%20%3D%20document.getElementsByTagName(%27iframe%27)[0]%3B%20d%20%3D%20f.contentDocument%3B%20}%3C%2Fscript%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22w(d.documentElement.innerHTML)%22%20value%3D%22dump%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.body.bgColor%3D%27red%27%22%20value%3D%22color%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22f.style.border%3D%27lime%20solid%27%22%20value%3D%22color%20frame%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write(%27%3Cp%3Etest%3C%2Fp%3E%27)%3B%20d.close()%22%20value%3D%22replace%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write(%27%3Cp%3E%3Cscript%3Ei%20%3D%200%3B%20setInterval(%26quot%3Bparent.w(i%2B%2B)%26quot%3B%2C%20500)%3C%2Fscript%3E%3C%2Fp%3E%27)%3B%20d.close()%22%20value%3D%22replace%20with%20timer%22%3E%0A --&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#unload-a-document title=&quot;unload a document&quot;&gt;Unload&lt;/a&gt; the
+   &lt;code&gt;Document&lt;/code&gt; object, with the &lt;var title=&quot;&quot;&gt;recycle&lt;/var&gt;
+   parameter set to true. If the user &lt;a href=#refused-to-allow-the-document-to-be-unloaded&gt;refused to allow the
+   document to be unloaded&lt;/a&gt;, then these steps must be
+   aborted.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the document has an &lt;span&gt;active parser&lt;/span&gt;&lt;!--XXX
    xref--&gt;, then stop that parser, and throw away any pending content
@@ -7381,14 +7430,28 @@
    XHTML, or image document, or something?&lt;/span&gt;&lt;/li&gt;&lt;!-- XXX see
    also innerHTML in HTML --&gt;
 
+   &lt;li&gt;&lt;p&gt;Freeze the document's &lt;a href=#current-script-group&gt;current script
+   group&lt;/a&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Unregister all event listeners registered on the
+   &lt;code&gt;Document&lt;/code&gt; node and its descendants.&lt;/p&gt;
+
    &lt;li&gt;&lt;p&gt;Remove all child nodes of the document, without firing any
    mutation events.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Create a new &lt;a href=#script-group&gt;script group&lt;/a&gt; and let the
+   document's &lt;a href=#current-script-group&gt;current script group&lt;/a&gt; be that new
+   group. (The old script group is now permanently frozen.)&lt;/li&gt;
+
+   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(</A>)%20%7B%20f%20%3D%20document.getElementsByTagName('iframe')%5B0%5D%3B%20d%20%3D%20f.contentWindow.document%3B%20%7D%3C%2Fscript%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22w(d.documentElement.innerHTML)%22%20value%3D%22dump%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write('%3Cscript%3Evar%20x%20%3D%20new%20XMLHttpRequest()%3Bx.open(%26quot%3BGET%26quot%3B%2C%20%26quot%3BGET%26quot%3B)%3Bx.onreadystatechange%3Dfunction()%20%7B%20alert(x.readyState)%3B%20%7D%3Bx.send(null)%3B%3C%2Fscript%3E')%3Bd.close()%3B%20setTimeout(function()%20%7B%20d.open()%3B%20d.write('%3Cp%3Etest%3C%2Fp%3E')%3B%20d.close()%20%7D%2C%200)%3B%22%20value%3D%22xhr%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.onclick%20%3D%20function()%20%7B%20w('click')%20%7D%22%20value%3D%22add%20click%20handler%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write('%3Cp%3Etest%3C%2Fp%3E')%3B%20d.close()%22%20value%3D%22replace%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write('%3Cp%3E%3Cscript%3Ei%20%3D%200%3B%20setTimeout(%26quot%3Bparent.w(i%2B%2B)%26quot%3B%2C%202000)%3C%2Fscript%3E%3C%2Fp%3E')%3B%20d.close()%22%20value%3D%22replace%20with%20timer%22%3E --&gt;
+
    &lt;li&gt;&lt;p&gt;Change the &lt;a href=&quot;#document's-character-encoding&quot;&gt;document's character encoding&lt;/a&gt; to
    UTF-16.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Change &lt;a href=&quot;#the-document's-address&quot;&gt;the document's address&lt;/a&gt; to the &lt;a href=&quot;#the-document's-address&quot; title=&quot;the document's address&quot;&gt;address&lt;/a&gt; of the &lt;a href=#script-document-context&gt;script
-   document context&lt;/a&gt; of the script that invoked the &lt;code title=dom-document-open&gt;&lt;a href=#dom-document-open&gt;document.open()&lt;/a&gt;&lt;/code&gt; method.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Change &lt;a href=&quot;#the-document's-address&quot;&gt;the document's address&lt;/a&gt; to the &lt;a href=&quot;#the-document's-address&quot;&gt;the
+   document's address&lt;/a&gt; of the &lt;a href=#active-document&gt;active document&lt;/a&gt; of
+   the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing context&lt;/a&gt;
+   of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that invoked the &lt;code title=dom-document-open&gt;&lt;a href=#dom-document-open&gt;document.open()&lt;/a&gt;&lt;/code&gt; method.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Create a new &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt; and associate it with
    the document. This is a &lt;dfn id=script-created-parser&gt;script-created parser&lt;/dfn&gt; (meaning
@@ -7484,8 +7547,10 @@
 
     &lt;p&gt;If the &lt;a href=#insertion-point&gt;insertion point&lt;/a&gt; is undefined, the &lt;code title=dom-document-open&gt;&lt;a href=#dom-document-open&gt;open()&lt;/a&gt;&lt;/code&gt; method must be called
     (with no arguments) on the &lt;code title=Document&gt;document&lt;/code&gt;
-    object. The &lt;a href=#insertion-point&gt;insertion point&lt;/a&gt; will point at just before
-    the end of the (empty) &lt;a href=#the-input-stream&gt;input stream&lt;/a&gt;.&lt;/p&gt;
+    object. If the user &lt;a href=#refused-to-allow-the-document-to-be-unloaded&gt;refused to allow the document to be
+    unloaded&lt;/a&gt;, then these steps must be aborted. Otherwise, the
+    &lt;a href=#insertion-point&gt;insertion point&lt;/a&gt; will point at just before the end of
+    the (empty) &lt;a href=#the-input-stream&gt;input stream&lt;/a&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -7921,7 +7986,7 @@
 
   &lt;ol&gt;&lt;li&gt;
 
-    &lt;p&gt;The user agent must create a new &lt;span&gt;XML parser&lt;/span&gt;.&lt;/p&gt;
+    &lt;p&gt;The user agent must create a new &lt;span&gt;XML parser&lt;/span&gt;&lt;!-- XXX xref --&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -9303,13 +9368,13 @@
   second is a flag indicating whether the element was
   &lt;dfn id=parser-inserted&gt;&quot;parser-inserted&quot;&lt;/dfn&gt;. This flag is set by the &lt;a href=#html-parser&gt;HTML
   parser&lt;/a&gt; and is used to handle &lt;code title=dom-document-write-HTML&gt;&lt;a href=#dom-document-write-html&gt;document.write()&lt;/a&gt;&lt;/code&gt; calls. The
-  third and fourth pieces of metadata are &lt;dfn id=&quot;the-script's-type&quot;&gt;&lt;var&gt;the script's
-  type&lt;/var&gt;&lt;/dfn&gt; and &lt;dfn id=&quot;the-script's-character-encoding&quot;&gt;&lt;var&gt;the script's character
+  third and fourth pieces of metadata are &lt;dfn id=&quot;the-script-block's-type&quot;&gt;&lt;var&gt;the script block's
+  type&lt;/var&gt;&lt;/dfn&gt; and &lt;dfn id=&quot;the-script-block's-character-encoding&quot;&gt;&lt;var&gt;the script block's character
   encoding&lt;/var&gt;&lt;/dfn&gt;. They are determined when the script is run,
   based on the attributes on the element at that time.&lt;/p&gt;
 
-  &lt;p&gt;When an &lt;span&gt;XML parser&lt;/span&gt; creates a &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;
-  element, it must be marked as being
+  &lt;p&gt;When an &lt;span&gt;XML parser&lt;/span&gt;&lt;!-- XXX xref --&gt; creates a
+  &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element, it must be marked as being
   &lt;a href=#parser-inserted&gt;&quot;parser-inserted&quot;&lt;/a&gt;. When the element's end tag is
   parsed, the user agent must &lt;a href=#running-a-script title=&quot;running a
   script&quot;&gt;run&lt;/a&gt; the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
@@ -9340,45 +9405,46 @@
 
      &lt;li&gt;the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element has neither a &lt;code title=attr-script-type&gt;&lt;a href=#attr-script-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute nor a &lt;code title=attr-script-language&gt;language&lt;/code&gt; attribute, then&lt;/li&gt;
 
-    &lt;/ul&gt;&lt;p&gt;...let &lt;var&gt;&lt;a href=&quot;#the-script's-type&quot;&gt;the script's type&lt;/a&gt;&lt;/var&gt; for this
+    &lt;/ul&gt;&lt;p&gt;...let &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; for this
     &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element be &quot;&lt;code title=&quot;&quot;&gt;text/javascript&lt;/code&gt;&quot;.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, if the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element has a &lt;code title=attr-script-type&gt;&lt;a href=#attr-script-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, let &lt;var&gt;&lt;a href=&quot;#the-script's-type&quot;&gt;the
-    script's type&lt;/a&gt;&lt;/var&gt; for this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element be the
-    value of that attribute.&lt;/p&gt;
+    &lt;p&gt;Otherwise, if the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element has a &lt;code title=attr-script-type&gt;&lt;a href=#attr-script-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, let &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the
+    script block's type&lt;/a&gt;&lt;/var&gt; for this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element be
+    the value of that attribute.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, the element has a &lt;code title=attr-script-language&gt;language&lt;/code&gt; attribute; let
-    &lt;var&gt;&lt;a href=&quot;#the-script's-type&quot;&gt;the script's type&lt;/a&gt;&lt;/var&gt; for this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element
-    be the concatenation of the string &quot;&lt;code title=&quot;&quot;&gt;text/&lt;/code&gt;&quot;
-    followed by the value of the &lt;code title=attr-script-language&gt;language&lt;/code&gt; attribute.&lt;/p&gt;
-    &lt;!-- user agents already support, e.g., type=&quot;text/javascript1.3&quot;,
-    so we don't have to support that separately. --&gt;
+    &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; for this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;
+    element be the concatenation of the string &quot;&lt;code title=&quot;&quot;&gt;text/&lt;/code&gt;&quot; followed by the value of the &lt;code title=attr-script-language&gt;language&lt;/code&gt; attribute.&lt;/p&gt; &lt;!--
+    user agents already support, e.g., type=&quot;text/javascript1.3&quot;, so
+    we don't have to support that separately. --&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
     &lt;p&gt;If the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element has a &lt;code title=attr-script-charset&gt;&lt;a href=#attr-script-charset&gt;charset&lt;/a&gt;&lt;/code&gt; attribute, then let
-    &lt;var&gt;&lt;a href=&quot;#the-script's-character-encoding&quot;&gt;the script's character encoding&lt;/a&gt;&lt;/var&gt; for this
+    &lt;var&gt;&lt;a href=&quot;#the-script-block's-character-encoding&quot;&gt;the script block's character encoding&lt;/a&gt;&lt;/var&gt; for this
     &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element be the encoding given by the &lt;code title=attr-script-charset&gt;&lt;a href=#attr-script-charset&gt;charset&lt;/a&gt;&lt;/code&gt; attribute.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, let &lt;var&gt;&lt;a href=&quot;#the-script's-character-encoding&quot;&gt;the script's character encoding&lt;/a&gt;&lt;/var&gt; for
-    this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element be the same as &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character encoding&quot;&gt;the encoding of the document
+    &lt;p&gt;Otherwise, let &lt;var&gt;&lt;a href=&quot;#the-script-block's-character-encoding&quot;&gt;the script block's character encoding&lt;/a&gt;&lt;/var&gt;
+    for this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element be the same as &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character encoding&quot;&gt;the encoding of the document
     itself&lt;/a&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;If the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element is &lt;a href=#without-script&gt;without
-    script&lt;/a&gt;, or if the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element was created
-    by an &lt;span&gt;XML parser&lt;/span&gt; that itself was created as part of
+    &lt;p&gt;If &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is
+    disabled&lt;/a&gt; for the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element, or if the
+    &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element was created by an &lt;span&gt;XML
+    parser&lt;/span&gt;&lt;!-- XXX xref --&gt; that itself was created as part of
     the processing of the &lt;code title=dom-innerHTML-XML&gt;&lt;a href=#dom-innerhtml-xml&gt;innerHTML&lt;/a&gt;&lt;/code&gt; attribute's setter&lt;!--
     no need to worry about the HTML case, as the HTML parser handles
     that for us --&gt;, or if the user agent does not &lt;a href=#support-the-scripting-language&gt;support the
-    scripting language&lt;/a&gt; given by &lt;var&gt;&lt;a href=&quot;#the-script's-type&quot;&gt;the script's type&lt;/a&gt;&lt;/var&gt;
-    for this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element, then the user agent must
-    abort these steps at this point. The script is not executed.&lt;/p&gt;
+    scripting language&lt;/a&gt; given by &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's
+    type&lt;/a&gt;&lt;/var&gt; for this &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element, then the user
+    agent must abort these steps at this point. The script is not
+    executed.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -9478,41 +9544,43 @@
      &lt;dt&gt;Otherwise&lt;/dt&gt;
 
      &lt;dd&gt;The user agent must immediately &lt;a href=#executing-a-script-block title=&quot;executing a
-     script block&quot;&gt;execute the script&lt;/a&gt;, even if other scripts
-     are already executing.&lt;/dd&gt;
+     script block&quot;&gt;execute the script block&lt;/a&gt;, even if other
+     scripts are already executing.&lt;/dd&gt;
 
     &lt;/dl&gt;&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p&gt;&lt;dfn id=when-a-script-completes-loading&gt;When a script completes loading&lt;/dfn&gt;: If the script's
-  element was added to one of the lists mentioned above and the
-  document is still being parsed, then the parser handles
-  it. Otherwise, the UA must run the following steps as the &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that the &lt;a href=#networking-task-source&gt;networking task
-  source&lt;/a&gt; places on the &lt;a href=#task-queue&gt;task queue&lt;/a&gt;:&lt;/p&gt;
+  &lt;/ol&gt;&lt;p&gt;&lt;dfn id=when-a-script-completes-loading&gt;When a script completes loading&lt;/dfn&gt;: If the
+  &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element was added to one of the lists mentioned
+  above and the document is still being parsed, then the parser
+  handles it. Otherwise, the UA must run the following steps as the
+  &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that the &lt;a href=#networking-task-source&gt;networking
+  task source&lt;/a&gt; places on the &lt;a href=#task-queue&gt;task queue&lt;/a&gt;:&lt;/p&gt;
 
-  &lt;dl class=switch&gt;&lt;dt&gt;If the script's element was added to the &lt;dfn id=list-of-scripts-that-will-execute-when-the-document-has-finished-parsing&gt;list of scripts
-   that will execute when the document has finished parsing&lt;/dfn&gt;:&lt;/dt&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element was added to the &lt;dfn id=list-of-scripts-that-will-execute-when-the-document-has-finished-parsing&gt;list
+   of scripts that will execute when the document has finished
+   parsing&lt;/dfn&gt;:&lt;/dt&gt;
 
    &lt;dd&gt;
 
     &lt;ol&gt;&lt;li&gt;
 
-      &lt;p&gt;If the script's element is not the first element in the list,
-      then do nothing yet. Stop going through these steps.&lt;/p&gt;
+      &lt;p&gt;If the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element is not the first element
+      in the list, then do nothing yet. Stop going through these
+      steps.&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
       &lt;p&gt;Otherwise, &lt;a href=#executing-a-script-block title=&quot;executing a script block&quot;&gt;execute the
-      script&lt;/a&gt; (that is, the script associated with the first
-      element in the list).&lt;/p&gt;
+      script block&lt;/a&gt; (the first element in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Remove the script's element from the list (i.e. shift out the
-      first entry in the list).&lt;/p&gt;
+      &lt;p&gt;Remove the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element from the list
+      (i.e. shift out the first entry in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -9526,8 +9594,8 @@
 
     &lt;/ol&gt;&lt;/dd&gt;
 
-   &lt;dt&gt;If the script's element was added to the &lt;dfn id=list-of-scripts-that-will-execute-asynchronously&gt;list of scripts
-   that will execute asynchronously&lt;/dfn&gt;:&lt;/dt&gt;
+   &lt;dt&gt;If the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element was added to the &lt;dfn id=list-of-scripts-that-will-execute-asynchronously&gt;list
+   of scripts that will execute asynchronously&lt;/dfn&gt;:&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -9540,16 +9608,15 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;a href=#executing-a-script-block title=&quot;executing a script block&quot;&gt;Execute the
-      script&lt;/a&gt; (the script associated with the first element in
-      the list).&lt;/p&gt;
+      &lt;p&gt;&lt;a href=#executing-a-script-block title=&quot;executing a script block&quot;&gt;Execute the script
+      block&lt;/a&gt; (the first element in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Remove the script's element from the list (i.e. shift out the
-      first entry in the list).&lt;/p&gt;
+      &lt;p&gt;Remove the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element from the list
+      (i.e. shift out the first entry in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -9565,21 +9632,21 @@
 
     &lt;/ol&gt;&lt;/dd&gt;
 
-   &lt;dt&gt;If the script's element was added to the &lt;dfn id=list-of-scripts-that-will-execute-as-soon-as-possible&gt;list of scripts
-   that will execute as soon as possible&lt;/dfn&gt;:&lt;/dt&gt;
+   &lt;dt&gt;If the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element was added to the &lt;dfn id=list-of-scripts-that-will-execute-as-soon-as-possible&gt;list
+   of scripts that will execute as soon as possible&lt;/dfn&gt;:&lt;/dt&gt;
 
    &lt;dd&gt;
 
     &lt;ol&gt;&lt;li&gt;
 
       &lt;p&gt;&lt;a href=#executing-a-script-block title=&quot;executing a script block&quot;&gt;Execute the
-      script&lt;/a&gt;.&lt;/p&gt;
+      script block&lt;/a&gt;.&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Remove the script's element from the list.&lt;/p&gt;
+      &lt;p&gt;Remove the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element from the list.&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -9588,35 +9655,36 @@
   &lt;/dl&gt;&lt;p&gt;Fetching an external script must &lt;a href=#delay-the-load-event&gt;delay the &lt;code title=event-load&gt;load&lt;/code&gt; event&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;&lt;dfn id=executing-a-script-block title=&quot;executing a script block&quot;&gt;Executing a script
-  block&lt;/dfn&gt;: When the steps above require that the script be
+  block&lt;/dfn&gt;: When the steps above require that the script block be
   executed, the user agent must act as follows:&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;If the load resulted in an error (for example a DNS error, or
    an HTTP 404 error)&lt;/dt&gt;
 
-   &lt;dd&gt;&lt;p&gt;Executing the script must just consist of &lt;a href=#fire-an-error-event title=&quot;fire
-   an error event&quot;&gt;firing an &lt;code title=event-error&gt;error&lt;/code&gt;
-   event&lt;/a&gt; at the element.&lt;/dd&gt;
+   &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;a href=#fire-an-error-event title=&quot;fire an error event&quot;&gt;firing an &lt;code title=event-error&gt;error&lt;/code&gt; event&lt;/a&gt; at the
+   element.&lt;/dd&gt;
 
    &lt;dt&gt;If the load was successful&lt;/dt&gt;
 
+   &lt;!-- SCRIPT EXEC --&gt;
    &lt;dd&gt;
 
     &lt;ol&gt;&lt;li&gt;
 
-      &lt;p&gt;If the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element's &lt;code&gt;Document&lt;/code&gt; is
-      the &lt;a href=#active-document&gt;active document&lt;/a&gt; in its &lt;a href=#browsing-context&gt;browsing
-      context&lt;/a&gt;, the user agent must execute the script:&lt;/p&gt;
+      &lt;p&gt;Initialise &lt;dfn id=&quot;the-script-block's-source&quot;&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt; as
+      follows:&lt;/p&gt;
 
       &lt;dl class=switch&gt;&lt;dt&gt;If the script is from an external file&lt;/dt&gt;
 
        &lt;dd&gt;
 
-        &lt;p&gt;That file must be used as the file to execute.&lt;/p&gt;
+        &lt;p&gt;The contents of that file, interpreted as as string of
+        Unicode characters, are the script source.&lt;/p&gt;
 
-        &lt;p&gt;The file must be interpreted using the character encoding
-        given by &lt;var&gt;&lt;a href=&quot;#the-script's-character-encoding&quot;&gt;the script's character encoding&lt;/a&gt;&lt;/var&gt;, regardless
-        of any metadata given by the file's &lt;a href=#content-type-0 title=Content-Type&gt;Content-Type metadata&lt;/a&gt;.&lt;/p&gt;
+        &lt;p&gt;The file must be converted to Unicode using the character
+        encoding given by &lt;var&gt;&lt;a href=&quot;#the-script-block's-character-encoding&quot;&gt;the script block's character
+        encoding&lt;/a&gt;&lt;/var&gt;, regardless of any metadata given by the file's
+        &lt;a href=#content-type-0 title=Content-Type&gt;Content-Type metadata&lt;/a&gt;.&lt;/p&gt;
 
         &lt;p class=XXX&gt;This means that a UTF-16 document will
         always assume external scripts are UTF-16...? This applies,
@@ -9627,46 +9695,44 @@
 
        &lt;/dd&gt;
 
-       &lt;dt&gt;If the script is inline&lt;/dt&gt;
+       &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
        &lt;dd&gt;
 
-        &lt;p&gt;For scripting languages that consist of pure text, user
-        agents must use the value of the DOM &lt;code title=dom-script-text&gt;&lt;a href=#dom-script-text&gt;text&lt;/a&gt;&lt;/code&gt; attribute (defined below) as
-        the script to execute, and for XML-based scripting languages,
-        user agents must use all the child nodes of the
-        &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element as the script to execute.&lt;/p&gt;
+        &lt;p&gt;The value of the DOM &lt;code title=dom-script-text&gt;&lt;a href=#dom-script-text&gt;text&lt;/a&gt;&lt;/code&gt; attribute at the time the
+        &quot;&lt;a href=#running-a-script&gt;running a script&lt;/a&gt;&quot; algorithm was first invoked is
+        the script source.&lt;/p&gt;
 
        &lt;/dd&gt;
 
-      &lt;/dl&gt;&lt;!-- SCRIPT EXEC --&gt;&lt;p&gt;In any case, the user agent must execute the script according to
-      the semantics defined by the language associated with &lt;var&gt;&lt;a href=&quot;#the-script's-type&quot;&gt;the
-      script's type&lt;/a&gt;&lt;/var&gt; (see the &lt;a href=#scriptingLanguages&gt;scripting
-      languages&lt;/a&gt; section below).&lt;/p&gt;
+       &lt;dt&gt;If the script is inline and &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; is an XML-based language&lt;/dt&gt;
 
-      &lt;p&gt;The &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; of the script must
-      be the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of that &lt;a href=#browsing-context&gt;browsing
-      context&lt;/a&gt;.&lt;/p&gt;
+       &lt;dd&gt;
 
-      &lt;p&gt;The &lt;a href=#script-document-context&gt;script document context&lt;/a&gt; of the script must
-      be the &lt;code&gt;Document&lt;/code&gt; object that owns the
-      &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
+        &lt;p&gt;The child nodes of the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element at the
+        time the &quot;&lt;a href=#running-a-script&gt;running a script&lt;/a&gt;&quot; algorithm was first
+        invoked are the script source.&lt;/p&gt;
 
-      &lt;p class=note&gt;The element's attributes' values might have changed
-      between when the element was inserted into the document and when the
-      script has finished loading, as may its other attributes; similarly,
-      the element itself might have been taken back out of the DOM, or had
-      other changes made. These changes do not in any way affect the above
-      steps; only the values of the attributes at the time the
-      &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element is first inserted into the document
-      matter.&lt;/p&gt;
+       &lt;/dd&gt;
 
+      &lt;/dl&gt;&lt;/li&gt;
+
+     &lt;li&gt;
+
+      &lt;p&gt;&lt;a href=#create-a-script-from-a-node title=&quot;create a script from a node&quot;&gt;Create a
+      script&lt;/a&gt; from the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element node, using
+      the &lt;var&gt;&lt;a href=&quot;#the-script-block's-source&quot;&gt;the script block's source&lt;/a&gt;&lt;/var&gt; and the &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script
+      block's type&lt;/a&gt;&lt;/var&gt;.&lt;/p&gt;
+
+      &lt;p class=note&gt;This is where the script is compiled and
+      actually executed.&lt;/p&gt;
+
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Then, the user agent must &lt;a href=#fire-a-load-event&gt;fire a &lt;code title=event-load&gt;load&lt;/code&gt; event&lt;/a&gt; at the
-      &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
+      &lt;p&gt;&lt;a href=#fire-a-load-event&gt;Fire a &lt;code title=event-load&gt;load&lt;/code&gt;
+      event&lt;/a&gt; at the &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -9711,8 +9777,8 @@
   &lt;h5 id=scriptingLanguages&gt;&lt;span class=secno&gt;4.3.1.1 &lt;/span&gt;Scripting languages&lt;/h5&gt;
 
   &lt;p&gt;A user agent is said to &lt;dfn id=support-the-scripting-language&gt;support the scripting language&lt;/dfn&gt;
-  if &lt;var&gt;&lt;a href=&quot;#the-script's-type&quot;&gt;the script's type&lt;/a&gt;&lt;/var&gt; matches the MIME type of a scripting
-  language that the user agent implements.&lt;/p&gt;
+  if &lt;var&gt;&lt;a href=&quot;#the-script-block's-type&quot;&gt;the script block's type&lt;/a&gt;&lt;/var&gt; matches the MIME type of a
+  scripting language that the user agent implements.&lt;/p&gt;
 
   &lt;p&gt;The following lists some MIME types and the languages to which
   they refer:&lt;/p&gt;
@@ -9747,9 +9813,9 @@
    &lt;dd&gt;In a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element of an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, if there are no ancestor &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; elements.&lt;/dd&gt;
    &lt;dd&gt;Where &lt;a href=#phrasing-content-0&gt;phrasing content&lt;/a&gt; is expected in &lt;a href=#html-documents&gt;HTML documents&lt;/a&gt;, if there are no ancestor &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; elements.&lt;/dd&gt;
    &lt;dt&gt;Content model:&lt;/dt&gt;
-   &lt;dd&gt;&lt;a href=#without-script&gt;Without script&lt;/a&gt;, in a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element: in any order, zero or more &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt; elements, zero or more &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt; elements, and zero or more &lt;code&gt;&lt;a href=#meta&gt;meta&lt;/a&gt;&lt;/code&gt; elements.&lt;/dd&gt;
-   &lt;dd&gt;&lt;a href=#without-script&gt;Without script&lt;/a&gt;, not in a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element: &lt;a href=#transparent&gt;transparent&lt;/a&gt;, but there must be no &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element descendants.&lt;/dd&gt;
-   &lt;dd&gt;&lt;a href=#with-script&gt;With script&lt;/a&gt;: text that conforms to the requirements given in the prose.&lt;/dd&gt;
+   &lt;dd&gt;When &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is disabled&lt;/a&gt;, in a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element: in any order, zero or more &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt; elements, zero or more &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt; elements, and zero or more &lt;code&gt;&lt;a href=#meta&gt;meta&lt;/a&gt;&lt;/code&gt; elements.&lt;/dd&gt;
+   &lt;dd&gt;When &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is disabled&lt;/a&gt;, not in a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element: &lt;a href=#transparent&gt;transparent&lt;/a&gt;, but there must be no &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element descendants.&lt;/dd&gt;
+   &lt;dd&gt;Otherwise: text that conforms to the requirements given in the prose.&lt;/dd&gt;
    &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
    &lt;dd&gt;None.&lt;/dd&gt;
    &lt;dt&gt;DOM interface:&lt;/dt&gt;
@@ -9759,102 +9825,109 @@
   scripting and those that don't support scripting, by affecting how
   the document is parsed.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must not be used in &lt;a href=#xml-documents&gt;XML
-  documents&lt;/a&gt;.&lt;/p&gt;
-
-  &lt;p class=note&gt;&lt;strong&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is only
-  effective in the &lt;span title=&quot;&quot;&gt;HTML serialization&lt;/span&gt;&lt;!-- XXX
-  xref --&gt;, it has no effect in the &lt;span title=&quot;&quot;&gt;XML
-  serialization&lt;/span&gt;&lt;!-- XXX xref --&gt;.&lt;/strong&gt;&lt;/p&gt;
-
   &lt;p&gt;When used in &lt;a href=#html-documents&gt;HTML documents&lt;/a&gt;, the allowed content
   model is as follows:&lt;/p&gt;
 
-  &lt;p&gt;In a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element, if the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt;
-  element is &lt;a href=#without-script&gt;without script&lt;/a&gt;, then the content model of a
-  &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must contain only &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt;,
-  &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;&lt;a href=#meta&gt;meta&lt;/a&gt;&lt;/code&gt; elements. If the
-  &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is &lt;a href=#with-script&gt;with script&lt;/a&gt;, then the
-  content model of a &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is text, except
-  that invoking the &lt;a href=#html-fragment-parsing-algorithm&gt;HTML fragment parsing algorithm&lt;/a&gt; with
-  the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element as the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt;
-  element and the text contents as the &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; must
-  result in a list of nodes that consists only of &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt;,
-  &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;&lt;a href=#meta&gt;meta&lt;/a&gt;&lt;/code&gt; elements.&lt;/p&gt;
+  &lt;dl&gt;&lt;dt&gt;In a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element, if &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is disabled&lt;/a&gt; for the
+   &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-  &lt;p&gt;Outside of &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; elements, if the
-  &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is &lt;a href=#without-script&gt;without script&lt;/a&gt;, then
-  the content model of a &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is
-  &lt;a href=#transparent&gt;transparent&lt;/a&gt;, with the additional restriction that a
-  &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must not have a &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt;
-  element as an ancestor (that is, &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; can't be
-  nested).&lt;/p&gt;
+   &lt;dd&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must contain only
+   &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;&lt;a href=#meta&gt;meta&lt;/a&gt;&lt;/code&gt;
+   elements.&lt;/dd&gt;
 
-  &lt;p&gt;Outside of &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; elements, if the
-  &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is &lt;a href=#with-script&gt;with script&lt;/a&gt;, then the
-  content model of a &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is text, except
-  that the text must be such that running the following algorithm
-  results in a conforming document with no &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt;
-  elements and no &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; elements, and such that no step
-  in the algorithm causes an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt; to flag a
-  &lt;a href=#parse-error&gt;parse error&lt;/a&gt;:&lt;/p&gt;
+   &lt;dt&gt;In a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element, if &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is enabled&lt;/a&gt; for the
+   &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-  &lt;ol&gt;&lt;li&gt;Remove every &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element from the
-   document.&lt;/li&gt;
+   &lt;dd&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must contain only text,
+   except that invoking the &lt;a href=#html-fragment-parsing-algorithm&gt;HTML fragment parsing
+   algorithm&lt;/a&gt; with the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element as the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element and the text contents as the &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; must result in a list of nodes that consists
+   only of &lt;code&gt;&lt;a href=#the-link-element&gt;link&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt;, and
+   &lt;code&gt;&lt;a href=#meta&gt;meta&lt;/a&gt;&lt;/code&gt; elements.&lt;/dd&gt;
 
-   &lt;li&gt;Make a list of every &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element in the
-   document. For every &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element in that list,
-   perform the following steps:
+   &lt;dt&gt;Outside of &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; elements, if &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is disabled&lt;/a&gt; for the
+   &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-    &lt;ol&gt;&lt;li&gt;Let the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; be the parent
-     element of the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element.&lt;/li&gt;
+   &lt;dd&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element's content model is
+   &lt;a href=#transparent&gt;transparent&lt;/a&gt;, with the additional restriction that a
+   &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must not have a &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt;
+   element as an ancestor (that is, &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; can't be
+   nested).&lt;/dd&gt;
 
-     &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
-     that come before the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element, and call these
-     elements &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt;.&lt;/li&gt;
+   &lt;dt&gt;Outside of &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; elements, if &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is enabled&lt;/a&gt; for the
+   &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-     &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
-     that come &lt;em&gt;after&lt;/em&gt; the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element, and
-     call these elements &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt;.&lt;/li&gt;
+   &lt;dd&gt;
 
-     &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;s&lt;/var&gt; be the concatenation of all the
-     &lt;a href=#text-node&gt;text node&lt;/a&gt; children of the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt;
-     element.&lt;/li&gt;
+    &lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must contain only text,
+    except that the text must be such that running the following
+    algorithm results in a conforming document with no
+    &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; elements and no &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;
+    elements, and such that no step in the algorithm causes an
+    &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt; to flag a &lt;a href=#parse-error&gt;parse error&lt;/a&gt;:&lt;/p&gt;
 
-     &lt;li&gt;Set the &lt;code title=dom-innerHTML-HTML&gt;&lt;a href=#dom-innerhtml-html&gt;innerHTML&lt;/a&gt;&lt;/code&gt;
-     attribute of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; to the value
-     of &lt;var title=&quot;&quot;&gt;s&lt;/var&gt;. (This, as a side-effect, causes the
-     &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element to be removed from the
-     document.)&lt;/li&gt;
+    &lt;ol&gt;&lt;li&gt;Remove every &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element from the
+     document.&lt;/li&gt;
 
-     &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt; at the start of
-     the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
-     relative order.&lt;/li&gt;
+     &lt;li&gt;Make a list of every &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element in the
+     document. For every &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element in that list,
+     perform the following steps:
 
-     &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt; at the end of the
-     &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
-     relative order.&lt;/li&gt;
+      &lt;ol&gt;&lt;li&gt;Let the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; be the parent
+       element of the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element.&lt;/li&gt;
 
-    &lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
+       that come before the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element, and call these
+       elements &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt;.&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element has no other requirements. In
-  particular, children of the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element are not
-  exempt from form submission, scripting, and so forth, even when the
-  element is &lt;a href=#with-script&gt;with script&lt;/a&gt;.&lt;/p&gt;
+       &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
+       that come &lt;em&gt;after&lt;/em&gt; the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element, and
+       call these elements &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt;.&lt;/li&gt;
 
-  &lt;p class=note&gt;All these contortions are required because, for
+       &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;s&lt;/var&gt; be the concatenation of all the
+       &lt;a href=#text-node&gt;text node&lt;/a&gt; children of the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt;
+       element.&lt;/li&gt;
+
+       &lt;li&gt;Set the &lt;code title=dom-innerHTML-HTML&gt;&lt;a href=#dom-innerhtml-html&gt;innerHTML&lt;/a&gt;&lt;/code&gt;
+       attribute of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; to the value
+       of &lt;var title=&quot;&quot;&gt;s&lt;/var&gt;. (This, as a side-effect, causes the
+       &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element to be removed from the
+       document.)&lt;/li&gt;
+
+       &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt; at the start of
+       the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
+       relative order.&lt;/li&gt;
+
+       &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt; at the end of the
+       &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
+       relative order.&lt;/li&gt;
+
+      &lt;/ol&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p class=note&gt;All these contortions are required because, for
   historical reasons, the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is handled
   differently by the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt; based on whether &lt;a href=#scripting-flag title=&quot;scripting flag&quot;&gt;scripting was enabled or not&lt;/a&gt; when the
   parser was invoked. The element is not allowed in XML, because in
   XML the parser is not affected by such state, and thus the element
   would not have the desired effect.&lt;/p&gt;
 
-  &lt;p class=note&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element interacts poorly
-  with the &lt;code title=dom-document-designMode&gt;&lt;a href=#designMode&gt;designMode&lt;/a&gt;&lt;/code&gt;
-  feature. Authors are encouraged to not use &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt;
-  elements on pages that will have &lt;code title=dom-document-designMode&gt;&lt;a href=#designMode&gt;designMode&lt;/a&gt;&lt;/code&gt; enabled.&lt;/p&gt;
+  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element must not be used in &lt;a href=#xml-documents&gt;XML
+  documents&lt;/a&gt;.&lt;/p&gt;
 
+  &lt;p class=note&gt;&lt;strong&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element is only
+  effective in the &lt;span&gt;HTML serialization&lt;/span&gt;&lt;!-- XXX xref --&gt;,
+  it has no effect in the &lt;span&gt;XML serialization&lt;/span&gt;&lt;!-- XXX xref
+  --&gt;.&lt;/strong&gt;&lt;/p&gt;
 
+  &lt;p&gt;The &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element has no other requirements. In
+  particular, children of the &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element are not
+  exempt from form submission, scripting, and so forth, even when
+  &lt;a href=#concept-n-script title=concept-n-script&gt;scripting is enabled&lt;/a&gt; for the
+  element.&lt;/p&gt;
+
+
+
   &lt;h4 id=the-eventsource-element&gt;&lt;span class=secno&gt;4.3.3 &lt;/span&gt;The &lt;dfn&gt;&lt;code&gt;eventsource&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
   &lt;dl class=element&gt;&lt;dt&gt;Categories&lt;/dt&gt;
@@ -14576,7 +14649,7 @@
   processed. Otherwise, the attribute must return false.&lt;/p&gt;
 
   &lt;p class=note&gt;The value of &lt;code title=dom-img-complete&gt;&lt;a href=#dom-img-complete&gt;complete&lt;/a&gt;&lt;/code&gt; can thus change while a
-  script is executing.&lt;/p&gt;
+  &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; is executing.&lt;/p&gt;
 
   &lt;p&gt;Three constructors are provided for creating
   &lt;code&gt;&lt;a href=#htmlimageelement&gt;HTMLImageElement&lt;/a&gt;&lt;/code&gt; objects (in addition to the factory
@@ -15615,7 +15688,9 @@
   (either directly or indirectly through other nested browsing
   contexts) must have the following flags set:&lt;/p&gt;
 
-  &lt;dl&gt;&lt;dt&gt;The &lt;dfn id=sandboxed-navigation-browsing-context-flag&gt;sandboxed navigation browsing context flag&lt;/dfn&gt;&lt;/dt&gt;
+  &lt;dl&gt;&lt;!-- XXX disallow cross-origin loads of any kind (networking
+        override that only allows same-origin URLs or about:,
+        javascript:, data:) --&gt;&lt;!-- XXX block access to 'contentWindow.frames' from iframe owner --&gt;&lt;!-- XXX block access to 'parent.frames' from sandbox --&gt;&lt;dt&gt;The &lt;dfn id=sandboxed-navigation-browsing-context-flag&gt;sandboxed navigation browsing context flag&lt;/dfn&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -18484,14 +18559,15 @@
 
   &lt;p&gt;The &lt;dfn id=attr-media-controls title=attr-media-controls&gt;&lt;code&gt;controls&lt;/code&gt;&lt;/dfn&gt;
   attribute is a &lt;a href=#boolean-attribute&gt;boolean attribute&lt;/a&gt;. If the attribute is
-  present, or if the &lt;a href=#media-element&gt;media element&lt;/a&gt; is &lt;a href=#without-script&gt;without
-  script&lt;/a&gt;, then the user agent should &lt;dfn id=expose-a-user-interface-to-the-user&gt;expose a user
-  interface to the user&lt;/dfn&gt;. This user interface should include
-  features to begin playback, pause playback, seek to an arbitrary
-  position in the content (if the content supports arbitrary seeking),
-  change the volume, and show the media content in manners more
-  suitable to the user (e.g. full-screen video or in an independent
-  resizable window). Other controls may also be made available.&lt;/p&gt;
+  present, or if &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is
+  disabled&lt;/a&gt; for the &lt;a href=#media-element&gt;media element&lt;/a&gt;, then the user
+  agent should &lt;dfn id=expose-a-user-interface-to-the-user&gt;expose a user interface to the user&lt;/dfn&gt;. This
+  user interface should include features to begin playback, pause
+  playback, seek to an arbitrary position in the content (if the
+  content supports arbitrary seeking), change the volume, and show the
+  media content in manners more suitable to the user (e.g. full-screen
+  video or in an independent resizable window). Other controls may
+  also be made available.&lt;/p&gt;
 
   &lt;p&gt;If the attribute is absent, then the user agent should avoid
   making a user interface available that could conflict with an
@@ -18757,8 +18833,8 @@
   element. The contents of the &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element, if any,
   are the element's &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;In interactive visual media, if the &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element
-  is &lt;a href=#with-script&gt;with script&lt;/a&gt;, the &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element
+  &lt;p&gt;In interactive visual media, if &lt;a href=#concept-n-script title=concept-n-script&gt;scripting is enabled&lt;/a&gt; for the
+  &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element, the &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element
   represents an embedded element with a dynamically created image.&lt;/p&gt;
 
   &lt;p&gt;In non-interactive, static, visual media, if the
@@ -18770,10 +18846,9 @@
   size. Otherwise, the element represents its &lt;a href=#fallback-content&gt;fallback
   content&lt;/a&gt; instead.&lt;/p&gt;
 
-  &lt;p&gt;In non-visual media, and in visual media if the
-  &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element is &lt;a href=#without-script&gt;without script&lt;/a&gt;, the
-  &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element represents its &lt;a href=#fallback-content&gt;fallback
-  content&lt;/a&gt; instead.&lt;/p&gt;
+  &lt;p&gt;In non-visual media, and in visual media if &lt;a href=#concept-n-noscript title=concept-n-noscript&gt;scripting is disabled&lt;/a&gt; for the
+  &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element, the &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element
+  represents its &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt; instead.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=#the-canvas-element&gt;canvas&lt;/a&gt;&lt;/code&gt; element has two attributes to control the
   size of the coordinate space: &lt;dfn id=attr-canvas-width title=attr-canvas-width&gt;&lt;code&gt;width&lt;/code&gt;&lt;/dfn&gt; and &lt;dfn id=attr-canvas-height title=attr-canvas-height&gt;&lt;code&gt;height&lt;/code&gt;&lt;/dfn&gt;. These
@@ -32738,12 +32813,13 @@
           <A HREF="http://www.mozilla.org/docs/dom/domref/dom_window_ref.html">http://www.mozilla.org/docs/dom/domref/dom_window_ref.html</A>
           <A HREF="http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindow.idl">http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindow.idl</A> - scrollBy, etc
           <A HREF="http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindowInternal.idl">http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindowInternal.idl</A> - DOM level 0
+      close() focus() blur()
    --&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-window title=dom-window&gt;&lt;code&gt;window&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-frames title=dom-frames&gt;&lt;code&gt;frames&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn id=dom-self title=dom-self&gt;&lt;code&gt;self&lt;/code&gt;&lt;/dfn&gt; DOM attributes must all
   return the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object itself.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object also provides the scope for script
+  &lt;p&gt;The &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object also provides the scope for &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;
   execution. Each &lt;code&gt;Document&lt;/code&gt; in a &lt;a href=#browsing-context&gt;browsing
   context&lt;/a&gt; has an associated &lt;dfn id=list-of-added-properties&gt;list of added properties&lt;/dfn&gt;
   that, when a document is &lt;a href=#active-document title=&quot;active
@@ -32840,9 +32916,9 @@
   enabled&lt;/a&gt;; otherwise, it must not be enabled unless the
   &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; was just created as part of the
   &lt;a href=#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name&gt;the rules for choosing a browsing context given a browsing
-  context name&lt;/a&gt;. The navigation must be done with the
-  &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt; of the script that invoked the
-  method as the &lt;a href=#source-browsing-context&gt;source browsing context&lt;/a&gt;.&lt;/p&gt;
+  context name&lt;/a&gt;. The navigation must be done with the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing context&lt;/a&gt; of the
+  &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that invoked the method as the &lt;a href=#source-browsing-context&gt;source browsing
+  context&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;The method must return the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of the
   default view of the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; that was
@@ -32873,6 +32949,41 @@
 
 
 
+  &lt;h4 id=garbage-collection-and-browsing-contexts&gt;&lt;span class=secno&gt;5.2.4 &lt;/span&gt;Garbage collection and browsing contexts&lt;/h4&gt;
+
+  &lt;p&gt;A &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; has a strong reference to each of
+  its &lt;code&gt;Document&lt;/code&gt;s and &lt;a href=#view title=view&gt;views&lt;/a&gt;, and
+  the user agent itself has a strong reference to its &lt;a href=#top-level-browsing-context title=&quot;top-level browsing context&quot;&gt;top-level browsing
+  contexts&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;When a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; is to &lt;dfn id=discard-a-document&gt;discard a
+  &lt;code&gt;Document&lt;/code&gt;&lt;/dfn&gt;, that means that it is to lose the
+  strong reference from the &lt;code&gt;Document&lt;/code&gt;'s &lt;a href=#browsing-context&gt;browsing
+  context&lt;/a&gt; to the &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
+
+  &lt;p class=note&gt;The &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s &lt;a href=#default-view&gt;default
+  view&lt;/a&gt;'s &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object &lt;a href=#implied-strong-reference title=&quot;implied strong
+  reference&quot;&gt;has a strong reference of its own&lt;/a&gt; to the
+  &lt;code&gt;Document&lt;/code&gt; object of the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s
+  &lt;a href=#active-document&gt;active document&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;When &lt;dfn id=a-browsing-context-is-discarded&gt;a &lt;em&gt;&lt;span&gt;browsing context&lt;/span&gt;&lt;/em&gt; is
+  discarded&lt;/dfn&gt;, the strong reference from the user agent itself to
+  the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; must be severed, and all the
+  &lt;code&gt;Document&lt;/code&gt; objects for all the entries in the
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s session history must be &lt;a href=#discard-a-document title=&quot;discard a document&quot;&gt;discarded&lt;/a&gt; as well.&lt;/p&gt;
+
+  &lt;p&gt;User agents may &lt;a href=#a-browsing-context-is-discarded title=&quot;a browsing context is
+  discarded&quot;&gt;discard&lt;/a&gt; &lt;a href=#top-level-browsing-context title=&quot;top-level browsing
+  context&quot;&gt;top-level browsing contexts&lt;/a&gt; at any time (typically,
+  in response to user requests, e.g. when a user closes a window
+  containing one or more &lt;a href=#top-level-browsing-context title=&quot;top-level browsing
+  context&quot;&gt;top-level browsing contexts&lt;/a&gt;). Other &lt;a href=#browsing-context title=&quot;browsing context&quot;&gt;browsing contexts&lt;/a&gt; must be discarded
+  once their &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object is eligible for garbage
+  collection.&lt;/p&gt;
+
+
+
   &lt;h3 id=origin&gt;&lt;span class=secno&gt;5.3 &lt;/span&gt;Origin&lt;/h3&gt;
   &lt;!-- Hallowed are the Ori --&gt;
 
@@ -33291,6 +33402,8 @@
 
   &lt;h3 id=scripting&gt;&lt;span class=secno&gt;5.4 &lt;/span&gt;Scripting&lt;/h3&gt;
 
+  &lt;h4 id=introduction-0&gt;&lt;span class=secno&gt;5.4.1 &lt;/span&gt;Introduction&lt;/h4&gt;
+
   &lt;p&gt;Various mechanisms can cause author-provided executable code to
   run in the context of a document. These mechanisms include, but are
   probably not limited to:&lt;/p&gt;
@@ -33309,85 +33422,246 @@
    &lt;li&gt;Processing of technologies like XBL or SVG that have their own
    scripting features.&lt;/li&gt;
 
-  &lt;/ul&gt;&lt;p&gt;When a script is created&lt;!-- which is marked by SCRIPT EXEC in
-  this spec --&gt;, it is associated with a &lt;a href=#script-execution-context&gt;script execution
-  context&lt;/a&gt;, a &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt;, and a
-  &lt;a href=#script-document-context&gt;script document context&lt;/a&gt;.&lt;/p&gt;
+  &lt;/ul&gt;&lt;h4 id=enabling-and-disabling-scripting&gt;&lt;span class=secno&gt;5.4.2 &lt;/span&gt;Enabling and disabling scripting&lt;/h4&gt;
 
+  &lt;p&gt;&lt;dfn id=concept-bc-script title=concept-bc-script&gt;Scripting is enabled&lt;/dfn&gt; in a
+  &lt;em&gt;&lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;&lt;/em&gt; when all of the
+  following conditions are true:&lt;/p&gt;
 
+  &lt;ul&gt;&lt;li&gt;The user agent supports scripting.&lt;/li&gt;
 
-  &lt;!-- SCRIPT EXEC --&gt;
-  &lt;h4 id=script-execution-contexts&gt;&lt;span class=secno&gt;5.4.1 &lt;/span&gt;Script execution contexts&lt;/h4&gt;
+   &lt;li&gt;The user has not disabled scripting for this &lt;a href=#browsing-context&gt;browsing
+   context&lt;/a&gt; at this time. (User agents may provide users with
+   the option to disable scripting globally, or in a finer-grained
+   manner, e.g. on a per-origin basis.)&lt;/li&gt;
 
-  &lt;p&gt;The &lt;dfn id=script-execution-context&gt;script execution context&lt;/dfn&gt; of a script is defined
-  when that script is created. In this specification, it is either a
-  &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object or an empty object; other specifications
-  might make the script execution context be some other object.&lt;/p&gt;
+   &lt;li id=sandboxScriptBlocked&gt;The &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;
+   does not have the &lt;a href=#sandboxed-scripts-browsing-context-flag&gt;sandboxed scripts browsing context
+   flag&lt;/a&gt; set.&lt;/li&gt;
 
-  &lt;p&gt;When the &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; of a script is an
-  empty object, it can't do anything that interacts with the
-  environment.&lt;/p&gt;
+  &lt;/ul&gt;&lt;p&gt;&lt;dfn id=concept-bc-noscript title=concept-bc-noscript&gt;Scripting is disabled&lt;/dfn&gt; in a
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; when any of the above conditions are
+  false (i.e. when scripting is not &lt;a href=#concept-bc-script title=concept-bc-script&gt;enabled&lt;/a&gt;).&lt;/p&gt;
 
-  &lt;p&gt;A &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; always has an associated
-  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, known as the &lt;dfn id=script-browsing-context&gt;script browsing
-  context&lt;/dfn&gt;. If the &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; is a
-  &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object, then that object's &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt; is it. Otherwise, the &lt;a href=#script-execution-context&gt;script execution
-  context&lt;/a&gt; is associated explicitly with a &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt; when it is created.&lt;/p&gt;
+  &lt;hr&gt;&lt;p&gt;&lt;dfn id=concept-n-script title=concept-n-script&gt;Scripting is enabled&lt;/dfn&gt; for a
+  &lt;em&gt;node&lt;/em&gt; if the &lt;code&gt;Document&lt;/code&gt; object of the node (the
+  node itself, if it is itself a &lt;code&gt;Document&lt;/code&gt; object) has an
+  associated &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, and &lt;a href=#concept-bc-script title=concept-bc-script&gt;scripting is enabled&lt;/a&gt; in that
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;Every script whose &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; is a
-  &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object is also associated with a
-  &lt;code&gt;Document&lt;/code&gt; object, known as its &lt;dfn id=script-document-context&gt;script document
-  context&lt;/dfn&gt;. It is used to &lt;a href=#resolve-a-url title=&quot;resolve a
-  url&quot;&gt;resolve&lt;/a&gt; URLs. The document is assigned when the script
-  is created, as with the &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt;.&lt;/p&gt;
+  &lt;p&gt;&lt;dfn id=concept-n-noscript title=concept-n-noscript&gt;Scripting is disabled&lt;/dfn&gt; for a
+  node if there is no such &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, or if &lt;a href=#concept-bc-noscript title=concept-bc-noscript&gt;scripting is disabled&lt;/a&gt; in that
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;hr&gt;&lt;p&gt;It is said that &lt;dfn id=scripting-is-disabled&gt;scripting is disabled&lt;/dfn&gt; in a
-  &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; when any of the following
-  conditions are true:&lt;/p&gt;
 
-  &lt;ul&gt;&lt;li&gt;The user agent does not support scripting.&lt;/li&gt;
 
-   &lt;li&gt;The user has disabled scripting for this &lt;a href=#script-execution-context&gt;script execution
-   context&lt;/a&gt;. (User agents may provide users with the option to
-   disable scripting globally, on a per-origin basis, or in other ways
-   down to the granularity of individual &lt;a href=#script-execution-context title=&quot;script execution
-   context&quot;&gt;script execution contexts&lt;/a&gt;.)&lt;/li&gt;
+  &lt;!-- SCRIPT EXEC (marks areas related to creation of scripts) --&gt;
+  &lt;h4 id=processing-model-1&gt;&lt;span class=secno&gt;5.4.3 &lt;/span&gt;Processing model&lt;/h4&gt;
 
-   &lt;li id=designModeScriptBlocked&gt;The &lt;a href=#script-execution-context&gt;script execution
-   context&lt;/a&gt;'s associated &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s
-   &lt;a href=#active-document&gt;active document&lt;/a&gt; has &lt;code title=dom-document-designMode&gt;&lt;a href=#designMode&gt;designMode&lt;/a&gt;&lt;/code&gt; enabled.&lt;/li&gt;
+  &lt;h5 id=definitions-0&gt;&lt;span class=secno&gt;5.4.3.1 &lt;/span&gt;Definitions&lt;/h5&gt;
 
-   &lt;li id=sandboxScriptBlocked&gt;The &lt;a href=#script-execution-context&gt;script execution
-   context&lt;/a&gt;'s associated &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; has the
-   &lt;a href=#sandboxed-scripts-browsing-context-flag&gt;sandboxed scripts browsing context flag&lt;/a&gt; set.&lt;/li&gt;
+  &lt;p&gt;A &lt;dfn id=concept-script title=concept-script&gt;script&lt;/dfn&gt; has:&lt;/p&gt;
 
-  &lt;/ul&gt;&lt;p&gt;A node is said to be &lt;dfn id=without-script&gt;without script&lt;/dfn&gt; if either the
-  &lt;code&gt;Document&lt;/code&gt; object of the node (the node itself, if it is
-  itself a &lt;code&gt;Document&lt;/code&gt; object) does not have an associated
-  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, or &lt;a href=#scripting-is-disabled&gt;scripting is disabled&lt;/a&gt;
-  in that &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;.&lt;/p&gt;
+  &lt;dl&gt;&lt;dt&gt;A &lt;dfn id=script-execution-environment&gt;script execution environment&lt;/dfn&gt;&lt;/dt&gt;
 
-  &lt;p&gt;A node is said to be &lt;dfn id=with-script&gt;with script&lt;/dfn&gt; if it is not
-  &lt;a href=#without-script&gt;without script&lt;/a&gt;.&lt;/p&gt;
+   &lt;dd&gt;
 
-  &lt;p class=XXX&gt;If you can find a better pair of terms than
-  &quot;with script&quot; and &quot;without script&quot; let me know. The only things I
-  can find that are less confusing are also way, way longer.&lt;/p&gt;
+    &lt;p&gt;The characteristics of the script execution environment depend
+    on the language, and are not defined by this specification.&lt;/p&gt;
 
-  &lt;p&gt;When a script is to be executed in a &lt;a href=#script-execution-context&gt;script execution
-  context&lt;/a&gt; in which &lt;a href=#scripting-is-disabled&gt;scripting is disabled&lt;/a&gt;, the
-  script must do nothing and return nothing (a void return value).&lt;/p&gt;
+    &lt;p class=example&gt;In JavaScript, the script execution environment
+    consists of the interpreter, the stack of &lt;i&gt;execution
+    contexts&lt;/i&gt;, the &lt;i&gt;global code&lt;/i&gt; and &lt;i&gt;function code&lt;/i&gt; and
+    the Function objects resulting, and so forth.&lt;/p&gt;
 
-  &lt;p class=note&gt;Thus, for instance, enabling &lt;code title=dom-document-designMode&gt;&lt;a href=#designMode&gt;designMode&lt;/a&gt;&lt;/code&gt; will disable any
-  event handler attributes, event listeners, timeouts, etc, that were
-  set by scripts in the document.&lt;/p&gt;
+   &lt;/dd&gt;
 
+   &lt;dt&gt;A &lt;dfn id=list-of-code-entry-points&gt;list of code entry-points&lt;/dfn&gt;&lt;/dt&gt;
 
+   &lt;dd&gt;
 
-  &lt;h4 id=event-loops&gt;&lt;span class=secno&gt;5.4.2 &lt;/span&gt;Event loops&lt;/h4&gt;
+    &lt;p&gt;Each code entry-point represents a block of executable code
+    that the script exposes to other scripts and to the user
+    agent.&lt;/p&gt;
 
+    &lt;p class=example&gt;Each Function object in a JavaScript
+    &lt;a href=#script-execution-environment&gt;script execution environment&lt;/a&gt; has a corresponding code
+    entry-point, for instance.&lt;/p&gt;
+
+    &lt;p&gt;The main program code of the script, if any, is the
+    &lt;dfn id=initial-code-entry-point&gt;&lt;i&gt;initial code entry-point&lt;/i&gt;&lt;/dfn&gt;. Typically, the code
+    corresponding to this entry-point is executed immediately after
+    the script is parsed.&lt;/p&gt;
+
+    &lt;p class=example&gt;In JavaScript, this corresponds to the
+    execution context of the global code.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A relationship with the &lt;dfn id=&quot;script's-global-object&quot;&gt;script's global object&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;An object that provides the APIs that the code can use.&lt;/p&gt;
+
+    &lt;p class=example&gt;This is typically a &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt;
+    object. In JavaScript, this corresponds to the &lt;i&gt;global
+    object&lt;/i&gt;.&lt;/p&gt;
+
+    &lt;p class=note&gt;When a &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt; is an
+    empty object, it can't do anything that interacts with the
+    environment.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A relationship with the &lt;dfn id=&quot;script's-browsing-context&quot;&gt;script's browsing context&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; that is assigned responsibility
+    for actions taken by the script.&lt;/p&gt;
+
+    &lt;p class=example&gt;When a script creates and &lt;a href=#navigate title=navigate&gt;navigates&lt;/a&gt; a new &lt;a href=#top-level-browsing-context&gt;top-level browsing
+    context&lt;/a&gt;, the &lt;code title=dom-opener&gt;&lt;a href=#dom-opener&gt;opener&lt;/a&gt;&lt;/code&gt;
+    attribute of the new &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s
+    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object will be set to the &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's
+    browsing context&lt;/a&gt;'s &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A &lt;dfn id=&quot;script's-character-encoding&quot; title=&quot;script's character encoding&quot;&gt;character encoding&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A character encoding, set when the script is created, used to
+    encode URLs.  &lt;span id=sce-not-copy&gt;If the character encoding is
+    set from another source, e.g. a &lt;a href=&quot;#document's-character-encoding&quot;&gt;document's character
+    encoding&lt;/a&gt;, then the &lt;a href=&quot;#script's-character-encoding&quot;&gt;script's character encoding&lt;/a&gt;
+    must follow the source, so that if the source's changes, so does
+    the script's.&lt;/span&gt;&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A &lt;dfn id=&quot;script's-base-url&quot; title=&quot;script's base URL&quot;&gt;base URL&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt;, set when the script is created, used to
+    resolve relative URLs. &lt;span id=sbu-not-copy&gt;If the base URL is
+    set from another source, e.g. a &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt;,
+    then the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt; must follow the source, so
+    that if the source's changes, so does the script's.&lt;/span&gt;&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;Membership in a &lt;dfn id=script-group&gt;script group&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A group of one or more scripts that are loaded in the same
+    context, which are always disabled as a group. Scripts in a script
+    group all have the same &lt;a href=&quot;#script's-global-object&quot; title=&quot;script's global
+    object&quot;&gt;global object&lt;/a&gt; and &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing
+    context&quot;&gt;browsing context&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;p&gt;A script group can be &lt;i&gt;frozen&lt;/i&gt;. When a script group is
+    frozen, any code defined in that script group will throw an
+    exception when invoked. A frozen script group can be
+    &lt;i&gt;unfrozen&lt;/i&gt;, allowing scripts in that script group to run
+    normally again.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=calling-scripts&gt;&lt;span class=secno&gt;5.4.3.2 &lt;/span&gt;Calling scripts&lt;/h5&gt;
+
+  &lt;p&gt;When a user agent is to &lt;dfn id=jump-to-a-code-entry-point&gt;jump to a code entry-point&lt;/dfn&gt; for
+  a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;, if &lt;a href=#concept-bc-noscript title=concept-bc-noscript&gt;scripting is disabled&lt;/a&gt; in the
+  &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, or if the script's
+  &lt;a href=#script-group&gt;script group&lt;/a&gt; is &lt;i&gt;frozen&lt;/i&gt;, then the user agent must
+  throw an &lt;code&gt;&lt;a href=#unavailable_script_err&gt;UNAVAILABLE_SCRIPT_ERR&lt;/a&gt;&lt;/code&gt; exception. Otherwise,
+  the &lt;a href=#script-execution-environment title=&quot;script execution environment&quot;&gt;script execution
+  environment&lt;/a&gt; for the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; must execute the code for the
+  given code entry-point.&lt;/p&gt;
+
+  &lt;p&gt;When executable code in one &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; makes a call to another &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;, the user agent must &lt;a href=#jump-to-a-code-entry-point title=&quot;jump to a code entry-point&quot;&gt;jump&lt;/a&gt; to the corresponding
+  code entry-point in that second script.&lt;/p&gt;
+
+  &lt;p&gt;Any time the user agent to invoke a callback defined in a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;, the user agent must &lt;a href=#jump-to-a-code-entry-point title=&quot;jump to a code entry-point&quot;&gt;jump&lt;/a&gt; to the corresponding
+  code entry-point in that second script.&lt;/p&gt;
+
+
+
+  &lt;h5 id=creating-scripts&gt;&lt;span class=secno&gt;5.4.3.3 &lt;/span&gt;Creating scripts&lt;/h5&gt;
+
+  &lt;p&gt;When the specification says that a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; is to be &lt;dfn id=create-a-script title=&quot;create a
+  script&quot;&gt;created&lt;/dfn&gt;, given some script source, its scripting
+  language, a global object, a browsing context, a character encoding,
+  a base URL, and a script group, the user agent must run the
+  following steps:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Set up a &lt;a href=#script-execution-environment&gt;script execution environment&lt;/a&gt; as
+   appropriate for the scripting language.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Parse/compile/initialise the source of the script using the
+   &lt;a href=#script-execution-environment&gt;script execution environment&lt;/a&gt;, as appropriate for the
+   scripting language, and thus obtain the &lt;a href=#list-of-code-entry-points&gt;list of code
+   entry-points&lt;/a&gt; for the script. If the semantics of the
+   scripting language and the given source code are such that there is
+   executable code to be immediately run, then the &lt;i&gt;&lt;a href=#initial-code-entry-point&gt;initial code
+   entry-point&lt;/a&gt;&lt;/i&gt; is the entry-point for that code.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set up the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, the
+   &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, the &lt;a href=&quot;#script's-character-encoding&quot;&gt;script's
+   character encoding&lt;/a&gt;, and the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt;
+   from the settings passed to this algorithm.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Add the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; to the given &lt;a href=#script-group&gt;script
+   group&lt;/a&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;a href=#jump-to-a-code-entry-point title=&quot;jump to a code entry-point&quot;&gt;Jump&lt;/a&gt; to the
+   &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;'s &lt;i&gt;&lt;a href=#initial-code-entry-point&gt;initial code
+   entry-point&lt;/a&gt;&lt;/i&gt;.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;hr&gt;&lt;p&gt;When the user agent is to &lt;dfn id=create-an-impotent-script&gt;create an impotent script&lt;/dfn&gt;,
+  given some script source, its scripting language, and a browsing
+  context, the user agent must &lt;a href=#create-a-script&gt;create a script&lt;/a&gt;, using the
+  given script source and scripting language, using a new empty object
+  as the global object, using the given browsing context as the
+  browsing context, and using a new script group as the script
+  group. The character encoding and base URL for the resulting &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; are not important as no APIs
+  are exposed to the script.&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;When the specification says that a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; is to be &lt;dfn id=create-a-script-from-a-node title=&quot;create a
+  script from a node&quot;&gt;created from a node&lt;/dfn&gt; &lt;var title=&quot;&quot;&gt;node&lt;/var&gt;, given some script source and its scripting
+  language, the user agent &lt;a href=#create-a-script&gt;create a script&lt;/a&gt;, using the
+  given script source and scripting language, and using &lt;a href=#the-script-settings-determined-from-the-node&gt;the
+  script settings determined from the node&lt;/a&gt; &lt;var title=&quot;&quot;&gt;node&lt;/var&gt;.&lt;/p&gt;
+
+  &lt;p&gt;&lt;dfn id=the-script-settings-determined-from-the-node&gt;The script settings determined from the node&lt;/dfn&gt; &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; are computed as follows:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; be the
+   &lt;code&gt;Document&lt;/code&gt; of &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; (or &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; itself if it is a
+   &lt;code&gt;Document&lt;/code&gt;).&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The browsing context is the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; of
+   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of the
+   &lt;a href=#default-view&gt;default view&lt;/a&gt; of the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; of
+   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The character encoding is the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's
+   character encoding&quot;&gt;character encoding&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. (&lt;a href=#sce-not-copy&gt;This is a
+   reference, not a copy&lt;/a&gt;.)&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The base URL is the &lt;a href=#document-base-url title=&quot;document base URL&quot;&gt;base
+   URL&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. (&lt;a href=#sbu-not-copy&gt;This is a reference, not a copy&lt;/a&gt;.)&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The script group is the &lt;a href=#current-script-group&gt;current script group&lt;/a&gt; of
+   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;h4 id=event-loops&gt;&lt;span class=secno&gt;5.4.4 &lt;/span&gt;Event loops&lt;/h4&gt;
+
   &lt;p&gt;To coordinate events, user interaction, scripts, rendering,
   networking, and so forth, user agents must use &lt;dfn id=event-loop title=&quot;event
   loop&quot;&gt;event loops&lt;/dfn&gt; as described in this section.&lt;/p&gt;
@@ -33445,7 +33719,18 @@
    manipulation, e.g. when that element is &lt;a href=#insert-an-element-into-a-document title=&quot;insert an
    element into a document&quot;&gt;inserted into the document&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;/dl&gt;&lt;p&gt;When a user agent is to &lt;dfn id=queue-a-task&gt;queue a task&lt;/dfn&gt;, it must add the
+  &lt;/dl&gt;&lt;p&gt;Each &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; is associated with a
+  &lt;code&gt;Document&lt;/code&gt;; if the task was queued in the context of an
+  element, then it is the element's &lt;code&gt;Document&lt;/code&gt;; if the task
+  was queued in the context of a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, then
+  it is the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'a &lt;a href=#active-document&gt;active
+  document&lt;/a&gt; at the time the task was queued; if the task was
+  queued by or for a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; then
+  the document is the script's &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing
+  context&lt;/a&gt;'s &lt;a href=#active-document&gt;active document&lt;/a&gt; at the time the task
+  was queued.&lt;/p&gt;
+
+  &lt;p&gt;When a user agent is to &lt;dfn id=queue-a-task&gt;queue a task&lt;/dfn&gt;, it must add the
   given task to one of the &lt;a href=#task-queue title=&quot;task queue&quot;&gt;task queues&lt;/a&gt;
   of the relevant &lt;a href=#event-loop&gt;event loop&lt;/a&gt;. All the tasks from one
   particular &lt;dfn id=task-source&gt;task source&lt;/dfn&gt; (e.g. the callbacks generated by
@@ -33467,8 +33752,10 @@
   following steps for as long as it exists:&lt;/p&gt;
 
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;Run the oldest task on one of the &lt;a href=#event-loop&gt;event loop&lt;/a&gt;'s
-   &lt;a href=#task-queue title=&quot;task queue&quot;&gt;task queues&lt;/a&gt;. The user agent may
-   pick any &lt;a href=#task-queue&gt;task queue&lt;/a&gt;.&lt;/li&gt;
+   &lt;a href=#task-queue title=&quot;task queue&quot;&gt;task queues&lt;/a&gt;, ignoring tasks whose
+   associated &lt;code&gt;Document&lt;/code&gt;s are not &lt;a href=#active-document title=&quot;active
+   document&quot;&gt;active&lt;/a&gt;. The user agent may pick any &lt;a href=#task-queue&gt;task
+   queue&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Remove that task from its &lt;a href=#task-queue&gt;task queue&lt;/a&gt;.&lt;/li&gt;
 
@@ -33479,7 +33766,7 @@
    &lt;li&gt;&lt;p&gt;Return to the first step of the &lt;a href=#event-loop&gt;event
    loop&lt;/a&gt;.&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;h5 id=generic-task-sources&gt;&lt;span class=secno&gt;5.4.2.1 &lt;/span&gt;Generic task sources&lt;/h5&gt;
+  &lt;/ol&gt;&lt;h5 id=generic-task-sources&gt;&lt;span class=secno&gt;5.4.4.1 &lt;/span&gt;Generic task sources&lt;/h5&gt;
 
   &lt;p&gt;The following &lt;a href=#task-source title=&quot;task source&quot;&gt;task sources&lt;/a&gt; are
   used by a number of mostly unrelated features in this and other
@@ -33525,61 +33812,107 @@
 
    &lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;!-- SCRIPT EXEC --&gt;&lt;h4 id=javascript-protocol&gt;&lt;span class=secno&gt;5.4.3 &lt;/span&gt;&lt;dfn title=&quot;javascript protocol&quot;&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol&lt;/dfn&gt;&lt;/h4&gt;
+  &lt;/dl&gt;&lt;!-- SCRIPT EXEC --&gt;&lt;h4 id=javascript-protocol&gt;&lt;span class=secno&gt;5.4.5 &lt;/span&gt;&lt;dfn title=&quot;javascript protocol&quot;&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol&lt;/dfn&gt;&lt;/h4&gt;
 
-  &lt;p&gt;A URL using the &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol must,
-  if and when &lt;dfn id=concept-js-deref title=concept-js-deref&gt;dereferenced&lt;/dfn&gt;, be
-  evaluated by executing the script obtained using the content
-  retrieval operation defined for &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt;
-  URLs. &lt;a href=#refsJSURL&gt;[JSURL]&lt;/a&gt;&lt;/p&gt;
+  &lt;p&gt;When a &lt;a href=#url&gt;URL&lt;/a&gt; using the &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol is &lt;dfn id=concept-js-deref title=concept-js-deref&gt;dereferenced&lt;/dfn&gt;, the user agent must run
+  the following steps:&lt;/p&gt;
 
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let the script source be the string obtained using the
+   content retrieval operation defined for &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; URLs. &lt;a href=#refsJSURL&gt;[JSURL]&lt;/a&gt;&lt;/li&gt;
+
 &lt;!--
 JSURL: <A HREF="http://ietfreport.isoc.org/all-ids/draft-hoehrmann-javascript-scheme-00.txt">http://ietfreport.isoc.org/all-ids/draft-hoehrmann-javascript-scheme-00.txt</A> and
        <A HREF="http://www.websitedev.de/ietf/draft-hoehrmann-javascript-scheme-00.txt">http://www.websitedev.de/ietf/draft-hoehrmann-javascript-scheme-00.txt</A> should be as stable as it gets,
        <A HREF="http://ietfreport.isoc.org/idref/draft-hoehrmann-javascript-scheme/">http://ietfreport.isoc.org/idref/draft-hoehrmann-javascript-scheme/</A> for the latest version
 --&gt;
 
-  &lt;p&gt;When a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; is &lt;a href=#navigate title=navigate&gt;navigated&lt;/a&gt; to a &lt;code&gt;javascript:&lt;/code&gt; URL,
-  and the &lt;a href=#active-document&gt;active document&lt;/a&gt; of that browsing context has
-  the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the script given by that URL, the
-  &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; must be the
-  &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;
-  being navigated, and the &lt;a href=#script-document-context&gt;script document context&lt;/a&gt; must
-  be that &lt;a href=#active-document&gt;active document&lt;/a&gt;.&lt;/p&gt;
+   &lt;li&gt;
 
-  &lt;p&gt;When a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; is &lt;a href=#navigate title=navigate&gt;navigated&lt;/a&gt; to a &lt;code&gt;javascript:&lt;/code&gt; URL,
-  and the &lt;a href=#active-document&gt;active document&lt;/a&gt; of that browsing context has an
-  &lt;a href=#origin-0&gt;origin&lt;/a&gt; that is &lt;em&gt;not&lt;/em&gt; the &lt;a href=#same-origin title=&quot;same
-  origin&quot;&gt;same&lt;/a&gt; as that of the script given by the URL, the
-  &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; must be an empty object, and
-  the &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt; must be the &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt; being &lt;a href=#navigate title=navigate&gt;navigated&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;Use the appropriate step from the following list:&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, if the &lt;code&gt;Document&lt;/code&gt; object of the element,
-  attribute, or style sheet from which the &lt;code&gt;javascript:&lt;/code&gt;
-  URL was reached has an associated &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the
-  &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; must be an empty object, and
-  the &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt;'s associated
-  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; must be that &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt;.&lt;/p&gt;
+    &lt;dl&gt;&lt;dt&gt;If a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; is being &lt;a href=#navigate title=navigate&gt;navigated&lt;/a&gt; to a &lt;code&gt;javascript:&lt;/code&gt;
+     URL, and the &lt;a href=#active-document&gt;active document&lt;/a&gt; of that browsing
+     context has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the script given by
+     that URL&lt;/dt&gt;
 
-  &lt;p&gt;Otherwise, the script is not executed and its return value is
-  void.&lt;/p&gt;
+     &lt;dd&gt;
 
-  &lt;p&gt;If the result of executing the script is void (there is no return
-  value), then the URL must be treated in a manner equivalent to an
-  HTTP resource with an HTTP 204 No Content response.&lt;/p&gt;
+      &lt;p&gt;&lt;a href=#create-a-script-from-a-node title=&quot;create a script from a node&quot;&gt;Create a
+      script&lt;/a&gt; from the &lt;code&gt;Document&lt;/code&gt; node of the
+      &lt;a href=#active-document&gt;active document&lt;/a&gt;, using the aforementioned script
+      source, and assuming the scripting language is JavaScript.&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, the URL must be treated in a manner equivalent to an
-  HTTP resource with a 200 OK response whose &lt;a href=#content-type-0 title=Content-Type&gt;Content-Type metadata&lt;/a&gt; is &lt;code title=&quot;&quot;&gt;text/html&lt;/code&gt; and whose response body is the return
-  value converted to a string value.&lt;/p&gt;
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the return value of the
+      &lt;i&gt;&lt;a href=#initial-code-entry-point&gt;initial code entry-point&lt;/a&gt;&lt;/i&gt; of this &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;. If an exception was
+      raised, let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void instead.&lt;/p&gt;
 
-  &lt;p class=note&gt;Certain contexts, in particular &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt;
-  elements, ignore the &lt;a href=#content-type-0 title=Content-Type&gt;Content-Type
-  metadata&lt;/a&gt;.&lt;/p&gt;
+     &lt;/dd&gt;
 
-  &lt;div class=example&gt;
+     &lt;dt&gt;If a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; is being &lt;a href=#navigate title=navigate&gt;navigated&lt;/a&gt; to a &lt;code&gt;javascript:&lt;/code&gt;
+     URL, and the &lt;a href=#active-document&gt;active document&lt;/a&gt; of that browsing
+     context has an &lt;a href=#origin-0&gt;origin&lt;/a&gt; that is &lt;em&gt;not&lt;/em&gt; the &lt;a href=#same-origin title=&quot;same origin&quot;&gt;same&lt;/a&gt; as that of the script given by
+     the URL&lt;/dt&gt;
 
+     &lt;dd&gt;
+
+      &lt;p&gt;&lt;a href=#create-an-impotent-script&gt;Create an impotent script&lt;/a&gt; using the
+      aforementioned script source, with the scripting language set to
+      JavaScript, and with the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; being
+      &lt;a href=#navigate title=navigate&gt;navigated&lt;/a&gt; as the browsing
+      context.&lt;/p&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the return value of the
+      &lt;i&gt;&lt;a href=#initial-code-entry-point&gt;initial code entry-point&lt;/a&gt;&lt;/i&gt; of this &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;. If an exception was
+      raised, let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void instead.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
+     &lt;dt&gt;If the &lt;code&gt;Document&lt;/code&gt; object of the element,
+     attribute, or style sheet from which the &lt;code&gt;javascript:&lt;/code&gt;
+     URL was reached has an associated &lt;a href=#browsing-context&gt;browsing
+     context&lt;/a&gt;&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;&lt;a href=#create-an-impotent-script&gt;Create an impotent script&lt;/a&gt; using the
+      aforementioned script source, with the scripting language set to
+      JavaScript, and with the &lt;code&gt;Document&lt;/code&gt;'s object's
+      &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; as the browsing context.&lt;/p&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the return value of the
+      &lt;i&gt;&lt;a href=#initial-code-entry-point&gt;initial code entry-point&lt;/a&gt;&lt;/i&gt; of this &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;. If an exception was
+      raised, let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void instead.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
+     &lt;dt&gt;Otherwise&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
+    &lt;/dl&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If the result of executing the script is void (there is no
+    return value), then the URL must be treated in a manner equivalent
+    to an HTTP resource with an HTTP 204 No Content response.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, the URL must be treated in a manner equivalent to an
+    HTTP resource with a 200 OK response whose &lt;a href=#content-type-0 title=Content-Type&gt;Content-Type metadata&lt;/a&gt; is &lt;code title=&quot;&quot;&gt;text/html&lt;/code&gt; and whose response body is the return
+    value converted to a string value.&lt;/p&gt;
+
+    &lt;p class=note&gt;Certain contexts, in particular &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt;
+    elements, ignore the &lt;a href=#content-type-0 title=Content-Type&gt;Content-Type
+    metadata&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;&lt;div class=example&gt;
+
    &lt;p&gt;So for example a &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; URL for a
    &lt;code title=attr-img-src&gt;&lt;a href=#attr-img-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of an
    &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element would be evaluated in the context of an
@@ -33598,13 +33931,13 @@
 
   &lt;/div&gt;
 
-  &lt;p class=note&gt;The rules for handling script execution in a
-  &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; include making the script not
-  execute (and just return void) in certain cases, e.g. in a sandbox
-  or when the user has disabled scripting altogether.&lt;/p&gt;
+  &lt;p class=note&gt;The rules for &lt;a href=#create-a-script title=&quot;create a script&quot;&gt;creating
+  a script&lt;/a&gt; include making the script not execute (and just
+  return void) in certain cases, e.g. in a sandbox or when the user
+  has disabled scripting altogether.&lt;/p&gt;
 
 
-  &lt;h4 id=events&gt;&lt;span class=secno&gt;5.4.4 &lt;/span&gt;Events&lt;/h4&gt;
+  &lt;h4 id=events&gt;&lt;span class=secno&gt;5.4.6 &lt;/span&gt;Events&lt;/h4&gt;
 
   &lt;p class=XXX&gt;We need to define how to handle events that are
   to be fired on a Document that is no longer the active document of
@@ -33616,71 +33949,83 @@
   when the document isn't active.&lt;/p&gt;
 
 
-  &lt;h5 id=event-handler-attributes&gt;&lt;span class=secno&gt;5.4.4.1 &lt;/span&gt;Event handler attributes&lt;/h5&gt;
+  &lt;h5 id=event-handler-attributes&gt;&lt;span class=secno&gt;5.4.6.1 &lt;/span&gt;Event handler attributes&lt;/h5&gt;
 
   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cscript%3E%0Aw(a%3Ddocument.implementation.createDocument(null%2C%20null%2C%20null">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cscript%3E%0Aw(a%3Ddocument.implementation.createDocument(null%2C%20null%2C%20null</A>))%3B%0Aw(a.appendChild(a.createElementNS('http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml'%2C%20'html')))%3B%0Aw(b%3Da.firstChild.appendChild(a.createElementNS('http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml'%2C%20'body')))%3B%0Aw(b.test%20%3D%20w)%3B%0Aw(b.setAttribute('onclick'%2C%20'test(%22fire%3A%20%22%20%2B%20event)'))%3B%0Aw(b.onclick)%3B%0Aw(e%3Da.createEvent('Event'))%3B%0Aw(e.initEvent('click'%2C%20false%2C%20false))%3B%0Aw(b.dispatchEvent(e))%3B%0A%3C%2Fscript%3E --&gt;
 
-  &lt;p&gt;&lt;a href=#html-elements&gt;HTML elements&lt;/a&gt; can have &lt;dfn id=event-handler-attributes-0&gt;event handler
-  attributes&lt;/dfn&gt; specified. These act as bubbling event listeners
-  for the element on which they are specified.&lt;/p&gt;
+  &lt;p&gt;Many objects can have &lt;dfn id=event-handler-attributes-0&gt;event handler attributes&lt;/dfn&gt;
+  specified. These act as bubbling event listeners for the element on
+  which they are specified.&lt;/p&gt;
 
-  &lt;p&gt;Each event handler attribute has two parts, an &lt;a href=#event-handler-content-attributes title=&quot;event
-  handler content attributes&quot;&gt;event handler content attribute&lt;/a&gt;
-  and an &lt;a href=#event-handler-dom-attributes title=&quot;event handler DOM attributes&quot;&gt;event handler DOM
-  attribute&lt;/a&gt;. Event handler attributes must initially be set to
-  null. When their value changes (through the changing of their event
-  handler content attribute or their event handler DOM attribute),
-  they will either be null, or have an &lt;code&gt;EventListener&lt;/code&gt;
-  object assigned to them.&lt;/p&gt;
+  &lt;p&gt;On &lt;a href=#html-elements&gt;HTML elements&lt;/a&gt;, each event handler attribute has
+  two parts, an &lt;a href=#event-handler-content-attributes title=&quot;event handler content attributes&quot;&gt;event
+  handler content attribute&lt;/a&gt; and an &lt;a href=#event-handler-dom-attributes title=&quot;event handler
+  DOM attributes&quot;&gt;event handler DOM attribute&lt;/a&gt;. Event handler
+  attributes must initially be set to null. When their value changes
+  (through the changing of their event handler content attribute or
+  their event handler DOM attribute), they will either be null, or
+  have an &lt;code&gt;EventListener&lt;/code&gt; object assigned to them.&lt;/p&gt;
 
   &lt;p&gt;Objects other than &lt;code&gt;Element&lt;/code&gt; objects, in particular
   &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt;, only have &lt;a href=#event-handler-dom-attributes title=&quot;event handler DOM
   attributes&quot;&gt;event handler DOM attribute&lt;/a&gt; (since they have no
   content attributes).&lt;/p&gt;
 
-  &lt;p&gt;&lt;dfn id=event-handler-content-attributes&gt;Event handler content attributes&lt;/dfn&gt;, when specified, must
+  &lt;hr&gt;&lt;p&gt;&lt;dfn id=event-handler-content-attributes&gt;Event handler content attributes&lt;/dfn&gt;, when specified, must
   contain valid ECMAScript code matching the ECMAScript &lt;code title=&quot;&quot;&gt;FunctionBody&lt;/code&gt; production. &lt;a href=#refsECMA262&gt;[ECMA262]&lt;/a&gt;&lt;/p&gt;
 
   &lt;!-- SCRIPT EXEC --&gt;
   &lt;p&gt;When an event handler content attribute is set, if the element is
   owned by a &lt;code&gt;Document&lt;/code&gt; that is in a &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt;, its new value must be interpreted as the body of an
-  anonymous function with a single argument called &lt;code&gt;event&lt;/code&gt;,
-  with the new function's scope chain being linked from the activation
-  object of the handler, to the element, to the element's
-  &lt;code&gt;&lt;a href=#the-form-element&gt;form&lt;/a&gt;&lt;/code&gt; element if it is a form control, to the
-  &lt;code&gt;Document&lt;/code&gt; object, to the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of
-  the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; of that &lt;code&gt;Document&lt;/code&gt;. The
-  function's &lt;code&gt;this&lt;/code&gt; parameter must be the
-  &lt;code&gt;Element&lt;/code&gt; object representing the element. The resulting
-  function must then be set as the value of the corresponding event
-  handler attribute, and the new value must be set as the value of the
-  content attribute. If the given function body fails to compile, then
-  the corresponding event handler attribute must be set to null
-  instead (the content attribute must still be updated to the new
-  value, though).&lt;/p&gt;
+  context&lt;/a&gt;, the user agent must run the following steps to
+  create a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; after setting
+  the content attribute to its new value:&lt;/p&gt;
 
-  &lt;p class=note&gt;See ECMA262 Edition 3, sections 10.1.6 and 10.2.3,
-  for more details on activation objects. &lt;a href=#refsECMA262&gt;[ECMA262]&lt;/a&gt;&lt;/p&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Set up a &lt;a href=#script-execution-environment&gt;script execution environment&lt;/a&gt; for
+   JavaScript.&lt;/li&gt;
 
-  &lt;p&gt;The &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt; of the event handler
-  must be the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object at the end of the scope
-  chain. The &lt;a href=#script-document-context&gt;script document context&lt;/a&gt; of the event handler
-  must be the &lt;code&gt;Document&lt;/code&gt; object that owns the event handler
-  content attribute that was set.&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;Using this script execution environment, interpret the
+   attribute's new value as the body of an anonymous function with a
+   single argument called &lt;code&gt;event&lt;/code&gt;. Link the new function's
+   scope chain from the activation object of the handler, to the
+   element's object, to the element's &lt;a href=#form-owner&gt;form owner&lt;/a&gt;, if it
+   has one, to the element's &lt;code&gt;Document&lt;/code&gt; object, to the
+   &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; of
+   that &lt;code&gt;Document&lt;/code&gt;. Set the function's &lt;code&gt;this&lt;/code&gt;
+   parameter to the &lt;code&gt;Element&lt;/code&gt; object representing the
+   element. Let this function be the only entry in the script's
+   &lt;a href=#list-of-code-entry-points&gt;list of code entry-points&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;When an event handler content attribute is set on an element
-  owned by a &lt;code&gt;Document&lt;/code&gt; that is not in a &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt;, the corresponding event handler attribute is not
-  changed.&lt;/p&gt;
+   &lt;p class=note&gt;See ECMA262 Edition 3, sections 10.1.6 and 10.2.3,
+   for more details on activation objects. &lt;a href=#refsECMA262&gt;[ECMA262]&lt;/a&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If the previous steps failed to compile the script, then set
+   the corresponding event handler attribute to null and abort these
+   steps.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set up the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, the
+   &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;, the &lt;a href=&quot;#script's-character-encoding&quot;&gt;script's
+   character encoding&lt;/a&gt;, and the &lt;a href=&quot;#script's-base-url&quot;&gt;script's base URL&lt;/a&gt;
+   from &lt;a href=#the-script-settings-determined-from-the-node&gt;the script settings determined from the node&lt;/a&gt; on
+   which the attribute is being set, and add the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; to the
+   &lt;a href=#script-group&gt;script group&lt;/a&gt; determined from that node as
+   well.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set the corresponding event handler attribute to the
+   aforementioned function.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p class=note&gt;When an event handler content attribute is set on an
+  element owned by a &lt;code&gt;Document&lt;/code&gt; that is not in a
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the corresponding event handler
+  attribute is not changed.&lt;/p&gt;
+
   &lt;p class=note&gt;Removing an event handler content attribute does not
-  reset the corresponding event handler attribute either.&lt;/p&gt;
+  reset the corresponding event handler attribute.&lt;/p&gt;
   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cbody%20onload%3D%22w(%27pass%27">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cbody%20onload%3D%22w(%27pass%27</A>)%22%3E%0A%3Cscript%3Edocument.body.removeAttribute(%27onload%27)%3B%3C%2Fscript%3E --&gt;
 
   &lt;p class=XXX&gt;How do we allow non-JS event handlers?&lt;/p&gt;
 
-  &lt;p&gt;&lt;dfn id=event-handler-dom-attributes&gt;Event handler DOM attributes&lt;/dfn&gt;, on setting, must set the
+  &lt;hr&gt;&lt;p&gt;&lt;dfn id=event-handler-dom-attributes&gt;Event handler DOM attributes&lt;/dfn&gt;, on setting, must set the
   corresponding event handler attribute to their new value, and on
   getting, must return whatever the current value of the corresponding
   event handler attribute is (possibly null).&lt;/p&gt;
@@ -33894,19 +34239,31 @@
    &lt;dt&gt;&lt;dfn id=handler-onunload title=handler-onunload&gt;&lt;code&gt;onunload&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt; &lt;!-- widely used --&gt;
 
    &lt;dd&gt;&lt;p&gt;Must be invoked whenever an &lt;code title=event-unload&gt;unload&lt;/code&gt; event is targeted at or bubbles
-   through the element.&lt;/dd&gt; &lt;!-- XXX need to fire this --&gt;
+   through the element.&lt;/dd&gt;
 
   &lt;/dl&gt;&lt;p&gt;When an event handler attribute is invoked, its argument must be
-  set to the &lt;code&gt;Event&lt;/code&gt; object of the event in question. If
-  the function returns the exact boolean value false, the event's
-  &lt;code&gt;preventDefault()&lt;/code&gt; method must then invoked. Exception:
-  for historical reasons, for the HTML &lt;code&gt;mouseover&lt;/code&gt; event,
-  the &lt;code&gt;preventDefault()&lt;/code&gt; method must be called when the
-  function returns true instead.&lt;/p&gt;
+  set to the &lt;code&gt;Event&lt;/code&gt; object of the event in question.&lt;/p&gt;
 
-  &lt;!-- IE actually uncancels the event if the function returns true --&gt;
+  &lt;p&gt;The handler's return value must be processed as follows:&lt;/p&gt;
 
-  &lt;p&gt;All event handler attributes on an element, whether set to null
+  &lt;dl class=switch&gt;&lt;dt&gt;If the event type is &lt;code class=event-mouseover&gt;mouseover&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;&lt;p&gt;If the return value is a boolean with the value true, then
+   the event must be canceled.&lt;/dd&gt;
+
+   &lt;dt&gt;If the event object is a &lt;code&gt;&lt;a href=#beforeunloadevent&gt;BeforeUnloadEvent&lt;/a&gt;&lt;/code&gt; object&lt;/dt&gt;
+
+   &lt;dd&gt;&lt;p&gt;If the return value is a string, and the event object's
+   &lt;code title=dom-BeforeUnloadEvent-returnValue&gt;&lt;a href=#dom-beforeunloadevent-returnvalue&gt;returnValue&lt;/a&gt;&lt;/code&gt;
+   attribute's value is the empty string, then set the &lt;code title=dom-BeforeUnloadEvent-returnValue&gt;&lt;a href=#dom-beforeunloadevent-returnvalue&gt;returnValue&lt;/a&gt;&lt;/code&gt;
+   attribute's value to the return value.&lt;/dd&gt;
+
+   &lt;dt&gt;Otherwise&lt;/dt&gt;
+
+   &lt;dd&gt;&lt;p&gt;If the return value is a boolean with the value false, then
+   the event must be canceled.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;!-- IE actually uncancels the event if the function returns true --&gt;&lt;p&gt;All event handler attributes on an element, whether set to null
   or to a function, must be registered as event listeners on the
   element, as if the &lt;code title=dom-EventTarget-addEventListenerNS&gt;addEventListenerNS()&lt;/code&gt;
   method on the &lt;code&gt;Element&lt;/code&gt; object's &lt;code&gt;EventTarget&lt;/code&gt;
@@ -33925,7 +34282,7 @@
   itself.)&lt;/p&gt;
 
 
-  &lt;h5 id=event-firing&gt;&lt;span class=secno&gt;5.4.4.2 &lt;/span&gt;Event firing&lt;/h5&gt;
+  &lt;h5 id=event-firing&gt;&lt;span class=secno&gt;5.4.6.2 &lt;/span&gt;Event firing&lt;/h5&gt;
 
   &lt;p class=XXX&gt;maybe this should be moved higher up
   (terminology? conformance? DOM?) Also, the whole terminology thing
@@ -33995,7 +34352,7 @@
   dispatched in expected ways.&lt;/p&gt;
 
 
-  &lt;h5 id=events-and-the-window-object&gt;&lt;span class=secno&gt;5.4.4.3 &lt;/span&gt;Events and the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object&lt;/h5&gt;
+  &lt;h5 id=events-and-the-window-object&gt;&lt;span class=secno&gt;5.4.6.3 &lt;/span&gt;Events and the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object&lt;/h5&gt;
 
   &lt;p&gt;When an event is dispatched at a DOM node in a
   &lt;code&gt;Document&lt;/code&gt; in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, if the
@@ -34011,7 +34368,7 @@
    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object at the end of the phase, unless bubbling
    has been prevented.&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;h5 id=runtime-script-errors&gt;&lt;span class=secno&gt;5.4.4.4 &lt;/span&gt;Runtime script errors&lt;/h5&gt;
+  &lt;/ol&gt;&lt;h5 id=runtime-script-errors&gt;&lt;span class=secno&gt;5.4.6.4 &lt;/span&gt;Runtime script errors&lt;/h5&gt;
 
   &lt;p&gt;&lt;em&gt;This section only applies to user agents that support
   scripting in general and ECMAScript in particular.&lt;/em&gt;&lt;/p&gt;
@@ -34201,7 +34558,7 @@
 
      &lt;li&gt;have an &lt;a href=#active-document&gt;active document&lt;/a&gt; whose
      &lt;a href=#origin-0&gt;origin&lt;/a&gt; is the &lt;a href=#same-origin title=&quot;same origin&quot;&gt;same&lt;/a&gt;
-     as the &lt;a href=#origin-0&gt;origin&lt;/a&gt; of the script that called the &lt;code title=dom-showModalDialog&gt;&lt;a href=#dom-showmodaldialog&gt;showModalDialog()&lt;/a&gt;&lt;/code&gt; method at
+     as the &lt;a href=#origin-0&gt;origin&lt;/a&gt; of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that called the &lt;code title=dom-showModalDialog&gt;&lt;a href=#dom-showmodaldialog&gt;showModalDialog()&lt;/a&gt;&lt;/code&gt; method at
      the time the method was called,&lt;/li&gt; &lt;!-- Note that changing
      document.domain to talk to another domain doesn't make you able
      to block that domain --&gt;
@@ -34246,16 +34603,16 @@
    &lt;li&gt;
 
     &lt;p&gt;Let the &lt;a href=&quot;#dialog-arguments'-origin&quot;&gt;dialog arguments' origin&lt;/a&gt; be the
-    &lt;a href=#origin-0&gt;origin&lt;/a&gt; of the script that called the &lt;code title=dom-showModalDialog&gt;&lt;a href=#dom-showmodaldialog&gt;showModalDialog()&lt;/a&gt;&lt;/code&gt; method.&lt;/p&gt;
+    &lt;a href=#origin-0&gt;origin&lt;/a&gt; of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that called the &lt;code title=dom-showModalDialog&gt;&lt;a href=#dom-showmodaldialog&gt;showModalDialog()&lt;/a&gt;&lt;/code&gt; method.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
     &lt;p&gt;&lt;a href=#navigate&gt;Navigate&lt;/a&gt; the new browsing context to &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, with &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt;, and
-    with the &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt; of the script that
-    invoked the method as the &lt;a href=#source-browsing-context&gt;source browsing
-    context&lt;/a&gt;.&lt;/p&gt;
+    with the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing
+    context&lt;/a&gt; of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that invoked the method as the
+    &lt;a href=#source-browsing-context&gt;source browsing context&lt;/a&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -34355,18 +34712,18 @@
   &lt;p&gt;The &lt;dfn id=dom-shownotification title=dom-showNotification&gt;&lt;code&gt;showNotification(&lt;var title=&quot;&quot;&gt;title&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;subtitle&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;description&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked, must
   cause the user agent to show a notification.&lt;/p&gt;
 
-  &lt;p id=sandboxNotifications&gt;If the method was invoked from a script
-  whose &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt; has the &lt;a href=#sandboxed-annoyances-browsing-context-flag&gt;sandboxed
-  annoyances browsing context flag&lt;/a&gt; set, then the notification
-  must be shown within that &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;. The
-  notification is said to be a &lt;dfn id=sandboxed-notification&gt;sandboxed notification&lt;/dfn&gt;.&lt;/p&gt;
+  &lt;p id=sandboxNotifications&gt;If the method was invoked from a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;
+  whose &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing
+  context&lt;/a&gt; has the &lt;a href=#sandboxed-annoyances-browsing-context-flag&gt;sandboxed annoyances browsing context
+  flag&lt;/a&gt; set, then the notification must be shown within that
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;. The notification is said to be a
+  &lt;dfn id=sandboxed-notification&gt;sandboxed notification&lt;/dfn&gt;.&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, if the &lt;a href=#origin-0&gt;origin&lt;/a&gt; of the &lt;a href=#script-browsing-context&gt;script
-  browsing context&lt;/a&gt; of the script that invoked the method is
-  &lt;em&gt;not&lt;/em&gt; flagged as being a &lt;a href=#trusted-notification-source&gt;trusted notification
-  source&lt;/a&gt;, then the notification should be rendered within the
-  &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; of the &lt;a href=#script-browsing-context&gt;script browsing
-  context&lt;/a&gt; of the script that invoked the method. The
+  &lt;p&gt;Otherwise, if the &lt;a href=#origin-0&gt;origin&lt;/a&gt; of the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing context&lt;/a&gt; of the
+  &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that invoked the method is &lt;em&gt;not&lt;/em&gt; flagged as being a
+  &lt;a href=#trusted-notification-source&gt;trusted notification source&lt;/a&gt;, then the notification
+  should be rendered within the &lt;a href=#top-level-browsing-context&gt;top-level browsing
+  context&lt;/a&gt; of the &lt;a href=&quot;#script's-browsing-context&quot;&gt;script's browsing context&lt;/a&gt;. The
   notification is said to be a &lt;dfn id=normal-notification&gt;normal notification&lt;/dfn&gt;. User
   agents should provide a way to set the origin's &lt;a href=#trusted-notification-source&gt;trusted
   notification source&lt;/a&gt; flag from the notification, so that the
@@ -34415,16 +34772,15 @@
   &lt;p&gt;When a &lt;a href=#normal-notification&gt;normal notification&lt;/a&gt; (but not a
   &lt;a href=#sandboxed-notification&gt;sandboxed notification&lt;/a&gt;) is shown, the user agent may
   bring the user's attention to the &lt;a href=#top-level-browsing-context&gt;top-level browsing
-  context&lt;/a&gt; of the &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt; of the
-  script that invoked the method, if that would be useful; but user
-  agents should not use system-wide notification mechanisms to do
-  so.&lt;/p&gt;
+  context&lt;/a&gt; of the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing
+  context&quot;&gt;browsing context&lt;/a&gt; of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that invoked the
+  method, if that would be useful; but user agents should not use
+  system-wide notification mechanisms to do so.&lt;/p&gt;
 
   &lt;p&gt;When a &lt;a href=#trusted-notification&gt;trusted notification&lt;/a&gt; is shown, the user agent
-  should bring the user's attention to the notification and the
-  &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt; of the script that invoked the
-  method, as per the platform conventions for attracting the user's
-  attention to applications.&lt;/p&gt;
+  should bring the user's attention to the notification and the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing context&lt;/a&gt; of the
+  &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that invoked the method, as per the platform conventions for
+  attracting the user's attention to applications.&lt;/p&gt;
 
   &lt;div class=example&gt;
 
@@ -34448,8 +34804,9 @@
 
    &lt;li&gt;The &lt;a href=#meta-application-name title=meta-application-name&gt;application
    name&lt;/a&gt;, if available, or else the &lt;a href=#document.title title=dom-document-title&gt;document title&lt;/a&gt;, of the
-   &lt;a href=#active-document&gt;active document&lt;/a&gt; of the &lt;a href=#script-browsing-context&gt;script browsing
-   context&lt;/a&gt; of the script that invoked the method.&lt;/li&gt;
+   &lt;a href=#active-document&gt;active document&lt;/a&gt; of the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing
+   context&quot;&gt;browsing context&lt;/a&gt; of the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; that invoked the
+   method.&lt;/li&gt;
 
    &lt;li&gt;An icon chosen from the &lt;a href=#external-resource-link title=&quot;external resource
    link&quot;&gt;external resource links&lt;/a&gt; of type &lt;code title=rel-icon&gt;&lt;a href=#rel-icon&gt;icon&lt;/a&gt;&lt;/code&gt;, if any are available.&lt;/li&gt;
@@ -34485,10 +34842,11 @@
   &lt;p&gt;User agents should support user interaction with notifications,
   if and as appropriate given the platform conventions. If a user
   activates a notification, and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt;
-  callback argument was present and is not null, then the &lt;a href=#script-browsing-context&gt;script
-  browsing context&lt;/a&gt; of the function given by &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; should be brought to the user's attention,
-  and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; callback should then be
-  invoked.&lt;/p&gt;
+  callback argument was present and is not null, then the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing context&lt;/a&gt; of the
+  &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; of the function given by
+  &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; should be brought to the user's
+  attention, and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; callback should then
+  be invoked.&lt;/p&gt;
 
 
 
@@ -34665,9 +35023,8 @@
     first occurrence of the exact literal string &quot;&lt;code&gt;%s&lt;/code&gt;&quot;
     with an escaped version of the URL of the content in question (as
     defined below), then &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt;
-    the resulting URL (using the &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the
-    &lt;a href=#script-document-context&gt;script document context&lt;/a&gt; of the script that originally
-    invoked the &lt;code title=dom-navigator-registerContentHandler&gt;&lt;a href=#dom-navigator-registercontenthandler&gt;registerContentHandler()&lt;/a&gt;&lt;/code&gt;
+    the resulting URL (using the &lt;a href=&quot;#script's-base-url&quot; title=&quot;script's base URL&quot;&gt;base
+    URL&lt;/a&gt; of the script that originally invoked the &lt;code title=dom-navigator-registerContentHandler&gt;&lt;a href=#dom-navigator-registercontenthandler&gt;registerContentHandler()&lt;/a&gt;&lt;/code&gt;
     or &lt;code title=dom-navigator-registerProtocolHandler&gt;&lt;a href=#dom-navigator-registerprotocolhandler&gt;registerProtocolHandler()&lt;/a&gt;&lt;/code&gt;
     method), and then &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting URL using the
     GET method (&lt;a href=#concept-http-equivalent-get title=concept-http-equivalent-get&gt;or
@@ -34904,7 +35261,7 @@
 
   &lt;h3 id=offline&gt;&lt;span class=secno&gt;5.7 &lt;/span&gt;Offline Web applications&lt;/h3&gt;
 
-  &lt;h4 id=introduction-0&gt;&lt;span class=secno&gt;5.7.1 &lt;/span&gt;Introduction&lt;/h4&gt;
+  &lt;h4 id=introduction-1&gt;&lt;span class=secno&gt;5.7.1 &lt;/span&gt;Introduction&lt;/h4&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -35902,7 +36259,7 @@
 
 
 
-  &lt;h4 id=processing-model-1&gt;&lt;span class=secno&gt;5.7.5 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h4 id=processing-model-2&gt;&lt;span class=secno&gt;5.7.5 &lt;/span&gt;Processing model&lt;/h4&gt;
 
   &lt;p&gt;The processing model of application caches for offline support in
   Web applications is part of the &lt;a href=#navigate title=navigate&gt;navigation&lt;/a&gt; model, but references the
@@ -36738,8 +37095,9 @@
   enabled&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;Navigation for the &lt;code title=dom-location-assign&gt;&lt;a href=#dom-location-assign&gt;assign()&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-location-replace&gt;&lt;a href=#dom-location-replace&gt;replace()&lt;/a&gt;&lt;/code&gt; methods must be done
-  with the &lt;a href=#script-browsing-context&gt;script browsing context&lt;/a&gt; of the script that
-  invoked the method as the &lt;a href=#source-browsing-context&gt;source browsing context&lt;/a&gt;.&lt;/p&gt;
+  with the &lt;a href=&quot;#script's-browsing-context&quot; title=&quot;script's browsing context&quot;&gt;browsing
+  context&lt;/a&gt; of the script that invoked the method as the
+  &lt;a href=#source-browsing-context&gt;source browsing context&lt;/a&gt;.&lt;/p&gt;
 
 &lt;!--XXX
   &lt;dfn title=&quot;dom-location-reload&quot;&gt;&lt;code&gt;reload()&lt;/code&gt;&lt;/dfn&gt;
@@ -36953,7 +37311,7 @@
     synchronous, but if fetching the resource depends on external
     resources, as it usually does for URLs that use HTTP or other
     networking protocols, then at this point the user agents must
-    yield to whatever script invoked the navigation steps, if they
+    yield to whatever &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; invoked the navigation steps, if they
     were invoked by script.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -37115,19 +37473,11 @@
   &lt;ol&gt;&lt;li&gt;&lt;p class=XXX&gt;pause for scripts -- but don't use the
    &quot;pause&quot; definition since that involves not running script!&lt;/li&gt;
 
-   &lt;li&gt;&lt;p class=XXX&gt;onbeforeunload, and if present set flag that we will kill document&lt;/li&gt;
-   &lt;!--
-   when we define onbeforeunload, then we have to say that the JS
-   implementation of EventListener::handleEvent checks for that event,
-   treating the return value as the string to use for the unload warning
-   message if there is a return value, and calling preventDefault if
-   there isn't.
-   --&gt;
+   &lt;li&gt;&lt;p&gt;&lt;a href=#unload-a-document title=&quot;unload a document&quot;&gt;Unload&lt;/a&gt; the
+   &lt;code&gt;Document&lt;/code&gt; object of the &lt;a href=#current-entry&gt;current entry&lt;/a&gt;,
+   with the &lt;var title=&quot;&quot;&gt;recycle&lt;/var&gt; parameter set to
+   false.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p class=XXX&gt;onunload, and if present set flag that we will kill document&lt;/li&gt;
-
-   &lt;li&gt;&lt;p class=XXX&gt;if flag is set: &lt;a href=#discard-a-document title=&quot;discard a document&quot;&gt;discard the &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;dl&gt;&lt;dt&gt;If the navigation was initiated for &lt;dfn id=entry-update&gt;entry update&lt;/dfn&gt; of
@@ -37483,8 +37833,8 @@
    &lt;code&gt;Document&lt;/code&gt; object than the &lt;a href=#current-entry&gt;current entry&lt;/a&gt;
    then the user agent must run the following substeps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li class=XXX&gt;freeze any timers, intervals,
-     XMLHttpRequests, database transactions, etc&lt;/li&gt;
+    &lt;ol&gt;&lt;li&gt;Freeze the &lt;a href=#active-document&gt;active document&lt;/a&gt;'s &lt;a href=#current-script-group&gt;current
+     script group&lt;/a&gt;.&lt;/li&gt;
 
      &lt;li&gt;The user agent must move any properties that have been added
      to the browsing context's default view's &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt;
@@ -37538,8 +37888,8 @@
      &lt;a href=#list-of-added-properties&gt;list of added properties&lt;/a&gt; to browsing context's
      default view's &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object.&lt;/li&gt;
 
-     &lt;li class=XXX&gt;unfreeze any timers, intervals,
-     XMLHttpRequests, database transactions, etc&lt;/li&gt;
+     &lt;li&gt;Unfreeze the &lt;a href=#active-document&gt;active document&lt;/a&gt;'s &lt;a href=#current-script-group&gt;current
+     script group&lt;/a&gt;.&lt;/li&gt;
 
     &lt;/ol&gt;&lt;/li&gt;
 
@@ -37577,32 +37927,84 @@
   affect .watch() when seen from other Windows?&lt;/p&gt;
 
 
-  &lt;h4 id=closing-a-browsing-context&gt;&lt;span class=secno&gt;5.9.10 &lt;/span&gt;Closing a browsing context&lt;/h4&gt;
 
-  &lt;p class=XXX&gt;Closing a browsing context and discarding it
-  (vs closing it and keeping it around in memory).&lt;/p&gt;
+  &lt;h4 id=unloading-documents&gt;&lt;span class=secno&gt;5.9.10 &lt;/span&gt;Unloading documents&lt;/h4&gt;
 
-  &lt;p class=XXX&gt;when a browsing context is closed, all session
-  history entries' &lt;code&gt;Document&lt;/code&gt; objects must be
-  discarded.&lt;/p&gt;
+  &lt;p&gt;When a user agent is to &lt;dfn id=unload-a-document&gt;unload a document&lt;/dfn&gt;, it must run
+  the following steps. These steps are passed an argument, &lt;var title=&quot;&quot;&gt;recycle&lt;/var&gt;, which is either true or false, indicating
+  whether the &lt;code&gt;Document&lt;/code&gt; object is going to be
+  re-used. (This is set by the &lt;code title=dom-document-open&gt;&lt;a href=#dom-document-open&gt;document.open()&lt;/a&gt;&lt;/code&gt; method.)&lt;/p&gt;
 
-  &lt;p class=XXX&gt;When a user agent is to &lt;dfn id=discard-a-document&gt;discard a
-  &lt;code&gt;Document&lt;/code&gt;&lt;/dfn&gt;, any frozen timers, intervals,
-  XMLHttpRequests, database transactions, etc, must be killed, and any
-  MessagePorts owned by the Window object must be
-  unentangled.&lt;/p&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Set &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; to true.&lt;/li&gt;
 
-  &lt;p class=XXX&gt;Also, &lt;code title=event-unload&gt;unload&lt;/code&gt;
-  events should fire.&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;event&lt;/var&gt; be a new
+   &lt;code&gt;&lt;a href=#beforeunloadevent&gt;BeforeUnloadEvent&lt;/a&gt;&lt;/code&gt; event object with the name &lt;code title=event-beforeunload&gt;beforeunload&lt;/code&gt;, with no namespace,
+   which does not bubble but is cancelable.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Dispatch &lt;var title=&quot;&quot;&gt;event&lt;/var&gt; at &lt;a href=#the-body-element-1&gt;the
+   &lt;code&gt;body&lt;/code&gt; element&lt;/a&gt;.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If any event listeners were triggered by the previous step,
+   then set &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; to false.&lt;/li&gt;
 
+   &lt;li&gt;
 
+    &lt;p&gt;If the &lt;code title=dom-BeforeUnloadEvent-returnValue&gt;&lt;a href=#dom-beforeunloadevent-returnvalue&gt;returnValue&lt;/a&gt;&lt;/code&gt;
+    attribute of the &lt;var title=&quot;&quot;&gt;event&lt;/var&gt; object is not the empty
+    string, or if the event was canceled, then the user agent should
+    ask the user to confirm that they wish to unload the document.&lt;/p&gt;
+
+    &lt;p&gt;The prompt shown by the user agent may include the string of
+    the &lt;code title=dom-BeforeUnloadEvent-returnValue&gt;&lt;a href=#dom-beforeunloadevent-returnvalue&gt;returnValue&lt;/a&gt;&lt;/code&gt;
+    attribute, or some leading subset thereof. (A user agent may want
+    to truncate the string to 1024 characters for display, for
+    instance.)&lt;/p&gt;
+
+    &lt;p&gt;The user agent must &lt;a href=#pause&gt;pause&lt;/a&gt; while waiting for the
+    user's response.&lt;/p&gt;
+
+    &lt;p&gt;If the user &lt;dfn id=refused-to-allow-the-document-to-be-unloaded&gt;refused to allow the document to be
+    unloaded&lt;/dfn&gt; then these steps must be aborted.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;a href=#fire-a-simple-event&gt;Fire a simple event&lt;/a&gt; called &lt;code title=event-unload&gt;unload&lt;/code&gt; at &lt;a href=#the-body-element-1&gt;the &lt;code&gt;body&lt;/code&gt;
+   element&lt;/a&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If any event listeners were triggered by the previous step,
+   then set &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; to false.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If there are any outstanding transactions that have
+   callbacks that involve &lt;a href=#concept-script title=concept-script&gt;scripts&lt;/a&gt;
+   that are in the document's &lt;a href=#current-script-group&gt;current script group&lt;/a&gt;, roll
+   them back (without invoking any of the callbacks) and set &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; to false.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;recycle&lt;/var&gt; are both false, &lt;a href=#discard-a-document title=&quot;discard a
+   document&quot;&gt;discard the &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt;.&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;h5 id=event-definition&gt;&lt;span class=secno&gt;5.9.10.1 &lt;/span&gt;Event definition&lt;/h5&gt;
+
+  &lt;pre class=idl&gt;interface &lt;dfn id=beforeunloadevent&gt;BeforeUnloadEvent&lt;/dfn&gt; : Event {
+           attribute DOMString &lt;a href=#dom-beforeunloadevent-returnvalue title=dom-BeforeUnloadEvent-returnValue&gt;returnValue&lt;/a&gt;;
+};&lt;/pre&gt;
+
+  &lt;p class=note&gt;There are no &lt;code&gt;&lt;a href=#beforeunloadevent&gt;BeforeUnloadEvent&lt;/a&gt;&lt;/code&gt;-specific
+  initialization methods.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-beforeunloadevent-returnvalue title=dom-BeforeUnloadEvent-returnValue&gt;&lt;code&gt;returnValue&lt;/code&gt;&lt;/dfn&gt;
+  attribute represents the message to show the user. When the event is
+  created, the attribute must be set to the empty string. On getting,
+  it must return the last value it was set to. On setting, the
+  attribute must be set to the new value.&lt;/p&gt;
+
+
+
+
   &lt;h3 id=structured-client-side-storage&gt;&lt;span class=secno&gt;5.10 &lt;/span&gt;Structured client-side storage&lt;/h3&gt;
 
   &lt;h4 id=storage&gt;&lt;span class=secno&gt;5.10.1 &lt;/span&gt;Storing name/value pairs&lt;/h4&gt;
 
-  &lt;h5 id=introduction-1&gt;&lt;span class=secno&gt;5.10.1.1 &lt;/span&gt;Introduction&lt;/h5&gt;
+  &lt;h5 id=introduction-2&gt;&lt;span class=secno&gt;5.10.1.1 &lt;/span&gt;Introduction&lt;/h5&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -37840,14 +38242,14 @@
   separate, not affecting each other in any way.&lt;/p&gt;
 
   &lt;p&gt;When a new &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; is created by
-  a script in an existing &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, or by the
-  user following a link in an existing browsing context, or in some
-  other way related to a specific &lt;code&gt;&lt;a href=#htmldocument&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;, then the
-  session storage area of the &lt;a href=#origin-0&gt;origin&lt;/a&gt; of that
-  &lt;code&gt;&lt;a href=#htmldocument&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; must be copied into the new browsing
-  context when it is created.  From that point on, however, the two
-  session storage areas must be considered separate, not affecting
-  each other in any way.&lt;/p&gt;
+  a &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt; in an existing
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, or by the user following a link in an
+  existing browsing context, or in some other way related to a
+  specific &lt;code&gt;&lt;a href=#htmldocument&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;, then the session storage area of
+  the &lt;a href=#origin-0&gt;origin&lt;/a&gt; of that &lt;code&gt;&lt;a href=#htmldocument&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; must be
+  copied into the new browsing context when it is created.  From that
+  point on, however, the two session storage areas must be considered
+  separate, not affecting each other in any way.&lt;/p&gt;
 
   &lt;p id=sessionStorageEvent&gt;When the &lt;code title=dom-Storage-setItem&gt;&lt;a href=#dom-storage-setitem&gt;setItem()&lt;/a&gt;&lt;/code&gt;, &lt;code title=dom-Storage-removeItem&gt;&lt;a href=#dom-storage-removeitem&gt;removeItem()&lt;/a&gt;&lt;/code&gt;, and &lt;code title=dom-Storage-clear&gt;&lt;a href=#dom-storage-clear&gt;clear()&lt;/a&gt;&lt;/code&gt; methods are called on a
   &lt;code&gt;&lt;a href=#storage-0&gt;Storage&lt;/a&gt;&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;x&lt;/var&gt; that is associated
@@ -37930,7 +38332,7 @@
   otherwise.&lt;/p&gt;
 
 
-  &lt;h6 id=event-definition&gt;&lt;span class=secno&gt;5.10.1.5.1 &lt;/span&gt;Event definition&lt;/h6&gt;
+  &lt;h6 id=event-definition-0&gt;&lt;span class=secno&gt;5.10.1.5.1 &lt;/span&gt;Event definition&lt;/h6&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=storageevent&gt;StorageEvent&lt;/dfn&gt; : Event {
   readonly attribute DOMString &lt;a href=#dom-storageevent-key title=dom-StorageEvent-key&gt;key&lt;/a&gt;;
@@ -38000,7 +38402,7 @@
         * handling the database getting corrupted
   --&gt;
 
-  &lt;h5 id=introduction-2&gt;&lt;span class=secno&gt;5.10.2.1 &lt;/span&gt;Introduction&lt;/h5&gt;
+  &lt;h5 id=introduction-3&gt;&lt;span class=secno&gt;5.10.2.1 &lt;/span&gt;Introduction&lt;/h5&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -38364,7 +38766,7 @@
 
 
 
-  &lt;h5 id=processing-model-2&gt;&lt;span class=secno&gt;5.10.2.6 &lt;/span&gt;Processing model&lt;/h5&gt;
+  &lt;h5 id=processing-model-3&gt;&lt;span class=secno&gt;5.10.2.6 &lt;/span&gt;Processing model&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=transaction-steps&gt;transaction steps&lt;/dfn&gt; are as follows. These steps must
   be run asynchronously. These steps are invoked with a &lt;i&gt;transaction
@@ -40867,7 +41269,7 @@
   step).&lt;/p&gt;
 
 
-  &lt;h4 id=introduction-3&gt;&lt;span class=secno&gt;6.8.1 &lt;/span&gt;Introduction&lt;/h4&gt;
+  &lt;h4 id=introduction-4&gt;&lt;span class=secno&gt;6.8.1 &lt;/span&gt;Introduction&lt;/h4&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -43725,7 +44127,7 @@
   attacks.&lt;/p&gt;
 
 
-  &lt;h4 id=introduction-4&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Introduction&lt;/h4&gt;
+  &lt;h4 id=introduction-5&gt;&lt;span class=secno&gt;7.4.1 &lt;/span&gt;Introduction&lt;/h4&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -43978,7 +44380,7 @@
 
   &lt;h3 id=channel-messaging&gt;&lt;span class=secno&gt;7.5 &lt;/span&gt;&lt;dfn&gt;Channel messaging&lt;/dfn&gt;&lt;/h3&gt;
 
-  &lt;h4 id=introduction-5&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Introduction&lt;/h4&gt;
+  &lt;h4 id=introduction-6&gt;&lt;span class=secno&gt;7.5.1 &lt;/span&gt;Introduction&lt;/h4&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -43999,10 +44401,10 @@
   constructor is called, it must run the following algorithm:&lt;/p&gt;
 
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#create-a-new-messageport-object&gt;Create a new &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/a&gt;
-   owned by the &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt;, and let &lt;var title=&quot;&quot;&gt;port1&lt;/var&gt; be that object.&lt;/li&gt;
+   owned by the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, and let &lt;var title=&quot;&quot;&gt;port1&lt;/var&gt; be that object.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;a href=#create-a-new-messageport-object&gt;Create a new &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/a&gt;
-   owned by the &lt;a href=#script-execution-context&gt;script execution context&lt;/a&gt;, and let &lt;var title=&quot;&quot;&gt;port2&lt;/var&gt; be that object.&lt;/li&gt;
+   owned by the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;, and let &lt;var title=&quot;&quot;&gt;port2&lt;/var&gt; be that object.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;a href=#entangle&gt;Entangle&lt;/a&gt; the &lt;var title=&quot;&quot;&gt;port1&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;port2&lt;/var&gt; objects.&lt;/li&gt;
 
@@ -44051,8 +44453,8 @@
   initially closed.&lt;/p&gt;
 
   &lt;p&gt;When the user agent is to &lt;dfn id=create-a-new-messageport-object&gt;create a new
-  &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/dfn&gt; owned by a &lt;a href=#script-execution-context&gt;script
-  execution context&lt;/a&gt; object &lt;var title=&quot;&quot;&gt;owner&lt;/var&gt;, it must
+  &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/dfn&gt; owned by a &lt;a href=&quot;#script's-global-object&quot;&gt;script's
+  global object&lt;/a&gt; object &lt;var title=&quot;&quot;&gt;owner&lt;/var&gt;, it must
   instantiate a new &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; object, and let its owner
   be &lt;var title=&quot;&quot;&gt;owner&lt;/var&gt;.&lt;/p&gt;
 
@@ -44179,7 +44581,7 @@
    argument.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;span&gt;Create a new &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/span&gt;
-   owned by the &lt;span&gt;script execution context&lt;/span&gt;, and let &lt;var
+   owned by the &lt;span&gt;script's global object&lt;/span&gt;, and let &lt;var
    title=&quot;&quot;&gt;port1&lt;/var&gt; be that object.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the &lt;var title=&quot;&quot;&gt;source port&lt;/var&gt; is not entangled with
@@ -44296,7 +44698,7 @@
    &lt;dd&gt;&lt;p&gt;Must be invoked whenever an &lt;code title=event-close&gt;close&lt;/code&gt; event is targeted at or bubbles
    through the &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; object.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=ports-and-browsing-contexts&gt;&lt;span class=secno&gt;7.5.3.1 &lt;/span&gt;Ports and browsing contexts&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=message-port-discarding&gt;&lt;span class=secno&gt;7.5.3.1 &lt;/span&gt;Ports and browsing contexts&lt;/h5&gt;
 
   &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is &lt;a href=#discard-a-document title=&quot;discard a
   document&quot;&gt;discarded&lt;/a&gt;, if there are any
@@ -44305,7 +44707,7 @@
   &lt;ul class=brief&gt;&lt;li&gt;are entangled, and&lt;/li&gt;
    &lt;li&gt;are owned by the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; that contained that &lt;code&gt;Document&lt;/code&gt;, and&lt;/li&gt;
    &lt;li&gt;were created while that &lt;code&gt;Document&lt;/code&gt; was the &lt;a href=#active-document&gt;active document&lt;/a&gt; of that &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, and&lt;/li&gt;
-   &lt;li&gt;are entangled with a port that is either not owned by that &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; or was not created while that &lt;code&gt;Document&lt;/code&gt; was the &lt;a href=#active-document&gt;active document&lt;/a&gt; of that &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;,&lt;/li&gt;
+   &lt;li&gt;are entangled with a port that is either not owned by that &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, or were not created while that &lt;code&gt;Document&lt;/code&gt; was the &lt;a href=#active-document&gt;active document&lt;/a&gt; of that &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;,&lt;/li&gt;
   &lt;/ul&gt;&lt;p&gt;...then the user agent must run the following steps for each such
   port:&lt;/p&gt;
 
@@ -46183,10 +46585,9 @@
 
   &lt;h5 id=the-scripting-state&gt;&lt;span class=secno&gt;8.2.3.5 &lt;/span&gt;The scripting state&lt;/h5&gt;
 
-  &lt;p&gt;The &lt;dfn id=scripting-flag&gt;scripting flag&lt;/dfn&gt; is set to &quot;enabled&quot; if the
-  &lt;code&gt;Document&lt;/code&gt; with which the parser is associated was
-  &lt;a href=#with-script&gt;with script&lt;/a&gt; when the parser was created, and &quot;disabled&quot;
-  otherwise.&lt;/p&gt;
+  &lt;p&gt;The &lt;dfn id=scripting-flag&gt;scripting flag&lt;/dfn&gt; is set to &quot;enabled&quot; if the &lt;a href=#concept-n-script title=concept-n-script&gt;scripting was enabled&lt;/a&gt; for the
+  &lt;code&gt;Document&lt;/code&gt; with which the parser is associated when the
+  parser was created, and &quot;disabled&quot; otherwise.&lt;/p&gt;
 
 
   &lt;h4 id=tokenization&gt;&lt;span class=secno&gt;8.2.4 &lt;/span&gt;&lt;dfn&gt;Tokenization&lt;/dfn&gt;&lt;/h4&gt;
@@ -53981,8 +54382,11 @@
   scope of the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; associated with the
   &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the &lt;code title=setTimeout&gt;setTimeout()&lt;/code&gt; method was invoked.&lt;/p&gt;
 
-  &lt;p class=XXX&gt;Need to define &lt;var title=&quot;&quot;&gt;language&lt;/var&gt;
-  values.&lt;/p&gt;
+  &lt;p class=XXX&gt;Need to define &lt;var title=&quot;&quot;&gt;language&lt;/var&gt; values;
+  need to define that the &lt;a href=#concept-script title=concept-script&gt;script&lt;/a&gt;
+  corresponding to the &lt;var title=&quot;&quot;&gt;code&lt;/var&gt; argument is created
+  before the timer is set up, so that the rule on pausing the ticker,
+  below, makes sense.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-windowtimers-setinterval title=dom-windowtimers-setInterval&gt;&lt;code&gt;setInterval(...)&lt;/code&gt;&lt;/dfn&gt;
   variants must work in the same way as the &lt;code&gt;setTimeout&lt;/code&gt;
@@ -54000,8 +54404,13 @@
   with a value that does not correspond to an active timeout or
   interval, the methods must return without doing anything.&lt;/p&gt;
 
+  &lt;p&gt;For both &lt;code title=dom-windowtimers-setTimeout&gt;&lt;a href=#dom-windowtimers-settimeout&gt;setTimeout()&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-windowtimers-setInterval&gt;&lt;a href=#dom-windowtimers-setinterval&gt;setInterval()&lt;/a&gt;&lt;/code&gt;, the clock
+  upon which the timers are based must only tick while the
+  &lt;a href=#script-group&gt;script group&lt;/a&gt; of their callbacks is not
+  &lt;i&gt;frozen&lt;/i&gt;.&lt;/p&gt;
 
 
+
   &lt;h3 id=rendering-and-the-dom&gt;&lt;span class=secno&gt;11.5 &lt;/span&gt;Rendering and the DOM&lt;/h3&gt;
 
   &lt;p class=XXX&gt;This section is expected to be moved to its own

Modified: source
===================================================================
--- source	2008-12-03 01:27:37 UTC (rev 2528)
+++ source	2008-12-12 08:46:24 UTC (rev 2529)
@@ -428,7 +428,7 @@
   that no scripts execute (e.g. no event handlers, no timers,
   etc). User agents should remain responsive to user input while
   paused, however, albeit without letting the user interact with Web
-  pages where that would involve invoking any script.&lt;/p&gt;
+  pages where that would involve invoking any &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt;.&lt;/p&gt;
 
 
   &lt;h4&gt;XML&lt;/h4&gt;
@@ -3334,13 +3334,7 @@
 
   &lt;h4&gt;Terminology&lt;/h4&gt;
 
-  &lt;p&gt;A &lt;dfn&gt;URL&lt;/dfn&gt; is a string used to identify a resource. &lt;span
-  id=&quot;urldoc&quot;&gt;A &lt;span&gt;URL&lt;/span&gt; is always associated with a
-  &lt;code&gt;Document&lt;/code&gt;, either explicitly when the URL is created or
-  defined; or through a DOM node, in which case the associated
-  &lt;code&gt;Document&lt;/code&gt; is the node's &lt;code&gt;Document&lt;/code&gt;; or
-  through a script, in which case the associated &lt;code&gt;Document&lt;/code&gt;
-  is the script's &lt;span&gt;script document context&lt;/span&gt;.&lt;/span&gt;&lt;/p&gt;
+  &lt;p&gt;A &lt;dfn&gt;URL&lt;/dfn&gt; is a string used to identify a resource.&lt;/p&gt;
 
   &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is a &lt;dfn&gt;valid URL&lt;/dfn&gt; if at least one of
   the following conditions holds:&lt;/p&gt;
@@ -3364,6 +3358,29 @@
 
   &lt;/ul&gt;
 
+  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; has an associated &lt;dfn&gt;URL character
+  encoding&lt;/dfn&gt;, determined as follows:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;If the URL came from a script (e.g. as an argument to a
+   method)&lt;/dt&gt;
+
+   &lt;dd&gt;The URL character encoding is the &lt;span&gt;script's character
+   encoding&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;If the URL came from a DOM node (e.g. from an element)&lt;/dt&gt;
+
+   &lt;dd&gt;The node has a &lt;code&gt;Document&lt;/code&gt;, and the URL character
+   encoding is the &lt;span&gt;document's character encoding&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;If the URL had a character encoding defined when the URL was
+   created or defined&lt;/dt&gt;
+
+   &lt;dd&gt;The URL character encoding is as defined.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
   &lt;p class=&quot;note&quot;&gt;The term &quot;URL&quot; in this specification is used in a
   manner distinct from the precise technical meaning it is given in
   RFC 3986. Readers familiar with that RFC will find it easier to read
@@ -3522,8 +3539,7 @@
 
    &lt;dt&gt;If the URL to be resolved was passed to an API&lt;/dt&gt;
 
-   &lt;dd&gt;&lt;p&gt;The base URL is the &lt;span&gt;document base URL&lt;/span&gt; of the
-   script's &lt;span&gt;script document context&lt;/span&gt;.&lt;/p&gt;&lt;/dd&gt;
+   &lt;dd&gt;&lt;p&gt;The base URL is the &lt;span&gt;script's base URL&lt;/span&gt;.&lt;/p&gt;&lt;/dd&gt;
 
    &lt;dt&gt;If the URL to be resolved is from the value of a content
    attribute&lt;/dt&gt;
@@ -3594,14 +3610,9 @@
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the &lt;span&gt;URL&lt;/span&gt; being
    resolved.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; be the
-   &lt;code&gt;Document&lt;/code&gt; &lt;a href=&quot;#urldoc&quot;&gt;associated with&lt;/a&gt; &lt;var
-   title=&quot;&quot;&gt;url&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; be the &lt;span&gt;URL character
+   encoding&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; be the &lt;span
-   title=&quot;document's character encoding&quot;&gt;character encoding&lt;/span&gt; of
-   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
-
    &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; is UTF-16, then change it to
    UTF-8.&lt;/p&gt;&lt;/li&gt;
 
@@ -5609,13 +5620,31 @@
    &lt;li value=&quot;20&quot;&gt;&lt;dfn&gt;&lt;code&gt;ABORT_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually in XHR for now --&gt;
    &lt;li value=&quot;21&quot;&gt;&lt;dfn&gt;&lt;code&gt;URL_MISMATCH_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually in workers for now --&gt;
    &lt;li value=&quot;22&quot;&gt;&lt;dfn&gt;&lt;code&gt;QUOTA_EXCEEDED_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined right here for now --&gt;
+   &lt;li value=&quot;23&quot;&gt;&lt;dfn&gt;&lt;code&gt;UNAVAILABLE_SCRIPT_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined right here for now --&gt;
    &lt;li value=&quot;81&quot;&gt;&lt;dfn&gt;&lt;code&gt;PARSE_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined in dom3ls --&gt;
    &lt;li value=&quot;82&quot;&gt;&lt;dfn&gt;&lt;code&gt;SERIALISE_ERR&lt;/code&gt;&lt;/dfn&gt;&lt;/li&gt; &lt;!-- actually defined in dom3ls --&gt;
   &lt;/ol&gt;
 
 
+  &lt;h4&gt;Garbage collection&lt;/h4&gt;
 
+  &lt;p&gt;There is an &lt;dfn&gt;implied strong reference&lt;/dfn&gt; from any DOM
+  attribute that returns a pre-existing object to that object.&lt;/p&gt;
 
+  &lt;div class=&quot;example&quot;&gt;
+
+   &lt;p&gt;For example, the &lt;code&gt;document.defaultView&lt;/code&gt; attribute
+   means that there is a strong reference from a &lt;code&gt;Document&lt;/code&gt;
+   object to its &lt;code&gt;Window&lt;/code&gt; object. Similarly, there is
+   always a strong reference from a &lt;code&gt;Document&lt;/code&gt; to any
+   descendant nodes, and from any node to its owner
+   &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
+
+  &lt;/div&gt;
+
+
+
+
   &lt;h2 id=&quot;dom&quot;&gt;Semantics and structure of HTML documents&lt;/h2&gt;
 
   &lt;h3 id=&quot;semantics-intro&quot;&gt;Introduction&lt;/h3&gt;
@@ -5634,10 +5663,12 @@
   &lt;p&gt;&lt;dfn&gt;The document's address&lt;/dfn&gt; is an &lt;span&gt;absolute URL&lt;/span&gt;
   that is set when the &lt;code&gt;Document&lt;/code&gt; is created.&lt;/p&gt;
 
-  &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is created by a script using the
-  &lt;code title=&quot;&quot;&gt;createDocument()&lt;/code&gt; API, &lt;span&gt;the document's
+  &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is created by a &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt; using the &lt;code
+  title=&quot;&quot;&gt;createDocument()&lt;/code&gt; API, &lt;span&gt;the document's
   address&lt;/span&gt; is the same as &lt;span&gt;the document's address&lt;/span&gt; of
-  the &lt;span&gt;script document context&lt;/span&gt; of that script.&lt;/p&gt;
+  the &lt;span&gt;active document&lt;/span&gt; of the &lt;span&gt;script's browsing
+  context&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;&lt;code&gt;Document&lt;/code&gt; objects are assumed to be &lt;dfn&gt;XML
   documents&lt;/dfn&gt; unless they are flagged as being &lt;dfn&gt;HTML
@@ -5654,8 +5685,15 @@
   &lt;span title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt; by calling &lt;code
   title=&quot;dom-document-open&quot;&gt;document.open()&lt;/code&gt; on it.&lt;/p&gt;
 
+  &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is first created, a new &lt;span&gt;script
+  group&lt;/span&gt; must be created. This is the &lt;code&gt;Document&lt;/code&gt;'s
+  &lt;dfn&gt;current script group&lt;/dfn&gt; until the script group is changed
+  (which can happen if &lt;code
+  title=&quot;dom-document-open&quot;&gt;document.open()&lt;/code&gt; is invoked on the
+  &lt;code&gt;Document&lt;/code&gt;).&lt;/p&gt;
 
 
+
   &lt;h4&gt;Documents in the DOM&lt;/h4&gt;
 
   &lt;p&gt;All &lt;code&gt;Document&lt;/code&gt; objects (in user agents implementing
@@ -7450,8 +7488,8 @@
   with the parser, and thus their behavior varies depending on whether
   they are used with &lt;span&gt;HTML documents&lt;/span&gt; (and the &lt;span&gt;HTML
   parser&lt;/span&gt;) or XHTML in &lt;span&gt;XML documents&lt;/span&gt; (and the
-  &lt;span&gt;XML parser&lt;/span&gt;). The following table cross-references the
-  various versions of these APIs.&lt;/p&gt;
+  &lt;span&gt;XML parser&lt;/span&gt;&lt;!-- XXX xref --&gt;). The following table
+  cross-references the various versions of these APIs.&lt;/p&gt;
 
   &lt;table&gt;
    &lt;thead&gt;
@@ -7550,8 +7588,11 @@
 
    &lt;/li&gt;
 
-   &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;onbeforeunload, onunload, reset timers, empty event queue, kill any pending transactions, XMLHttpRequests, etc&lt;/p&gt;&lt;/li&gt;
-   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(</A>)%20{%20f%20%3D%20document.getElementsByTagName(%27iframe%27)[0]%3B%20d%20%3D%20f.contentDocument%3B%20}%3C%2Fscript%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22w(d.documentElement.innerHTML)%22%20value%3D%22dump%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.body.bgColor%3D%27red%27%22%20value%3D%22color%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22f.style.border%3D%27lime%20solid%27%22%20value%3D%22color%20frame%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write(%27%3Cp%3Etest%3C%2Fp%3E%27)%3B%20d.close()%22%20value%3D%22replace%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write(%27%3Cp%3E%3Cscript%3Ei%20%3D%200%3B%20setInterval(%26quot%3Bparent.w(i%2B%2B)%26quot%3B%2C%20500)%3C%2Fscript%3E%3C%2Fp%3E%27)%3B%20d.close()%22%20value%3D%22replace%20with%20timer%22%3E%0A --&gt;
+   &lt;li&gt;&lt;p&gt;&lt;span title=&quot;unload a document&quot;&gt;Unload&lt;/span&gt; the
+   &lt;code&gt;Document&lt;/code&gt; object, with the &lt;var title=&quot;&quot;&gt;recycle&lt;/var&gt;
+   parameter set to true. If the user &lt;span&gt;refused to allow the
+   document to be unloaded&lt;/span&gt;, then these steps must be
+   aborted.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the document has an &lt;span&gt;active parser&lt;/span&gt;&lt;!--XXX
    xref--&gt;, then stop that parser, and throw away any pending content
@@ -7560,15 +7601,28 @@
    XHTML, or image document, or something?&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;!-- XXX see
    also innerHTML in HTML --&gt;
 
+   &lt;li&gt;&lt;p&gt;Freeze the document's &lt;span&gt;current script
+   group&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Unregister all event listeners registered on the
+   &lt;code&gt;Document&lt;/code&gt; node and its descendants.&lt;/p&gt;
+
    &lt;li&gt;&lt;p&gt;Remove all child nodes of the document, without firing any
    mutation events.&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Create a new &lt;span&gt;script group&lt;/span&gt; and let the
+   document's &lt;span&gt;current script group&lt;/span&gt; be that new
+   group. (The old script group is now permanently frozen.)&lt;/p&gt;&lt;/li&gt;
+
+   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%20src%3D%22document%22%3E%3C%2Fiframe%3E%0A%3Cscript%3Eonload%20%3D%20function%20(</A>)%20%7B%20f%20%3D%20document.getElementsByTagName('iframe')%5B0%5D%3B%20d%20%3D%20f.contentWindow.document%3B%20%7D%3C%2Fscript%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22w(d.documentElement.innerHTML)%22%20value%3D%22dump%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write('%3Cscript%3Evar%20x%20%3D%20new%20XMLHttpRequest()%3Bx.open(%26quot%3BGET%26quot%3B%2C%20%26quot%3BGET%26quot%3B)%3Bx.onreadystatechange%3Dfunction()%20%7B%20alert(x.readyState)%3B%20%7D%3Bx.send(null)%3B%3C%2Fscript%3E')%3Bd.close()%3B%20setTimeout(function()%20%7B%20d.open()%3B%20d.write('%3Cp%3Etest%3C%2Fp%3E')%3B%20d.close()%20%7D%2C%200)%3B%22%20value%3D%22xhr%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.onclick%20%3D%20function()%20%7B%20w('click')%20%7D%22%20value%3D%22add%20click%20handler%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write('%3Cp%3Etest%3C%2Fp%3E')%3B%20d.close()%22%20value%3D%22replace%22%3E%0A%3Cinput%20type%3Dbutton%20onclick%3D%22d.open()%3B%20d.write('%3Cp%3E%3Cscript%3Ei%20%3D%200%3B%20setTimeout(%26quot%3Bparent.w(i%2B%2B)%26quot%3B%2C%202000)%3C%2Fscript%3E%3C%2Fp%3E')%3B%20d.close()%22%20value%3D%22replace%20with%20timer%22%3E --&gt;
+
    &lt;li&gt;&lt;p&gt;Change the &lt;span&gt;document's character encoding&lt;/span&gt; to
    UTF-16.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Change &lt;span&gt;the document's address&lt;/span&gt; to the &lt;span
-   title=&quot;the document's address&quot;&gt;address&lt;/span&gt; of the &lt;span&gt;script
-   document context&lt;/span&gt; of the script that invoked the &lt;code
+   &lt;li&gt;&lt;p&gt;Change &lt;span&gt;the document's address&lt;/span&gt; to the &lt;span&gt;the
+   document's address&lt;/span&gt; of the &lt;span&gt;active document&lt;/span&gt; of
+   the &lt;span title=&quot;script's browsing context&quot;&gt;browsing context&lt;/span&gt;
+   of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that invoked the &lt;code
    title=&quot;dom-document-open&quot;&gt;document.open()&lt;/code&gt; method.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Create a new &lt;span&gt;HTML parser&lt;/span&gt; and associate it with
@@ -7685,8 +7739,10 @@
     &lt;p&gt;If the &lt;span&gt;insertion point&lt;/span&gt; is undefined, the &lt;code
     title=&quot;dom-document-open&quot;&gt;open()&lt;/code&gt; method must be called
     (with no arguments) on the &lt;code title=&quot;Document&quot;&gt;document&lt;/code&gt;
-    object. The &lt;span&gt;insertion point&lt;/span&gt; will point at just before
-    the end of the (empty) &lt;span&gt;input stream&lt;/span&gt;.&lt;/p&gt;
+    object. If the user &lt;span&gt;refused to allow the document to be
+    unloaded&lt;/span&gt;, then these steps must be aborted. Otherwise, the
+    &lt;span&gt;insertion point&lt;/span&gt; will point at just before the end of
+    the (empty) &lt;span&gt;input stream&lt;/span&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -8193,7 +8249,7 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;The user agent must create a new &lt;span&gt;XML parser&lt;/span&gt;.&lt;/p&gt;
+    &lt;p&gt;The user agent must create a new &lt;span&gt;XML parser&lt;/span&gt;&lt;!-- XXX xref --&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -9793,13 +9849,13 @@
   &lt;dfn&gt;&quot;parser-inserted&quot;&lt;/dfn&gt;. This flag is set by the &lt;span&gt;HTML
   parser&lt;/span&gt; and is used to handle &lt;code
   title=&quot;dom-document-write-HTML&quot;&gt;document.write()&lt;/code&gt; calls. The
-  third and fourth pieces of metadata are &lt;dfn&gt;&lt;var&gt;the script's
-  type&lt;/var&gt;&lt;/dfn&gt; and &lt;dfn&gt;&lt;var&gt;the script's character
+  third and fourth pieces of metadata are &lt;dfn&gt;&lt;var&gt;the script block's
+  type&lt;/var&gt;&lt;/dfn&gt; and &lt;dfn&gt;&lt;var&gt;the script block's character
   encoding&lt;/var&gt;&lt;/dfn&gt;. They are determined when the script is run,
   based on the attributes on the element at that time.&lt;/p&gt;
 
-  &lt;p&gt;When an &lt;span&gt;XML parser&lt;/span&gt; creates a &lt;code&gt;script&lt;/code&gt;
-  element, it must be marked as being
+  &lt;p&gt;When an &lt;span&gt;XML parser&lt;/span&gt;&lt;!-- XXX xref --&gt; creates a
+  &lt;code&gt;script&lt;/code&gt; element, it must be marked as being
   &lt;span&gt;&quot;parser-inserted&quot;&lt;/span&gt;. When the element's end tag is
   parsed, the user agent must &lt;span title=&quot;running a
   script&quot;&gt;run&lt;/span&gt; the &lt;code&gt;script&lt;/code&gt; element.&lt;/p&gt;
@@ -9841,23 +9897,23 @@
 
     &lt;/ul&gt;
 
-    &lt;p&gt;...let &lt;var&gt;the script's type&lt;/var&gt; for this
+    &lt;p&gt;...let &lt;var&gt;the script block's type&lt;/var&gt; for this
     &lt;code&gt;script&lt;/code&gt; element be &quot;&lt;code
     title=&quot;&quot;&gt;text/javascript&lt;/code&gt;&quot;.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, if the &lt;code&gt;script&lt;/code&gt; element has a &lt;code
     title=&quot;attr-script-type&quot;&gt;type&lt;/code&gt; attribute, let &lt;var&gt;the
-    script's type&lt;/var&gt; for this &lt;code&gt;script&lt;/code&gt; element be the
-    value of that attribute.&lt;/p&gt;
+    script block's type&lt;/var&gt; for this &lt;code&gt;script&lt;/code&gt; element be
+    the value of that attribute.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, the element has a &lt;code
     title=&quot;attr-script-language&quot;&gt;language&lt;/code&gt; attribute; let
-    &lt;var&gt;the script's type&lt;/var&gt; for this &lt;code&gt;script&lt;/code&gt; element
-    be the concatenation of the string &quot;&lt;code title=&quot;&quot;&gt;text/&lt;/code&gt;&quot;
-    followed by the value of the &lt;code
-    title=&quot;attr-script-language&quot;&gt;language&lt;/code&gt; attribute.&lt;/p&gt;
-    &lt;!-- user agents already support, e.g., type=&quot;text/javascript1.3&quot;,
-    so we don't have to support that separately. --&gt;
+    &lt;var&gt;the script block's type&lt;/var&gt; for this &lt;code&gt;script&lt;/code&gt;
+    element be the concatenation of the string &quot;&lt;code
+    title=&quot;&quot;&gt;text/&lt;/code&gt;&quot; followed by the value of the &lt;code
+    title=&quot;attr-script-language&quot;&gt;language&lt;/code&gt; attribute.&lt;/p&gt; &lt;!--
+    user agents already support, e.g., type=&quot;text/javascript1.3&quot;, so
+    we don't have to support that separately. --&gt;
 
    &lt;/li&gt;
 
@@ -9865,12 +9921,12 @@
 
     &lt;p&gt;If the &lt;code&gt;script&lt;/code&gt; element has a &lt;code
     title=&quot;attr-script-charset&quot;&gt;charset&lt;/code&gt; attribute, then let
-    &lt;var&gt;the script's character encoding&lt;/var&gt; for this
+    &lt;var&gt;the script block's character encoding&lt;/var&gt; for this
     &lt;code&gt;script&lt;/code&gt; element be the encoding given by the &lt;code
     title=&quot;attr-script-charset&quot;&gt;charset&lt;/code&gt; attribute.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, let &lt;var&gt;the script's character encoding&lt;/var&gt; for
-    this &lt;code&gt;script&lt;/code&gt; element be the same as &lt;span
+    &lt;p&gt;Otherwise, let &lt;var&gt;the script block's character encoding&lt;/var&gt;
+    for this &lt;code&gt;script&lt;/code&gt; element be the same as &lt;span
     title=&quot;document's character encoding&quot;&gt;the encoding of the document
     itself&lt;/span&gt;.&lt;/p&gt;
 
@@ -9878,16 +9934,18 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;If the &lt;code&gt;script&lt;/code&gt; element is &lt;span&gt;without
-    script&lt;/span&gt;, or if the &lt;code&gt;script&lt;/code&gt; element was created
-    by an &lt;span&gt;XML parser&lt;/span&gt; that itself was created as part of
+    &lt;p&gt;If &lt;span title=&quot;concept-n-noscript&quot;&gt;scripting is
+    disabled&lt;/span&gt; for the &lt;code&gt;script&lt;/code&gt; element, or if the
+    &lt;code&gt;script&lt;/code&gt; element was created by an &lt;span&gt;XML
+    parser&lt;/span&gt;&lt;!-- XXX xref --&gt; that itself was created as part of
     the processing of the &lt;code
     title=&quot;dom-innerHTML-XML&quot;&gt;innerHTML&lt;/code&gt; attribute's setter&lt;!--
     no need to worry about the HTML case, as the HTML parser handles
     that for us --&gt;, or if the user agent does not &lt;span&gt;support the
-    scripting language&lt;/span&gt; given by &lt;var&gt;the script's type&lt;/var&gt;
-    for this &lt;code&gt;script&lt;/code&gt; element, then the user agent must
-    abort these steps at this point. The script is not executed.&lt;/p&gt;
+    scripting language&lt;/span&gt; given by &lt;var&gt;the script block's
+    type&lt;/var&gt; for this &lt;code&gt;script&lt;/code&gt; element, then the user
+    agent must abort these steps at this point. The script is not
+    executed.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -9997,8 +10055,8 @@
      &lt;dt&gt;Otherwise&lt;/dt&gt;
 
      &lt;dd&gt;The user agent must immediately &lt;span title=&quot;executing a
-     script block&quot;&gt;execute the script&lt;/span&gt;, even if other scripts
-     are already executing.&lt;/dd&gt;
+     script block&quot;&gt;execute the script block&lt;/span&gt;, even if other
+     scripts are already executing.&lt;/dd&gt;
 
     &lt;/dl&gt;
 
@@ -10006,17 +10064,18 @@
 
   &lt;/ol&gt;
 
-  &lt;p&gt;&lt;dfn&gt;When a script completes loading&lt;/dfn&gt;: If the script's
-  element was added to one of the lists mentioned above and the
-  document is still being parsed, then the parser handles
-  it. Otherwise, the UA must run the following steps as the &lt;span
-  title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that the &lt;span&gt;networking task
-  source&lt;/span&gt; places on the &lt;span&gt;task queue&lt;/span&gt;:&lt;/p&gt;
+  &lt;p&gt;&lt;dfn&gt;When a script completes loading&lt;/dfn&gt;: If the
+  &lt;code&gt;script&lt;/code&gt; element was added to one of the lists mentioned
+  above and the document is still being parsed, then the parser
+  handles it. Otherwise, the UA must run the following steps as the
+  &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that the &lt;span&gt;networking
+  task source&lt;/span&gt; places on the &lt;span&gt;task queue&lt;/span&gt;:&lt;/p&gt;
 
   &lt;dl class=&quot;switch&quot;&gt;
 
-   &lt;dt&gt;If the script's element was added to the &lt;dfn&gt;list of scripts
-   that will execute when the document has finished parsing&lt;/dfn&gt;:&lt;/dt&gt;
+   &lt;dt&gt;If the &lt;code&gt;script&lt;/code&gt; element was added to the &lt;dfn&gt;list
+   of scripts that will execute when the document has finished
+   parsing&lt;/dfn&gt;:&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -10024,23 +10083,23 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;If the script's element is not the first element in the list,
-      then do nothing yet. Stop going through these steps.&lt;/p&gt;
+      &lt;p&gt;If the &lt;code&gt;script&lt;/code&gt; element is not the first element
+      in the list, then do nothing yet. Stop going through these
+      steps.&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
       &lt;p&gt;Otherwise, &lt;span title=&quot;executing a script block&quot;&gt;execute the
-      script&lt;/span&gt; (that is, the script associated with the first
-      element in the list).&lt;/p&gt;
+      script block&lt;/span&gt; (the first element in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Remove the script's element from the list (i.e. shift out the
-      first entry in the list).&lt;/p&gt;
+      &lt;p&gt;Remove the &lt;code&gt;script&lt;/code&gt; element from the list
+      (i.e. shift out the first entry in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -10056,8 +10115,8 @@
 
    &lt;/dd&gt;
 
-   &lt;dt&gt;If the script's element was added to the &lt;dfn&gt;list of scripts
-   that will execute asynchronously&lt;/dfn&gt;:&lt;/dt&gt;
+   &lt;dt&gt;If the &lt;code&gt;script&lt;/code&gt; element was added to the &lt;dfn&gt;list
+   of scripts that will execute asynchronously&lt;/dfn&gt;:&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -10072,16 +10131,15 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;span title=&quot;executing a script block&quot;&gt;Execute the
-      script&lt;/span&gt; (the script associated with the first element in
-      the list).&lt;/p&gt;
+      &lt;p&gt;&lt;span title=&quot;executing a script block&quot;&gt;Execute the script
+      block&lt;/span&gt; (the first element in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Remove the script's element from the list (i.e. shift out the
-      first entry in the list).&lt;/p&gt;
+      &lt;p&gt;Remove the &lt;code&gt;script&lt;/code&gt; element from the list
+      (i.e. shift out the first entry in the list).&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -10100,8 +10158,8 @@
 
    &lt;/dd&gt;
 
-   &lt;dt&gt;If the script's element was added to the &lt;dfn&gt;list of scripts
-   that will execute as soon as possible&lt;/dfn&gt;:&lt;/dt&gt;
+   &lt;dt&gt;If the &lt;code&gt;script&lt;/code&gt; element was added to the &lt;dfn&gt;list
+   of scripts that will execute as soon as possible&lt;/dfn&gt;:&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -10110,13 +10168,13 @@
      &lt;li&gt;
 
       &lt;p&gt;&lt;span title=&quot;executing a script block&quot;&gt;Execute the
-      script&lt;/span&gt;.&lt;/p&gt;
+      script block&lt;/span&gt;.&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Remove the script's element from the list.&lt;/p&gt;
+      &lt;p&gt;Remove the &lt;code&gt;script&lt;/code&gt; element from the list.&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -10130,7 +10188,7 @@
   title=&quot;event-load&quot;&gt;load&lt;/code&gt; event&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;&lt;dfn title=&quot;executing a script block&quot;&gt;Executing a script
-  block&lt;/dfn&gt;: When the steps above require that the script be
+  block&lt;/dfn&gt;: When the steps above require that the script block be
   executed, the user agent must act as follows:&lt;/p&gt;
 
   &lt;dl class=&quot;switch&quot;&gt;
@@ -10138,21 +10196,22 @@
    &lt;dt&gt;If the load resulted in an error (for example a DNS error, or
    an HTTP 404 error)&lt;/dt&gt;
 
-   &lt;dd&gt;&lt;p&gt;Executing the script must just consist of &lt;span title=&quot;fire
-   an error event&quot;&gt;firing an &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt;
-   event&lt;/span&gt; at the element.&lt;/p&gt;&lt;/dd&gt;
+   &lt;dd&gt;&lt;p&gt;Executing the script block must just consist of &lt;span
+   title=&quot;fire an error event&quot;&gt;firing an &lt;code
+   title=&quot;event-error&quot;&gt;error&lt;/code&gt; event&lt;/span&gt; at the
+   element.&lt;/p&gt;&lt;/dd&gt;
 
    &lt;dt&gt;If the load was successful&lt;/dt&gt;
 
+   &lt;!-- SCRIPT EXEC --&gt;
    &lt;dd&gt;
 
     &lt;ol&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;If the &lt;code&gt;script&lt;/code&gt; element's &lt;code&gt;Document&lt;/code&gt; is
-      the &lt;span&gt;active document&lt;/span&gt; in its &lt;span&gt;browsing
-      context&lt;/span&gt;, the user agent must execute the script:&lt;/p&gt;
+      &lt;p&gt;Initialise &lt;dfn&gt;&lt;var&gt;the script block's source&lt;/var&gt;&lt;/dfn&gt; as
+      follows:&lt;/p&gt;
 
       &lt;dl class=&quot;switch&quot;&gt;
 
@@ -10160,12 +10219,13 @@
 
        &lt;dd&gt;
 
-        &lt;p&gt;That file must be used as the file to execute.&lt;/p&gt;
+        &lt;p&gt;The contents of that file, interpreted as as string of
+        Unicode characters, are the script source.&lt;/p&gt;
 
-        &lt;p&gt;The file must be interpreted using the character encoding
-        given by &lt;var&gt;the script's character encoding&lt;/var&gt;, regardless
-        of any metadata given by the file's &lt;span
-        title=&quot;Content-Type&quot;&gt;Content-Type metadata&lt;/span&gt;.&lt;/p&gt;
+        &lt;p&gt;The file must be converted to Unicode using the character
+        encoding given by &lt;var&gt;the script block's character
+        encoding&lt;/var&gt;, regardless of any metadata given by the file's
+        &lt;span title=&quot;Content-Type&quot;&gt;Content-Type metadata&lt;/span&gt;.&lt;/p&gt;
 
         &lt;p class=&quot;XXX&quot;&gt;This means that a UTF-16 document will
         always assume external scripts are UTF-16...? This applies,
@@ -10176,51 +10236,47 @@
 
        &lt;/dd&gt;
 
-       &lt;dt&gt;If the script is inline&lt;/dt&gt;
+       &lt;dt&gt;If the script is inline and &lt;var&gt;the script block's type&lt;/var&gt; is a text-based language&lt;/dt&gt;
 
        &lt;dd&gt;
 
-        &lt;p&gt;For scripting languages that consist of pure text, user
-        agents must use the value of the DOM &lt;code
-        title=&quot;dom-script-text&quot;&gt;text&lt;/code&gt; attribute (defined below) as
-        the script to execute, and for XML-based scripting languages,
-        user agents must use all the child nodes of the
-        &lt;code&gt;script&lt;/code&gt; element as the script to execute.&lt;/p&gt;
+        &lt;p&gt;The value of the DOM &lt;code
+        title=&quot;dom-script-text&quot;&gt;text&lt;/code&gt; attribute at the time the
+        &quot;&lt;span&gt;running a script&lt;/span&gt;&quot; algorithm was first invoked is
+        the script source.&lt;/p&gt;
 
        &lt;/dd&gt;
 
+       &lt;dt&gt;If the script is inline and &lt;var&gt;the script block's type&lt;/var&gt; is an XML-based language&lt;/dt&gt;
+
+       &lt;dd&gt;
+
+        &lt;p&gt;The child nodes of the &lt;code&gt;script&lt;/code&gt; element at the
+        time the &quot;&lt;span&gt;running a script&lt;/span&gt;&quot; algorithm was first
+        invoked are the script source.&lt;/p&gt;
+
+       &lt;/dd&gt;
+
       &lt;/dl&gt;
 
-      &lt;!-- SCRIPT EXEC --&gt;
-      &lt;p&gt;In any case, the user agent must execute the script according to
-      the semantics defined by the language associated with &lt;var&gt;the
-      script's type&lt;/var&gt; (see the &lt;a href=&quot;#scriptingLanguages&quot;&gt;scripting
-      languages&lt;/a&gt; section below).&lt;/p&gt;
+     &lt;/li&gt;
 
-      &lt;p&gt;The &lt;span&gt;script execution context&lt;/span&gt; of the script must
-      be the &lt;code&gt;Window&lt;/code&gt; object of that &lt;span&gt;browsing
-      context&lt;/span&gt;.&lt;/p&gt;
+     &lt;li&gt;
 
-      &lt;p&gt;The &lt;span&gt;script document context&lt;/span&gt; of the script must
-      be the &lt;code&gt;Document&lt;/code&gt; object that owns the
-      &lt;code&gt;script&lt;/code&gt; element.&lt;/p&gt;
+      &lt;p&gt;&lt;span title=&quot;create a script from a node&quot;&gt;Create a
+      script&lt;/span&gt; from the &lt;code&gt;script&lt;/code&gt; element node, using
+      the &lt;var&gt;the script block's source&lt;/var&gt; and the &lt;var&gt;the script
+      block's type&lt;/var&gt;.&lt;/p&gt;
 
-      &lt;p class=&quot;note&quot;&gt;The element's attributes' values might have changed
-      between when the element was inserted into the document and when the
-      script has finished loading, as may its other attributes; similarly,
-      the element itself might have been taken back out of the DOM, or had
-      other changes made. These changes do not in any way affect the above
-      steps; only the values of the attributes at the time the
-      &lt;code&gt;script&lt;/code&gt; element is first inserted into the document
-      matter.&lt;/p&gt;
+      &lt;p class=&quot;note&quot;&gt;This is where the script is compiled and
+      actually executed.&lt;/p&gt;
 
      &lt;/li&gt;
 
      &lt;li&gt;
 
-      &lt;p&gt;Then, the user agent must &lt;span&gt;fire a &lt;code
-      title=&quot;event-load&quot;&gt;load&lt;/code&gt; event&lt;/span&gt; at the
-      &lt;code&gt;script&lt;/code&gt; element.&lt;/p&gt;
+      &lt;p&gt;&lt;span&gt;Fire a &lt;code title=&quot;event-load&quot;&gt;load&lt;/code&gt;
+      event&lt;/span&gt; at the &lt;code&gt;script&lt;/code&gt; element.&lt;/p&gt;
 
      &lt;/li&gt;
 
@@ -10275,8 +10331,8 @@
   &lt;h5 id=&quot;scriptingLanguages&quot;&gt;Scripting languages&lt;/h5&gt;
 
   &lt;p&gt;A user agent is said to &lt;dfn&gt;support the scripting language&lt;/dfn&gt;
-  if &lt;var&gt;the script's type&lt;/var&gt; matches the MIME type of a scripting
-  language that the user agent implements.&lt;/p&gt;
+  if &lt;var&gt;the script block's type&lt;/var&gt; matches the MIME type of a
+  scripting language that the user agent implements.&lt;/p&gt;
 
   &lt;p&gt;The following lists some MIME types and the languages to which
   they refer:&lt;/p&gt;
@@ -10316,9 +10372,9 @@
    &lt;dd&gt;In a &lt;code&gt;head&lt;/code&gt; element of an &lt;span title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, if there are no ancestor &lt;code&gt;noscript&lt;/code&gt; elements.&lt;/dd&gt;
    &lt;dd&gt;Where &lt;span&gt;phrasing content&lt;/span&gt; is expected in &lt;span&gt;HTML documents&lt;/span&gt;, if there are no ancestor &lt;code&gt;noscript&lt;/code&gt; elements.&lt;/dd&gt;
    &lt;dt&gt;Content model:&lt;/dt&gt;
-   &lt;dd&gt;&lt;span&gt;Without script&lt;/span&gt;, in a &lt;code&gt;head&lt;/code&gt; element: in any order, zero or more &lt;code&gt;link&lt;/code&gt; elements, zero or more &lt;code&gt;style&lt;/code&gt; elements, and zero or more &lt;code&gt;meta&lt;/code&gt; elements.&lt;/dd&gt;
-   &lt;dd&gt;&lt;span&gt;Without script&lt;/span&gt;, not in a &lt;code&gt;head&lt;/code&gt; element: &lt;span&gt;transparent&lt;/span&gt;, but there must be no &lt;code&gt;noscript&lt;/code&gt; element descendants.&lt;/dd&gt;
-   &lt;dd&gt;&lt;span&gt;With script&lt;/span&gt;: text that conforms to the requirements given in the prose.&lt;/dd&gt;
+   &lt;dd&gt;When &lt;span title=&quot;concept-n-noscript&quot;&gt;scripting is disabled&lt;/span&gt;, in a &lt;code&gt;head&lt;/code&gt; element: in any order, zero or more &lt;code&gt;link&lt;/code&gt; elements, zero or more &lt;code&gt;style&lt;/code&gt; elements, and zero or more &lt;code&gt;meta&lt;/code&gt; elements.&lt;/dd&gt;
+   &lt;dd&gt;When &lt;span title=&quot;concept-n-noscript&quot;&gt;scripting is disabled&lt;/span&gt;, not in a &lt;code&gt;head&lt;/code&gt; element: &lt;span&gt;transparent&lt;/span&gt;, but there must be no &lt;code&gt;noscript&lt;/code&gt; element descendants.&lt;/dd&gt;
+   &lt;dd&gt;Otherwise: text that conforms to the requirements given in the prose.&lt;/dd&gt;
    &lt;dt&gt;Element-specific attributes:&lt;/dt&gt;
    &lt;dd&gt;None.&lt;/dd&gt;
    &lt;dt&gt;DOM interface:&lt;/dt&gt;
@@ -10330,97 +10386,104 @@
   scripting and those that don't support scripting, by affecting how
   the document is parsed.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element must not be used in &lt;span&gt;XML
-  documents&lt;/span&gt;.&lt;/p&gt;
-
-  &lt;p class=&quot;note&quot;&gt;&lt;strong&gt;The &lt;code&gt;noscript&lt;/code&gt; element is only
-  effective in the &lt;span title=&quot;&quot;&gt;HTML serialization&lt;/span&gt;&lt;!-- XXX
-  xref --&gt;, it has no effect in the &lt;span title=&quot;&quot;&gt;XML
-  serialization&lt;/span&gt;&lt;!-- XXX xref --&gt;.&lt;/strong&gt;&lt;/p&gt;
-
   &lt;p&gt;When used in &lt;span&gt;HTML documents&lt;/span&gt;, the allowed content
   model is as follows:&lt;/p&gt;
 
-  &lt;p&gt;In a &lt;code&gt;head&lt;/code&gt; element, if the &lt;code&gt;noscript&lt;/code&gt;
-  element is &lt;span&gt;without script&lt;/span&gt;, then the content model of a
-  &lt;code&gt;noscript&lt;/code&gt; element must contain only &lt;code&gt;link&lt;/code&gt;,
-  &lt;code&gt;style&lt;/code&gt;, and &lt;code&gt;meta&lt;/code&gt; elements. If the
-  &lt;code&gt;noscript&lt;/code&gt; element is &lt;span&gt;with script&lt;/span&gt;, then the
-  content model of a &lt;code&gt;noscript&lt;/code&gt; element is text, except
-  that invoking the &lt;span&gt;HTML fragment parsing algorithm&lt;/span&gt; with
-  the &lt;code&gt;noscript&lt;/code&gt; element as the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt;
-  element and the text contents as the &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; must
-  result in a list of nodes that consists only of &lt;code&gt;link&lt;/code&gt;,
-  &lt;code&gt;style&lt;/code&gt;, and &lt;code&gt;meta&lt;/code&gt; elements.&lt;/p&gt;
+  &lt;dl&gt;
 
-  &lt;p&gt;Outside of &lt;code&gt;head&lt;/code&gt; elements, if the
-  &lt;code&gt;noscript&lt;/code&gt; element is &lt;span&gt;without script&lt;/span&gt;, then
-  the content model of a &lt;code&gt;noscript&lt;/code&gt; element is
-  &lt;span&gt;transparent&lt;/span&gt;, with the additional restriction that a
-  &lt;code&gt;noscript&lt;/code&gt; element must not have a &lt;code&gt;noscript&lt;/code&gt;
-  element as an ancestor (that is, &lt;code&gt;noscript&lt;/code&gt; can't be
-  nested).&lt;/p&gt;
+   &lt;dt&gt;In a &lt;code&gt;head&lt;/code&gt; element, if &lt;span
+   title=&quot;concept-n-noscript&quot;&gt;scripting is disabled&lt;/span&gt; for the
+   &lt;code&gt;noscript&lt;/code&gt; element&lt;/dt&gt;
 
-  &lt;p&gt;Outside of &lt;code&gt;head&lt;/code&gt; elements, if the
-  &lt;code&gt;noscript&lt;/code&gt; element is &lt;span&gt;with script&lt;/span&gt;, then the
-  content model of a &lt;code&gt;noscript&lt;/code&gt; element is text, except
-  that the text must be such that running the following algorithm
-  results in a conforming document with no &lt;code&gt;noscript&lt;/code&gt;
-  elements and no &lt;code&gt;script&lt;/code&gt; elements, and such that no step
-  in the algorithm causes an &lt;span&gt;HTML parser&lt;/span&gt; to flag a
-  &lt;span&gt;parse error&lt;/span&gt;:&lt;/p&gt;
+   &lt;dd&gt;&lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element must contain only
+   &lt;code&gt;link&lt;/code&gt;, &lt;code&gt;style&lt;/code&gt;, and &lt;code&gt;meta&lt;/code&gt;
+   elements.&lt;/p&gt;&lt;/dd&gt;
 
-  &lt;ol&gt;
+   &lt;dt&gt;In a &lt;code&gt;head&lt;/code&gt; element, if &lt;span
+   title=&quot;concept-n-noscript&quot;&gt;scripting is enabled&lt;/span&gt; for the
+   &lt;code&gt;noscript&lt;/code&gt; element&lt;/dt&gt;
 
-   &lt;li&gt;Remove every &lt;code&gt;script&lt;/code&gt; element from the
-   document.&lt;/li&gt;
+   &lt;dd&gt;&lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element must contain only text,
+   except that invoking the &lt;span&gt;HTML fragment parsing
+   algorithm&lt;/span&gt; with the &lt;code&gt;noscript&lt;/code&gt; element as the &lt;var
+   title=&quot;&quot;&gt;context&lt;/var&gt; element and the text contents as the &lt;var
+   title=&quot;&quot;&gt;input&lt;/var&gt; must result in a list of nodes that consists
+   only of &lt;code&gt;link&lt;/code&gt;, &lt;code&gt;style&lt;/code&gt;, and
+   &lt;code&gt;meta&lt;/code&gt; elements.&lt;/p&gt;&lt;/dd&gt;
 
-   &lt;li&gt;Make a list of every &lt;code&gt;noscript&lt;/code&gt; element in the
-   document. For every &lt;code&gt;noscript&lt;/code&gt; element in that list,
-   perform the following steps:
+   &lt;dt&gt;Outside of &lt;code&gt;head&lt;/code&gt; elements, if &lt;span
+   title=&quot;concept-n-noscript&quot;&gt;scripting is disabled&lt;/span&gt; for the
+   &lt;code&gt;noscript&lt;/code&gt; element&lt;/dt&gt;
 
+   &lt;dd&gt;&lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element's content model is
+   &lt;span&gt;transparent&lt;/span&gt;, with the additional restriction that a
+   &lt;code&gt;noscript&lt;/code&gt; element must not have a &lt;code&gt;noscript&lt;/code&gt;
+   element as an ancestor (that is, &lt;code&gt;noscript&lt;/code&gt; can't be
+   nested).&lt;/p&gt;&lt;/dd&gt;
+
+   &lt;dt&gt;Outside of &lt;code&gt;head&lt;/code&gt; elements, if &lt;span
+   title=&quot;concept-n-noscript&quot;&gt;scripting is enabled&lt;/span&gt; for the
+   &lt;code&gt;noscript&lt;/code&gt; element&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element must contain only text,
+    except that the text must be such that running the following
+    algorithm results in a conforming document with no
+    &lt;code&gt;noscript&lt;/code&gt; elements and no &lt;code&gt;script&lt;/code&gt;
+    elements, and such that no step in the algorithm causes an
+    &lt;span&gt;HTML parser&lt;/span&gt; to flag a &lt;span&gt;parse error&lt;/span&gt;:&lt;/p&gt;
+
     &lt;ol&gt;
 
-     &lt;li&gt;Let the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; be the parent
-     element of the &lt;code&gt;noscript&lt;/code&gt; element.&lt;/li&gt;
+     &lt;li&gt;Remove every &lt;code&gt;script&lt;/code&gt; element from the
+     document.&lt;/li&gt;
 
-     &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
-     that come before the &lt;code&gt;noscript&lt;/code&gt; element, and call these
-     elements &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt;.&lt;/li&gt;
+     &lt;li&gt;Make a list of every &lt;code&gt;noscript&lt;/code&gt; element in the
+     document. For every &lt;code&gt;noscript&lt;/code&gt; element in that list,
+     perform the following steps:
 
-     &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
-     that come &lt;em&gt;after&lt;/em&gt; the &lt;code&gt;noscript&lt;/code&gt; element, and
-     call these elements &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt;.&lt;/li&gt;
+      &lt;ol&gt;
 
-     &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;s&lt;/var&gt; be the concatenation of all the
-     &lt;span&gt;text node&lt;/span&gt; children of the &lt;code&gt;noscript&lt;/code&gt;
-     element.&lt;/li&gt;
+       &lt;li&gt;Let the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; be the parent
+       element of the &lt;code&gt;noscript&lt;/code&gt; element.&lt;/li&gt;
 
-     &lt;li&gt;Set the &lt;code title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt;
-     attribute of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; to the value
-     of &lt;var title=&quot;&quot;&gt;s&lt;/var&gt;. (This, as a side-effect, causes the
-     &lt;code&gt;noscript&lt;/code&gt; element to be removed from the
-     document.)&lt;/li&gt;
+       &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
+       that come before the &lt;code&gt;noscript&lt;/code&gt; element, and call these
+       elements &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt;.&lt;/li&gt;
 
-     &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt; at the start of
-     the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
-     relative order.&lt;/li&gt;
+       &lt;li&gt;Take all the children of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;
+       that come &lt;em&gt;after&lt;/em&gt; the &lt;code&gt;noscript&lt;/code&gt; element, and
+       call these elements &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt;.&lt;/li&gt;
 
-     &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt; at the end of the
-     &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
-     relative order.&lt;/li&gt;
+       &lt;li&gt;Let &lt;var title=&quot;&quot;&gt;s&lt;/var&gt; be the concatenation of all the
+       &lt;span&gt;text node&lt;/span&gt; children of the &lt;code&gt;noscript&lt;/code&gt;
+       element.&lt;/li&gt;
 
+       &lt;li&gt;Set the &lt;code title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt;
+       attribute of the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt; to the value
+       of &lt;var title=&quot;&quot;&gt;s&lt;/var&gt;. (This, as a side-effect, causes the
+       &lt;code&gt;noscript&lt;/code&gt; element to be removed from the
+       document.)&lt;/li&gt;
+
+       &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the before children&lt;/var&gt; at the start of
+       the &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
+       relative order.&lt;/li&gt;
+
+       &lt;li&gt;Insert &lt;var title=&quot;&quot;&gt;the after children&lt;/var&gt; at the end of the
+       &lt;var title=&quot;&quot;&gt;parent element&lt;/var&gt;, preserving their original
+       relative order.&lt;/li&gt;
+
+      &lt;/ol&gt;
+
+     &lt;/li&gt;
+
     &lt;/ol&gt;
 
-   &lt;/li&gt;
+   &lt;/dd&gt;
 
-  &lt;/ol&gt;
+  &lt;/dl&gt;
 
-  &lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element has no other requirements. In
-  particular, children of the &lt;code&gt;noscript&lt;/code&gt; element are not
-  exempt from form submission, scripting, and so forth, even when the
-  element is &lt;span&gt;with script&lt;/span&gt;.&lt;/p&gt;
-
   &lt;p class=&quot;note&quot;&gt;All these contortions are required because, for
   historical reasons, the &lt;code&gt;noscript&lt;/code&gt; element is handled
   differently by the &lt;span&gt;HTML parser&lt;/span&gt; based on whether &lt;span
@@ -10429,13 +10492,22 @@
   XML the parser is not affected by such state, and thus the element
   would not have the desired effect.&lt;/p&gt;
 
-  &lt;p class=&quot;note&quot;&gt;The &lt;code&gt;noscript&lt;/code&gt; element interacts poorly
-  with the &lt;code title=&quot;dom-document-designMode&quot;&gt;designMode&lt;/code&gt;
-  feature. Authors are encouraged to not use &lt;code&gt;noscript&lt;/code&gt;
-  elements on pages that will have &lt;code
-  title=&quot;dom-document-designMode&quot;&gt;designMode&lt;/code&gt; enabled.&lt;/p&gt;
+  &lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element must not be used in &lt;span&gt;XML
+  documents&lt;/span&gt;.&lt;/p&gt;
 
+  &lt;p class=&quot;note&quot;&gt;&lt;strong&gt;The &lt;code&gt;noscript&lt;/code&gt; element is only
+  effective in the &lt;span&gt;HTML serialization&lt;/span&gt;&lt;!-- XXX xref --&gt;,
+  it has no effect in the &lt;span&gt;XML serialization&lt;/span&gt;&lt;!-- XXX xref
+  --&gt;.&lt;/strong&gt;&lt;/p&gt;
 
+  &lt;p&gt;The &lt;code&gt;noscript&lt;/code&gt; element has no other requirements. In
+  particular, children of the &lt;code&gt;noscript&lt;/code&gt; element are not
+  exempt from form submission, scripting, and so forth, even when
+  &lt;span title=&quot;concept-n-script&quot;&gt;scripting is enabled&lt;/span&gt; for the
+  element.&lt;/p&gt;
+
+
+
   &lt;h4&gt;The &lt;dfn&gt;&lt;code&gt;eventsource&lt;/code&gt;&lt;/dfn&gt; element&lt;/h4&gt;
 
   &lt;dl class=&quot;element&quot;&gt;
@@ -15596,7 +15668,7 @@
 
   &lt;p class=&quot;note&quot;&gt;The value of &lt;code
   title=&quot;dom-img-complete&quot;&gt;complete&lt;/code&gt; can thus change while a
-  script is executing.&lt;/p&gt;
+  &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; is executing.&lt;/p&gt;
 
   &lt;p&gt;Three constructors are provided for creating
   &lt;code&gt;HTMLImageElement&lt;/code&gt; objects (in addition to the factory
@@ -16695,6 +16767,12 @@
 
   &lt;dl&gt;
 
+   &lt;!-- XXX disallow cross-origin loads of any kind (networking
+        override that only allows same-origin URLs or about:,
+        javascript:, data:) --&gt;
+   &lt;!-- XXX block access to 'contentWindow.frames' from iframe owner --&gt;
+   &lt;!-- XXX block access to 'parent.frames' from sandbox --&gt;
+
    &lt;dt&gt;The &lt;dfn&gt;sandboxed navigation browsing context flag&lt;/dfn&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -20049,14 +20127,15 @@
 
   &lt;p&gt;The &lt;dfn title=&quot;attr-media-controls&quot;&gt;&lt;code&gt;controls&lt;/code&gt;&lt;/dfn&gt;
   attribute is a &lt;span&gt;boolean attribute&lt;/span&gt;. If the attribute is
-  present, or if the &lt;span&gt;media element&lt;/span&gt; is &lt;span&gt;without
-  script&lt;/span&gt;, then the user agent should &lt;dfn&gt;expose a user
-  interface to the user&lt;/dfn&gt;. This user interface should include
-  features to begin playback, pause playback, seek to an arbitrary
-  position in the content (if the content supports arbitrary seeking),
-  change the volume, and show the media content in manners more
-  suitable to the user (e.g. full-screen video or in an independent
-  resizable window). Other controls may also be made available.&lt;/p&gt;
+  present, or if &lt;span title=&quot;concept-n-noscript&quot;&gt;scripting is
+  disabled&lt;/span&gt; for the &lt;span&gt;media element&lt;/span&gt;, then the user
+  agent should &lt;dfn&gt;expose a user interface to the user&lt;/dfn&gt;. This
+  user interface should include features to begin playback, pause
+  playback, seek to an arbitrary position in the content (if the
+  content supports arbitrary seeking), change the volume, and show the
+  media content in manners more suitable to the user (e.g. full-screen
+  video or in an independent resizable window). Other controls may
+  also be made available.&lt;/p&gt;
 
   &lt;p&gt;If the attribute is absent, then the user agent should avoid
   making a user interface available that could conflict with an
@@ -20370,8 +20449,9 @@
   element. The contents of the &lt;code&gt;canvas&lt;/code&gt; element, if any,
   are the element's &lt;span&gt;fallback content&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;In interactive visual media, if the &lt;code&gt;canvas&lt;/code&gt; element
-  is &lt;span&gt;with script&lt;/span&gt;, the &lt;code&gt;canvas&lt;/code&gt; element
+  &lt;p&gt;In interactive visual media, if &lt;span
+  title=&quot;concept-n-script&quot;&gt;scripting is enabled&lt;/span&gt; for the
+  &lt;code&gt;canvas&lt;/code&gt; element, the &lt;code&gt;canvas&lt;/code&gt; element
   represents an embedded element with a dynamically created image.&lt;/p&gt;
 
   &lt;p&gt;In non-interactive, static, visual media, if the
@@ -20383,10 +20463,10 @@
   size. Otherwise, the element represents its &lt;span&gt;fallback
   content&lt;/span&gt; instead.&lt;/p&gt;
 
-  &lt;p&gt;In non-visual media, and in visual media if the
-  &lt;code&gt;canvas&lt;/code&gt; element is &lt;span&gt;without script&lt;/span&gt;, the
-  &lt;code&gt;canvas&lt;/code&gt; element represents its &lt;span&gt;fallback
-  content&lt;/span&gt; instead.&lt;/p&gt;
+  &lt;p&gt;In non-visual media, and in visual media if &lt;span
+  title=&quot;concept-n-noscript&quot;&gt;scripting is disabled&lt;/span&gt; for the
+  &lt;code&gt;canvas&lt;/code&gt; element, the &lt;code&gt;canvas&lt;/code&gt; element
+  represents its &lt;span&gt;fallback content&lt;/span&gt; instead.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code&gt;canvas&lt;/code&gt; element has two attributes to control the
   size of the coordinate space: &lt;dfn
@@ -37230,6 +37310,7 @@
           <A HREF="http://www.mozilla.org/docs/dom/domref/dom_window_ref.html">http://www.mozilla.org/docs/dom/domref/dom_window_ref.html</A>
           <A HREF="http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindow.idl">http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindow.idl</A> - scrollBy, etc
           <A HREF="http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindowInternal.idl">http://lxr.mozilla.org/mozilla/source/dom/public/idl/base/nsIDOMWindowInternal.idl</A> - DOM level 0
+      close() focus() blur()
    --&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-window&quot;&gt;&lt;code&gt;window&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn
@@ -37237,7 +37318,7 @@
   title=&quot;dom-self&quot;&gt;&lt;code&gt;self&lt;/code&gt;&lt;/dfn&gt; DOM attributes must all
   return the &lt;code&gt;Window&lt;/code&gt; object itself.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;code&gt;Window&lt;/code&gt; object also provides the scope for script
+  &lt;p&gt;The &lt;code&gt;Window&lt;/code&gt; object also provides the scope for &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt;
   execution. Each &lt;code&gt;Document&lt;/code&gt; in a &lt;span&gt;browsing
   context&lt;/span&gt; has an associated &lt;dfn&gt;list of added properties&lt;/dfn&gt;
   that, when a document is &lt;span title=&quot;active
@@ -37343,9 +37424,10 @@
   enabled&lt;/span&gt;; otherwise, it must not be enabled unless the
   &lt;span&gt;browsing context&lt;/span&gt; was just created as part of the
   &lt;span&gt;the rules for choosing a browsing context given a browsing
-  context name&lt;/span&gt;. The navigation must be done with the
-  &lt;span&gt;script browsing context&lt;/span&gt; of the script that invoked the
-  method as the &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
+  context name&lt;/span&gt;. The navigation must be done with the &lt;span
+  title=&quot;script's browsing context&quot;&gt;browsing context&lt;/span&gt; of the
+  &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that invoked the method as the &lt;span&gt;source browsing
+  context&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;The method must return the &lt;code&gt;Window&lt;/code&gt; object of the
   default view of the &lt;span&gt;browsing context&lt;/span&gt; that was
@@ -37378,6 +37460,44 @@
 
 
 
+  &lt;h4&gt;Garbage collection and browsing contexts&lt;/h4&gt;
+
+  &lt;p&gt;A &lt;span&gt;browsing context&lt;/span&gt; has a strong reference to each of
+  its &lt;code&gt;Document&lt;/code&gt;s and &lt;span title=&quot;view&quot;&gt;views&lt;/span&gt;, and
+  the user agent itself has a strong reference to its &lt;span
+  title=&quot;top-level browsing context&quot;&gt;top-level browsing
+  contexts&lt;/span&gt;.&lt;/p&gt;
+
+  &lt;p&gt;When a &lt;span&gt;browsing context&lt;/span&gt; is to &lt;dfn&gt;discard a
+  &lt;code&gt;Document&lt;/code&gt;&lt;/dfn&gt;, that means that it is to lose the
+  strong reference from the &lt;code&gt;Document&lt;/code&gt;'s &lt;span&gt;browsing
+  context&lt;/span&gt; to the &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
+
+  &lt;p class=&quot;note&quot;&gt;The &lt;span&gt;browsing context&lt;/span&gt;'s &lt;span&gt;default
+  view&lt;/span&gt;'s &lt;code&gt;Window&lt;/code&gt; object &lt;span title=&quot;implied strong
+  reference&quot;&gt;has a strong reference of its own&lt;/span&gt; to the
+  &lt;code&gt;Document&lt;/code&gt; object of the &lt;span&gt;browsing context&lt;/span&gt;'s
+  &lt;span&gt;active document&lt;/span&gt;.&lt;/p&gt;
+
+  &lt;p&gt;When &lt;dfn&gt;a &lt;em&gt;&lt;span&gt;browsing context&lt;/span&gt;&lt;/em&gt; is
+  discarded&lt;/dfn&gt;, the strong reference from the user agent itself to
+  the &lt;span&gt;browsing context&lt;/span&gt; must be severed, and all the
+  &lt;code&gt;Document&lt;/code&gt; objects for all the entries in the
+  &lt;span&gt;browsing context&lt;/span&gt;'s session history must be &lt;span
+  title=&quot;discard a document&quot;&gt;discarded&lt;/span&gt; as well.&lt;/p&gt;
+
+  &lt;p&gt;User agents may &lt;span title=&quot;a browsing context is
+  discarded&quot;&gt;discard&lt;/span&gt; &lt;span title=&quot;top-level browsing
+  context&quot;&gt;top-level browsing contexts&lt;/span&gt; at any time (typically,
+  in response to user requests, e.g. when a user closes a window
+  containing one or more &lt;span title=&quot;top-level browsing
+  context&quot;&gt;top-level browsing contexts&lt;/span&gt;). Other &lt;span
+  title=&quot;browsing context&quot;&gt;browsing contexts&lt;/span&gt; must be discarded
+  once their &lt;code&gt;Window&lt;/code&gt; object is eligible for garbage
+  collection.&lt;/p&gt;
+
+
+
   &lt;h3&gt;Origin&lt;/h3&gt;
   &lt;!-- Hallowed are the Ori --&gt;
 
@@ -37871,6 +37991,8 @@
 
   &lt;h3 id=&quot;scripting&quot;&gt;Scripting&lt;/h3&gt;
 
+  &lt;h4&gt;Introduction&lt;/h4&gt;
+
   &lt;p&gt;Various mechanisms can cause author-provided executable code to
   run in the context of a document. These mechanisms include, but are
   probably not limited to:&lt;/p&gt;
@@ -37895,91 +38017,293 @@
 
   &lt;/ul&gt;
 
-  &lt;p&gt;When a script is created&lt;!-- which is marked by SCRIPT EXEC in
-  this spec --&gt;, it is associated with a &lt;span&gt;script execution
-  context&lt;/span&gt;, a &lt;span&gt;script browsing context&lt;/span&gt;, and a
-  &lt;span&gt;script document context&lt;/span&gt;.&lt;/p&gt;
 
 
 
-  &lt;!-- SCRIPT EXEC --&gt;
-  &lt;h4&gt;Script execution contexts&lt;/h4&gt;
+  &lt;h4&gt;Enabling and disabling scripting&lt;/h4&gt;
 
-  &lt;p&gt;The &lt;dfn&gt;script execution context&lt;/dfn&gt; of a script is defined
-  when that script is created. In this specification, it is either a
-  &lt;code&gt;Window&lt;/code&gt; object or an empty object; other specifications
-  might make the script execution context be some other object.&lt;/p&gt;
+  &lt;p&gt;&lt;dfn title=&quot;concept-bc-script&quot;&gt;Scripting is enabled&lt;/dfn&gt; in a
+  &lt;em&gt;&lt;span&gt;browsing context&lt;/span&gt;&lt;/em&gt; when all of the
+  following conditions are true:&lt;/p&gt;
 
-  &lt;p&gt;When the &lt;span&gt;script execution context&lt;/span&gt; of a script is an
-  empty object, it can't do anything that interacts with the
-  environment.&lt;/p&gt;
+  &lt;ul&gt;
 
-  &lt;p&gt;A &lt;span&gt;script execution context&lt;/span&gt; always has an associated
-  &lt;span&gt;browsing context&lt;/span&gt;, known as the &lt;dfn&gt;script browsing
-  context&lt;/dfn&gt;. If the &lt;span&gt;script execution context&lt;/span&gt; is a
-  &lt;code&gt;Window&lt;/code&gt; object, then that object's &lt;span&gt;browsing
-  context&lt;/span&gt; is it. Otherwise, the &lt;span&gt;script execution
-  context&lt;/span&gt; is associated explicitly with a &lt;span&gt;browsing
-  context&lt;/span&gt; when it is created.&lt;/p&gt;
+   &lt;li&gt;The user agent supports scripting.&lt;/li&gt;
 
-  &lt;p&gt;Every script whose &lt;span&gt;script execution context&lt;/span&gt; is a
-  &lt;code&gt;Window&lt;/code&gt; object is also associated with a
-  &lt;code&gt;Document&lt;/code&gt; object, known as its &lt;dfn&gt;script document
-  context&lt;/dfn&gt;. It is used to &lt;span title=&quot;resolve a
-  url&quot;&gt;resolve&lt;/span&gt; URLs. The document is assigned when the script
-  is created, as with the &lt;span&gt;script browsing context&lt;/span&gt;.&lt;/p&gt;
+   &lt;li&gt;The user has not disabled scripting for this &lt;span&gt;browsing
+   context&lt;/span&gt; at this time. (User agents may provide users with
+   the option to disable scripting globally, or in a finer-grained
+   manner, e.g. on a per-origin basis.)&lt;/li&gt;
 
+   &lt;li id=&quot;sandboxScriptBlocked&quot;&gt;The &lt;span&gt;browsing context&lt;/span&gt;
+   does not have the &lt;span&gt;sandboxed scripts browsing context
+   flag&lt;/span&gt; set.&lt;/li&gt;
+
+  &lt;/ul&gt;
+
+  &lt;p&gt;&lt;dfn title=&quot;concept-bc-noscript&quot;&gt;Scripting is disabled&lt;/dfn&gt; in a
+  &lt;span&gt;browsing context&lt;/span&gt; when any of the above conditions are
+  false (i.e. when scripting is not &lt;span
+  title=&quot;concept-bc-script&quot;&gt;enabled&lt;/span&gt;).&lt;/p&gt;
+
   &lt;hr&gt;
 
-  &lt;p&gt;It is said that &lt;dfn&gt;scripting is disabled&lt;/dfn&gt; in a
-  &lt;span&gt;script execution context&lt;/span&gt; when any of the following
-  conditions are true:&lt;/p&gt;
+  &lt;p&gt;&lt;dfn title=&quot;concept-n-script&quot;&gt;Scripting is enabled&lt;/dfn&gt; for a
+  &lt;em&gt;node&lt;/em&gt; if the &lt;code&gt;Document&lt;/code&gt; object of the node (the
+  node itself, if it is itself a &lt;code&gt;Document&lt;/code&gt; object) has an
+  associated &lt;span&gt;browsing context&lt;/span&gt;, and &lt;span
+  title=&quot;concept-bc-script&quot;&gt;scripting is enabled&lt;/span&gt; in that
+  &lt;span&gt;browsing context&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;ul&gt;
+  &lt;p&gt;&lt;dfn title=&quot;concept-n-noscript&quot;&gt;Scripting is disabled&lt;/dfn&gt; for a
+  node if there is no such &lt;span&gt;browsing context&lt;/span&gt;, or if &lt;span
+  title=&quot;concept-bc-noscript&quot;&gt;scripting is disabled&lt;/span&gt; in that
+  &lt;span&gt;browsing context&lt;/span&gt;.&lt;/p&gt;
 
-   &lt;li&gt;The user agent does not support scripting.&lt;/li&gt;
 
-   &lt;li&gt;The user has disabled scripting for this &lt;span&gt;script execution
-   context&lt;/span&gt;. (User agents may provide users with the option to
-   disable scripting globally, on a per-origin basis, or in other ways
-   down to the granularity of individual &lt;span title=&quot;script execution
-   context&quot;&gt;script execution contexts&lt;/span&gt;.)&lt;/li&gt;
 
-   &lt;li id=&quot;designModeScriptBlocked&quot;&gt;The &lt;span&gt;script execution
-   context&lt;/span&gt;'s associated &lt;span&gt;browsing context&lt;/span&gt;'s
-   &lt;span&gt;active document&lt;/span&gt; has &lt;code
-   title=&quot;dom-document-designMode&quot;&gt;designMode&lt;/code&gt; enabled.&lt;/li&gt;
+  &lt;!-- SCRIPT EXEC (marks areas related to creation of scripts) --&gt;
+  &lt;h4&gt;Processing model&lt;/h4&gt;
 
-   &lt;li id=&quot;sandboxScriptBlocked&quot;&gt;The &lt;span&gt;script execution
-   context&lt;/span&gt;'s associated &lt;span&gt;browsing context&lt;/span&gt; has the
-   &lt;span&gt;sandboxed scripts browsing context flag&lt;/span&gt; set.&lt;/li&gt;
+  &lt;h5&gt;Definitions&lt;/h5&gt;
 
-  &lt;/ul&gt;
+  &lt;p&gt;A &lt;dfn title=&quot;concept-script&quot;&gt;script&lt;/dfn&gt; has:&lt;/p&gt;
 
-  &lt;p&gt;A node is said to be &lt;dfn&gt;without script&lt;/dfn&gt; if either the
-  &lt;code&gt;Document&lt;/code&gt; object of the node (the node itself, if it is
-  itself a &lt;code&gt;Document&lt;/code&gt; object) does not have an associated
-  &lt;span&gt;browsing context&lt;/span&gt;, or &lt;span&gt;scripting is disabled&lt;/span&gt;
-  in that &lt;span&gt;browsing context&lt;/span&gt;.&lt;/p&gt;
+  &lt;dl&gt;
 
-  &lt;p&gt;A node is said to be &lt;dfn&gt;with script&lt;/dfn&gt; if it is not
-  &lt;span&gt;without script&lt;/span&gt;.&lt;/p&gt;
+   &lt;dt&gt;A &lt;dfn&gt;script execution environment&lt;/dfn&gt;&lt;/dt&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;If you can find a better pair of terms than
-  &quot;with script&quot; and &quot;without script&quot; let me know. The only things I
-  can find that are less confusing are also way, way longer.&lt;/p&gt;
+   &lt;dd&gt;
 
-  &lt;p&gt;When a script is to be executed in a &lt;span&gt;script execution
-  context&lt;/span&gt; in which &lt;span&gt;scripting is disabled&lt;/span&gt;, the
-  script must do nothing and return nothing (a void return value).&lt;/p&gt;
+    &lt;p&gt;The characteristics of the script execution environment depend
+    on the language, and are not defined by this specification.&lt;/p&gt;
 
-  &lt;p class=&quot;note&quot;&gt;Thus, for instance, enabling &lt;code
-  title=&quot;dom-document-designMode&quot;&gt;designMode&lt;/code&gt; will disable any
-  event handler attributes, event listeners, timeouts, etc, that were
-  set by scripts in the document.&lt;/p&gt;
+    &lt;p class=&quot;example&quot;&gt;In JavaScript, the script execution environment
+    consists of the interpreter, the stack of &lt;i&gt;execution
+    contexts&lt;/i&gt;, the &lt;i&gt;global code&lt;/i&gt; and &lt;i&gt;function code&lt;/i&gt; and
+    the Function objects resulting, and so forth.&lt;/p&gt;
 
+   &lt;/dd&gt;
 
+   &lt;dt&gt;A &lt;dfn&gt;list of code entry-points&lt;/dfn&gt;&lt;/dt&gt;
 
+   &lt;dd&gt;
+
+    &lt;p&gt;Each code entry-point represents a block of executable code
+    that the script exposes to other scripts and to the user
+    agent.&lt;/p&gt;
+
+    &lt;p class=&quot;example&quot;&gt;Each Function object in a JavaScript
+    &lt;span&gt;script execution environment&lt;/span&gt; has a corresponding code
+    entry-point, for instance.&lt;/p&gt;
+
+    &lt;p&gt;The main program code of the script, if any, is the
+    &lt;dfn&gt;&lt;i&gt;initial code entry-point&lt;/i&gt;&lt;/dfn&gt;. Typically, the code
+    corresponding to this entry-point is executed immediately after
+    the script is parsed.&lt;/p&gt;
+
+    &lt;p class=&quot;example&quot;&gt;In JavaScript, this corresponds to the
+    execution context of the global code.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A relationship with the &lt;dfn&gt;script's global object&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;An object that provides the APIs that the code can use.&lt;/p&gt;
+
+    &lt;p class=&quot;example&quot;&gt;This is typically a &lt;code&gt;Window&lt;/code&gt;
+    object. In JavaScript, this corresponds to the &lt;i&gt;global
+    object&lt;/i&gt;.&lt;/p&gt;
+
+    &lt;p class=&quot;note&quot;&gt;When a &lt;span&gt;script's global object&lt;/span&gt; is an
+    empty object, it can't do anything that interacts with the
+    environment.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A relationship with the &lt;dfn&gt;script's browsing context&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A &lt;span&gt;browsing context&lt;/span&gt; that is assigned responsibility
+    for actions taken by the script.&lt;/p&gt;
+
+    &lt;p class=&quot;example&quot;&gt;When a script creates and &lt;span
+    title=&quot;navigate&quot;&gt;navigates&lt;/span&gt; a new &lt;span&gt;top-level browsing
+    context&lt;/span&gt;, the &lt;code title=&quot;dom-opener&quot;&gt;opener&lt;/code&gt;
+    attribute of the new &lt;span&gt;browsing context&lt;/span&gt;'s
+    &lt;code&gt;Window&lt;/code&gt; object will be set to the &lt;span&gt;script's
+    browsing context&lt;/span&gt;'s &lt;code&gt;Window&lt;/code&gt; object.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A &lt;dfn title=&quot;script's character encoding&quot;&gt;character encoding&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A character encoding, set when the script is created, used to
+    encode URLs.  &lt;span id=&quot;sce-not-copy&quot;&gt;If the character encoding is
+    set from another source, e.g. a &lt;span&gt;document's character
+    encoding&lt;/span&gt;, then the &lt;span&gt;script's character encoding&lt;/span&gt;
+    must follow the source, so that if the source's changes, so does
+    the script's.&lt;/span&gt;&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;A &lt;dfn title=&quot;script's base URL&quot;&gt;base URL&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt;, set when the script is created, used to
+    resolve relative URLs. &lt;span id=&quot;sbu-not-copy&quot;&gt;If the base URL is
+    set from another source, e.g. a &lt;span&gt;document base URL&lt;/span&gt;,
+    then the &lt;span&gt;script's base URL&lt;/span&gt; must follow the source, so
+    that if the source's changes, so does the script's.&lt;/span&gt;&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;Membership in a &lt;dfn&gt;script group&lt;/dfn&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;A group of one or more scripts that are loaded in the same
+    context, which are always disabled as a group. Scripts in a script
+    group all have the same &lt;span title=&quot;script's global
+    object&quot;&gt;global object&lt;/span&gt; and &lt;span title=&quot;script's browsing
+    context&quot;&gt;browsing context&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;p&gt;A script group can be &lt;i&gt;frozen&lt;/i&gt;. When a script group is
+    frozen, any code defined in that script group will throw an
+    exception when invoked. A frozen script group can be
+    &lt;i&gt;unfrozen&lt;/i&gt;, allowing scripts in that script group to run
+    normally again.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+
+  &lt;h5&gt;Calling scripts&lt;/h5&gt;
+
+  &lt;p&gt;When a user agent is to &lt;dfn&gt;jump to a code entry-point&lt;/dfn&gt; for
+  a &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt;, if &lt;span
+  title=&quot;concept-bc-noscript&quot;&gt;scripting is disabled&lt;/span&gt; in the
+  &lt;span&gt;script's browsing context&lt;/span&gt;, or if the script's
+  &lt;span&gt;script group&lt;/span&gt; is &lt;i&gt;frozen&lt;/i&gt;, then the user agent must
+  throw an &lt;code&gt;UNAVAILABLE_SCRIPT_ERR&lt;/code&gt; exception. Otherwise,
+  the &lt;span title=&quot;script execution environment&quot;&gt;script execution
+  environment&lt;/span&gt; for the &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt; must execute the code for the
+  given code entry-point.&lt;/p&gt;
+
+  &lt;p&gt;When executable code in one &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt; makes a call to another &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt;, the user agent must &lt;span
+  title=&quot;jump to a code entry-point&quot;&gt;jump&lt;/span&gt; to the corresponding
+  code entry-point in that second script.&lt;/p&gt;
+
+  &lt;p&gt;Any time the user agent to invoke a callback defined in a &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt;, the user agent must &lt;span
+  title=&quot;jump to a code entry-point&quot;&gt;jump&lt;/span&gt; to the corresponding
+  code entry-point in that second script.&lt;/p&gt;
+
+
+
+  &lt;h5&gt;Creating scripts&lt;/h5&gt;
+
+  &lt;p&gt;When the specification says that a &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt; is to be &lt;dfn title=&quot;create a
+  script&quot;&gt;created&lt;/dfn&gt;, given some script source, its scripting
+  language, a global object, a browsing context, a character encoding,
+  a base URL, and a script group, the user agent must run the
+  following steps:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;Set up a &lt;span&gt;script execution environment&lt;/span&gt; as
+   appropriate for the scripting language.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Parse/compile/initialise the source of the script using the
+   &lt;span&gt;script execution environment&lt;/span&gt;, as appropriate for the
+   scripting language, and thus obtain the &lt;span&gt;list of code
+   entry-points&lt;/span&gt; for the script. If the semantics of the
+   scripting language and the given source code are such that there is
+   executable code to be immediately run, then the &lt;i&gt;initial code
+   entry-point&lt;/i&gt; is the entry-point for that code.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set up the &lt;span&gt;script's global object&lt;/span&gt;, the
+   &lt;span&gt;script's browsing context&lt;/span&gt;, the &lt;span&gt;script's
+   character encoding&lt;/span&gt;, and the &lt;span&gt;script's base URL&lt;/span&gt;
+   from the settings passed to this algorithm.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Add the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; to the given &lt;span&gt;script
+   group&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;span title=&quot;jump to a code entry-point&quot;&gt;Jump&lt;/span&gt; to the
+   &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt;'s &lt;i&gt;initial code
+   entry-point&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;hr&gt;
+
+  &lt;p&gt;When the user agent is to &lt;dfn&gt;create an impotent script&lt;/dfn&gt;,
+  given some script source, its scripting language, and a browsing
+  context, the user agent must &lt;span&gt;create a script&lt;/span&gt;, using the
+  given script source and scripting language, using a new empty object
+  as the global object, using the given browsing context as the
+  browsing context, and using a new script group as the script
+  group. The character encoding and base URL for the resulting &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt; are not important as no APIs
+  are exposed to the script.&lt;/p&gt;
+
+  &lt;hr&gt;
+
+  &lt;p&gt;When the specification says that a &lt;span
+  title=&quot;concept-script&quot;&gt;script&lt;/span&gt; is to be &lt;dfn title=&quot;create a
+  script from a node&quot;&gt;created from a node&lt;/dfn&gt; &lt;var
+  title=&quot;&quot;&gt;node&lt;/var&gt;, given some script source and its scripting
+  language, the user agent &lt;span&gt;create a script&lt;/span&gt;, using the
+  given script source and scripting language, and using &lt;span&gt;the
+  script settings determined from the node&lt;/span&gt; &lt;var
+  title=&quot;&quot;&gt;node&lt;/var&gt;.&lt;/p&gt;
+
+  &lt;p&gt;&lt;dfn&gt;The script settings determined from the node&lt;/dfn&gt; &lt;var
+  title=&quot;&quot;&gt;node&lt;/var&gt; are computed as follows:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;document&lt;/var&gt; be the
+   &lt;code&gt;Document&lt;/code&gt; of &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; (or &lt;var
+   title=&quot;&quot;&gt;node&lt;/var&gt; itself if it is a
+   &lt;code&gt;Document&lt;/code&gt;).&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The browsing context is the &lt;span&gt;browsing context&lt;/span&gt; of
+   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;The global object is the &lt;code&gt;Window&lt;/code&gt; object of the
+   &lt;span&gt;default view&lt;/span&gt; of the &lt;span&gt;browsing context&lt;/span&gt; of
+   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The character encoding is the &lt;span title=&quot;document's
+   character encoding&quot;&gt;character encoding&lt;/span&gt; of &lt;var
+   title=&quot;&quot;&gt;document&lt;/var&gt;. (&lt;a href=&quot;#sce-not-copy&quot;&gt;This is a
+   reference, not a copy&lt;/a&gt;.)&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The base URL is the &lt;span title=&quot;document base URL&quot;&gt;base
+   URL&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;. (&lt;a
+   href=&quot;#sbu-not-copy&quot;&gt;This is a reference, not a copy&lt;/a&gt;.)&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The script group is the &lt;span&gt;current script group&lt;/span&gt; of
+   &lt;var title=&quot;&quot;&gt;document&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+
+
   &lt;h4&gt;Event loops&lt;/h4&gt;
 
   &lt;p&gt;To coordinate events, user interaction, scripts, rendering,
@@ -38044,6 +38368,17 @@
 
   &lt;/dl&gt;
 
+  &lt;p&gt;Each &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; is associated with a
+  &lt;code&gt;Document&lt;/code&gt;; if the task was queued in the context of an
+  element, then it is the element's &lt;code&gt;Document&lt;/code&gt;; if the task
+  was queued in the context of a &lt;span&gt;browsing context&lt;/span&gt;, then
+  it is the &lt;span&gt;browsing context&lt;/span&gt;'a &lt;span&gt;active
+  document&lt;/span&gt; at the time the task was queued; if the task was
+  queued by or for a &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; then
+  the document is the script's &lt;span&gt;script's browsing
+  context&lt;/span&gt;'s &lt;span&gt;active document&lt;/span&gt; at the time the task
+  was queued.&lt;/p&gt;
+
   &lt;p&gt;When a user agent is to &lt;dfn&gt;queue a task&lt;/dfn&gt;, it must add the
   given task to one of the &lt;span title=&quot;task queue&quot;&gt;task queues&lt;/span&gt;
   of the relevant &lt;span&gt;event loop&lt;/span&gt;. All the tasks from one
@@ -38069,8 +38404,10 @@
   &lt;ol&gt;
 
    &lt;li&gt;&lt;p&gt;Run the oldest task on one of the &lt;span&gt;event loop&lt;/span&gt;'s
-   &lt;span title=&quot;task queue&quot;&gt;task queues&lt;/span&gt;. The user agent may
-   pick any &lt;span&gt;task queue&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;span title=&quot;task queue&quot;&gt;task queues&lt;/span&gt;, ignoring tasks whose
+   associated &lt;code&gt;Document&lt;/code&gt;s are not &lt;span title=&quot;active
+   document&quot;&gt;active&lt;/span&gt;. The user agent may pick any &lt;span&gt;task
+   queue&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Remove that task from its &lt;span&gt;task queue&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
@@ -38142,61 +38479,123 @@
   &lt;!-- SCRIPT EXEC --&gt;
   &lt;h4 id=&quot;javascript-protocol&quot;&gt;&lt;dfn title=&quot;javascript protocol&quot;&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol&lt;/dfn&gt;&lt;/h4&gt;
 
-  &lt;p&gt;A URL using the &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol must,
-  if and when &lt;dfn title=&quot;concept-js-deref&quot;&gt;dereferenced&lt;/dfn&gt;, be
-  evaluated by executing the script obtained using the content
-  retrieval operation defined for &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt;
-  URLs. &lt;a href=&quot;#refsJSURL&quot;&gt;[JSURL]&lt;/a&gt;&lt;/p&gt;
+  &lt;p&gt;When a &lt;span&gt;URL&lt;/span&gt; using the &lt;code
+  title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol is &lt;dfn
+  title=&quot;concept-js-deref&quot;&gt;dereferenced&lt;/dfn&gt;, the user agent must run
+  the following steps:&lt;/p&gt;
 
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;Let the script source be the string obtained using the
+   content retrieval operation defined for &lt;code
+   title=&quot;&quot;&gt;javascript:&lt;/code&gt; URLs. &lt;a
+   href=&quot;#refsJSURL&quot;&gt;[JSURL]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
+
 &lt;!--
 JSURL: <A HREF="http://ietfreport.isoc.org/all-ids/draft-hoehrmann-javascript-scheme-00.txt">http://ietfreport.isoc.org/all-ids/draft-hoehrmann-javascript-scheme-00.txt</A> and
        <A HREF="http://www.websitedev.de/ietf/draft-hoehrmann-javascript-scheme-00.txt">http://www.websitedev.de/ietf/draft-hoehrmann-javascript-scheme-00.txt</A> should be as stable as it gets,
        <A HREF="http://ietfreport.isoc.org/idref/draft-hoehrmann-javascript-scheme/">http://ietfreport.isoc.org/idref/draft-hoehrmann-javascript-scheme/</A> for the latest version
 --&gt;
 
-  &lt;p&gt;When a &lt;span&gt;browsing context&lt;/span&gt; is &lt;span
-  title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; to a &lt;code&gt;javascript:&lt;/code&gt; URL,
-  and the &lt;span&gt;active document&lt;/span&gt; of that browsing context has
-  the &lt;span&gt;same origin&lt;/span&gt; as the script given by that URL, the
-  &lt;span&gt;script execution context&lt;/span&gt; must be the
-  &lt;code&gt;Window&lt;/code&gt; object of the &lt;span&gt;browsing context&lt;/span&gt;
-  being navigated, and the &lt;span&gt;script document context&lt;/span&gt; must
-  be that &lt;span&gt;active document&lt;/span&gt;.&lt;/p&gt;
+   &lt;li&gt;
 
-  &lt;p&gt;When a &lt;span&gt;browsing context&lt;/span&gt; is &lt;span
-  title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; to a &lt;code&gt;javascript:&lt;/code&gt; URL,
-  and the &lt;span&gt;active document&lt;/span&gt; of that browsing context has an
-  &lt;span&gt;origin&lt;/span&gt; that is &lt;em&gt;not&lt;/em&gt; the &lt;span title=&quot;same
-  origin&quot;&gt;same&lt;/span&gt; as that of the script given by the URL, the
-  &lt;span&gt;script execution context&lt;/span&gt; must be an empty object, and
-  the &lt;span&gt;script browsing context&lt;/span&gt; must be the &lt;span&gt;browsing
-  context&lt;/span&gt; being &lt;span title=&quot;navigate&quot;&gt;navigated&lt;/span&gt;.&lt;/p&gt;
+    &lt;p&gt;Use the appropriate step from the following list:&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, if the &lt;code&gt;Document&lt;/code&gt; object of the element,
-  attribute, or style sheet from which the &lt;code&gt;javascript:&lt;/code&gt;
-  URL was reached has an associated &lt;span&gt;browsing context&lt;/span&gt;, the
-  &lt;span&gt;script execution context&lt;/span&gt; must be an empty object, and
-  the &lt;span&gt;script execution context&lt;/span&gt;'s associated
-  &lt;span&gt;browsing context&lt;/span&gt; must be that &lt;span&gt;browsing
-  context&lt;/span&gt;.&lt;/p&gt;
+    &lt;dl&gt;
 
-  &lt;p&gt;Otherwise, the script is not executed and its return value is
-  void.&lt;/p&gt;
+     &lt;dt&gt;If a &lt;span&gt;browsing context&lt;/span&gt; is being &lt;span
+     title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; to a &lt;code&gt;javascript:&lt;/code&gt;
+     URL, and the &lt;span&gt;active document&lt;/span&gt; of that browsing
+     context has the &lt;span&gt;same origin&lt;/span&gt; as the script given by
+     that URL&lt;/dt&gt;
 
-  &lt;p&gt;If the result of executing the script is void (there is no return
-  value), then the URL must be treated in a manner equivalent to an
-  HTTP resource with an HTTP 204 No Content response.&lt;/p&gt;
+     &lt;dd&gt;
 
-  &lt;p&gt;Otherwise, the URL must be treated in a manner equivalent to an
-  HTTP resource with a 200 OK response whose &lt;span
-  title=&quot;Content-Type&quot;&gt;Content-Type metadata&lt;/span&gt; is &lt;code
-  title=&quot;&quot;&gt;text/html&lt;/code&gt; and whose response body is the return
-  value converted to a string value.&lt;/p&gt;
+      &lt;p&gt;&lt;span title=&quot;create a script from a node&quot;&gt;Create a
+      script&lt;/span&gt; from the &lt;code&gt;Document&lt;/code&gt; node of the
+      &lt;span&gt;active document&lt;/span&gt;, using the aforementioned script
+      source, and assuming the scripting language is JavaScript.&lt;/p&gt;
 
-  &lt;p class=&quot;note&quot;&gt;Certain contexts, in particular &lt;code&gt;img&lt;/code&gt;
-  elements, ignore the &lt;span title=&quot;Content-Type&quot;&gt;Content-Type
-  metadata&lt;/span&gt;.&lt;/p&gt;
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the return value of the
+      &lt;i&gt;initial code entry-point&lt;/i&gt; of this &lt;span
+      title=&quot;concept-script&quot;&gt;script&lt;/span&gt;. If an exception was
+      raised, let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void instead.&lt;/p&gt;
 
+     &lt;/dd&gt;
+
+     &lt;dt&gt;If a &lt;span&gt;browsing context&lt;/span&gt; is being &lt;span
+     title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; to a &lt;code&gt;javascript:&lt;/code&gt;
+     URL, and the &lt;span&gt;active document&lt;/span&gt; of that browsing
+     context has an &lt;span&gt;origin&lt;/span&gt; that is &lt;em&gt;not&lt;/em&gt; the &lt;span
+     title=&quot;same origin&quot;&gt;same&lt;/span&gt; as that of the script given by
+     the URL&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;&lt;span&gt;Create an impotent script&lt;/span&gt; using the
+      aforementioned script source, with the scripting language set to
+      JavaScript, and with the &lt;span&gt;browsing context&lt;/span&gt; being
+      &lt;span title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; as the browsing
+      context.&lt;/p&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the return value of the
+      &lt;i&gt;initial code entry-point&lt;/i&gt; of this &lt;span
+      title=&quot;concept-script&quot;&gt;script&lt;/span&gt;. If an exception was
+      raised, let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void instead.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
+     &lt;dt&gt;If the &lt;code&gt;Document&lt;/code&gt; object of the element,
+     attribute, or style sheet from which the &lt;code&gt;javascript:&lt;/code&gt;
+     URL was reached has an associated &lt;span&gt;browsing
+     context&lt;/span&gt;&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;&lt;span&gt;Create an impotent script&lt;/span&gt; using the
+      aforementioned script source, with the scripting language set to
+      JavaScript, and with the &lt;code&gt;Document&lt;/code&gt;'s object's
+      &lt;span&gt;browsing context&lt;/span&gt; as the browsing context.&lt;/p&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be the return value of the
+      &lt;i&gt;initial code entry-point&lt;/i&gt; of this &lt;span
+      title=&quot;concept-script&quot;&gt;script&lt;/span&gt;. If an exception was
+      raised, let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void instead.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
+     &lt;dt&gt;Otherwise&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be void.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
+    &lt;/dl&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If the result of executing the script is void (there is no
+    return value), then the URL must be treated in a manner equivalent
+    to an HTTP resource with an HTTP 204 No Content response.&lt;/p&gt;
+
+    &lt;p&gt;Otherwise, the URL must be treated in a manner equivalent to an
+    HTTP resource with a 200 OK response whose &lt;span
+    title=&quot;Content-Type&quot;&gt;Content-Type metadata&lt;/span&gt; is &lt;code
+    title=&quot;&quot;&gt;text/html&lt;/code&gt; and whose response body is the return
+    value converted to a string value.&lt;/p&gt;
+
+    &lt;p class=&quot;note&quot;&gt;Certain contexts, in particular &lt;code&gt;img&lt;/code&gt;
+    elements, ignore the &lt;span title=&quot;Content-Type&quot;&gt;Content-Type
+    metadata&lt;/span&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;
+
   &lt;div class=&quot;example&quot;&gt;
 
    &lt;p&gt;So for example a &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; URL for a
@@ -38219,10 +38618,10 @@
 
   &lt;/div&gt;
 
-  &lt;p class=&quot;note&quot;&gt;The rules for handling script execution in a
-  &lt;span&gt;script execution context&lt;/span&gt; include making the script not
-  execute (and just return void) in certain cases, e.g. in a sandbox
-  or when the user has disabled scripting altogether.&lt;/p&gt;
+  &lt;p class=&quot;note&quot;&gt;The rules for &lt;span title=&quot;create a script&quot;&gt;creating
+  a script&lt;/span&gt; include making the script not execute (and just
+  return void) in certain cases, e.g. in a sandbox or when the user
+  has disabled scripting altogether.&lt;/p&gt;
 
 
   &lt;h4&gt;Events&lt;/h4&gt;
@@ -38241,24 +38640,26 @@
 
   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cscript%3E%0Aw(a%3Ddocument.implementation.createDocument(null%2C%20null%2C%20null">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cscript%3E%0Aw(a%3Ddocument.implementation.createDocument(null%2C%20null%2C%20null</A>))%3B%0Aw(a.appendChild(a.createElementNS('http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml'%2C%20'html')))%3B%0Aw(b%3Da.firstChild.appendChild(a.createElementNS('http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml'%2C%20'body')))%3B%0Aw(b.test%20%3D%20w)%3B%0Aw(b.setAttribute('onclick'%2C%20'test(%22fire%3A%20%22%20%2B%20event)'))%3B%0Aw(b.onclick)%3B%0Aw(e%3Da.createEvent('Event'))%3B%0Aw(e.initEvent('click'%2C%20false%2C%20false))%3B%0Aw(b.dispatchEvent(e))%3B%0A%3C%2Fscript%3E --&gt;
 
-  &lt;p&gt;&lt;span&gt;HTML elements&lt;/span&gt; can have &lt;dfn&gt;event handler
-  attributes&lt;/dfn&gt; specified. These act as bubbling event listeners
-  for the element on which they are specified.&lt;/p&gt;
+  &lt;p&gt;Many objects can have &lt;dfn&gt;event handler attributes&lt;/dfn&gt;
+  specified. These act as bubbling event listeners for the element on
+  which they are specified.&lt;/p&gt;
 
-  &lt;p&gt;Each event handler attribute has two parts, an &lt;span title=&quot;event
-  handler content attributes&quot;&gt;event handler content attribute&lt;/span&gt;
-  and an &lt;span title=&quot;event handler DOM attributes&quot;&gt;event handler DOM
-  attribute&lt;/span&gt;. Event handler attributes must initially be set to
-  null. When their value changes (through the changing of their event
-  handler content attribute or their event handler DOM attribute),
-  they will either be null, or have an &lt;code&gt;EventListener&lt;/code&gt;
-  object assigned to them.&lt;/p&gt;
+  &lt;p&gt;On &lt;span&gt;HTML elements&lt;/span&gt;, each event handler attribute has
+  two parts, an &lt;span title=&quot;event handler content attributes&quot;&gt;event
+  handler content attribute&lt;/span&gt; and an &lt;span title=&quot;event handler
+  DOM attributes&quot;&gt;event handler DOM attribute&lt;/span&gt;. Event handler
+  attributes must initially be set to null. When their value changes
+  (through the changing of their event handler content attribute or
+  their event handler DOM attribute), they will either be null, or
+  have an &lt;code&gt;EventListener&lt;/code&gt; object assigned to them.&lt;/p&gt;
 
   &lt;p&gt;Objects other than &lt;code&gt;Element&lt;/code&gt; objects, in particular
   &lt;code&gt;Window&lt;/code&gt;, only have &lt;span title=&quot;event handler DOM
   attributes&quot;&gt;event handler DOM attribute&lt;/span&gt; (since they have no
   content attributes).&lt;/p&gt;
 
+  &lt;hr&gt;
+
   &lt;p&gt;&lt;dfn&gt;Event handler content attributes&lt;/dfn&gt;, when specified, must
   contain valid ECMAScript code matching the ECMAScript &lt;code
   title=&quot;&quot;&gt;FunctionBody&lt;/code&gt; production. &lt;a
@@ -38267,43 +38668,61 @@
   &lt;!-- SCRIPT EXEC --&gt;
   &lt;p&gt;When an event handler content attribute is set, if the element is
   owned by a &lt;code&gt;Document&lt;/code&gt; that is in a &lt;span&gt;browsing
-  context&lt;/span&gt;, its new value must be interpreted as the body of an
-  anonymous function with a single argument called &lt;code&gt;event&lt;/code&gt;,
-  with the new function's scope chain being linked from the activation
-  object of the handler, to the element, to the element's
-  &lt;code&gt;form&lt;/code&gt; element if it is a form control, to the
-  &lt;code&gt;Document&lt;/code&gt; object, to the &lt;code&gt;Window&lt;/code&gt; object of
-  the &lt;span&gt;browsing context&lt;/span&gt; of that &lt;code&gt;Document&lt;/code&gt;. The
-  function's &lt;code&gt;this&lt;/code&gt; parameter must be the
-  &lt;code&gt;Element&lt;/code&gt; object representing the element. The resulting
-  function must then be set as the value of the corresponding event
-  handler attribute, and the new value must be set as the value of the
-  content attribute. If the given function body fails to compile, then
-  the corresponding event handler attribute must be set to null
-  instead (the content attribute must still be updated to the new
-  value, though).&lt;/p&gt;
+  context&lt;/span&gt;, the user agent must run the following steps to
+  create a &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; after setting
+  the content attribute to its new value:&lt;/p&gt;
 
-  &lt;p class=&quot;note&quot;&gt;See ECMA262 Edition 3, sections 10.1.6 and 10.2.3,
-  for more details on activation objects. &lt;a
-  href=&quot;#refsECMA262&quot;&gt;[ECMA262]&lt;/a&gt;&lt;/p&gt;
+  &lt;ol&gt;
 
-  &lt;p&gt;The &lt;span&gt;script execution context&lt;/span&gt; of the event handler
-  must be the &lt;code&gt;Window&lt;/code&gt; object at the end of the scope
-  chain. The &lt;span&gt;script document context&lt;/span&gt; of the event handler
-  must be the &lt;code&gt;Document&lt;/code&gt; object that owns the event handler
-  content attribute that was set.&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;Set up a &lt;span&gt;script execution environment&lt;/span&gt; for
+   JavaScript.&lt;/p&gt;&lt;/li&gt;
 
-  &lt;p&gt;When an event handler content attribute is set on an element
-  owned by a &lt;code&gt;Document&lt;/code&gt; that is not in a &lt;span&gt;browsing
-  context&lt;/span&gt;, the corresponding event handler attribute is not
-  changed.&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;Using this script execution environment, interpret the
+   attribute's new value as the body of an anonymous function with a
+   single argument called &lt;code&gt;event&lt;/code&gt;. Link the new function's
+   scope chain from the activation object of the handler, to the
+   element's object, to the element's &lt;span&gt;form owner&lt;/span&gt;, if it
+   has one, to the element's &lt;code&gt;Document&lt;/code&gt; object, to the
+   &lt;code&gt;Window&lt;/code&gt; object of the &lt;span&gt;browsing context&lt;/span&gt; of
+   that &lt;code&gt;Document&lt;/code&gt;. Set the function's &lt;code&gt;this&lt;/code&gt;
+   parameter to the &lt;code&gt;Element&lt;/code&gt; object representing the
+   element. Let this function be the only entry in the script's
+   &lt;span&gt;list of code entry-points&lt;/span&gt;.&lt;/p&gt;
 
+   &lt;p class=&quot;note&quot;&gt;See ECMA262 Edition 3, sections 10.1.6 and 10.2.3,
+   for more details on activation objects. &lt;a
+   href=&quot;#refsECMA262&quot;&gt;[ECMA262]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the previous steps failed to compile the script, then set
+   the corresponding event handler attribute to null and abort these
+   steps.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set up the &lt;span&gt;script's global object&lt;/span&gt;, the
+   &lt;span&gt;script's browsing context&lt;/span&gt;, the &lt;span&gt;script's
+   character encoding&lt;/span&gt;, and the &lt;span&gt;script's base URL&lt;/span&gt;
+   from &lt;span&gt;the script settings determined from the node&lt;/span&gt; on
+   which the attribute is being set, and add the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; to the
+   &lt;span&gt;script group&lt;/span&gt; determined from that node as
+   well.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set the corresponding event handler attribute to the
+   aforementioned function.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;p class=&quot;note&quot;&gt;When an event handler content attribute is set on an
+  element owned by a &lt;code&gt;Document&lt;/code&gt; that is not in a
+  &lt;span&gt;browsing context&lt;/span&gt;, the corresponding event handler
+  attribute is not changed.&lt;/p&gt;
+
   &lt;p class=&quot;note&quot;&gt;Removing an event handler content attribute does not
-  reset the corresponding event handler attribute either.&lt;/p&gt;
+  reset the corresponding event handler attribute.&lt;/p&gt;
   &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cbody%20onload%3D%22w(%27pass%27">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cbody%20onload%3D%22w(%27pass%27</A>)%22%3E%0A%3Cscript%3Edocument.body.removeAttribute(%27onload%27)%3B%3C%2Fscript%3E --&gt;
 
   &lt;p class=&quot;XXX&quot;&gt;How do we allow non-JS event handlers?&lt;/p&gt;
 
+  &lt;hr&gt;
+
   &lt;p&gt;&lt;dfn&gt;Event handler DOM attributes&lt;/dfn&gt;, on setting, must set the
   corresponding event handler attribute to their new value, and on
   getting, must return whatever the current value of the corresponding
@@ -38555,18 +38974,37 @@
 
    &lt;dd&gt;&lt;p&gt;Must be invoked whenever an &lt;code
    title=&quot;event-unload&quot;&gt;unload&lt;/code&gt; event is targeted at or bubbles
-   through the element.&lt;/p&gt;&lt;/dd&gt; &lt;!-- XXX need to fire this --&gt;
+   through the element.&lt;/p&gt;&lt;/dd&gt;
 
   &lt;/dl&gt;
 
   &lt;p&gt;When an event handler attribute is invoked, its argument must be
-  set to the &lt;code&gt;Event&lt;/code&gt; object of the event in question. If
-  the function returns the exact boolean value false, the event's
-  &lt;code&gt;preventDefault()&lt;/code&gt; method must then invoked. Exception:
-  for historical reasons, for the HTML &lt;code&gt;mouseover&lt;/code&gt; event,
-  the &lt;code&gt;preventDefault()&lt;/code&gt; method must be called when the
-  function returns true instead.&lt;/p&gt;
+  set to the &lt;code&gt;Event&lt;/code&gt; object of the event in question.&lt;/p&gt;
 
+  &lt;p&gt;The handler's return value must be processed as follows:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;If the event type is &lt;code class=&quot;event-mouseover&quot;&gt;mouseover&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;&lt;p&gt;If the return value is a boolean with the value true, then
+   the event must be canceled.&lt;/p&gt;&lt;/dd&gt;
+
+   &lt;dt&gt;If the event object is a &lt;code&gt;BeforeUnloadEvent&lt;/code&gt; object&lt;/dt&gt;
+
+   &lt;dd&gt;&lt;p&gt;If the return value is a string, and the event object's
+   &lt;code title=&quot;dom-BeforeUnloadEvent-returnValue&quot;&gt;returnValue&lt;/code&gt;
+   attribute's value is the empty string, then set the &lt;code
+   title=&quot;dom-BeforeUnloadEvent-returnValue&quot;&gt;returnValue&lt;/code&gt;
+   attribute's value to the return value.&lt;/p&gt;&lt;/dd&gt;
+
+   &lt;dt&gt;Otherwise&lt;/dt&gt;
+
+   &lt;dd&gt;&lt;p&gt;If the return value is a boolean with the value false, then
+   the event must be canceled.&lt;/p&gt;&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
   &lt;!-- IE actually uncancels the event if the function returns true --&gt;
 
   &lt;p&gt;All event handler attributes on an element, whether set to null
@@ -38920,7 +39358,7 @@
 
      &lt;li&gt;have an &lt;span&gt;active document&lt;/span&gt; whose
      &lt;span&gt;origin&lt;/span&gt; is the &lt;span title=&quot;same origin&quot;&gt;same&lt;/span&gt;
-     as the &lt;span&gt;origin&lt;/span&gt; of the script that called the &lt;code
+     as the &lt;span&gt;origin&lt;/span&gt; of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that called the &lt;code
      title=&quot;dom-showModalDialog&quot;&gt;showModalDialog()&lt;/code&gt; method at
      the time the method was called,&lt;/li&gt; &lt;!-- Note that changing
      document.domain to talk to another domain doesn't make you able
@@ -38969,7 +39407,7 @@
    &lt;li&gt;
 
     &lt;p&gt;Let the &lt;span&gt;dialog arguments' origin&lt;/span&gt; be the
-    &lt;span&gt;origin&lt;/span&gt; of the script that called the &lt;code
+    &lt;span&gt;origin&lt;/span&gt; of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that called the &lt;code
     title=&quot;dom-showModalDialog&quot;&gt;showModalDialog()&lt;/code&gt; method.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -38978,9 +39416,9 @@
 
     &lt;p&gt;&lt;span&gt;Navigate&lt;/span&gt; the new browsing context to &lt;var
     title=&quot;&quot;&gt;url&lt;/var&gt;, with &lt;span&gt;replacement enabled&lt;/span&gt;, and
-    with the &lt;span&gt;script browsing context&lt;/span&gt; of the script that
-    invoked the method as the &lt;span&gt;source browsing
-    context&lt;/span&gt;.&lt;/p&gt;
+    with the &lt;span title=&quot;script's browsing context&quot;&gt;browsing
+    context&lt;/span&gt; of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that invoked the method as the
+    &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -39089,18 +39527,19 @@
   title=&quot;&quot;&gt;onclick&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method, when invoked, must
   cause the user agent to show a notification.&lt;/p&gt;
 
-  &lt;p id=&quot;sandboxNotifications&quot;&gt;If the method was invoked from a script
-  whose &lt;span&gt;script browsing context&lt;/span&gt; has the &lt;span&gt;sandboxed
-  annoyances browsing context flag&lt;/span&gt; set, then the notification
-  must be shown within that &lt;span&gt;browsing context&lt;/span&gt;. The
-  notification is said to be a &lt;dfn&gt;sandboxed notification&lt;/dfn&gt;.&lt;/p&gt;
+  &lt;p id=&quot;sandboxNotifications&quot;&gt;If the method was invoked from a &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt;
+  whose &lt;span title=&quot;script's browsing context&quot;&gt;browsing
+  context&lt;/span&gt; has the &lt;span&gt;sandboxed annoyances browsing context
+  flag&lt;/span&gt; set, then the notification must be shown within that
+  &lt;span&gt;browsing context&lt;/span&gt;. The notification is said to be a
+  &lt;dfn&gt;sandboxed notification&lt;/dfn&gt;.&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, if the &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;script
-  browsing context&lt;/span&gt; of the script that invoked the method is
-  &lt;em&gt;not&lt;/em&gt; flagged as being a &lt;span&gt;trusted notification
-  source&lt;/span&gt;, then the notification should be rendered within the
-  &lt;span&gt;top-level browsing context&lt;/span&gt; of the &lt;span&gt;script browsing
-  context&lt;/span&gt; of the script that invoked the method. The
+  &lt;p&gt;Otherwise, if the &lt;span&gt;origin&lt;/span&gt; of the &lt;span
+  title=&quot;script's browsing context&quot;&gt;browsing context&lt;/span&gt; of the
+  &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that invoked the method is &lt;em&gt;not&lt;/em&gt; flagged as being a
+  &lt;span&gt;trusted notification source&lt;/span&gt;, then the notification
+  should be rendered within the &lt;span&gt;top-level browsing
+  context&lt;/span&gt; of the &lt;span&gt;script's browsing context&lt;/span&gt;. The
   notification is said to be a &lt;dfn&gt;normal notification&lt;/dfn&gt;. User
   agents should provide a way to set the origin's &lt;span&gt;trusted
   notification source&lt;/span&gt; flag from the notification, so that the
@@ -39149,16 +39588,16 @@
   &lt;p&gt;When a &lt;span&gt;normal notification&lt;/span&gt; (but not a
   &lt;span&gt;sandboxed notification&lt;/span&gt;) is shown, the user agent may
   bring the user's attention to the &lt;span&gt;top-level browsing
-  context&lt;/span&gt; of the &lt;span&gt;script browsing context&lt;/span&gt; of the
-  script that invoked the method, if that would be useful; but user
-  agents should not use system-wide notification mechanisms to do
-  so.&lt;/p&gt;
+  context&lt;/span&gt; of the &lt;span title=&quot;script's browsing
+  context&quot;&gt;browsing context&lt;/span&gt; of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that invoked the
+  method, if that would be useful; but user agents should not use
+  system-wide notification mechanisms to do so.&lt;/p&gt;
 
   &lt;p&gt;When a &lt;span&gt;trusted notification&lt;/span&gt; is shown, the user agent
-  should bring the user's attention to the notification and the
-  &lt;span&gt;script browsing context&lt;/span&gt; of the script that invoked the
-  method, as per the platform conventions for attracting the user's
-  attention to applications.&lt;/p&gt;
+  should bring the user's attention to the notification and the &lt;span
+  title=&quot;script's browsing context&quot;&gt;browsing context&lt;/span&gt; of the
+  &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that invoked the method, as per the platform conventions for
+  attracting the user's attention to applications.&lt;/p&gt;
 
   &lt;div class=&quot;example&quot;&gt;
 
@@ -39185,8 +39624,9 @@
    &lt;li&gt;The &lt;span title=&quot;meta-application-name&quot;&gt;application
    name&lt;/span&gt;, if available, or else the &lt;span
    title=&quot;dom-document-title&quot;&gt;document title&lt;/span&gt;, of the
-   &lt;span&gt;active document&lt;/span&gt; of the &lt;span&gt;script browsing
-   context&lt;/span&gt; of the script that invoked the method.&lt;/li&gt;
+   &lt;span&gt;active document&lt;/span&gt; of the &lt;span title=&quot;script's browsing
+   context&quot;&gt;browsing context&lt;/span&gt; of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that invoked the
+   method.&lt;/li&gt;
 
    &lt;li&gt;An icon chosen from the &lt;span title=&quot;external resource
    link&quot;&gt;external resource links&lt;/span&gt; of type &lt;code
@@ -39229,11 +39669,12 @@
   &lt;p&gt;User agents should support user interaction with notifications,
   if and as appropriate given the platform conventions. If a user
   activates a notification, and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt;
-  callback argument was present and is not null, then the &lt;span&gt;script
-  browsing context&lt;/span&gt; of the function given by &lt;var
-  title=&quot;&quot;&gt;onclick&lt;/var&gt; should be brought to the user's attention,
-  and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; callback should then be
-  invoked.&lt;/p&gt;
+  callback argument was present and is not null, then the &lt;span
+  title=&quot;script's browsing context&quot;&gt;browsing context&lt;/span&gt; of the
+  &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; of the function given by
+  &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; should be brought to the user's
+  attention, and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; callback should then
+  be invoked.&lt;/p&gt;
 
 
 
@@ -39425,9 +39866,8 @@
     first occurrence of the exact literal string &quot;&lt;code&gt;%s&lt;/code&gt;&quot;
     with an escaped version of the URL of the content in question (as
     defined below), then &lt;span title=&quot;resolve a url&quot;&gt;resolve&lt;/span&gt;
-    the resulting URL (using the &lt;span&gt;document base URL&lt;/span&gt; of the
-    &lt;span&gt;script document context&lt;/span&gt; of the script that originally
-    invoked the &lt;code
+    the resulting URL (using the &lt;span title=&quot;script's base URL&quot;&gt;base
+    URL&lt;/span&gt; of the script that originally invoked the &lt;code
     title=&quot;dom-navigator-registerContentHandler&quot;&gt;registerContentHandler()&lt;/code&gt;
     or &lt;code
     title=&quot;dom-navigator-registerProtocolHandler&quot;&gt;registerProtocolHandler()&lt;/code&gt;
@@ -41839,8 +42279,9 @@
   &lt;p&gt;Navigation for the &lt;code
   title=&quot;dom-location-assign&quot;&gt;assign()&lt;/code&gt; and &lt;code
   title=&quot;dom-location-replace&quot;&gt;replace()&lt;/code&gt; methods must be done
-  with the &lt;span&gt;script browsing context&lt;/span&gt; of the script that
-  invoked the method as the &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
+  with the &lt;span title=&quot;script's browsing context&quot;&gt;browsing
+  context&lt;/span&gt; of the script that invoked the method as the
+  &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
 
 &lt;!--XXX
   &lt;dfn title=&quot;dom-location-reload&quot;&gt;&lt;code&gt;reload()&lt;/code&gt;&lt;/dfn&gt;
@@ -42090,7 +42531,7 @@
     synchronous, but if fetching the resource depends on external
     resources, as it usually does for URLs that use HTTP or other
     networking protocols, then at this point the user agents must
-    yield to whatever script invoked the navigation steps, if they
+    yield to whatever &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; invoked the navigation steps, if they
     were invoked by script.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -42279,19 +42720,11 @@
    &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;pause for scripts -- but don't use the
    &quot;pause&quot; definition since that involves not running script!&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;onbeforeunload, and if present set flag that we will kill document&lt;/p&gt;&lt;/li&gt;
-   &lt;!--
-   when we define onbeforeunload, then we have to say that the JS
-   implementation of EventListener::handleEvent checks for that event,
-   treating the return value as the string to use for the unload warning
-   message if there is a return value, and calling preventDefault if
-   there isn't.
-   --&gt;
+   &lt;li&gt;&lt;p&gt;&lt;span title=&quot;unload a document&quot;&gt;Unload&lt;/span&gt; the
+   &lt;code&gt;Document&lt;/code&gt; object of the &lt;span&gt;current entry&lt;/span&gt;,
+   with the &lt;var title=&quot;&quot;&gt;recycle&lt;/var&gt; parameter set to
+   false.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;onunload, and if present set flag that we will kill document&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;if flag is set: &lt;span title=&quot;discard a document&quot;&gt;discard the &lt;code&gt;Document&lt;/code&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;dl&gt;
@@ -42692,8 +43125,8 @@
 
     &lt;ol&gt;
 
-     &lt;li class=&quot;XXX&quot;&gt;freeze any timers, intervals,
-     XMLHttpRequests, database transactions, etc&lt;/li&gt;
+     &lt;li&gt;Freeze the &lt;span&gt;active document&lt;/span&gt;'s &lt;span&gt;current
+     script group&lt;/span&gt;.&lt;/li&gt;
 
      &lt;li&gt;The user agent must move any properties that have been added
      to the browsing context's default view's &lt;code&gt;Window&lt;/code&gt;
@@ -42756,8 +43189,8 @@
      &lt;span&gt;list of added properties&lt;/span&gt; to browsing context's
      default view's &lt;code&gt;Window&lt;/code&gt; object.&lt;/li&gt;
 
-     &lt;li class=&quot;XXX&quot;&gt;unfreeze any timers, intervals,
-     XMLHttpRequests, database transactions, etc&lt;/li&gt;
+     &lt;li&gt;Unfreeze the &lt;span&gt;active document&lt;/span&gt;'s &lt;span&gt;current
+     script group&lt;/span&gt;.&lt;/li&gt;
 
     &lt;/ol&gt;
 
@@ -42801,27 +43234,94 @@
   affect .watch() when seen from other Windows?&lt;/p&gt;
 
 
-  &lt;h4&gt;Closing a browsing context&lt;/h4&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;Closing a browsing context and discarding it
-  (vs closing it and keeping it around in memory).&lt;/p&gt;
+  &lt;h4&gt;Unloading documents&lt;/h4&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;when a browsing context is closed, all session
-  history entries' &lt;code&gt;Document&lt;/code&gt; objects must be
-  discarded.&lt;/p&gt;
+  &lt;p&gt;When a user agent is to &lt;dfn&gt;unload a document&lt;/dfn&gt;, it must run
+  the following steps. These steps are passed an argument, &lt;var
+  title=&quot;&quot;&gt;recycle&lt;/var&gt;, which is either true or false, indicating
+  whether the &lt;code&gt;Document&lt;/code&gt; object is going to be
+  re-used. (This is set by the &lt;code
+  title=&quot;dom-document-open&quot;&gt;document.open()&lt;/code&gt; method.)&lt;/p&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;When a user agent is to &lt;dfn&gt;discard a
-  &lt;code&gt;Document&lt;/code&gt;&lt;/dfn&gt;, any frozen timers, intervals,
-  XMLHttpRequests, database transactions, etc, must be killed, and any
-  MessagePorts owned by the Window object must be
-  unentangled.&lt;/p&gt;
+  &lt;ol&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;Also, &lt;code title=&quot;event-unload&quot;&gt;unload&lt;/code&gt;
-  events should fire.&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;Set &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; to true.&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;event&lt;/var&gt; be a new
+   &lt;code&gt;BeforeUnloadEvent&lt;/code&gt; event object with the name &lt;code
+   title=&quot;event-beforeunload&quot;&gt;beforeunload&lt;/code&gt;, with no namespace,
+   which does not bubble but is cancelable.&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Dispatch &lt;var title=&quot;&quot;&gt;event&lt;/var&gt; at &lt;span&gt;the
+   &lt;code&gt;body&lt;/code&gt; element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If any event listeners were triggered by the previous step,
+   then set &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; to false.&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p&gt;If the &lt;code
+    title=&quot;dom-BeforeUnloadEvent-returnValue&quot;&gt;returnValue&lt;/code&gt;
+    attribute of the &lt;var title=&quot;&quot;&gt;event&lt;/var&gt; object is not the empty
+    string, or if the event was canceled, then the user agent should
+    ask the user to confirm that they wish to unload the document.&lt;/p&gt;
+
+    &lt;p&gt;The prompt shown by the user agent may include the string of
+    the &lt;code
+    title=&quot;dom-BeforeUnloadEvent-returnValue&quot;&gt;returnValue&lt;/code&gt;
+    attribute, or some leading subset thereof. (A user agent may want
+    to truncate the string to 1024 characters for display, for
+    instance.)&lt;/p&gt;
+
+    &lt;p&gt;The user agent must &lt;span&gt;pause&lt;/span&gt; while waiting for the
+    user's response.&lt;/p&gt;
+
+    &lt;p&gt;If the user &lt;dfn&gt;refused to allow the document to be
+    unloaded&lt;/dfn&gt; then these steps must be aborted.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Fire a simple event&lt;/span&gt; called &lt;code
+   title=&quot;event-unload&quot;&gt;unload&lt;/code&gt; at &lt;span&gt;the &lt;code&gt;body&lt;/code&gt;
+   element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If any event listeners were triggered by the previous step,
+   then set &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; to false.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If there are any outstanding transactions that have
+   callbacks that involve &lt;span title=&quot;concept-script&quot;&gt;scripts&lt;/span&gt;
+   that are in the document's &lt;span&gt;current script group&lt;/span&gt;, roll
+   them back (without invoking any of the callbacks) and set &lt;var
+   title=&quot;&quot;&gt;salvageable&lt;/var&gt; to false.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;salvageable&lt;/var&gt; and &lt;var
+   title=&quot;&quot;&gt;recycle&lt;/var&gt; are both false, &lt;span title=&quot;discard a
+   document&quot;&gt;discard the &lt;code&gt;Document&lt;/code&gt;&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;
+
+
+
+  &lt;h5&gt;Event definition&lt;/h5&gt;
+
+  &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;BeforeUnloadEvent&lt;/dfn&gt; : Event {
+           attribute DOMString &lt;span title=&quot;dom-BeforeUnloadEvent-returnValue&quot;&gt;returnValue&lt;/span&gt;;
+};&lt;/pre&gt;
+
+  &lt;p class=&quot;note&quot;&gt;There are no &lt;code&gt;BeforeUnloadEvent&lt;/code&gt;-specific
+  initialization methods.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn
+  title=&quot;dom-BeforeUnloadEvent-returnValue&quot;&gt;&lt;code&gt;returnValue&lt;/code&gt;&lt;/dfn&gt;
+  attribute represents the message to show the user. When the event is
+  created, the attribute must be set to the empty string. On getting,
+  it must return the last value it was set to. On setting, the
+  attribute must be set to the new value.&lt;/p&gt;
+
+
+
+
   &lt;h3&gt;Structured client-side storage&lt;/h3&gt;
 
   &lt;h4 id=&quot;storage&quot;&gt;Storing name/value pairs&lt;/h4&gt;
@@ -43080,14 +43580,14 @@
   separate, not affecting each other in any way.&lt;/p&gt;
 
   &lt;p&gt;When a new &lt;span&gt;top-level browsing context&lt;/span&gt; is created by
-  a script in an existing &lt;span&gt;browsing context&lt;/span&gt;, or by the
-  user following a link in an existing browsing context, or in some
-  other way related to a specific &lt;code&gt;HTMLDocument&lt;/code&gt;, then the
-  session storage area of the &lt;span&gt;origin&lt;/span&gt; of that
-  &lt;code&gt;HTMLDocument&lt;/code&gt; must be copied into the new browsing
-  context when it is created.  From that point on, however, the two
-  session storage areas must be considered separate, not affecting
-  each other in any way.&lt;/p&gt;
+  a &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; in an existing
+  &lt;span&gt;browsing context&lt;/span&gt;, or by the user following a link in an
+  existing browsing context, or in some other way related to a
+  specific &lt;code&gt;HTMLDocument&lt;/code&gt;, then the session storage area of
+  the &lt;span&gt;origin&lt;/span&gt; of that &lt;code&gt;HTMLDocument&lt;/code&gt; must be
+  copied into the new browsing context when it is created.  From that
+  point on, however, the two session storage areas must be considered
+  separate, not affecting each other in any way.&lt;/p&gt;
 
   &lt;p id=&quot;sessionStorageEvent&quot;&gt;When the &lt;code
   title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt;, &lt;code
@@ -50206,11 +50706,11 @@
   &lt;ol&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;span&gt;Create a new &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/span&gt;
-   owned by the &lt;span&gt;script execution context&lt;/span&gt;, and let &lt;var
+   owned by the &lt;span&gt;script's global object&lt;/span&gt;, and let &lt;var
    title=&quot;&quot;&gt;port1&lt;/var&gt; be that object.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;span&gt;Create a new &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/span&gt;
-   owned by the &lt;span&gt;script execution context&lt;/span&gt;, and let &lt;var
+   owned by the &lt;span&gt;script's global object&lt;/span&gt;, and let &lt;var
    title=&quot;&quot;&gt;port2&lt;/var&gt; be that object.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;span&gt;Entangle&lt;/span&gt; the &lt;var title=&quot;&quot;&gt;port1&lt;/var&gt; and &lt;var
@@ -50265,8 +50765,8 @@
   initially closed.&lt;/p&gt;
 
   &lt;p&gt;When the user agent is to &lt;dfn&gt;create a new
-  &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/dfn&gt; owned by a &lt;span&gt;script
-  execution context&lt;/span&gt; object &lt;var title=&quot;&quot;&gt;owner&lt;/var&gt;, it must
+  &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/dfn&gt; owned by a &lt;span&gt;script's
+  global object&lt;/span&gt; object &lt;var title=&quot;&quot;&gt;owner&lt;/var&gt;, it must
   instantiate a new &lt;code&gt;MessagePort&lt;/code&gt; object, and let its owner
   be &lt;var title=&quot;&quot;&gt;owner&lt;/var&gt;.&lt;/p&gt;
 
@@ -50428,7 +50928,7 @@
    argument.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;&lt;span&gt;Create a new &lt;code&gt;MessagePort&lt;/code&gt; object&lt;/span&gt;
-   owned by the &lt;span&gt;script execution context&lt;/span&gt;, and let &lt;var
+   owned by the &lt;span&gt;script's global object&lt;/span&gt;, and let &lt;var
    title=&quot;&quot;&gt;port1&lt;/var&gt; be that object.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the &lt;var title=&quot;&quot;&gt;source port&lt;/var&gt; is not entangled with
@@ -50567,7 +51067,7 @@
 
 
 
-  &lt;h5&gt;Ports and browsing contexts&lt;/h5&gt;
+  &lt;h5 id=&quot;message-port-discarding&quot;&gt;Ports and browsing contexts&lt;/h5&gt;
 
   &lt;p&gt;When a &lt;code&gt;Document&lt;/code&gt; is &lt;span title=&quot;discard a
   document&quot;&gt;discarded&lt;/span&gt;, if there are any
@@ -50577,7 +51077,7 @@
    &lt;li&gt;are entangled, and&lt;/li&gt;
    &lt;li&gt;are owned by the &lt;span&gt;browsing context&lt;/span&gt; that contained that &lt;code&gt;Document&lt;/code&gt;, and&lt;/li&gt;
    &lt;li&gt;were created while that &lt;code&gt;Document&lt;/code&gt; was the &lt;span&gt;active document&lt;/span&gt; of that &lt;span&gt;browsing context&lt;/span&gt;, and&lt;/li&gt;
-   &lt;li&gt;are entangled with a port that is either not owned by that &lt;span&gt;browsing context&lt;/span&gt; or was not created while that &lt;code&gt;Document&lt;/code&gt; was the &lt;span&gt;active document&lt;/span&gt; of that &lt;span&gt;browsing context&lt;/span&gt;,&lt;/li&gt;
+   &lt;li&gt;are entangled with a port that is either not owned by that &lt;span&gt;browsing context&lt;/span&gt;, or were not created while that &lt;code&gt;Document&lt;/code&gt; was the &lt;span&gt;active document&lt;/span&gt; of that &lt;span&gt;browsing context&lt;/span&gt;,&lt;/li&gt;
   &lt;/ul&gt;
 
   &lt;p&gt;...then the user agent must run the following steps for each such
@@ -52714,10 +53214,10 @@
 
   &lt;h5&gt;The scripting state&lt;/h5&gt;
 
-  &lt;p&gt;The &lt;dfn&gt;scripting flag&lt;/dfn&gt; is set to &quot;enabled&quot; if the
-  &lt;code&gt;Document&lt;/code&gt; with which the parser is associated was
-  &lt;span&gt;with script&lt;/span&gt; when the parser was created, and &quot;disabled&quot;
-  otherwise.&lt;/p&gt;
+  &lt;p&gt;The &lt;dfn&gt;scripting flag&lt;/dfn&gt; is set to &quot;enabled&quot; if the &lt;span
+  title=&quot;concept-n-script&quot;&gt;scripting was enabled&lt;/span&gt; for the
+  &lt;code&gt;Document&lt;/code&gt; with which the parser is associated when the
+  parser was created, and &quot;disabled&quot; otherwise.&lt;/p&gt;
 
 
   &lt;h4&gt;&lt;dfn&gt;Tokenization&lt;/dfn&gt;&lt;/h4&gt;
@@ -58963,8 +59463,11 @@
   &lt;code&gt;Window&lt;/code&gt; object on which the &lt;code
   title=&quot;setTimeout&quot;&gt;setTimeout()&lt;/code&gt; method was invoked.&lt;/p&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;Need to define &lt;var title=&quot;&quot;&gt;language&lt;/var&gt;
-  values.&lt;/p&gt;
+  &lt;p class=&quot;XXX&quot;&gt;Need to define &lt;var title=&quot;&quot;&gt;language&lt;/var&gt; values;
+  need to define that the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt;
+  corresponding to the &lt;var title=&quot;&quot;&gt;code&lt;/var&gt; argument is created
+  before the timer is set up, so that the rule on pausing the ticker,
+  below, makes sense.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn
   title=&quot;dom-windowtimers-setInterval&quot;&gt;&lt;code&gt;setInterval(...)&lt;/code&gt;&lt;/dfn&gt;
@@ -58988,8 +59491,15 @@
   with a value that does not correspond to an active timeout or
   interval, the methods must return without doing anything.&lt;/p&gt;
 
+  &lt;p&gt;For both &lt;code
+  title=&quot;dom-windowtimers-setTimeout&quot;&gt;setTimeout()&lt;/code&gt; and &lt;code
+  title=&quot;dom-windowtimers-setInterval&quot;&gt;setInterval()&lt;/code&gt;, the clock
+  upon which the timers are based must only tick while the
+  &lt;span&gt;script group&lt;/span&gt; of their callbacks is not
+  &lt;i&gt;frozen&lt;/i&gt;.&lt;/p&gt;
 
 
+
   &lt;h3&gt;Rendering and the DOM&lt;/h3&gt;
 
   &lt;p class=&quot;XXX&quot;&gt;This section is expected to be moved to its own


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009411.html">[html5] r2528 - [giow] (2) WF2: Change &lt;legend&gt; to be treated more	like &lt;option&gt; than like a ful [...]
</A></li>
	<LI>Next message: <A HREF="009413.html">[html5] r2530 - [e] (0) Update terminology to help Workers	specification.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9412">[ date ]</a>
              <a href="thread.html#9412">[ thread ]</a>
              <a href="subject.html#9412">[ subject ]</a>
              <a href="author.html#9412">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
