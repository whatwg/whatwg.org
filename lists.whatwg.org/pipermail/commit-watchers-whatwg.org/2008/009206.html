<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2321 - [] (0) WF2: constraint validation API
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2321%20-%20%5B%5D%20%280%29%20WF2%3A%20constraint%20validation%20API&In-Reply-To=%3C20081010043233.B631838E8F6%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009205.html">
   <LINK REL="Next"  HREF="009207.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2321 - [] (0) WF2: constraint validation API</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2321%20-%20%5B%5D%20%280%29%20WF2%3A%20constraint%20validation%20API&In-Reply-To=%3C20081010043233.B631838E8F6%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2321 - [] (0) WF2: constraint validation API">whatwg at whatwg.org
       </A><BR>
    <I>Thu Oct  9 21:32:33 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="009205.html">[html5] r2320 - [] (0) WF2: Define the ailments for a form control.
</A></li>
        <LI>Next message: <A HREF="009207.html">[html5] r2322 - [] (0) WF2: Form submission encoding algorithms and	related fallout. Also, chang [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9206">[ date ]</a>
              <a href="thread.html#9206">[ thread ]</a>
              <a href="subject.html#9206">[ subject ]</a>
              <a href="author.html#9206">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-10-09 21:32:32 -0700 (Thu, 09 Oct 2008)
New Revision: 2321

Modified:
   index
   source
Log:
[] (0) WF2: constraint validation API

Modified: index
===================================================================
--- index	2008-10-10 02:54:53 UTC (rev 2320)
+++ index	2008-10-10 04:32:32 UTC (rev 2321)
@@ -22795,7 +22795,7 @@
   readonly attribute &lt;a href=#htmlformcontrolscollection-0&gt;HTMLFormControlsCollection&lt;/a&gt; &lt;a href=#dom-fieldset-elements title=dom-fieldset-elements&gt;elements&lt;/a&gt;;
 
   readonly attribute boolean &lt;a href=#dom-cva-willvalidate title=dom-cva-willValidate&gt;willValidate&lt;/a&gt;;
-  readonly attribute &lt;span&gt;ValidityState&lt;/span&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
+  readonly attribute &lt;a href=#validitystate&gt;ValidityState&lt;/a&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-cva-validationmessage title=dom-cva-validationMessage&gt;validationMessage&lt;/a&gt;;
   boolean &lt;a href=#dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;checkValidity&lt;/a&gt;();
   void &lt;a href=#dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;setCustomValidity&lt;/a&gt;(in DOMString error);
@@ -23002,7 +23002,7 @@
   void &lt;a href=#dom-input-stepdown title=dom-input-stepDown&gt;stepDown&lt;/a&gt;(in int n);
 
   readonly attribute boolean &lt;a href=#dom-cva-willvalidate title=dom-cva-willValidate&gt;willValidate&lt;/a&gt;;
-  readonly attribute &lt;span&gt;ValidityState&lt;/span&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
+  readonly attribute &lt;a href=#validitystate&gt;ValidityState&lt;/a&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-cva-validationmessage title=dom-cva-validationMessage&gt;validationMessage&lt;/a&gt;;
   boolean &lt;a href=#dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;checkValidity&lt;/a&gt;();
   void &lt;a href=#dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;setCustomValidity&lt;/a&gt;(in DOMString error);
@@ -26274,7 +26274,7 @@
            attribute DOMString &lt;a href=#dom-button-value title=dom-button-value&gt;value&lt;/a&gt;;
 
   readonly attribute boolean &lt;a href=#dom-cva-willvalidate title=dom-cva-willValidate&gt;willValidate&lt;/a&gt;;
-  readonly attribute &lt;span&gt;ValidityState&lt;/span&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
+  readonly attribute &lt;a href=#validitystate&gt;ValidityState&lt;/a&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-cva-validationmessage title=dom-cva-validationMessage&gt;validationMessage&lt;/a&gt;;
   boolean &lt;a href=#dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;checkValidity&lt;/a&gt;();
   void &lt;a href=#dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;setCustomValidity&lt;/a&gt;(in DOMString error);
@@ -26401,7 +26401,7 @@
            attribute DOMString &lt;a href=#dom-select-value title=dom-select-value&gt;value&lt;/a&gt;;
 
   readonly attribute boolean &lt;a href=#dom-cva-willvalidate title=dom-cva-willValidate&gt;willValidate&lt;/a&gt;;
-  readonly attribute &lt;span&gt;ValidityState&lt;/span&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
+  readonly attribute &lt;a href=#validitystate&gt;ValidityState&lt;/a&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-cva-validationmessage title=dom-cva-validationMessage&gt;validationMessage&lt;/a&gt;;
   boolean &lt;a href=#dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;checkValidity&lt;/a&gt;();
   void &lt;a href=#dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;setCustomValidity&lt;/a&gt;(in DOMString error);
@@ -26816,7 +26816,7 @@
            attribute DOMString &lt;a href=#dom-textarea-value title=dom-textarea-value&gt;value&lt;/a&gt;;
 
   readonly attribute boolean &lt;a href=#dom-cva-willvalidate title=dom-cva-willValidate&gt;willValidate&lt;/a&gt;;
-  readonly attribute &lt;span&gt;ValidityState&lt;/span&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
+  readonly attribute &lt;a href=#validitystate&gt;ValidityState&lt;/a&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-cva-validationmessage title=dom-cva-validationMessage&gt;validationMessage&lt;/a&gt;;
   boolean &lt;a href=#dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;checkValidity&lt;/a&gt;();
   void &lt;a href=#dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;setCustomValidity&lt;/a&gt;(in DOMString error);
@@ -27003,7 +27003,7 @@
            attribute DOMString &lt;a href=#dom-output-value title=dom-output-value&gt;value&lt;/a&gt;;
 
   readonly attribute boolean &lt;a href=#dom-cva-willvalidate title=dom-cva-willValidate&gt;willValidate&lt;/a&gt;;
-  readonly attribute &lt;span&gt;ValidityState&lt;/span&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
+  readonly attribute &lt;a href=#validitystate&gt;ValidityState&lt;/a&gt; &lt;a href=#dom-cva-validity title=dom-cva-validity&gt;validity&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-cva-validationmessage title=dom-cva-validationMessage&gt;validationMessage&lt;/a&gt;;
   boolean &lt;a href=#dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;checkValidity&lt;/a&gt;();
   void &lt;a href=#dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;setCustomValidity&lt;/a&gt;(in DOMString error);
@@ -27380,9 +27380,19 @@
   constraint validation&lt;/a&gt; if it is an &lt;code&gt;&lt;a href=#the-output-element&gt;output&lt;/a&gt;&lt;/code&gt; or
   &lt;code&gt;&lt;a href=#the-fieldset-element&gt;fieldset&lt;/a&gt;&lt;/code&gt; element.)&lt;/p&gt;
 
+  &lt;p&gt;An element can have a &lt;dfn id=custom-validity-error-message&gt;custom validity error message&lt;/dfn&gt;
+  defined. Initially, an element must have its &lt;a href=#custom-validity-error-message&gt;custom validity
+  error message&lt;/a&gt; set to the empty string. When its value is not
+  the empty string, the element is &lt;a href=#suffering-from-a-custom-error&gt;suffering from a custom
+  error&lt;/a&gt;. It can be set using the &lt;code title=dom-cva-setCustomValidity&gt;&lt;a href=#dom-cva-setcustomvalidity&gt;setCustomValidity()&lt;/a&gt;&lt;/code&gt;
+  method. The user agent should use the &lt;a href=#custom-validity-error-message&gt;custom validity error
+  message&lt;/a&gt; when alerting the user to the problem with the
+  control.&lt;/p&gt;
+
   &lt;p&gt;An element can be constrained in various ways. The following is
-  the list of ailments that a form control can suffer from, making the
-  control invalid for the purposes of constraint valiation:&lt;/p&gt;
+  the list of &lt;dfn id=validity-states&gt;validity states&lt;/dfn&gt; that a form control can be
+  in, making the control invalid for the purposes of constraint
+  valiation:&lt;/p&gt;
 
   &lt;dl&gt;&lt;dt&gt; &lt;dfn id=suffering-from-being-missing&gt;Suffering from being missing&lt;/dfn&gt; &lt;/dt&gt;
 
@@ -27421,9 +27431,15 @@
    given by the &lt;code title=attr-input-step&gt;&lt;a href=#attr-input-step&gt;step&lt;/a&gt;&lt;/code&gt;
    attribute.&lt;/dd&gt;
 
+   &lt;dt&gt; &lt;dfn id=suffering-from-a-custom-error&gt;Suffering from a custom error&lt;/dfn&gt; &lt;/dt&gt;
+
+   &lt;dd&gt; &lt;p&gt;When a control's &lt;a href=#custom-validity-error-message&gt;custom validity error message&lt;/a&gt;
+   (as set by the element's &lt;code title=dom-cva-setCustomValidity&gt;&lt;a href=#dom-cva-setcustomvalidity&gt;setCustomValidity()&lt;/a&gt;&lt;/code&gt;
+   method) is not the empty string.&lt;/p&gt; &lt;/dd&gt;
+
   &lt;/dl&gt;&lt;p&gt;An element &lt;dfn id=concept-fv-valid title=concept-fv-valid&gt;satisfies its
   constraints&lt;/dfn&gt; if it is not suffering from any of the above
-  ailments.&lt;/p&gt;
+  &lt;a href=#validity-states&gt;validity states&lt;/a&gt;.&lt;/p&gt;
 
 
 
@@ -27515,11 +27531,81 @@
   conditions are &lt;a href=#barred-from-constraint-validation title=&quot;barred from constraint
   validation&quot;&gt;barring it from constraint validation&lt;/a&gt;).&lt;/p&gt;
 
-  &lt;p class=XXX&gt; &lt;dfn id=dom-cva-validity title=dom-cva-validity&gt;&lt;code&gt;validity&lt;/code&gt;&lt;/dfn&gt; &lt;dfn id=dom-cva-validationmessage title=dom-cva-validationMessage&gt;&lt;code&gt;validationMessage&lt;/code&gt;&lt;/dfn&gt;
-  &lt;dfn id=dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;&lt;code&gt;checkValidity()&lt;/code&gt;&lt;/dfn&gt;
-  &lt;dfn id=dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;&lt;code&gt;setCustomValidity()&lt;/code&gt;&lt;/dfn&gt;&lt;/p&gt;
+  &lt;p&gt;The &lt;dfn id=dom-cva-setcustomvalidity title=dom-cva-setCustomValidity&gt;&lt;code&gt;setCustomValidity(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt;, when invoked, must set the
+  &lt;a href=#custom-validity-error-message&gt;custom validity error message&lt;/a&gt; to the value of the given
+  &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; argument.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;dfn id=dom-cva-validity title=dom-cva-validity&gt;&lt;code&gt;validity&lt;/code&gt;&lt;/dfn&gt;
+  attribute must return a &lt;code&gt;&lt;a href=#validitystate&gt;ValidityState&lt;/a&gt;&lt;/code&gt; object that
+  represents the &lt;a href=#validity-states&gt;validity states&lt;/a&gt; of the element. This
+  object is live, and the same object must be returned each time the
+  element's &lt;code title=dom-cva-validity&gt;&lt;a href=#dom-cva-validity&gt;validity&lt;/a&gt;&lt;/code&gt; attribute
+  is retrieved.&lt;/p&gt;
 
+&lt;pre class=idl&gt;interface &lt;dfn id=validitystate&gt;ValidityState&lt;/dfn&gt; {
+  readonly attribute boolean &lt;a href=#dom-validitystate-valuemissing title=dom-ValidityState-valueMissing&gt;valueMissing&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-typemismatch title=dom-ValidityState-typeMismatch&gt;typeMismatch&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-patternmismatch title=dom-ValidityState-patternMismatch&gt;patternMismatch&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-toolong title=dom-ValidityState-tooLong&gt;tooLong&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-rangeunderflow title=dom-ValidityState-rangeUnderflow&gt;rangeUnderflow&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-rangeoverflow title=dom-ValidityState-rangeOverflow&gt;rangeOverflow&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-stepmismatch title=dom-ValidityState-stepMismatch&gt;stepMismatch&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-customerror title=dom-ValidityState-customError&gt;customError&lt;/a&gt;;
+  readonly attribute boolean &lt;a href=#dom-validitystate-valid title=dom-ValidityState-valid&gt;valid&lt;/a&gt;;
+};&lt;/pre&gt;
+
+  &lt;p&gt;A &lt;code&gt;&lt;a href=#validitystate&gt;ValidityState&lt;/a&gt;&lt;/code&gt; object has the following
+  attributes. On getting, they must return true if the corresponding
+  condition given in the following list is true, and false
+  otherwise.&lt;/p&gt;
+
+  &lt;dl&gt;&lt;dt&gt;&lt;dfn id=dom-validitystate-valuemissing title=dom-ValidityState-valueMissing&gt;&lt;code&gt;valueMissing&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-being-missing&gt;suffering from being missing&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-typemismatch title=dom-ValidityState-typeMismatch&gt;&lt;code&gt;typeMismatch&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-a-type-mismatch&gt;suffering from a type mismatch&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-patternmismatch title=dom-ValidityState-patternMismatch&gt;&lt;code&gt;patternMismatch&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-a-pattern-mismatch&gt;suffering from a pattern mismatch&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-toolong title=dom-ValidityState-tooLong&gt;&lt;code&gt;tooLong&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-being-too-long&gt;suffering from being too long&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-rangeunderflow title=dom-ValidityState-rangeUnderflow&gt;&lt;code&gt;rangeUnderflow&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-an-underflow&gt;suffering from an underflow&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-rangeoverflow title=dom-ValidityState-rangeOverflow&gt;&lt;code&gt;rangeOverflow&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-an-overflow&gt;suffering from an overflow&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-stepmismatch title=dom-ValidityState-stepMismatch&gt;&lt;code&gt;stepMismatch&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-a-step-mismatch&gt;suffering from a step mismatch&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-customerror title=dom-ValidityState-customError&gt;&lt;code&gt;customError&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;a href=#suffering-from-a-custom-error&gt;suffering from a custom error&lt;/a&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn id=dom-validitystate-valid title=dom-ValidityState-valid&gt;&lt;code&gt;valid&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;None of the other conditions are true.&lt;/p&gt; &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p&gt;When the &lt;dfn id=dom-cva-checkvalidatity title=dom-cva-checkValidatity&gt;&lt;code&gt;checkValidity()&lt;/code&gt;&lt;/dfn&gt;
+  method is invoked, if the element is a &lt;a href=#candidate-for-constraint-validation&gt;candidate for
+  constraint validation&lt;/a&gt; and does not &lt;a href=#concept-fv-valid title=concept-fv-valid&gt;satisfy its constaints&lt;/a&gt;, the user
+  agent must &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=event-invalid&gt;invalid&lt;/code&gt; at the element and return
+  false. Otherwise, it must only return true without doing anything
+  else.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-cva-validationmessage title=dom-cva-validationMessage&gt;&lt;code&gt;validationMessage&lt;/code&gt;&lt;/dfn&gt;
+  attribute must return the empty string if the element is not a
+  &lt;a href=#candidate-for-constraint-validation&gt;candidate for constraint validation&lt;/a&gt; or if it is one but
+  it &lt;a href=#concept-fv-valid title=concept-fv-valid&gt;satisfies its constaints&lt;/a&gt;;
+  otherwise, it must return a suitably localised message that the user
+  agent would show the user if this were the only form with a validity
+  constraint problem. If the element is &lt;a href=#suffering-from-a-custom-error&gt;suffering from a custom
+  error&lt;/a&gt;, then the &lt;a href=#custom-validity-error-message&gt;custom validity error message&lt;/a&gt;
+  should be present in the return value.&lt;/p&gt;
+
+
+
+
   &lt;h4 id=form-submission-0&gt;&lt;span class=secno&gt;4.10.15 &lt;/span&gt;Form submission&lt;/h4&gt;
 
   &lt;!-- XXX <A HREF="http://lxr.mozilla.org/mozilla/source/content/html/content/src/nsHTMLFormElement.cpp">http://lxr.mozilla.org/mozilla/source/content/html/content/src/nsHTMLFormElement.cpp</A> --&gt;

Modified: source
===================================================================
--- source	2008-10-10 02:54:53 UTC (rev 2320)
+++ source	2008-10-10 04:32:32 UTC (rev 2321)
@@ -30776,9 +30776,20 @@
   constraint validation&lt;/span&gt; if it is an &lt;code&gt;output&lt;/code&gt; or
   &lt;code&gt;fieldset&lt;/code&gt; element.)&lt;/p&gt;
 
+  &lt;p&gt;An element can have a &lt;dfn&gt;custom validity error message&lt;/dfn&gt;
+  defined. Initially, an element must have its &lt;span&gt;custom validity
+  error message&lt;/span&gt; set to the empty string. When its value is not
+  the empty string, the element is &lt;span&gt;suffering from a custom
+  error&lt;/span&gt;. It can be set using the &lt;code
+  title=&quot;dom-cva-setCustomValidity&quot;&gt;setCustomValidity()&lt;/code&gt;
+  method. The user agent should use the &lt;span&gt;custom validity error
+  message&lt;/span&gt; when alerting the user to the problem with the
+  control.&lt;/p&gt;
+
   &lt;p&gt;An element can be constrained in various ways. The following is
-  the list of ailments that a form control can suffer from, making the
-  control invalid for the purposes of constraint valiation:&lt;/p&gt;
+  the list of &lt;dfn&gt;validity states&lt;/dfn&gt; that a form control can be
+  in, making the control invalid for the purposes of constraint
+  valiation:&lt;/p&gt;
 
   &lt;dl&gt;
 
@@ -30832,11 +30843,18 @@
    given by the &lt;code title=&quot;attr-input-step&quot;&gt;step&lt;/code&gt;
    attribute.&lt;/p&gt;&lt;/dd&gt;
 
+   &lt;dt&gt; &lt;dfn&gt;Suffering from a custom error&lt;/dfn&gt; &lt;/dt&gt;
+
+   &lt;dd&gt; &lt;p&gt;When a control's &lt;span&gt;custom validity error message&lt;/span&gt;
+   (as set by the element's &lt;code
+   title=&quot;dom-cva-setCustomValidity&quot;&gt;setCustomValidity()&lt;/code&gt;
+   method) is not the empty string.&lt;/p&gt; &lt;/dd&gt;
+
   &lt;/dl&gt;
 
   &lt;p&gt;An element &lt;dfn title=&quot;concept-fv-valid&quot;&gt;satisfies its
   constraints&lt;/dfn&gt; if it is not suffering from any of the above
-  ailments.&lt;/p&gt;
+  &lt;span&gt;validity states&lt;/span&gt;.&lt;/p&gt;
 
 
 
@@ -30958,15 +30976,90 @@
   conditions are &lt;span title=&quot;barred from constraint
   validation&quot;&gt;barring it from constraint validation&lt;/span&gt;).&lt;/p&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt; &lt;dfn
-  title=&quot;dom-cva-validity&quot;&gt;&lt;code&gt;validity&lt;/code&gt;&lt;/dfn&gt; &lt;dfn
-  title=&quot;dom-cva-validationMessage&quot;&gt;&lt;code&gt;validationMessage&lt;/code&gt;&lt;/dfn&gt;
-  &lt;dfn
+  &lt;p&gt;The &lt;dfn
+  title=&quot;dom-cva-setCustomValidity&quot;&gt;&lt;code&gt;setCustomValidity(&lt;var
+  title=&quot;&quot;&gt;message&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt;, when invoked, must set the
+  &lt;span&gt;custom validity error message&lt;/span&gt; to the value of the given
+  &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; argument.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;dom-cva-validity&quot;&gt;&lt;code&gt;validity&lt;/code&gt;&lt;/dfn&gt;
+  attribute must return a &lt;code&gt;ValidityState&lt;/code&gt; object that
+  represents the &lt;span&gt;validity states&lt;/span&gt; of the element. This
+  object is live, and the same object must be returned each time the
+  element's &lt;code title=&quot;dom-cva-validity&quot;&gt;validity&lt;/code&gt; attribute
+  is retrieved.&lt;/p&gt;
+
+&lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;ValidityState&lt;/dfn&gt; {
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-valueMissing&quot;&gt;valueMissing&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-typeMismatch&quot;&gt;typeMismatch&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-patternMismatch&quot;&gt;patternMismatch&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-tooLong&quot;&gt;tooLong&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-rangeUnderflow&quot;&gt;rangeUnderflow&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-rangeOverflow&quot;&gt;rangeOverflow&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-stepMismatch&quot;&gt;stepMismatch&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-customError&quot;&gt;customError&lt;/span&gt;;
+  readonly attribute boolean &lt;span title=&quot;dom-ValidityState-valid&quot;&gt;valid&lt;/span&gt;;
+};&lt;/pre&gt;
+
+  &lt;p&gt;A &lt;code&gt;ValidityState&lt;/code&gt; object has the following
+  attributes. On getting, they must return true if the corresponding
+  condition given in the following list is true, and false
+  otherwise.&lt;/p&gt;
+
+  &lt;dl&gt;
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-valueMissing&quot;&gt;&lt;code&gt;valueMissing&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from being missing&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-typeMismatch&quot;&gt;&lt;code&gt;typeMismatch&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from a type mismatch&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-patternMismatch&quot;&gt;&lt;code&gt;patternMismatch&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from a pattern mismatch&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-tooLong&quot;&gt;&lt;code&gt;tooLong&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from being too long&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-rangeUnderflow&quot;&gt;&lt;code&gt;rangeUnderflow&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from an underflow&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-rangeOverflow&quot;&gt;&lt;code&gt;rangeOverflow&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from an overflow&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-stepMismatch&quot;&gt;&lt;code&gt;stepMismatch&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from a step mismatch&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-customError&quot;&gt;&lt;code&gt;customError&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;The control is &lt;span&gt;suffering from a custom error&lt;/span&gt;.&lt;/p&gt; &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;dfn title=&quot;dom-ValidityState-valid&quot;&gt;&lt;code&gt;valid&lt;/code&gt;&lt;/dfn&gt;&lt;/dt&gt;
+   &lt;dd&gt; &lt;p&gt;None of the other conditions are true.&lt;/p&gt; &lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+  &lt;p&gt;When the &lt;dfn
   title=&quot;dom-cva-checkValidatity&quot;&gt;&lt;code&gt;checkValidity()&lt;/code&gt;&lt;/dfn&gt;
-  &lt;dfn
-  title=&quot;dom-cva-setCustomValidity&quot;&gt;&lt;code&gt;setCustomValidity()&lt;/code&gt;&lt;/dfn&gt;&lt;/p&gt;
+  method is invoked, if the element is a &lt;span&gt;candidate for
+  constraint validation&lt;/span&gt; and does not &lt;span
+  title=&quot;concept-fv-valid&quot;&gt;satisfy its constaints&lt;/span&gt;, the user
+  agent must &lt;span&gt;fire a simple event&lt;/span&gt; named &lt;code
+  title=&quot;event-invalid&quot;&gt;invalid&lt;/code&gt; at the element and return
+  false. Otherwise, it must only return true without doing anything
+  else.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;dfn
+  title=&quot;dom-cva-validationMessage&quot;&gt;&lt;code&gt;validationMessage&lt;/code&gt;&lt;/dfn&gt;
+  attribute must return the empty string if the element is not a
+  &lt;span&gt;candidate for constraint validation&lt;/span&gt; or if it is one but
+  it &lt;span title=&quot;concept-fv-valid&quot;&gt;satisfies its constaints&lt;/span&gt;;
+  otherwise, it must return a suitably localised message that the user
+  agent would show the user if this were the only form with a validity
+  constraint problem. If the element is &lt;span&gt;suffering from a custom
+  error&lt;/span&gt;, then the &lt;span&gt;custom validity error message&lt;/span&gt;
+  should be present in the return value.&lt;/p&gt;
 
+
+
+
   &lt;h4&gt;Form submission&lt;/h4&gt;
 
   &lt;!-- XXX <A HREF="http://lxr.mozilla.org/mozilla/source/content/html/content/src/nsHTMLFormElement.cpp">http://lxr.mozilla.org/mozilla/source/content/html/content/src/nsHTMLFormElement.cpp</A> --&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009205.html">[html5] r2320 - [] (0) WF2: Define the ailments for a form control.
</A></li>
	<LI>Next message: <A HREF="009207.html">[html5] r2322 - [] (0) WF2: Form submission encoding algorithms and	related fallout. Also, chang [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9206">[ date ]</a>
              <a href="thread.html#9206">[ thread ]</a>
              <a href="subject.html#9206">[ subject ]</a>
              <a href="author.html#9206">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
