<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2338 - [gwr] (2) Remove opportunistic caching;	leave only the fallback feature.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2338%20-%20%5Bgwr%5D%20%282%29%20Remove%20opportunistic%20caching%3B%0A%09leave%20only%20the%20fallback%20feature.&In-Reply-To=%3C20081016003318.9978F38EDC6%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009222.html">
   <LINK REL="Next"  HREF="009224.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2338 - [gwr] (2) Remove opportunistic caching;	leave only the fallback feature.</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2338%20-%20%5Bgwr%5D%20%282%29%20Remove%20opportunistic%20caching%3B%0A%09leave%20only%20the%20fallback%20feature.&In-Reply-To=%3C20081016003318.9978F38EDC6%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2338 - [gwr] (2) Remove opportunistic caching;	leave only the fallback feature.">whatwg at whatwg.org
       </A><BR>
    <I>Wed Oct 15 17:33:18 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="009222.html">[html5] r2337 - [gwr] (2) Make the online whitelist a prefix match	feature, not an exact match f [...]
</A></li>
        <LI>Next message: <A HREF="009224.html">[html5] r2339 - [gwr] (2) handle captive portals better in the	offline appcache feature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9223">[ date ]</a>
              <a href="thread.html#9223">[ thread ]</a>
              <a href="subject.html#9223">[ subject ]</a>
              <a href="author.html#9223">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-10-15 17:33:17 -0700 (Wed, 15 Oct 2008)
New Revision: 2338

Modified:
   index
   source
Log:
[gwr] (2) Remove opportunistic caching; leave only the fallback feature.

Modified: index
===================================================================
--- index	2008-10-15 23:44:11 UTC (rev 2337)
+++ index	2008-10-16 00:33:17 UTC (rev 2338)
@@ -16,7 +16,7 @@
   &lt;div class=head&gt;
    &lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;h1&gt;HTML 5&lt;/h1&gt;
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 15 October 2008&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 16 October 2008&lt;/h2&gt;
    &lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;dl&gt;&lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -31805,8 +31805,7 @@
      URL&lt;/a&gt;, then return a new globally unique
      identifier.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;scheme&lt;/var&gt; be the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component of the URI,
-     &lt;a href=#converted-to-lowercase&gt;converted to lowercase&lt;/a&gt;.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;scheme&lt;/var&gt; be the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component of &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, &lt;a href=#converted-to-lowercase&gt;converted to lowercase&lt;/a&gt;.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;If the UA doesn't support the protocol given by &lt;var title=&quot;&quot;&gt;scheme&lt;/var&gt;, then return a new globally unique
      identifier.&lt;/li&gt;
@@ -33693,7 +33692,7 @@
    a document that uses that content type.&lt;/li&gt;
 
    &lt;li&gt;The user agent contacts the third party and hands the third
-   party the URI to the Intranet content.&lt;/li&gt;
+   party the URL to the Intranet content.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p&gt;No actual confidential file data is leaked in this manner, but
   the URLs themselves could contain confidential information. For
@@ -33889,13 +33888,6 @@
      entries.
 
  
-     &lt;dt&gt;&lt;dfn id=concept-appcache-oppcache title=concept-appcache-oppcache&gt;Opportunistically cached entries&lt;/dfn&gt;
-
-     &lt;dd&gt;Resources whose URLs &lt;a href=#concept-appcache-matches-oppcache title=concept-appcache-matches-oppcache&gt;matched&lt;/a&gt; an &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-     namespace&lt;/a&gt; when they were fetched, and were therefore
-     cached in the application cache.
-
- 
      &lt;dt&gt;&lt;dfn id=concept-appcache-dynamic title=concept-appcache-dynamic&gt;Dynamic entries&lt;/dfn&gt;
 
      &lt;dd&gt;Resources that were added to the cache by the &lt;code title=dom-appcache-add&gt;&lt;a href=#dom-appcache-add&gt;add()&lt;/a&gt;&lt;/code&gt; method.
@@ -33907,14 +33899,13 @@
 
    &lt;/li&gt;
 
-   &lt;li&gt;Zero or more &lt;dfn id=concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-   namespaces&lt;/dfn&gt;: URLs, used as &lt;a href=#concept-appcache-matches-oppcache title=concept-appcache-matches-oppcache&gt;prefix match
+   &lt;li&gt;Zero or more &lt;dfn id=concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback
+   namespaces&lt;/dfn&gt;: URLs, used as &lt;a href=#concept-appcache-matches-fallback title=concept-appcache-matches-fallback&gt;prefix match
    patterns&lt;/a&gt;, each of which is mapped to a &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entry&lt;/a&gt;. Each
-   namespace URL prefix, when parsed as a URL, has the &lt;a href=#same-origin&gt;same
-   origin&lt;/a&gt; as &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;the
-   manifest&lt;/a&gt;.&lt;/li&gt;
+   namespace URL has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;the manifest&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;Zero or more URLs that form the &lt;dfn id=concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online whitelist&lt;/dfn&gt;.
+   &lt;li&gt;Zero or more URLs that form the &lt;dfn id=concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online whitelist
+   namespaces&lt;/dfn&gt;.
 
   &lt;/ul&gt;&lt;p&gt;Multiple application caches can contain the same resource,
   e.g. if their manifests all reference that resource. If the user
@@ -34064,30 +34055,24 @@
   &lt;/dl&gt;&lt;p&gt;Manifests may contain sections more than once. Sections may be
   empty.&lt;/p&gt;
 
-  &lt;p&gt;URLs that are to be fallback pages associated with &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-  namespaces&lt;/a&gt;, and those namespaces themselves, must be given in
-  fallback sections, with the namespace being the first URL of the
-  data line, and the corresponding fallback page being the second
-  URL. All the other pages to be cached must be listed in explicit
-  sections.&lt;/p&gt;
+  &lt;p&gt;URLs that are to be fallback pages associated with &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback namespaces&lt;/a&gt;, and
+  those namespaces themselves, must be given in fallback sections,
+  with the namespace being the first URL of the data line, and the
+  corresponding fallback page being the second URL. All the other
+  pages to be cached must be listed in explicit sections.&lt;/p&gt;
 
-  &lt;p&gt;&lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;Opportunistic caching
+  &lt;p&gt;&lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;Fallback
   namespaces&lt;/a&gt; must have the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the
   manifest itself.&lt;/p&gt;
 
-  &lt;p&gt;An opportunistic caching namespace must not be listed more than
-  once.&lt;/p&gt;
+  &lt;p&gt;A &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback
+  namespace&lt;/a&gt; must not be listed more than once.&lt;/p&gt;
 
   &lt;p&gt;URLs that the user agent is to put into the &lt;a href=#concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online whitelist&lt;/a&gt;
   must all be specified in online whitelist sections. (This is needed
   for any URL that the page is intending to use to communicate back to
   the server.)&lt;/p&gt;
 
-  &lt;p&gt;URLs in the online whitelist section must not also be listed in
-  explicit section, and must not be listed as fallback entries in the
-  fallback section. (URLs in the online whitelist section may match
-  opportunistic caching namespaces, however.)&lt;/p&gt;
-
   &lt;p&gt;Relative URLs must be given relative to the manifest's own
   URL.&lt;/p&gt;
 
@@ -34114,8 +34099,8 @@
    entries&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback URLs&lt;/var&gt; be an initially empty
-   mapping of &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic
-   caching namespaces&lt;/a&gt; to &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt;.&lt;/li&gt;
+   mapping of &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback
+   namespaces&lt;/a&gt; to &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;online whitelist URLs&lt;/var&gt; be an
    initially empty list of URLs for a &lt;a href=#concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online
@@ -34276,15 +34261,13 @@
       resulting &lt;a href=#absolute-url title=&quot;absolute URL&quot;&gt;absolute URLs&lt;/a&gt;.&lt;/p&gt;
 
       &lt;p&gt;If the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; corresponding to &lt;var title=&quot;&quot;&gt;part one&lt;/var&gt; is already in the &lt;var title=&quot;&quot;&gt;fallback
-      URIs&lt;/var&gt; mapping as an &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-      namespace&lt;/a&gt;, then jump back to the step labeled &quot;start of
-      line&quot;.&lt;/p&gt;
+      URLs&lt;/var&gt; mapping as a &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback namespace&lt;/a&gt;,
+      then jump back to the step labeled &quot;start of line&quot;.&lt;/p&gt;
 
       &lt;p&gt;Otherwise, add the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; corresponding to
       &lt;var title=&quot;&quot;&gt;part one&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;fallback
-      URIs&lt;/var&gt; mapping as an &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-      namespace&lt;/a&gt;, mapped to the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
-      corresponding to &lt;var title=&quot;&quot;&gt;part two&lt;/var&gt; as the &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entry&lt;/a&gt;.&lt;/p&gt;
+      URLs&lt;/var&gt; mapping as a &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback namespace&lt;/a&gt;,
+      mapped to the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; corresponding to &lt;var title=&quot;&quot;&gt;part two&lt;/var&gt; as the &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entry&lt;/a&gt;.&lt;/p&gt;
 
      &lt;/dd&gt;
 
@@ -34329,12 +34312,11 @@
    &lt;li&gt;&lt;p&gt;Return the &lt;var title=&quot;&quot;&gt;explicit URLs&lt;/var&gt; list, the &lt;var title=&quot;&quot;&gt;fallback URLs&lt;/var&gt; mapping, and the &lt;var title=&quot;&quot;&gt;online
    whitelist URLs&lt;/var&gt;.&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p class=note&gt;If a resource is listed in both the online whitelist
-  and in the explicit section, then that resource will be fetched and
-  cached, but when the page tries to use this resource, the user agent
-  will ignore the cached copy and attempt to fetch the file from the
-  network. Indeed, the cached copy will only be used if it is opened
-  from a top-level browsing context.&lt;/p&gt;
+  &lt;/ol&gt;&lt;p class=note&gt;If a resource is listed in the explicit section and
+  matches an entry in the online whitelist, or if a resource matches
+  both an entry in the fallback section and the online whitelist, the
+  resource will taken from the cache, and the online whitelist entry
+  will be ignored.&lt;/p&gt;
 
 
   &lt;h4 id=updating-an-application-cache&gt;&lt;span class=secno&gt;5.7.4 &lt;/span&gt;Updating an application cache&lt;/h4&gt;
@@ -34405,9 +34387,8 @@
     manifest&quot;&gt;rules for parsing manifests&lt;/a&gt;, obtaining a list of
     &lt;a href=#concept-appcache-explicit title=concept-appcache-explicit&gt;explicit entries&lt;/a&gt;,
     &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt;
-    and the &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic
-    caching namespaces&lt;/a&gt; that map to them, and entries for the
-    &lt;a href=#concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online
+    and the &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback
+    namespaces&lt;/a&gt; that map to them, and entries for the &lt;a href=#concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online
     whitelist&lt;/a&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -34480,13 +34461,6 @@
    list&lt;/var&gt;, each flagged with &quot;fallback entry&quot;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade
-   attempt&lt;/a&gt;, then add all the URLs of &lt;a href=#concept-appcache-oppcache title=concept-appcache-oppcache&gt;opportunistically cached
-   entries&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;cache&lt;/var&gt; that &lt;a href=#concept-appcache-matches-oppcache title=concept-appcache-matches-oppcache&gt;match&lt;/a&gt; the &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-   namespaces&lt;/a&gt; obtained by parsing &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt;
-   to &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, each flagged with &quot;opportunistic
-   entry&quot;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade
    attempt&lt;/a&gt;, then add all the URLs of &lt;a href=#concept-appcache-implicit title=concept-appcache-implicit&gt;implicit entries&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;cache&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, each flagged
    with &quot;implicit entry&quot;.&lt;/li&gt;
 
@@ -34554,11 +34528,6 @@
      entry as a &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback
      entry&lt;/a&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;If the URL being processed was flagged as a &quot;opportunistic
-     entry&quot; in &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, then categorize the
-     entry as an &lt;a href=#concept-appcache-oppcache title=concept-appcache-oppcache&gt;opportunistically cached
-     entry&lt;/a&gt;.&lt;/li&gt;
-
      &lt;li&gt;&lt;p&gt;If the URL being processed was flagged as an &quot;implicit
      entry&quot; in &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, then categorize the
      entry as a &lt;a href=#concept-appcache-implicit title=concept-appcache-implicit&gt;implicit
@@ -34575,8 +34544,8 @@
    cache&lt;/var&gt;, if it's not there already, and categorize this entry
    (whether newly added or not) as &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;the manifest&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Store the list of &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-   namespaces&lt;/a&gt;, and the URLs of the &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt; that they
+   &lt;li&gt;&lt;p&gt;Store the list of &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback namespaces&lt;/a&gt;,
+   and the URLs of the &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entries&lt;/a&gt; that they
    map to, in the new cache.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Store the URLs that form the new &lt;a href=#concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online whitelist&lt;/a&gt; in
@@ -34662,24 +34631,24 @@
   Web applications is part of the &lt;a href=#navigate title=navigate&gt;navigation&lt;/a&gt; model, but references the
   algorithms defined in this section.&lt;/p&gt;
 
-  &lt;p&gt;A URL &lt;dfn id=concept-appcache-matches-oppcache title=concept-appcache-matches-oppcache&gt;matches an
-  opportunistic caching namespace&lt;/dfn&gt; if there exists an
-  &lt;a href=#application-cache&gt;application cache&lt;/a&gt; whose &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;manifest&lt;/a&gt;'s URL has the
+  &lt;p&gt;A URL &lt;dfn id=concept-appcache-matches-fallback title=concept-appcache-matches-fallback&gt;matches a
+  fallback namespace&lt;/dfn&gt; if there exists an &lt;a href=#application-cache&gt;application
+  cache&lt;/a&gt; whose &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;manifest&lt;/a&gt;'s URL has the
   &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the URL in question, and if that
-  application cache has an &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-  namespace&lt;/a&gt; with a &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt;
-  component that exactly matches the start of the &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt; component of the URL being
-  examined. If multiple opportunistic caching namespaces match the
-  same URL, the one with the longest &lt;path&gt; component is the one
-  that matches. A URL looking for an opportunistic caching namespace
-  can match more than one application cache at a time, but only
-  matches one namespace in each cache.&lt;/p&gt;
+  application cache has a &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback namespace&lt;/a&gt; with
+  a &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt; component that is a
+  &lt;a href=#prefix-match&gt;prefix match&lt;/a&gt; for the &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt; component of the URL being
+  examined. If multiple fallback namespaces match the same URL, the
+  one with the longest &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt; component is the one
+  that matches. A URL looking for an fallback namespace can match more
+  than one application cache at a time, but only matches one namespace
+  in each cache.&lt;/p&gt;
 
   &lt;div class=example&gt;
 
    &lt;p&gt;If a manifest &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/app1/manifest&lt;/code">http://example.com/app1/manifest&lt;/code</A>&gt; declares that
-   &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/resources/images&lt;/code">http://example.com/resources/images&lt;/code</A>&gt; should be
-   opportunistically cached, and the user navigates to &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/resources/images/cat.png&lt;/code">http://example.com/resources/images/cat.png&lt;/code</A>&gt;, then
+   &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/resources/images&lt;/code">http://example.com/resources/images&lt;/code</A>&gt; is a
+   fallback namespace, and the user navigates to &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/resources/images/cat.png&lt;/code">http://example.com/resources/images/cat.png&lt;/code</A>&gt;, then
    the user agent will decide that the application cache identified by
    &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/app1/manifest&lt;/code">http://example.com/app1/manifest&lt;/code</A>&gt; contains a
    namespace with a match for that URL.&lt;/p&gt;
@@ -34822,37 +34791,34 @@
    mechanism or equivalent, then &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resource
    normally and abort these steps.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If the resource's URL is &lt;a href=#concept-appcache-implicit title=concept-appcache-implicit&gt;an implicit entry&lt;/a&gt;, &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;the manifest&lt;/a&gt;, &lt;a href=#concept-appcache-explicit title=concept-appcache-explicit&gt;an explicit entry&lt;/a&gt;, &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;a fallback entry&lt;/a&gt;, &lt;a href=#concept-appcache-oppcache title=concept-appcache-oppcache&gt;an opportunistically cached
-   entry&lt;/a&gt;, or a &lt;a href=#concept-appcache-dynamic title=concept-appcache-dynamic&gt;dynamic
-   entry&lt;/a&gt; in the &lt;a href=#application-cache&gt;application cache&lt;/a&gt;, then get the
-   resource from the cache (instead of fetching it), and abort these
-   steps.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;If the resource's URL is &lt;a href=#concept-appcache-implicit title=concept-appcache-implicit&gt;an implicit entry&lt;/a&gt;, &lt;a href=#concept-appcache-manifest title=concept-appcache-manifest&gt;the manifest&lt;/a&gt;, &lt;a href=#concept-appcache-explicit title=concept-appcache-explicit&gt;an explicit entry&lt;/a&gt;, &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;a fallback entry&lt;/a&gt;, or a
+   &lt;a href=#concept-appcache-dynamic title=concept-appcache-dynamic&gt;dynamic entry&lt;/a&gt; in the
+   &lt;a href=#application-cache&gt;application cache&lt;/a&gt;, then get the resource from the
+   cache (instead of fetching it), and abort these steps.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If there is an entry in the &lt;a href=#application-cache&gt;application cache&lt;/a&gt;'s
-   &lt;a href=#concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online
-   whitelist&lt;/a&gt; that has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the
-   resource's URL and that is a &lt;a href=#prefix-match&gt;prefix match&lt;/a&gt; for the
-   resource's URL, then &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resource normally and
-   abort these steps.&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;If the resource's URL has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the
-    manifest's URL, and there is an &lt;a href=#concept-appcache-oppcache-ns title=concept-appcache-oppcache-ns&gt;opportunistic caching
-    namespace&lt;/a&gt; in the &lt;a href=#application-cache&gt;application cache&lt;/a&gt; whose
-    &lt;path&gt; component is a &lt;a href=#prefix-match&gt;prefix match&lt;/a&gt; for the
-    resource's URL's &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt;
-    component, then:
+    manifest's URL, and there is a &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback namespace&lt;/a&gt; in
+    the &lt;a href=#application-cache&gt;application cache&lt;/a&gt; whose &lt;path&gt; component is
+    a &lt;a href=#prefix-match&gt;prefix match&lt;/a&gt; for the resource's URL's &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt; component, then:&lt;/p&gt;
 
     &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource normally. If this results 4xx
     or 5xx status codes or equivalent, or if there were network errors
     (but not if the user canceled the download), then instead get,
     from the cache, the resource of the &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback entry&lt;/a&gt;
-    corresponding to the namespace with the longest matching
-    &lt;path&gt; component. Abort these steps.&lt;/p&gt;
+    corresponding to the namespace with the longest matching &lt;a href=#url-path title=url-path&gt;&lt;path&gt;&lt;/a&gt; component. Abort these
+    steps.&lt;/p&gt;
 
    &lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If there is an entry in the &lt;a href=#application-cache&gt;application cache&lt;/a&gt;'s
+   &lt;a href=#concept-appcache-onlinewhitelist title=concept-appcache-onlinewhitelist&gt;online
+   whitelist&lt;/a&gt; that has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the
+   resource's URL and that is a &lt;a href=#prefix-match&gt;prefix match&lt;/a&gt; for the
+   resource's URL, then &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resource normally and
+   abort these steps.&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;Fail the resource load.&lt;/li&gt;
 
   &lt;/ol&gt;&lt;p class=note&gt;The above algorithm ensures that resources that are
@@ -35710,55 +35676,36 @@
 
     &lt;p&gt;If the resource was not fetched from an &lt;a href=#application-cache&gt;application
     cache&lt;/a&gt;, and was to be fetched using HTTP GET or equivalent,
-    and its URL &lt;a href=#concept-appcache-matches-oppcache title=concept-appcache-matches-oppcache&gt;matches the
-    opportunistic caching namespace&lt;/a&gt; of one or more application
-    caches, and the user didn't cancel the navigation attempt during
-    the previous step, then:&lt;/p&gt;
+    and its URL &lt;a href=#concept-appcache-matches-fallback title=concept-appcache-matches-fallback&gt;matches the fallback
+    namespace&lt;/a&gt; of one or more application caches, and the user
+    didn't cancel the navigation attempt during the previous step, and
+    the browsing context being navigated is a &lt;a href=#top-level-browsing-context&gt;top-level browsing
+    context&lt;/a&gt;, and the navigation attempt failed (e.g. the server
+    returned a 4xx or 5xx status code or equivalent, or there was a
+    DNS error), then:&lt;/p&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;If the browsing context being navigated is a &lt;a href=#top-level-browsing-context&gt;top-level
-     browsing context&lt;/a&gt;, and the navigation attempt failed
-     (e.g. the server returned a 4xx or 5xx status code or equivalent,
-     or there was a DNS error)&lt;/dt&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback resource&lt;/a&gt;
+    specified for the &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback namespace&lt;/a&gt; in
+    question. If multiple application caches match, the user agent
+    must use the fallback of the &lt;a href=#concept-appcache-selection title=concept-appcache-selection&gt;most appropriate application
+    cache&lt;/a&gt; of those that match.&lt;/p&gt;
 
-     &lt;dd&gt;
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is not marked as &lt;a href=#concept-appcache-foreign title=concept-appcache-foreign&gt;foreign&lt;/a&gt;, then the user
+    agent must discard the failed load and instead continue along
+    these steps using &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; as the
+    resource.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the &lt;a href=#concept-appcache-fallback title=concept-appcache-fallback&gt;fallback resource&lt;/a&gt;
-      specified for the opportunistic caching namespace in
-      question. If multiple application caches match, the user agent
-      must use the fallback of the &lt;a href=#concept-appcache-selection title=concept-appcache-selection&gt;most appropriate application
-      cache&lt;/a&gt; of those that match.&lt;/p&gt;
+    &lt;p&gt;For the purposes of session history (and features that depend
+    on session history, e.g. bookmarking) the user agent must use the
+    URL of the resource that was requested (the one that matched the
+    &lt;a href=#concept-appcache-fallback-ns title=concept-appcache-fallback-ns&gt;fallback
+    namespace&lt;/a&gt;), not the fallback resource. However, the user
+    agent may indicate to the user that the original page load failed,
+    that the page used was a fallback resource, and what the URL of
+    the fallback resource actually is.&lt;/p&gt;
 
-      &lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is not marked as &lt;a href=#concept-appcache-foreign title=concept-appcache-foreign&gt;foreign&lt;/a&gt;, then the user
-      agent must discard the failed load and instead continue along
-      these steps using &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; as the
-      resource.&lt;/p&gt;
+   &lt;/li&gt;
 
-      &lt;p&gt;For the purposes of session history (and features that depend
-      on session history, e.g. bookmarking) the user agent must use
-      the URL of the resource that was requested (the one that matched
-      the opportunistic caching namespace), not the fallback
-      resource. However, the user agent may indicate to the user that
-      the original page load failed, that the page used was a fallback
-      resource, and what the URL of the fallback resource actually
-      is.&lt;/p&gt;
-
-     &lt;/dd&gt;
-
-     &lt;dt&gt;Otherwise&lt;/dt&gt;
-
-     &lt;dd&gt;
-
-      &lt;p&gt;Once the download is complete, if there were no errors and
-      the user didn't cancel the request, the user agent must cache
-      the resource in all the application caches that have a &lt;a href=#concept-appcache-matches-oppcache title=concept-appcache-matches-oppcache&gt;matching opportunistic
-      caching namespace&lt;/a&gt;, categorized as &lt;a href=#concept-appcache-oppcache title=concept-appcache-oppcache&gt;opportunistically cached
-      entries&lt;/a&gt;. Meanwhile, the user agent must continue along
-      these steps.&lt;/p&gt;
-
-     &lt;/dd&gt;
-
-    &lt;/dl&gt;&lt;/li&gt;
-
    &lt;li&gt;&lt;p&gt;If the document's out-of-band metadata (e.g. HTTP headers),
    not counting any &lt;a href=#content-type-0 title=Content-Type&gt;type information&lt;/a&gt;
    (such as the Content-Type HTTP header), requires some sort of
@@ -41094,8 +41041,8 @@
   must &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt; the &lt;a href=#url&gt;URL&lt;/a&gt;
   specified in &lt;var title=&quot;&quot;&gt;src&lt;/var&gt;, and if that succeeds, remove
   the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; from the &lt;a href=#concept-eventsource-list title=concept-eventsource-list&gt;list of event sources&lt;/a&gt; for
-  that object.  If the same URI has been registered multiple times,
-  removing it must remove only one instance of that URI for each
+  that object.  If the same URL has been registered multiple times,
+  removing it must remove only one instance of that URL for each
   invocation of the &lt;code title=removeEventSource&gt;removeEventSource()&lt;/code&gt; method. If the
   URL fails to resolve, the user agent does nothing.&lt;/p&gt;
 

Modified: source
===================================================================
--- source	2008-10-15 23:44:11 UTC (rev 2337)
+++ source	2008-10-16 00:33:17 UTC (rev 2338)
@@ -36099,8 +36099,8 @@
      identifier.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;scheme&lt;/var&gt; be the &lt;span
-     title=&quot;url-scheme&quot;&gt;&lt;scheme&gt;&lt;/span&gt; component of the URI,
-     &lt;span&gt;converted to lowercase&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+     title=&quot;url-scheme&quot;&gt;&lt;scheme&gt;&lt;/span&gt; component of &lt;var
+     title=&quot;&quot;&gt;url&lt;/var&gt;, &lt;span&gt;converted to lowercase&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;If the UA doesn't support the protocol given by &lt;var
      title=&quot;&quot;&gt;scheme&lt;/var&gt;, then return a new globally unique
@@ -38239,7 +38239,7 @@
    a document that uses that content type.&lt;/li&gt;
 
    &lt;li&gt;The user agent contacts the third party and hands the third
-   party the URI to the Intranet content.&lt;/li&gt;
+   party the URL to the Intranet content.&lt;/li&gt;
 
   &lt;/ol&gt;
 
@@ -38458,15 +38458,6 @@
      entries.
 
  
-     &lt;dt&gt;&lt;dfn title=&quot;concept-appcache-oppcache&quot;&gt;Opportunistically cached entries&lt;/dfn&gt;
-
-     &lt;dd&gt;Resources whose URLs &lt;span
-     title=&quot;concept-appcache-matches-oppcache&quot;&gt;matched&lt;/span&gt; an &lt;span
-     title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-     namespace&lt;/span&gt; when they were fetched, and were therefore
-     cached in the application cache.
-
- 
      &lt;dt&gt;&lt;dfn title=&quot;concept-appcache-dynamic&quot;&gt;Dynamic entries&lt;/dfn&gt;
 
      &lt;dd&gt;Resources that were added to the cache by the &lt;code
@@ -38481,18 +38472,17 @@
 
    &lt;/li&gt;
 
-   &lt;li&gt;Zero or more &lt;dfn
-   title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
+   &lt;li&gt;Zero or more &lt;dfn title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback
    namespaces&lt;/dfn&gt;: URLs, used as &lt;span
-   title=&quot;concept-appcache-matches-oppcache&quot;&gt;prefix match
+   title=&quot;concept-appcache-matches-fallback&quot;&gt;prefix match
    patterns&lt;/span&gt;, each of which is mapped to a &lt;span
    title=&quot;concept-appcache-fallback&quot;&gt;fallback entry&lt;/span&gt;. Each
-   namespace URL prefix, when parsed as a URL, has the &lt;span&gt;same
-   origin&lt;/span&gt; as &lt;span title=&quot;concept-appcache-manifest&quot;&gt;the
-   manifest&lt;/span&gt;.&lt;/li&gt;
+   namespace URL has the &lt;span&gt;same origin&lt;/span&gt; as &lt;span
+   title=&quot;concept-appcache-manifest&quot;&gt;the manifest&lt;/span&gt;.&lt;/li&gt;
 
    &lt;li&gt;Zero or more URLs that form the &lt;dfn
-   title=&quot;concept-appcache-onlinewhitelist&quot;&gt;online whitelist&lt;/dfn&gt;.
+   title=&quot;concept-appcache-onlinewhitelist&quot;&gt;online whitelist
+   namespaces&lt;/dfn&gt;.
 
   &lt;/ul&gt;
 
@@ -38659,19 +38649,18 @@
   empty.&lt;/p&gt;
 
   &lt;p&gt;URLs that are to be fallback pages associated with &lt;span
-  title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-  namespaces&lt;/span&gt;, and those namespaces themselves, must be given in
-  fallback sections, with the namespace being the first URL of the
-  data line, and the corresponding fallback page being the second
-  URL. All the other pages to be cached must be listed in explicit
-  sections.&lt;/p&gt;
+  title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback namespaces&lt;/span&gt;, and
+  those namespaces themselves, must be given in fallback sections,
+  with the namespace being the first URL of the data line, and the
+  corresponding fallback page being the second URL. All the other
+  pages to be cached must be listed in explicit sections.&lt;/p&gt;
 
-  &lt;p&gt;&lt;span title=&quot;concept-appcache-oppcache-ns&quot;&gt;Opportunistic caching
+  &lt;p&gt;&lt;span title=&quot;concept-appcache-fallback-ns&quot;&gt;Fallback
   namespaces&lt;/span&gt; must have the &lt;span&gt;same origin&lt;/span&gt; as the
   manifest itself.&lt;/p&gt;
 
-  &lt;p&gt;An opportunistic caching namespace must not be listed more than
-  once.&lt;/p&gt;
+  &lt;p&gt;A &lt;span title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback
+  namespace&lt;/span&gt; must not be listed more than once.&lt;/p&gt;
 
   &lt;p&gt;URLs that the user agent is to put into the &lt;span
   title=&quot;concept-appcache-onlinewhitelist&quot;&gt;online whitelist&lt;/span&gt;
@@ -38679,11 +38668,6 @@
   for any URL that the page is intending to use to communicate back to
   the server.)&lt;/p&gt;
 
-  &lt;p&gt;URLs in the online whitelist section must not also be listed in
-  explicit section, and must not be listed as fallback entries in the
-  fallback section. (URLs in the online whitelist section may match
-  opportunistic caching namespaces, however.)&lt;/p&gt;
-
   &lt;p&gt;Relative URLs must be given relative to the manifest's own
   URL.&lt;/p&gt;
 
@@ -38712,8 +38696,8 @@
    entries&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback URLs&lt;/var&gt; be an initially empty
-   mapping of &lt;span title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic
-   caching namespaces&lt;/span&gt; to &lt;span
+   mapping of &lt;span title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback
+   namespaces&lt;/span&gt; to &lt;span
    title=&quot;concept-appcache-fallback&quot;&gt;fallback entries&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;online whitelist URLs&lt;/var&gt; be an
@@ -38908,17 +38892,16 @@
 
       &lt;p&gt;If the &lt;span&gt;absolute URL&lt;/span&gt; corresponding to &lt;var
       title=&quot;&quot;&gt;part one&lt;/var&gt; is already in the &lt;var title=&quot;&quot;&gt;fallback
-      URIs&lt;/var&gt; mapping as an &lt;span
-      title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-      namespace&lt;/span&gt;, then jump back to the step labeled &quot;start of
-      line&quot;.&lt;/p&gt;
+      URLs&lt;/var&gt; mapping as a &lt;span
+      title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback namespace&lt;/span&gt;,
+      then jump back to the step labeled &quot;start of line&quot;.&lt;/p&gt;
 
       &lt;p&gt;Otherwise, add the &lt;span&gt;absolute URL&lt;/span&gt; corresponding to
       &lt;var title=&quot;&quot;&gt;part one&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;fallback
-      URIs&lt;/var&gt; mapping as an &lt;span
-      title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-      namespace&lt;/span&gt;, mapped to the &lt;span&gt;absolute URL&lt;/span&gt;
-      corresponding to &lt;var title=&quot;&quot;&gt;part two&lt;/var&gt; as the &lt;span
+      URLs&lt;/var&gt; mapping as a &lt;span
+      title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback namespace&lt;/span&gt;,
+      mapped to the &lt;span&gt;absolute URL&lt;/span&gt; corresponding to &lt;var
+      title=&quot;&quot;&gt;part two&lt;/var&gt; as the &lt;span
       title=&quot;concept-appcache-fallback&quot;&gt;fallback entry&lt;/span&gt;.&lt;/p&gt;
 
      &lt;/dd&gt;
@@ -38970,12 +38953,11 @@
 
   &lt;/ol&gt;
 
-  &lt;p class=&quot;note&quot;&gt;If a resource is listed in both the online whitelist
-  and in the explicit section, then that resource will be fetched and
-  cached, but when the page tries to use this resource, the user agent
-  will ignore the cached copy and attempt to fetch the file from the
-  network. Indeed, the cached copy will only be used if it is opened
-  from a top-level browsing context.&lt;/p&gt;
+  &lt;p class=&quot;note&quot;&gt;If a resource is listed in the explicit section and
+  matches an entry in the online whitelist, or if a resource matches
+  both an entry in the fallback section and the online whitelist, the
+  resource will taken from the cache, and the online whitelist entry
+  will be ignored.&lt;/p&gt;
 
 
   &lt;h4&gt;Updating an application cache&lt;/h4&gt;
@@ -39060,9 +39042,9 @@
     manifest&quot;&gt;rules for parsing manifests&lt;/span&gt;, obtaining a list of
     &lt;span title=&quot;concept-appcache-explicit&quot;&gt;explicit entries&lt;/span&gt;,
     &lt;span title=&quot;concept-appcache-fallback&quot;&gt;fallback entries&lt;/span&gt;
-    and the &lt;span title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic
-    caching namespaces&lt;/span&gt; that map to them, and entries for the
-    &lt;span title=&quot;concept-appcache-onlinewhitelist&quot;&gt;online
+    and the &lt;span title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback
+    namespaces&lt;/span&gt; that map to them, and entries for the &lt;span
+    title=&quot;concept-appcache-onlinewhitelist&quot;&gt;online
     whitelist&lt;/span&gt;.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -39152,16 +39134,6 @@
 
    &lt;li&gt;&lt;p&gt;If this is an &lt;span title=&quot;concept-appcache-upgrade&quot;&gt;upgrade
    attempt&lt;/span&gt;, then add all the URLs of &lt;span
-   title=&quot;concept-appcache-oppcache&quot;&gt;opportunistically cached
-   entries&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;cache&lt;/var&gt; that &lt;span
-   title=&quot;concept-appcache-matches-oppcache&quot;&gt;match&lt;/span&gt; the &lt;span
-   title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-   namespaces&lt;/span&gt; obtained by parsing &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt;
-   to &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, each flagged with &quot;opportunistic
-   entry&quot;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If this is an &lt;span title=&quot;concept-appcache-upgrade&quot;&gt;upgrade
-   attempt&lt;/span&gt;, then add all the URLs of &lt;span
    title=&quot;concept-appcache-implicit&quot;&gt;implicit entries&lt;/span&gt; in &lt;var
    title=&quot;&quot;&gt;cache&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, each flagged
    with &quot;implicit entry&quot;.&lt;/p&gt;&lt;/li&gt;
@@ -39237,12 +39209,6 @@
      entry as a &lt;span title=&quot;concept-appcache-fallback&quot;&gt;fallback
      entry&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;If the URL being processed was flagged as a &quot;opportunistic
-     entry&quot; in &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, then categorize the
-     entry as an &lt;span
-     title=&quot;concept-appcache-oppcache&quot;&gt;opportunistically cached
-     entry&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
-
      &lt;li&gt;&lt;p&gt;If the URL being processed was flagged as an &quot;implicit
      entry&quot; in &lt;var title=&quot;&quot;&gt;file list&lt;/var&gt;, then categorize the
      entry as a &lt;span title=&quot;concept-appcache-implicit&quot;&gt;implicit
@@ -39263,8 +39229,8 @@
    title=&quot;concept-appcache-manifest&quot;&gt;the manifest&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Store the list of &lt;span
-   title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-   namespaces&lt;/span&gt;, and the URLs of the &lt;span
+   title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback namespaces&lt;/span&gt;,
+   and the URLs of the &lt;span
    title=&quot;concept-appcache-fallback&quot;&gt;fallback entries&lt;/span&gt; that they
    map to, in the new cache.&lt;/p&gt;&lt;/li&gt;
 
@@ -39370,28 +39336,28 @@
   title=&quot;navigate&quot;&gt;navigation&lt;/span&gt; model, but references the
   algorithms defined in this section.&lt;/p&gt;
 
-  &lt;p&gt;A URL &lt;dfn title=&quot;concept-appcache-matches-oppcache&quot;&gt;matches an
-  opportunistic caching namespace&lt;/dfn&gt; if there exists an
-  &lt;span&gt;application cache&lt;/span&gt; whose &lt;span
+  &lt;p&gt;A URL &lt;dfn title=&quot;concept-appcache-matches-fallback&quot;&gt;matches a
+  fallback namespace&lt;/dfn&gt; if there exists an &lt;span&gt;application
+  cache&lt;/span&gt; whose &lt;span
   title=&quot;concept-appcache-manifest&quot;&gt;manifest&lt;/span&gt;'s URL has the
   &lt;span&gt;same origin&lt;/span&gt; as the URL in question, and if that
-  application cache has an &lt;span
-  title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-  namespace&lt;/span&gt; with a &lt;span title=&quot;url-path&quot;&gt;&lt;path&gt;&lt;/span&gt;
-  component that exactly matches the start of the &lt;span
+  application cache has a &lt;span
+  title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback namespace&lt;/span&gt; with
+  a &lt;span title=&quot;url-path&quot;&gt;&lt;path&gt;&lt;/span&gt; component that is a
+  &lt;span&gt;prefix match&lt;/span&gt; for the &lt;span
   title=&quot;url-path&quot;&gt;&lt;path&gt;&lt;/span&gt; component of the URL being
-  examined. If multiple opportunistic caching namespaces match the
-  same URL, the one with the longest &lt;path&gt; component is the one
-  that matches. A URL looking for an opportunistic caching namespace
-  can match more than one application cache at a time, but only
-  matches one namespace in each cache.&lt;/p&gt;
+  examined. If multiple fallback namespaces match the same URL, the
+  one with the longest &lt;span title=&quot;url-path&quot;&gt;&lt;path&gt;&lt;/span&gt; component is the one
+  that matches. A URL looking for an fallback namespace can match more
+  than one application cache at a time, but only matches one namespace
+  in each cache.&lt;/p&gt;
 
   &lt;div class=&quot;example&quot;&gt;
 
    &lt;p&gt;If a manifest &lt;code
    title=&quot;&quot;&gt;<A HREF="http://example.com/app1/manifest&lt;/code">http://example.com/app1/manifest&lt;/code</A>&gt; declares that
-   &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/resources/images&lt;/code">http://example.com/resources/images&lt;/code</A>&gt; should be
-   opportunistically cached, and the user navigates to &lt;code
+   &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/resources/images&lt;/code">http://example.com/resources/images&lt;/code</A>&gt; is a
+   fallback namespace, and the user navigates to &lt;code
    title=&quot;&quot;&gt;<A HREF="http://example.com/resources/images/cat.png&lt;/code">http://example.com/resources/images/cat.png&lt;/code</A>&gt;, then
    the user agent will decide that the application cache identified by
    &lt;code title=&quot;&quot;&gt;<A HREF="http://example.com/app1/manifest&lt;/code">http://example.com/app1/manifest&lt;/code</A>&gt; contains a
@@ -39560,40 +39526,38 @@
    title=&quot;concept-appcache-implicit&quot;&gt;an implicit entry&lt;/span&gt;, &lt;span
    title=&quot;concept-appcache-manifest&quot;&gt;the manifest&lt;/span&gt;, &lt;span
    title=&quot;concept-appcache-explicit&quot;&gt;an explicit entry&lt;/span&gt;, &lt;span
-   title=&quot;concept-appcache-fallback&quot;&gt;a fallback entry&lt;/span&gt;, &lt;span
-   title=&quot;concept-appcache-oppcache&quot;&gt;an opportunistically cached
-   entry&lt;/span&gt;, or a &lt;span title=&quot;concept-appcache-dynamic&quot;&gt;dynamic
-   entry&lt;/span&gt; in the &lt;span&gt;application cache&lt;/span&gt;, then get the
-   resource from the cache (instead of fetching it), and abort these
-   steps.&lt;/p&gt;&lt;/li&gt;
+   title=&quot;concept-appcache-fallback&quot;&gt;a fallback entry&lt;/span&gt;, or a
+   &lt;span title=&quot;concept-appcache-dynamic&quot;&gt;dynamic entry&lt;/span&gt; in the
+   &lt;span&gt;application cache&lt;/span&gt;, then get the resource from the
+   cache (instead of fetching it), and abort these steps.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If there is an entry in the &lt;span&gt;application cache&lt;/span&gt;'s
-   &lt;span title=&quot;concept-appcache-onlinewhitelist&quot;&gt;online
-   whitelist&lt;/span&gt; that has the &lt;span&gt;same origin&lt;/span&gt; as the
-   resource's URL and that is a &lt;span&gt;prefix match&lt;/span&gt; for the
-   resource's URL, then &lt;span&gt;fetch&lt;/span&gt; the resource normally and
-   abort these steps.&lt;/p&gt;&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;If the resource's URL has the &lt;span&gt;same origin&lt;/span&gt; as the
-    manifest's URL, and there is an &lt;span
-    title=&quot;concept-appcache-oppcache-ns&quot;&gt;opportunistic caching
-    namespace&lt;/span&gt; in the &lt;span&gt;application cache&lt;/span&gt; whose
-    &lt;path&gt; component is a &lt;span&gt;prefix match&lt;/span&gt; for the
-    resource's URL's &lt;span title=&quot;url-path&quot;&gt;&lt;path&gt;&lt;/span&gt;
-    component, then:
+    manifest's URL, and there is a &lt;span
+    title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback namespace&lt;/span&gt; in
+    the &lt;span&gt;application cache&lt;/span&gt; whose &lt;path&gt; component is
+    a &lt;span&gt;prefix match&lt;/span&gt; for the resource's URL's &lt;span
+    title=&quot;url-path&quot;&gt;&lt;path&gt;&lt;/span&gt; component, then:&lt;/p&gt;
 
     &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resource normally. If this results 4xx
     or 5xx status codes or equivalent, or if there were network errors
     (but not if the user canceled the download), then instead get,
     from the cache, the resource of the &lt;span
     title=&quot;concept-appcache-fallback&quot;&gt;fallback entry&lt;/span&gt;
-    corresponding to the namespace with the longest matching
-    &lt;path&gt; component. Abort these steps.&lt;/p&gt;
+    corresponding to the namespace with the longest matching &lt;span
+    title=&quot;url-path&quot;&gt;&lt;path&gt;&lt;/span&gt; component. Abort these
+    steps.&lt;/p&gt;
 
    &lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If there is an entry in the &lt;span&gt;application cache&lt;/span&gt;'s
+   &lt;span title=&quot;concept-appcache-onlinewhitelist&quot;&gt;online
+   whitelist&lt;/span&gt; that has the &lt;span&gt;same origin&lt;/span&gt; as the
+   resource's URL and that is a &lt;span&gt;prefix match&lt;/span&gt; for the
+   resource's URL, then &lt;span&gt;fetch&lt;/span&gt; the resource normally and
+   abort these steps.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;Fail the resource load.&lt;/p&gt;&lt;/li&gt;
 
   &lt;/ol&gt;
@@ -40594,62 +40558,38 @@
     &lt;p&gt;If the resource was not fetched from an &lt;span&gt;application
     cache&lt;/span&gt;, and was to be fetched using HTTP GET or equivalent,
     and its URL &lt;span
-    title=&quot;concept-appcache-matches-oppcache&quot;&gt;matches the
-    opportunistic caching namespace&lt;/span&gt; of one or more application
-    caches, and the user didn't cancel the navigation attempt during
-    the previous step, then:&lt;/p&gt;
+    title=&quot;concept-appcache-matches-fallback&quot;&gt;matches the fallback
+    namespace&lt;/span&gt; of one or more application caches, and the user
+    didn't cancel the navigation attempt during the previous step, and
+    the browsing context being navigated is a &lt;span&gt;top-level browsing
+    context&lt;/span&gt;, and the navigation attempt failed (e.g. the server
+    returned a 4xx or 5xx status code or equivalent, or there was a
+    DNS error), then:&lt;/p&gt;
 
-    &lt;dl class=&quot;switch&quot;&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the &lt;span
+    title=&quot;concept-appcache-fallback&quot;&gt;fallback resource&lt;/span&gt;
+    specified for the &lt;span
+    title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback namespace&lt;/span&gt; in
+    question. If multiple application caches match, the user agent
+    must use the fallback of the &lt;span
+    title=&quot;concept-appcache-selection&quot;&gt;most appropriate application
+    cache&lt;/span&gt; of those that match.&lt;/p&gt;
 
-     &lt;dt&gt;If the browsing context being navigated is a &lt;span&gt;top-level
-     browsing context&lt;/span&gt;, and the navigation attempt failed
-     (e.g. the server returned a 4xx or 5xx status code or equivalent,
-     or there was a DNS error)&lt;/dt&gt;
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is not marked as &lt;span
+    title=&quot;concept-appcache-foreign&quot;&gt;foreign&lt;/span&gt;, then the user
+    agent must discard the failed load and instead continue along
+    these steps using &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; as the
+    resource.&lt;/p&gt;
 
-     &lt;dd&gt;
+    &lt;p&gt;For the purposes of session history (and features that depend
+    on session history, e.g. bookmarking) the user agent must use the
+    URL of the resource that was requested (the one that matched the
+    &lt;span title=&quot;concept-appcache-fallback-ns&quot;&gt;fallback
+    namespace&lt;/span&gt;), not the fallback resource. However, the user
+    agent may indicate to the user that the original page load failed,
+    that the page used was a fallback resource, and what the URL of
+    the fallback resource actually is.&lt;/p&gt;
 
-      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the &lt;span
-      title=&quot;concept-appcache-fallback&quot;&gt;fallback resource&lt;/span&gt;
-      specified for the opportunistic caching namespace in
-      question. If multiple application caches match, the user agent
-      must use the fallback of the &lt;span
-      title=&quot;concept-appcache-selection&quot;&gt;most appropriate application
-      cache&lt;/span&gt; of those that match.&lt;/p&gt;
-
-      &lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is not marked as &lt;span
-      title=&quot;concept-appcache-foreign&quot;&gt;foreign&lt;/span&gt;, then the user
-      agent must discard the failed load and instead continue along
-      these steps using &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; as the
-      resource.&lt;/p&gt;
-
-      &lt;p&gt;For the purposes of session history (and features that depend
-      on session history, e.g. bookmarking) the user agent must use
-      the URL of the resource that was requested (the one that matched
-      the opportunistic caching namespace), not the fallback
-      resource. However, the user agent may indicate to the user that
-      the original page load failed, that the page used was a fallback
-      resource, and what the URL of the fallback resource actually
-      is.&lt;/p&gt;
-
-     &lt;/dd&gt;
-
-     &lt;dt&gt;Otherwise&lt;/dt&gt;
-
-     &lt;dd&gt;
-
-      &lt;p&gt;Once the download is complete, if there were no errors and
-      the user didn't cancel the request, the user agent must cache
-      the resource in all the application caches that have a &lt;span
-      title=&quot;concept-appcache-matches-oppcache&quot;&gt;matching opportunistic
-      caching namespace&lt;/span&gt;, categorized as &lt;span
-      title=&quot;concept-appcache-oppcache&quot;&gt;opportunistically cached
-      entries&lt;/span&gt;. Meanwhile, the user agent must continue along
-      these steps.&lt;/p&gt;
-
-     &lt;/dd&gt;
-
-    &lt;/dl&gt;
-
    &lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the document's out-of-band metadata (e.g. HTTP headers),
@@ -46821,8 +46761,8 @@
   specified in &lt;var title=&quot;&quot;&gt;src&lt;/var&gt;, and if that succeeds, remove
   the resulting &lt;span&gt;absolute URL&lt;/span&gt; from the &lt;span
   title=&quot;concept-eventsource-list&quot;&gt;list of event sources&lt;/span&gt; for
-  that object.  If the same URI has been registered multiple times,
-  removing it must remove only one instance of that URI for each
+  that object.  If the same URL has been registered multiple times,
+  removing it must remove only one instance of that URL for each
   invocation of the &lt;code
   title=&quot;removeEventSource&quot;&gt;removeEventSource()&lt;/code&gt; method. If the
   URL fails to resolve, the user agent does nothing.&lt;/p&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009222.html">[html5] r2337 - [gwr] (2) Make the online whitelist a prefix match	feature, not an exact match f [...]
</A></li>
	<LI>Next message: <A HREF="009224.html">[html5] r2339 - [gwr] (2) handle captive portals better in the	offline appcache feature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9223">[ date ]</a>
              <a href="thread.html#9223">[ thread ]</a>
              <a href="subject.html#9223">[ subject ]</a>
              <a href="author.html#9223">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
