<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2034 - [] (1) Define outerHTML for HTML elements in HTML	documents.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2034%20-%20%5B%5D%20%281%29%20Define%20outerHTML%20for%20HTML%20elements%20in%20HTML%0A%09documents.&In-Reply-To=%3C20080810222346.F162C1428AB%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008919.html">
   <LINK REL="Next"  HREF="008921.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2034 - [] (1) Define outerHTML for HTML elements in HTML	documents.</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2034%20-%20%5B%5D%20%281%29%20Define%20outerHTML%20for%20HTML%20elements%20in%20HTML%0A%09documents.&In-Reply-To=%3C20080810222346.F162C1428AB%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2034 - [] (1) Define outerHTML for HTML elements in HTML	documents.">whatwg at whatwg.org
       </A><BR>
    <I>Sun Aug 10 15:23:46 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008919.html">[html5] r2033 - [e] (0) Removing note -- bz is probably right,	but we've had even more feedback  [...]
</A></li>
        <LI>Next message: <A HREF="008921.html">[html5] r2035 - [] (0) Handle outerHTML on elements inside	DocumentFragments, because I'm stupid [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8920">[ date ]</a>
              <a href="thread.html#8920">[ thread ]</a>
              <a href="subject.html#8920">[ subject ]</a>
              <a href="author.html#8920">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-08-10 15:23:45 -0700 (Sun, 10 Aug 2008)
New Revision: 2034

Modified:
   index
   source
Log:
[] (1) Define outerHTML for HTML elements in HTML documents.

Modified: index
===================================================================
--- index	2008-08-10 06:24:55 UTC (rev 2033)
+++ index	2008-08-10 22:23:45 UTC (rev 2034)
@@ -7633,7 +7633,7 @@
 
   // &lt;a href=&quot;#dynamic3&quot;&gt;dynamic markup insertion&lt;/a&gt;
            attribute DOMString &lt;a href=&quot;#innerhtml&quot; title=dom-innerHTML&gt;innerHTML&lt;/a&gt;;
-           attribute DOMString &lt;span title=dom-outerHTML&gt;outerHTML&lt;/span&gt;;
+           attribute DOMString &lt;a href=&quot;#outerhtml&quot; title=dom-outerHTML&gt;outerHTML&lt;/a&gt;;
 
   // &lt;span&gt;metadata attributes&lt;/span&gt;
            attribute DOMString &lt;a href=&quot;#id0&quot; title=dom-id&gt;id&lt;/a&gt;;
@@ -8702,9 +8702,10 @@
 
   &lt;p&gt;The &lt;code title=dom-document-write&gt;&lt;a
    href=&quot;#document.write&quot;&gt;document.write()&lt;/a&gt;&lt;/code&gt; family of methods and
-   the &lt;code title=dom-innerHTML&gt;&lt;a href=&quot;#innerhtml&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt;
-   family of DOM attributes enable script authors to dynamically insert
-   markup into the document.
+   the &lt;code title=dom-innerHTML&gt;&lt;a
+   href=&quot;#innerhtml&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt;/&lt;code title=dom-outerHTML&gt;&lt;a
+   href=&quot;#outerhtml&quot;&gt;outerHTML&lt;/a&gt;&lt;/code&gt; family of DOM attributes enable
+   script authors to dynamically insert markup into the document.
 
   &lt;p&gt;Because these APIs interact with the parser, their behavior varies
    depending on whether they are used with &lt;a href=&quot;#html-&quot;&gt;HTML
@@ -8717,28 +8718,36 @@
     &lt;tr&gt;
      &lt;td&gt;
 
-     &lt;th&gt;&lt;dfn id=document.write
-      title=dom-document-write&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt;
+     &lt;th&gt;For documents that are &lt;a href=&quot;#html-&quot;&gt;HTML documents&lt;/a&gt;
 
-     &lt;th&gt;&lt;dfn id=innerhtml title=dom-innerHTML&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt;
+     &lt;th&gt;For documents that are &lt;a href=&quot;#xml-documents&quot;&gt;XML documents&lt;/a&gt;
 
    &lt;tbody&gt;
     &lt;tr&gt;
-     &lt;th&gt;For documents that are &lt;a href=&quot;#html-&quot;&gt;HTML documents&lt;/a&gt;
+     &lt;th&gt;&lt;dfn id=document.write
+      title=dom-document-write&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt;
 
      &lt;td&gt;&lt;a href=&quot;#document.write...&quot;
       title=dom-document-write-HTML&gt;&lt;code&gt;document.write()&lt;/code&gt; in HTML&lt;/a&gt;
 
+     &lt;td&gt;&lt;a href=&quot;#document.write0&quot;
+      title=dom-document-write-XML&gt;&lt;code&gt;document.write()&lt;/code&gt; in XML&lt;/a&gt;
+
+    &lt;tr&gt;
+     &lt;th&gt;&lt;dfn id=innerhtml title=dom-innerHTML&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt;
+
      &lt;td&gt;&lt;a href=&quot;#innerhtml0&quot;
       title=dom-innerHTML-HTML&gt;&lt;code&gt;innerHTML&lt;/code&gt; in HTML&lt;/a&gt;
 
+     &lt;td&gt;&lt;span title=dom-innerHTML-XML&gt;&lt;code&gt;innerHTML&lt;/code&gt; in XML&lt;/span&gt;
+
     &lt;tr&gt;
-     &lt;th&gt;For documents that are &lt;a href=&quot;#xml-documents&quot;&gt;XML documents&lt;/a&gt;
+     &lt;th&gt;&lt;dfn id=outerhtml title=dom-outerHTML&gt;&lt;code&gt;outerHTML&lt;/code&gt;&lt;/dfn&gt;
 
-     &lt;td&gt;&lt;a href=&quot;#document.write0&quot;
-      title=dom-document-write-XML&gt;&lt;code&gt;document.write()&lt;/code&gt; in XML&lt;/a&gt;
+     &lt;td&gt;&lt;a href=&quot;#outerhtml0&quot;
+      title=dom-outerHTML-HTML&gt;&lt;code&gt;outerHTML&lt;/code&gt; in HTML&lt;/a&gt;
 
-     &lt;td&gt;&lt;a href=&quot;#innerhtml1&quot; title=dom-innerHTML-XML&gt;&lt;code&gt;innerHTML&lt;/code&gt;
+     &lt;td&gt;&lt;a href=&quot;#outerhtml1&quot; title=dom-outerHTML-XML&gt;&lt;code&gt;outerHTML&lt;/code&gt;
       in XML&lt;/a&gt;
   &lt;/table&gt;
 
@@ -8935,21 +8944,14 @@
     &lt;p&gt;Finally, the method must return.&lt;/p&gt;
   &lt;/ol&gt;
 
-  &lt;p&gt;In HTML, the &lt;dfn id=innerhtml0
-   title=dom-innerHTML-HTML&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt; DOM attribute of all
-   &lt;code&gt;&lt;a href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a
-   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; nodes returns a serialization
-   of the node's children using the &lt;span&gt;HTML syntax&lt;/span&gt;&lt;!-- XXX xref
-  --&gt;.
-   On setting, it replaces the node's children with new nodes that result
-   from parsing the given value. The formal definitions follow.
+  &lt;hr&gt;
 
-  &lt;p&gt;On getting, the &lt;code title=dom-innerHTML-HTML&gt;&lt;a
-   href=&quot;#innerhtml0&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; DOM attribute must return the
-   result of running the &lt;a href=&quot;#html-fragment&quot;&gt;HTML fragment serialization
-   algorithm&lt;/a&gt; on the node.
+  &lt;p&gt;On getting, the &lt;dfn id=innerhtml0
+   title=dom-innerHTML-HTML&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt; DOM attribute must
+   return the result of running the &lt;a href=&quot;#html-fragment&quot;&gt;HTML fragment
+   serialization algorithm&lt;/a&gt; on the node.
 
-  &lt;p&gt;On setting, if the node is a document, the &lt;code
+  &lt;p&gt;On setting, &lt;strong&gt;if the node is a document&lt;/strong&gt;, the &lt;code
    title=dom-innerHTML-HTML&gt;&lt;a href=&quot;#innerhtml0&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; DOM
    attribute must run the following algorithm:
 
@@ -9034,10 +9036,70 @@
      preserving their order.&lt;/p&gt;
   &lt;/ol&gt;
 
+  &lt;hr&gt;
+
+  &lt;p&gt;On getting, the &lt;dfn id=outerhtml0
+   title=dom-outerHTML-HTML&gt;&lt;code&gt;outerHTML&lt;/code&gt;&lt;/dfn&gt; DOM attribute must
+   return the result of running the &lt;a href=&quot;#html-fragment&quot;&gt;HTML fragment
+   serialization algorithm&lt;/a&gt; on a fictional node whose only child is the
+   node on which the attribute was invoked.
+
+  &lt;p&gt;On setting, the &lt;code title=dom-outerHTML-HTML&gt;&lt;a
+   href=&quot;#outerhtml0&quot;&gt;outerHTML&lt;/a&gt;&lt;/code&gt; DOM attribute must cause the
+   following algorithm to run:
+
+  &lt;ol&gt;
+   &lt;li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target&lt;/var&gt; be the element whose &lt;code
+     title=dom-innerHTML-HTML&gt;&lt;a href=&quot;#innerhtml0&quot;&gt;outerHTML&lt;/a&gt;&lt;/code&gt;
+     attribute is being set.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;target&lt;/var&gt; has no parent node, then abort these
+     steps. There would be no way to obtain a reference to the nodes created
+     even if the remaining steps were run.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;target&lt;/var&gt;'s parent node is a &lt;code&gt;Document&lt;/code&gt;
+     object, throw a &lt;code&gt;NO_MODIFICATION_ALLOWED_ERR&lt;/code&gt; exception and
+     abort these steps.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Invoke the &lt;a href=&quot;#html-fragment0&quot;&gt;HTML fragment parsing
+     algorithm&lt;/a&gt;, with &lt;var title=&quot;&quot;&gt;target&lt;/var&gt;'s parent element as the
+     &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element and the string being assigned into
+     the &lt;code title=dom-outerHTML-HTML&gt;&lt;a
+     href=&quot;#outerhtml0&quot;&gt;outerHTML&lt;/a&gt;&lt;/code&gt; attribute as the &lt;var
+     title=&quot;&quot;&gt;input&lt;/var&gt;. Let &lt;var title=&quot;&quot;&gt;new children&lt;/var&gt; be the result
+     of this algorithm.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target document&lt;/var&gt; be the &lt;code
+     title=&quot;&quot;&gt;ownerDocument&lt;/code&gt; of &lt;var title=&quot;&quot;&gt;target&lt;/var&gt;.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Set the &lt;code title=&quot;&quot;&gt;ownerDocument&lt;/code&gt; of all the nodes in &lt;var
+     title=&quot;&quot;&gt;new children&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;target document&lt;/var&gt;.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Remove &lt;var title=&quot;&quot;&gt;target&lt;/var&gt; from its parent node and insert in
+     its place all the &lt;var title=&quot;&quot;&gt;new children&lt;/var&gt; nodes, preserving
+     their order.&lt;/p&gt;
+  &lt;/ol&gt;
+
+  &lt;hr&gt;
+
+  &lt;p class=note&gt;The &lt;code title=dom-innerHTML-HTML&gt;&lt;a
+   href=&quot;#innerhtml0&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; attribute applies to both
+   &lt;code&gt;Element&lt;/code&gt; nodes as well as &lt;code&gt;Document&lt;/code&gt; nodes. The
+   &lt;code title=dom-outerHTML-HTML&gt;&lt;a href=&quot;#outerhtml0&quot;&gt;outerHTML&lt;/a&gt;&lt;/code&gt;
+   attribute, on the other hand, only applies to &lt;code&gt;Element&lt;/code&gt; nodes.
+
   &lt;p class=note&gt;&lt;code&gt;&lt;a href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt; elements inserted
    using &lt;code title=dom-innerHTML-HTML&gt;&lt;a
-   href=&quot;#innerhtml0&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; do not execute when they are
-   inserted.&lt;/p&gt;
+   href=&quot;#innerhtml0&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; and &lt;code
+   title=dom-outerHTML-HTML&gt;&lt;a href=&quot;#outerhtml0&quot;&gt;outerHTML&lt;/a&gt;&lt;/code&gt; do not
+   execute when they are inserted.&lt;/p&gt;
   &lt;!-- XXX must make sure we spec that innerHTML causes mutation
   events to fire, but document.write() doesn't. (the latter is already
   req-stated in the parser section, btw) --&gt;
@@ -9053,46 +9115,27 @@
   &lt;h4 id=dynamic2&gt;&lt;span class=secno&gt;3.7.3 &lt;/span&gt;Dynamic markup insertion in
    XML&lt;/h4&gt;
 
-  &lt;p&gt;In an XML context, the &lt;dfn id=document.write0
-   title=dom-document-write-XML&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt; method
-   must raise an &lt;code&gt;INVALID_ACCESS_ERR&lt;/code&gt; exception.&lt;/p&gt;
-  &lt;!--
-  For XHTML: content must be well-formed. Where does
-  it insert? Immediately after the script that called document.write()?&lt;/p&gt;
-  how do we handle async scripts vs sync scripts?
-
-Consider:
-data:text/xml,&lt;script xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;![CDATA[ document.write('&lt;foo&gt;Test&lt;/foo&gt;'); ]]&gt;&lt;/script&gt;
-data:text/xml,&lt;script xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;![CDATA[ alert('test'); alert(document.write); try { document.write('&lt;foo&gt;Test&lt;/foo&gt;'); alert(document.childNodes.length); } catch (e) { alert(e); } ]]&gt;&lt;/script&gt;
-
---&gt;
-
-  &lt;p&gt;On the other hand, however, the &lt;dfn id=innerhtml1
-   title=dom-innerHTML-XML&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt; attribute is indeed
-   usable in an XML context.
-
-  &lt;p&gt;In an XML context, the &lt;code title=dom-innerHTML-XML&gt;&lt;a
-   href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; DOM attribute on &lt;code&gt;&lt;a
-   href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt;s must return a string in the
-   form of an &lt;a href=&quot;<A HREF="http://www.w3.org/TR/xml/#wf-entities">http://www.w3.org/TR/xml/#wf-entities</A>&quot;&gt;internal
-   general parsed entity&lt;/a&gt;, and on &lt;code&gt;&lt;a
-   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;s must return a string in the
-   form of a &lt;a href=&quot;<A HREF="http://www.w3.org/TR/xml/#sec-well-formed">http://www.w3.org/TR/xml/#sec-well-formed</A>&quot;&gt;document
-   entity&lt;/a&gt;. The string returned must be XML namespace-well-formed and must
-   be an isomorphic serialization of all of that node's child nodes, in
-   document order. User agents may adjust prefixes and namespace declarations
-   in the serialization (and indeed might be forced to do so in some cases to
-   obtain namespace-well-formed XML). For the &lt;code
-   title=dom-innerHTML-XML&gt;&lt;a href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt;
-   attribute on &lt;code&gt;&lt;a href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt; objects,
-   if any of the elements in the serialization are in no namespace, the
-   default namespace in scope for those elements must be explicitly declared
-   as the empty string.&lt;!-- because otherwise round-tripping might break
+  &lt;p&gt;In an XML context, the &lt;code title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt;
+   DOM attribute on &lt;code&gt;&lt;a href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt;s must
+   return a string in the form of an &lt;a
+   href=&quot;<A HREF="http://www.w3.org/TR/xml/#wf-entities">http://www.w3.org/TR/xml/#wf-entities</A>&quot;&gt;internal general parsed
+   entity&lt;/a&gt;, and on &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;s
+   must return a string in the form of a &lt;a
+   href=&quot;<A HREF="http://www.w3.org/TR/xml/#sec-well-formed">http://www.w3.org/TR/xml/#sec-well-formed</A>&quot;&gt;document entity&lt;/a&gt;. The
+   string returned must be XML namespace-well-formed and must be an
+   isomorphic serialization of all of that node's child nodes, in document
+   order. User agents may adjust prefixes and namespace declarations in the
+   serialization (and indeed might be forced to do so in some cases to obtain
+   namespace-well-formed XML). For the &lt;code
+   title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; attribute on &lt;code&gt;&lt;a
+   href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt; objects, if any of the elements
+   in the serialization are in no namespace, the default namespace in scope
+   for those elements must be explicitly declared as the empty
+   string.&lt;!-- because otherwise round-tripping might break
   since it'll pick up the surrounding default ns when setting --&gt;
-   (This doesn't apply to the &lt;code title=dom-innerHTML-XML&gt;&lt;a
-   href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; attribute on &lt;code&gt;&lt;a
-   href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; objects.) &lt;a
-   href=&quot;#refsXML&quot;&gt;[XML]&lt;/a&gt; &lt;a href=&quot;#refsXMLNS&quot;&gt;[XMLNS]&lt;/a&gt;
+   (This doesn't apply to the &lt;code title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt;
+   attribute on &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;
+   objects.) &lt;a href=&quot;#refsXML&quot;&gt;[XML]&lt;/a&gt; &lt;a href=&quot;#refsXMLNS&quot;&gt;[XMLNS]&lt;/a&gt;
 
   &lt;p&gt;If any of the following cases are found in the DOM being serialized, the
    user agent must raise an &lt;code&gt;INVALID_STATE_ERR&lt;/code&gt; exception:
@@ -9134,8 +9177,8 @@
    attribute with a name that contains an equals sign (=) will raised an
    &lt;code&gt;INVALID_CHARACTER_ERR&lt;/code&gt; exception.
 
-  &lt;p&gt;On setting, in an XML context, the &lt;code title=dom-innerHTML-XML&gt;&lt;a
-   href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; DOM attribute on &lt;code&gt;&lt;a
+  &lt;p&gt;On setting, in an XML context, the &lt;code
+   title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; DOM attribute on &lt;code&gt;&lt;a
    href=&quot;#htmlelement&quot;&gt;HTMLElement&lt;/a&gt;&lt;/code&gt;s and &lt;code&gt;&lt;a
    href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;s must run the following
    algorithm:
@@ -9145,24 +9188,22 @@
     &lt;p&gt;The user agent must create a new &lt;span&gt;XML parser&lt;/span&gt;.&lt;/p&gt;
 
    &lt;li&gt;
-    &lt;p&gt;If the &lt;code title=dom-innerHTML-XML&gt;&lt;a
-     href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; attribute is being set on an
-     element, the user agent must &lt;span&gt;feed the parser&lt;/span&gt; just created
-     the string corresponding to the start tag of that element, declaring all
-     the namespace prefixes that are in scope on that element in the DOM, as
-     well as declaring the default namespace (if any) that is in scope on
-     that element in the DOM.&lt;/p&gt;
+    &lt;p&gt;If the &lt;code title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; attribute is
+     being set on an element, the user agent must &lt;span&gt;feed the
+     parser&lt;/span&gt; just created the string corresponding to the start tag of
+     that element, declaring all the namespace prefixes that are in scope on
+     that element in the DOM, as well as declaring the default namespace (if
+     any) that is in scope on that element in the DOM.&lt;/p&gt;
 
    &lt;li&gt;
     &lt;p&gt;The user agent must &lt;span&gt;feed the parser&lt;/span&gt; just created the
-     string being assigned into the &lt;code title=dom-innerHTML-XML&gt;&lt;a
-     href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; attribute.&lt;/p&gt;
+     string being assigned into the &lt;code
+     title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; attribute.&lt;/p&gt;
 
    &lt;li&gt;
-    &lt;p&gt;If the &lt;code title=dom-innerHTML-XML&gt;&lt;a
-     href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; attribute is being set on an
-     element, the user agent must &lt;span&gt;feed the parser&lt;/span&gt; the string
-     corresponding to the end tag of that element.&lt;/p&gt;
+    &lt;p&gt;If the &lt;code title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; attribute is
+     being set on an element, the user agent must &lt;span&gt;feed the
+     parser&lt;/span&gt; the string corresponding to the end tag of that element.&lt;/p&gt;
 
    &lt;li&gt;
     &lt;p&gt;If the parser found a well-formedness error, the attribute's setter
@@ -9170,8 +9211,7 @@
 
    &lt;li&gt;
     &lt;p&gt;The user agent must remove the children nodes of the node whose &lt;code
-     title=dom-innerHTML-XML&gt;&lt;a href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt;
-     attribute is being set.&lt;/p&gt;
+     title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; attribute is being set.&lt;/p&gt;
 
    &lt;li&gt;
     &lt;p&gt;If the attribute is being set on a &lt;code&gt;Document&lt;/code&gt; node, let
@@ -9193,16 +9233,25 @@
 
    &lt;li&gt;
     &lt;p&gt;Append all the &lt;var title=&quot;&quot;&gt;new children&lt;/var&gt; nodes to the node
-     whose &lt;code title=dom-innerHTML-XML&gt;&lt;a
-     href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; attribute is being set,
-     preserving their order.&lt;/p&gt;
+     whose &lt;code title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; attribute is being
+     set, preserving their order.&lt;/p&gt;
   &lt;/ol&gt;
 
   &lt;p class=note&gt;&lt;code&gt;&lt;a href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt; elements inserted
-   using &lt;code title=dom-innerHTML-XML&gt;&lt;a
-   href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt; do not execute when they are
-   inserted.
+   using &lt;code title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; do not execute when
+   they are inserted.
 
+  &lt;p&gt;In an XML context, the &lt;dfn id=document.write0
+   title=dom-document-write-XML&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt; method,
+   and the &lt;dfn id=outerhtml1
+   title=dom-outerHTML-XML&gt;&lt;code&gt;outerHTML&lt;/code&gt;&lt;/dfn&gt; attribute on both
+   getting and setting, must raise an &lt;code&gt;INVALID_ACCESS_ERR&lt;/code&gt;
+   exception.&lt;/p&gt;
+  &lt;!--
+Where would document.write() insert?
+Consider: data:text/xml,&lt;script xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;![CDATA[ document.write('&lt;foo&gt;Test&lt;/foo&gt;'); ]]&gt;&lt;/script&gt;
+--&gt;
+
   &lt;h2 id=semantics&gt;&lt;span class=secno&gt;4. &lt;/span&gt;The elements of HTML&lt;/h2&gt;
 
   &lt;h3 id=the-root&gt;&lt;span class=secno&gt;4.1 &lt;/span&gt;The root element&lt;/h3&gt;
@@ -26136,10 +26185,9 @@
      href=&quot;#without&quot;&gt;without script&lt;/a&gt;, or if the &lt;code&gt;&lt;a
      href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt; element was created by an &lt;span&gt;XML
      parser&lt;/span&gt; that itself was created as part of the processing of the
-     &lt;code title=dom-innerHTML-XML&gt;&lt;a href=&quot;#innerhtml1&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt;
-     attribute's setter&lt;!--
+     &lt;code title=dom-innerHTML-XML&gt;innerHTML&lt;/code&gt; attribute's setter&lt;!--
     no need to worry about the innerHTML-HTML case, as the HTML parser
-    handles that for us--&gt;,
+    handles that for us, and outerHTML-XML doesn't work--&gt;,
      or if the user agent does not &lt;a href=&quot;#support&quot;&gt;support the scripting
      language&lt;/a&gt; given by &lt;var&gt;&lt;a href=&quot;#the-scripts&quot;&gt;the script's
      type&lt;/a&gt;&lt;/var&gt; for this &lt;code&gt;&lt;a href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt;
@@ -45872,14 +45920,14 @@
    here for now in case people think that the spec accidentally
    omitted it and try to &quot;fix&quot; it. Note that noscript-in-head is also
    handled this way. This is all intentional. The only thing it
-   doesn't handle is the scripting-enabled fragment parsing case for a
-   &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
+   doesn't handle is the scripting-disabled fragment parsing case for
+   a &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
    something other than a &lt;link&gt; or a &lt;style&gt; element; you'd expect
    that to break out of the &lt;noscript&gt; but it doesn't. This is an edge
    case that doesn't affect the spec, since the algorithm for fragment
-   parsing is only used for innerHTML, where we know scripting is
-   enabled. (XXX except maybe if innerHTML is set from another
-   browsing context on a document with designMode set?) --&gt;
+   parsing is only used for innerHTML/outerHTML, where we know
+   scripting is enabled. (XXX except maybe if innerHTML is set from
+   another browsing context on a document with designMode set?) --&gt;
 
    &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;&lt;a
     href=&quot;#body0&quot;&gt;body&lt;/a&gt;&lt;/code&gt; element, then switch the &lt;span&gt;insertion
@@ -49029,7 +49077,9 @@
      element as &quot;already executed&quot; prevents it from executing when it is
      inserted into the document a few paragraphs below. Thus, scripts missing
      their end tags and scripts that were inserted using &lt;code
-     title=dom-innerHTML-HTML&gt;&lt;a href=&quot;#innerhtml0&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt;
+     title=dom-innerHTML-HTML&gt;&lt;a
+     href=&quot;#innerhtml0&quot;&gt;innerHTML&lt;/a&gt;&lt;/code&gt;/&lt;code
+     title=dom-outerHTML-HTML&gt;&lt;a href=&quot;#outerhtml0&quot;&gt;outerHTML&lt;/a&gt;&lt;/code&gt;
      aren't executed.&lt;/p&gt;
 
     &lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;old insertion point&lt;/var&gt; have the same value as
@@ -51428,7 +51478,9 @@
      href=&quot;#html-fragment0&quot;&gt;HTML fragment parsing algorithm&lt;/a&gt;, this is a &lt;a
      href=&quot;#parse2&quot;&gt;parse error&lt;/a&gt;; ignore the token. (&lt;a
      href=&quot;#fragment&quot;&gt;fragment case&lt;/a&gt;)&lt;/p&gt;
-    &lt;!-- can only happen for &lt;html&gt;'s own innerHTML --&gt;
+    &lt;!-- can only happen for &lt;html&gt;'s own innerHTML or its children's
+    outerHTML --&gt;
+    
     &lt;p&gt;Otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;a
      href=&quot;#after12&quot; title=&quot;insertion mode: after after body&quot;&gt;after after
      body&lt;/a&gt;&quot;.&lt;/p&gt;
@@ -52018,7 +52070,7 @@
          element, then append the value of &lt;var title=&quot;&quot;&gt;current node&lt;/var&gt;'s
          &lt;code title=&quot;&quot;&gt;data&lt;/code&gt; DOM attribute literally.&lt;/p&gt;
         &lt;!-- note about noscript: we're
-        assuming here that scripting is disabled. If this algorithm is
+        assuming here that scripting is enabled. If this algorithm is
         used with scripting disabled, this won't work right. XXX This
         might affect calling innerHTML on nodes in a document that is
         being designMode'd --&gt;

Modified: source
===================================================================
--- source	2008-08-10 06:24:55 UTC (rev 2033)
+++ source	2008-08-10 22:23:45 UTC (rev 2034)
@@ -6612,7 +6612,8 @@
 
   &lt;p&gt;The &lt;code title=&quot;dom-document-write&quot;&gt;document.write()&lt;/code&gt;
   family of methods and the &lt;code
-  title=&quot;dom-innerHTML&quot;&gt;innerHTML&lt;/code&gt; family of DOM attributes
+  title=&quot;dom-innerHTML&quot;&gt;innerHTML&lt;/code&gt;/&lt;code
+  title=&quot;dom-outerHTML&quot;&gt;outerHTML&lt;/code&gt; family of DOM attributes
   enable script authors to dynamically insert markup into the
   document.&lt;/p&gt;
 
@@ -6627,21 +6628,26 @@
    &lt;thead&gt;
     &lt;tr&gt;
      &lt;td&gt;&lt;/td&gt;
-     &lt;th&gt;&lt;dfn title=&quot;dom-document-write&quot;&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt;&lt;/th&gt;
-     &lt;th&gt;&lt;dfn title=&quot;dom-innerHTML&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt;&lt;/th&gt;
+     &lt;th&gt;For documents that are &lt;span&gt;HTML documents&lt;/span&gt;&lt;/th&gt;
+     &lt;th&gt;For documents that are &lt;span&gt;XML documents&lt;/span&gt;&lt;/th&gt;
     &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
     &lt;tr&gt;
-     &lt;th&gt;For documents that are &lt;span&gt;HTML documents&lt;/span&gt;&lt;/th&gt;
+     &lt;th&gt;&lt;dfn title=&quot;dom-document-write&quot;&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt;&lt;/th&gt;
      &lt;td&gt;&lt;span title=&quot;dom-document-write-HTML&quot;&gt;&lt;code&gt;document.write()&lt;/code&gt; in HTML&lt;/span&gt;&lt;/td&gt;
-     &lt;td&gt;&lt;span title=&quot;dom-innerHTML-HTML&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt; in HTML&lt;/span&gt;&lt;/td&gt;
+     &lt;td&gt;&lt;span title=&quot;dom-document-write-XML&quot;&gt;&lt;code&gt;document.write()&lt;/code&gt; in XML&lt;/span&gt;&lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
-     &lt;th&gt;For documents that are &lt;span&gt;XML documents&lt;/span&gt;&lt;/th&gt;
-     &lt;td&gt;&lt;span title=&quot;dom-document-write-XML&quot;&gt;&lt;code&gt;document.write()&lt;/code&gt; in XML&lt;/span&gt;&lt;/td&gt;
+     &lt;th&gt;&lt;dfn title=&quot;dom-innerHTML&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt;&lt;/th&gt;
+     &lt;td&gt;&lt;span title=&quot;dom-innerHTML-HTML&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt; in HTML&lt;/span&gt;&lt;/td&gt;
      &lt;td&gt;&lt;span title=&quot;dom-innerHTML-XML&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt; in XML&lt;/span&gt;&lt;/td&gt;
     &lt;/tr&gt;
+    &lt;tr&gt;
+     &lt;th&gt;&lt;dfn title=&quot;dom-outerHTML&quot;&gt;&lt;code&gt;outerHTML&lt;/code&gt;&lt;/dfn&gt;&lt;/th&gt;
+     &lt;td&gt;&lt;span title=&quot;dom-outerHTML-HTML&quot;&gt;&lt;code&gt;outerHTML&lt;/code&gt; in HTML&lt;/span&gt;&lt;/td&gt;
+     &lt;td&gt;&lt;span title=&quot;dom-outerHTML-XML&quot;&gt;&lt;code&gt;outerHTML&lt;/code&gt; in XML&lt;/span&gt;&lt;/td&gt;
+    &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
 
@@ -6851,20 +6857,14 @@
 
   &lt;/ol&gt;
 
-  &lt;p&gt;In HTML, the &lt;dfn
+  &lt;hr&gt;
+
+  &lt;p&gt;On getting, the &lt;dfn
   title=&quot;dom-innerHTML-HTML&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt; DOM
-  attribute of all &lt;code&gt;HTMLElement&lt;/code&gt; and
-  &lt;code&gt;HTMLDocument&lt;/code&gt; nodes returns a serialization of the
-  node's children using the &lt;span&gt;HTML syntax&lt;/span&gt;&lt;!-- XXX xref
-  --&gt;. On setting, it replaces the node's children with new nodes that
-  result from parsing the given value. The formal definitions
-  follow.&lt;/p&gt;
+  attribute must return the result of running the &lt;span&gt;HTML fragment
+  serialization algorithm&lt;/span&gt; on the node.&lt;/p&gt;
 
-  &lt;p&gt;On getting, the &lt;code title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt;
-  DOM attribute must return the result of running the &lt;span&gt;HTML
-  fragment serialization algorithm&lt;/span&gt; on the node.&lt;/p&gt;
-
-  &lt;p&gt;On setting, if the node is a document, the &lt;code
+  &lt;p&gt;On setting, &lt;strong&gt;if the node is a document&lt;/strong&gt;, the &lt;code
   title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt; DOM attribute must run
   the following algorithm:&lt;/p&gt;
 
@@ -6979,8 +6979,92 @@
 
   &lt;/ol&gt;
 
+  &lt;hr&gt;
+
+  &lt;p&gt;On getting, the &lt;dfn
+  title=&quot;dom-outerHTML-HTML&quot;&gt;&lt;code&gt;outerHTML&lt;/code&gt;&lt;/dfn&gt; DOM
+  attribute must return the result of running the &lt;span&gt;HTML fragment
+  serialization algorithm&lt;/span&gt; on a fictional node whose only child
+  is the node on which the attribute was invoked.&lt;/p&gt;
+
+  &lt;p&gt;On setting, the &lt;code title=&quot;dom-outerHTML-HTML&quot;&gt;outerHTML&lt;/code&gt;
+  DOM attribute must cause the following algorithm to run:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target&lt;/var&gt; be the element whose &lt;code
+    title=&quot;dom-innerHTML-HTML&quot;&gt;outerHTML&lt;/code&gt; attribute is being
+    set.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;target&lt;/var&gt; has no parent node, then abort
+    these steps. There would be no way to obtain a reference to the
+    nodes created even if the remaining steps were run.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;target&lt;/var&gt;'s parent node is a
+    &lt;code&gt;Document&lt;/code&gt; object, throw a
+    &lt;code&gt;NO_MODIFICATION_ALLOWED_ERR&lt;/code&gt; exception and abort these
+    steps.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Invoke the &lt;span&gt;HTML fragment parsing algorithm&lt;/span&gt;, with
+    &lt;var title=&quot;&quot;&gt;target&lt;/var&gt;'s parent element as the &lt;var
+    title=&quot;&quot;&gt;context&lt;/var&gt; element and the string being assigned into
+    the &lt;code title=&quot;dom-outerHTML-HTML&quot;&gt;outerHTML&lt;/code&gt; attribute as
+    the &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;. Let &lt;var title=&quot;&quot;&gt;new
+    children&lt;/var&gt; be the result of this algorithm.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;target document&lt;/var&gt; be the &lt;code
+    title=&quot;&quot;&gt;ownerDocument&lt;/code&gt; of &lt;var title=&quot;&quot;&gt;target&lt;/var&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Set the &lt;code title=&quot;&quot;&gt;ownerDocument&lt;/code&gt; of all the nodes in
+    &lt;var title=&quot;&quot;&gt;new children&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;target
+    document&lt;/var&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Remove &lt;var title=&quot;&quot;&gt;target&lt;/var&gt; from its parent node and
+    insert in its place all the &lt;var title=&quot;&quot;&gt;new children&lt;/var&gt;
+    nodes, preserving their order.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;hr&gt;
+
+  &lt;p class=&quot;note&quot;&gt;The &lt;code
+  title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt; attribute applies to
+  both &lt;code&gt;Element&lt;/code&gt; nodes as well as &lt;code&gt;Document&lt;/code&gt;
+  nodes. The &lt;code title=&quot;dom-outerHTML-HTML&quot;&gt;outerHTML&lt;/code&gt;
+  attribute, on the other hand, only applies to &lt;code&gt;Element&lt;/code&gt;
+  nodes.&lt;/p&gt;
+
   &lt;p class=&quot;note&quot;&gt;&lt;code&gt;script&lt;/code&gt; elements inserted using &lt;code
-  title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt; do not execute when they
+  title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt; and &lt;code
+  title=&quot;dom-outerHTML-HTML&quot;&gt;outerHTML&lt;/code&gt; do not execute when they
   are inserted.&lt;/p&gt;
 
   &lt;!-- XXX must make sure we spec that innerHTML causes mutation
@@ -6999,25 +7083,6 @@
 
   &lt;h4&gt;Dynamic markup insertion in XML&lt;/h4&gt;
 
-  &lt;p&gt;In an XML context, the &lt;dfn
-  title=&quot;dom-document-write-XML&quot;&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt;
-  method must raise an &lt;code&gt;INVALID_ACCESS_ERR&lt;/code&gt; exception.&lt;/p&gt;
-
-&lt;!--
-  For XHTML: content must be well-formed. Where does
-  it insert? Immediately after the script that called document.write()?&lt;/p&gt;
-  how do we handle async scripts vs sync scripts?
-
-Consider:
-data:text/xml,&lt;script xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;![CDATA[ document.write('&lt;foo&gt;Test&lt;/foo&gt;'); ]]&gt;&lt;/script&gt;
-data:text/xml,&lt;script xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;![CDATA[ alert('test'); alert(document.write); try { document.write('&lt;foo&gt;Test&lt;/foo&gt;'); alert(document.childNodes.length); } catch (e) { alert(e); } ]]&gt;&lt;/script&gt;
-
---&gt;
-
-  &lt;p&gt;On the other hand, however, the &lt;dfn
-  title=&quot;dom-innerHTML-XML&quot;&gt;&lt;code&gt;innerHTML&lt;/code&gt;&lt;/dfn&gt; attribute is
-  indeed usable in an XML context.&lt;/p&gt;
-
   &lt;p&gt;In an XML context, the &lt;code
   title=&quot;dom-innerHTML-XML&quot;&gt;innerHTML&lt;/code&gt; DOM attribute on
   &lt;code&gt;HTMLElement&lt;/code&gt;s must return a string in the form of an &lt;a
@@ -7190,9 +7255,21 @@
   title=&quot;dom-innerHTML-XML&quot;&gt;innerHTML&lt;/code&gt; do not execute when they
   are inserted.&lt;/p&gt;
 
+  &lt;p&gt;In an XML context, the &lt;dfn
+  title=&quot;dom-document-write-XML&quot;&gt;&lt;code&gt;document.write()&lt;/code&gt;&lt;/dfn&gt;
+  method, and the &lt;dfn
+  title=&quot;dom-outerHTML-XML&quot;&gt;&lt;code&gt;outerHTML&lt;/code&gt;&lt;/dfn&gt; attribute on
+  both getting and setting, must raise an
+  &lt;code&gt;INVALID_ACCESS_ERR&lt;/code&gt; exception.&lt;/p&gt;
 
+&lt;!--
+Where would document.write() insert?
+Consider: data:text/xml,&lt;script xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot;&gt;&lt;![CDATA[ document.write('&lt;foo&gt;Test&lt;/foo&gt;'); ]]&gt;&lt;/script&gt;
+--&gt;
 
 
+
+
   &lt;h2 id=&quot;semantics&quot;&gt;The elements of HTML&lt;/h2&gt;
 
   &lt;h3&gt;The root element&lt;/h3&gt;
@@ -23449,12 +23526,12 @@
     the processing of the &lt;code
     title=&quot;dom-innerHTML-XML&quot;&gt;innerHTML&lt;/code&gt; attribute's setter&lt;!--
     no need to worry about the innerHTML-HTML case, as the HTML parser
-    handles that for us--&gt;, or if the user agent does not
-    &lt;span&gt;support the scripting language&lt;/span&gt; given by &lt;var&gt;the
-    script's type&lt;/var&gt; for this &lt;code&gt;script&lt;/code&gt; element, or if
-    the &lt;code&gt;script&lt;/code&gt; element has its &lt;span&gt;&quot;already
-    executed&quot;&lt;/span&gt; flag set, then the user agent must abort these
-    steps at this point. The script is not executed.&lt;/p&gt;
+    handles that for us, and outerHTML-XML doesn't work--&gt;, or if the
+    user agent does not &lt;span&gt;support the scripting language&lt;/span&gt;
+    given by &lt;var&gt;the script's type&lt;/var&gt; for this &lt;code&gt;script&lt;/code&gt;
+    element, or if the &lt;code&gt;script&lt;/code&gt; element has its
+    &lt;span&gt;&quot;already executed&quot;&lt;/span&gt; flag set, then the user agent must
+    abort these steps at this point. The script is not executed.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -43229,14 +43306,14 @@
    here for now in case people think that the spec accidentally
    omitted it and try to &quot;fix&quot; it. Note that noscript-in-head is also
    handled this way. This is all intentional. The only thing it
-   doesn't handle is the scripting-enabled fragment parsing case for a
-   &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
+   doesn't handle is the scripting-disabled fragment parsing case for
+   a &lt;head&gt; element containing a &lt;noscript&gt; which itself contains
    something other than a &lt;link&gt; or a &lt;style&gt; element; you'd expect
    that to break out of the &lt;noscript&gt; but it doesn't. This is an edge
    case that doesn't affect the spec, since the algorithm for fragment
-   parsing is only used for innerHTML, where we know scripting is
-   enabled. (XXX except maybe if innerHTML is set from another
-   browsing context on a document with designMode set?) --&gt;
+   parsing is only used for innerHTML/outerHTML, where we know
+   scripting is enabled. (XXX except maybe if innerHTML is set from
+   another browsing context on a document with designMode set?) --&gt;
 
    &lt;li&gt;If &lt;var title=&quot;&quot;&gt;node&lt;/var&gt; is a &lt;code&gt;body&lt;/code&gt; element,
    then switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
@@ -45822,11 +45899,11 @@
     executed). (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/p&gt;
 
     &lt;p class=&quot;note&quot;&gt;Marking the &lt;code&gt;script&lt;/code&gt; element as
-    &quot;already executed&quot; prevents it from executing when it is
-    inserted into the document a few paragraphs below. Thus,
-    scripts missing their end tags and scripts that were inserted
-    using &lt;code title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt; aren't
-    executed.&lt;/p&gt;
+    &quot;already executed&quot; prevents it from executing when it is inserted
+    into the document a few paragraphs below. Thus, scripts missing
+    their end tags and scripts that were inserted using &lt;code
+    title=&quot;dom-innerHTML-HTML&quot;&gt;innerHTML&lt;/code&gt;/&lt;code
+    title=&quot;dom-outerHTML-HTML&quot;&gt;outerHTML&lt;/code&gt; aren't executed.&lt;/p&gt;
 
     &lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;old insertion point&lt;/var&gt; have the
     same value as the current &lt;span&gt;insertion point&lt;/span&gt;. Let
@@ -48351,7 +48428,8 @@
     &lt;p&gt;If the parser was originally created as part of the &lt;span&gt;HTML
     fragment parsing algorithm&lt;/span&gt;, this is a &lt;span&gt;parse
     error&lt;/span&gt;; ignore the token.  (&lt;span&gt;fragment case&lt;/span&gt;)&lt;/p&gt;
-    &lt;!-- can only happen for &lt;html&gt;'s own innerHTML --&gt;
+    &lt;!-- can only happen for &lt;html&gt;'s own innerHTML or its children's
+    outerHTML --&gt;
 
     &lt;p&gt;Otherwise, switch the &lt;span&gt;insertion mode&lt;/span&gt; to &quot;&lt;span
     title=&quot;insertion mode: after after body&quot;&gt;after after
@@ -48962,7 +49040,7 @@
         &lt;code&gt;plaintext&lt;/code&gt; element, then append the value of &lt;var
         title=&quot;&quot;&gt;current node&lt;/var&gt;'s &lt;code title=&quot;&quot;&gt;data&lt;/code&gt; DOM
         attribute literally.&lt;/p&gt; &lt;!-- note about noscript: we're
-        assuming here that scripting is disabled. If this algorithm is
+        assuming here that scripting is enabled. If this algorithm is
         used with scripting disabled, this won't work right. XXX This
         might affect calling innerHTML on nodes in a document that is
         being designMode'd --&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008919.html">[html5] r2033 - [e] (0) Removing note -- bz is probably right,	but we've had even more feedback  [...]
</A></li>
	<LI>Next message: <A HREF="008921.html">[html5] r2035 - [] (0) Handle outerHTML on elements inside	DocumentFragments, because I'm stupid [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8920">[ date ]</a>
              <a href="thread.html#8920">[ thread ]</a>
              <a href="subject.html#8920">[ subject ]</a>
              <a href="author.html#8920">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
