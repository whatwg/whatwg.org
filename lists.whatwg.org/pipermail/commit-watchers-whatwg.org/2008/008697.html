<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r1799 - [] (0) Make the 'navigate' step resolve URLs. Make	the 'navigate' algorithm more [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1799%20-%20%5B%5D%20%280%29%20Make%20the%20%27navigate%27%20step%20resolve%20URLs.%20Make%0A%09the%20%27navigate%27%20algorithm%20more%20%5B...%5D&In-Reply-To=%3C20080625073807.E03F138E221%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008696.html">
   <LINK REL="Next"  HREF="008698.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r1799 - [] (0) Make the 'navigate' step resolve URLs. Make	the 'navigate' algorithm more [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1799%20-%20%5B%5D%20%280%29%20Make%20the%20%27navigate%27%20step%20resolve%20URLs.%20Make%0A%09the%20%27navigate%27%20algorithm%20more%20%5B...%5D&In-Reply-To=%3C20080625073807.E03F138E221%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r1799 - [] (0) Make the 'navigate' step resolve URLs. Make	the 'navigate' algorithm more [...]">whatwg at whatwg.org
       </A><BR>
    <I>Wed Jun 25 00:38:07 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008696.html">[html5] r1798 - [] (0) More work replacing references to 'URI' with	references to 'URL
</A></li>
        <LI>Next message: <A HREF="008698.html">[html5] r1800 - [e] (0) &lt;object&gt; element: bring some old prose in	line with future plans regardi [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8697">[ date ]</a>
              <a href="thread.html#8697">[ thread ]</a>
              <a href="subject.html#8697">[ subject ]</a>
              <a href="author.html#8697">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-06-25 00:38:07 -0700 (Wed, 25 Jun 2008)
New Revision: 1799

Modified:
   index
   source
Log:
[] (0) Make the 'navigate' step resolve URLs. Make the 'navigate' algorithm more precise and correct and consistent, in particular regarding fragment identifiers. Fix some xrefs in the 'navigate' algorithm. More URLing. Add a placeholder for defining the term 'fetching'.

Modified: index
===================================================================
--- index	2008-06-25 05:36:59 UTC (rev 1798)
+++ index	2008-06-25 07:38:07 UTC (rev 1799)
@@ -309,25 +309,28 @@
         strings&lt;/a&gt;
       &lt;/ul&gt;
 
-     &lt;li&gt;&lt;a href=&quot;#content-type-sniffing&quot;&gt;&lt;span class=secno&gt;2.6
+     &lt;li&gt;&lt;a href=&quot;#fetching&quot;&gt;&lt;span class=secno&gt;2.6 &lt;/span&gt;Fetching
+      resources&lt;/a&gt;
+
+     &lt;li&gt;&lt;a href=&quot;#content-type-sniffing&quot;&gt;&lt;span class=secno&gt;2.7
       &lt;/span&gt;Determining the type of a resource&lt;/a&gt;
       &lt;ul class=toc&gt;
-       &lt;li&gt;&lt;a href=&quot;#content-type&quot;&gt;&lt;span class=secno&gt;2.6.1
+       &lt;li&gt;&lt;a href=&quot;#content-type&quot;&gt;&lt;span class=secno&gt;2.7.1
         &lt;/span&gt;Content-Type metadata&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#content-type0&quot;&gt;&lt;span class=secno&gt;2.6.2
+       &lt;li&gt;&lt;a href=&quot;#content-type0&quot;&gt;&lt;span class=secno&gt;2.7.2
         &lt;/span&gt;Content-Type sniffing: Web pages&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#content-type1&quot;&gt;&lt;span class=secno&gt;2.6.3
+       &lt;li&gt;&lt;a href=&quot;#content-type1&quot;&gt;&lt;span class=secno&gt;2.7.3
         &lt;/span&gt;Content-Type sniffing: text or binary&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#content-type2&quot;&gt;&lt;span class=secno&gt;2.6.4
+       &lt;li&gt;&lt;a href=&quot;#content-type2&quot;&gt;&lt;span class=secno&gt;2.7.4
         &lt;/span&gt;Content-Type sniffing: unknown type&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#content-type3&quot;&gt;&lt;span class=secno&gt;2.6.5
+       &lt;li&gt;&lt;a href=&quot;#content-type3&quot;&gt;&lt;span class=secno&gt;2.7.5
         &lt;/span&gt;Content-Type sniffing: image&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#content-type4&quot;&gt;&lt;span class=secno&gt;2.6.6
+       &lt;li&gt;&lt;a href=&quot;#content-type4&quot;&gt;&lt;span class=secno&gt;2.7.6
         &lt;/span&gt;Content-Type sniffing: feed or HTML&lt;/a&gt;
       &lt;/ul&gt;
     &lt;/ul&gt;
@@ -5559,7 +5562,19 @@
    &quot;&lt;code&gt;5.0&lt;/code&gt;&quot; also supports &quot;&lt;code title=&quot;&quot;&gt;HTML&lt;/code&gt;&quot;
    &quot;&lt;code&gt;2.0&lt;/code&gt;&quot;.
 
-  &lt;h3 id=content-type-sniffing&gt;&lt;span class=secno&gt;2.6 &lt;/span&gt;Determining the
+  &lt;h3 id=fetching&gt;&lt;span class=secno&gt;2.6 &lt;/span&gt;Fetching resources&lt;/h3&gt;
+
+  &lt;p class=big-issue&gt;replace all instances of the word 'fetch' or 'download'
+   with a reference to this section, and put something here that talks about
+   caching, that redirects to the offline storage stuff when appropriate,
+   that defines that before fetching a URL you have to resolve the URL, so
+   that every case of fetching doesn't have to independently say to resolve
+   the URL, etc; &quot;once fetched, a resource might have to have its type
+   determined&quot;, pointing to the next section but also explicitly saying that
+   it's up to the part of the spec doing the fetching to determine how the
+   type is established
+
+  &lt;h3 id=content-type-sniffing&gt;&lt;span class=secno&gt;2.7 &lt;/span&gt;Determining the
    type of a resource&lt;/h3&gt;
 
   &lt;p class=warning&gt;It is imperative that the rules in this section be
@@ -5571,7 +5586,7 @@
    the end user can be exposed to malicious content, making the user
    vulnerable to cookie theft attacks and other cross-site scripting attacks.
 
-  &lt;h4 id=content-type&gt;&lt;span class=secno&gt;2.6.1 &lt;/span&gt;Content-Type metadata&lt;/h4&gt;
+  &lt;h4 id=content-type&gt;&lt;span class=secno&gt;2.7.1 &lt;/span&gt;Content-Type metadata&lt;/h4&gt;
 
   &lt;p&gt;What explicit &lt;dfn id=content-type5 title=Content-Type&gt;Content-Type
    metadata&lt;/dfn&gt; is associated with the resource (the resource's type
@@ -5654,7 +5669,7 @@
   &lt;p class=note&gt;The above algorithm is a willful violation of the HTTP
    specification. &lt;a href=&quot;#refsRFC2616&quot;&gt;[RFC2616]&lt;/a&gt;
 
-  &lt;h4 id=content-type0&gt;&lt;span class=secno&gt;2.6.2 &lt;/span&gt;Content-Type sniffing:
+  &lt;h4 id=content-type0&gt;&lt;span class=secno&gt;2.7.2 &lt;/span&gt;Content-Type sniffing:
    Web pages&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=sniffed title=&quot;Content-Type sniffing&quot;&gt;sniffed type of a
@@ -5755,7 +5770,7 @@
     &lt;p&gt;The sniffed type of the resource is &lt;var title=&quot;&quot;&gt;official type&lt;/var&gt;.
   &lt;/ol&gt;
 
-  &lt;h4 id=content-type1&gt;&lt;span class=secno&gt;2.6.3 &lt;/span&gt;&lt;dfn
+  &lt;h4 id=content-type1&gt;&lt;span class=secno&gt;2.7.3 &lt;/span&gt;&lt;dfn
    id=content-type6&gt;Content-Type sniffing: text or binary&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;ol&gt;
@@ -5846,7 +5861,7 @@
     &lt;p&gt;Otherwise, the sniffed type of the resource is &quot;text/plain&quot;.
   &lt;/ol&gt;
 
-  &lt;h4 id=content-type2&gt;&lt;span class=secno&gt;2.6.4 &lt;/span&gt;&lt;dfn
+  &lt;h4 id=content-type2&gt;&lt;span class=secno&gt;2.7.4 &lt;/span&gt;&lt;dfn
    id=content-type7&gt;Content-Type sniffing: unknown type&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;ol&gt;
@@ -6108,7 +6123,7 @@
    determine that content is not HTML and thus safe from XSS attacks, but
    then a user agent detects it as HTML anyway and allows script to execute).
 
-  &lt;h4 id=content-type3&gt;&lt;span class=secno&gt;2.6.5 &lt;/span&gt;&lt;dfn
+  &lt;h4 id=content-type3&gt;&lt;span class=secno&gt;2.7.5 &lt;/span&gt;&lt;dfn
    id=content-type8&gt;Content-Type sniffing: image&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;If the first bytes of the file match one of the byte sequences in the
@@ -6180,7 +6195,7 @@
   &lt;p&gt;Otherwise, the sniffed type of the resource is the same as its &lt;var
    title=&quot;&quot;&gt;official type&lt;/var&gt;.
 
-  &lt;h4 id=content-type4&gt;&lt;span class=secno&gt;2.6.6 &lt;/span&gt;&lt;dfn
+  &lt;h4 id=content-type4&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;&lt;dfn
    id=content-type9&gt;Content-Type sniffing: feed or HTML&lt;/dfn&gt;&lt;/h4&gt;
   &lt;!-- mostly based on:
    <A HREF="http://blogs.msdn.com/rssteam/articles/PublishersGuide.aspx">http://blogs.msdn.com/rssteam/articles/PublishersGuide.aspx</A>
@@ -15370,15 +15385,12 @@
   &lt;p&gt;If the &lt;code title=attr-img-src&gt;&lt;a href=&quot;#src&quot;&gt;src&lt;/a&gt;&lt;/code&gt; attribute
    is omitted, the image represents whatever string is given by the element's
    &lt;code title=attr-img-alt&gt;&lt;a href=&quot;#alt&quot;&gt;alt&lt;/a&gt;&lt;/code&gt; attribute, if any,
-   or nothing, if that attribute is empty or absent.&lt;/p&gt;
-  &lt;!-- XXXURL XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX \(URI\|IRI\|URL\) --&gt;
+   or nothing, if that attribute is empty or absent.
 
   &lt;p&gt;The &lt;code title=attr-img-src&gt;&lt;a href=&quot;#src&quot;&gt;src&lt;/a&gt;&lt;/code&gt; attribute, on
    setting, must cause the user agent to immediately begin to download the
-   specified resource&lt;!-- XXX xref what fetching means, XXXURL how to
-  resolve URLs in attributes (including those not in the DOM) --&gt;,
-   unless the user agent cannot support images, or its support for images has
-   been disabled.
+   specified resource&lt;!-- XXX xref what fetching means --&gt;, unless the user
+   agent cannot support images, or its support for images has been disabled.
 
   &lt;p&gt;The download of the image must &lt;a href=&quot;#delays&quot;&gt;delay the &lt;code
    title=event-load&gt;load&lt;/code&gt; event&lt;/a&gt;.
@@ -15601,13 +15613,13 @@
   &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt; element introduces a new
    nested &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;.
 
-  &lt;p&gt;The &lt;dfn id=src1 title=attr-iframe-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; attribute,
-   if present, must be a &lt;a href=&quot;#valid&quot;&gt;valid URL&lt;/a&gt; of a page that the
-   nested &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; is to contain. When the
-   browsing context is created, if the attribute is present, the user agent
-   must &lt;a href=&quot;#navigate&quot;&gt;navigate&lt;/a&gt; this browsing context to the given
-   URI&lt;!-- XXXURL resolve relative URLs --&gt;, with &lt;a
-   href=&quot;#replacement&quot;&gt;replacement enabled&lt;/a&gt;, and with the &lt;code&gt;&lt;a
+  &lt;p&gt;The &lt;dfn id=src1 title=attr-iframe-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; attribute
+   gives the address of a page that the nested &lt;a href=&quot;#browsing1&quot;&gt;browsing
+   context&lt;/a&gt; is to contain. The attribute, if present, must be a &lt;a
+   href=&quot;#valid&quot;&gt;valid URL&lt;/a&gt;. When the browsing context is created, if the
+   attribute is present, the user agent must &lt;a href=&quot;#navigate&quot;&gt;navigate&lt;/a&gt;
+   the element's browsing context to the given &lt;a href=&quot;#url&quot;&gt;URL&lt;/a&gt;, with
+   &lt;a href=&quot;#replacement&quot;&gt;replacement enabled&lt;/a&gt;, and with the &lt;code&gt;&lt;a
    href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt; element's document's &lt;a
    href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; as the &lt;a href=&quot;#source0&quot;&gt;source
    browsing context&lt;/a&gt;. If the user &lt;a href=&quot;#navigate&quot;
@@ -15619,12 +15631,10 @@
 
   &lt;p&gt;Whenever the &lt;code title=attr-iframe-src&gt;&lt;a href=&quot;#src1&quot;&gt;src&lt;/a&gt;&lt;/code&gt;
    attribute is set, the nested &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;
-   must be &lt;a href=&quot;#navigate&quot; title=navigate&gt;navigated&lt;/a&gt; to the given
-   URI&lt;!-- XXXURL
-  resolve relative URLs --&gt;, with the &lt;code&gt;&lt;a
-   href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt; element's document's &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; as the &lt;a href=&quot;#source0&quot;&gt;source
-   browsing context&lt;/a&gt;.
+   must be &lt;a href=&quot;#navigate&quot; title=navigate&gt;navigated&lt;/a&gt; to the given &lt;a
+   href=&quot;#url&quot;&gt;URL&lt;/a&gt;, with the &lt;code&gt;&lt;a href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt;
+   element's document's &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; as the &lt;a
+   href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;.
 
   &lt;p&gt;If the &lt;code title=attr-iframe-src&gt;&lt;a href=&quot;#src1&quot;&gt;src&lt;/a&gt;&lt;/code&gt;
    attribute is not set when the element is created, the browsing context
@@ -16178,7 +16188,8 @@
 
   &lt;p&gt;The &lt;dfn id=data title=attr-object-data&gt;&lt;code&gt;data&lt;/code&gt;&lt;/dfn&gt;
    attribute, if present, specifies the address of the resource. If present,
-   the attribute must be a &lt;a href=&quot;#valid&quot;&gt;valid URL&lt;/a&gt;.
+   the attribute must be a &lt;a href=&quot;#valid&quot;&gt;valid URL&lt;/a&gt;.&lt;/p&gt;
+  &lt;!-- XXXURL XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX \(URI\|IRI\|URL\) --&gt;
 
   &lt;p&gt;The &lt;dfn id=type6 title=attr-object-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;
    attribute, if present, specifies the type of the resource. If present, the
@@ -34259,9 +34270,9 @@
    documents&lt;/h4&gt;
 
   &lt;p&gt;Certain actions cause the &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; to
-   &lt;dfn id=navigate&gt;navigate&lt;/dfn&gt;. Navigation always involves a &lt;dfn
-   id=source0&gt;source browsing context&lt;/dfn&gt;, which is the browsing context
-   which was responsible for starting the navigation.
+   &lt;dfn id=navigate&gt;navigate&lt;/dfn&gt; to a new resource. Navigation always
+   involves &lt;dfn id=source0&gt;source browsing context&lt;/dfn&gt;, which is the
+   browsing context which was responsible for starting the navigation.
 
   &lt;p class=example&gt;For example, &lt;a href=&quot;#following0&quot; title=&quot;following
    hyperlinks&quot;&gt;following a hyperlink&lt;/a&gt;, &lt;span title=&quot;&quot;&gt;form
@@ -34270,11 +34281,12 @@
    title=dom-location-assign&gt;&lt;a href=&quot;#assign&quot;&gt;location.assign()&lt;/a&gt;&lt;/code&gt;
    methods can all cause a browsing context to navigate.
 
-  &lt;p&gt;A user agent may also provide various ways for the user to explicitly
-   cause a browsing context to navigate.
+  &lt;p&gt;A user agent may provide various ways for the user to explicitly cause a
+   browsing context to navigate, in addition to those defined in this
+   specification.
 
-  &lt;p&gt;When a browsing context is navigated, the user agent must run the
-   following steps:
+  &lt;p&gt;When a browsing context is navigated to a new resource, the user agent
+   must run the following steps:
 
   &lt;ol&gt;
    &lt;li id=sandboxLinks&gt;
@@ -34285,14 +34297,13 @@
      contexts&lt;/a&gt; of the &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; being
      navigated, and the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt; has
      its &lt;a href=&quot;#sandboxed&quot;&gt;sandboxed navigation browsing context flag&lt;/a&gt;
-     set, then abort these steps. The user agent may offer to open the
-     specified resource in a new &lt;a href=&quot;#top-level&quot;&gt;top-level browsing
-     context&lt;/a&gt; or in the &lt;a href=&quot;#top-level&quot;&gt;top-level browsing
-     context&lt;/a&gt; of the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;, at
-     the user's option, in which case the user agent must &lt;a
-     href=&quot;#navigate&quot;&gt;navigate&lt;/a&gt; that designated &lt;a
-     href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; to the specified
-     resource as if the user had requested it independently.
+     set, then abort these steps. The user agent may offer to open the new
+     resource in a new &lt;a href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; or
+     in the &lt;a href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; of the &lt;a
+     href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;, at the user's option, in
+     which case the user agent must &lt;a href=&quot;#navigate&quot;&gt;navigate&lt;/a&gt; that
+     designated &lt;a href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; to the
+     new resource as if the user had requested it independently.
 
    &lt;li id=seamlessLinks&gt;
     &lt;p&gt;If the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt; is the same as
@@ -34306,14 +34317,25 @@
      title=navigate&gt;navigated&lt;/a&gt; instead.
 
    &lt;li&gt;
-    &lt;p&gt;Cancel any preexisting attempt to navigate the browsing context.
+    &lt;p&gt;Cancel any preexisting attempt to navigate the &lt;a
+     href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;.
 
-   &lt;li&gt;
-    &lt;p&gt;If the new resource is the same as the current resource, but a
-     fragment identifier has been specified, changed, or removed, then &lt;a
-     href=&quot;#navigating0&quot; title=navigate-fragid&gt;navigate to that fragment
-     identifier&lt;/a&gt; and abort these steps.
+   &lt;li&gt;&lt;a href=&quot;#resolve&quot; title=&quot;resolve a url&quot;&gt;Resolve&lt;/a&gt; the &lt;a
+    href=&quot;#url&quot;&gt;URL&lt;/a&gt; of the new resource. If that fails, abort these
+    steps.
 
+   &lt;li id=navigate-fragid-step&gt;
+    &lt;p&gt;&lt;i&gt;Fragment identifiers&lt;/i&gt;: If the &lt;a href=&quot;#absolute&quot;&gt;absolute
+     URL&lt;/a&gt; of the new resource is the same as the &lt;span title=&quot;the
+     document's address&quot;&gt;address&lt;/span&gt;&lt;!--XXXDOCURL--&gt; of the &lt;a
+     href=&quot;#active&quot;&gt;active document&lt;/a&gt; of the &lt;a href=&quot;#browsing1&quot;&gt;browsing
+     context&lt;/a&gt; being navigated, ignoring any &lt;a href=&quot;#ltfragmentgt&quot;
+     title=url-fragment&gt;&lt;fragment&gt;&lt;/a&gt; components of those &lt;a
+     href=&quot;#url&quot; title=URL&gt;URLs&lt;/a&gt;, and the new resource is to be fetched
+     using HTTP GET or equivalent, then &lt;a href=&quot;#navigating0&quot;
+     title=navigate-fragid&gt;navigate to that fragment identifier&lt;/a&gt; and abort
+     these steps.
+
    &lt;li&gt;
     &lt;p&gt;If the new resource is to be handled by displaying some sort of inline
      content, e.g. an error message because the specified scheme is not one
@@ -34345,12 +34367,13 @@
      title=concept-appcache-selection&gt;most appropriate application cache&lt;/a&gt;
      of those that match.&lt;/p&gt;
     &lt;!-- XXXURL JSURI issue --&gt;
-    &lt;p&gt;Otherwise, start fetching the specified resource in the appropriate
-     manner (e.g. performing an HTTP GET or POST operation, or reading the
-     file from disk, or executing script in the case of a &lt;a
+    &lt;p&gt;Otherwise, start fetching&lt;!-- XXX xref --&gt; the new resource in the
+     appropriate manner (e.g. performing an HTTP GET or POST operation, or
+     reading the file from disk, or executing script in the case of a &lt;a
      href=&quot;#the-javascript&quot; title=&quot;javascript protocol&quot;&gt;&lt;code
      title=&quot;&quot;&gt;javascript:&lt;/code&gt; URI&lt;/a&gt;). If this results in a redirect,
-     return to step 2 with the new resource.&lt;/p&gt;
+     return to &lt;a href=navigate-fragid-step&gt;the step labeled &quot;fragment
+     identifiers&quot;&lt;/a&gt; with the new resource.&lt;/p&gt;
 
     &lt;p class=example&gt;For example, imagine an HTML page with an associated
      application cache displaying an image and a form, where the image is
@@ -34484,11 +34507,11 @@
     &lt;/dl&gt;
 
    &lt;li id=navigate-non-Document&gt;
-    &lt;p&gt;If, given &lt;var title=&quot;&quot;&gt;type&lt;/var&gt;, the new resource is to be handled
-     by displaying some sort of inline content, e.g. a native rendering of
-     the content, an error message because the specified type is not
-     supported, or an inline prompt to allow the user to select &lt;a
-     href=&quot;#registercontenthandler&quot;
+    &lt;p&gt;&lt;i&gt;Non-document content&lt;/i&gt;: If, given &lt;var title=&quot;&quot;&gt;type&lt;/var&gt;, the
+     new resource is to be handled by displaying some sort of inline content,
+     e.g. a native rendering of the content, an error message because the
+     specified type is not supported, or an inline prompt to allow the user
+     to select &lt;a href=&quot;#registercontenthandler&quot;
      title=dom-navigator-registerContentHandler&gt;a registered handler&lt;/a&gt; for
      the given type, then &lt;a href=&quot;#page-load4&quot;
      title=navigate-ua-inline&gt;display the inline content&lt;/a&gt; and abort these
@@ -34653,8 +34676,9 @@
    dispatch to alternative processing tools, e.g. determining that the
    content is actually a syndication feed and passing it to a feed handler.
    If such processing is to take place, abort the steps in this section, and
-   jump to &lt;a href=&quot;#navigate-non-Document&quot;&gt;step 10&lt;/a&gt; in the &lt;a
-   href=&quot;#navigate&quot;&gt;navigate&lt;/a&gt; steps above.
+   jump to &lt;a href=&quot;#navigate-non-Document&quot;&gt;the next step&lt;/a&gt; (labeled
+   &quot;non-document content&quot;) in the &lt;a href=&quot;#navigate&quot;&gt;navigate&lt;/a&gt; steps
+   above.
 
   &lt;p&gt;Otherwise, then, with the newly created &lt;code&gt;Document&lt;/code&gt;, the user
    agents must &lt;a href=&quot;#update2&quot;&gt;update the session history with the new

Modified: source
===================================================================
--- source	2008-06-25 05:36:59 UTC (rev 1798)
+++ source	2008-06-25 07:38:07 UTC (rev 1799)
@@ -3870,6 +3870,21 @@
 
 
 
+  &lt;h3&gt;Fetching resources&lt;/h3&gt;
+
+  &lt;p class=&quot;big-issue&quot;&gt;replace all instances of the word 'fetch' or
+  'download' with a reference to this section, and put something here
+  that talks about caching, that redirects to the offline storage
+  stuff when appropriate, that defines that before fetching a URL you
+  have to resolve the URL, so that every case of fetching doesn't have
+  to independently say to resolve the URL, etc; &quot;once fetched, a
+  resource might have to have its type determined&quot;, pointing to the
+  next section but also explicitly saying that it's up to the part of
+  the spec doing the fetching to determine how the type is
+  established&lt;/p&gt;
+
+
+
   &lt;h3 id=&quot;content-type-sniffing&quot;&gt;Determining the type of a resource&lt;/h3&gt;
 
   &lt;p class=&quot;warning&quot;&gt;It is imperative that the rules in this section
@@ -4586,6 +4601,9 @@
 
 
 
+
+
+
   &lt;h2 id=&quot;dom&quot;&gt;Semantics and structure of HTML documents&lt;/h2&gt;
 
   &lt;h3 id=&quot;semantics-intro&quot;&gt;Introduction&lt;/h3&gt;
@@ -13180,14 +13198,11 @@
 
 
 
-  &lt;!-- XXXURL XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX \(URI\|IRI\|URL\) --&gt;
-
   &lt;p&gt;The &lt;code title=&quot;attr-img-src&quot;&gt;src&lt;/code&gt; attribute, on setting,
   must cause the user agent to immediately begin to download the
-  specified resource&lt;!-- XXX xref what fetching means, XXXURL how to
-  resolve URLs in attributes (including those not in the DOM) --&gt;,
-  unless the user agent cannot support images, or its support for
-  images has been disabled.&lt;/p&gt;
+  specified resource&lt;!-- XXX xref what fetching means --&gt;, unless the
+  user agent cannot support images, or its support for images has been
+  disabled.&lt;/p&gt;
 
   &lt;p&gt;The download of the image must &lt;span&gt;delay the &lt;code
   title=&quot;event-load&quot;&gt;load&lt;/code&gt; event&lt;/span&gt;.&lt;/p&gt;
@@ -13401,15 +13416,15 @@
   &lt;p&gt;The &lt;code&gt;iframe&lt;/code&gt; element introduces a new nested
   &lt;span&gt;browsing context&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn title=&quot;attr-iframe-src&quot;&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;
-  attribute, if present, must be a &lt;span&gt;valid URL&lt;/span&gt; of a page that
-  the nested &lt;span&gt;browsing context&lt;/span&gt; is to contain. When the
-  browsing context is created, if the attribute is present, the user
-  agent must &lt;span&gt;navigate&lt;/span&gt; this browsing context to the given
-  URI&lt;!-- XXXURL resolve relative URLs --&gt;, with &lt;span&gt;replacement
-  enabled&lt;/span&gt;, and with the &lt;code&gt;iframe&lt;/code&gt; element's
-  document's &lt;span&gt;browsing context&lt;/span&gt; as the &lt;span&gt;source
-  browsing context&lt;/span&gt;. If the user &lt;span
+  &lt;p&gt;The &lt;dfn title=&quot;attr-iframe-src&quot;&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; attribute
+  gives the address of a page that the nested &lt;span&gt;browsing
+  context&lt;/span&gt; is to contain. The attribute, if present, must be a
+  &lt;span&gt;valid URL&lt;/span&gt;. When the browsing context is created, if the
+  attribute is present, the user agent must &lt;span&gt;navigate&lt;/span&gt; the
+  element's browsing context to the given &lt;span&gt;URL&lt;/span&gt;, with
+  &lt;span&gt;replacement enabled&lt;/span&gt;, and with the &lt;code&gt;iframe&lt;/code&gt;
+  element's document's &lt;span&gt;browsing context&lt;/span&gt; as the
+  &lt;span&gt;source browsing context&lt;/span&gt;. If the user &lt;span
   title=&quot;navigate&quot;&gt;navigates&lt;/span&gt; away from this page, the
   &lt;code&gt;iframe&lt;/code&gt;'s corresponding &lt;code&gt;Window&lt;/code&gt; object will
   reference new &lt;code&gt;Document&lt;/code&gt; objects, but the &lt;code
@@ -13417,10 +13432,9 @@
 
   &lt;p&gt;Whenever the &lt;code title=&quot;attr-iframe-src&quot;&gt;src&lt;/code&gt; attribute
   is set, the nested &lt;span&gt;browsing context&lt;/span&gt; must be &lt;span
-  title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; to the given URI&lt;!-- XXXURL
-  resolve relative URLs --&gt;, with the &lt;code&gt;iframe&lt;/code&gt; element's
-  document's &lt;span&gt;browsing context&lt;/span&gt; as the &lt;span&gt;source
-  browsing context&lt;/span&gt;.&lt;/p&gt;
+  title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; to the given &lt;span&gt;URL&lt;/span&gt;,
+  with the &lt;code&gt;iframe&lt;/code&gt; element's document's &lt;span&gt;browsing
+  context&lt;/span&gt; as the &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;If the &lt;code title=&quot;attr-iframe-src&quot;&gt;src&lt;/code&gt; attribute is not
   set when the element is created, the browsing context will remain at
@@ -13985,6 +13999,8 @@
   attribute, if present, specifies the address of the resource. If
   present, the attribute must be a &lt;span&gt;valid URL&lt;/span&gt;.&lt;/p&gt;
 
+  &lt;!-- XXXURL XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX \(URI\|IRI\|URL\) --&gt;
+
   &lt;p&gt;The &lt;dfn title=&quot;attr-object-type&quot;&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;
   attribute, if present, specifies the type of the resource. If
   present, the attribute must be a valid MIME type, optionally with
@@ -31921,9 +31937,9 @@
   &lt;h4&gt;Navigating across documents&lt;/h4&gt;
 
   &lt;p&gt;Certain actions cause the &lt;span&gt;browsing context&lt;/span&gt; to
-  &lt;dfn&gt;navigate&lt;/dfn&gt;. Navigation always involves a &lt;dfn&gt;source
-  browsing context&lt;/dfn&gt;, which is the browsing context which was
-  responsible for starting the navigation.&lt;/p&gt;
+  &lt;dfn&gt;navigate&lt;/dfn&gt; to a new resource. Navigation always involves
+  &lt;dfn&gt;source browsing context&lt;/dfn&gt;, which is the browsing context
+  which was responsible for starting the navigation.&lt;/p&gt;
 
   &lt;p class=&quot;example&quot;&gt;For example, &lt;span title=&quot;following
   hyperlinks&quot;&gt;following a hyperlink&lt;/span&gt;, &lt;span title=&quot;&quot;&gt;form
@@ -31932,11 +31948,12 @@
   title=&quot;dom-location-assign&quot;&gt;location.assign()&lt;/code&gt; methods can all
   cause a browsing context to navigate.&lt;/p&gt;
 
-  &lt;p&gt;A user agent may also provide various ways for the user to
-  explicitly cause a browsing context to navigate.&lt;/p&gt;
+  &lt;p&gt;A user agent may provide various ways for the user to explicitly
+  cause a browsing context to navigate, in addition to those defined
+  in this specification.&lt;/p&gt;
 
-  &lt;p&gt;When a browsing context is navigated, the user agent must run the
-  following steps:&lt;/p&gt;
+  &lt;p&gt;When a browsing context is navigated to a new resource, the user
+  agent must run the following steps:&lt;/p&gt;
 
   &lt;ol&gt;
 
@@ -31947,13 +31964,13 @@
    browsing contexts&lt;/span&gt; of the &lt;span&gt;browsing context&lt;/span&gt; being
    navigated, and the &lt;span&gt;source browsing context&lt;/span&gt; has its
    &lt;span&gt;sandboxed navigation browsing context flag&lt;/span&gt; set, then
-   abort these steps. The user agent may offer to open the specified
+   abort these steps. The user agent may offer to open the new
    resource in a new &lt;span&gt;top-level browsing context&lt;/span&gt; or in the
    &lt;span&gt;top-level browsing context&lt;/span&gt; of the &lt;span&gt;source
    browsing context&lt;/span&gt;, at the user's option, in which case the
    user agent must &lt;span&gt;navigate&lt;/span&gt; that designated
-   &lt;span&gt;top-level browsing context&lt;/span&gt; to the specified resource
-   as if the user had requested it independently.&lt;/p&gt;&lt;/li&gt;
+   &lt;span&gt;top-level browsing context&lt;/span&gt; to the new resource as if
+   the user had requested it independently.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li id=&quot;seamlessLinks&quot;&gt;&lt;p&gt;If the &lt;span&gt;source browsing
    context&lt;/span&gt; is the same as the &lt;span&gt;browsing context&lt;/span&gt;
@@ -31965,14 +31982,24 @@
    that was going to be &lt;span title=&quot;navigate&quot;&gt;navigated&lt;/span&gt;
    instead.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Cancel any preexisting attempt to navigate the browsing
-   context.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Cancel any preexisting attempt to navigate the
+   &lt;span&gt;browsing context&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If the new resource is the same as the current resource, but
-   a fragment identifier has been specified, changed, or removed, then
-   &lt;span title=&quot;navigate-fragid&quot;&gt;navigate to that fragment
-   identifier&lt;/span&gt; and abort these steps.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;span title=&quot;resolve a url&quot;&gt;Resolve&lt;/span&gt; the &lt;span&gt;URL&lt;/span&gt;
+   of the new resource. If that fails, abort these steps.&lt;/li&gt;
 
+   &lt;li id=&quot;navigate-fragid-step&quot;&gt;&lt;p&gt;&lt;i&gt;Fragment identifiers&lt;/i&gt;: If
+   the &lt;span&gt;absolute URL&lt;/span&gt; of the new resource is the same as
+   the &lt;span title=&quot;the document's
+   address&quot;&gt;address&lt;/span&gt;&lt;!--XXXDOCURL--&gt; of the &lt;span&gt;active
+   document&lt;/span&gt; of the &lt;span&gt;browsing context&lt;/span&gt; being
+   navigated, ignoring any &lt;span
+   title=&quot;url-fragment&quot;&gt;&lt;fragment&gt;&lt;/span&gt; components of those
+   &lt;span title=&quot;URL&quot;&gt;URLs&lt;/span&gt;, and the new resource is to be
+   fetched using HTTP GET or equivalent, then &lt;span
+   title=&quot;navigate-fragid&quot;&gt;navigate to that fragment identifier&lt;/span&gt;
+   and abort these steps.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;If the new resource is to be handled by displaying some sort
    of inline content, e.g. an error message because the specified
    scheme is not one of the supported protocols, or an inline prompt
@@ -32004,12 +32031,13 @@
     cache&lt;/span&gt; of those that match.&lt;/p&gt;
 
     &lt;!-- XXXURL JSURI issue --&gt;
-    &lt;p&gt;Otherwise, start fetching the specified resource in the
-    appropriate manner (e.g. performing an HTTP GET or POST operation,
-    or reading the file from disk, or executing script in the case of
-    a &lt;span title=&quot;javascript protocol&quot;&gt;&lt;code
+    &lt;p&gt;Otherwise, start fetching&lt;!-- XXX xref --&gt; the new resource in
+    the appropriate manner (e.g. performing an HTTP GET or POST
+    operation, or reading the file from disk, or executing script in
+    the case of a &lt;span title=&quot;javascript protocol&quot;&gt;&lt;code
     title=&quot;&quot;&gt;javascript:&lt;/code&gt; URI&lt;/span&gt;). If this results in a
-    redirect, return to step 2 with the new resource.&lt;/p&gt;
+    redirect, return to &lt;a href=&quot;navigate-fragid-step&quot;&gt;the step
+    labeled &quot;fragment identifiers&quot;&lt;/a&gt; with the new resource.&lt;/p&gt;
 
     &lt;p class=&quot;example&quot;&gt;For example, imagine an HTML page with an
     associated application cache displaying an image and a form, where
@@ -32158,10 +32186,10 @@
 
    &lt;/li&gt;
 
-   &lt;li id=&quot;navigate-non-Document&quot;&gt;&lt;p&gt;If, given &lt;var
-   title=&quot;&quot;&gt;type&lt;/var&gt;, the new resource is to be handled by
-   displaying some sort of inline content, e.g. a native rendering of
-   the content, an error message because the specified type is not
+   &lt;li id=&quot;navigate-non-Document&quot;&gt;&lt;p&gt;&lt;i&gt;Non-document content&lt;/i&gt;: If,
+   given &lt;var title=&quot;&quot;&gt;type&lt;/var&gt;, the new resource is to be handled
+   by displaying some sort of inline content, e.g. a native rendering
+   of the content, an error message because the specified type is not
    supported, or an inline prompt to allow the user to select &lt;span
    title=&quot;dom-navigator-registerContentHandler&quot;&gt;a registered
    handler&lt;/span&gt; for the given type, then &lt;span
@@ -32338,8 +32366,9 @@
   e.g. determining that the content is actually a syndication feed and
   passing it to a feed handler. If such processing is to take place,
   abort the steps in this section, and jump to &lt;a
-  href=&quot;#navigate-non-Document&quot;&gt;step 10&lt;/a&gt; in the
-  &lt;span&gt;navigate&lt;/span&gt; steps above.&lt;/p&gt;
+  href=&quot;#navigate-non-Document&quot;&gt;the next step&lt;/a&gt; (labeled
+  &quot;non-document content&quot;) in the &lt;span&gt;navigate&lt;/span&gt; steps
+  above.&lt;/p&gt;
 
   &lt;p&gt;Otherwise, then, with the newly created &lt;code&gt;Document&lt;/code&gt;,
   the user agents must &lt;span&gt;update the session history with the new


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008696.html">[html5] r1798 - [] (0) More work replacing references to 'URI' with	references to 'URL
</A></li>
	<LI>Next message: <A HREF="008698.html">[html5] r1800 - [e] (0) &lt;object&gt; element: bring some old prose in	line with future plans regardi [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8697">[ date ]</a>
              <a href="thread.html#8697">[ thread ]</a>
              <a href="subject.html#8697">[ subject ]</a>
              <a href="author.html#8697">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
