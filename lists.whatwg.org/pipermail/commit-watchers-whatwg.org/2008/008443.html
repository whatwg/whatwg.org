<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r1544 - /
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1544%20-%20/&In-Reply-To=%3C20080507040341.B0D0C13A159%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008442.html">
   <LINK REL="Next"  HREF="008444.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r1544 - /</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1544%20-%20/&In-Reply-To=%3C20080507040341.B0D0C13A159%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r1544 - /">whatwg at whatwg.org
       </A><BR>
    <I>Tue May  6 21:03:41 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008442.html">[html5] r1543 - /
</A></li>
        <LI>Next message: <A HREF="008444.html">[html5] r1545 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8443">[ date ]</a>
              <a href="thread.html#8443">[ thread ]</a>
              <a href="subject.html#8443">[ subject ]</a>
              <a href="author.html#8443">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-05-06 21:03:40 -0700 (Tue, 06 May 2008)
New Revision: 1544

Modified:
   index
   source
Log:
[e] (0) Merge the name/value pair storage and SQL storage sections into one section with a common privacy and security bit, and other editorial fixes.

Modified: index
===================================================================
--- index	2008-05-07 03:27:23 UTC (rev 1543)
+++ index	2008-05-07 04:03:40 UTC (rev 1544)
@@ -1214,192 +1214,190 @@
         &lt;/span&gt;Content-Type metadata&lt;/a&gt;
       &lt;/ul&gt;
 
-     &lt;li&gt;&lt;a href=&quot;#storage&quot;&gt;&lt;span class=secno&gt;4.11 &lt;/span&gt;Client-side session
-      and persistent storage of name/value pairs&lt;/a&gt;
+     &lt;li&gt;&lt;a href=&quot;#structured&quot;&gt;&lt;span class=secno&gt;4.11 &lt;/span&gt;Structured
+      client-side storage&lt;/a&gt;
       &lt;ul class=toc&gt;
-       &lt;li&gt;&lt;a href=&quot;#introduction2&quot;&gt;&lt;span class=secno&gt;4.11.1
-        &lt;/span&gt;Introduction&lt;/a&gt;
+       &lt;li&gt;&lt;a href=&quot;#storage&quot;&gt;&lt;span class=secno&gt;4.11.1 &lt;/span&gt;Storing
+        name/value pairs&lt;/a&gt;
+        &lt;ul class=toc&gt;
+         &lt;li&gt;&lt;a href=&quot;#introduction2&quot;&gt;&lt;span class=secno&gt;4.11.1.1.
+          &lt;/span&gt;Introduction&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-storage&quot;&gt;&lt;span class=secno&gt;4.11.2 &lt;/span&gt;The
-        &lt;code&gt;Storage&lt;/code&gt; interface&lt;/a&gt;
+         &lt;li&gt;&lt;a href=&quot;#the-storage&quot;&gt;&lt;span class=secno&gt;4.11.1.2. &lt;/span&gt;The
+          &lt;code&gt;Storage&lt;/code&gt; interface&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-sessionstorage&quot;&gt;&lt;span class=secno&gt;4.11.3 &lt;/span&gt;The
-        &lt;code title=dom-sessionStorage&gt;sessionStorage&lt;/code&gt; attribute&lt;/a&gt;
+         &lt;li&gt;&lt;a href=&quot;#the-sessionstorage&quot;&gt;&lt;span class=secno&gt;4.11.1.3.
+          &lt;/span&gt;The &lt;code title=dom-sessionStorage&gt;sessionStorage&lt;/code&gt;
+          attribute&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-localstorage&quot;&gt;&lt;span class=secno&gt;4.11.4 &lt;/span&gt;The
-        &lt;code title=dom-localStorage&gt;localStorage&lt;/code&gt; attribute&lt;/a&gt;
+         &lt;li&gt;&lt;a href=&quot;#the-localstorage&quot;&gt;&lt;span class=secno&gt;4.11.1.4.
+          &lt;/span&gt;The &lt;code title=dom-localStorage&gt;localStorage&lt;/code&gt;
+          attribute&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#the-storage0&quot;&gt;&lt;span class=secno&gt;4.11.5 &lt;/span&gt;The &lt;code
-        title=event-storage&gt;storage&lt;/code&gt; event&lt;/a&gt;
-        &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#event0&quot;&gt;&lt;span class=secno&gt;4.11.5.1. &lt;/span&gt;Event
-          definition&lt;/a&gt;
+         &lt;li&gt;&lt;a href=&quot;#the-storage0&quot;&gt;&lt;span class=secno&gt;4.11.1.5. &lt;/span&gt;The
+          &lt;code title=event-storage&gt;storage&lt;/code&gt; event&lt;/a&gt;
+          &lt;ul class=toc&gt;
+           &lt;li&gt;&lt;a href=&quot;#event0&quot;&gt;&lt;span class=secno&gt;4.11.1.5.1. &lt;/span&gt;Event
+            definition&lt;/a&gt;
+          &lt;/ul&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#threads0&quot;&gt;&lt;span class=secno&gt;4.11.1.6.
+          &lt;/span&gt;Threads&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#miscellaneous0&quot;&gt;&lt;span class=secno&gt;4.11.6
-        &lt;/span&gt;Miscellaneous implementation requirements for storage
-        areas&lt;/a&gt;
+       &lt;li&gt;&lt;a href=&quot;#sql&quot;&gt;&lt;span class=secno&gt;4.11.2 &lt;/span&gt;Database
+        storage&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#disk-space&quot;&gt;&lt;span class=secno&gt;4.11.6.1. &lt;/span&gt;Disk
-          space&lt;/a&gt;
+         &lt;li&gt;&lt;a href=&quot;#introduction3&quot;&gt;&lt;span class=secno&gt;4.11.2.1.
+          &lt;/span&gt;Introduction&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#threads0&quot;&gt;&lt;span class=secno&gt;4.11.6.2.
-          &lt;/span&gt;Threads&lt;/a&gt;
+         &lt;li&gt;&lt;a href=&quot;#databases&quot;&gt;&lt;span class=secno&gt;4.11.2.2.
+          &lt;/span&gt;Databases&lt;/a&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#executing&quot;&gt;&lt;span class=secno&gt;4.11.2.3.
+          &lt;/span&gt;Executing SQL statements&lt;/a&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#database&quot;&gt;&lt;span class=secno&gt;4.11.2.4. &lt;/span&gt;Database
+          query results&lt;/a&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#errors&quot;&gt;&lt;span class=secno&gt;4.11.2.5. &lt;/span&gt;Errors&lt;/a&gt;
+
+         &lt;li&gt;&lt;a href=&quot;#processing3&quot;&gt;&lt;span class=secno&gt;4.11.2.6.
+          &lt;/span&gt;Processing model&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#security7&quot;&gt;&lt;span class=secno&gt;4.11.7 &lt;/span&gt;Security and
-        privacy&lt;/a&gt;
+       &lt;li&gt;&lt;a href=&quot;#disk-space&quot;&gt;&lt;span class=secno&gt;4.11.3 &lt;/span&gt;Disk
+        space&lt;/a&gt;
+
+       &lt;li&gt;&lt;a href=&quot;#privacy&quot;&gt;&lt;span class=secno&gt;4.11.4 &lt;/span&gt;Privacy&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#user-tracking&quot;&gt;&lt;span class=secno&gt;4.11.7.1. &lt;/span&gt;User
+         &lt;li&gt;&lt;a href=&quot;#user-tracking&quot;&gt;&lt;span class=secno&gt;4.11.4.1. &lt;/span&gt;User
           tracking&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#cookie&quot;&gt;&lt;span class=secno&gt;4.11.7.2. &lt;/span&gt;Cookie
+         &lt;li&gt;&lt;a href=&quot;#cookie&quot;&gt;&lt;span class=secno&gt;4.11.4.2. &lt;/span&gt;Cookie
           resurrection&lt;/a&gt;
+        &lt;/ul&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#dns-spoofing&quot;&gt;&lt;span class=secno&gt;4.11.7.3. &lt;/span&gt;DNS
+       &lt;li&gt;&lt;a href=&quot;#security7&quot;&gt;&lt;span class=secno&gt;4.11.5 &lt;/span&gt;Security&lt;/a&gt;
+        &lt;ul class=toc&gt;
+         &lt;li&gt;&lt;a href=&quot;#dns-spoofing&quot;&gt;&lt;span class=secno&gt;4.11.5.1. &lt;/span&gt;DNS
           spoofing attacks&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#cross-directory&quot;&gt;&lt;span class=secno&gt;4.11.7.4.
+         &lt;li&gt;&lt;a href=&quot;#cross-directory&quot;&gt;&lt;span class=secno&gt;4.11.5.2.
           &lt;/span&gt;Cross-directory attacks&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#implementation&quot;&gt;&lt;span class=secno&gt;4.11.7.5.
+         &lt;li&gt;&lt;a href=&quot;#implementation&quot;&gt;&lt;span class=secno&gt;4.11.5.3.
           &lt;/span&gt;Implementation risks&lt;/a&gt;
-        &lt;/ul&gt;
-      &lt;/ul&gt;
 
-     &lt;li&gt;&lt;a href=&quot;#sql&quot;&gt;&lt;span class=secno&gt;4.12 &lt;/span&gt;Client-side database
-      storage&lt;/a&gt;
-      &lt;ul class=toc&gt;
-       &lt;li&gt;&lt;a href=&quot;#introduction3&quot;&gt;&lt;span class=secno&gt;4.12.1
-        &lt;/span&gt;Introduction&lt;/a&gt;
+         &lt;li&gt;&lt;a href=&quot;#sql-and&quot;&gt;&lt;span class=secno&gt;4.11.5.4. &lt;/span&gt;SQL and
+          user agents&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#databases&quot;&gt;&lt;span class=secno&gt;4.12.2 &lt;/span&gt;Databases&lt;/a&gt;
-        
-
-       &lt;li&gt;&lt;a href=&quot;#executing&quot;&gt;&lt;span class=secno&gt;4.12.3 &lt;/span&gt;Executing SQL
-        statements&lt;/a&gt;
-
-       &lt;li&gt;&lt;a href=&quot;#database&quot;&gt;&lt;span class=secno&gt;4.12.4 &lt;/span&gt;Database query
-        results&lt;/a&gt;
-
-       &lt;li&gt;&lt;a href=&quot;#errors&quot;&gt;&lt;span class=secno&gt;4.12.5 &lt;/span&gt;Errors&lt;/a&gt;
-
-       &lt;li&gt;&lt;a href=&quot;#processing3&quot;&gt;&lt;span class=secno&gt;4.12.6 &lt;/span&gt;Processing
-        model&lt;/a&gt;
-
-       &lt;li&gt;&lt;a href=&quot;#privacy&quot;&gt;&lt;span class=secno&gt;4.12.7 &lt;/span&gt;Privacy&lt;/a&gt;
-
-       &lt;li&gt;&lt;a href=&quot;#security8&quot;&gt;&lt;span class=secno&gt;4.12.8 &lt;/span&gt;Security&lt;/a&gt;
-        &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#user-agents&quot;&gt;&lt;span class=secno&gt;4.12.8.1. &lt;/span&gt;User
-          agents&lt;/a&gt;
-
-         &lt;li&gt;&lt;a href=&quot;#sql-injection&quot;&gt;&lt;span class=secno&gt;4.12.8.2. &lt;/span&gt;SQL
+         &lt;li&gt;&lt;a href=&quot;#sql-injection&quot;&gt;&lt;span class=secno&gt;4.11.5.5. &lt;/span&gt;SQL
           injection&lt;/a&gt;
         &lt;/ul&gt;
       &lt;/ul&gt;
 
-     &lt;li&gt;&lt;a href=&quot;#links&quot;&gt;&lt;span class=secno&gt;4.13 &lt;/span&gt;Links&lt;/a&gt;
+     &lt;li&gt;&lt;a href=&quot;#links&quot;&gt;&lt;span class=secno&gt;4.12 &lt;/span&gt;Links&lt;/a&gt;
       &lt;ul class=toc&gt;
-       &lt;li&gt;&lt;a href=&quot;#hyperlink&quot;&gt;&lt;span class=secno&gt;4.13.1 &lt;/span&gt;Hyperlink
+       &lt;li&gt;&lt;a href=&quot;#hyperlink&quot;&gt;&lt;span class=secno&gt;4.12.1 &lt;/span&gt;Hyperlink
         elements&lt;/a&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#following&quot;&gt;&lt;span class=secno&gt;4.13.2 &lt;/span&gt;Following
+       &lt;li&gt;&lt;a href=&quot;#following&quot;&gt;&lt;span class=secno&gt;4.12.2 &lt;/span&gt;Following
         hyperlinks&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#hyperlink0&quot;&gt;&lt;span class=secno&gt;4.13.2.1.
+         &lt;li&gt;&lt;a href=&quot;#hyperlink0&quot;&gt;&lt;span class=secno&gt;4.12.2.1.
           &lt;/span&gt;Hyperlink auditing&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#linkTypes&quot;&gt;&lt;span class=secno&gt;4.13.3 &lt;/span&gt;Link
+       &lt;li&gt;&lt;a href=&quot;#linkTypes&quot;&gt;&lt;span class=secno&gt;4.12.3 &lt;/span&gt;Link
         types&lt;/a&gt;
         &lt;ul class=toc&gt;
-         &lt;li&gt;&lt;a href=&quot;#link-type&quot;&gt;&lt;span class=secno&gt;4.13.3.1. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type&quot;&gt;&lt;span class=secno&gt;4.12.3.1. &lt;/span&gt;Link
           type &quot;&lt;code&gt;alternate&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type0&quot;&gt;&lt;span class=secno&gt;4.13.3.2. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type0&quot;&gt;&lt;span class=secno&gt;4.12.3.2. &lt;/span&gt;Link
           type &quot;&lt;code&gt;archives&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type1&quot;&gt;&lt;span class=secno&gt;4.13.3.3. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type1&quot;&gt;&lt;span class=secno&gt;4.12.3.3. &lt;/span&gt;Link
           type &quot;&lt;code&gt;author&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type2&quot;&gt;&lt;span class=secno&gt;4.13.3.4. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type2&quot;&gt;&lt;span class=secno&gt;4.12.3.4. &lt;/span&gt;Link
           type &quot;&lt;code&gt;bookmark&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type3&quot;&gt;&lt;span class=secno&gt;4.13.3.5. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type3&quot;&gt;&lt;span class=secno&gt;4.12.3.5. &lt;/span&gt;Link
           type &quot;&lt;code&gt;contact&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type4&quot;&gt;&lt;span class=secno&gt;4.13.3.6. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type4&quot;&gt;&lt;span class=secno&gt;4.12.3.6. &lt;/span&gt;Link
           type &quot;&lt;code&gt;external&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type5&quot;&gt;&lt;span class=secno&gt;4.13.3.7. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type5&quot;&gt;&lt;span class=secno&gt;4.12.3.7. &lt;/span&gt;Link
           type &quot;&lt;code&gt;feed&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type6&quot;&gt;&lt;span class=secno&gt;4.13.3.8. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type6&quot;&gt;&lt;span class=secno&gt;4.12.3.8. &lt;/span&gt;Link
           type &quot;&lt;code&gt;help&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type7&quot;&gt;&lt;span class=secno&gt;4.13.3.9. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type7&quot;&gt;&lt;span class=secno&gt;4.12.3.9. &lt;/span&gt;Link
           type &quot;&lt;code&gt;icon&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type8&quot;&gt;&lt;span class=secno&gt;4.13.3.10. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type8&quot;&gt;&lt;span class=secno&gt;4.12.3.10. &lt;/span&gt;Link
           type &quot;&lt;code&gt;license&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type9&quot;&gt;&lt;span class=secno&gt;4.13.3.11. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type9&quot;&gt;&lt;span class=secno&gt;4.12.3.11. &lt;/span&gt;Link
           type &quot;&lt;code&gt;nofollow&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type10&quot;&gt;&lt;span class=secno&gt;4.13.3.12. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type10&quot;&gt;&lt;span class=secno&gt;4.12.3.12. &lt;/span&gt;Link
           type &quot;&lt;code&gt;noreferrer&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type11&quot;&gt;&lt;span class=secno&gt;4.13.3.13. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type11&quot;&gt;&lt;span class=secno&gt;4.12.3.13. &lt;/span&gt;Link
           type &quot;&lt;code&gt;pingback&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type12&quot;&gt;&lt;span class=secno&gt;4.13.3.14. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type12&quot;&gt;&lt;span class=secno&gt;4.12.3.14. &lt;/span&gt;Link
           type &quot;&lt;code&gt;prefetch&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type13&quot;&gt;&lt;span class=secno&gt;4.13.3.15. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type13&quot;&gt;&lt;span class=secno&gt;4.12.3.15. &lt;/span&gt;Link
           type &quot;&lt;code&gt;search&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type14&quot;&gt;&lt;span class=secno&gt;4.13.3.16. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type14&quot;&gt;&lt;span class=secno&gt;4.12.3.16. &lt;/span&gt;Link
           type &quot;&lt;code&gt;stylesheet&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type15&quot;&gt;&lt;span class=secno&gt;4.13.3.17. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type15&quot;&gt;&lt;span class=secno&gt;4.12.3.17. &lt;/span&gt;Link
           type &quot;&lt;code&gt;sidebar&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#link-type16&quot;&gt;&lt;span class=secno&gt;4.13.3.18. &lt;/span&gt;Link
+         &lt;li&gt;&lt;a href=&quot;#link-type16&quot;&gt;&lt;span class=secno&gt;4.12.3.18. &lt;/span&gt;Link
           type &quot;&lt;code&gt;tag&lt;/code&gt;&quot;&lt;/a&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#hierarchical&quot;&gt;&lt;span class=secno&gt;4.13.3.19.
+         &lt;li&gt;&lt;a href=&quot;#hierarchical&quot;&gt;&lt;span class=secno&gt;4.12.3.19.
           &lt;/span&gt;Hierarchical link types&lt;/a&gt;
           &lt;ul class=toc&gt;
-           &lt;li&gt;&lt;a href=&quot;#link-type17&quot;&gt;&lt;span class=secno&gt;4.13.3.19.1.
+           &lt;li&gt;&lt;a href=&quot;#link-type17&quot;&gt;&lt;span class=secno&gt;4.12.3.19.1.
             &lt;/span&gt;Link type &quot;&lt;code&gt;index&lt;/code&gt;&quot;&lt;/a&gt;
 
-           &lt;li&gt;&lt;a href=&quot;#link-type18&quot;&gt;&lt;span class=secno&gt;4.13.3.19.2.
+           &lt;li&gt;&lt;a href=&quot;#link-type18&quot;&gt;&lt;span class=secno&gt;4.12.3.19.2.
             &lt;/span&gt;Link type &quot;&lt;code&gt;up&lt;/code&gt;&quot;&lt;/a&gt;
           &lt;/ul&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#sequential0&quot;&gt;&lt;span class=secno&gt;4.13.3.20.
+         &lt;li&gt;&lt;a href=&quot;#sequential0&quot;&gt;&lt;span class=secno&gt;4.12.3.20.
           &lt;/span&gt;Sequential link types&lt;/a&gt;
           &lt;ul class=toc&gt;
-           &lt;li&gt;&lt;a href=&quot;#link-type19&quot;&gt;&lt;span class=secno&gt;4.13.3.20.1.
+           &lt;li&gt;&lt;a href=&quot;#link-type19&quot;&gt;&lt;span class=secno&gt;4.12.3.20.1.
             &lt;/span&gt;Link type &quot;&lt;code&gt;first&lt;/code&gt;&quot;&lt;/a&gt;
 
-           &lt;li&gt;&lt;a href=&quot;#link-type20&quot;&gt;&lt;span class=secno&gt;4.13.3.20.2.
+           &lt;li&gt;&lt;a href=&quot;#link-type20&quot;&gt;&lt;span class=secno&gt;4.12.3.20.2.
             &lt;/span&gt;Link type &quot;&lt;code&gt;last&lt;/code&gt;&quot;&lt;/a&gt;
 
-           &lt;li&gt;&lt;a href=&quot;#link-type21&quot;&gt;&lt;span class=secno&gt;4.13.3.20.3.
+           &lt;li&gt;&lt;a href=&quot;#link-type21&quot;&gt;&lt;span class=secno&gt;4.12.3.20.3.
             &lt;/span&gt;Link type &quot;&lt;code&gt;next&lt;/code&gt;&quot;&lt;/a&gt;
 
-           &lt;li&gt;&lt;a href=&quot;#link-type22&quot;&gt;&lt;span class=secno&gt;4.13.3.20.4.
+           &lt;li&gt;&lt;a href=&quot;#link-type22&quot;&gt;&lt;span class=secno&gt;4.12.3.20.4.
             &lt;/span&gt;Link type &quot;&lt;code&gt;prev&lt;/code&gt;&quot;&lt;/a&gt;
           &lt;/ul&gt;
 
-         &lt;li&gt;&lt;a href=&quot;#other0&quot;&gt;&lt;span class=secno&gt;4.13.3.21. &lt;/span&gt;Other link
+         &lt;li&gt;&lt;a href=&quot;#other0&quot;&gt;&lt;span class=secno&gt;4.12.3.21. &lt;/span&gt;Other link
           types&lt;/a&gt;
         &lt;/ul&gt;
       &lt;/ul&gt;
 
-     &lt;li&gt;&lt;a href=&quot;#interfaces&quot;&gt;&lt;span class=secno&gt;4.14 &lt;/span&gt;Interfaces for
+     &lt;li&gt;&lt;a href=&quot;#interfaces&quot;&gt;&lt;span class=secno&gt;4.13 &lt;/span&gt;Interfaces for
       URI manipulation&lt;/a&gt;
     &lt;/ul&gt;
 
@@ -1458,7 +1456,7 @@
           selection&lt;/a&gt;
         &lt;/ul&gt;
 
-       &lt;li&gt;&lt;a href=&quot;#security9&quot;&gt;&lt;span class=secno&gt;5.3.7 &lt;/span&gt;Security risks
+       &lt;li&gt;&lt;a href=&quot;#security8&quot;&gt;&lt;span class=secno&gt;5.3.7 &lt;/span&gt;Security risks
         in the drag-and-drop model&lt;/a&gt;
       &lt;/ul&gt;
 
@@ -2684,7 +2682,7 @@
 
   &lt;h4 id=security&gt;&lt;span class=secno&gt;2.1.1 &lt;/span&gt;Security&lt;/h4&gt;
 
-  &lt;p&gt;User agents must raise a &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt;
+  &lt;p&gt;User agents must raise a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt;
    whenever any of the members of an &lt;code&gt;&lt;a
    href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt; object are accessed by
    scripts whose &lt;a href=&quot;#effective3&quot;&gt;effective script origin&lt;/a&gt; is not the
@@ -27605,7 +27603,7 @@
 
   &lt;h4 id=security3&gt;&lt;span class=secno&gt;4.2.1 &lt;/span&gt;Security&lt;/h4&gt;
 
-  &lt;p&gt;User agents must raise a &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt;
+  &lt;p&gt;User agents must raise a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt;
    whenever any of the members of a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt;
    object are accessed by scripts whose &lt;a href=&quot;#effective3&quot;&gt;effective
    script origin&lt;/a&gt; is not the same as the &lt;code&gt;&lt;a
@@ -28038,7 +28036,7 @@
 
     &lt;p&gt;If ToASCII fails to convert one of the components of the string, e.g.
      because it is too long or because it contains invalid characters, then
-     throw a &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt; and abort these
+     throw a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt; and abort these
      steps. &lt;a href=&quot;#refsRFC3490&quot;&gt;[RFC3490]&lt;/a&gt;&lt;/p&gt;
 
    &lt;li&gt;
@@ -28050,12 +28048,12 @@
     &lt;ol&gt;
      &lt;li&gt;
       &lt;p&gt;If the current value is an IP address, throw a &lt;a
-       href=&quot;#security10&quot;&gt;security exception&lt;/a&gt; and abort these steps.&lt;/p&gt;
+       href=&quot;#security9&quot;&gt;security exception&lt;/a&gt; and abort these steps.&lt;/p&gt;
 
      &lt;li&gt;
       &lt;p&gt;If &lt;var title=&quot;&quot;&gt;new value&lt;/var&gt;, prefixed by a U+002E FULL STOP
        (&quot;.&quot;), does not exactly match the end of the current value, throw a &lt;a
-       href=&quot;#security10&quot;&gt;security exception&lt;/a&gt; and abort these steps.&lt;/p&gt;
+       href=&quot;#security9&quot;&gt;security exception&lt;/a&gt; and abort these steps.&lt;/p&gt;
     &lt;/ol&gt;
 
    &lt;li&gt;
@@ -28138,7 +28136,7 @@
 
   &lt;h4 id=security4&gt;&lt;span class=secno&gt;4.4.2 &lt;/span&gt;Security exceptions&lt;/h4&gt;
 
-  &lt;p class=big-issue&gt;Define &lt;dfn id=security10&gt;security exception&lt;/dfn&gt;.
+  &lt;p class=big-issue&gt;Define &lt;dfn id=security9&gt;security exception&lt;/dfn&gt;.
 
   &lt;h4 id=javascript-protocol&gt;&lt;span class=secno&gt;4.4.3 &lt;/span&gt;&lt;dfn
    id=the-javascript title=&quot;javascript protocol&quot;&gt;The &lt;code
@@ -29083,7 +29081,7 @@
      the user what the site in question is.&lt;/p&gt;
   &lt;/dl&gt;
 
-  &lt;p&gt;User agents should raise &lt;a href=&quot;#security10&quot; title=&quot;security
+  &lt;p&gt;User agents should raise &lt;a href=&quot;#security9&quot; title=&quot;security
    exception&quot;&gt;security exceptions&lt;/a&gt; if the methods are called with &lt;var
    title=&quot;&quot;&gt;protocol&lt;/var&gt; or &lt;var title=&quot;&quot;&gt;mimeType&lt;/var&gt; values that the UA
    deems to be &quot;privileged&quot;. For example, a site attempting to register a
@@ -30472,7 +30470,7 @@
 
    &lt;li&gt;
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;uri&lt;/var&gt; has a different &lt;scheme&gt; component than
-     the manifest's URI, then raise a &lt;a href=&quot;#security10&quot;&gt;security
+     the manifest's URI, then raise a &lt;a href=&quot;#security9&quot;&gt;security
      exception&lt;/a&gt;.
 
    &lt;li&gt;
@@ -31008,7 +31006,7 @@
    hierarchical &lt;scheme&gt;). If the verification fails (either because
    the argument is syntactically incorrect, or differs in a way not described
    as acceptable in the previous sentence) then the user agent must raise a
-   &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt;. &lt;a
+   &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt;. &lt;a
    href=&quot;#refsRFC3986&quot;&gt;[RFC3986]&lt;/a&gt; &lt;a href=&quot;#refsRFC3987&quot;&gt;[RFC3987]&lt;/a&gt;
 
   &lt;p&gt;If the third argument passes its verification step, or if the third
@@ -31226,7 +31224,7 @@
 
   &lt;h5 id=security6&gt;&lt;span class=secno&gt;4.8.4.1. &lt;/span&gt;Security&lt;/h5&gt;
 
-  &lt;p&gt;User agents must raise a &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt;
+  &lt;p&gt;User agents must raise a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt;
    whenever any of the members of a &lt;code&gt;&lt;a
    href=&quot;#location2&quot;&gt;Location&lt;/a&gt;&lt;/code&gt; object are accessed by scripts whose
    &lt;a href=&quot;#effective3&quot;&gt;effective script origin&lt;/a&gt; is not the same as the
@@ -32629,11 +32627,13 @@
     &lt;/dl&gt;
   &lt;/ol&gt;
 
-  &lt;h3 id=storage&gt;&lt;span class=secno&gt;4.11 &lt;/span&gt;Client-side session and
-   persistent storage of name/value pairs&lt;/h3&gt;
+  &lt;h3 id=structured&gt;&lt;span class=secno&gt;4.11 &lt;/span&gt;Structured client-side
+   storage&lt;/h3&gt;
 
-  &lt;h4 id=introduction2&gt;&lt;span class=secno&gt;4.11.1 &lt;/span&gt;Introduction&lt;/h4&gt;
+  &lt;h4 id=storage&gt;&lt;span class=secno&gt;4.11.1 &lt;/span&gt;Storing name/value pairs&lt;/h4&gt;
 
+  &lt;h5 id=introduction2&gt;&lt;span class=secno&gt;4.11.1.1. &lt;/span&gt;Introduction&lt;/h5&gt;
+
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;
 
   &lt;p&gt;This specification introduces two related mechanisms, similar to HTTP
@@ -32725,8 +32725,8 @@
    store structured data in a storage area, you must first convert it to a
    string.
 
-  &lt;h4 id=the-storage&gt;&lt;span class=secno&gt;4.11.2 &lt;/span&gt;The &lt;code&gt;&lt;a
-   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface&lt;/h4&gt;
+  &lt;h5 id=the-storage&gt;&lt;span class=secno&gt;4.11.1.2. &lt;/span&gt;The &lt;code&gt;&lt;a
+   href=&quot;#storage0&quot;&gt;Storage&lt;/a&gt;&lt;/code&gt; interface&lt;/h5&gt;
   &lt;!-- XXX shouldn't we define somewhere how null values get handled
   in these methods? Do they get converted to the empty string or
   something? --&gt;
@@ -32842,9 +32842,9 @@
   not normative, see the sections below for the normative statement
   --&gt;
 
-  &lt;h4 id=the-sessionstorage&gt;&lt;span class=secno&gt;4.11.3 &lt;/span&gt;The &lt;code
+  &lt;h5 id=the-sessionstorage&gt;&lt;span class=secno&gt;4.11.1.3. &lt;/span&gt;The &lt;code
    title=dom-sessionStorage&gt;&lt;a
-   href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; attribute&lt;/h4&gt;
+   href=&quot;#sessionstorage&quot;&gt;sessionStorage&lt;/a&gt;&lt;/code&gt; attribute&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=sessionstorage
    title=dom-sessionStorage&gt;&lt;code&gt;sessionStorage&lt;/code&gt;&lt;/dfn&gt; attribute
@@ -32914,9 +32914,9 @@
    title=event-storage&gt;&lt;a href=&quot;#storage1&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event must be
    fired, as &lt;a href=&quot;#storage1&quot; title=event-storage&gt;described below&lt;/a&gt;.
 
-  &lt;h4 id=the-localstorage&gt;&lt;span class=secno&gt;4.11.4 &lt;/span&gt;The &lt;code
+  &lt;h5 id=the-localstorage&gt;&lt;span class=secno&gt;4.11.1.4. &lt;/span&gt;The &lt;code
    title=dom-localStorage&gt;&lt;a href=&quot;#localstorage&quot;&gt;localStorage&lt;/a&gt;&lt;/code&gt;
-   attribute&lt;/h4&gt;
+   attribute&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=localstorage
    title=dom-localStorage&gt;&lt;code&gt;localStorage&lt;/code&gt;&lt;/dfn&gt; object provides a
@@ -32960,8 +32960,8 @@
    must be fired, as &lt;a href=&quot;#storage1&quot; title=event-storage&gt;described
    below&lt;/a&gt;.
 
-  &lt;h4 id=the-storage0&gt;&lt;span class=secno&gt;4.11.5 &lt;/span&gt;The &lt;code
-   title=event-storage&gt;&lt;a href=&quot;#storage1&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event&lt;/h4&gt;
+  &lt;h5 id=the-storage0&gt;&lt;span class=secno&gt;4.11.1.5. &lt;/span&gt;The &lt;code
+   title=event-storage&gt;&lt;a href=&quot;#storage1&quot;&gt;storage&lt;/a&gt;&lt;/code&gt; event&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=storage1 title=event-storage&gt;&lt;code&gt;storage&lt;/code&gt;&lt;/dfn&gt;
    event is fired in an &lt;code&gt;&lt;a href=&quot;#htmldocument&quot;&gt;HTMLDocument&lt;/a&gt;&lt;/code&gt;
@@ -33004,7 +33004,7 @@
    the two documents are in the same &lt;a href=&quot;#unit-of&quot;&gt;unit of related
    browsing contexts&lt;/a&gt;, or null otherwise.
 
-  &lt;h5 id=event0&gt;&lt;span class=secno&gt;4.11.5.1. &lt;/span&gt;Event definition&lt;/h5&gt;
+  &lt;h6 id=event0&gt;&lt;span class=secno&gt;4.11.1.5.1. &lt;/span&gt;Event definition&lt;/h6&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=storageevent&gt;StorageEvent&lt;/dfn&gt; : Event {
   readonly attribute DOMString &lt;a href=&quot;#key&quot; title=dom-StorageEvent-key&gt;key&lt;/a&gt;;
@@ -33043,36 +33043,8 @@
    represents the &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; that changed the
    key.
 
-  &lt;h4 id=miscellaneous0&gt;&lt;span class=secno&gt;4.11.6 &lt;/span&gt;Miscellaneous
-   implementation requirements for storage areas&lt;/h4&gt;
+  &lt;h5 id=threads0&gt;&lt;span class=secno&gt;4.11.1.6. &lt;/span&gt;Threads&lt;/h5&gt;
 
-  &lt;h5 id=disk-space&gt;&lt;span class=secno&gt;4.11.6.1. &lt;/span&gt;Disk space&lt;/h5&gt;
-
-  &lt;p&gt;User agents should limit the total amount of space allowed for a storage
-   area.
-
-  &lt;p&gt;User agents should guard against sites storing data in the storage areas
-   of subdomains, e.g. storing up to the limit in a1.example.com,
-   a2.example.com, a3.example.com, etc, circumventing the main example.com
-   storage area's limit.
-
-  &lt;p&gt;User agents may prompt the user when quotas are reached, allowing the
-   user to grant a site more space. This enables sites to store many
-   user-created documents on the user's computer, for instance.
-
-  &lt;p&gt;User agents should allow users to see how much space each domain is
-   using.
-
-  &lt;p&gt;If the storage area space limit is reached during a &lt;code
-   title=dom-Storage-setItem&gt;&lt;a href=&quot;#setitem&quot;&gt;setItem()&lt;/a&gt;&lt;/code&gt; call,
-   the method will raise an exception.
-
-  &lt;p&gt;A mostly arbitrary limit of five megabytes per domain is recommended.
-   Implementation feedback is welcome and will be used to update this
-   suggestion in future.
-
-  &lt;h5 id=threads0&gt;&lt;span class=secno&gt;4.11.6.2. &lt;/span&gt;Threads&lt;/h5&gt;
-
   &lt;p&gt;Multiple browsing contexts must be able to access the local storage
    areas simultaneously in a predictable manner. Scripts must not be able to
    detect any concurrent script execution.
@@ -33095,164 +33067,14 @@
    execution. This specification does not require any particular
    implementation strategy, so long as the requirement above is met.
 
-  &lt;h4 id=security7&gt;&lt;span class=secno&gt;4.11.7 &lt;/span&gt;Security and privacy&lt;/h4&gt;
-
-  &lt;h5 id=user-tracking&gt;&lt;span class=secno&gt;4.11.7.1. &lt;/span&gt;User tracking&lt;/h5&gt;
-
-  &lt;p&gt;A third-party advertiser (or any entity capable of getting content
-   distributed to multiple sites) could use a unique identifier stored in its
-   local storage area to track a user across multiple sessions, building a
-   profile of the user's interests to allow for highly targeted advertising.
-   In conjunction with a site that is aware of the user's real identity (for
-   example an e-commerce site that requires authenticated credentials), this
-   could allow oppressive groups to target individuals with greater accuracy
-   than in a world with purely anonymous Web usage.
-
-  &lt;p&gt;There are a number of techniques that can be used to mitigate the risk
-   of user tracking:
-
-  &lt;ul&gt;
-   &lt;li&gt;
-    &lt;p&gt;Blocking third-party storage: user agents may restrict access to the
-     &lt;code title=dom-localStorage&gt;&lt;a
-     href=&quot;#localstorage&quot;&gt;localStorage&lt;/a&gt;&lt;/code&gt; object to scripts
-     originating at the domain of the top-level document of the &lt;a
-     href=&quot;#browsing0&quot;&gt;browsing context&lt;/a&gt;, for instance denying access to
-     the API for pages from other domains running in &lt;code&gt;&lt;a
-     href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt;s.&lt;/p&gt;
-
-   &lt;li&gt;
-    &lt;p&gt;Expiring stored data: user agents may automatically delete stored data
-     after a period of time.&lt;/p&gt;
-
-    &lt;p&gt;For example, a user agent could treat third-party local storage areas
-     as session-only storage, deleting the data once the user had closed all
-     the &lt;span&gt;browsing contexts&lt;/span&gt; that could access it.&lt;/p&gt;
-
-    &lt;p&gt;This can restrict the ability of a site to track a user, as the site
-     would then only be able to track the user across multiple sessions when
-     he authenticates with the site itself (e.g. by making a purchase or
-     logging in to a service).&lt;/p&gt;
-
-    &lt;p&gt;However, this also puts the user's data at risk.&lt;/p&gt;
-    &lt;!-- XXX should there be an explicit way for sites to state when
-    data should expire? as in
-    localStorage.expireData(365); ? --&gt;
-    
-
-   &lt;li&gt;
-    &lt;p&gt;Treating persistent storage as cookies: user agents may present the
-     persistent storage feature to the user in a way that does not
-     distinguish it from HTTP session cookies. &lt;a
-     href=&quot;#refsRFC2965&quot;&gt;[RFC2965]&lt;/a&gt;&lt;/p&gt;
-
-    &lt;p&gt;This might encourage users to view persistent storage with healthy
-     suspicion.&lt;/p&gt;
-
-   &lt;li&gt;
-    &lt;p&gt;Site-specific white-listing of access to local storage areas: user
-     agents may allow sites to access session storage areas in an
-     unrestricted manner, but require the user to authorise access to local
-     storage areas.&lt;/p&gt;
-
-   &lt;li&gt;
-    &lt;p&gt;Origin-tracking of persistent storage data: user agents may record the
-     origins of sites that contained content from third-party origins that
-     caused data to be stored.&lt;/p&gt;
-
-    &lt;p&gt;If this information is then used to present the view of data currently
-     in persistent storage, it would allow the user to make informed
-     decisions about which parts of the persistent storage to prune. Combined
-     with a blacklist (&quot;delete this data and prevent this domain from ever
-     storing data again&quot;), the user can restrict the use of persistent
-     storage to sites that he trusts.&lt;/p&gt;
-
-   &lt;li&gt;
-    &lt;p&gt;Shared blacklists: user agents may allow users to share their
-     persistent storage domain blacklists.&lt;/p&gt;
-
-    &lt;p&gt;This would allow communities to act together to protect their privacy.&lt;/p&gt;
-  &lt;/ul&gt;
-
-  &lt;p&gt;While these suggestions prevent trivial use of this API for user
-   tracking, they do not block it altogether. Within a single domain, a site
-   can continue to track the user during a session, and can then pass all
-   this information to the third party along with any identifying information
-   (names, credit card numbers, addresses) obtained by the site. If a third
-   party cooperates with multiple sites to obtain such information, a profile
-   can still be created.
-
-  &lt;p&gt;However, user tracking is to some extent possible even with no
-   cooperation from the user agent whatsoever, for instance by using session
-   identifiers in URIs, a technique already commonly used for innocuous
-   purposes but easily repurposed for user tracking (even retroactively).
-   This information can then be shared with other sites, using using
-   visitors' IP addresses and other user-specific data (e.g. user-agent
-   headers and configuration settings) to combine separate sessions into
-   coherent user profiles.
-
-  &lt;h5 id=cookie&gt;&lt;span class=secno&gt;4.11.7.2. &lt;/span&gt;Cookie resurrection&lt;/h5&gt;
-
-  &lt;p&gt;If the user interface for persistent storage presents data in the
-   persistent storage feature separately from data in HTTP session cookies,
-   then users are likely to delete data in one and not the other. This would
-   allow sites to use the two features as redundant backup for each other,
-   defeating a user's attempts to protect his privacy.
-
-  &lt;h5 id=dns-spoofing&gt;&lt;span class=secno&gt;4.11.7.3. &lt;/span&gt;DNS spoofing attacks&lt;/h5&gt;
-
-  &lt;p&gt;Because of the potential for DNS spoofing attacks, one cannot guarentee
-   that a host claiming to be in a certain domain really is from that domain.
-   To mitigate this, pages can use SSL. Pages using SSL can be sure that only
-   pages using SSL that have certificates identifying them as being from the
-   same domain can access their local storage areas.
-
-  &lt;h5 id=cross-directory&gt;&lt;span class=secno&gt;4.11.7.4. &lt;/span&gt;Cross-directory
-   attacks&lt;/h5&gt;
-
-  &lt;p&gt;Different authors sharing one host name, for example users hosting
-   content on &lt;code&gt;geocities.com&lt;/code&gt;, all share one persistent storage
-   object. There is no feature to restrict the access by pathname. Authors on
-   shared hosts are therefore recommended to avoid using the persistent
-   storage feature, as it would be trivial for other authors to read from and
-   write to the same storage area.
-
-  &lt;p class=note&gt;Even if a path-restriction feature was made available, the
-   usual DOM scripting security model would make it trivial to bypass this
-   protection and access the data from any path.
-
-  &lt;h5 id=implementation&gt;&lt;span class=secno&gt;4.11.7.5. &lt;/span&gt;Implementation
-   risks&lt;/h5&gt;
-
-  &lt;p&gt;The two primary risks when implementing this persistent storage feature
-   are letting hostile sites read information from other domains, and letting
-   hostile sites write information that is then read from other domains.
-
-  &lt;p&gt;Letting third-party sites read data that is not supposed to be read from
-   their domain causes &lt;em&gt;information leakage&lt;/em&gt;, For example, a user's
-   shopping wishlist on one domain could be used by another domain for
-   targeted advertising; or a user's work-in-progress confidential documents
-   stored by a word-processing site could be examined by the site of a
-   competing company.
-
-  &lt;p&gt;Letting third-party sites write data to the storage areas of other
-   domains can result in &lt;em&gt;information spoofing&lt;/em&gt;, which is equally
-   dangerous. For example, a hostile site could add items to a user's
-   wishlist; or a hostile site could set a user's session identifier to a
-   known ID that the hostile site can then use to track the user's actions on
-   the victim site.
-
-  &lt;p&gt;Thus, strictly following the model described in this specification is
-   important for user security.
-
-  &lt;h3 id=sql&gt;&lt;span class=secno&gt;4.12 &lt;/span&gt;Client-side database storage&lt;/h3&gt;
+  &lt;h4 id=sql&gt;&lt;span class=secno&gt;4.11.2 &lt;/span&gt;Database storage&lt;/h4&gt;
   &lt;!-- Feature requests for future versions (v2):
         * deleting databases
         * determining how much storage room is left
         * handling the database getting corrupted
   --&gt;
 
-  &lt;h4 id=introduction3&gt;&lt;span class=secno&gt;4.12.1 &lt;/span&gt;Introduction&lt;/h4&gt;
+  &lt;h5 id=introduction3&gt;&lt;span class=secno&gt;4.11.2.1. &lt;/span&gt;Introduction&lt;/h5&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;
 
@@ -33266,7 +33088,7 @@
    executeSql('SELECT rowid FROM t WHERE c IN (' + q + ')', array, ...);
 --&gt;
 
-  &lt;h4 id=databases&gt;&lt;span class=secno&gt;4.12.2 &lt;/span&gt;Databases&lt;/h4&gt;
+  &lt;h5 id=databases&gt;&lt;span class=secno&gt;4.11.2.2. &lt;/span&gt;Databases&lt;/h5&gt;
 
   &lt;p&gt;Each &lt;i&gt;&lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt;&lt;/i&gt; has an associated set of
    databases. Each database has a name and a current version. There is no way
@@ -33285,25 +33107,28 @@
    an estimated size, in bytes, of the data that will be stored in the
    database.
 
+  &lt;p&gt;The &lt;code title=dom-opendatabase&gt;&lt;a
+   href=&quot;#opendatabase&quot;&gt;openDatabase()&lt;/a&gt;&lt;/code&gt; method must use and create
+   databases from the &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; of the &lt;a
+   href=&quot;#active&quot;&gt;active document&lt;/a&gt; of the &lt;code&gt;&lt;a
+   href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the method was invoked.
+
   &lt;p&gt;If the database version provided is not the empty string, and the
    database already exists but has a different version, then the method must
    raise an &lt;code&gt;INVALID_STATE_ERR&lt;/code&gt; exception.
 
-  &lt;p&gt;The user agent may also raise a &lt;a href=&quot;#security10&quot;&gt;security
+  &lt;p&gt;The user agent may also raise a &lt;a href=&quot;#security9&quot;&gt;security
    exception&lt;/a&gt; in case the request violates a policy decision (e.g. if the
    user agent is configured to not allow the page to open databases).
 
-  &lt;p&gt;Otherwise, if the database provided is the empty string, or if the
-   database doesn't yet exist, or if the database exists and the version
+  &lt;p&gt;Otherwise, if the database version provided is the empty string, or if
+   the database doesn't yet exist, or if the database exists and the version
    provided to the &lt;code title=dom-opendatabase&gt;&lt;a
    href=&quot;#opendatabase&quot;&gt;openDatabase()&lt;/a&gt;&lt;/code&gt; method is the same as the
    current version associated with the database, then the method must return
    a &lt;code&gt;&lt;a href=&quot;#database0&quot;&gt;Database&lt;/a&gt;&lt;/code&gt; object representing the
-   database associated with the &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; of the &lt;a
-   href=&quot;#active&quot;&gt;active document&lt;/a&gt; of the &lt;a href=&quot;#browsing0&quot;&gt;browsing
-   context&lt;/a&gt; of the &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object on
-   which the method was called that has the name that was given. If no such
-   database exists, it must be created first.
+   database that has the name that was given. If no such database exists, it
+   must be created first.
 
   &lt;p&gt;All strings including the empty string are valid database names.
    Database names are case-sensitive.
@@ -33389,7 +33214,8 @@
     href=&quot;#changeversion&quot;&gt;changeVersion()&lt;/a&gt;&lt;/code&gt; method.
   &lt;/ol&gt;
 
-  &lt;h4 id=executing&gt;&lt;span class=secno&gt;4.12.3 &lt;/span&gt;Executing SQL statements&lt;/h4&gt;
+  &lt;h5 id=executing&gt;&lt;span class=secno&gt;4.11.2.3. &lt;/span&gt;Executing SQL
+   statements&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=dom-database-transaction&gt;&lt;a
    href=&quot;#transaction&quot;&gt;transaction()&lt;/a&gt;&lt;/code&gt; and &lt;code
@@ -33488,15 +33314,6 @@
    completely empty environment with no resources. For example, attempts to
    read from or write to the filesystem will fail.
 
-  &lt;p&gt;User agents should limit the total amount of space allowed for each
-   origin, but may prompt the user and extend the limit if a database is
-   reaching its quota. User agents should allow users to see how much space
-   each database is using.
-
-  &lt;p&gt;A mostly arbitrary limit of five megabytes per origin is recommended.
-   Implementation feedback is welcome and will be used to update this
-   suggestion in future.
-
   &lt;p&gt;SQL inherently supports multiple concurrent connections. Authors should
    make appropriate use of the transaction features to handle the case of
    multiple scripts interacting with the same database simultaneously (as
@@ -33512,7 +33329,7 @@
   &lt;p class=note&gt;A future version of this specification will probably define
    the exact SQL subset required in more detail.
 
-  &lt;h4 id=database&gt;&lt;span class=secno&gt;4.12.4 &lt;/span&gt;Database query results&lt;/h4&gt;
+  &lt;h5 id=database&gt;&lt;span class=secno&gt;4.11.2.4. &lt;/span&gt;Database query results&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=dom-transaction-executeSql&gt;executeSql()&lt;/code&gt; method
    invokes its callback with a &lt;code&gt;&lt;a
@@ -33544,7 +33361,9 @@
    attribute must return a &lt;code&gt;&lt;a
    href=&quot;#sqlresultsetrowlist&quot;&gt;SQLResultSetRowList&lt;/a&gt;&lt;/code&gt; representing
    the rows returned, in the order returned by the database. If no rows were
-   returned, then the object will be empty.
+   returned, then the object will be empty (its &lt;code
+   title=dom-SQLResultSetRowList-length&gt;&lt;a href=&quot;#length9&quot;&gt;length&lt;/a&gt;&lt;/code&gt;
+   will be zero).
 
   &lt;pre
    class=idl&gt;interface &lt;dfn id=sqlresultsetrowlist&gt;SQLResultSetRowList&lt;/dfn&gt; {
@@ -33572,7 +33391,7 @@
    have the name of the column and the value of the cell, as they were
    returned by the database.
 
-  &lt;h4 id=errors&gt;&lt;span class=secno&gt;4.12.5 &lt;/span&gt;Errors&lt;/h4&gt;
+  &lt;h5 id=errors&gt;&lt;span class=secno&gt;4.11.2.5. &lt;/span&gt;Errors&lt;/h5&gt;
 
   &lt;p&gt;Errors in the database API are reported using callbacks that have a
    &lt;code&gt;&lt;a href=&quot;#sqlerror&quot;&gt;SQLError&lt;/a&gt;&lt;/code&gt; object as one of their
@@ -33655,7 +33474,7 @@
    return an error message describing the error encountered. The message
    should be localised to the user's language.
 
-  &lt;h4 id=processing3&gt;&lt;span class=secno&gt;4.12.6 &lt;/span&gt;Processing model&lt;/h4&gt;
+  &lt;h5 id=processing3&gt;&lt;span class=secno&gt;4.11.2.6. &lt;/span&gt;Processing model&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=transaction0&gt;transaction steps&lt;/dfn&gt; are as follows. These
    steps must be run asynchronously. These steps are invoked with a
@@ -33783,25 +33602,186 @@
      still-pending statements in the transaction are discarded.
   &lt;/ol&gt;
 
-  &lt;h4 id=privacy&gt;&lt;span class=secno&gt;4.12.7 &lt;/span&gt;Privacy&lt;/h4&gt;
+  &lt;h4 id=disk-space&gt;&lt;span class=secno&gt;4.11.3 &lt;/span&gt;Disk space&lt;/h4&gt;
 
-  &lt;p&gt;In contrast with the &lt;code title=dom-localStorage&gt;&lt;a
-   href=&quot;#localstorage&quot;&gt;localStorage&lt;/a&gt;&lt;/code&gt; feature, which intentionally
-   allows data to be accessed across multiple domains, protocols, and ports
-   (albeit in a controlled fashion), this database feature is limited to
-   scripts running with the same &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; as the
-   database. Thus, it is expected that the privacy implications be equivalent
-   to those already present in allowing scripts to communicate with their
-   originating host.
+  &lt;p&gt;User agents should limit the total amount of space allowed for storage
+   areas and databases.
 
-  &lt;p&gt;User agents are encouraged to treat data stored in databases in the same
-   way as cookies for the purposes of user interfaces, to reduce the risk of
-   using this feature for cookie resurrection.
+  &lt;p&gt;User agents should guard against sites storing data in the storage areas
+   or databases of subdomains, e.g. storing up to the limit in
+   a1.example.com, a2.example.com, a3.example.com, etc, circumventing the
+   main example.com storage limit.
 
-  &lt;h4 id=security8&gt;&lt;span class=secno&gt;4.12.8 &lt;/span&gt;Security&lt;/h4&gt;
+  &lt;p&gt;User agents may prompt the user when quotas are reached, allowing the
+   user to grant a site more space. This enables sites to store many
+   user-created documents on the user's computer, for instance.
 
-  &lt;h5 id=user-agents&gt;&lt;span class=secno&gt;4.12.8.1. &lt;/span&gt;User agents&lt;/h5&gt;
+  &lt;p&gt;User agents should allow users to see how much space each domain is
+   using.&lt;/p&gt;
+  &lt;!--&lt;p&gt;If the storage area space limit is reached during a &lt;code
+  title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt; call, the method will
+  raise an exception.&lt;/p&gt;--&gt;
 
+  &lt;p&gt;A mostly arbitrary limit of five megabytes per domain is recommended.
+   Implementation feedback is welcome and will be used to update this
+   suggestion in future.
+
+  &lt;h4 id=privacy&gt;&lt;span class=secno&gt;4.11.4 &lt;/span&gt;Privacy&lt;/h4&gt;
+
+  &lt;h5 id=user-tracking&gt;&lt;span class=secno&gt;4.11.4.1. &lt;/span&gt;User tracking&lt;/h5&gt;
+
+  &lt;p&gt;A third-party advertiser (or any entity capable of getting content
+   distributed to multiple sites) could use a unique identifier stored in its
+   local storage area or in its client-side database to track a user across
+   multiple sessions, building a profile of the user's interests to allow for
+   highly targeted advertising. In conjunction with a site that is aware of
+   the user's real identity (for example an e-commerce site that requires
+   authenticated credentials), this could allow oppressive groups to target
+   individuals with greater accuracy than in a world with purely anonymous
+   Web usage.
+
+  &lt;p&gt;There are a number of techniques that can be used to mitigate the risk
+   of user tracking:
+
+  &lt;ul&gt;
+   &lt;li&gt;
+    &lt;p&gt;Blocking third-party storage: user agents may restrict access to the
+     &lt;code title=dom-localStorage&gt;&lt;a
+     href=&quot;#localstorage&quot;&gt;localStorage&lt;/a&gt;&lt;/code&gt; and database objects to
+     scripts originating at the domain of the top-level document of the &lt;a
+     href=&quot;#browsing0&quot;&gt;browsing context&lt;/a&gt;, for instance denying access to
+     the API for pages from other domains running in &lt;code&gt;&lt;a
+     href=&quot;#iframe&quot;&gt;iframe&lt;/a&gt;&lt;/code&gt;s.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Expiring stored data: user agents may automatically delete stored data
+     after a period of time.&lt;/p&gt;
+
+    &lt;p&gt;For example, a user agent could treat third-party local storage areas
+     as session-only storage, deleting the data once the user had closed all
+     the &lt;span&gt;browsing contexts&lt;/span&gt; that could access it.&lt;/p&gt;
+
+    &lt;p&gt;This can restrict the ability of a site to track a user, as the site
+     would then only be able to track the user across multiple sessions when
+     he authenticates with the site itself (e.g. by making a purchase or
+     logging in to a service).&lt;/p&gt;
+
+    &lt;p&gt;However, this also puts the user's data at risk.&lt;/p&gt;
+    &lt;!-- XXX should there be an explicit way for sites to state when
+    data should expire? as in
+    localStorage.expireData(365); ? --&gt;
+    
+
+   &lt;li&gt;
+    &lt;p&gt;Treating persistent storage as cookies: user agents should present the
+     persistent storage and database features to the user in a way that does
+     not distinguish them from HTTP session cookies. &lt;a
+     href=&quot;#refsRFC2965&quot;&gt;[RFC2965]&lt;/a&gt;&lt;/p&gt;
+
+    &lt;p&gt;This might encourage users to view persistent storage with healthy
+     suspicion.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Site-specific white-listing of access to local storage areas and
+     databases: user agents may allow sites to access session storage areas
+     in an unrestricted manner, but require the user to authorise access to
+     local storage areas and databases.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Origin-tracking of persistent storage data: user agents may record the
+     origins of sites that contained content from third-party origins that
+     caused data to be stored.&lt;/p&gt;
+
+    &lt;p&gt;If this information is then used to present the view of data currently
+     in persistent storage, it would allow the user to make informed
+     decisions about which parts of the persistent storage to prune. Combined
+     with a blacklist (&quot;delete this data and prevent this domain from ever
+     storing data again&quot;), the user can restrict the use of persistent
+     storage to sites that he trusts.&lt;/p&gt;
+
+   &lt;li&gt;
+    &lt;p&gt;Shared blacklists: user agents may allow users to share their
+     persistent storage domain blacklists.&lt;/p&gt;
+
+    &lt;p&gt;This would allow communities to act together to protect their privacy.&lt;/p&gt;
+  &lt;/ul&gt;
+
+  &lt;p&gt;While these suggestions prevent trivial use of these APIs for user
+   tracking, they do not block it altogether. Within a single domain, a site
+   can continue to track the user during a session, and can then pass all
+   this information to the third party along with any identifying information
+   (names, credit card numbers, addresses) obtained by the site. If a third
+   party cooperates with multiple sites to obtain such information, a profile
+   can still be created.
+
+  &lt;p&gt;However, user tracking is to some extent possible even with no
+   cooperation from the user agent whatsoever, for instance by using session
+   identifiers in URIs, a technique already commonly used for innocuous
+   purposes but easily repurposed for user tracking (even retroactively).
+   This information can then be shared with other sites, using using
+   visitors' IP addresses and other user-specific data (e.g. user-agent
+   headers and configuration settings) to combine separate sessions into
+   coherent user profiles.
+
+  &lt;h5 id=cookie&gt;&lt;span class=secno&gt;4.11.4.2. &lt;/span&gt;Cookie resurrection&lt;/h5&gt;
+
+  &lt;p&gt;If the user interface for persistent storage presents data in the
+   persistent storage features separately from data in HTTP session cookies,
+   then users are likely to delete data in one and not the other. This would
+   allow sites to use the two features as redundant backup for each other,
+   defeating a user's attempts to protect his privacy.
+
+  &lt;h4 id=security7&gt;&lt;span class=secno&gt;4.11.5 &lt;/span&gt;Security&lt;/h4&gt;
+
+  &lt;h5 id=dns-spoofing&gt;&lt;span class=secno&gt;4.11.5.1. &lt;/span&gt;DNS spoofing attacks&lt;/h5&gt;
+
+  &lt;p&gt;Because of the potential for DNS spoofing attacks, one cannot guarentee
+   that a host claiming to be in a certain domain really is from that domain.
+   To mitigate this, pages can use SSL. Pages using SSL can be sure that only
+   pages using SSL that have certificates identifying them as being from the
+   same domain can access their local storage areas and databases.
+
+  &lt;h5 id=cross-directory&gt;&lt;span class=secno&gt;4.11.5.2. &lt;/span&gt;Cross-directory
+   attacks&lt;/h5&gt;
+
+  &lt;p&gt;Different authors sharing one host name, for example users hosting
+   content on &lt;code&gt;geocities.com&lt;/code&gt;, all share one persistent storage
+   object and one set of databases. There is no feature to restrict the
+   access by pathname. Authors on shared hosts are therefore recommended to
+   avoid using the persistent storage features, as it would be trivial for
+   other authors to read from and write to the same storage area or database.
+
+  &lt;p class=note&gt;Even if a path-restriction feature was made available, the
+   usual DOM scripting security model would make it trivial to bypass this
+   protection and access the data from any path.
+
+  &lt;h5 id=implementation&gt;&lt;span class=secno&gt;4.11.5.3. &lt;/span&gt;Implementation
+   risks&lt;/h5&gt;
+
+  &lt;p&gt;The two primary risks when implementing these persistent storage
+   features are letting hostile sites read information from other domains,
+   and letting hostile sites write information that is then read from other
+   domains.
+
+  &lt;p&gt;Letting third-party sites read data that is not supposed to be read from
+   their domain causes &lt;em&gt;information leakage&lt;/em&gt;, For example, a user's
+   shopping wishlist on one domain could be used by another domain for
+   targeted advertising; or a user's work-in-progress confidential documents
+   stored by a word-processing site could be examined by the site of a
+   competing company.
+
+  &lt;p&gt;Letting third-party sites write data to the storage areas of other
+   domains can result in &lt;em&gt;information spoofing&lt;/em&gt;, which is equally
+   dangerous. For example, a hostile site could add items to a user's
+   wishlist; or a hostile site could set a user's session identifier to a
+   known ID that the hostile site can then use to track the user's actions on
+   the victim site.
+
+  &lt;p&gt;Thus, strictly following the &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; model
+   described in this specification is important for user security.
+
+  &lt;h5 id=sql-and&gt;&lt;span class=secno&gt;4.11.5.4. &lt;/span&gt;SQL and user agents&lt;/h5&gt;
+
   &lt;p&gt;User agent implementors are strongly encouraged to audit all their
    supported SQL statements for security implications. For example, &lt;code
    title=&quot;&quot;&gt;LOAD DATA INFILE&lt;/code&gt; is likely to pose security risks and
@@ -33813,7 +33793,7 @@
    disk representation of the data, as all data in ECMAScript is implicitly
    UTF-16.
 
-  &lt;h5 id=sql-injection&gt;&lt;span class=secno&gt;4.12.8.2. &lt;/span&gt;SQL injection&lt;/h5&gt;
+  &lt;h5 id=sql-injection&gt;&lt;span class=secno&gt;4.11.5.5. &lt;/span&gt;SQL injection&lt;/h5&gt;
 
   &lt;p&gt;Authors are strongly recommended to make use of the &lt;code
    title=&quot;&quot;&gt;?&lt;/code&gt; placeholder feature of the &lt;code
@@ -33821,9 +33801,9 @@
    href=&quot;#executesql&quot;&gt;executeSql()&lt;/a&gt;&lt;/code&gt; method, and to never construct
    SQL statements on the fly.
 
-  &lt;h3 id=links&gt;&lt;span class=secno&gt;4.13 &lt;/span&gt;Links&lt;/h3&gt;
+  &lt;h3 id=links&gt;&lt;span class=secno&gt;4.12 &lt;/span&gt;Links&lt;/h3&gt;
 
-  &lt;h4 id=hyperlink&gt;&lt;span class=secno&gt;4.13.1 &lt;/span&gt;Hyperlink elements&lt;/h4&gt;
+  &lt;h4 id=hyperlink&gt;&lt;span class=secno&gt;4.12.1 &lt;/span&gt;Hyperlink elements&lt;/h4&gt;
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#a&quot;&gt;a&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a
    href=&quot;#area&quot;&gt;area&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;&lt;a href=&quot;#link&quot;&gt;link&lt;/a&gt;&lt;/code&gt;
@@ -33901,7 +33881,7 @@
    fetching the resource, user agents must not use metadata included in the
    link to the resource to determine its type.
 
-  &lt;h4 id=following&gt;&lt;span class=secno&gt;4.13.2 &lt;/span&gt;&lt;dfn
+  &lt;h4 id=following&gt;&lt;span class=secno&gt;4.12.2 &lt;/span&gt;&lt;dfn
    id=following0&gt;Following hyperlinks&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When a user &lt;em&gt;follows a hyperlink&lt;/em&gt;, the user agent must &lt;a
@@ -33956,7 +33936,7 @@
   &lt;p&gt;Otherwise, the browsing context that must be navigated is the same
    browsing context as the one which the hyperlink element itself is in.
 
-  &lt;h5 id=hyperlink0&gt;&lt;span class=secno&gt;4.13.2.1. &lt;/span&gt;Hyperlink auditing&lt;/h5&gt;
+  &lt;h5 id=hyperlink0&gt;&lt;span class=secno&gt;4.12.2.1. &lt;/span&gt;Hyperlink auditing&lt;/h5&gt;
 
   &lt;p&gt;If an &lt;code&gt;&lt;a href=&quot;#a&quot;&gt;a&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a
    href=&quot;#area&quot;&gt;area&lt;/a&gt;&lt;/code&gt; hyperlink element has a &lt;code
@@ -34058,7 +34038,7 @@
    it sounds kooky. --&gt;
    &lt;/div&gt;
 
-  &lt;h4 id=linkTypes&gt;&lt;span class=secno&gt;4.13.3 &lt;/span&gt;Link types&lt;/h4&gt;
+  &lt;h4 id=linkTypes&gt;&lt;span class=secno&gt;4.12.3 &lt;/span&gt;Link types&lt;/h4&gt;
 
   &lt;p&gt;The following table summarises the link types that are defined by this
    specification. This table is non-normative; the actual definitions for the
@@ -34381,7 +34361,7 @@
 
     --&gt;
 
-  &lt;h5 id=link-type&gt;&lt;span class=secno&gt;4.13.3.1. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type&gt;&lt;span class=secno&gt;4.12.3.1. &lt;/span&gt;Link type &quot;&lt;dfn
    id=alternate title=rel-alternate&gt;&lt;code&gt;alternate&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-alternate&gt;&lt;a href=&quot;#alternate&quot;&gt;alternate&lt;/a&gt;&lt;/code&gt;
@@ -34458,7 +34438,7 @@
    document, it is also implying that those two documents are alternative
    representations of each other.
 
-  &lt;h5 id=link-type0&gt;&lt;span class=secno&gt;4.13.3.2. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type0&gt;&lt;span class=secno&gt;4.12.3.2. &lt;/span&gt;Link type &quot;&lt;dfn
    id=archives title=rel-archives&gt;&lt;code&gt;archives&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-archives&gt;&lt;a href=&quot;#archives&quot;&gt;archives&lt;/a&gt;&lt;/code&gt;
@@ -34478,7 +34458,7 @@
    treat the keyword &quot;&lt;code title=&quot;&quot;&gt;archive&lt;/code&gt;&quot; like the &lt;code
    title=rel-archives&gt;&lt;a href=&quot;#archives&quot;&gt;archives&lt;/a&gt;&lt;/code&gt; keyword.
 
-  &lt;h5 id=link-type1&gt;&lt;span class=secno&gt;4.13.3.3. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type1&gt;&lt;span class=secno&gt;4.12.3.3. &lt;/span&gt;Link type &quot;&lt;dfn
    id=author title=rel-author&gt;&lt;code&gt;author&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-author&gt;&lt;a href=&quot;#author&quot;&gt;author&lt;/a&gt;&lt;/code&gt; keyword
@@ -34510,7 +34490,7 @@
    &quot;&lt;code&gt;made&lt;/code&gt;&quot; as having the &lt;code title=rel-author&gt;&lt;a
    href=&quot;#author&quot;&gt;author&lt;/a&gt;&lt;/code&gt; keyword specified as a link relationship.
 
-  &lt;h5 id=link-type2&gt;&lt;span class=secno&gt;4.13.3.4. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type2&gt;&lt;span class=secno&gt;4.12.3.4. &lt;/span&gt;Link type &quot;&lt;dfn
    id=bookmark title=rel-bookmark&gt;&lt;code&gt;bookmark&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-bookmark&gt;&lt;a href=&quot;#bookmark&quot;&gt;bookmark&lt;/a&gt;&lt;/code&gt;
@@ -34551,7 +34531,7 @@
  ...&lt;/pre&gt;
   &lt;/div&gt;
 
-  &lt;h5 id=link-type3&gt;&lt;span class=secno&gt;4.13.3.5. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type3&gt;&lt;span class=secno&gt;4.12.3.5. &lt;/span&gt;Link type &quot;&lt;dfn
    id=contact title=rel-contact&gt;&lt;code&gt;contact&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-contact&gt;&lt;a href=&quot;#contact&quot;&gt;contact&lt;/a&gt;&lt;/code&gt;
@@ -34576,7 +34556,7 @@
    that the referenced document provides further contact information for the
    page as a whole.
 
-  &lt;h5 id=link-type4&gt;&lt;span class=secno&gt;4.13.3.6. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type4&gt;&lt;span class=secno&gt;4.12.3.6. &lt;/span&gt;Link type &quot;&lt;dfn
    id=external title=rel-external&gt;&lt;code&gt;external&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-external&gt;&lt;a href=&quot;#external&quot;&gt;external&lt;/a&gt;&lt;/code&gt;
@@ -34587,7 +34567,7 @@
    keyword indicates that the link is leading to a document that is not part
    of the site that the current document forms a part of.
 
-  &lt;h5 id=link-type5&gt;&lt;span class=secno&gt;4.13.3.7. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type5&gt;&lt;span class=secno&gt;4.12.3.7. &lt;/span&gt;Link type &quot;&lt;dfn
    id=feed title=rel-feed&gt;&lt;code&gt;feed&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-feed&gt;&lt;a href=&quot;#feed&quot;&gt;feed&lt;/a&gt;&lt;/code&gt; keyword may be
@@ -34631,7 +34611,7 @@
  &lt;/ul&gt;&lt;/pre&gt;
   &lt;/div&gt;
 
-  &lt;h5 id=link-type6&gt;&lt;span class=secno&gt;4.13.3.8. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type6&gt;&lt;span class=secno&gt;4.12.3.8. &lt;/span&gt;Link type &quot;&lt;dfn
    id=help title=rel-help&gt;&lt;code&gt;help&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-help&gt;&lt;a href=&quot;#help&quot;&gt;help&lt;/a&gt;&lt;/code&gt; keyword may be
@@ -34659,7 +34639,7 @@
    title=rel-help&gt;&lt;a href=&quot;#help&quot;&gt;help&lt;/a&gt;&lt;/code&gt; keyword indicates that the
    referenced document provides help for the page as a whole.
 
-  &lt;h5 id=link-type7&gt;&lt;span class=secno&gt;4.13.3.9. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type7&gt;&lt;span class=secno&gt;4.12.3.9. &lt;/span&gt;Link type &quot;&lt;dfn
    id=icon3 title=rel-icon&gt;&lt;code&gt;icon&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-icon&gt;&lt;a href=&quot;#icon3&quot;&gt;icon&lt;/a&gt;&lt;/code&gt; keyword may be
@@ -34681,7 +34661,7 @@
   &lt;!-- XXX we don't define
   the content-type sniffing for this keyword --&gt;
 
-  &lt;h5 id=link-type8&gt;&lt;span class=secno&gt;4.13.3.10. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type8&gt;&lt;span class=secno&gt;4.12.3.10. &lt;/span&gt;Link type &quot;&lt;dfn
    id=license title=rel-license&gt;&lt;code&gt;license&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-license&gt;&lt;a href=&quot;#license&quot;&gt;license&lt;/a&gt;&lt;/code&gt;
@@ -34698,7 +34678,7 @@
    treat the keyword &quot;&lt;code title=&quot;&quot;&gt;copyright&lt;/code&gt;&quot; like the &lt;code
    title=rel-license&gt;&lt;a href=&quot;#license&quot;&gt;license&lt;/a&gt;&lt;/code&gt; keyword.
 
-  &lt;h5 id=link-type9&gt;&lt;span class=secno&gt;4.13.3.11. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type9&gt;&lt;span class=secno&gt;4.12.3.11. &lt;/span&gt;Link type &quot;&lt;dfn
    id=nofollow title=rel-nofollow&gt;&lt;code&gt;nofollow&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-nofollow&gt;&lt;a href=&quot;#nofollow&quot;&gt;nofollow&lt;/a&gt;&lt;/code&gt;
@@ -34709,7 +34689,7 @@
    keyword indicates that the link is not endorsed by the original author or
    publisher of the page.
 
-  &lt;h5 id=link-type10&gt;&lt;span class=secno&gt;4.13.3.12. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type10&gt;&lt;span class=secno&gt;4.12.3.12. &lt;/span&gt;Link type &quot;&lt;dfn
    id=noreferrer title=rel-noreferrer&gt;&lt;code&gt;noreferrer&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-noreferrer&gt;&lt;a
@@ -34723,7 +34703,7 @@
    include a &lt;code title=&quot;&quot;&gt;Referer&lt;/code&gt; HTTP header (or equivalent for
    other protocols) in the request.
 
-  &lt;h5 id=link-type11&gt;&lt;span class=secno&gt;4.13.3.13. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type11&gt;&lt;span class=secno&gt;4.12.3.13. &lt;/span&gt;Link type &quot;&lt;dfn
    id=pingback title=rel-pingback&gt;&lt;code&gt;pingback&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-pingback&gt;&lt;a href=&quot;#pingback&quot;&gt;pingback&lt;/a&gt;&lt;/code&gt;
@@ -34735,7 +34715,7 @@
    href=&quot;#pingback&quot;&gt;pingback&lt;/a&gt;&lt;/code&gt; keyword, see the Pingback 1.0
    specification. &lt;a href=&quot;#refsPINGBACK&quot;&gt;[PINGBACK]&lt;/a&gt;
 
-  &lt;h5 id=link-type12&gt;&lt;span class=secno&gt;4.13.3.14. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type12&gt;&lt;span class=secno&gt;4.12.3.14. &lt;/span&gt;Link type &quot;&lt;dfn
    id=prefetch title=rel-prefetch&gt;&lt;code&gt;prefetch&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-prefetch&gt;&lt;a href=&quot;#prefetch&quot;&gt;prefetch&lt;/a&gt;&lt;/code&gt;
@@ -34751,7 +34731,7 @@
   &lt;p&gt;There is no default type for resources given by the &lt;code
    title=rel-prefetch&gt;&lt;a href=&quot;#prefetch&quot;&gt;prefetch&lt;/a&gt;&lt;/code&gt; keyword.
 
-  &lt;h5 id=link-type13&gt;&lt;span class=secno&gt;4.13.3.15. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type13&gt;&lt;span class=secno&gt;4.12.3.15. &lt;/span&gt;Link type &quot;&lt;dfn
    id=search0 title=rel-search&gt;&lt;code&gt;search&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-search&gt;&lt;a href=&quot;#search0&quot;&gt;search&lt;/a&gt;&lt;/code&gt; keyword
@@ -34772,7 +34752,7 @@
   <A HREF="http://www.opensearch.org/Specifications/OpenSearch/1.1#Autodiscovery_in_HTML.2FXHTML">http://www.opensearch.org/Specifications/OpenSearch/1.1#Autodiscovery_in_HTML.2FXHTML</A>
   --&gt;
 
-  &lt;h5 id=link-type14&gt;&lt;span class=secno&gt;4.13.3.16. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type14&gt;&lt;span class=secno&gt;4.12.3.16. &lt;/span&gt;Link type &quot;&lt;dfn
    id=stylesheet title=rel-stylesheet&gt;&lt;code&gt;stylesheet&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-stylesheet&gt;&lt;a
@@ -34800,7 +34780,7 @@
    not a supported style sheet type, the user agent must instead assume it to
    be &lt;code title=&quot;&quot;&gt;text/css&lt;/code&gt;.
 
-  &lt;h5 id=link-type15&gt;&lt;span class=secno&gt;4.13.3.17. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type15&gt;&lt;span class=secno&gt;4.12.3.17. &lt;/span&gt;Link type &quot;&lt;dfn
    id=sidebar title=rel-sidebar&gt;&lt;code&gt;sidebar&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-sidebar&gt;&lt;a href=&quot;#sidebar&quot;&gt;sidebar&lt;/a&gt;&lt;/code&gt;
@@ -34820,7 +34800,7 @@
    specified is a &lt;dfn id=sidebar0 title=rel-sidebar-hyperlink&gt;sidebar
    hyperlink&lt;/dfn&gt;.
 
-  &lt;h5 id=link-type16&gt;&lt;span class=secno&gt;4.13.3.18. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h5 id=link-type16&gt;&lt;span class=secno&gt;4.12.3.18. &lt;/span&gt;Link type &quot;&lt;dfn
    id=tag title=rel-tag&gt;&lt;code&gt;tag&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=rel-tag&gt;&lt;a href=&quot;#tag&quot;&gt;tag&lt;/a&gt;&lt;/code&gt; keyword may be
@@ -34833,7 +34813,7 @@
    that the &lt;em&gt;tag&lt;/em&gt; that the referenced document represents applies to
    the current document.
 
-  &lt;h5 id=hierarchical&gt;&lt;span class=secno&gt;4.13.3.19. &lt;/span&gt;Hierarchical link
+  &lt;h5 id=hierarchical&gt;&lt;span class=secno&gt;4.12.3.19. &lt;/span&gt;Hierarchical link
    types&lt;/h5&gt;
 
   &lt;p&gt;Some documents form part of a hierarchical structure of documents.
@@ -34845,7 +34825,7 @@
 
   &lt;p&gt;A document may be part of multiple hierarchies.
 
-  &lt;h6 id=link-type17&gt;&lt;span class=secno&gt;4.13.3.19.1. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h6 id=link-type17&gt;&lt;span class=secno&gt;4.12.3.19.1. &lt;/span&gt;Link type &quot;&lt;dfn
    id=index title=rel-index&gt;&lt;code&gt;index&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h6&gt;
 
   &lt;p&gt;The &lt;code title=rel-index&gt;&lt;a href=&quot;#index&quot;&gt;index&lt;/a&gt;&lt;/code&gt; keyword may
@@ -34865,7 +34845,7 @@
    title=&quot;&quot;&gt;contents&lt;/code&gt;&quot;, and &quot;&lt;code title=&quot;&quot;&gt;toc&lt;/code&gt;&quot; like the &lt;code
    title=rel-index&gt;&lt;a href=&quot;#index&quot;&gt;index&lt;/a&gt;&lt;/code&gt; keyword.
 
-  &lt;h6 id=link-type18&gt;&lt;span class=secno&gt;4.13.3.19.2. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h6 id=link-type18&gt;&lt;span class=secno&gt;4.12.3.19.2. &lt;/span&gt;Link type &quot;&lt;dfn
    id=up title=rel-up&gt;&lt;code&gt;up&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h6&gt;
 
   &lt;p&gt;The &lt;code title=rel-up&gt;&lt;a href=&quot;#up&quot;&gt;up&lt;/a&gt;&lt;/code&gt; keyword may be used
@@ -34930,7 +34910,7 @@
    &lt;code title=rel-up&gt;&lt;a href=&quot;#up&quot;&gt;up&lt;/a&gt;&lt;/code&gt; keywords (the interface
    hides duplicates).
 
-  &lt;h5 id=sequential0&gt;&lt;span class=secno&gt;4.13.3.20. &lt;/span&gt;Sequential link
+  &lt;h5 id=sequential0&gt;&lt;span class=secno&gt;4.12.3.20. &lt;/span&gt;Sequential link
    types&lt;/h5&gt;
 
   &lt;p&gt;Some documents form part of a sequence of documents.
@@ -34942,7 +34922,7 @@
 
   &lt;p&gt;A document may be part of multiple sequences.
 
-  &lt;h6 id=link-type19&gt;&lt;span class=secno&gt;4.13.3.20.1. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h6 id=link-type19&gt;&lt;span class=secno&gt;4.12.3.20.1. &lt;/span&gt;Link type &quot;&lt;dfn
    id=first title=rel-first&gt;&lt;code&gt;first&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h6&gt;
 
   &lt;p&gt;The &lt;code title=rel-first&gt;&lt;a href=&quot;#first&quot;&gt;first&lt;/a&gt;&lt;/code&gt; keyword may
@@ -34961,7 +34941,7 @@
    title=&quot;&quot;&gt;start&lt;/code&gt;&quot; like the &lt;code title=rel-first&gt;&lt;a
    href=&quot;#first&quot;&gt;first&lt;/a&gt;&lt;/code&gt; keyword.
 
-  &lt;h6 id=link-type20&gt;&lt;span class=secno&gt;4.13.3.20.2. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h6 id=link-type20&gt;&lt;span class=secno&gt;4.12.3.20.2. &lt;/span&gt;Link type &quot;&lt;dfn
    id=last title=rel-last&gt;&lt;code&gt;last&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h6&gt;
 
   &lt;p&gt;The &lt;code title=rel-last&gt;&lt;a href=&quot;#last&quot;&gt;last&lt;/a&gt;&lt;/code&gt; keyword may be
@@ -34978,7 +34958,7 @@
    treat the keyword &quot;&lt;code title=&quot;&quot;&gt;end&lt;/code&gt;&quot; like the &lt;code
    title=rel-last&gt;&lt;a href=&quot;#last&quot;&gt;last&lt;/a&gt;&lt;/code&gt; keyword.
 
-  &lt;h6 id=link-type21&gt;&lt;span class=secno&gt;4.13.3.20.3. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h6 id=link-type21&gt;&lt;span class=secno&gt;4.12.3.20.3. &lt;/span&gt;Link type &quot;&lt;dfn
    id=next title=rel-next&gt;&lt;code&gt;next&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h6&gt;
 
   &lt;p&gt;The &lt;code title=rel-next&gt;&lt;a href=&quot;#next&quot;&gt;next&lt;/a&gt;&lt;/code&gt; keyword may be
@@ -34991,7 +34971,7 @@
    indicates that the document is part of a sequence, and that the link is
    leading to the document that is the next logical document in the sequence.
 
-  &lt;h6 id=link-type22&gt;&lt;span class=secno&gt;4.13.3.20.4. &lt;/span&gt;Link type &quot;&lt;dfn
+  &lt;h6 id=link-type22&gt;&lt;span class=secno&gt;4.12.3.20.4. &lt;/span&gt;Link type &quot;&lt;dfn
    id=prev title=rel-prev&gt;&lt;code&gt;prev&lt;/code&gt;&lt;/dfn&gt;&quot;&lt;/h6&gt;
 
   &lt;p&gt;The &lt;code title=rel-prev&gt;&lt;a href=&quot;#prev&quot;&gt;prev&lt;/a&gt;&lt;/code&gt; keyword may be
@@ -35009,7 +34989,7 @@
    treat the keyword &quot;&lt;code title=&quot;&quot;&gt;previous&lt;/code&gt;&quot; like the &lt;code
    title=rel-prev&gt;&lt;a href=&quot;#prev&quot;&gt;prev&lt;/a&gt;&lt;/code&gt; keyword.
 
-  &lt;h5 id=other0&gt;&lt;span class=secno&gt;4.13.3.21. &lt;/span&gt;Other link types&lt;/h5&gt;
+  &lt;h5 id=other0&gt;&lt;span class=secno&gt;4.12.3.21. &lt;/span&gt;Other link types&lt;/h5&gt;
 
   &lt;p&gt;Other than the types defined above, only types defined as extensions in
    the &lt;a href=&quot;<A HREF="http://wiki.whatwg.org/wiki/RelExtensions">http://wiki.whatwg.org/wiki/RelExtensions</A>&quot;&gt;WHATWG Wiki
@@ -35138,7 +35118,7 @@
   &lt;p&gt;This specification does not define how new values will get approved. It
    is expected that the Wiki will have a community that addresses this.
 
-  &lt;h3 id=interfaces&gt;&lt;span class=secno&gt;4.14 &lt;/span&gt;Interfaces for URI
+  &lt;h3 id=interfaces&gt;&lt;span class=secno&gt;4.13 &lt;/span&gt;Interfaces for URI
    manipulation&lt;/h3&gt;
 
   &lt;p&gt;An interface that has a complement of &lt;dfn id=uri-decomposition&gt;URI
@@ -36732,7 +36712,7 @@
    element with the keyboard focus, and then ended the drag-and-drop
    operation without canceling it.
 
-  &lt;h4 id=security9&gt;&lt;span class=secno&gt;5.3.7 &lt;/span&gt;Security risks in the
+  &lt;h4 id=security8&gt;&lt;span class=secno&gt;5.3.7 &lt;/span&gt;Security risks in the
    drag-and-drop model&lt;/h4&gt;
 
   &lt;p&gt;User agents must not make the data added to the &lt;code&gt;&lt;a
@@ -38724,7 +38704,7 @@
 
   &lt;p&gt;First, if the domain part of the script's &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt;
    is not a host name (e.g. it is an IP address) then the UA must raise a &lt;a
-   href=&quot;#security10&quot;&gt;security exception&lt;/a&gt;. &lt;span class=issue&gt;We currently
+   href=&quot;#security9&quot;&gt;security exception&lt;/a&gt;. &lt;span class=issue&gt;We currently
    don't allow connections to be set up back to an originating IP address,
    but we could, if the subdomain is the empty string.&lt;/span&gt;
 
@@ -38744,16 +38724,15 @@
     65535,
   &lt;/ul&gt;
 
-  &lt;p&gt;...then the UA must raise a &lt;a href=&quot;#security10&quot;&gt;security
-   exception&lt;/a&gt;.&lt;/p&gt;
+  &lt;p&gt;...then the UA must raise a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt;.&lt;/p&gt;
   &lt;!-- XXX we should have our own port for this too, e.g. 980 --&gt;
 
   &lt;p&gt;Otherwise, the user agent must verify that the &lt;a
    href=&quot;#the-string0&quot;&gt;the string representing the script's domain in IDNA
    format&lt;/a&gt; can be obtained without errors. If it cannot, then the user
-   agent must raise a &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt;.
+   agent must raise a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt;.
 
-  &lt;p&gt;The user agent may also raise a &lt;a href=&quot;#security10&quot;&gt;security
+  &lt;p&gt;The user agent may also raise a &lt;a href=&quot;#security9&quot;&gt;security
    exception&lt;/a&gt; at this time if, for some reason, permission to create a
    direct TCP connection to the relevant host is denied. Reasons could
    include the UA being instructed by the user to not allow direct
@@ -38815,7 +38794,7 @@
    href=&quot;#network1&quot;&gt;network&lt;/a&gt;&lt;/code&gt; attribute of the object must be set to
    &lt;a href=&quot;#the-string0&quot;&gt;the string representing the script's domain in IDNA
    format&lt;/a&gt;. If this string cannot be obtained, then the user agent must
-   raise a &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt; exception when the
+   raise a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt; exception when the
    constructor is called.
 
   &lt;p&gt;The &lt;code title=dom-Connection-peer&gt;&lt;a href=&quot;#peer&quot;&gt;peer&lt;/a&gt;&lt;/code&gt;
@@ -38823,7 +38802,7 @@
 
   &lt;p&gt;The object must then be returned, unless, for some reason, permission to
    broadcast on the local network is to be denied. In the latter case, a &lt;a
-   href=&quot;#security10&quot;&gt;security exception&lt;/a&gt; must be raised instead. User
+   href=&quot;#security9&quot;&gt;security exception&lt;/a&gt; must be raised instead. User
    agents may deny such permission for any reason, for example a user
    preference.
 
@@ -38953,7 +38932,7 @@
    href=&quot;#network1&quot;&gt;network&lt;/a&gt;&lt;/code&gt; attribute of the object must be set to
    &lt;a href=&quot;#the-string0&quot;&gt;the string representing the script's domain in IDNA
    format&lt;/a&gt;. If this string cannot be obtained, then the user agent must
-   raise a &lt;a href=&quot;#security10&quot;&gt;security exception&lt;/a&gt; exception when the
+   raise a &lt;a href=&quot;#security9&quot;&gt;security exception&lt;/a&gt; exception when the
    constructor is called.
 
   &lt;p&gt;The &lt;code title=dom-Connection-peer&gt;&lt;a href=&quot;#peer&quot;&gt;peer&lt;/a&gt;&lt;/code&gt;
@@ -38962,7 +38941,7 @@
   &lt;p&gt;The object must then be returned, unless, for some reason, permission to
    establish peer-to-peer connections is generally disallowed, for example
    due to administrator settings. In the latter case, a &lt;a
-   href=&quot;#security10&quot;&gt;security exception&lt;/a&gt; must be raised instead.
+   href=&quot;#security9&quot;&gt;security exception&lt;/a&gt; must be raised instead.
 
   &lt;p&gt;The user agent must then, typically while the script resumes execution,
    find a remote host to establish a connection to. To do this it must start

Modified: source
===================================================================
--- source	2008-05-07 03:27:23 UTC (rev 1543)
+++ source	2008-05-07 04:03:40 UTC (rev 1544)
@@ -30418,10 +30418,11 @@
 
 
 
+  &lt;h3&gt;Structured client-side storage&lt;/h3&gt;
 
-  &lt;h3 id=&quot;storage&quot;&gt;Client-side session and persistent storage of name/value pairs&lt;/h3&gt;
+  &lt;h4 id=&quot;storage&quot;&gt;Storing name/value pairs&lt;/h4&gt;
 
-  &lt;h4&gt;Introduction&lt;/h4&gt;
+  &lt;h5&gt;Introduction&lt;/h5&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -30519,7 +30520,7 @@
   convert it to a string.&lt;/p&gt;
 
 
-  &lt;h4&gt;The &lt;code&gt;Storage&lt;/code&gt; interface&lt;/h4&gt;
+  &lt;h5&gt;The &lt;code&gt;Storage&lt;/code&gt; interface&lt;/h5&gt;
 
   &lt;!-- XXX shouldn't we define somewhere how null values get handled
   in these methods? Do they get converted to the empty string or
@@ -30629,7 +30630,7 @@
   --&gt;
 
 
-  &lt;h4&gt;The &lt;code title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; attribute&lt;/h4&gt;
+  &lt;h5&gt;The &lt;code title=&quot;dom-sessionStorage&quot;&gt;sessionStorage&lt;/code&gt; attribute&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn
   title=&quot;dom-sessionStorage&quot;&gt;&lt;code&gt;sessionStorage&lt;/code&gt;&lt;/dfn&gt;
@@ -30695,7 +30696,7 @@
   title=&quot;event-storage&quot;&gt;described below&lt;/span&gt;.&lt;/p&gt;
 
 
-  &lt;h4&gt;The &lt;code title=&quot;dom-localStorage&quot;&gt;localStorage&lt;/code&gt; attribute&lt;/h4&gt;
+  &lt;h5&gt;The &lt;code title=&quot;dom-localStorage&quot;&gt;localStorage&lt;/code&gt; attribute&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-localStorage&quot;&gt;&lt;code&gt;localStorage&lt;/code&gt;&lt;/dfn&gt;
   object provides a &lt;code&gt;Storage&lt;/code&gt; object for an
@@ -30736,7 +30737,7 @@
   title=&quot;event-storage&quot;&gt;described below&lt;/span&gt;.&lt;/p&gt;
 
 
-  &lt;h4&gt;The &lt;code title=&quot;event-storage&quot;&gt;storage&lt;/code&gt; event&lt;/h4&gt;
+  &lt;h5&gt;The &lt;code title=&quot;event-storage&quot;&gt;storage&lt;/code&gt; event&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;event-storage&quot;&gt;&lt;code&gt;storage&lt;/code&gt;&lt;/dfn&gt; event
   is fired in an &lt;code&gt;HTMLDocument&lt;/code&gt; when a storage area
@@ -30779,7 +30780,7 @@
   otherwise.&lt;/p&gt;
 
 
-  &lt;h5&gt;Event definition&lt;/h5&gt;
+  &lt;h6&gt;Event definition&lt;/h6&gt;
 
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;StorageEvent&lt;/dfn&gt; : Event {
   readonly attribute DOMString &lt;span title=&quot;dom-StorageEvent-key&quot;&gt;key&lt;/span&gt;;
@@ -30820,35 +30821,6 @@
 
 
 
-  &lt;h4&gt;Miscellaneous implementation requirements for storage areas&lt;/h4&gt;
-
-  &lt;h5&gt;Disk space&lt;/h5&gt;
-
-  &lt;p&gt;User agents should limit the total amount of space allowed for a
-  storage area.&lt;/p&gt;
-
-  &lt;p&gt;User agents should guard against sites storing data in the
-  storage areas of subdomains, e.g. storing up to the limit in
-  a1.example.com, a2.example.com, a3.example.com, etc, circumventing
-  the main example.com storage area's limit.&lt;/p&gt;
-
-  &lt;p&gt;User agents may prompt the user when quotas are reached, allowing
-  the user to grant a site more space. This enables sites to store
-  many user-created documents on the user's computer, for
-  instance.&lt;/p&gt;
-
-  &lt;p&gt;User agents should allow users to see how much space each domain
-  is using.&lt;/p&gt;
-
-  &lt;p&gt;If the storage area space limit is reached during a &lt;code
-  title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt; call, the method will
-  raise an exception.&lt;/p&gt;
-
-  &lt;p&gt;A mostly arbitrary limit of five megabytes per domain is
-  recommended. Implementation feedback is welcome and will be used to
-  update this suggestion in future.&lt;/p&gt;
-
-
   &lt;h5&gt;Threads&lt;/h5&gt;
 
   &lt;p&gt;Multiple browsing contexts must be able to access the local
@@ -30877,197 +30849,17 @@
   met.&lt;/p&gt;
 
 
-  &lt;h4&gt;Security and privacy&lt;/h4&gt;
 
-  &lt;h5&gt;User tracking&lt;/h5&gt;
 
-  &lt;p&gt;A third-party advertiser (or any entity capable of getting
-  content distributed to multiple sites) could use a unique identifier
-  stored in its local storage area to track a user across multiple
-  sessions, building a profile of the user's interests to allow for
-  highly targeted advertising. In conjunction with a site that is
-  aware of the user's real identity (for example an e-commerce site
-  that requires authenticated credentials), this could allow
-  oppressive groups to target individuals with greater accuracy than
-  in a world with purely anonymous Web usage.&lt;/p&gt;
+  &lt;h4 id=&quot;sql&quot;&gt;Database storage&lt;/h4&gt;
 
-  &lt;p&gt;There are a number of techniques that can be used to mitigate the
-  risk of user tracking:&lt;/p&gt;
-
-  &lt;ul&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Blocking third-party storage: user agents may restrict access
-    to the &lt;code title=&quot;dom-localStorage&quot;&gt;localStorage&lt;/code&gt; object
-    to scripts originating at the domain of the top-level document of
-    the &lt;span&gt;browsing context&lt;/span&gt;, for instance denying access to
-    the API for pages from other domains running in
-    &lt;code&gt;iframe&lt;/code&gt;s.&lt;/p&gt;
-
-   &lt;/li&gt;
- 
-   &lt;li&gt;
-
-    &lt;p&gt;Expiring stored data: user agents may automatically delete
-    stored data after a period of time.&lt;/p&gt;
-
-    &lt;p&gt;For example, a user agent could treat third-party local
-    storage areas as session-only storage, deleting the data once the
-    user had closed all the &lt;span&gt;browsing contexts&lt;/span&gt; that could
-    access it.&lt;/p&gt;
-
-    &lt;p&gt;This can restrict the ability of a site to track a user, as the
-    site would then only be able to track the user across multiple
-    sessions when he authenticates with the site itself (e.g. by
-    making a purchase or logging in to a service).&lt;/p&gt;
-
-    &lt;p&gt;However, this also puts the user's data at risk.&lt;/p&gt;
-
-    &lt;!-- XXX should there be an explicit way for sites to state when
-    data should expire? as in
-    localStorage.expireData(365); ? --&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Treating persistent storage as cookies: user agents may present
-    the persistent storage feature to the user in a way that does not
-    distinguish it from HTTP session cookies. &lt;a
-    href=&quot;#refsRFC2965&quot;&gt;[RFC2965]&lt;/a&gt;&lt;/p&gt;
-
-    &lt;p&gt;This might encourage users to view persistent storage with
-    healthy suspicion.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Site-specific white-listing of access to local storage areas:
-    user agents may allow sites to access session storage areas in an
-    unrestricted manner, but require the user to authorise access to
-    local storage areas.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Origin-tracking of persistent storage data: user agents may
-    record the origins of sites that contained content from
-    third-party origins that caused data to be stored.&lt;/p&gt;
-
-    &lt;p&gt;If this information is then used to present the view of data
-    currently in persistent storage, it would allow the user to make
-    informed decisions about which parts of the persistent storage to
-    prune. Combined with a blacklist (&quot;delete this data and prevent
-    this domain from ever storing data again&quot;), the user can restrict
-    the use of persistent storage to sites that he trusts.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Shared blacklists: user agents may allow users to share their
-    persistent storage domain blacklists.&lt;/p&gt;
-
-    &lt;p&gt;This would allow communities to act together to protect their
-    privacy.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-  &lt;/ul&gt;
-
-  &lt;p&gt;While these suggestions prevent trivial use of this API for user
-  tracking, they do not block it altogether. Within a single domain, a
-  site can continue to track the user during a session, and can then
-  pass all this information to the third party along with any
-  identifying information (names, credit card numbers, addresses)
-  obtained by the site. If a third party cooperates with multiple
-  sites to obtain such information, a profile can still be
-  created.&lt;/p&gt;
-
-  &lt;p&gt;However, user tracking is to some extent possible even with no
-  cooperation from the user agent whatsoever, for instance by using
-  session identifiers in URIs, a technique already commonly used for
-  innocuous purposes but easily repurposed for user tracking (even
-  retroactively). This information can then be shared with other
-  sites, using using visitors' IP addresses and other user-specific
-  data (e.g. user-agent headers and configuration settings) to combine
-  separate sessions into coherent user profiles.&lt;/p&gt;
-
-
-  &lt;h5&gt;Cookie resurrection&lt;/h5&gt;
-
-  &lt;p&gt;If the user interface for persistent storage presents data in the
-  persistent storage feature separately from data in HTTP session
-  cookies, then users are likely to delete data in one and not the
-  other. This would allow sites to use the two features as redundant
-  backup for each other, defeating a user's attempts to protect his
-  privacy.&lt;/p&gt;
-
-
-  &lt;h5&gt;DNS spoofing attacks&lt;/h5&gt;
-
-  &lt;p&gt;Because of the potential for DNS spoofing attacks, one cannot
-  guarentee that a host claiming to be in a certain domain really is
-  from that domain. To mitigate this, pages can use SSL. Pages using
-  SSL can be sure that only pages using SSL that have certificates
-  identifying them as being from the same domain can access their
-  local storage areas.&lt;/p&gt;
-
-
-  &lt;h5&gt;Cross-directory attacks&lt;/h5&gt;
-
-  &lt;p&gt;Different authors sharing one host name, for example users
-  hosting content on &lt;code&gt;geocities.com&lt;/code&gt;, all share one
-  persistent storage object. There is no feature to restrict the
-  access by pathname. Authors on shared hosts are therefore
-  recommended to avoid using the persistent storage feature, as it
-  would be trivial for other authors to read from and write to the
-  same storage area.&lt;/p&gt;
-
-  &lt;p class=&quot;note&quot;&gt;Even if a path-restriction feature was made
-  available, the usual DOM scripting security model would make it
-  trivial to bypass this protection and access the data from any
-  path.&lt;/p&gt;
-
-
-  &lt;h5&gt;Implementation risks&lt;/h5&gt;
-
-  &lt;p&gt;The two primary risks when implementing this persistent storage
-  feature are letting hostile sites read information from other
-  domains, and letting hostile sites write information that is then
-  read from other domains.&lt;/p&gt;
-
-  &lt;p&gt;Letting third-party sites read data that is not supposed to be
-  read from their domain causes &lt;em&gt;information leakage&lt;/em&gt;, For
-  example, a user's shopping wishlist on one domain could be used by
-  another domain for targeted advertising; or a user's
-  work-in-progress confidential documents stored by a word-processing
-  site could be examined by the site of a competing company.&lt;/p&gt;
-
-  &lt;p&gt;Letting third-party sites write data to the storage areas of
-  other domains can result in &lt;em&gt;information spoofing&lt;/em&gt;, which is
-  equally dangerous. For example, a hostile site could add items to a
-  user's wishlist; or a hostile site could set a user's session
-  identifier to a known ID that the hostile site can then use to track
-  the user's actions on the victim site.&lt;/p&gt;
-
-  &lt;p&gt;Thus, strictly following the model described in this
-  specification is important for user security.&lt;/p&gt;
-
-
-
-  &lt;h3 id=&quot;sql&quot;&gt;Client-side database storage&lt;/h3&gt;
-
   &lt;!-- Feature requests for future versions (v2):
         * deleting databases
         * determining how much storage room is left
         * handling the database getting corrupted
   --&gt;
 
-  &lt;h4&gt;Introduction&lt;/h4&gt;
+  &lt;h5&gt;Introduction&lt;/h5&gt;
 
   &lt;p&gt;&lt;em&gt;This section is non-normative.&lt;/em&gt;&lt;/p&gt;
 
@@ -31082,7 +30874,7 @@
    executeSql('SELECT rowid FROM t WHERE c IN (' + q + ')', array, ...);
 --&gt;
 
-  &lt;h4&gt;Databases&lt;/h4&gt;
+  &lt;h5&gt;Databases&lt;/h5&gt;
 
   &lt;p&gt;Each &lt;i&gt;origin&lt;/i&gt; has an associated set of databases. Each
   database has a name and a current version. There is no way to
@@ -31103,6 +30895,11 @@
   an estimated size, in bytes, of the data that will be stored in the
   database.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;code title=&quot;dom-opendatabase&quot;&gt;openDatabase()&lt;/code&gt; method
+  must use and create databases from the &lt;span&gt;origin&lt;/span&gt; of the
+  &lt;span&gt;active document&lt;/span&gt; of the &lt;code&gt;Window&lt;/code&gt; object on
+  which the method was invoked.&lt;/p&gt;
+
   &lt;p&gt;If the database version provided is not the empty string, and the
   database already exists but has a different version, then the method
   must raise an &lt;code&gt;INVALID_STATE_ERR&lt;/code&gt; exception.&lt;/p&gt;
@@ -31111,17 +30908,14 @@
   in case the request violates a policy decision (e.g. if the user
   agent is configured to not allow the page to open databases).&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, if the database provided is the empty string, or if
-  the database doesn't yet exist, or if the database exists and the
-  version provided to the &lt;code
+  &lt;p&gt;Otherwise, if the database version provided is the empty string,
+  or if the database doesn't yet exist, or if the database exists and
+  the version provided to the &lt;code
   title=&quot;dom-opendatabase&quot;&gt;openDatabase()&lt;/code&gt; method is the same as
   the current version associated with the database, then the method
   must return a &lt;code&gt;Database&lt;/code&gt; object representing the database
-  associated with the &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;active
-  document&lt;/span&gt; of the &lt;span&gt;browsing context&lt;/span&gt; of the
-  &lt;code&gt;Window&lt;/code&gt; object on which the method was called that has
-  the name that was given. If no such database exists, it must be
-  created first.&lt;/p&gt;
+  that has the name that was given. If no such database exists, it
+  must be created first.&lt;/p&gt;
 
   &lt;p&gt;All strings including the empty string are valid database
   names. Database names are case-sensitive.&lt;/p&gt;
@@ -31215,7 +31009,7 @@
   &lt;/ol&gt;
 
 
-  &lt;h4&gt;Executing SQL statements&lt;/h4&gt;
+  &lt;h5&gt;Executing SQL statements&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=&quot;dom-database-transaction&quot;&gt;transaction()&lt;/code&gt;
   and &lt;code title=&quot;dom-database-changeVersion&quot;&gt;changeVersion()&lt;/code&gt;
@@ -31312,15 +31106,7 @@
   example, attempts to read from or write to the filesystem will
   fail.&lt;/p&gt;
 
-  &lt;p&gt;User agents should limit the total amount of space allowed for
-  each origin, but may prompt the user and extend the limit if a
-  database is reaching its quota. User agents should allow users to
-  see how much space each database is using.&lt;/p&gt;
 
-  &lt;p&gt;A mostly arbitrary limit of five megabytes per origin is
-  recommended. Implementation feedback is welcome and will be used to
-  update this suggestion in future.&lt;/p&gt;
-
   &lt;p&gt;SQL inherently supports multiple concurrent connections. Authors
   should make appropriate use of the transaction features to handle
   the case of multiple scripts interacting with the same database
@@ -31339,7 +31125,7 @@
   define the exact SQL subset required in more detail.&lt;/p&gt;
 
 
-  &lt;h4&gt;Database query results&lt;/h4&gt;
+  &lt;h5&gt;Database query results&lt;/h5&gt;
 
   &lt;p&gt;The &lt;code title=&quot;dom-transaction-executeSql&quot;&gt;executeSql()&lt;/code&gt;
   method invokes its callback with a &lt;code&gt;SQLResultSet&lt;/code&gt; object
@@ -31370,8 +31156,9 @@
   &lt;p&gt;The &lt;dfn title=&quot;dom-SQLResultSet-rows&quot;&gt;&lt;code&gt;rows&lt;/code&gt;&lt;/dfn&gt;
   attribute must return a &lt;code&gt;SQLResultSetRowList&lt;/code&gt;
   representing the rows returned, in the order returned by the
-  database. If no rows were returned, then the object will be
-  empty.&lt;/p&gt;
+  database. If no rows were returned, then the object will be empty
+  (its &lt;code title=&quot;dom-SQLResultSetRowList-length&quot;&gt;length&lt;/code&gt; will
+  be zero).&lt;/p&gt;
 
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;SQLResultSetRowList&lt;/dfn&gt; {
   readonly attribute unsigned long &lt;span title=&quot;dom-SQLResultSetRowList-length&quot;&gt;length&lt;/span&gt;;
@@ -31398,7 +31185,7 @@
   by the database.&lt;/p&gt;
 
 
-  &lt;h4&gt;Errors&lt;/h4&gt;
+  &lt;h5&gt;Errors&lt;/h5&gt;
 
   &lt;p&gt;Errors in the database API are reported using callbacks that have
   a &lt;code&gt;SQLError&lt;/code&gt; object as one of their arguments.&lt;/p&gt;
@@ -31478,7 +31265,7 @@
 
 
 
-  &lt;h4&gt;Processing model&lt;/h4&gt;
+  &lt;h5&gt;Processing model&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn&gt;transaction steps&lt;/dfn&gt; are as follows. These steps must
   be run asynchronously. These steps are invoked with a &lt;i&gt;transaction
@@ -31595,26 +31382,219 @@
 
 
 
+  &lt;h4&gt;Disk space&lt;/h4&gt;
+
+  &lt;p&gt;User agents should limit the total amount of space allowed for
+  storage areas and databases.&lt;/p&gt;
+
+  &lt;p&gt;User agents should guard against sites storing data in the
+  storage areas or databases of subdomains, e.g. storing up to the
+  limit in a1.example.com, a2.example.com, a3.example.com, etc,
+  circumventing the main example.com storage limit.&lt;/p&gt;
+
+  &lt;p&gt;User agents may prompt the user when quotas are reached, allowing
+  the user to grant a site more space. This enables sites to store
+  many user-created documents on the user's computer, for
+  instance.&lt;/p&gt;
+
+  &lt;p&gt;User agents should allow users to see how much space each domain
+  is using.&lt;/p&gt;
+
+  &lt;!--&lt;p&gt;If the storage area space limit is reached during a &lt;code
+  title=&quot;dom-Storage-setItem&quot;&gt;setItem()&lt;/code&gt; call, the method will
+  raise an exception.&lt;/p&gt;--&gt;
+
+  &lt;p&gt;A mostly arbitrary limit of five megabytes per domain is
+  recommended. Implementation feedback is welcome and will be used to
+  update this suggestion in future.&lt;/p&gt;
+
+
   &lt;h4&gt;Privacy&lt;/h4&gt;
 
-  &lt;p&gt;In contrast with the &lt;code
-  title=&quot;dom-localStorage&quot;&gt;localStorage&lt;/code&gt; feature, which
-  intentionally allows data to be accessed across multiple domains,
-  protocols, and ports (albeit in a controlled fashion), this database
-  feature is limited to scripts running with the same
-  &lt;span&gt;origin&lt;/span&gt; as the database. Thus, it is expected that the
-  privacy implications be equivalent to those already present in
-  allowing scripts to communicate with their originating host.&lt;/p&gt;
+  &lt;h5&gt;User tracking&lt;/h5&gt;
 
-  &lt;p&gt;User agents are encouraged to treat data stored in databases in
-  the same way as cookies for the purposes of user interfaces, to
-  reduce the risk of using this feature for cookie resurrection.&lt;/p&gt;
+  &lt;p&gt;A third-party advertiser (or any entity capable of getting
+  content distributed to multiple sites) could use a unique identifier
+  stored in its local storage area or in its client-side database to
+  track a user across multiple sessions, building a profile of the
+  user's interests to allow for highly targeted advertising. In
+  conjunction with a site that is aware of the user's real identity
+  (for example an e-commerce site that requires authenticated
+  credentials), this could allow oppressive groups to target
+  individuals with greater accuracy than in a world with purely
+  anonymous Web usage.&lt;/p&gt;
 
+  &lt;p&gt;There are a number of techniques that can be used to mitigate the
+  risk of user tracking:&lt;/p&gt;
 
+  &lt;ul&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Blocking third-party storage: user agents may restrict access
+    to the &lt;code title=&quot;dom-localStorage&quot;&gt;localStorage&lt;/code&gt; and
+    database objects to scripts originating at the domain of the
+    top-level document of the &lt;span&gt;browsing context&lt;/span&gt;, for
+    instance denying access to the API for pages from other domains
+    running in &lt;code&gt;iframe&lt;/code&gt;s.&lt;/p&gt;
+
+   &lt;/li&gt;
+ 
+   &lt;li&gt;
+
+    &lt;p&gt;Expiring stored data: user agents may automatically delete
+    stored data after a period of time.&lt;/p&gt;
+
+    &lt;p&gt;For example, a user agent could treat third-party local
+    storage areas as session-only storage, deleting the data once the
+    user had closed all the &lt;span&gt;browsing contexts&lt;/span&gt; that could
+    access it.&lt;/p&gt;
+
+    &lt;p&gt;This can restrict the ability of a site to track a user, as the
+    site would then only be able to track the user across multiple
+    sessions when he authenticates with the site itself (e.g. by
+    making a purchase or logging in to a service).&lt;/p&gt;
+
+    &lt;p&gt;However, this also puts the user's data at risk.&lt;/p&gt;
+
+    &lt;!-- XXX should there be an explicit way for sites to state when
+    data should expire? as in
+    localStorage.expireData(365); ? --&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Treating persistent storage as cookies: user agents should
+    present the persistent storage and database features to the user
+    in a way that does not distinguish them from HTTP session
+    cookies. &lt;a href=&quot;#refsRFC2965&quot;&gt;[RFC2965]&lt;/a&gt;&lt;/p&gt;
+
+    &lt;p&gt;This might encourage users to view persistent storage with
+    healthy suspicion.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Site-specific white-listing of access to local storage areas
+    and databases: user agents may allow sites to access session
+    storage areas in an unrestricted manner, but require the user to
+    authorise access to local storage areas and databases.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Origin-tracking of persistent storage data: user agents may
+    record the origins of sites that contained content from
+    third-party origins that caused data to be stored.&lt;/p&gt;
+
+    &lt;p&gt;If this information is then used to present the view of data
+    currently in persistent storage, it would allow the user to make
+    informed decisions about which parts of the persistent storage to
+    prune. Combined with a blacklist (&quot;delete this data and prevent
+    this domain from ever storing data again&quot;), the user can restrict
+    the use of persistent storage to sites that he trusts.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Shared blacklists: user agents may allow users to share their
+    persistent storage domain blacklists.&lt;/p&gt;
+
+    &lt;p&gt;This would allow communities to act together to protect their
+    privacy.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ul&gt;
+
+  &lt;p&gt;While these suggestions prevent trivial use of these APIs for
+  user tracking, they do not block it altogether. Within a single
+  domain, a site can continue to track the user during a session, and
+  can then pass all this information to the third party along with any
+  identifying information (names, credit card numbers, addresses)
+  obtained by the site. If a third party cooperates with multiple
+  sites to obtain such information, a profile can still be
+  created.&lt;/p&gt;
+
+  &lt;p&gt;However, user tracking is to some extent possible even with no
+  cooperation from the user agent whatsoever, for instance by using
+  session identifiers in URIs, a technique already commonly used for
+  innocuous purposes but easily repurposed for user tracking (even
+  retroactively). This information can then be shared with other
+  sites, using using visitors' IP addresses and other user-specific
+  data (e.g. user-agent headers and configuration settings) to combine
+  separate sessions into coherent user profiles.&lt;/p&gt;
+
+
+  &lt;h5&gt;Cookie resurrection&lt;/h5&gt;
+
+  &lt;p&gt;If the user interface for persistent storage presents data in the
+  persistent storage features separately from data in HTTP session
+  cookies, then users are likely to delete data in one and not the
+  other. This would allow sites to use the two features as redundant
+  backup for each other, defeating a user's attempts to protect his
+  privacy.&lt;/p&gt;
+
+
   &lt;h4&gt;Security&lt;/h4&gt;
 
-  &lt;h5&gt;User agents&lt;/h5&gt;
+  &lt;h5&gt;DNS spoofing attacks&lt;/h5&gt;
 
+  &lt;p&gt;Because of the potential for DNS spoofing attacks, one cannot
+  guarentee that a host claiming to be in a certain domain really is
+  from that domain. To mitigate this, pages can use SSL. Pages using
+  SSL can be sure that only pages using SSL that have certificates
+  identifying them as being from the same domain can access their
+  local storage areas and databases.&lt;/p&gt;
+
+
+  &lt;h5&gt;Cross-directory attacks&lt;/h5&gt;
+
+  &lt;p&gt;Different authors sharing one host name, for example users
+  hosting content on &lt;code&gt;geocities.com&lt;/code&gt;, all share one
+  persistent storage object and one set of databases. There is no
+  feature to restrict the access by pathname. Authors on shared hosts
+  are therefore recommended to avoid using the persistent storage
+  features, as it would be trivial for other authors to read from and
+  write to the same storage area or database.&lt;/p&gt;
+
+  &lt;p class=&quot;note&quot;&gt;Even if a path-restriction feature was made
+  available, the usual DOM scripting security model would make it
+  trivial to bypass this protection and access the data from any
+  path.&lt;/p&gt;
+
+
+  &lt;h5&gt;Implementation risks&lt;/h5&gt;
+
+  &lt;p&gt;The two primary risks when implementing these persistent storage
+  features are letting hostile sites read information from other
+  domains, and letting hostile sites write information that is then
+  read from other domains.&lt;/p&gt;
+
+  &lt;p&gt;Letting third-party sites read data that is not supposed to be
+  read from their domain causes &lt;em&gt;information leakage&lt;/em&gt;, For
+  example, a user's shopping wishlist on one domain could be used by
+  another domain for targeted advertising; or a user's
+  work-in-progress confidential documents stored by a word-processing
+  site could be examined by the site of a competing company.&lt;/p&gt;
+
+  &lt;p&gt;Letting third-party sites write data to the storage areas of
+  other domains can result in &lt;em&gt;information spoofing&lt;/em&gt;, which is
+  equally dangerous. For example, a hostile site could add items to a
+  user's wishlist; or a hostile site could set a user's session
+  identifier to a known ID that the hostile site can then use to track
+  the user's actions on the victim site.&lt;/p&gt;
+
+  &lt;p&gt;Thus, strictly following the &lt;span&gt;origin&lt;/span&gt; model described
+  in this specification is important for user security.&lt;/p&gt;
+
+
+  &lt;h5&gt;SQL and user agents&lt;/h5&gt;
+
   &lt;p&gt;User agent implementors are strongly encouraged to audit all
   their supported SQL statements for security implications. For
   example, &lt;code title=&quot;&quot;&gt;LOAD DATA INFILE&lt;/code&gt; is likely to pose


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008442.html">[html5] r1543 - /
</A></li>
	<LI>Next message: <A HREF="008444.html">[html5] r1545 - /
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8443">[ date ]</a>
              <a href="thread.html#8443">[ thread ]</a>
              <a href="subject.html#8443">[ subject ]</a>
              <a href="author.html#8443">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
