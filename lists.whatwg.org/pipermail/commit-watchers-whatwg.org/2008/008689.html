<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r1791 - [acgiowrt] (2) Define 'URL' and 'valid U [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1791%20-%20%5Bacgiowrt%5D%20%282%29%20Define%20%27URL%27%20and%20%27valid%20U%20%5B...%5D&In-Reply-To=%3C20080624002104.B459938E1C9%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008688.html">
   <LINK REL="Next"  HREF="008690.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r1791 - [acgiowrt] (2) Define 'URL' and 'valid U [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r1791%20-%20%5Bacgiowrt%5D%20%282%29%20Define%20%27URL%27%20and%20%27valid%20U%20%5B...%5D&In-Reply-To=%3C20080624002104.B459938E1C9%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r1791 - [acgiowrt] (2) Define 'URL' and 'valid U [...]">whatwg at whatwg.org
       </A><BR>
    <I>Mon Jun 23 17:21:04 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008688.html">[html5] r1790 - /
</A></li>
        <LI>Next message: <A HREF="008690.html">[html5] r1792 - [e] (0) Hm, that didn't work well. Let's [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8689">[ date ]</a>
              <a href="thread.html#8689">[ thread ]</a>
              <a href="subject.html#8689">[ subject ]</a>
              <a href="author.html#8689">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2008-06-23 17:21:03 -0700 (Mon, 23 Jun 2008)
New Revision: 1791

Modified:
   index
   source
Log:
[acgiowrt] (2) Define 'URL' and 'valid URL'. Define 'script document context'. Introduce the term 'script browsing context' for the existing concept of 'browsing context associated with a script execution context' and use that term where appropriate. Define origin of onfoo='' scripts. Fix xref errors. Minor editorial fixes.

Modified: index
===================================================================
--- index	2008-06-19 09:27:25 UTC (rev 1790)
+++ index	2008-06-24 00:21:03 UTC (rev 1791)
@@ -25,7 +25,7 @@
 
    &lt;h1 id=html-5&gt;HTML 5&lt;/h1&gt;
 
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft&gt;Draft Recommendation &mdash; 19 June
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft&gt;Draft Recommendation &mdash; 24 June
     2008&lt;/h2&gt;
 
    &lt;p&gt;You can take part in this work. &lt;a
@@ -213,7 +213,10 @@
 
      &lt;li&gt;&lt;a href=&quot;#urls&quot;&gt;&lt;span class=secno&gt;2.3 &lt;/span&gt;URLs&lt;/a&gt;
       &lt;ul class=toc&gt;
-       &lt;li&gt;&lt;a href=&quot;#interfaces&quot;&gt;&lt;span class=secno&gt;2.3.1 &lt;/span&gt;Interfaces
+       &lt;li&gt;&lt;a href=&quot;#terminology0&quot;&gt;&lt;span class=secno&gt;2.3.1
+        &lt;/span&gt;Terminology&lt;/a&gt;
+
+       &lt;li&gt;&lt;a href=&quot;#interfaces&quot;&gt;&lt;span class=secno&gt;2.3.2 &lt;/span&gt;Interfaces
         for URI manipulation&lt;/a&gt;
       &lt;/ul&gt;
 
@@ -2681,6 +2684,40 @@
   &lt;h3 id=urls&gt;&lt;span class=secno&gt;2.3 &lt;/span&gt;URLs&lt;/h3&gt;
   &lt;!-- XXXURL --&gt;
 
+  &lt;p class=big-issue&gt;The text in this section is not yet integrated with the
+   rest of the specification.
+
+  &lt;h4 id=terminology0&gt;&lt;span class=secno&gt;2.3.1 &lt;/span&gt;Terminology&lt;/h4&gt;
+
+  &lt;p&gt;A &lt;dfn id=url&gt;URL&lt;/dfn&gt; is a string used to identify a resource. A &lt;a
+   href=&quot;#url&quot;&gt;URL&lt;/a&gt; is always associated with a &lt;code&gt;Document&lt;/code&gt;,
+   either explicitly when the URL is created or defined; or through a DOM
+   node, in which case the associated &lt;code&gt;Document&lt;/code&gt; is the node's
+   &lt;code&gt;Document&lt;/code&gt;; or through a script, in which case the associated
+   &lt;code&gt;Document&lt;/code&gt; is the script's &lt;a href=&quot;#script4&quot;&gt;script document
+   context&lt;/a&gt;.
+
+  &lt;p&gt;A &lt;a href=&quot;#url&quot;&gt;URL&lt;/a&gt; is a &lt;dfn id=valid&gt;valid URL&lt;/dfn&gt; if at least
+   one of the following conditions holds:
+
+  &lt;ul&gt;
+   &lt;li&gt;
+    &lt;p&gt;The &lt;a href=&quot;#url&quot;&gt;URL&lt;/a&gt; is a valid URI.
+
+   &lt;li&gt;
+    &lt;p&gt;The &lt;a href=&quot;#url&quot;&gt;URL&lt;/a&gt; is a valid IRI and it has no query
+     component.
+
+   &lt;li&gt;
+    &lt;p&gt;The &lt;a href=&quot;#url&quot;&gt;URL&lt;/a&gt; is a valid IRI and its query component
+     contains no unescaped non-ASCII characters.
+
+   &lt;li&gt;
+    &lt;p&gt;The &lt;a href=&quot;#url&quot;&gt;URL&lt;/a&gt; is a valid IRI and the &lt;a
+     href=&quot;#character1&quot; title=&quot;document's character encoding&quot;&gt;character
+     encoding&lt;/a&gt; of the URL's &lt;code&gt;Document&lt;/code&gt; is UTF-8.
+  &lt;/ul&gt;
+
   &lt;div class=big-issue&gt;
    &lt;p&gt;This section will do the following:&lt;/p&gt;
 
@@ -2785,7 +2822,7 @@
   &lt;/div&gt;
   &lt;!-- XXXURL change to URL --&gt;
 
-  &lt;h4 id=interfaces&gt;&lt;span class=secno&gt;2.3.1 &lt;/span&gt;Interfaces for URI
+  &lt;h4 id=interfaces&gt;&lt;span class=secno&gt;2.3.2 &lt;/span&gt;Interfaces for URI
    manipulation&lt;/h4&gt;
   &lt;!-- XXXURL change to URL --&gt;
 
@@ -3078,7 +3115,7 @@
 
   &lt;h5 id=unsigned&gt;&lt;span class=secno&gt;2.4.3.1. &lt;/span&gt;Unsigned integers&lt;/h5&gt;
 
-  &lt;p&gt;A string is a &lt;dfn id=valid&gt;valid non-negative integer&lt;/dfn&gt; if it
+  &lt;p&gt;A string is a &lt;dfn id=valid0&gt;valid non-negative integer&lt;/dfn&gt; if it
    consists of one of more characters in the range U+0030 DIGIT ZERO (0) to
    U+0039 DIGIT NINE (9).
 
@@ -3139,7 +3176,7 @@
 
   &lt;h5 id=signed&gt;&lt;span class=secno&gt;2.4.3.2. &lt;/span&gt;Signed integers&lt;/h5&gt;
 
-  &lt;p&gt;A string is a &lt;dfn id=valid0&gt;valid integer&lt;/dfn&gt; if it consists of one
+  &lt;p&gt;A string is a &lt;dfn id=valid1&gt;valid integer&lt;/dfn&gt; if it consists of one
    of more characters in the range U+0030 DIGIT ZERO (0) to U+0039 DIGIT NINE
    (9), optionally prefixed with a U+002D HYPHEN-MINUS (&quot;-&quot;) character.
 
@@ -3217,7 +3254,7 @@
 
   &lt;h5 id=real-numbers&gt;&lt;span class=secno&gt;2.4.3.3. &lt;/span&gt;Real numbers&lt;/h5&gt;
 
-  &lt;p&gt;A string is a &lt;dfn id=valid1&gt;valid floating point number&lt;/dfn&gt; if it
+  &lt;p&gt;A string is a &lt;dfn id=valid2&gt;valid floating point number&lt;/dfn&gt; if it
    consists of one of more characters in the range U+0030 DIGIT ZERO (0) to
    U+0039 DIGIT NINE (9), optionally with a single U+002E FULL STOP (&quot;.&quot;)
    character somewhere (either before these numbers, in between two numbers,
@@ -3343,7 +3380,7 @@
    &lt;code&gt;&lt;a href=&quot;#progress&quot;&gt;progress&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a
    href=&quot;#meter&quot;&gt;meter&lt;/a&gt;&lt;/code&gt; elements.
 
-  &lt;p&gt;A &lt;dfn id=valid2&gt;valid denominator punctuation character&lt;/dfn&gt; is one of
+  &lt;p&gt;A &lt;dfn id=valid3&gt;valid denominator punctuation character&lt;/dfn&gt; is one of
    the characters from the table below. There is &lt;dfn id=a-value
    title=&quot;values associated with denominator punctuation characters&quot;&gt;a value
    associated with each denominator punctuation character&lt;/dfn&gt;, as shown in
@@ -3421,7 +3458,7 @@
     href=&quot;#refsUNICODE&quot;&gt;[UNICODE]&lt;/a&gt;
 
    &lt;li&gt;If there are still further characters in the string, and the next
-    character in the string is a &lt;a href=&quot;#valid2&quot;&gt;valid denominator
+    character in the string is a &lt;a href=&quot;#valid3&quot;&gt;valid denominator
     punctuation character&lt;/a&gt;, set &lt;var title=&quot;&quot;&gt;denominator&lt;/var&gt; to that
     character.
 
@@ -3444,7 +3481,7 @@
     sub-algorithm in step 9.
 
    &lt;li&gt;If there are still further characters in the string, and the next
-    character in the string is a &lt;a href=&quot;#valid2&quot;&gt;valid denominator
+    character in the string is a &lt;a href=&quot;#valid3&quot;&gt;valid denominator
     punctuation character&lt;/a&gt;, return nothing and abort these steps.
 
    &lt;li&gt;If the string contains any other characters in the range U+0030 DIGIT
@@ -3479,7 +3516,7 @@
    &lt;li&gt;Parse &lt;var title=&quot;&quot;&gt;string&lt;/var&gt; according to the &lt;a
     href=&quot;#rules1&quot;&gt;rules for parsing floating point number values&lt;/a&gt;, to
     obtain &lt;var title=&quot;&quot;&gt;number&lt;/var&gt;. This step cannot fail (&lt;var
-    title=&quot;&quot;&gt;string&lt;/var&gt; is guaranteed to be a &lt;a href=&quot;#valid1&quot;&gt;valid
+    title=&quot;&quot;&gt;string&lt;/var&gt; is guaranteed to be a &lt;a href=&quot;#valid2&quot;&gt;valid
     floating point number&lt;/a&gt;).
 
    &lt;li&gt;Return &lt;var title=&quot;&quot;&gt;number&lt;/var&gt;.
@@ -3488,15 +3525,15 @@
   &lt;h5 id=percentages-and-dimensions&gt;&lt;span class=secno&gt;2.4.3.5.
    &lt;/span&gt;Percentages and dimensions&lt;/h5&gt;
 
-  &lt;p class=big-issue&gt;&lt;dfn id=valid3&gt;valid positive non-zero integers&lt;/dfn&gt;
+  &lt;p class=big-issue&gt;&lt;dfn id=valid4&gt;valid positive non-zero integers&lt;/dfn&gt;
    &lt;dfn id=rules2&gt;rules for parsing dimension values&lt;/dfn&gt; (only used by
    height/width on img, embed, object &mdash; lengths in css pixels or
    percentages)
 
   &lt;h5 id=lists&gt;&lt;span class=secno&gt;2.4.3.6. &lt;/span&gt;Lists of integers&lt;/h5&gt;
 
-  &lt;p&gt;A &lt;dfn id=valid4&gt;valid list of integers&lt;/dfn&gt; is a number of &lt;a
-   href=&quot;#valid0&quot; title=&quot;valid integer&quot;&gt;valid integers&lt;/a&gt; separated by
+  &lt;p&gt;A &lt;dfn id=valid5&gt;valid list of integers&lt;/dfn&gt; is a number of &lt;a
+   href=&quot;#valid1&quot; title=&quot;valid integer&quot;&gt;valid integers&lt;/a&gt; separated by
    U+002C COMMA characters, with no other characters (e.g. no &lt;a
    href=&quot;#space&quot; title=&quot;space character&quot;&gt;space characters&lt;/a&gt;). In addition,
    there might be restrictions on the number of integers that can be given,
@@ -3787,7 +3824,7 @@
 
   &lt;h5 id=specific&gt;&lt;span class=secno&gt;2.4.4.1. &lt;/span&gt;Specific moments in time&lt;/h5&gt;
 
-  &lt;p&gt;A string is a &lt;dfn id=valid5&gt;valid datetime&lt;/dfn&gt; if it has four digits
+  &lt;p&gt;A string is a &lt;dfn id=valid6&gt;valid datetime&lt;/dfn&gt; if it has four digits
    (representing the year), a literal hyphen, two digits (representing the
    month), a literal hyphen, two digits (representing the day), optionally
    some spaces, either a literal T or a space, optionally some more spaces,
@@ -3820,7 +3857,7 @@
    U+002B PLUS SIGN, and the minus U+002D (same as the hyphen).
 
   &lt;div class=example&gt;
-   &lt;p&gt;The following are some examples of dates written as &lt;a href=&quot;#valid5&quot;
+   &lt;p&gt;The following are some examples of dates written as &lt;a href=&quot;#valid6&quot;
     title=&quot;valid datetime&quot;&gt;valid datetimes&lt;/a&gt;.&lt;/p&gt;
 
    &lt;dl&gt;
@@ -3873,7 +3910,7 @@
    user agent must apply the following algorithm to the string. This will
    either return a time in UTC, with associated timezone information for
    round tripping or display purposes, or nothing, indicating the value is
-   not a &lt;a href=&quot;#valid5&quot;&gt;valid datetime&lt;/a&gt;. If at any point the algorithm
+   not a &lt;a href=&quot;#valid6&quot;&gt;valid datetime&lt;/a&gt;. If at any point the algorithm
    says that it &quot;fails&quot;, this means that it returns nothing.
 
   &lt;ol&gt;
@@ -4485,7 +4522,7 @@
 
   &lt;h4 id=time-offsets&gt;&lt;span class=secno&gt;2.4.5 &lt;/span&gt;Time offsets&lt;/h4&gt;
 
-  &lt;p class=big-issue&gt;&lt;dfn id=valid6&gt;valid time offset&lt;/dfn&gt;, &lt;dfn
+  &lt;p class=big-issue&gt;&lt;dfn id=valid7&gt;valid time offset&lt;/dfn&gt;, &lt;dfn
    id=rules4&gt;rules for parsing time offsets&lt;/dfn&gt;, &lt;dfn id=time-offset&gt;time
    offset serialization rules&lt;/dfn&gt;; in the format &quot;5d4h3m2s1ms&quot; or &quot;3m 9.2s&quot;
    or &quot;00:00:00.00&quot; or similar.
@@ -4682,7 +4719,7 @@
 
   &lt;h4 id=syntax-references&gt;&lt;span class=secno&gt;2.4.8 &lt;/span&gt;References&lt;/h4&gt;
 
-  &lt;p&gt;A &lt;dfn id=valid7&gt;valid hash-name reference&lt;/dfn&gt; to an element of type
+  &lt;p&gt;A &lt;dfn id=valid8&gt;valid hash-name reference&lt;/dfn&gt; to an element of type
    &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; is a string consisting of a U+0023 NUMBER SIGN
    (&lt;code title=&quot;&quot;&gt;#&lt;/code&gt;) character followed by a string which exactly
    matches the value of the &lt;code title=&quot;&quot;&gt;name&lt;/code&gt; attribute of an
@@ -4778,7 +4815,7 @@
    the attribute is absent, then the default value must be returned instead,
    or 0 if there is no default value. On setting, the given value must be
    converted to the shortest possible string representing the number as a &lt;a
-   href=&quot;#valid0&quot;&gt;valid integer&lt;/a&gt; in base ten and then that string must be
+   href=&quot;#valid1&quot;&gt;valid integer&lt;/a&gt; in base ten and then that string must be
    used as the new content attribute value.
 
   &lt;p&gt;If a reflecting DOM attribute is an &lt;em&gt;unsigned&lt;/em&gt; integer type
@@ -4789,7 +4826,7 @@
    hand, it fails, or if the attribute is absent, the default value must be
    returned instead, or 0 if there is no default value. On setting, the given
    value must be converted to the shortest possible string representing the
-   number as a &lt;a href=&quot;#valid&quot;&gt;valid non-negative integer&lt;/a&gt; in base ten
+   number as a &lt;a href=&quot;#valid0&quot;&gt;valid non-negative integer&lt;/a&gt; in base ten
    and then that string must be used as the new content attribute value.
 
   &lt;p&gt;If a reflecting DOM attribute is an unsigned integer type
@@ -4804,7 +4841,7 @@
    value. On setting, if the value is zero, the user agent must fire an
    &lt;code&gt;INDEX_SIZE_ERR&lt;/code&gt; exception. Otherwise, the given value must be
    converted to the shortest possible string representing the number as a &lt;a
-   href=&quot;#valid&quot;&gt;valid non-negative integer&lt;/a&gt; in base ten and then that
+   href=&quot;#valid0&quot;&gt;valid non-negative integer&lt;/a&gt; in base ten and then that
    string must be used as the new content attribute value.
 
   &lt;p&gt;If a reflecting DOM attribute is a floating point number type
@@ -4829,7 +4866,7 @@
    other hand, it fails, or if the attribute is absent, the default value
    must be returned instead, or 0.0 if there is no default value. On setting,
    the given value must be converted to the shortest possible string
-   representing the number as a &lt;a href=&quot;#valid1&quot;&gt;valid floating point
+   representing the number as a &lt;a href=&quot;#valid2&quot;&gt;valid floating point
    number&lt;/a&gt; in base ten and then that string must be used as the new
    content attribute value.
 
@@ -6160,7 +6197,7 @@
   &lt;pre class=idl&gt;interface &lt;dfn id=htmldocument&gt;HTMLDocument&lt;/dfn&gt; {
   // &lt;a href=&quot;#resource0&quot;&gt;resource metadata management&lt;/a&gt;
   [PutForwards=href] readonly attribute &lt;a href=&quot;#location2&quot;&gt;Location&lt;/a&gt; &lt;a href=&quot;#location0&quot; title=dom-document-location&gt;location&lt;/a&gt;;
-  readonly attribute DOMString &lt;a href=&quot;#url&quot; title=dom-document-URL&gt;URL&lt;/a&gt;;
+  readonly attribute DOMString &lt;a href=&quot;#url0&quot; title=dom-document-URL&gt;URL&lt;/a&gt;;
            attribute DOMString &lt;a href=&quot;#domain&quot; title=dom-document-domain&gt;domain&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=&quot;#referrer&quot; title=dom-document-referrer&gt;referrer&lt;/a&gt;;
            attribute DOMString &lt;a href=&quot;#cookie0&quot; title=dom-document-cookie&gt;cookie&lt;/a&gt;;
@@ -6229,7 +6266,7 @@
   &lt;h4 id=resource&gt;&lt;span class=secno&gt;3.2.3 &lt;/span&gt;&lt;dfn id=resource0&gt;Resource
    metadata management&lt;/dfn&gt;&lt;/h4&gt;
 
-  &lt;p&gt;The &lt;dfn id=url title=dom-document-URL&gt;&lt;code&gt;URL&lt;/code&gt;&lt;/dfn&gt; attribute
+  &lt;p&gt;The &lt;dfn id=url0 title=dom-document-URL&gt;&lt;code&gt;URL&lt;/code&gt;&lt;/dfn&gt; attribute
    must return &lt;span&gt;the document's address&lt;/span&gt;&lt;!--
   XXXDOCURL xref --&gt;.
 
@@ -8532,7 +8569,7 @@
    the first are ignored.
 
   &lt;p&gt;The &lt;dfn id=target title=attr-base-target&gt;&lt;code&gt;target&lt;/code&gt;&lt;/dfn&gt;
-   attribute, if specified, must contain a &lt;a href=&quot;#valid9&quot;&gt;valid browsing
+   attribute, if specified, must contain a &lt;a href=&quot;#valid10&quot;&gt;valid browsing
    context name or keyword&lt;/a&gt;. User agents use this name when &lt;a
    href=&quot;#following0&quot;&gt;following hyperlinks&lt;/a&gt;.
 
@@ -9405,9 +9442,9 @@
      attribute must have a value consisting either of:
 
     &lt;ul&gt;
-     &lt;li&gt; just a &lt;a href=&quot;#valid&quot;&gt;valid non-negative integer&lt;/a&gt;, or
+     &lt;li&gt; just a &lt;a href=&quot;#valid0&quot;&gt;valid non-negative integer&lt;/a&gt;, or
 
-     &lt;li&gt; a &lt;a href=&quot;#valid&quot;&gt;valid non-negative integer&lt;/a&gt;, followed by a
+     &lt;li&gt; a &lt;a href=&quot;#valid0&quot;&gt;valid non-negative integer&lt;/a&gt;, followed by a
       U+003B SEMICOLON (&lt;code title=&quot;&quot;&gt;;&lt;/code&gt;), followed by one or more &lt;a
       href=&quot;#space&quot; title=&quot;space character&quot;&gt;space characters&lt;/a&gt;, followed by
       either a U+0055 LATIN CAPITAL LETTER U or a U+0075 LATIN SMALL LETTER
@@ -11265,7 +11302,7 @@
    attribute is omitted, the list is an ascending list (1, 2, 3, ...).
 
   &lt;p&gt;The &lt;dfn id=start0 title=attr-ol-start&gt;&lt;code&gt;start&lt;/code&gt;&lt;/dfn&gt;
-   attribute, if present, must be a &lt;a href=&quot;#valid0&quot;&gt;valid integer&lt;/a&gt;
+   attribute, if present, must be a &lt;a href=&quot;#valid1&quot;&gt;valid integer&lt;/a&gt;
    giving the ordinal value of the first list item.
 
   &lt;p&gt;If the &lt;code title=attr-ol-start&gt;&lt;a href=&quot;#start0&quot;&gt;start&lt;/a&gt;&lt;/code&gt;
@@ -11450,7 +11487,7 @@
    element.
 
   &lt;p&gt;The &lt;dfn id=value title=attr-li-value&gt;&lt;code&gt;value&lt;/code&gt;&lt;/dfn&gt;
-   attribute, if present, must be a &lt;a href=&quot;#valid0&quot;&gt;valid integer&lt;/a&gt;
+   attribute, if present, must be a &lt;a href=&quot;#valid1&quot;&gt;valid integer&lt;/a&gt;
    giving the ordinal value of the list item.
 
   &lt;p&gt;If the &lt;code title=attr-li-value&gt;&lt;a href=&quot;#value&quot;&gt;value&lt;/a&gt;&lt;/code&gt;
@@ -12907,7 +12944,7 @@
   &lt;p&gt;&lt;strong&gt;Author requirements&lt;/strong&gt;: The &lt;code
    title=attr-progress-max&gt;&lt;a href=&quot;#max&quot;&gt;max&lt;/a&gt;&lt;/code&gt; and &lt;code
    title=attr-progress-value&gt;&lt;a href=&quot;#value1&quot;&gt;value&lt;/a&gt;&lt;/code&gt; attributes,
-   when present, must have values that are &lt;a href=&quot;#valid1&quot; title=&quot;valid
+   when present, must have values that are &lt;a href=&quot;#valid2&quot; title=&quot;valid
    floating point number&quot;&gt;valid floating point numbers&lt;/a&gt;. The &lt;code
    title=attr-progress-max&gt;&lt;a href=&quot;#max&quot;&gt;max&lt;/a&gt;&lt;/code&gt; attribute, if
    present, must have a value greater than zero. The &lt;code
@@ -13122,7 +13159,7 @@
    title=attr-meter-max&gt;&lt;a href=&quot;#max1&quot;&gt;max&lt;/a&gt;&lt;/code&gt;, and &lt;code
    title=attr-meter-optimum&gt;&lt;a href=&quot;#optimum&quot;&gt;optimum&lt;/a&gt;&lt;/code&gt; attributes
    are all optional. When present, they must have values that are &lt;a
-   href=&quot;#valid1&quot; title=&quot;valid floating point number&quot;&gt;valid floating point
+   href=&quot;#valid2&quot; title=&quot;valid floating point number&quot;&gt;valid floating point
    numbers&lt;/a&gt;, and their values must satisfy the following inequalities:
 
   &lt;ul class=brief&gt;
@@ -14385,14 +14422,14 @@
 
   &lt;p&gt;If present, the &lt;code title=attr-mod-datetime&gt;&lt;a
    href=&quot;#datetime1&quot;&gt;datetime&lt;/a&gt;&lt;/code&gt; attribute must be a &lt;a
-   href=&quot;#valid5&quot;&gt;valid datetime&lt;/a&gt; value.
+   href=&quot;#valid6&quot;&gt;valid datetime&lt;/a&gt; value.
 
   &lt;p&gt;User agents must parse the &lt;code title=attr-mod-datetime&gt;&lt;a
    href=&quot;#datetime1&quot;&gt;datetime&lt;/a&gt;&lt;/code&gt; attribute according to the &lt;a
    href=&quot;#datetime-parser&quot;&gt;parse a string as a datetime value&lt;/a&gt; algorithm.
    If that doesn't return a time, then the modification has no associated
    timestamp (the value is non-conforming; it is not a &lt;a
-   href=&quot;#valid5&quot;&gt;valid datetime&lt;/a&gt;). Otherwise, the modification is marked
+   href=&quot;#valid6&quot;&gt;valid datetime&lt;/a&gt;). Otherwise, the modification is marked
    as having been made at the given datetime. User agents should use the
    associated timezone information to determine which timezone to present the
    given datetime in.
@@ -15405,7 +15442,7 @@
    will remain at the initial &lt;code&gt;about:blank&lt;/code&gt;&lt;!-- XXX xref --&gt; page.
 
   &lt;p&gt;The &lt;dfn id=name1 title=attr-iframe-name&gt;&lt;code&gt;name&lt;/code&gt;&lt;/dfn&gt;
-   attribute, if present, must be a &lt;a href=&quot;#valid8&quot;&gt;valid browsing context
+   attribute, if present, must be a &lt;a href=&quot;#valid9&quot;&gt;valid browsing context
    name&lt;/a&gt;. When the browsing context is created, if the attribute is
    present, the &lt;a href=&quot;#browsing2&quot;&gt;browsing context name&lt;/a&gt; must be set to
    the value of this attribute; otherwise, the &lt;a href=&quot;#browsing2&quot;&gt;browsing
@@ -15964,7 +16001,7 @@
    href=&quot;#type6&quot;&gt;type&lt;/a&gt;&lt;/code&gt; attributes must be present.
 
   &lt;p&gt;The &lt;dfn id=name3 title=attr-object-name&gt;&lt;code&gt;name&lt;/code&gt;&lt;/dfn&gt;
-   attribute, if present, must be a &lt;a href=&quot;#valid8&quot;&gt;valid browsing context
+   attribute, if present, must be a &lt;a href=&quot;#valid9&quot;&gt;valid browsing context
    name&lt;/a&gt;.
 
   &lt;p&gt;When the element is created, and subsequently whenever the &lt;code
@@ -16909,7 +16946,7 @@
    allows the author to specify the pixel ratio of anamorphic &lt;a
    href=&quot;#media10&quot; title=&quot;media resource&quot;&gt;media resources&lt;/a&gt; that do not
    self-describe their pixel ratio. The attribute value, if specified, must
-   be a &lt;a href=&quot;#valid1&quot;&gt;valid floating point number&lt;/a&gt; giving the ratio of
+   be a &lt;a href=&quot;#valid2&quot;&gt;valid floating point number&lt;/a&gt; giving the ratio of
    the correct rendered width of each pixel to the actual width of each pixel
    in the image (i.e., the multiple by which the video's intrinsic width is
    to be multiplied to obtain the rendered width that gives the correct
@@ -19295,7 +19332,7 @@
    to control the size of the coordinate space: &lt;dfn id=width0
    title=attr-canvas-width&gt;&lt;code&gt;width&lt;/code&gt;&lt;/dfn&gt; and &lt;dfn id=height0
    title=attr-canvas-height&gt;&lt;code&gt;height&lt;/code&gt;&lt;/dfn&gt;. These attributes, when
-   specified, must have values that are &lt;a href=&quot;#valid&quot; title=&quot;valid
+   specified, must have values that are &lt;a href=&quot;#valid0&quot; title=&quot;valid
    non-negative integer&quot;&gt;valid non-negative integers&lt;/a&gt;. The &lt;a
    href=&quot;#rules&quot;&gt;rules for parsing non-negative integers&lt;/a&gt; must be used to
    obtain their numeric values. If an attribute is missing, or if parsing its
@@ -20722,9 +20759,8 @@
    href=&quot;#globalcompositeoperation&quot;
    title=dom-context-2d-globalCompositeOperation&gt;global composition
    operators&lt;/a&gt;. (Transformations affect the path when the path is created,
-   not when it is painted, though the stroke &lt;em&gt;&lt;a
-   href=&quot;#style1&quot;&gt;style&lt;/a&gt;&lt;/em&gt; is still affected by the transformation
-   during painting.)
+   not when it is painted, though the stroke &lt;em title=&quot;&quot;&gt;style&lt;/em&gt; is still
+   affected by the transformation during painting.)
 
   &lt;p&gt;Zero-length line segments must be pruned before stroking a path. Empty
    subpaths must be ignored.
@@ -22060,7 +22096,7 @@
    href=&quot;#rectangle&quot; title=attr-area-shape-rect&gt;rectangle&lt;/a&gt; state.
 
   &lt;p&gt;The &lt;dfn id=coords title=attr-area-coords&gt;&lt;code&gt;coords&lt;/code&gt;&lt;/dfn&gt;
-   attribute must, if specified, contain a &lt;a href=&quot;#valid4&quot;&gt;valid list of
+   attribute must, if specified, contain a &lt;a href=&quot;#valid5&quot;&gt;valid list of
    integers&lt;/a&gt;. This attribute gives the coordinates for the shape described
    by the &lt;code title=attr-area-shape&gt;&lt;a href=&quot;#shape&quot;&gt;shape&lt;/a&gt;&lt;/code&gt;
    attribute. The processing for this attribute is described as part of the
@@ -22190,7 +22226,7 @@
    &lt;code&gt;&lt;a href=&quot;#img&quot;&gt;img&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a
    href=&quot;#object&quot;&gt;object&lt;/a&gt;&lt;/code&gt; element. The &lt;code
    title=attr-area-usemap&gt;usemap&lt;/code&gt; attribute, if specified, must be a &lt;a
-   href=&quot;#valid7&quot;&gt;valid hash-name reference&lt;/a&gt; to a &lt;code&gt;&lt;a
+   href=&quot;#valid8&quot;&gt;valid hash-name reference&lt;/a&gt; to a &lt;code&gt;&lt;a
    href=&quot;#map&quot;&gt;map&lt;/a&gt;&lt;/code&gt; element.
 
   &lt;p&gt;If an &lt;code&gt;&lt;a href=&quot;#img&quot;&gt;img&lt;/a&gt;&lt;/code&gt; element or an &lt;code&gt;&lt;a
@@ -22512,7 +22548,7 @@
    give the dimensions of the visual content of the element (the width and
    height respectively, relative to the nominal direction of the output
    medium), in CSS pixels. The attributes, if specified, must have values
-   that are &lt;a href=&quot;#valid3&quot;&gt;valid positive non-zero integers&lt;/a&gt;.
+   that are &lt;a href=&quot;#valid4&quot;&gt;valid positive non-zero integers&lt;/a&gt;.
 
   &lt;p&gt;The specified dimensions given may differ from the dimensions specified
    in the resource itself, since the resource may have a resolution that
@@ -22925,7 +22961,7 @@
   &lt;p&gt;If the &lt;code&gt;&lt;a href=&quot;#colgroup&quot;&gt;colgroup&lt;/a&gt;&lt;/code&gt; element contains no
    &lt;code&gt;&lt;a href=&quot;#col&quot;&gt;col&lt;/a&gt;&lt;/code&gt; elements, then the element may have a
    &lt;dfn id=span0 title=attr-colgroup-span&gt;&lt;code&gt;span&lt;/code&gt;&lt;/dfn&gt; content
-   attribute specified, whose value must be a &lt;a href=&quot;#valid&quot;&gt;valid
+   attribute specified, whose value must be a &lt;a href=&quot;#valid0&quot;&gt;valid
    non-negative integer&lt;/a&gt; greater than zero.
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#colgroup&quot;&gt;colgroup&lt;/a&gt;&lt;/code&gt; element and its &lt;code
@@ -22979,7 +23015,7 @@
 
   &lt;p&gt;The element may have a &lt;dfn id=span2
    title=attr-col-span&gt;&lt;code&gt;span&lt;/code&gt;&lt;/dfn&gt; content attribute specified,
-   whose value must be a &lt;a href=&quot;#valid&quot;&gt;valid non-negative integer&lt;/a&gt;
+   whose value must be a &lt;a href=&quot;#valid0&quot;&gt;valid non-negative integer&lt;/a&gt;
    greater than zero.
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#col&quot;&gt;col&lt;/a&gt;&lt;/code&gt; element and its &lt;code
@@ -23452,13 +23488,13 @@
   &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a
    href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt; elements may have a &lt;dfn id=colspan
    title=attr-tdth-colspan&gt;&lt;code&gt;colspan&lt;/code&gt;&lt;/dfn&gt; content attribute
-   specified, whose value must be a &lt;a href=&quot;#valid&quot;&gt;valid non-negative
+   specified, whose value must be a &lt;a href=&quot;#valid0&quot;&gt;valid non-negative
    integer&lt;/a&gt; greater than zero.
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a
    href=&quot;#th&quot;&gt;th&lt;/a&gt;&lt;/code&gt; elements may also have a &lt;dfn id=rowspan
    title=attr-tdth-rowspan&gt;&lt;code&gt;rowspan&lt;/code&gt;&lt;/dfn&gt; content attribute
-   specified, whose value must be a &lt;a href=&quot;#valid&quot;&gt;valid non-negative
+   specified, whose value must be a &lt;a href=&quot;#valid0&quot;&gt;valid non-negative
    integer&lt;/a&gt;.
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=&quot;#td&quot;&gt;td&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a
@@ -24898,7 +24934,7 @@
          agents must use all the child nodes of the &lt;code&gt;&lt;a
          href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt; element as the script to execute.&lt;/p&gt;
       &lt;/dl&gt;
-
+      &lt;!-- SCRIPT EXEC --&gt;
       &lt;p&gt;In any case, the user agent must execute the script according to the
        semantics defined by the language associated with &lt;var&gt;&lt;a
        href=&quot;#the-scripts&quot;&gt;the script's type&lt;/a&gt;&lt;/var&gt; (see the &lt;a
@@ -24908,6 +24944,10 @@
        must be the &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object of that
        &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;.&lt;/p&gt;
 
+      &lt;p&gt;The &lt;a href=&quot;#script4&quot;&gt;script document context&lt;/a&gt; of the script
+       must be the &lt;code&gt;Document&lt;/code&gt; object that owns the &lt;code&gt;&lt;a
+       href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt; element.&lt;/p&gt;
+
       &lt;p class=note&gt;The element's attributes' values might have changed
        between when the element was inserted into the document and when the
        script has finished loading, as may its other attributes; similarly,
@@ -29687,12 +29727,12 @@
    name&lt;/dfn&gt;. By default, a browsing context has no name (its name is not
    set).
 
-  &lt;p&gt;A &lt;dfn id=valid8&gt;valid browsing context name&lt;/dfn&gt; is any string with at
+  &lt;p&gt;A &lt;dfn id=valid9&gt;valid browsing context name&lt;/dfn&gt; is any string with at
    least one character that does not start with a U+005F LOW LINE character.
    (Names starting with an underscore are reserved for special keywords.)
 
-  &lt;p&gt;A &lt;dfn id=valid9&gt;valid browsing context name or keyword&lt;/dfn&gt; is any
-   string that is either a &lt;a href=&quot;#valid8&quot;&gt;valid browsing context name&lt;/a&gt;
+  &lt;p&gt;A &lt;dfn id=valid10&gt;valid browsing context name or keyword&lt;/dfn&gt; is any
+   string that is either a &lt;a href=&quot;#valid9&quot;&gt;valid browsing context name&lt;/a&gt;
    or that case-insensitively &lt;!-- ASCII --&gt; matches one of: &lt;code
    title=&quot;&quot;&gt;_blank&lt;/code&gt;, &lt;code title=&quot;&quot;&gt;_self&lt;/code&gt;, &lt;code
    title=&quot;&quot;&gt;_parent&lt;/code&gt;, or &lt;code title=&quot;&quot;&gt;_top&lt;/code&gt;.
@@ -29992,7 +30032,7 @@
 
   &lt;p&gt;The second argument, &lt;var title=&quot;&quot;&gt;target&lt;/var&gt;, specifies the &lt;a
    href=&quot;#browsing2&quot; title=&quot;browsing context name&quot;&gt;name&lt;/a&gt; of the browsing
-   context that is to be navigated. It must be a &lt;a href=&quot;#valid9&quot;&gt;valid
+   context that is to be navigated. It must be a &lt;a href=&quot;#valid10&quot;&gt;valid
    browsing context name or keyword&lt;/a&gt;. If fewer than two arguments are
    provided, then the &lt;var title=&quot;&quot;&gt;name&lt;/var&gt; argument defaults to the value
    &quot;&lt;code&gt;_blank&lt;/code&gt;&quot;.
@@ -30035,16 +30075,9 @@
    href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; was just created as part of the &lt;a
    href=&quot;#the-rules&quot;&gt;the rules for choosing a browsing context given a
    browsing context name&lt;/a&gt;. The navigation must be done with the &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; corresponding to the &lt;code&gt;&lt;a
-   href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object that is the &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the script that invoked
-   the method as the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;.
+   href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; of the script that invoked the
+   method as the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;.
 
-  &lt;p class=note&gt;If the &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of a
-   script isn't a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object, then it
-   can't ever get to a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object to
-   call this method.
-
   &lt;p&gt;The method must return the &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt;
    object of the default view of the &lt;a href=&quot;#browsing1&quot;&gt;browsing
    context&lt;/a&gt; that was navigated, or null if no browsing context was
@@ -30174,6 +30207,12 @@
      &lt;dd&gt;The owner is the &lt;code&gt;Document&lt;/code&gt; to which the &lt;code&gt;&lt;a
       href=&quot;#script1&quot;&gt;script&lt;/a&gt;&lt;/code&gt; element belongs.
 
+     &lt;dt&gt;If a script is in an &lt;a href=&quot;#event3&quot; title=&quot;event handler content
+      attributes&quot;&gt;event handler content attribute&lt;/a&gt;
+
+     &lt;dd&gt;The owner is the &lt;code&gt;Document&lt;/code&gt; to which the attribute node
+      belongs.
+
      &lt;dt&gt;If a script is a function or other code reference created by another
       script
 
@@ -30508,20 +30547,35 @@
     scripting features.
   &lt;/ul&gt;
 
+  &lt;p&gt;When a script is created&lt;!-- which is marked by SCRIPT EXEC in
+  this spec --&gt;,
+   it is associated with a &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt;, a
+   &lt;a href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt;, and a &lt;a
+   href=&quot;#script4&quot;&gt;script document context&lt;/a&gt;.&lt;/p&gt;
+  &lt;!-- SCRIPT EXEC --&gt;
+
   &lt;h4 id=script0&gt;&lt;span class=secno&gt;5.4.1 &lt;/span&gt;Script execution contexts&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn id=script2&gt;script execution context&lt;/dfn&gt; of a script is
-   defined when that script is created. It is typically a &lt;code&gt;&lt;a
-   href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object.
+   defined when that script is created. It is either a &lt;code&gt;&lt;a
+   href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object or an empty object.
 
+  &lt;p&gt;When the &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of a script is
+   an empty object, it can't do anything that interacts with the environment.
+
+  &lt;hr&gt;
+
   &lt;p&gt;A &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; always has an
-   associated &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;. If the &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; is a &lt;code&gt;&lt;a
-   href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object, then that object's &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; is it. Otherwise, the &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; is associated explicitly with
-   a &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; when it is created.
+   associated &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;, known as the &lt;dfn
+   id=script3&gt;script browsing context&lt;/dfn&gt;. If the &lt;a href=&quot;#script2&quot;&gt;script
+   execution context&lt;/a&gt; is a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt;
+   object, then that object's &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; is
+   it. Otherwise, the &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; is
+   associated explicitly with a &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;
+   when it is created.
 
+  &lt;hr&gt;
+
   &lt;p&gt;It is said that &lt;dfn id=scripting1&gt;scripting is disabled&lt;/dfn&gt; in a &lt;a
    href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; when any of the following
    conditions are true:
@@ -30548,8 +30602,8 @@
   &lt;/ul&gt;
 
   &lt;p&gt;A node is said to be &lt;dfn id=without&gt;without script&lt;/dfn&gt; if either the
-   &lt;code&gt;Document&lt;/code&gt; object of the node (the node itself, it is itself a
-   &lt;code&gt;Document&lt;/code&gt; object) does not have an associated &lt;a
+   &lt;code&gt;Document&lt;/code&gt; object of the node (the node itself, if it is itself
+   a &lt;code&gt;Document&lt;/code&gt; object) does not have an associated &lt;a
    href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;, or &lt;a href=&quot;#scripting1&quot;&gt;scripting
    is disabled&lt;/a&gt; in that &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;.
 
@@ -30569,9 +30623,19 @@
    will disable any event handler attributes, event listeners, timeouts, etc,
    that were set by scripts in the document.
 
+  &lt;hr&gt;
+
+  &lt;p&gt;Every script whose &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; is a
+   &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object is also associated with a
+   &lt;code&gt;Document&lt;/code&gt; object, known as its &lt;dfn id=script4&gt;script document
+   context&lt;/dfn&gt;. It is used to resolve URLs. The document is assigned when
+   the script is created, as with the &lt;a href=&quot;#script3&quot;&gt;script browsing
+   context&lt;/a&gt;.
+
   &lt;h4 id=security4&gt;&lt;span class=secno&gt;5.4.2 &lt;/span&gt;Security exceptions&lt;/h4&gt;
 
-  &lt;p class=big-issue&gt;Define &lt;dfn id=security9&gt;security exception&lt;/dfn&gt;.
+  &lt;p class=big-issue&gt;Define &lt;dfn id=security9&gt;security exception&lt;/dfn&gt;.&lt;/p&gt;
+  &lt;!-- SCRIPT EXEC --&gt;
 
   &lt;h4 id=javascript-protocol&gt;&lt;span class=secno&gt;5.4.3 &lt;/span&gt;&lt;dfn
    id=the-javascript title=&quot;javascript protocol&quot;&gt;The &lt;code
@@ -30597,7 +30661,9 @@
    href=&quot;#same-origin&quot;&gt;same origin&lt;/a&gt; as the script given by that URI, the
    &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; must be the &lt;code&gt;&lt;a
    href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object of the &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; being navigated.&lt;/p&gt;
+   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; being navigated, and the &lt;a
+   href=&quot;#script4&quot;&gt;script document context&lt;/a&gt; must be that &lt;a
+   href=&quot;#active&quot;&gt;active document&lt;/a&gt;.&lt;/p&gt;
   &lt;!-- XXXURL JSURL issue --&gt;
 
   &lt;p&gt;When a browsing context is &lt;a href=&quot;#navigate&quot;
@@ -30606,8 +30672,7 @@
    href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; that is &lt;em&gt;not&lt;/em&gt; the &lt;a href=&quot;#same-origin&quot;
    title=&quot;same origin&quot;&gt;same&lt;/a&gt; as that of the script given by the URI, the
    &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; must be an empty object,
-   and the &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt;'s associated &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; must be the &lt;a
+   and the &lt;a href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; must be the &lt;a
    href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; being &lt;a href=&quot;#navigate&quot;
    title=navigate&gt;navigated&lt;/a&gt;.&lt;/p&gt;
   &lt;!-- XXXURL JSURL issue --&gt;
@@ -30697,7 +30762,8 @@
   &lt;p&gt;&lt;dfn id=event3&gt;Event handler content attributes&lt;/dfn&gt;, when specified,
    must contain valid ECMAScript code matching the ECMAScript &lt;code
    title=&quot;&quot;&gt;FunctionBody&lt;/code&gt; production. &lt;a
-   href=&quot;#refsECMA262&quot;&gt;[ECMA262]&lt;/a&gt;
+   href=&quot;#refsECMA262&quot;&gt;[ECMA262]&lt;/a&gt;&lt;/p&gt;
+  &lt;!-- SCRIPT EXEC --&gt;
 
   &lt;p&gt;When an event handler content attribute is set, its new value must be
    interpreted as the body of an anonymous function with a single argument
@@ -30720,7 +30786,9 @@
 
   &lt;p&gt;The &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the event handler
    must be the &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object at the end of
-   the scope chain.
+   the scope chain. The &lt;a href=&quot;#script4&quot;&gt;script document context&lt;/a&gt; of the
+   event handler must be the &lt;code&gt;Document&lt;/code&gt; object that owns the event
+   handler content attribute that was set.
 
   &lt;p class=big-issue&gt;How do we allow non-JS event handlers?
 
@@ -31402,16 +31470,10 @@
    &lt;li&gt;
     &lt;p&gt;&lt;a href=&quot;#navigate&quot;&gt;Navigate&lt;/a&gt; the new browsing context to &lt;var
      title=&quot;&quot;&gt;url&lt;/var&gt;, with &lt;a href=&quot;#replacement&quot;&gt;replacement enabled&lt;/a&gt;,
-     and with the &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; of the &lt;code&gt;&lt;a
-     href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object that is the &lt;a
-     href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the script that invoked
-     the method as the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;.&lt;/p&gt;
+     and with the &lt;a href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; of the
+     script that invoked the method as the &lt;a href=&quot;#source0&quot;&gt;source browsing
+     context&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p class=note&gt;If the &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of a
-     script isn't a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object, then it
-     can't ever get to a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object to
-     call this method.&lt;/p&gt;
-
    &lt;li&gt;
     &lt;p&gt;Wait for the browsing context to be closed. (The user agent must allow
      the user to indicate that the browsing context is to be closed.)&lt;/p&gt;
@@ -31505,22 +31567,19 @@
    method, when invoked, must cause the user agent to show a notification.
 
   &lt;p id=sandboxNotifications&gt;If the method was invoked from a script whose &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt;'s associated &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; has the &lt;a
+   href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; has the &lt;a
    href=&quot;#sandboxed1&quot;&gt;sandboxed annoyances browsing context flag&lt;/a&gt; set,
    then the notification must be shown within that &lt;a
    href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;. The notification is said to be a
    &lt;dfn id=sandboxed5&gt;sandboxed notification&lt;/dfn&gt;.
 
   &lt;p&gt;Otherwise, if the &lt;a href=&quot;#origin0&quot;&gt;origin&lt;/a&gt; of the &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; associated with the &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the script that invoked
-   the method is &lt;em&gt;not&lt;/em&gt; flagged as being a &lt;a href=&quot;#trusted&quot;&gt;trusted
+   href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; of the script that invoked the
+   method is &lt;em&gt;not&lt;/em&gt; flagged as being a &lt;a href=&quot;#trusted&quot;&gt;trusted
    notification source&lt;/a&gt;, then the notification should be rendered within
    the &lt;a href=&quot;#top-level&quot;&gt;top-level browsing context&lt;/a&gt; of the &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; associated with the &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the script that invoked
-   the method. The notification is said to be a &lt;dfn id=normal&gt;normal
+   href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; of the script that invoked the
+   method. The notification is said to be a &lt;dfn id=normal&gt;normal
    notification&lt;/dfn&gt;. User agents should provide a way to set the origin's
    &lt;a href=&quot;#trusted&quot;&gt;trusted notification source&lt;/a&gt; flag from the
    notification, so that the user can benefit from notifications even when
@@ -31564,16 +31623,14 @@
   &lt;p&gt;When a &lt;a href=&quot;#normal&quot;&gt;normal notification&lt;/a&gt; (but not a &lt;a
    href=&quot;#sandboxed5&quot;&gt;sandboxed notification&lt;/a&gt;) is shown, the user agent
    may bring the user's attention to the &lt;a href=&quot;#top-level&quot;&gt;top-level
-   browsing context&lt;/a&gt; of the &lt;a href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt;
-   associated with the &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the
-   script that invoked the method, if that would be useful; but user agents
-   should not use system-wide notification mechanisms to do so.
+   browsing context&lt;/a&gt; of the &lt;a href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt;
+   of the script that invoked the method, if that would be useful; but user
+   agents should not use system-wide notification mechanisms to do so.
 
   &lt;p&gt;When a &lt;a href=&quot;#trusted0&quot;&gt;trusted notification&lt;/a&gt; is shown, the user
    agent should bring the user's attention to the notification and the &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; associated with the &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the script that invoked
-   the method, as per the platform conventions for attracting the user's
+   href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; of the script that invoked the
+   method, as per the platform conventions for attracting the user's
    attention to applications.
 
   &lt;div class=example&gt;
@@ -31599,8 +31656,7 @@
     title=meta-application-name&gt;application name&lt;/a&gt;, if available, or else
     the &lt;a href=&quot;#document.title&quot; title=dom-document-title&gt;document
     title&lt;/a&gt;, of the &lt;a href=&quot;#active&quot;&gt;active document&lt;/a&gt; of the &lt;a
-    href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; associated with the &lt;a
-    href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the script that invoked
+    href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; of the script that invoked
     the method.
 
    &lt;li&gt;An icon chosen from the &lt;a href=&quot;#links1&quot; title=&quot;external resource
@@ -31640,8 +31696,7 @@
   &lt;p&gt;User agents should support user interaction with notifications, if and
    as appropriate given the platform conventions. If a user activates a
    notification, and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; callback argument was
-   present and is not null, then the &lt;a href=&quot;#browsing1&quot;&gt;browsing
-   context&lt;/a&gt; associated with the &lt;a href=&quot;#script2&quot;&gt;script execution
+   present and is not null, then the &lt;a href=&quot;#script3&quot;&gt;script browsing
    context&lt;/a&gt; of the function given by &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; should be
    brought to the user's attention, and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt;
    callback should then be invoked.
@@ -33907,15 +33962,8 @@
   &lt;p&gt;Navigation for the &lt;code title=dom-location-assign&gt;&lt;a
    href=&quot;#assign&quot;&gt;assign()&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-location-replace&gt;&lt;a
    href=&quot;#replace&quot;&gt;replace()&lt;/a&gt;&lt;/code&gt; methods must be done with the &lt;a
-   href=&quot;#browsing1&quot;&gt;browsing context&lt;/a&gt; of the &lt;code&gt;&lt;a
-   href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object that is the &lt;a
-   href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of the script that invoked
-   the method as the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;.
-
-  &lt;p class=note&gt;If the &lt;a href=&quot;#script2&quot;&gt;script execution context&lt;/a&gt; of a
-   script isn't a &lt;code&gt;&lt;a href=&quot;#window&quot;&gt;Window&lt;/a&gt;&lt;/code&gt; object, then it
-   can't ever get to a &lt;code&gt;&lt;a href=&quot;#location2&quot;&gt;Location&lt;/a&gt;&lt;/code&gt; object
-   to call these methods.&lt;/p&gt;
+   href=&quot;#script3&quot;&gt;script browsing context&lt;/a&gt; of the script that invoked the
+   method as the &lt;a href=&quot;#source0&quot;&gt;source browsing context&lt;/a&gt;.&lt;/p&gt;
   &lt;!-- XXXURL algorithms --&gt;
 
   &lt;p&gt;Relative &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; arguments for &lt;code
@@ -35996,7 +36044,7 @@
 
   &lt;p&gt;The &lt;dfn id=target3
    title=attr-hyperlink-target&gt;&lt;code&gt;target&lt;/code&gt;&lt;/dfn&gt; attribute, if
-   present, must be a &lt;a href=&quot;#valid9&quot;&gt;valid browsing context name or
+   present, must be a &lt;a href=&quot;#valid10&quot;&gt;valid browsing context name or
    keyword&lt;/a&gt;. User agents use this name when &lt;a
    href=&quot;#following0&quot;&gt;following hyperlinks&lt;/a&gt;.&lt;/p&gt;
   &lt;!-- XXXURL change to URL --&gt;
@@ -36853,7 +36901,7 @@
    href=&quot;#unordered&quot;&gt;unordered set of unique space-separated tokens&lt;/a&gt;. The
    values must all be either &lt;code title=attr-link-sizes-any&gt;&lt;a
    href=&quot;#any&quot;&gt;any&lt;/a&gt;&lt;/code&gt; or a value that consists of two &lt;a
-   href=&quot;#valid&quot; title=&quot;valid non-negative integer&quot;&gt;valid non-negative
+   href=&quot;#valid0&quot; title=&quot;valid non-negative integer&quot;&gt;valid non-negative
    integers&lt;/a&gt; that do not have a leading U+0030 DIGIT ZERO (0) character
    and that are separated by a single U+0078 LATIN SMALL LETTER X character.
 
@@ -37628,7 +37676,7 @@
 
   &lt;p&gt;The &lt;code title=attr-tabindex&gt;&lt;a href=&quot;#tabindex&quot;&gt;tabindex&lt;/a&gt;&lt;/code&gt;
    attribute, if specified, must have a value that is a &lt;a
-   href=&quot;#valid0&quot;&gt;valid integer&lt;/a&gt;.
+   href=&quot;#valid1&quot;&gt;valid integer&lt;/a&gt;.
 
   &lt;p&gt;If the attribute is specified, it must be parsed using the &lt;a
    href=&quot;#rules0&quot;&gt;rules for parsing integers&lt;/a&gt;. The attribute's values have

Modified: source
===================================================================
--- source	2008-06-19 09:27:25 UTC (rev 1790)
+++ source	2008-06-24 00:21:03 UTC (rev 1791)
@@ -945,6 +945,39 @@
 
   &lt;h3&gt;URLs&lt;/h3&gt;&lt;!-- XXXURL --&gt;
 
+  &lt;p class=&quot;big-issue&quot;&gt;The text in this section is not yet integrated
+  with the rest of the specification.&lt;/p&gt;
+
+  &lt;h4&gt;Terminology&lt;/h4&gt;
+
+  &lt;p&gt;A &lt;dfn&gt;URL&lt;/dfn&gt; is a string used to identify a resource. A
+  &lt;span&gt;URL&lt;/span&gt; is always associated with a &lt;code&gt;Document&lt;/code&gt;,
+  either explicitly when the URL is created or defined; or through a
+  DOM node, in which case the associated &lt;code&gt;Document&lt;/code&gt; is the
+  node's &lt;code&gt;Document&lt;/code&gt;; or through a script, in which case the
+  associated &lt;code&gt;Document&lt;/code&gt; is the script's &lt;span&gt;script
+  document context&lt;/span&gt;.&lt;/p&gt;
+
+  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is a &lt;dfn&gt;valid URL&lt;/dfn&gt; if at least one of
+  the following conditions holds:&lt;/p&gt;
+
+  &lt;ul&gt;
+
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid URI.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid IRI and it has no query
+   component.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid IRI and its query component
+   contains no unescaped non-ASCII characters.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid IRI and the &lt;span
+   title=&quot;document's character encoding&quot;&gt;character encoding&lt;/span&gt; of
+   the URL's &lt;code&gt;Document&lt;/code&gt; is UTF-8.&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ul&gt;
+
+
   &lt;div class=&quot;big-issue&quot;&gt;
 
    &lt;p&gt;This section will do the following:&lt;/p&gt;
@@ -18203,8 +18236,9 @@
   title=&quot;clipping region&quot;&gt;clipping region&lt;/span&gt;, and &lt;span
   title=&quot;dom-context-2d-globalCompositeOperation&quot;&gt;global composition
   operators&lt;/span&gt;. (Transformations affect the path when the path is
-  created, not when it is painted, though the stroke &lt;em&gt;style&lt;/em&gt; is
-  still affected by the transformation during painting.)&lt;/p&gt;
+  created, not when it is painted, though the stroke &lt;em
+  title=&quot;&quot;&gt;style&lt;/em&gt; is still affected by the transformation during
+  painting.)&lt;/p&gt;
 
   &lt;p&gt;Zero-length line segments must be pruned before stroking a
   path. Empty subpaths must be ignored.&lt;/p&gt;
@@ -22584,6 +22618,7 @@
 
       &lt;/dl&gt;
 
+      &lt;!-- SCRIPT EXEC --&gt;
       &lt;p&gt;In any case, the user agent must execute the script according to
       the semantics defined by the language associated with &lt;var&gt;the
       script's type&lt;/var&gt; (see the &lt;a href=&quot;#scriptingLanguages&quot;&gt;scripting
@@ -22593,6 +22628,10 @@
       be the &lt;code&gt;Window&lt;/code&gt; object of that &lt;span&gt;browsing
       context&lt;/span&gt;.&lt;/p&gt;
 
+      &lt;p&gt;The &lt;span&gt;script document context&lt;/span&gt; of the script must
+      be the &lt;code&gt;Document&lt;/code&gt; object that owns the
+      &lt;code&gt;script&lt;/code&gt; element.&lt;/p&gt;
+
       &lt;p class=&quot;note&quot;&gt;The element's attributes' values might have changed
       between when the element was inserted into the document and when the
       script has finished loading, as may its other attributes; similarly,
@@ -27526,15 +27565,9 @@
   &lt;span&gt;browsing context&lt;/span&gt; was just created as part of the
   &lt;span&gt;the rules for choosing a browsing context given a browsing
   context name&lt;/span&gt;. The navigation must be done with the
-  &lt;span&gt;browsing context&lt;/span&gt; corresponding to the
-  &lt;code&gt;Window&lt;/code&gt; object that is the &lt;span&gt;script execution
-  context&lt;/span&gt; of the script that invoked the method as the
-  &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
+  &lt;span&gt;script browsing context&lt;/span&gt; of the script that invoked the
+  method as the &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p class=&quot;note&quot;&gt;If the &lt;span&gt;script execution context&lt;/span&gt; of a
-  script isn't a &lt;code&gt;Window&lt;/code&gt; object, then it can't ever get to
-  a &lt;code&gt;Window&lt;/code&gt; object to call this method.&lt;/p&gt;
-
   &lt;p&gt;The method must return the &lt;code&gt;Window&lt;/code&gt; object of the
   default view of the &lt;span&gt;browsing context&lt;/span&gt; that was
   navigated, or null if no browsing context was navigated.&lt;/p&gt;
@@ -27665,6 +27698,12 @@
      &lt;code&gt;script&lt;/code&gt; element belongs.&lt;/dd&gt;
 
 
+     &lt;dt&gt;If a script is in an &lt;span title=&quot;event handler content attributes&quot;&gt;event handler content attribute&lt;/span&gt;&lt;/dt&gt;
+
+     &lt;dd&gt;The owner is the &lt;code&gt;Document&lt;/code&gt; to which the
+     attribute node belongs.&lt;/dd&gt;
+
+
      &lt;dt&gt;If a script is a function or other code reference created by
      another script&lt;/dt&gt;
 
@@ -28057,21 +28096,36 @@
 
   &lt;/ul&gt;
 
+  &lt;p&gt;When a script is created&lt;!-- which is marked by SCRIPT EXEC in
+  this spec --&gt;, it is associated with a &lt;span&gt;script execution
+  context&lt;/span&gt;, a &lt;span&gt;script browsing context&lt;/span&gt;, and a
+  &lt;span&gt;script document context&lt;/span&gt;.&lt;/p&gt;
 
 
+
+  &lt;!-- SCRIPT EXEC --&gt;
   &lt;h4&gt;Script execution contexts&lt;/h4&gt;
 
   &lt;p&gt;The &lt;dfn&gt;script execution context&lt;/dfn&gt; of a script is defined
-  when that script is created. It is typically a &lt;code&gt;Window&lt;/code&gt;
-  object.&lt;/p&gt;
+  when that script is created. It is either a &lt;code&gt;Window&lt;/code&gt;
+  object or an empty object.&lt;/p&gt;
 
+  &lt;p&gt;When the &lt;span&gt;script execution context&lt;/span&gt; of a script is an
+  empty object, it can't do anything that interacts with the
+  environment.&lt;/p&gt;
+
+  &lt;hr&gt;
+
   &lt;p&gt;A &lt;span&gt;script execution context&lt;/span&gt; always has an associated
-  &lt;span&gt;browsing context&lt;/span&gt;. If the &lt;span&gt;script execution
-  context&lt;/span&gt; is a &lt;code&gt;Window&lt;/code&gt; object, then that object's
-  &lt;span&gt;browsing context&lt;/span&gt; is it. Otherwise, the &lt;span&gt;script
-  execution context&lt;/span&gt; is associated explicitly with a
-  &lt;span&gt;browsing context&lt;/span&gt; when it is created.&lt;/p&gt;
+  &lt;span&gt;browsing context&lt;/span&gt;, known as the &lt;dfn&gt;script browsing
+  context&lt;/dfn&gt;. If the &lt;span&gt;script execution context&lt;/span&gt; is a
+  &lt;code&gt;Window&lt;/code&gt; object, then that object's &lt;span&gt;browsing
+  context&lt;/span&gt; is it. Otherwise, the &lt;span&gt;script execution
+  context&lt;/span&gt; is associated explicitly with a &lt;span&gt;browsing
+  context&lt;/span&gt; when it is created.&lt;/p&gt;
 
+  &lt;hr&gt;
+
   &lt;p&gt;It is said that &lt;dfn&gt;scripting is disabled&lt;/dfn&gt; in a
   &lt;span&gt;script execution context&lt;/span&gt; when any of the following
   conditions are true:&lt;/p&gt;
@@ -28098,7 +28152,7 @@
   &lt;/ul&gt;
 
   &lt;p&gt;A node is said to be &lt;dfn&gt;without script&lt;/dfn&gt; if either the
-  &lt;code&gt;Document&lt;/code&gt; object of the node (the node itself, it is
+  &lt;code&gt;Document&lt;/code&gt; object of the node (the node itself, if it is
   itself a &lt;code&gt;Document&lt;/code&gt; object) does not have an associated
   &lt;span&gt;browsing context&lt;/span&gt;, or &lt;span&gt;scripting is disabled&lt;/span&gt;
   in that &lt;span&gt;browsing context&lt;/span&gt;.&lt;/p&gt;
@@ -28119,13 +28173,22 @@
   event handler attributes, event listeners, timeouts, etc, that were
   set by scripts in the document.&lt;/p&gt;
 
+  &lt;hr&gt;
 
+  &lt;p&gt;Every script whose &lt;span&gt;script execution context&lt;/span&gt; is a
+  &lt;code&gt;Window&lt;/code&gt; object is also associated with a
+  &lt;code&gt;Document&lt;/code&gt; object, known as its &lt;dfn&gt;script document
+  context&lt;/dfn&gt;. It is used to resolve URLs. The document is assigned
+  when the script is created, as with the &lt;span&gt;script browsing
+  context&lt;/span&gt;.&lt;/p&gt;
 
+
   &lt;h4&gt;Security exceptions&lt;/h4&gt;
 
   &lt;p class=&quot;big-issue&quot;&gt;Define &lt;dfn&gt;security exception&lt;/dfn&gt;.&lt;/p&gt;
 
 
+  &lt;!-- SCRIPT EXEC --&gt;
   &lt;h4 id=&quot;javascript-protocol&quot;&gt;&lt;dfn title=&quot;javascript protocol&quot;&gt;The &lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt; protocol&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;!-- XXXURL merge into URLs section? (we could define 'fetch'/'download' while we're at it?) --&gt;
@@ -28150,7 +28213,8 @@
   the &lt;span&gt;same origin&lt;/span&gt; as the script given by that URI, the
   &lt;span&gt;script execution context&lt;/span&gt; must be the
   &lt;code&gt;Window&lt;/code&gt; object of the &lt;span&gt;browsing context&lt;/span&gt;
-  being navigated.&lt;/p&gt;
+  being navigated, and the &lt;span&gt;script document context&lt;/span&gt; must
+  be that &lt;span&gt;active document&lt;/span&gt;.&lt;/p&gt;
 
   &lt;!-- XXXURL JSURL issue --&gt;
   &lt;p&gt;When a browsing context is &lt;span
@@ -28159,8 +28223,7 @@
   &lt;span&gt;origin&lt;/span&gt; that is &lt;em&gt;not&lt;/em&gt; the &lt;span title=&quot;same
   origin&quot;&gt;same&lt;/span&gt; as that of the script given by the URI, the
   &lt;span&gt;script execution context&lt;/span&gt; must be an empty object, and
-  the &lt;span&gt;script execution context&lt;/span&gt;'s associated
-  &lt;span&gt;browsing context&lt;/span&gt; must be the &lt;span&gt;browsing
+  the &lt;span&gt;script browsing context&lt;/span&gt; must be the &lt;span&gt;browsing
   context&lt;/span&gt; being &lt;span title=&quot;navigate&quot;&gt;navigated&lt;/span&gt;.&lt;/p&gt;
 
   &lt;!-- XXXURL JSURL issue --&gt;
@@ -28253,6 +28316,7 @@
   title=&quot;&quot;&gt;FunctionBody&lt;/code&gt; production. &lt;a
   href=&quot;#refsECMA262&quot;&gt;[ECMA262]&lt;/a&gt;&lt;/p&gt;
 
+  &lt;!-- SCRIPT EXEC --&gt;
   &lt;p&gt;When an event handler content attribute is set, its new value
   must be interpreted as the body of an anonymous function with a
   single argument called &lt;code&gt;event&lt;/code&gt;, with the new function's
@@ -28275,7 +28339,9 @@
 
   &lt;p&gt;The &lt;span&gt;script execution context&lt;/span&gt; of the event handler
   must be the &lt;code&gt;Window&lt;/code&gt; object at the end of the scope
-  chain.&lt;/p&gt;
+  chain. The &lt;span&gt;script document context&lt;/span&gt; of the event handler
+  must be the &lt;code&gt;Document&lt;/code&gt; object that owns the event handler
+  content attribute that was set.&lt;/p&gt;
 
   &lt;p class=&quot;big-issue&quot;&gt;How do we allow non-JS event handlers?&lt;/p&gt;
 
@@ -28956,15 +29022,10 @@
 
     &lt;p&gt;&lt;span&gt;Navigate&lt;/span&gt; the new browsing context to &lt;var
     title=&quot;&quot;&gt;url&lt;/var&gt;, with &lt;span&gt;replacement enabled&lt;/span&gt;, and
-    with the &lt;span&gt;browsing context&lt;/span&gt; of the &lt;code&gt;Window&lt;/code&gt;
-    object that is the &lt;span&gt;script execution context&lt;/span&gt; of the
-    script that invoked the method as the &lt;span&gt;source browsing
+    with the &lt;span&gt;script browsing context&lt;/span&gt; of the script that
+    invoked the method as the &lt;span&gt;source browsing
     context&lt;/span&gt;.&lt;/p&gt;
 
-    &lt;p class=&quot;note&quot;&gt;If the &lt;span&gt;script execution context&lt;/span&gt; of a
-    script isn't a &lt;code&gt;Window&lt;/code&gt; object, then it can't ever get
-    to a &lt;code&gt;Window&lt;/code&gt; object to call this method.&lt;/p&gt;
-
    &lt;/li&gt;
 
    &lt;li&gt;
@@ -29073,24 +29134,22 @@
   cause the user agent to show a notification.&lt;/p&gt;
 
   &lt;p id=&quot;sandboxNotifications&quot;&gt;If the method was invoked from a script
-  whose &lt;span&gt;script execution context&lt;/span&gt;'s associated
-  &lt;span&gt;browsing context&lt;/span&gt; has the &lt;span&gt;sandboxed annoyances
-  browsing context flag&lt;/span&gt; set, then the notification must be
-  shown within that &lt;span&gt;browsing context&lt;/span&gt;. The notification is
-  said to be a &lt;dfn&gt;sandboxed notification&lt;/dfn&gt;.&lt;/p&gt;
+  whose &lt;span&gt;script browsing context&lt;/span&gt; has the &lt;span&gt;sandboxed
+  annoyances browsing context flag&lt;/span&gt; set, then the notification
+  must be shown within that &lt;span&gt;browsing context&lt;/span&gt;. The
+  notification is said to be a &lt;dfn&gt;sandboxed notification&lt;/dfn&gt;.&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, if the &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;browsing
-  context&lt;/span&gt; associated with the &lt;span&gt;script execution
-  context&lt;/span&gt; of the script that invoked the method is &lt;em&gt;not&lt;/em&gt;
-  flagged as being a &lt;span&gt;trusted notification source&lt;/span&gt;, then
-  the notification should be rendered within the &lt;span&gt;top-level
-  browsing context&lt;/span&gt; of the &lt;span&gt;browsing context&lt;/span&gt;
-  associated with the &lt;span&gt;script execution context&lt;/span&gt; of the
-  script that invoked the method. The notification is said to be a
-  &lt;dfn&gt;normal notification&lt;/dfn&gt;. User agents should provide a way to
-  set the origin's &lt;span&gt;trusted notification source&lt;/span&gt; flag from
-  the notification, so that the user can benefit from notifications
-  even when the user agent is not the active application.&lt;/p&gt;
+  &lt;p&gt;Otherwise, if the &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;script
+  browsing context&lt;/span&gt; of the script that invoked the method is
+  &lt;em&gt;not&lt;/em&gt; flagged as being a &lt;span&gt;trusted notification
+  source&lt;/span&gt;, then the notification should be rendered within the
+  &lt;span&gt;top-level browsing context&lt;/span&gt; of the &lt;span&gt;script browsing
+  context&lt;/span&gt; of the script that invoked the method. The
+  notification is said to be a &lt;dfn&gt;normal notification&lt;/dfn&gt;. User
+  agents should provide a way to set the origin's &lt;span&gt;trusted
+  notification source&lt;/span&gt; flag from the notification, so that the
+  user can benefit from notifications even when the user agent is not
+  the active application.&lt;/p&gt;
 
   &lt;p&gt;Otherwise, the &lt;span&gt;origin&lt;/span&gt; is flagged as a &lt;span&gt;trusted
   notification source&lt;/span&gt;, and the notification should be shown
@@ -29134,17 +29193,16 @@
   &lt;p&gt;When a &lt;span&gt;normal notification&lt;/span&gt; (but not a
   &lt;span&gt;sandboxed notification&lt;/span&gt;) is shown, the user agent may
   bring the user's attention to the &lt;span&gt;top-level browsing
-  context&lt;/span&gt; of the &lt;span&gt;browsing context&lt;/span&gt; associated with
-  the &lt;span&gt;script execution context&lt;/span&gt; of the script that invoked
-  the method, if that would be useful; but user agents should not use
-  system-wide notification mechanisms to do so.&lt;/p&gt;
+  context&lt;/span&gt; of the &lt;span&gt;script browsing context&lt;/span&gt; of the
+  script that invoked the method, if that would be useful; but user
+  agents should not use system-wide notification mechanisms to do
+  so.&lt;/p&gt;
 
   &lt;p&gt;When a &lt;span&gt;trusted notification&lt;/span&gt; is shown, the user agent
   should bring the user's attention to the notification and the
-  &lt;span&gt;browsing context&lt;/span&gt; associated with the &lt;span&gt;script
-  execution context&lt;/span&gt; of the script that invoked the method, as
-  per the platform conventions for attracting the user's attention to
-  applications.&lt;/p&gt;
+  &lt;span&gt;script browsing context&lt;/span&gt; of the script that invoked the
+  method, as per the platform conventions for attracting the user's
+  attention to applications.&lt;/p&gt;
 
   &lt;div class=&quot;example&quot;&gt;
 
@@ -29171,9 +29229,8 @@
    &lt;li&gt;The &lt;span title=&quot;meta-application-name&quot;&gt;application
    name&lt;/span&gt;, if available, or else the &lt;span
    title=&quot;dom-document-title&quot;&gt;document title&lt;/span&gt;, of the
-   &lt;span&gt;active document&lt;/span&gt; of the &lt;span&gt;browsing context&lt;/span&gt;
-   associated with the &lt;span&gt;script execution context&lt;/span&gt; of the
-   script that invoked the method.&lt;/li&gt;
+   &lt;span&gt;active document&lt;/span&gt; of the &lt;span&gt;script browsing
+   context&lt;/span&gt; of the script that invoked the method.&lt;/li&gt;
 
    &lt;li&gt;An icon chosen from the &lt;span title=&quot;external resource
    link&quot;&gt;external resource links&lt;/span&gt; of type &lt;code
@@ -29216,9 +29273,8 @@
   &lt;p&gt;User agents should support user interaction with notifications,
   if and as appropriate given the platform conventions. If a user
   activates a notification, and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt;
-  callback argument was present and is not null, then the
-  &lt;span&gt;browsing context&lt;/span&gt; associated with the &lt;span&gt;script
-  execution context&lt;/span&gt; of the function given by &lt;var
+  callback argument was present and is not null, then the &lt;span&gt;script
+  browsing context&lt;/span&gt; of the function given by &lt;var
   title=&quot;&quot;&gt;onclick&lt;/var&gt; should be brought to the user's attention,
   and the &lt;var title=&quot;&quot;&gt;onclick&lt;/var&gt; callback should then be
   invoked.&lt;/p&gt;
@@ -31542,15 +31598,9 @@
   &lt;p&gt;Navigation for the &lt;code
   title=&quot;dom-location-assign&quot;&gt;assign()&lt;/code&gt; and &lt;code
   title=&quot;dom-location-replace&quot;&gt;replace()&lt;/code&gt; methods must be done
-  with the &lt;span&gt;browsing context&lt;/span&gt; of the &lt;code&gt;Window&lt;/code&gt;
-  object that is the &lt;span&gt;script execution context&lt;/span&gt; of the
-  script that invoked the method as the &lt;span&gt;source browsing
-  context&lt;/span&gt;.&lt;/p&gt;
+  with the &lt;span&gt;script browsing context&lt;/span&gt; of the script that
+  invoked the method as the &lt;span&gt;source browsing context&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p class=&quot;note&quot;&gt;If the &lt;span&gt;script execution context&lt;/span&gt; of a
-  script isn't a &lt;code&gt;Window&lt;/code&gt; object, then it can't ever get to
-  a &lt;code&gt;Location&lt;/code&gt; object to call these methods.&lt;/p&gt;
-
   &lt;!-- XXXURL algorithms --&gt;
   &lt;p&gt;Relative &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; arguments for &lt;code
   title=&quot;dom-location-assign&quot;&gt;assign()&lt;/code&gt; and &lt;code


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008688.html">[html5] r1790 - /
</A></li>
	<LI>Next message: <A HREF="008690.html">[html5] r1792 - [e] (0) Hm, that didn't work well. Let's [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8689">[ date ]</a>
              <a href="thread.html#8689">[ thread ]</a>
              <a href="subject.html#8689">[ subject ]</a>
              <a href="author.html#8689">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
