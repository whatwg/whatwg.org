<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r7849 - [giow] (0) ImageData objects now expose an explicit	pixel density, enabling them [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7849%20-%20%5Bgiow%5D%20%280%29%20ImageData%20objects%20now%20expose%20an%20explicit%0A%09pixel%20density%2C%20enabling%20them%20%5B...%5D&In-Reply-To=%3C20130423183208.C99831C9C004%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014706.html">
   <LINK REL="Next"  HREF="014708.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r7849 - [giow] (0) ImageData objects now expose an explicit	pixel density, enabling them [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7849%20-%20%5Bgiow%5D%20%280%29%20ImageData%20objects%20now%20expose%20an%20explicit%0A%09pixel%20density%2C%20enabling%20them%20%5B...%5D&In-Reply-To=%3C20130423183208.C99831C9C004%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r7849 - [giow] (0) ImageData objects now expose an explicit	pixel density, enabling them [...]">whatwg at whatwg.org
       </A><BR>
    <I>Tue Apr 23 11:32:08 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="014706.html">[html5] r7848 - [e] (0) Be clearer about how preparsing handles	running out of bytes. Fixing htt [...]
</A></li>
        <LI>Next message: <A HREF="014708.html">[html5] r7850 - [giow] (2) Add bitcoin: to the URL scheme whitelist,	by request. It's more or le [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14707">[ date ]</a>
              <a href="thread.html#14707">[ thread ]</a>
              <a href="subject.html#14707">[ subject ]</a>
              <a href="author.html#14707">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2013-04-23 11:32:07 -0700 (Tue, 23 Apr 2013)
New Revision: 7849

Modified:
   complete.html
   index
   source
Log:
[giow] (0) ImageData objects now expose an explicit pixel density, enabling them to be converted to BitmapImage objects correctly.
Fixing <A HREF="https://www.w3.org/Bugs/Public/show_bug.cgi?id=21329">https://www.w3.org/Bugs/Public/show_bug.cgi?id=21329</A>
Affected topics: Canvas, DOM APIs

Modified: complete.html
===================================================================
--- complete.html	2013-04-23 00:05:05 UTC (rev 7848)
+++ complete.html	2013-04-23 18:32:07 UTC (rev 7849)
@@ -7986,6 +7986,7 @@
 
   &lt;h4 id=safe-passing-of-structured-data&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;Safe passing of structured data&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a user agent is required to obtain a &lt;dfn id=structured-clone&gt;structured
   clone&lt;/dfn&gt; of a value, optionally with a &lt;i&gt;transfer map&lt;/i&gt;, it
   must run the following algorithm, which either returns a separate
@@ -8074,7 +8075,7 @@
      &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; is an &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object&lt;/dt&gt;
 
      &lt;dd&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;output&lt;/var&gt; be a newly constructed
-     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-imagedata-width&gt;&lt;a href=#dom-imagedata-width&gt;width&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-imagedata-height&gt;&lt;a href=#dom-imagedata-height&gt;height&lt;/a&gt;&lt;/code&gt; attributes have values
+     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-imagedata-width&gt;&lt;a href=#dom-imagedata-width&gt;width&lt;/a&gt;&lt;/code&gt;, &lt;code title=dom-imagedata-height&gt;&lt;a href=#dom-imagedata-height&gt;height&lt;/a&gt;&lt;/code&gt;, and &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attributes have values
      equal to the corresponding attributes on &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;, and whose &lt;code title=dom-imagedata-data&gt;&lt;a href=#dom-imagedata-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute has the value
      obtained from invoking the &lt;a href=#internal-structured-cloning-algorithm&gt;internal structured cloning
      algorithm&lt;/a&gt; recursively with the value of the &lt;code title=dom-imagedata-data&gt;&lt;a href=#dom-imagedata-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute on &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; as the new &quot;&lt;var title=&quot;&quot;&gt;input&lt;/var&gt;&quot;
@@ -33233,6 +33234,7 @@
 interface &lt;dfn id=imagedata&gt;ImageData&lt;/dfn&gt; {
   readonly attribute unsigned long &lt;a href=#dom-imagedata-width title=dom-imagedata-width&gt;width&lt;/a&gt;;
   readonly attribute unsigned long &lt;a href=#dom-imagedata-height title=dom-imagedata-height&gt;height&lt;/a&gt;;
+  readonly attribute double &lt;a href=#dom-imagedata-resolution title=dom-imagedata-resolution&gt;resolution&lt;/a&gt;;
   readonly attribute &lt;a href=#uint8clampedarray&gt;Uint8ClampedArray&lt;/a&gt; &lt;a href=#dom-imagedata-data title=dom-imagedata-data&gt;data&lt;/a&gt;;
 };
 
@@ -35620,9 +35622,10 @@
 
    &lt;li&gt;&lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
 
-  &lt;!-- v3: supporting ImageData object might make sense (when resizing as well as filtering) - ack Charles Pritchard --&gt;
+  &lt;/ul&gt;&lt;p class=note&gt;The &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; interface can be created from a number of other
+  image-representing types, including &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
 
-  &lt;/ul&gt;&lt;p&gt;When a user agent is required to &lt;dfn id=check-the-usability-of-the-image-argument&gt;check the usability of the &lt;var title=&quot;&quot;&gt;image&lt;/var&gt;
+  &lt;p&gt;When a user agent is required to &lt;dfn id=check-the-usability-of-the-image-argument&gt;check the usability of the &lt;var title=&quot;&quot;&gt;image&lt;/var&gt;
   argument&lt;/dfn&gt;, where &lt;var title=&quot;&quot;&gt;image&lt;/var&gt; is a &lt;code&gt;&lt;a href=#canvasimagesource&gt;CanvasImageSource&lt;/a&gt;&lt;/code&gt; object, the
   user agent must run these steps, which return either &lt;i&gt;good&lt;/i&gt;, &lt;i&gt;bad&lt;/i&gt;, or
   &lt;i&gt;aborted&lt;/i&gt;:&lt;/p&gt;
@@ -37624,6 +37627,7 @@
 
 
   &lt;h6 id=pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.2.16 &lt;/span&gt;&lt;dfn&gt;Pixel manipulation&lt;/dfn&gt;&lt;/h6&gt;
+&lt;!--CLEANUP--&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-createImageData&gt;&lt;a href=#dom-context-2d-createimagedata&gt;createImageData&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/dt&gt;
 
@@ -37701,6 +37705,18 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; . &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns the theoretical number of pixels in the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object's data per
+    corresponding coordinate space unit. This value is automatically determined from the source
+    image when the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object is created. It is only used to ensure that
+    &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; objects have the right pixel density when generated from
+    &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; objects.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; . &lt;code title=dom-imagedata-data&gt;&lt;a href=#dom-imagedata-data&gt;data&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -37726,7 +37742,8 @@
     &lt;p&gt;Throws a &lt;code&gt;&lt;a href=#notsupportederror&gt;NotSupportedError&lt;/a&gt;&lt;/code&gt; exception if any of the
     arguments are not finite.&lt;/p&gt;
 
-    &lt;p&gt;Each pixel in the image data is mapped to one coordinate space unit on the bitmap.&lt;/p&gt;
+    &lt;p&gt;Each pixel in the image data is mapped to one coordinate space unit on the bitmap, regardless
+    of the value of the &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attribute.&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -37735,8 +37752,8 @@
    &lt;dd&gt;
 
     &lt;p&gt;Paints the data from the given &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object onto the bitmap, at the bitmap's
-    native pixel density. If a dirty rectangle is provided, only the pixels from that rectangle are
-    painted.&lt;/p&gt;
+    native pixel density (regardless of the value of the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object's &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attribute). If a dirty rectangle is provided,
+    only the pixels from that rectangle are painted.&lt;/p&gt;
 
     &lt;p&gt;The &lt;code title=dom-context-2d-globalAlpha&gt;&lt;a href=#dom-context-2d-globalalpha&gt;globalAlpha&lt;/a&gt;&lt;/code&gt;
     and &lt;code title=dom-context-2d-globalCompositeOperation&gt;&lt;a href=#dom-context-2d-globalcompositeoperation&gt;globalCompositeOperation&lt;/a&gt;&lt;/code&gt;
@@ -37758,23 +37775,21 @@
   objects.&lt;/p&gt;
 
   &lt;p&gt;When the &lt;dfn id=dom-context-2d-createimagedata title=dom-context-2d-createImageData&gt;&lt;code&gt;createImageData()&lt;/code&gt;&lt;/dfn&gt;
-  method is invoked with two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;, it must return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt;
-  object representing a rectangle with a width in equal to the
-  absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and a height equal to
-  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;. When invoked with
-  a single &lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; argument, it must return a
-  new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing a rectangle with the
-  same dimensions as the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object passed as the
-  argument. The &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be filled
-  with transparent black.&lt;/p&gt;
+  method is invoked with two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;, it must
+  return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing a rectangle with a width in equal to the
+  absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and a height equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;, and with a 1.0 pixel density. When invoked with a single &lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; argument, it must return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing
+  a rectangle with the same dimensions and pixel density as the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object passed
+  as the argument. In either case, the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be filled with
+  transparent black.&lt;/p&gt;
 
   &lt;p&gt;When the &lt;dfn id=dom-context-2d-createimagedatahd title=dom-context-2d-createImageDataHD&gt;&lt;code&gt;createImageDataHD()&lt;/code&gt;&lt;/dfn&gt;
   method is invoked (with its two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;) it
   must return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing a rectangle with a width in equal to
-  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; and a
-  height equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, where &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the number of pixels in the &lt;a href=#scratch-bitmap&gt;scratch
-  bitmap&lt;/a&gt; per coordinate space units. The &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be
-  filled with transparent black.&lt;/p&gt;
+  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, a height
+  equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;,
+  and a pixel density equal to &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, where &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the
+  number of pixels in the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; per coordinate space units. The
+  &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be filled with transparent black.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-context-2d-getimagedata title=dom-context-2d-getImageData&gt;&lt;code&gt;getImageData(&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must, if
   either the &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; or &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; arguments are zero, throw an
@@ -37783,6 +37798,7 @@
   if the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt;'s &lt;a href=#concept-canvas-origin-clean title=concept-canvas-origin-clean&gt;origin-clean&lt;/a&gt;
   flag is set to false, it must throw a &lt;code&gt;&lt;a href=#securityerror&gt;SecurityError&lt;/a&gt;&lt;/code&gt; exception;
   &lt;!--REMOVE-TOPIC:Security--&gt;
+
   otherwise, it must return an &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object with width &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and
   height &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; representing the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; for the area of that
   bitmap denoted by the rectangle whose corners are the four points (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), in the bitmap's coordinate space
@@ -37790,7 +37806,7 @@
   the value of each pixel in the returned abject must be derived from the value(s) of the pixel(s)
   in the bitmap that correspond to the same coordinate. Pixels outside the &lt;a href=#scratch-bitmap&gt;scratch
   bitmap&lt;/a&gt; must be returned as transparent black. Pixels must be returned as non-premultiplied
-  alpha values.&lt;/p&gt;
+  alpha values. The pixel density of the object returned must be 1.0.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-context-2d-getimagedatahd title=dom-context-2d-getImageDataHD&gt;&lt;code&gt;getImageDataHD(&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;,
   &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must,
@@ -37804,13 +37820,17 @@
   multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; representing the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; for the area of that bitmap
   denoted by the rectangle whose corners are the four points (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), in the bitmap's coordinate space
   units. Pixels outside the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; must be returned as transparent black.
-  Pixels must be returned as non-premultiplied alpha values.&lt;/p&gt;
+  Pixels must be returned as non-premultiplied alpha values. The pixel density of the object
+  returned must be &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;. For the purposes of this paragraph, &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the number of pixels in the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; per coordinate
+  space units.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;New &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; objects must be initialized so that
   their &lt;dfn id=dom-imagedata-width title=dom-imagedata-width&gt;&lt;code&gt;width&lt;/code&gt;&lt;/dfn&gt;
   attribute is set to the number of pixels per row in the image data,
   their &lt;dfn id=dom-imagedata-height title=dom-imagedata-height&gt;&lt;code&gt;height&lt;/code&gt;&lt;/dfn&gt;
-  attribute is set to the number of rows in the image data, and their
+  attribute is set to the number of rows in the image data,
+  their &lt;dfn id=dom-imagedata-resolution title=dom-imagedata-resolution&gt;&lt;code&gt;resolution&lt;/code&gt;&lt;/dfn&gt; is set to the object's pixel density, and their
   &lt;dfn id=dom-imagedata-data title=dom-imagedata-data&gt;&lt;code&gt;data&lt;/code&gt;&lt;/dfn&gt; attribute is
   initialized to a &lt;code&gt;&lt;a href=#uint8clampedarray&gt;Uint8ClampedArray&lt;/a&gt;&lt;/code&gt; object. The
   &lt;code&gt;&lt;a href=#uint8clampedarray&gt;Uint8ClampedArray&lt;/a&gt;&lt;/code&gt; object must use a &lt;a href=#canvas-pixel-arraybuffer&gt;Canvas Pixel
@@ -73825,7 +73845,9 @@
      &lt;li&gt;&lt;p&gt;Create a new &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; object.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; object's bitmap data be the image data given by the
-     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object, &lt;a href=#cropped-to-the-source-rectangle&gt;cropped to the source rectangle&lt;/a&gt;.&lt;/li&gt;
+     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object, &lt;a href=#cropped-to-the-source-rectangle&gt;cropped to the source rectangle&lt;/a&gt;, using the value
+     ofd the object's &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attribute as the
+     object's pixel density.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Return, but continue running these steps asynchronously.&lt;/li&gt;
 

Modified: index
===================================================================
--- index	2013-04-23 00:05:05 UTC (rev 7848)
+++ index	2013-04-23 18:32:07 UTC (rev 7849)
@@ -7986,6 +7986,7 @@
 
   &lt;h4 id=safe-passing-of-structured-data&gt;&lt;span class=secno&gt;2.7.6 &lt;/span&gt;Safe passing of structured data&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a user agent is required to obtain a &lt;dfn id=structured-clone&gt;structured
   clone&lt;/dfn&gt; of a value, optionally with a &lt;i&gt;transfer map&lt;/i&gt;, it
   must run the following algorithm, which either returns a separate
@@ -8074,7 +8075,7 @@
      &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; is an &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object&lt;/dt&gt;
 
      &lt;dd&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;output&lt;/var&gt; be a newly constructed
-     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-imagedata-width&gt;&lt;a href=#dom-imagedata-width&gt;width&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-imagedata-height&gt;&lt;a href=#dom-imagedata-height&gt;height&lt;/a&gt;&lt;/code&gt; attributes have values
+     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-imagedata-width&gt;&lt;a href=#dom-imagedata-width&gt;width&lt;/a&gt;&lt;/code&gt;, &lt;code title=dom-imagedata-height&gt;&lt;a href=#dom-imagedata-height&gt;height&lt;/a&gt;&lt;/code&gt;, and &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attributes have values
      equal to the corresponding attributes on &lt;var title=&quot;&quot;&gt;input&lt;/var&gt;, and whose &lt;code title=dom-imagedata-data&gt;&lt;a href=#dom-imagedata-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute has the value
      obtained from invoking the &lt;a href=#internal-structured-cloning-algorithm&gt;internal structured cloning
      algorithm&lt;/a&gt; recursively with the value of the &lt;code title=dom-imagedata-data&gt;&lt;a href=#dom-imagedata-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute on &lt;var title=&quot;&quot;&gt;input&lt;/var&gt; as the new &quot;&lt;var title=&quot;&quot;&gt;input&lt;/var&gt;&quot;
@@ -33233,6 +33234,7 @@
 interface &lt;dfn id=imagedata&gt;ImageData&lt;/dfn&gt; {
   readonly attribute unsigned long &lt;a href=#dom-imagedata-width title=dom-imagedata-width&gt;width&lt;/a&gt;;
   readonly attribute unsigned long &lt;a href=#dom-imagedata-height title=dom-imagedata-height&gt;height&lt;/a&gt;;
+  readonly attribute double &lt;a href=#dom-imagedata-resolution title=dom-imagedata-resolution&gt;resolution&lt;/a&gt;;
   readonly attribute &lt;a href=#uint8clampedarray&gt;Uint8ClampedArray&lt;/a&gt; &lt;a href=#dom-imagedata-data title=dom-imagedata-data&gt;data&lt;/a&gt;;
 };
 
@@ -35620,9 +35622,10 @@
 
    &lt;li&gt;&lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
 
-  &lt;!-- v3: supporting ImageData object might make sense (when resizing as well as filtering) - ack Charles Pritchard --&gt;
+  &lt;/ul&gt;&lt;p class=note&gt;The &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; interface can be created from a number of other
+  image-representing types, including &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
 
-  &lt;/ul&gt;&lt;p&gt;When a user agent is required to &lt;dfn id=check-the-usability-of-the-image-argument&gt;check the usability of the &lt;var title=&quot;&quot;&gt;image&lt;/var&gt;
+  &lt;p&gt;When a user agent is required to &lt;dfn id=check-the-usability-of-the-image-argument&gt;check the usability of the &lt;var title=&quot;&quot;&gt;image&lt;/var&gt;
   argument&lt;/dfn&gt;, where &lt;var title=&quot;&quot;&gt;image&lt;/var&gt; is a &lt;code&gt;&lt;a href=#canvasimagesource&gt;CanvasImageSource&lt;/a&gt;&lt;/code&gt; object, the
   user agent must run these steps, which return either &lt;i&gt;good&lt;/i&gt;, &lt;i&gt;bad&lt;/i&gt;, or
   &lt;i&gt;aborted&lt;/i&gt;:&lt;/p&gt;
@@ -37624,6 +37627,7 @@
 
 
   &lt;h6 id=pixel-manipulation&gt;&lt;span class=secno&gt;4.8.11.2.16 &lt;/span&gt;&lt;dfn&gt;Pixel manipulation&lt;/dfn&gt;&lt;/h6&gt;
+&lt;!--CLEANUP--&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; = &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; . &lt;code title=dom-context-2d-createImageData&gt;&lt;a href=#dom-context-2d-createimagedata&gt;createImageData&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/dt&gt;
 
@@ -37701,6 +37705,18 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; . &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns the theoretical number of pixels in the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object's data per
+    corresponding coordinate space unit. This value is automatically determined from the source
+    image when the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object is created. It is only used to ensure that
+    &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; objects have the right pixel density when generated from
+    &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; objects.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; . &lt;code title=dom-imagedata-data&gt;&lt;a href=#dom-imagedata-data&gt;data&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -37726,7 +37742,8 @@
     &lt;p&gt;Throws a &lt;code&gt;&lt;a href=#notsupportederror&gt;NotSupportedError&lt;/a&gt;&lt;/code&gt; exception if any of the
     arguments are not finite.&lt;/p&gt;
 
-    &lt;p&gt;Each pixel in the image data is mapped to one coordinate space unit on the bitmap.&lt;/p&gt;
+    &lt;p&gt;Each pixel in the image data is mapped to one coordinate space unit on the bitmap, regardless
+    of the value of the &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attribute.&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -37735,8 +37752,8 @@
    &lt;dd&gt;
 
     &lt;p&gt;Paints the data from the given &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object onto the bitmap, at the bitmap's
-    native pixel density. If a dirty rectangle is provided, only the pixels from that rectangle are
-    painted.&lt;/p&gt;
+    native pixel density (regardless of the value of the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object's &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attribute). If a dirty rectangle is provided,
+    only the pixels from that rectangle are painted.&lt;/p&gt;
 
     &lt;p&gt;The &lt;code title=dom-context-2d-globalAlpha&gt;&lt;a href=#dom-context-2d-globalalpha&gt;globalAlpha&lt;/a&gt;&lt;/code&gt;
     and &lt;code title=dom-context-2d-globalCompositeOperation&gt;&lt;a href=#dom-context-2d-globalcompositeoperation&gt;globalCompositeOperation&lt;/a&gt;&lt;/code&gt;
@@ -37758,23 +37775,21 @@
   objects.&lt;/p&gt;
 
   &lt;p&gt;When the &lt;dfn id=dom-context-2d-createimagedata title=dom-context-2d-createImageData&gt;&lt;code&gt;createImageData()&lt;/code&gt;&lt;/dfn&gt;
-  method is invoked with two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;, it must return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt;
-  object representing a rectangle with a width in equal to the
-  absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and a height equal to
-  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;. When invoked with
-  a single &lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; argument, it must return a
-  new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing a rectangle with the
-  same dimensions as the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object passed as the
-  argument. The &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be filled
-  with transparent black.&lt;/p&gt;
+  method is invoked with two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;, it must
+  return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing a rectangle with a width in equal to the
+  absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and a height equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;, and with a 1.0 pixel density. When invoked with a single &lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; argument, it must return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing
+  a rectangle with the same dimensions and pixel density as the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object passed
+  as the argument. In either case, the &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be filled with
+  transparent black.&lt;/p&gt;
 
   &lt;p&gt;When the &lt;dfn id=dom-context-2d-createimagedatahd title=dom-context-2d-createImageDataHD&gt;&lt;code&gt;createImageDataHD()&lt;/code&gt;&lt;/dfn&gt;
   method is invoked (with its two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;) it
   must return a new &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object representing a rectangle with a width in equal to
-  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; and a
-  height equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, where &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the number of pixels in the &lt;a href=#scratch-bitmap&gt;scratch
-  bitmap&lt;/a&gt; per coordinate space units. The &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be
-  filled with transparent black.&lt;/p&gt;
+  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, a height
+  equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;,
+  and a pixel density equal to &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, where &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the
+  number of pixels in the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; per coordinate space units. The
+  &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object returned must be filled with transparent black.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-context-2d-getimagedata title=dom-context-2d-getImageData&gt;&lt;code&gt;getImageData(&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must, if
   either the &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; or &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; arguments are zero, throw an
@@ -37783,6 +37798,7 @@
   if the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt;'s &lt;a href=#concept-canvas-origin-clean title=concept-canvas-origin-clean&gt;origin-clean&lt;/a&gt;
   flag is set to false, it must throw a &lt;code&gt;&lt;a href=#securityerror&gt;SecurityError&lt;/a&gt;&lt;/code&gt; exception;
   &lt;!--REMOVE-TOPIC:Security--&gt;
+
   otherwise, it must return an &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object with width &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and
   height &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; representing the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; for the area of that
   bitmap denoted by the rectangle whose corners are the four points (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), in the bitmap's coordinate space
@@ -37790,7 +37806,7 @@
   the value of each pixel in the returned abject must be derived from the value(s) of the pixel(s)
   in the bitmap that correspond to the same coordinate. Pixels outside the &lt;a href=#scratch-bitmap&gt;scratch
   bitmap&lt;/a&gt; must be returned as transparent black. Pixels must be returned as non-premultiplied
-  alpha values.&lt;/p&gt;
+  alpha values. The pixel density of the object returned must be 1.0.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-context-2d-getimagedatahd title=dom-context-2d-getImageDataHD&gt;&lt;code&gt;getImageDataHD(&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;,
   &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must,
@@ -37804,13 +37820,17 @@
   multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; and height &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; representing the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; for the area of that bitmap
   denoted by the rectangle whose corners are the four points (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;), (&lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;&lt;/span&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;span title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), in the bitmap's coordinate space
   units. Pixels outside the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; must be returned as transparent black.
-  Pixels must be returned as non-premultiplied alpha values.&lt;/p&gt;
+  Pixels must be returned as non-premultiplied alpha values. The pixel density of the object
+  returned must be &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;. For the purposes of this paragraph, &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the number of pixels in the &lt;a href=#scratch-bitmap&gt;scratch bitmap&lt;/a&gt; per coordinate
+  space units.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;New &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; objects must be initialized so that
   their &lt;dfn id=dom-imagedata-width title=dom-imagedata-width&gt;&lt;code&gt;width&lt;/code&gt;&lt;/dfn&gt;
   attribute is set to the number of pixels per row in the image data,
   their &lt;dfn id=dom-imagedata-height title=dom-imagedata-height&gt;&lt;code&gt;height&lt;/code&gt;&lt;/dfn&gt;
-  attribute is set to the number of rows in the image data, and their
+  attribute is set to the number of rows in the image data,
+  their &lt;dfn id=dom-imagedata-resolution title=dom-imagedata-resolution&gt;&lt;code&gt;resolution&lt;/code&gt;&lt;/dfn&gt; is set to the object's pixel density, and their
   &lt;dfn id=dom-imagedata-data title=dom-imagedata-data&gt;&lt;code&gt;data&lt;/code&gt;&lt;/dfn&gt; attribute is
   initialized to a &lt;code&gt;&lt;a href=#uint8clampedarray&gt;Uint8ClampedArray&lt;/a&gt;&lt;/code&gt; object. The
   &lt;code&gt;&lt;a href=#uint8clampedarray&gt;Uint8ClampedArray&lt;/a&gt;&lt;/code&gt; object must use a &lt;a href=#canvas-pixel-arraybuffer&gt;Canvas Pixel
@@ -73825,7 +73845,9 @@
      &lt;li&gt;&lt;p&gt;Create a new &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; object.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;code&gt;&lt;a href=#imagebitmap&gt;ImageBitmap&lt;/a&gt;&lt;/code&gt; object's bitmap data be the image data given by the
-     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object, &lt;a href=#cropped-to-the-source-rectangle&gt;cropped to the source rectangle&lt;/a&gt;.&lt;/li&gt;
+     &lt;code&gt;&lt;a href=#imagedata&gt;ImageData&lt;/a&gt;&lt;/code&gt; object, &lt;a href=#cropped-to-the-source-rectangle&gt;cropped to the source rectangle&lt;/a&gt;, using the value
+     ofd the object's &lt;code title=dom-imagedata-resolution&gt;&lt;a href=#dom-imagedata-resolution&gt;resolution&lt;/a&gt;&lt;/code&gt; attribute as the
+     object's pixel density.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Return, but continue running these steps asynchronously.&lt;/li&gt;
 

Modified: source
===================================================================
--- source	2013-04-23 00:05:05 UTC (rev 7848)
+++ source	2013-04-23 18:32:07 UTC (rev 7849)
@@ -7637,6 +7637,7 @@
 
   &lt;h4&gt;Safe passing of structured data&lt;/h4&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;When a user agent is required to obtain a &lt;dfn&gt;structured
   clone&lt;/dfn&gt; of a value, optionally with a &lt;i&gt;transfer map&lt;/i&gt;, it
   must run the following algorithm, which either returns a separate
@@ -7737,8 +7738,9 @@
 
      &lt;dd&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;output&lt;/var&gt; be a newly constructed
      &lt;code&gt;ImageData&lt;/code&gt; object whose &lt;code
-     title=&quot;dom-imagedata-width&quot;&gt;width&lt;/code&gt; and &lt;code
-     title=&quot;dom-imagedata-height&quot;&gt;height&lt;/code&gt; attributes have values
+     title=&quot;dom-imagedata-width&quot;&gt;width&lt;/code&gt;, &lt;code
+     title=&quot;dom-imagedata-height&quot;&gt;height&lt;/code&gt;, and &lt;code
+     title=&quot;dom-imagedata-resolution&quot;&gt;resolution&lt;/code&gt; attributes have values
      equal to the corresponding attributes on &lt;var
      title=&quot;&quot;&gt;input&lt;/var&gt;, and whose &lt;code
      title=&quot;dom-imagedata-data&quot;&gt;data&lt;/code&gt; attribute has the value
@@ -35860,6 +35862,7 @@
 interface &lt;dfn&gt;ImageData&lt;/dfn&gt; {
   readonly attribute unsigned long &lt;span title=&quot;dom-imagedata-width&quot;&gt;width&lt;/span&gt;;
   readonly attribute unsigned long &lt;span title=&quot;dom-imagedata-height&quot;&gt;height&lt;/span&gt;;
+  readonly attribute double &lt;span title=&quot;dom-imagedata-resolution&quot;&gt;resolution&lt;/span&gt;;
   readonly attribute &lt;span&gt;Uint8ClampedArray&lt;/span&gt; &lt;span title=&quot;dom-imagedata-data&quot;&gt;data&lt;/span&gt;;
 };
 
@@ -38707,10 +38710,11 @@
 
    &lt;li&gt;&lt;code&gt;ImageBitmap&lt;/code&gt;&lt;/li&gt;
 
-  &lt;!-- v3: supporting ImageData object might make sense (when resizing as well as filtering) - ack Charles Pritchard --&gt;
-
   &lt;/ul&gt;
 
+  &lt;p class=&quot;note&quot;&gt;The &lt;code&gt;ImageBitmap&lt;/code&gt; interface can be created from a number of other
+  image-representing types, including &lt;code&gt;ImageData&lt;/code&gt;.&lt;/p&gt;
+
   &lt;p&gt;When a user agent is required to &lt;dfn&gt;check the usability of the &lt;var title=&quot;&quot;&gt;image&lt;/var&gt;
   argument&lt;/dfn&gt;, where &lt;var title=&quot;&quot;&gt;image&lt;/var&gt; is a &lt;code&gt;CanvasImageSource&lt;/code&gt; object, the
   user agent must run these steps, which return either &lt;i&gt;good&lt;/i&gt;, &lt;i&gt;bad&lt;/i&gt;, or
@@ -41118,6 +41122,7 @@
 
 
   &lt;h6&gt;&lt;dfn&gt;Pixel manipulation&lt;/dfn&gt;&lt;/h6&gt;
+&lt;!--CLEANUP--&gt;
 
   &lt;dl class=&quot;domintro&quot;&gt;
 
@@ -41197,6 +41202,18 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; . &lt;code title=&quot;dom-imagedata-resolution&quot;&gt;resolution&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns the theoretical number of pixels in the &lt;code&gt;ImageData&lt;/code&gt; object's data per
+    corresponding coordinate space unit. This value is automatically determined from the source
+    image when the &lt;code&gt;ImageData&lt;/code&gt; object is created. It is only used to ensure that
+    &lt;code&gt;ImageBitmap&lt;/code&gt; objects have the right pixel density when generated from
+    &lt;code&gt;ImageData&lt;/code&gt; objects.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; . &lt;code title=&quot;dom-imagedata-data&quot;&gt;data&lt;/code&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -41223,7 +41240,8 @@
     &lt;p&gt;Throws a &lt;code&gt;NotSupportedError&lt;/code&gt; exception if any of the
     arguments are not finite.&lt;/p&gt;
 
-    &lt;p&gt;Each pixel in the image data is mapped to one coordinate space unit on the bitmap.&lt;/p&gt;
+    &lt;p&gt;Each pixel in the image data is mapped to one coordinate space unit on the bitmap, regardless
+    of the value of the &lt;code title=&quot;dom-imagedata-resolution&quot;&gt;resolution&lt;/code&gt; attribute.&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -41232,8 +41250,9 @@
    &lt;dd&gt;
 
     &lt;p&gt;Paints the data from the given &lt;code&gt;ImageData&lt;/code&gt; object onto the bitmap, at the bitmap's
-    native pixel density. If a dirty rectangle is provided, only the pixels from that rectangle are
-    painted.&lt;/p&gt;
+    native pixel density (regardless of the value of the &lt;code&gt;ImageData&lt;/code&gt; object's &lt;code
+    title=&quot;dom-imagedata-resolution&quot;&gt;resolution&lt;/code&gt; attribute). If a dirty rectangle is provided,
+    only the pixels from that rectangle are painted.&lt;/p&gt;
 
     &lt;p&gt;The &lt;code title=&quot;dom-context-2d-globalAlpha&quot;&gt;globalAlpha&lt;/code&gt;
     and &lt;code
@@ -41259,27 +41278,24 @@
   methods are used to instantiate new blank &lt;code&gt;ImageData&lt;/code&gt;
   objects.&lt;/p&gt;
 
-  &lt;p&gt;When the &lt;dfn
-  title=&quot;dom-context-2d-createImageData&quot;&gt;&lt;code&gt;createImageData()&lt;/code&gt;&lt;/dfn&gt;
-  method is invoked with two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var
-  title=&quot;&quot;&gt;sh&lt;/var&gt;, it must return a new &lt;code&gt;ImageData&lt;/code&gt;
-  object representing a rectangle with a width in equal to the
-  absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and a height equal to
-  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;. When invoked with
-  a single &lt;var title=&quot;&quot;&gt;imagedata&lt;/var&gt; argument, it must return a
-  new &lt;code&gt;ImageData&lt;/code&gt; object representing a rectangle with the
-  same dimensions as the &lt;code&gt;ImageData&lt;/code&gt; object passed as the
-  argument. The &lt;code&gt;ImageData&lt;/code&gt; object returned must be filled
-  with transparent black.&lt;/p&gt;
+  &lt;p&gt;When the &lt;dfn title=&quot;dom-context-2d-createImageData&quot;&gt;&lt;code&gt;createImageData()&lt;/code&gt;&lt;/dfn&gt;
+  method is invoked with two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;, it must
+  return a new &lt;code&gt;ImageData&lt;/code&gt; object representing a rectangle with a width in equal to the
+  absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and a height equal to the absolute magnitude of &lt;var
+  title=&quot;&quot;&gt;sh&lt;/var&gt;, and with a 1.0 pixel density. When invoked with a single &lt;var
+  title=&quot;&quot;&gt;imagedata&lt;/var&gt; argument, it must return a new &lt;code&gt;ImageData&lt;/code&gt; object representing
+  a rectangle with the same dimensions and pixel density as the &lt;code&gt;ImageData&lt;/code&gt; object passed
+  as the argument. In either case, the &lt;code&gt;ImageData&lt;/code&gt; object returned must be filled with
+  transparent black.&lt;/p&gt;
 
   &lt;p&gt;When the &lt;dfn title=&quot;dom-context-2d-createImageDataHD&quot;&gt;&lt;code&gt;createImageDataHD()&lt;/code&gt;&lt;/dfn&gt;
   method is invoked (with its two arguments &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;) it
   must return a new &lt;code&gt;ImageData&lt;/code&gt; object representing a rectangle with a width in equal to
-  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; and a
-  height equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var
-  title=&quot;&quot;&gt;scale&lt;/var&gt;, where &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the number of pixels in the &lt;span&gt;scratch
-  bitmap&lt;/span&gt; per coordinate space units. The &lt;code&gt;ImageData&lt;/code&gt; object returned must be
-  filled with transparent black.&lt;/p&gt;
+  the absolute magnitude of &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, a height
+  equal to the absolute magnitude of &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; multiplied by &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;,
+  and a pixel density equal to &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;, where &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt; is the
+  number of pixels in the &lt;span&gt;scratch bitmap&lt;/span&gt; per coordinate space units. The
+  &lt;code&gt;ImageData&lt;/code&gt; object returned must be filled with transparent black.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-context-2d-getImageData&quot;&gt;&lt;code&gt;getImageData(&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var
   title=&quot;&quot;&gt;sy&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must, if
@@ -41289,6 +41305,7 @@
   if the &lt;span&gt;scratch bitmap&lt;/span&gt;'s &lt;span title=&quot;concept-canvas-origin-clean&quot;&gt;origin-clean&lt;/span&gt;
   flag is set to false, it must throw a &lt;code&gt;SecurityError&lt;/code&gt; exception;
   &lt;!--REMOVE-TOPIC:Security--&gt;
+
   otherwise, it must return an &lt;code&gt;ImageData&lt;/code&gt; object with width &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt; and
   height &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt; representing the &lt;span&gt;scratch bitmap&lt;/span&gt; for the area of that
   bitmap denoted by the rectangle whose corners are the four points (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;var
@@ -41300,7 +41317,7 @@
   the value of each pixel in the returned abject must be derived from the value(s) of the pixel(s)
   in the bitmap that correspond to the same coordinate. Pixels outside the &lt;span&gt;scratch
   bitmap&lt;/span&gt; must be returned as transparent black. Pixels must be returned as non-premultiplied
-  alpha values.&lt;/p&gt;
+  alpha values. The pixel density of the object returned must be 1.0.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;dom-context-2d-getImageDataHD&quot;&gt;&lt;code&gt;getImageDataHD(&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;,
   &lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sw&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method must,
@@ -41319,13 +41336,18 @@
   title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), (&lt;var title=&quot;&quot;&gt;sx&lt;/var&gt;, &lt;span
   title=&quot;&quot;&gt;&lt;var title=&quot;&quot;&gt;sy&lt;/var&gt;+&lt;var title=&quot;&quot;&gt;sh&lt;/var&gt;&lt;/span&gt;), in the bitmap's coordinate space
   units. Pixels outside the &lt;span&gt;scratch bitmap&lt;/span&gt; must be returned as transparent black.
-  Pixels must be returned as non-premultiplied alpha values.&lt;/p&gt;
+  Pixels must be returned as non-premultiplied alpha values. The pixel density of the object
+  returned must be &lt;var title=&quot;&quot;&gt;scale&lt;/var&gt;. For the purposes of this paragraph, &lt;var
+  title=&quot;&quot;&gt;scale&lt;/var&gt; is the number of pixels in the &lt;span&gt;scratch bitmap&lt;/span&gt; per coordinate
+  space units.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p&gt;New &lt;code&gt;ImageData&lt;/code&gt; objects must be initialized so that
   their &lt;dfn title=&quot;dom-imagedata-width&quot;&gt;&lt;code&gt;width&lt;/code&gt;&lt;/dfn&gt;
   attribute is set to the number of pixels per row in the image data,
   their &lt;dfn title=&quot;dom-imagedata-height&quot;&gt;&lt;code&gt;height&lt;/code&gt;&lt;/dfn&gt;
-  attribute is set to the number of rows in the image data, and their
+  attribute is set to the number of rows in the image data,
+  their &lt;dfn title=&quot;dom-imagedata-resolution&quot;&gt;&lt;code&gt;resolution&lt;/code&gt;&lt;/dfn&gt; is set to the object's pixel density, and their
   &lt;dfn title=&quot;dom-imagedata-data&quot;&gt;&lt;code&gt;data&lt;/code&gt;&lt;/dfn&gt; attribute is
   initialized to a &lt;code&gt;Uint8ClampedArray&lt;/code&gt; object. The
   &lt;code&gt;Uint8ClampedArray&lt;/code&gt; object must use a &lt;span&gt;Canvas Pixel
@@ -82835,7 +82857,9 @@
      &lt;li&gt;&lt;p&gt;Create a new &lt;code&gt;ImageBitmap&lt;/code&gt; object.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;code&gt;ImageBitmap&lt;/code&gt; object's bitmap data be the image data given by the
-     &lt;code&gt;ImageData&lt;/code&gt; object, &lt;span&gt;cropped to the source rectangle&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+     &lt;code&gt;ImageData&lt;/code&gt; object, &lt;span&gt;cropped to the source rectangle&lt;/span&gt;, using the value
+     ofd the object's &lt;code title=&quot;dom-imagedata-resolution&quot;&gt;resolution&lt;/code&gt; attribute as the
+     object's pixel density.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Return, but continue running these steps asynchronously.&lt;/p&gt;&lt;/li&gt;
 


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014706.html">[html5] r7848 - [e] (0) Be clearer about how preparsing handles	running out of bytes. Fixing htt [...]
</A></li>
	<LI>Next message: <A HREF="014708.html">[html5] r7850 - [giow] (2) Add bitcoin: to the URL scheme whitelist,	by request. It's more or le [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14707">[ date ]</a>
              <a href="thread.html#14707">[ thread ]</a>
              <a href="subject.html#14707">[ subject ]</a>
              <a href="author.html#14707">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
