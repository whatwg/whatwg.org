<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r8274 - [agiow] (0) New BroadcastChannel feature to send	messages to other tabs in the s [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8274%20-%20%5Bagiow%5D%20%280%29%20New%20BroadcastChannel%20feature%20to%20send%0A%09messages%20to%20other%20tabs%20in%20the%20s%20%5B...%5D&In-Reply-To=%3C20131113190936.264AA1536CEF3%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015128.html">
   <LINK REL="Next"  HREF="015130.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r8274 - [agiow] (0) New BroadcastChannel feature to send	messages to other tabs in the s [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8274%20-%20%5Bagiow%5D%20%280%29%20New%20BroadcastChannel%20feature%20to%20send%0A%09messages%20to%20other%20tabs%20in%20the%20s%20%5B...%5D&In-Reply-To=%3C20131113190936.264AA1536CEF3%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r8274 - [agiow] (0) New BroadcastChannel feature to send	messages to other tabs in the s [...]">whatwg at whatwg.org
       </A><BR>
    <I>Wed Nov 13 11:09:36 PST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="015128.html">[html5] r8273 - [] (3) Remove security checks on Document since	there should now be no way to ge [...]
</A></li>
        <LI>Next message: <A HREF="015130.html">[html5] r8275 - [giow] (2) Make sandboxed iframes block	document.domain setting Fixing https://w [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15129">[ date ]</a>
              <a href="thread.html#15129">[ thread ]</a>
              <a href="subject.html#15129">[ subject ]</a>
              <a href="author.html#15129">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2013-11-13 11:09:31 -0800 (Wed, 13 Nov 2013)
New Revision: 8274

Modified:
   complete.html
   index
   source
Log:
[agiow] (0) New BroadcastChannel feature to send messages to other tabs in the same origin, so you don't have to abuse the onstorage event, and don't need to use a heavy shared worker for something otherwise trivial.
Fixing <A HREF="https://www.w3.org/Bugs/Public/show_bug.cgi?id=22628">https://www.w3.org/Bugs/Public/show_bug.cgi?id=22628</A>
Affected topics: DOM APIs, HTML

Modified: complete.html
===================================================================
--- complete.html	2013-11-12 21:53:05 UTC (rev 8273)
+++ complete.html	2013-11-13 19:09:31 UTC (rev 8274)
@@ -298,7 +298,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> class=logo&gt;&lt;img width=101 src=/images/logo alt=WHATWG height=101&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1 class=allcaps&gt;HTML&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 12 November 2013&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 13 November 2013&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;dl&gt;&lt;dt&gt;&lt;strong&gt;Web developer edition:&lt;/strong&gt;&lt;/dt&gt;
     &lt;dd&gt;&lt;strong&gt;&lt;a href=<A HREF="http://developers.whatwg.org/">http://developers.whatwg.org/</A>&gt;<A HREF="http://developers.whatwg.org/&lt;/a">http://developers.whatwg.org/&lt;/a</A>&gt;&lt;/strong&gt;&lt;/dd&gt;
     &lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -1142,7 +1142,8 @@
      &lt;li&gt;&lt;a href=#message-channels&gt;&lt;span class=secno&gt;9.5.2 &lt;/span&gt;Message channels&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#message-ports&gt;&lt;span class=secno&gt;9.5.3 &lt;/span&gt;Message ports&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#broadcasting-to-many-ports&gt;&lt;span class=secno&gt;9.5.4 &lt;/span&gt;Broadcasting to many ports&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#ports-and-garbage-collection&gt;&lt;span class=secno&gt;9.5.5 &lt;/span&gt;Ports and garbage collection&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#ports-and-garbage-collection&gt;&lt;span class=secno&gt;9.5.5 &lt;/span&gt;Ports and garbage collection&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#broadcasting-to-other-browsing-contexts&gt;&lt;span class=secno&gt;9.6 &lt;/span&gt;Broadcasting to other browsing contexts&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=#workers&gt;&lt;span class=secno&gt;10 &lt;/span&gt;Web workers&lt;/a&gt;
   &lt;ol&gt;
    &lt;li&gt;&lt;a href=#introduction-11&gt;&lt;span class=secno&gt;10.1 &lt;/span&gt;Introduction&lt;/a&gt;
@@ -77896,7 +77897,7 @@
   &lt;h3 id=event-definitions-2&gt;&lt;span class=secno&gt;9.1 &lt;/span&gt;Event definitions&lt;/h3&gt;
 
   &lt;p&gt;Messages in &lt;a href=#server-sent-events&gt;server-sent events&lt;/a&gt;, &lt;a href=#network&gt;Web sockets&lt;/a&gt;, &lt;a href=#web-messaging&gt;cross-document
-  messaging&lt;/a&gt;, and &lt;a href=#channel-messaging&gt;channel messaging&lt;/a&gt; use the &lt;dfn id=event-message title=event-message&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt; event. &lt;/p&gt;
+  messaging&lt;/a&gt;, &lt;a href=#channel-messaging&gt;channel messaging&lt;/a&gt;, and &lt;a href=#broadcasting-to-other-browsing-contexts&gt;broadcast channels&lt;/a&gt; use the &lt;dfn id=event-message title=event-message&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt; event. &lt;/p&gt;
 
   &lt;p&gt;The following interface is defined for this event:&lt;/p&gt;
 
@@ -77905,6 +77906,7 @@
   readonly attribute any &lt;a href=#dom-messageevent-data title=dom-MessageEvent-data&gt;data&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-messageevent-origin title=dom-MessageEvent-origin&gt;origin&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-messageevent-lasteventid title=dom-MessageEvent-lastEventId&gt;lastEventId&lt;/a&gt;;
+  readonly attribute DOMString &lt;a href=#dom-messageevent-channel title=dom-MessageEvent-channel&gt;channel&lt;/a&gt;;
   readonly attribute (&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt; or &lt;a href=#messageport&gt;MessagePort&lt;/a&gt;)? &lt;a href=#dom-messageevent-source title=dom-MessageEvent-source&gt;source&lt;/a&gt;;
   readonly attribute &lt;a href=#messageport&gt;MessagePort&lt;/a&gt;[]? &lt;a href=#dom-messageevent-ports title=dom-MessageEvent-ports&gt;ports&lt;/a&gt;;
 };
@@ -77913,6 +77915,7 @@
   any data;
   DOMString origin;
   DOMString lastEventId;
+  DOMString channel;
   (&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt; or &lt;a href=#messageport&gt;MessagePort&lt;/a&gt;)? source;
   sequence&lt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&gt; ports;
 };&lt;/pre&gt;
@@ -77943,6 +77946,14 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;event&lt;/var&gt; . &lt;code title=dom-MessageEvent-channel&gt;&lt;a href=#dom-messageevent-channel&gt;channel&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns the channel ID, for &lt;a href=#broadcasting-to-other-browsing-contexts&gt;broadcast channels&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;event&lt;/var&gt; . &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -77978,6 +77989,10 @@
   return the value it was initialized to. When the object is created, this attribute must be
   initialized to the empty string. It represents, in &lt;a href=#server-sent-events&gt;server-sent events&lt;/a&gt;, the &lt;a href=#concept-event-stream-last-event-id title=concept-event-stream-last-event-id&gt;last event ID string&lt;/a&gt; of the event source.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;dfn id=dom-messageevent-channel title=dom-MessageEvent-channel&gt;&lt;code&gt;channel&lt;/code&gt;&lt;/dfn&gt; attribute must return the
+  value it was initialized to. When the object is created, this attribute must be initialized to the
+  empty string. It represents, in &lt;a href=#broadcasting-to-other-browsing-contexts&gt;broadcast channels&lt;/a&gt;, the channel of the message.&lt;/p&gt;
+
   &lt;p&gt;The &lt;dfn id=dom-messageevent-source title=dom-MessageEvent-source&gt;&lt;code&gt;source&lt;/code&gt;&lt;/dfn&gt; attribute must return the
   value it was initialized to. When the object is created, this attribute must be initialized to
   null. It represents, in &lt;a href=#web-messaging&gt;cross-document messaging&lt;/a&gt;, the &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; of the
@@ -80589,7 +80604,181 @@
 &lt;!--POSTMSG--&gt;
 
 
+  &lt;h3 id=broadcasting-to-other-browsing-contexts&gt;&lt;span class=secno&gt;9.6 &lt;/span&gt;&lt;dfn title=&quot;broadcast channels&quot;&gt;Broadcasting to other browsing contexts&lt;/dfn&gt;&lt;/h3&gt;
 
+  &lt;p&gt;Pages on a single &lt;a href=#origin&gt;origin&lt;/a&gt; opened by the same user in the same user agent but in
+  different unrelated &lt;a href=#browsing-context title=&quot;browsing context&quot;&gt;browsing contexts&lt;/a&gt; sometimes need to
+  send notifications to each other, for example &quot;hey, the user logged in over here, check your
+  credentials again&quot;.&lt;/p&gt;
+
+  &lt;p&gt;For elaborate cases, e.g. to manage locking of shared state, to manage synchronisation of
+  resources between a server and multiple local clients, to share a &lt;code&gt;&lt;a href=#websocket&gt;WebSocket&lt;/a&gt;&lt;/code&gt;
+  connection with a remote host, and so forth, &lt;a href=#sharedworker title=SharedWorker&gt;shared workers&lt;/a&gt; are
+  the most appropriate solution.&lt;/p&gt;
+
+  &lt;p&gt;For simple cases, though, where a shared worker would be an unreasonable overhead, authors can
+  use the simple channel-based broadcast mechanism described in this section.&lt;/p&gt;
+
+  &lt;pre class=idl&gt;[&lt;a href=#dom-broadcastchannel title=dom-BroadcastChannel&gt;Constructor&lt;/a&gt;(DOMString channel)] interface &lt;dfn id=broadcastchannel&gt;BroadcastChannel&lt;/dfn&gt; {
+  void &lt;a href=#dom-broadcastchannel-postmessage title=dom-BroadcastChannel-postMessage&gt;postMessage&lt;/a&gt;(DOMString message);
+           attribute &lt;a href=#eventhandler&gt;EventHandler&lt;/a&gt; &lt;a href=#handler-broadcastchannel-onmessage title=handler-BroadcastChannel-onmessage&gt;onmessage&lt;/a&gt;;
+};&lt;/pre&gt;
+
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;broadcastChannel&lt;/var&gt; = new &lt;code title=dom-BroadcastChannel&gt;&lt;a href=#dom-broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;channel&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns a new &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object via which messages for the given channel can be sent and received.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;broadcastChannel&lt;/var&gt; . &lt;code title=dom-BroadcastChannel-postMessage&gt;&lt;a href=#dom-broadcastchannel-postmessage&gt;postMessage&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Sends the given message to other &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects set up for this channel.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;div class=impl&gt;
+
+  &lt;p&gt;A &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object has a &lt;dfn id=channel-name&gt;channel name&lt;/dfn&gt; and a
+  &lt;dfn id=broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/dfn&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-broadcastchannel title=dom-BroadcastChannel&gt;&lt;code&gt;BroadcastChannel()&lt;/code&gt;&lt;/dfn&gt; constructor, when
+  invoked, must create and return a &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object whose &lt;a href=#channel-name&gt;channel
+  name&lt;/a&gt; is the constructor's first argument, and whose &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt;
+  settings object&lt;/a&gt; is the &lt;a href=#incumbent-settings-object&gt;incumbent settings object&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-broadcastchannel-postmessage title=dom-BroadcastChannel-postMessage&gt;&lt;code&gt;postMessage()&lt;/code&gt;&lt;/dfn&gt; method,
+  when invoked on a &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; with an
+  argument &lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, must run the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;source settings&lt;/var&gt; be &lt;var title=&quot;&quot;&gt;source&lt;/var&gt;'s
+   &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;source channel&lt;/var&gt; be &lt;var title=&quot;&quot;&gt;source&lt;/var&gt;'s
+   &lt;a href=#channel-name&gt;channel name&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt; be a list of &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects that
+    match the folllowing criteria:&lt;/p&gt;
+
+    &lt;ul&gt;&lt;li&gt;&lt;p&gt;Their &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt; specifies a
+     &lt;a href=#responsible-document&gt;responsible document&lt;/a&gt; that is &lt;a href=#fully-active&gt;fully active&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Their &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt; specifies an
+     &lt;a href=#origin&gt;origin&lt;/a&gt; that is the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the &lt;a href=#origin&gt;origin&lt;/a&gt; specified
+     by &lt;var title=&quot;&quot;&gt;source settings&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Their &lt;a href=#channel-name&gt;channel name&lt;/a&gt; is a &lt;a href=#case-sensitive&gt;case-sensitive&lt;/a&gt; match for &lt;var title=&quot;&quot;&gt;source channel&lt;/var&gt;.&lt;/li&gt;
+
+    &lt;/ul&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Remove &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; from &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Sort &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt; such that:&lt;/p&gt;
+
+    &lt;ul&gt;&lt;li&gt;&lt;p&gt;All &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify the same
+     &lt;a href=#responsible-document&gt;responsible document&lt;/a&gt; must be sorted in creation order, oldest first.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;All &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify a &lt;a href=#responsible-document&gt;responsible
+     document&lt;/a&gt; contained within a particular &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; must be
+     sorted in the same relative order as the order that those &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; objects are
+     listed in the &lt;a href=#list-of-the-descendant-browsing-contexts&gt;list of the descendant browsing contexts&lt;/a&gt; for the &lt;a href=#active-document&gt;active
+     document&lt;/a&gt; of that &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;All &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify a &lt;a href=#responsible-document&gt;responsible
+     document&lt;/a&gt; whose &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; is an &lt;a href=#auxiliary-browsing-context&gt;auxiliary browsing
+     context&lt;/a&gt; &lt;var title=&quot;&quot;&gt;X&lt;/var&gt; must come &lt;em&gt;after&lt;/em&gt; the
+     &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify a &lt;a href=#responsible-document&gt;responsible
+     document&lt;/a&gt; whose &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; is &lt;var title=&quot;&quot;&gt;X&lt;/var&gt;'s
+     &lt;a href=#opener-browsing-context&gt;opener browsing context&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/ul&gt;&lt;p&gt;This does not define a complete ordering. Within the constraints described above, user agents
+    may sort the list in any user-agent defined manner.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;For each &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object in &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt;,
+    &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that runs the following steps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Create an event that uses the &lt;code&gt;&lt;a href=#messageevent&gt;MessageEvent&lt;/a&gt;&lt;/code&gt; interface, with the event type
+     &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt;, which does not bubble, is not cancelable, and has
+     no default action. The &lt;code title=dom-MessageEvent-data&gt;&lt;a href=#dom-messageevent-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute must be
+     initialized to the value of the &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; argument, the &lt;code title=dom-MessageEvent-origin&gt;&lt;a href=#dom-messageevent-origin&gt;origin&lt;/a&gt;&lt;/code&gt; attribute must be initialized to the &lt;a href=#unicode-serialization-of-an-origin title=&quot;Unicode serialization of an origin&quot;&gt;Unicode serialization&lt;/a&gt; of the
+     &lt;a href=#origin&gt;origin&lt;/a&gt; specified by &lt;var title=&quot;&quot;&gt;source settings&lt;/var&gt;, and the &lt;code title=dom-MessageEvent-channel&gt;&lt;a href=#dom-messageevent-channel&gt;channel&lt;/a&gt;&lt;/code&gt; attribute must be initialized to the &lt;var title=&quot;&quot;&gt;channel name&lt;/var&gt;. This event is not &lt;a href=#concept-events-trusted title=concept-events-trusted&gt;trusted&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;a href=#concept-event-dispatch title=concept-event-dispatch&gt;Dispatch&lt;/a&gt; the event at the
+     &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;p&gt;The &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; must be associated with the &lt;a href=#responsible-document&gt;responsible
+    document&lt;/a&gt; specified by the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object's
+    &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt;, and must use the &lt;a href=#dom-manipulation-task-source&gt;DOM
+    manipulation task source&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;While a &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object has an event listener registered for &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt; events, there must be a strong reference from &lt;a href=#global-object&gt;global
+  object&lt;/a&gt; specified by the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object's
+  &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt; to the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;
+  object itself.&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;The following are the &lt;a href=#event-handlers&gt;event handlers&lt;/a&gt; (and their corresponding &lt;a href=#event-handler-event-type title=&quot;event
+  handler event type&quot;&gt;event handler event types&lt;/a&gt;) that must be supported, as &lt;a href=#event-handler-idl-attributes&gt;event
+  handler IDL attributes&lt;/a&gt;, by all objects implementing the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;
+  interface:&lt;/p&gt;
+
+  &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;Event handler&lt;/a&gt; &lt;th&gt;&lt;a href=#event-handler-event-type&gt;Event handler event type&lt;/a&gt;
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-broadcastchannel-onmessage title=handler-BroadcastChannel-onmessage&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt;
+  &lt;/table&gt;&lt;/div&gt;
+
+  &lt;p class=note&gt;Authors are strongly encouraged to explicitly close &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt;
+  objects to disentangle them, so that their resources can be recollected. Creating many
+  &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; objects and discarding them without closing them can lead to high
+  transient memory usage since garbage collection is not necessarily performed promptly.&lt;/p&gt;
+
+  &lt;div class=example&gt;
+
+   &lt;p&gt;Suppose a page wants to know when the user logs out, even when the user does so from another
+   tab at the same site:&lt;/p&gt;
+
+   &lt;pre&gt;var authChannel = new BroadcastChannel('auth');
+authChannel.onmessage = function (event) {
+  if (event.data == 'logout')
+    showLogout();
+}
+
+function logoutRequested() {
+  // called when the user asks us to log them out
+  doLogout();
+  showLogout();
+  authChannel.postMessage('logout');
+}
+
+function doLogout() {
+  // actually log the user out (e.g. clearing cookies)
+  // ...
+}
+
+function showLogout() {
+  // update the UI to indicate we're logged out
+  // ...
+}&lt;/pre&gt;
+
+  &lt;/div&gt;
+
+
+
 &lt;!--ADD-TOPIC:Workers--&gt;
 
   &lt;h2 id=workers&gt;&lt;span class=secno&gt;10 &lt;/span&gt;Web workers&lt;/h2&gt;
@@ -100514,6 +100703,7 @@
    &lt;li&gt;&lt;code&gt;&lt;a href=#audiotracklist&gt;AudioTrackList&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#barprop&gt;BarProp&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#beforeunloadevent&gt;BeforeUnloadEvent&lt;/a&gt;&lt;/code&gt;
+   &lt;li&gt;&lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#canvasdrawingstyles&gt;CanvasDrawingStyles&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#canvasgradient&gt;CanvasGradient&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#canvaspathmethods&gt;CanvasPathMethods&lt;/a&gt;&lt;/code&gt;

Modified: index
===================================================================
--- index	2013-11-12 21:53:05 UTC (rev 8273)
+++ index	2013-11-13 19:09:31 UTC (rev 8274)
@@ -298,7 +298,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> class=logo&gt;&lt;img width=101 src=/images/logo alt=WHATWG height=101&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1 class=allcaps&gt;HTML&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 12 November 2013&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Living Standard &mdash; Last Updated 13 November 2013&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;dl&gt;&lt;dt&gt;&lt;strong&gt;Web developer edition:&lt;/strong&gt;&lt;/dt&gt;
     &lt;dd&gt;&lt;strong&gt;&lt;a href=<A HREF="http://developers.whatwg.org/">http://developers.whatwg.org/</A>&gt;<A HREF="http://developers.whatwg.org/&lt;/a">http://developers.whatwg.org/&lt;/a</A>&gt;&lt;/strong&gt;&lt;/dd&gt;
     &lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -1142,7 +1142,8 @@
      &lt;li&gt;&lt;a href=#message-channels&gt;&lt;span class=secno&gt;9.5.2 &lt;/span&gt;Message channels&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#message-ports&gt;&lt;span class=secno&gt;9.5.3 &lt;/span&gt;Message ports&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#broadcasting-to-many-ports&gt;&lt;span class=secno&gt;9.5.4 &lt;/span&gt;Broadcasting to many ports&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#ports-and-garbage-collection&gt;&lt;span class=secno&gt;9.5.5 &lt;/span&gt;Ports and garbage collection&lt;/a&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#ports-and-garbage-collection&gt;&lt;span class=secno&gt;9.5.5 &lt;/span&gt;Ports and garbage collection&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;a href=#broadcasting-to-other-browsing-contexts&gt;&lt;span class=secno&gt;9.6 &lt;/span&gt;Broadcasting to other browsing contexts&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=#workers&gt;&lt;span class=secno&gt;10 &lt;/span&gt;Web workers&lt;/a&gt;
   &lt;ol&gt;
    &lt;li&gt;&lt;a href=#introduction-11&gt;&lt;span class=secno&gt;10.1 &lt;/span&gt;Introduction&lt;/a&gt;
@@ -77896,7 +77897,7 @@
   &lt;h3 id=event-definitions-2&gt;&lt;span class=secno&gt;9.1 &lt;/span&gt;Event definitions&lt;/h3&gt;
 
   &lt;p&gt;Messages in &lt;a href=#server-sent-events&gt;server-sent events&lt;/a&gt;, &lt;a href=#network&gt;Web sockets&lt;/a&gt;, &lt;a href=#web-messaging&gt;cross-document
-  messaging&lt;/a&gt;, and &lt;a href=#channel-messaging&gt;channel messaging&lt;/a&gt; use the &lt;dfn id=event-message title=event-message&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt; event. &lt;/p&gt;
+  messaging&lt;/a&gt;, &lt;a href=#channel-messaging&gt;channel messaging&lt;/a&gt;, and &lt;a href=#broadcasting-to-other-browsing-contexts&gt;broadcast channels&lt;/a&gt; use the &lt;dfn id=event-message title=event-message&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt; event. &lt;/p&gt;
 
   &lt;p&gt;The following interface is defined for this event:&lt;/p&gt;
 
@@ -77905,6 +77906,7 @@
   readonly attribute any &lt;a href=#dom-messageevent-data title=dom-MessageEvent-data&gt;data&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-messageevent-origin title=dom-MessageEvent-origin&gt;origin&lt;/a&gt;;
   readonly attribute DOMString &lt;a href=#dom-messageevent-lasteventid title=dom-MessageEvent-lastEventId&gt;lastEventId&lt;/a&gt;;
+  readonly attribute DOMString &lt;a href=#dom-messageevent-channel title=dom-MessageEvent-channel&gt;channel&lt;/a&gt;;
   readonly attribute (&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt; or &lt;a href=#messageport&gt;MessagePort&lt;/a&gt;)? &lt;a href=#dom-messageevent-source title=dom-MessageEvent-source&gt;source&lt;/a&gt;;
   readonly attribute &lt;a href=#messageport&gt;MessagePort&lt;/a&gt;[]? &lt;a href=#dom-messageevent-ports title=dom-MessageEvent-ports&gt;ports&lt;/a&gt;;
 };
@@ -77913,6 +77915,7 @@
   any data;
   DOMString origin;
   DOMString lastEventId;
+  DOMString channel;
   (&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt; or &lt;a href=#messageport&gt;MessagePort&lt;/a&gt;)? source;
   sequence&lt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&gt; ports;
 };&lt;/pre&gt;
@@ -77943,6 +77946,14 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;event&lt;/var&gt; . &lt;code title=dom-MessageEvent-channel&gt;&lt;a href=#dom-messageevent-channel&gt;channel&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns the channel ID, for &lt;a href=#broadcasting-to-other-browsing-contexts&gt;broadcast channels&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var title=&quot;&quot;&gt;event&lt;/var&gt; . &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -77978,6 +77989,10 @@
   return the value it was initialized to. When the object is created, this attribute must be
   initialized to the empty string. It represents, in &lt;a href=#server-sent-events&gt;server-sent events&lt;/a&gt;, the &lt;a href=#concept-event-stream-last-event-id title=concept-event-stream-last-event-id&gt;last event ID string&lt;/a&gt; of the event source.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;dfn id=dom-messageevent-channel title=dom-MessageEvent-channel&gt;&lt;code&gt;channel&lt;/code&gt;&lt;/dfn&gt; attribute must return the
+  value it was initialized to. When the object is created, this attribute must be initialized to the
+  empty string. It represents, in &lt;a href=#broadcasting-to-other-browsing-contexts&gt;broadcast channels&lt;/a&gt;, the channel of the message.&lt;/p&gt;
+
   &lt;p&gt;The &lt;dfn id=dom-messageevent-source title=dom-MessageEvent-source&gt;&lt;code&gt;source&lt;/code&gt;&lt;/dfn&gt; attribute must return the
   value it was initialized to. When the object is created, this attribute must be initialized to
   null. It represents, in &lt;a href=#web-messaging&gt;cross-document messaging&lt;/a&gt;, the &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; of the
@@ -80589,7 +80604,181 @@
 &lt;!--POSTMSG--&gt;
 
 
+  &lt;h3 id=broadcasting-to-other-browsing-contexts&gt;&lt;span class=secno&gt;9.6 &lt;/span&gt;&lt;dfn title=&quot;broadcast channels&quot;&gt;Broadcasting to other browsing contexts&lt;/dfn&gt;&lt;/h3&gt;
 
+  &lt;p&gt;Pages on a single &lt;a href=#origin&gt;origin&lt;/a&gt; opened by the same user in the same user agent but in
+  different unrelated &lt;a href=#browsing-context title=&quot;browsing context&quot;&gt;browsing contexts&lt;/a&gt; sometimes need to
+  send notifications to each other, for example &quot;hey, the user logged in over here, check your
+  credentials again&quot;.&lt;/p&gt;
+
+  &lt;p&gt;For elaborate cases, e.g. to manage locking of shared state, to manage synchronisation of
+  resources between a server and multiple local clients, to share a &lt;code&gt;&lt;a href=#websocket&gt;WebSocket&lt;/a&gt;&lt;/code&gt;
+  connection with a remote host, and so forth, &lt;a href=#sharedworker title=SharedWorker&gt;shared workers&lt;/a&gt; are
+  the most appropriate solution.&lt;/p&gt;
+
+  &lt;p&gt;For simple cases, though, where a shared worker would be an unreasonable overhead, authors can
+  use the simple channel-based broadcast mechanism described in this section.&lt;/p&gt;
+
+  &lt;pre class=idl&gt;[&lt;a href=#dom-broadcastchannel title=dom-BroadcastChannel&gt;Constructor&lt;/a&gt;(DOMString channel)] interface &lt;dfn id=broadcastchannel&gt;BroadcastChannel&lt;/dfn&gt; {
+  void &lt;a href=#dom-broadcastchannel-postmessage title=dom-BroadcastChannel-postMessage&gt;postMessage&lt;/a&gt;(DOMString message);
+           attribute &lt;a href=#eventhandler&gt;EventHandler&lt;/a&gt; &lt;a href=#handler-broadcastchannel-onmessage title=handler-BroadcastChannel-onmessage&gt;onmessage&lt;/a&gt;;
+};&lt;/pre&gt;
+
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;broadcastChannel&lt;/var&gt; = new &lt;code title=dom-BroadcastChannel&gt;&lt;a href=#dom-broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;channel&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns a new &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object via which messages for the given channel can be sent and received.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;broadcastChannel&lt;/var&gt; . &lt;code title=dom-BroadcastChannel-postMessage&gt;&lt;a href=#dom-broadcastchannel-postmessage&gt;postMessage&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Sends the given message to other &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects set up for this channel.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;div class=impl&gt;
+
+  &lt;p&gt;A &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object has a &lt;dfn id=channel-name&gt;channel name&lt;/dfn&gt; and a
+  &lt;dfn id=broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/dfn&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-broadcastchannel title=dom-BroadcastChannel&gt;&lt;code&gt;BroadcastChannel()&lt;/code&gt;&lt;/dfn&gt; constructor, when
+  invoked, must create and return a &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object whose &lt;a href=#channel-name&gt;channel
+  name&lt;/a&gt; is the constructor's first argument, and whose &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt;
+  settings object&lt;/a&gt; is the &lt;a href=#incumbent-settings-object&gt;incumbent settings object&lt;/a&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn id=dom-broadcastchannel-postmessage title=dom-BroadcastChannel-postMessage&gt;&lt;code&gt;postMessage()&lt;/code&gt;&lt;/dfn&gt; method,
+  when invoked on a &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; with an
+  argument &lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, must run the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;source settings&lt;/var&gt; be &lt;var title=&quot;&quot;&gt;source&lt;/var&gt;'s
+   &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;source channel&lt;/var&gt; be &lt;var title=&quot;&quot;&gt;source&lt;/var&gt;'s
+   &lt;a href=#channel-name&gt;channel name&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt; be a list of &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects that
+    match the folllowing criteria:&lt;/p&gt;
+
+    &lt;ul&gt;&lt;li&gt;&lt;p&gt;Their &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt; specifies a
+     &lt;a href=#responsible-document&gt;responsible document&lt;/a&gt; that is &lt;a href=#fully-active&gt;fully active&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Their &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt; specifies an
+     &lt;a href=#origin&gt;origin&lt;/a&gt; that is the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the &lt;a href=#origin&gt;origin&lt;/a&gt; specified
+     by &lt;var title=&quot;&quot;&gt;source settings&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Their &lt;a href=#channel-name&gt;channel name&lt;/a&gt; is a &lt;a href=#case-sensitive&gt;case-sensitive&lt;/a&gt; match for &lt;var title=&quot;&quot;&gt;source channel&lt;/var&gt;.&lt;/li&gt;
+
+    &lt;/ul&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Remove &lt;var title=&quot;&quot;&gt;source&lt;/var&gt; from &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Sort &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt; such that:&lt;/p&gt;
+
+    &lt;ul&gt;&lt;li&gt;&lt;p&gt;All &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify the same
+     &lt;a href=#responsible-document&gt;responsible document&lt;/a&gt; must be sorted in creation order, oldest first.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;All &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify a &lt;a href=#responsible-document&gt;responsible
+     document&lt;/a&gt; contained within a particular &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; must be
+     sorted in the same relative order as the order that those &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; objects are
+     listed in the &lt;a href=#list-of-the-descendant-browsing-contexts&gt;list of the descendant browsing contexts&lt;/a&gt; for the &lt;a href=#active-document&gt;active
+     document&lt;/a&gt; of that &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;All &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify a &lt;a href=#responsible-document&gt;responsible
+     document&lt;/a&gt; whose &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; is an &lt;a href=#auxiliary-browsing-context&gt;auxiliary browsing
+     context&lt;/a&gt; &lt;var title=&quot;&quot;&gt;X&lt;/var&gt; must come &lt;em&gt;after&lt;/em&gt; the
+     &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; objects whose &lt;a href=#broadcastchannel-settings-object title=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/a&gt; specify a &lt;a href=#responsible-document&gt;responsible
+     document&lt;/a&gt; whose &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; is &lt;var title=&quot;&quot;&gt;X&lt;/var&gt;'s
+     &lt;a href=#opener-browsing-context&gt;opener browsing context&lt;/a&gt;.&lt;/p&gt;
+
+    &lt;/ul&gt;&lt;p&gt;This does not define a complete ordering. Within the constraints described above, user agents
+    may sort the list in any user-agent defined manner.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;For each &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object in &lt;var title=&quot;&quot;&gt;destinations&lt;/var&gt;,
+    &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that runs the following steps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Create an event that uses the &lt;code&gt;&lt;a href=#messageevent&gt;MessageEvent&lt;/a&gt;&lt;/code&gt; interface, with the event type
+     &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt;, which does not bubble, is not cancelable, and has
+     no default action. The &lt;code title=dom-MessageEvent-data&gt;&lt;a href=#dom-messageevent-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute must be
+     initialized to the value of the &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; argument, the &lt;code title=dom-MessageEvent-origin&gt;&lt;a href=#dom-messageevent-origin&gt;origin&lt;/a&gt;&lt;/code&gt; attribute must be initialized to the &lt;a href=#unicode-serialization-of-an-origin title=&quot;Unicode serialization of an origin&quot;&gt;Unicode serialization&lt;/a&gt; of the
+     &lt;a href=#origin&gt;origin&lt;/a&gt; specified by &lt;var title=&quot;&quot;&gt;source settings&lt;/var&gt;, and the &lt;code title=dom-MessageEvent-channel&gt;&lt;a href=#dom-messageevent-channel&gt;channel&lt;/a&gt;&lt;/code&gt; attribute must be initialized to the &lt;var title=&quot;&quot;&gt;channel name&lt;/var&gt;. This event is not &lt;a href=#concept-events-trusted title=concept-events-trusted&gt;trusted&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;a href=#concept-event-dispatch title=concept-event-dispatch&gt;Dispatch&lt;/a&gt; the event at the
+     &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;p&gt;The &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; must be associated with the &lt;a href=#responsible-document&gt;responsible
+    document&lt;/a&gt; specified by the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object's
+    &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt;, and must use the &lt;a href=#dom-manipulation-task-source&gt;DOM
+    manipulation task source&lt;/a&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;&lt;p&gt;While a &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object has an event listener registered for &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt; events, there must be a strong reference from &lt;a href=#global-object&gt;global
+  object&lt;/a&gt; specified by the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt; object's
+  &lt;a href=#broadcastchannel-settings-object&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/a&gt; to the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;
+  object itself.&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;The following are the &lt;a href=#event-handlers&gt;event handlers&lt;/a&gt; (and their corresponding &lt;a href=#event-handler-event-type title=&quot;event
+  handler event type&quot;&gt;event handler event types&lt;/a&gt;) that must be supported, as &lt;a href=#event-handler-idl-attributes&gt;event
+  handler IDL attributes&lt;/a&gt;, by all objects implementing the &lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;
+  interface:&lt;/p&gt;
+
+  &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;a href=#event-handlers title=&quot;event handlers&quot;&gt;Event handler&lt;/a&gt; &lt;th&gt;&lt;a href=#event-handler-event-type&gt;Event handler event type&lt;/a&gt;
+   &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-broadcastchannel-onmessage title=handler-BroadcastChannel-onmessage&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt;
+  &lt;/table&gt;&lt;/div&gt;
+
+  &lt;p class=note&gt;Authors are strongly encouraged to explicitly close &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt;
+  objects to disentangle them, so that their resources can be recollected. Creating many
+  &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; objects and discarding them without closing them can lead to high
+  transient memory usage since garbage collection is not necessarily performed promptly.&lt;/p&gt;
+
+  &lt;div class=example&gt;
+
+   &lt;p&gt;Suppose a page wants to know when the user logs out, even when the user does so from another
+   tab at the same site:&lt;/p&gt;
+
+   &lt;pre&gt;var authChannel = new BroadcastChannel('auth');
+authChannel.onmessage = function (event) {
+  if (event.data == 'logout')
+    showLogout();
+}
+
+function logoutRequested() {
+  // called when the user asks us to log them out
+  doLogout();
+  showLogout();
+  authChannel.postMessage('logout');
+}
+
+function doLogout() {
+  // actually log the user out (e.g. clearing cookies)
+  // ...
+}
+
+function showLogout() {
+  // update the UI to indicate we're logged out
+  // ...
+}&lt;/pre&gt;
+
+  &lt;/div&gt;
+
+
+
 &lt;!--ADD-TOPIC:Workers--&gt;
 
   &lt;h2 id=workers&gt;&lt;span class=secno&gt;10 &lt;/span&gt;Web workers&lt;/h2&gt;
@@ -100514,6 +100703,7 @@
    &lt;li&gt;&lt;code&gt;&lt;a href=#audiotracklist&gt;AudioTrackList&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#barprop&gt;BarProp&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#beforeunloadevent&gt;BeforeUnloadEvent&lt;/a&gt;&lt;/code&gt;
+   &lt;li&gt;&lt;code&gt;&lt;a href=#broadcastchannel&gt;BroadcastChannel&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#canvasdrawingstyles&gt;CanvasDrawingStyles&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#canvasgradient&gt;CanvasGradient&lt;/a&gt;&lt;/code&gt;
    &lt;li&gt;&lt;code&gt;&lt;a href=#canvaspathmethods&gt;CanvasPathMethods&lt;/a&gt;&lt;/code&gt;

Modified: source
===================================================================
--- source	2013-11-12 21:53:05 UTC (rev 8273)
+++ source	2013-11-13 19:09:31 UTC (rev 8274)
@@ -87215,7 +87215,7 @@
   &lt;h3&gt;Event definitions&lt;/h3&gt;
 
   &lt;p&gt;Messages in &lt;span&gt;server-sent events&lt;/span&gt;, &lt;span&gt;Web sockets&lt;/span&gt;, &lt;span&gt;cross-document
-  messaging&lt;/span&gt;, and &lt;span&gt;channel messaging&lt;/span&gt; use the &lt;dfn
+  messaging&lt;/span&gt;, &lt;span&gt;channel messaging&lt;/span&gt;, and &lt;span&gt;broadcast channels&lt;/span&gt; use the &lt;dfn
   data-x=&quot;event-message&quot;&gt;&lt;code&gt;message&lt;/code&gt;&lt;/dfn&gt; event. &lt;/p&gt;
 
   &lt;p&gt;The following interface is defined for this event:&lt;/p&gt;
@@ -87225,6 +87225,7 @@
   readonly attribute any &lt;span data-x=&quot;dom-MessageEvent-data&quot;&gt;data&lt;/span&gt;;
   readonly attribute DOMString &lt;span data-x=&quot;dom-MessageEvent-origin&quot;&gt;origin&lt;/span&gt;;
   readonly attribute DOMString &lt;span data-x=&quot;dom-MessageEvent-lastEventId&quot;&gt;lastEventId&lt;/span&gt;;
+  readonly attribute DOMString &lt;span data-x=&quot;dom-MessageEvent-channel&quot;&gt;channel&lt;/span&gt;;
   readonly attribute (&lt;span&gt;WindowProxy&lt;/span&gt; or &lt;span&gt;MessagePort&lt;/span&gt;)? &lt;span data-x=&quot;dom-MessageEvent-source&quot;&gt;source&lt;/span&gt;;
   readonly attribute &lt;span&gt;MessagePort&lt;/span&gt;[]? &lt;span data-x=&quot;dom-MessageEvent-ports&quot;&gt;ports&lt;/span&gt;;
 };
@@ -87233,6 +87234,7 @@
   any data;
   DOMString origin;
   DOMString lastEventId;
+  DOMString channel;
   (&lt;span&gt;WindowProxy&lt;/span&gt; or &lt;span&gt;MessagePort&lt;/span&gt;)? source;
   sequence&lt;&lt;span&gt;MessagePort&lt;/span&gt;&gt; ports;
 };&lt;/pre&gt;
@@ -87265,6 +87267,14 @@
 
    &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var data-x=&quot;&quot;&gt;event&lt;/var&gt; . &lt;code data-x=&quot;dom-MessageEvent-channel&quot;&gt;channel&lt;/code&gt;&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns the channel ID, for &lt;span&gt;broadcast channels&lt;/span&gt;.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
    &lt;dt&gt;&lt;var data-x=&quot;&quot;&gt;event&lt;/var&gt; . &lt;code data-x=&quot;dom-MessageEvent-source&quot;&gt;source&lt;/code&gt;&lt;/dt&gt;
 
    &lt;dd&gt;
@@ -87304,6 +87314,10 @@
   initialized to the empty string. It represents, in &lt;span&gt;server-sent events&lt;/span&gt;, the &lt;span
   data-x=&quot;concept-event-stream-last-event-id&quot;&gt;last event ID string&lt;/span&gt; of the event source.&lt;/p&gt;
 
+  &lt;p&gt;The &lt;dfn data-x=&quot;dom-MessageEvent-channel&quot;&gt;&lt;code&gt;channel&lt;/code&gt;&lt;/dfn&gt; attribute must return the
+  value it was initialized to. When the object is created, this attribute must be initialized to the
+  empty string. It represents, in &lt;span&gt;broadcast channels&lt;/span&gt;, the channel of the message.&lt;/p&gt;
+
   &lt;p&gt;The &lt;dfn data-x=&quot;dom-MessageEvent-source&quot;&gt;&lt;code&gt;source&lt;/code&gt;&lt;/dfn&gt; attribute must return the
   value it was initialized to. When the object is created, this attribute must be initialized to
   null. It represents, in &lt;span&gt;cross-document messaging&lt;/span&gt;, the &lt;code&gt;WindowProxy&lt;/code&gt; of the
@@ -90322,7 +90336,215 @@
 &lt;!--END postmsg--&gt;&lt;!--POSTMSG--&gt;
 
 
+  &lt;h3&gt;&lt;dfn data-x=&quot;broadcast channels&quot;&gt;Broadcasting to other browsing contexts&lt;/dfn&gt;&lt;/h3&gt;
 
+  &lt;p&gt;Pages on a single &lt;span&gt;origin&lt;/span&gt; opened by the same user in the same user agent but in
+  different unrelated &lt;span data-x=&quot;browsing context&quot;&gt;browsing contexts&lt;/span&gt; sometimes need to
+  send notifications to each other, for example &quot;hey, the user logged in over here, check your
+  credentials again&quot;.&lt;/p&gt;
+
+  &lt;p&gt;For elaborate cases, e.g. to manage locking of shared state, to manage synchronisation of
+  resources between a server and multiple local clients, to share a &lt;code&gt;WebSocket&lt;/code&gt;
+  connection with a remote host, and so forth, &lt;span data-x=&quot;SharedWorker&quot;&gt;shared workers&lt;/span&gt; are
+  the most appropriate solution.&lt;/p&gt;
+
+  &lt;p&gt;For simple cases, though, where a shared worker would be an unreasonable overhead, authors can
+  use the simple channel-based broadcast mechanism described in this section.&lt;/p&gt;
+
+  &lt;pre class=&quot;idl&quot;&gt;[&lt;span data-x=&quot;dom-BroadcastChannel&quot;&gt;Constructor&lt;/span&gt;(DOMString channel)] interface &lt;dfn&gt;BroadcastChannel&lt;/dfn&gt; {
+  void &lt;span data-x=&quot;dom-BroadcastChannel-postMessage&quot;&gt;postMessage&lt;/span&gt;(DOMString message);
+           attribute &lt;span&gt;EventHandler&lt;/span&gt; &lt;span data-x=&quot;handler-BroadcastChannel-onmessage&quot;&gt;onmessage&lt;/span&gt;;
+};&lt;/pre&gt;
+
+  &lt;dl class=&quot;domintro&quot;&gt;
+
+   &lt;dt&gt;&lt;var data-x=&quot;&quot;&gt;broadcastChannel&lt;/var&gt; = new &lt;code data-x=&quot;dom-BroadcastChannel&quot;&gt;BroadcastChannel&lt;/code&gt;(&lt;var data-x=&quot;&quot;&gt;channel&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Returns a new &lt;code&gt;BroadcastChannel&lt;/code&gt; object via which messages for the given channel can be sent and received.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var data-x=&quot;&quot;&gt;broadcastChannel&lt;/var&gt; . &lt;code data-x=&quot;dom-BroadcastChannel-postMessage&quot;&gt;postMessage&lt;/code&gt;(&lt;var data-x=&quot;&quot;&gt;message&lt;/var&gt;)&lt;/dt&gt;
+
+   &lt;dd&gt;
+
+    &lt;p&gt;Sends the given message to other &lt;code&gt;BroadcastChannel&lt;/code&gt; objects set up for this channel.&lt;/p&gt;
+
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+  &lt;div class=&quot;impl&quot;&gt;
+
+  &lt;p&gt;A &lt;code&gt;BroadcastChannel&lt;/code&gt; object has a &lt;dfn&gt;channel name&lt;/dfn&gt; and a
+  &lt;dfn&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/dfn&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn data-x=&quot;dom-BroadcastChannel&quot;&gt;&lt;code&gt;BroadcastChannel()&lt;/code&gt;&lt;/dfn&gt; constructor, when
+  invoked, must create and return a &lt;code&gt;BroadcastChannel&lt;/code&gt; object whose &lt;span&gt;channel
+  name&lt;/span&gt; is the constructor's first argument, and whose &lt;span&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt;
+  settings object&lt;/span&gt; is the &lt;span&gt;incumbent settings object&lt;/span&gt;.&lt;/p&gt;
+
+  &lt;p&gt;The &lt;dfn data-x=&quot;dom-BroadcastChannel-postMessage&quot;&gt;&lt;code&gt;postMessage()&lt;/code&gt;&lt;/dfn&gt; method,
+  when invoked on a &lt;code&gt;BroadcastChannel&lt;/code&gt; object &lt;var data-x=&quot;&quot;&gt;source&lt;/var&gt; with an
+  argument &lt;var data-x=&quot;&quot;&gt;message&lt;/var&gt;, must run the following steps:&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var data-x=&quot;&quot;&gt;source settings&lt;/var&gt; be &lt;var data-x=&quot;&quot;&gt;source&lt;/var&gt;'s
+   &lt;span&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/span&gt;.&lt;/p&gt;
+
+   &lt;li&gt;&lt;p&gt;Let &lt;var data-x=&quot;&quot;&gt;source channel&lt;/var&gt; be &lt;var data-x=&quot;&quot;&gt;source&lt;/var&gt;'s
+   &lt;span&gt;channel name&lt;/span&gt;.&lt;/p&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Let &lt;var data-x=&quot;&quot;&gt;destinations&lt;/var&gt; be a list of &lt;code&gt;BroadcastChannel&lt;/code&gt; objects that
+    match the folllowing criteria:&lt;/p&gt;
+
+    &lt;ul&gt;
+
+     &lt;li&gt;&lt;p&gt;Their &lt;span&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/span&gt; specifies a
+     &lt;span&gt;responsible document&lt;/span&gt; that is &lt;span&gt;fully active&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Their &lt;span&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/span&gt; specifies an
+     &lt;span&gt;origin&lt;/span&gt; that is the &lt;span&gt;same origin&lt;/span&gt; as the &lt;span&gt;origin&lt;/span&gt; specified
+     by &lt;var data-x=&quot;&quot;&gt;source settings&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Their &lt;span&gt;channel name&lt;/span&gt; is a &lt;span&gt;case-sensitive&lt;/span&gt; match for &lt;var
+     data-x=&quot;&quot;&gt;source channel&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ul&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Remove &lt;var data-x=&quot;&quot;&gt;source&lt;/var&gt; from &lt;var data-x=&quot;&quot;&gt;destinations&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;Sort &lt;var data-x=&quot;&quot;&gt;destinations&lt;/var&gt; such that:&lt;/p&gt;
+
+    &lt;ul&gt;
+
+     &lt;li&gt;&lt;p&gt;All &lt;code&gt;BroadcastChannel&lt;/code&gt; objects whose &lt;span data-x=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/span&gt; specify the same
+     &lt;span&gt;responsible document&lt;/span&gt; must be sorted in creation order, oldest first.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;All &lt;code&gt;BroadcastChannel&lt;/code&gt; objects whose &lt;span data-x=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/span&gt; specify a &lt;span&gt;responsible
+     document&lt;/span&gt; contained within a particular &lt;span&gt;top-level browsing context&lt;/span&gt; must be
+     sorted in the same relative order as the order that those &lt;code&gt;Document&lt;/code&gt; objects are
+     listed in the &lt;span&gt;list of the descendant browsing contexts&lt;/span&gt; for the &lt;span&gt;active
+     document&lt;/span&gt; of that &lt;span&gt;top-level browsing context&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;All &lt;code&gt;BroadcastChannel&lt;/code&gt; objects whose &lt;span data-x=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/span&gt; specify a &lt;span&gt;responsible
+     document&lt;/span&gt; whose &lt;span&gt;top-level browsing context&lt;/span&gt; is an &lt;span&gt;auxiliary browsing
+     context&lt;/span&gt; &lt;var data-x=&quot;&quot;&gt;X&lt;/var&gt; must come &lt;em&gt;after&lt;/em&gt; the
+     &lt;code&gt;BroadcastChannel&lt;/code&gt; objects whose &lt;span data-x=&quot;BroadcastChannel settings
+     object&quot;&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings objects&lt;/span&gt; specify a &lt;span&gt;responsible
+     document&lt;/span&gt; whose &lt;span&gt;top-level browsing context&lt;/span&gt; is &lt;var data-x=&quot;&quot;&gt;X&lt;/var&gt;'s
+     &lt;span&gt;opener browsing context&lt;/span&gt;.&lt;/p&gt;
+
+    &lt;/ul&gt;
+
+    &lt;p&gt;This does not define a complete ordering. Within the constraints described above, user agents
+    may sort the list in any user-agent defined manner.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;
+
+    &lt;p&gt;For each &lt;code&gt;BroadcastChannel&lt;/code&gt; object in &lt;var data-x=&quot;&quot;&gt;destinations&lt;/var&gt;,
+    &lt;span&gt;queue a task&lt;/span&gt; that runs the following steps:&lt;/p&gt;
+
+    &lt;ol&gt;
+
+     &lt;li&gt;&lt;p&gt;Create an event that uses the &lt;code&gt;MessageEvent&lt;/code&gt; interface, with the event type
+     &lt;code data-x=&quot;event-message&quot;&gt;message&lt;/code&gt;, which does not bubble, is not cancelable, and has
+     no default action. The &lt;code data-x=&quot;dom-MessageEvent-data&quot;&gt;data&lt;/code&gt; attribute must be
+     initialized to the value of the &lt;var data-x=&quot;&quot;&gt;message&lt;/var&gt; argument, the &lt;code
+     data-x=&quot;dom-MessageEvent-origin&quot;&gt;origin&lt;/code&gt; attribute must be initialized to the &lt;span
+     data-x=&quot;Unicode serialization of an origin&quot;&gt;Unicode serialization&lt;/span&gt; of the
+     &lt;span&gt;origin&lt;/span&gt; specified by &lt;var data-x=&quot;&quot;&gt;source settings&lt;/var&gt;, and the &lt;code
+     data-x=&quot;dom-MessageEvent-channel&quot;&gt;channel&lt;/code&gt; attribute must be initialized to the &lt;var
+     data-x=&quot;&quot;&gt;channel name&lt;/var&gt;. This event is not &lt;span
+     data-x=&quot;concept-events-trusted&quot;&gt;trusted&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;span data-x=&quot;concept-event-dispatch&quot;&gt;Dispatch&lt;/span&gt; the event at the
+     &lt;code&gt;BroadcastChannel&lt;/code&gt; object.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;
+
+    &lt;p&gt;The &lt;span data-x=&quot;concept-task&quot;&gt;tasks&lt;/span&gt; must be associated with the &lt;span&gt;responsible
+    document&lt;/span&gt; specified by the &lt;code&gt;BroadcastChannel&lt;/code&gt; object's
+    &lt;span&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/span&gt;, and must use the &lt;span&gt;DOM
+    manipulation task source&lt;/span&gt;.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;p&gt;While a &lt;code&gt;BroadcastChannel&lt;/code&gt; object has an event listener registered for &lt;code
+  data-x=&quot;event-message&quot;&gt;message&lt;/code&gt; events, there must be a strong reference from &lt;span&gt;global
+  object&lt;/span&gt; specified by the &lt;code&gt;BroadcastChannel&lt;/code&gt; object's
+  &lt;span&gt;&lt;code&gt;BroadcastChannel&lt;/code&gt; settings object&lt;/span&gt; to the &lt;code&gt;BroadcastChannel&lt;/code&gt;
+  object itself.&lt;/p&gt;
+
+  &lt;hr&gt;
+
+  &lt;p&gt;The following are the &lt;span&gt;event handlers&lt;/span&gt; (and their corresponding &lt;span data-x=&quot;event
+  handler event type&quot;&gt;event handler event types&lt;/span&gt;) that must be supported, as &lt;span&gt;event
+  handler IDL attributes&lt;/span&gt;, by all objects implementing the &lt;code&gt;BroadcastChannel&lt;/code&gt;
+  interface:&lt;/p&gt;
+
+  &lt;table&gt;
+   &lt;thead&gt;
+    &lt;tr&gt;&lt;th&gt;&lt;span data-x=&quot;event handlers&quot;&gt;Event handler&lt;/span&gt; &lt;th&gt;&lt;span&gt;Event handler event type&lt;/span&gt;
+   &lt;tbody&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn data-x=&quot;handler-BroadcastChannel-onmessage&quot;&gt;&lt;code&gt;onmessage&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code data-x=&quot;event-message&quot;&gt;message&lt;/code&gt;
+  &lt;/table&gt;
+
+  &lt;/div&gt;
+
+  &lt;p class=&quot;note&quot;&gt;Authors are strongly encouraged to explicitly close &lt;code&gt;MessagePort&lt;/code&gt;
+  objects to disentangle them, so that their resources can be recollected. Creating many
+  &lt;code&gt;MessagePort&lt;/code&gt; objects and discarding them without closing them can lead to high
+  transient memory usage since garbage collection is not necessarily performed promptly.&lt;/p&gt;
+
+  &lt;div class=&quot;example&quot;&gt;
+
+   &lt;p&gt;Suppose a page wants to know when the user logs out, even when the user does so from another
+   tab at the same site:&lt;/p&gt;
+
+   &lt;pre&gt;var authChannel = new BroadcastChannel('auth');
+authChannel.onmessage = function (event) {
+  if (event.data == 'logout')
+    showLogout();
+}
+
+function logoutRequested() {
+  // called when the user asks us to log them out
+  doLogout();
+  showLogout();
+  authChannel.postMessage('logout');
+}
+
+function doLogout() {
+  // actually log the user out (e.g. clearing cookies)
+  // ...
+}
+
+function showLogout() {
+  // update the UI to indicate we're logged out
+  // ...
+}&lt;/pre&gt;
+
+  &lt;/div&gt;
+
+
+
 &lt;!--ADD-TOPIC:Workers--&gt;
 
   &lt;h2 id=&quot;workers&quot;&gt;Web workers&lt;/h2&gt;


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015128.html">[html5] r8273 - [] (3) Remove security checks on Document since	there should now be no way to ge [...]
</A></li>
	<LI>Next message: <A HREF="015130.html">[html5] r8275 - [giow] (2) Make sandboxed iframes block	document.domain setting Fixing https://w [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15129">[ date ]</a>
              <a href="thread.html#15129">[ thread ]</a>
              <a href="subject.html#15129">[ subject ]</a>
              <a href="author.html#15129">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
