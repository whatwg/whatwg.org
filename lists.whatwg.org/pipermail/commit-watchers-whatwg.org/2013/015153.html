<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r8298 - [e] (0) Reword the concept of closing a WebSocket	with prejudice so that it's mo [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8298%20-%20%5Be%5D%20%280%29%20Reword%20the%20concept%20of%20closing%20a%20WebSocket%0A%09with%20prejudice%20so%20that%20it%27s%20mo%20%5B...%5D&In-Reply-To=%3C20131119211539.025411536CF7E%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015152.html">
   <LINK REL="Next"  HREF="015154.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r8298 - [e] (0) Reword the concept of closing a WebSocket	with prejudice so that it's mo [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r8298%20-%20%5Be%5D%20%280%29%20Reword%20the%20concept%20of%20closing%20a%20WebSocket%0A%09with%20prejudice%20so%20that%20it%27s%20mo%20%5B...%5D&In-Reply-To=%3C20131119211539.025411536CF7E%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r8298 - [e] (0) Reword the concept of closing a WebSocket	with prejudice so that it's mo [...]">whatwg at whatwg.org
       </A><BR>
    <I>Tue Nov 19 13:15:38 PST 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="015152.html">[html5] r8297 - [giow] (3) Move more towards the browsers for	&lt;option&gt; selectedness vs dirtiness [...]
</A></li>
        <LI>Next message: <A HREF="015154.html">[html5] r8299 - [c] (2) Remove the parts of the script content	model that could lead to unbalanc [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15153">[ date ]</a>
              <a href="thread.html#15153">[ thread ]</a>
              <a href="subject.html#15153">[ subject ]</a>
              <a href="author.html#15153">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2013-11-19 13:15:37 -0800 (Tue, 19 Nov 2013)
New Revision: 8298

Modified:
   complete.html
   index
   source
Log:
[e] (0) Reword the concept of closing a WebSocket with prejudice so that it's more obviously a flag
Fixing <A HREF="https://www.w3.org/Bugs/Public/show_bug.cgi?id=23601">https://www.w3.org/Bugs/Public/show_bug.cgi?id=23601</A>
Affected topics: HTML

Modified: complete.html
===================================================================
--- complete.html	2013-11-19 20:20:46 UTC (rev 8297)
+++ complete.html	2013-11-19 21:15:37 UTC (rev 8298)
@@ -79231,6 +79231,7 @@
   string &quot;&lt;code title=&quot;&quot;&gt;blob&lt;/code&gt;&quot;. On getting, it must return the last value it was set to. On
   setting, the user agent must set the IDL attribute to the new value.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p class=note&gt;This attribute allows authors to control how binary data is exposed to scripts. By
   setting the attribute to &quot;&lt;code title=&quot;&quot;&gt;blob&lt;/code&gt;&quot;, binary data is returned in
   &lt;code&gt;&lt;a href=#blob&gt;Blob&lt;/a&gt;&lt;/code&gt; form; by setting it to &quot;&lt;code title=&quot;&quot;&gt;arraybuffer&lt;/code&gt;&quot;, it is returned in
@@ -79252,13 +79253,15 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; be the result of &lt;a href=#convert-a-domstring-to-a-sequence-of-unicode-characters title=&quot;convert a DOMString to a sequence
     of Unicode characters&quot;&gt;converting the &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; argument to a sequence of Unicode
     characters&lt;/a&gt;. If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt; and &lt;i title=&quot;the WebSocket
     closing handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the
     user agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a
     text frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. Any invocation of this method with a
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. Any invocation of this method with a
     string argument that does not throw an exception must increase the &lt;code title=dom-WebSocket-bufferedAmount&gt;&lt;a href=#dom-websocket-bufferedamount&gt;bufferedAmount&lt;/a&gt;&lt;/code&gt; attribute by the number of bytes
     needed to express the argument as UTF-8. &lt;a href=#refsUNICODE&gt;[UNICODE]&lt;/a&gt; &lt;a href=#refsRFC3629&gt;[RFC3629]&lt;/a&gt; &lt;a href=#refsWSP&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
 
@@ -79269,11 +79272,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt;, and &lt;i title=&quot;the WebSocket closing
     handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. The data to be sent is the raw data
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. The data to be sent is the raw data
     represented by the &lt;code&gt;&lt;a href=#blob&gt;Blob&lt;/a&gt;&lt;/code&gt; object. &lt;!-- that sentence is meant to invoke &quot;This
     interface represents immutable raw data.&quot; --&gt; Any invocation of this method with a
     &lt;code&gt;&lt;a href=#blob&gt;Blob&lt;/a&gt;&lt;/code&gt; argument that does not throw an exception must increase the &lt;code title=dom-WebSocket-bufferedAmount&gt;&lt;a href=#dom-websocket-bufferedamount&gt;bufferedAmount&lt;/a&gt;&lt;/code&gt; attribute by the size of the
@@ -79287,11 +79292,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt;, and &lt;i title=&quot;the WebSocket closing
     handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. The data to be sent is the data
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. The data to be sent is the data
     stored in the buffer described by the &lt;code&gt;&lt;a href=#arraybuffer&gt;ArrayBuffer&lt;/a&gt;&lt;/code&gt; object. &lt;!-- that sentence is
     meant to invoke &quot;The ArrayBuffer type describes a buffer used to store data for the array buffer
     views.&quot; at the top of the Typed Array spec, and &quot;Optional byteOffset and length can be used to
@@ -79308,11 +79315,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt;, and &lt;i title=&quot;the WebSocket closing
     handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. The data to be sent is the data
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. The data to be sent is the data
     stored in the section of the buffer described by the &lt;code&gt;&lt;a href=#arraybuffer&gt;ArrayBuffer&lt;/a&gt;&lt;/code&gt; object that the
     &lt;code&gt;&lt;a href=#arraybufferview&gt;ArrayBufferView&lt;/a&gt;&lt;/code&gt; object references. &lt;!-- that sentence is meant to invoke &quot;The
     ArrayBuffer type describes a buffer used to store data for the array buffer views.&quot; at the top
@@ -79438,8 +79447,9 @@
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;Change the &lt;code title=dom-WebSocket-readyState&gt;&lt;a href=#dom-websocket-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute's value to
    &lt;code title=dom-WebSocket-CLOSED&gt;&lt;a href=#dom-websocket-closed&gt;CLOSED&lt;/a&gt;&lt;/code&gt; (3).&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If the user agent was required to &lt;i&gt;&lt;a href=#fail-the-websocket-connection&gt;fail the WebSocket connection&lt;/a&gt;&lt;/i&gt; or &lt;i&gt;&lt;a href=#the-websocket-connection-is-closed&gt;the WebSocket
-   connection is closed&lt;/a&gt;&lt;/i&gt; &lt;dfn id=concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/dfn&gt;,
+&lt;!--CLEANUP--&gt;
+   &lt;li&gt;&lt;p&gt;If the user agent was required to &lt;i&gt;&lt;a href=#fail-the-websocket-connection&gt;fail the WebSocket connection&lt;/a&gt;&lt;/i&gt;, or if the &lt;i title=&quot;the WebSocket connection is closed&quot;&gt;&lt;a href=#the-websocket-connection-is-closed&gt;the WebSocket connection was closed&lt;/a&gt;&lt;/i&gt; after being
+   &lt;dfn id=concept-websocket-close-fail title=concept-websocket-close-fail&gt;flagged as full&lt;/dfn&gt;,
    &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=&quot;&quot;&gt;error&lt;/code&gt; at the &lt;code&gt;&lt;a href=#websocket&gt;WebSocket&lt;/a&gt;&lt;/code&gt;
    object. &lt;a href=#refsWSP&gt;[WSP]&lt;/a&gt;&lt;/li&gt;
 

Modified: index
===================================================================
--- index	2013-11-19 20:20:46 UTC (rev 8297)
+++ index	2013-11-19 21:15:37 UTC (rev 8298)
@@ -79231,6 +79231,7 @@
   string &quot;&lt;code title=&quot;&quot;&gt;blob&lt;/code&gt;&quot;. On getting, it must return the last value it was set to. On
   setting, the user agent must set the IDL attribute to the new value.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p class=note&gt;This attribute allows authors to control how binary data is exposed to scripts. By
   setting the attribute to &quot;&lt;code title=&quot;&quot;&gt;blob&lt;/code&gt;&quot;, binary data is returned in
   &lt;code&gt;&lt;a href=#blob&gt;Blob&lt;/a&gt;&lt;/code&gt; form; by setting it to &quot;&lt;code title=&quot;&quot;&gt;arraybuffer&lt;/code&gt;&quot;, it is returned in
@@ -79252,13 +79253,15 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; be the result of &lt;a href=#convert-a-domstring-to-a-sequence-of-unicode-characters title=&quot;convert a DOMString to a sequence
     of Unicode characters&quot;&gt;converting the &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; argument to a sequence of Unicode
     characters&lt;/a&gt;. If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt; and &lt;i title=&quot;the WebSocket
     closing handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the
     user agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a
     text frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. Any invocation of this method with a
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. Any invocation of this method with a
     string argument that does not throw an exception must increase the &lt;code title=dom-WebSocket-bufferedAmount&gt;&lt;a href=#dom-websocket-bufferedamount&gt;bufferedAmount&lt;/a&gt;&lt;/code&gt; attribute by the number of bytes
     needed to express the argument as UTF-8. &lt;a href=#refsUNICODE&gt;[UNICODE]&lt;/a&gt; &lt;a href=#refsRFC3629&gt;[RFC3629]&lt;/a&gt; &lt;a href=#refsWSP&gt;[WSP]&lt;/a&gt;&lt;/p&gt;
 
@@ -79269,11 +79272,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt;, and &lt;i title=&quot;the WebSocket closing
     handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. The data to be sent is the raw data
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. The data to be sent is the raw data
     represented by the &lt;code&gt;&lt;a href=#blob&gt;Blob&lt;/a&gt;&lt;/code&gt; object. &lt;!-- that sentence is meant to invoke &quot;This
     interface represents immutable raw data.&quot; --&gt; Any invocation of this method with a
     &lt;code&gt;&lt;a href=#blob&gt;Blob&lt;/a&gt;&lt;/code&gt; argument that does not throw an exception must increase the &lt;code title=dom-WebSocket-bufferedAmount&gt;&lt;a href=#dom-websocket-bufferedamount&gt;bufferedAmount&lt;/a&gt;&lt;/code&gt; attribute by the size of the
@@ -79287,11 +79292,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt;, and &lt;i title=&quot;the WebSocket closing
     handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. The data to be sent is the data
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. The data to be sent is the data
     stored in the buffer described by the &lt;code&gt;&lt;a href=#arraybuffer&gt;ArrayBuffer&lt;/a&gt;&lt;/code&gt; object. &lt;!-- that sentence is
     meant to invoke &quot;The ArrayBuffer type describes a buffer used to store data for the array buffer
     views.&quot; at the top of the Typed Array spec, and &quot;Optional byteOffset and length can be used to
@@ -79308,11 +79315,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;&lt;a href=#the-websocket-connection-is-established&gt;the WebSocket connection is established&lt;/a&gt;&lt;/i&gt;, and &lt;i title=&quot;the WebSocket closing
     handshake is started&quot;&gt;&lt;a href=#the-websocket-closing-handshake-is-started&gt;the WebSocket closing handshake has not yet started&lt;/a&gt;&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var title=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt; &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/a&gt;. The data to be sent is the data
+    buffer is full, the user agent must &lt;a href=#concept-websocket-close-fail title=concept-websocket-close-fail&gt;flag the WebSocket
+    as full&lt;/a&gt; and then &lt;i&gt;&lt;a href=#close-the-websocket-connection&gt;close the WebSocket connection&lt;/a&gt;&lt;/i&gt;. The data to be sent is the data
     stored in the section of the buffer described by the &lt;code&gt;&lt;a href=#arraybuffer&gt;ArrayBuffer&lt;/a&gt;&lt;/code&gt; object that the
     &lt;code&gt;&lt;a href=#arraybufferview&gt;ArrayBufferView&lt;/a&gt;&lt;/code&gt; object references. &lt;!-- that sentence is meant to invoke &quot;The
     ArrayBuffer type describes a buffer used to store data for the array buffer views.&quot; at the top
@@ -79438,8 +79447,9 @@
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;Change the &lt;code title=dom-WebSocket-readyState&gt;&lt;a href=#dom-websocket-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute's value to
    &lt;code title=dom-WebSocket-CLOSED&gt;&lt;a href=#dom-websocket-closed&gt;CLOSED&lt;/a&gt;&lt;/code&gt; (3).&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If the user agent was required to &lt;i&gt;&lt;a href=#fail-the-websocket-connection&gt;fail the WebSocket connection&lt;/a&gt;&lt;/i&gt; or &lt;i&gt;&lt;a href=#the-websocket-connection-is-closed&gt;the WebSocket
-   connection is closed&lt;/a&gt;&lt;/i&gt; &lt;dfn id=concept-websocket-close-fail title=concept-websocket-close-fail&gt;with prejudice&lt;/dfn&gt;,
+&lt;!--CLEANUP--&gt;
+   &lt;li&gt;&lt;p&gt;If the user agent was required to &lt;i&gt;&lt;a href=#fail-the-websocket-connection&gt;fail the WebSocket connection&lt;/a&gt;&lt;/i&gt;, or if the &lt;i title=&quot;the WebSocket connection is closed&quot;&gt;&lt;a href=#the-websocket-connection-is-closed&gt;the WebSocket connection was closed&lt;/a&gt;&lt;/i&gt; after being
+   &lt;dfn id=concept-websocket-close-fail title=concept-websocket-close-fail&gt;flagged as full&lt;/dfn&gt;,
    &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=&quot;&quot;&gt;error&lt;/code&gt; at the &lt;code&gt;&lt;a href=#websocket&gt;WebSocket&lt;/a&gt;&lt;/code&gt;
    object. &lt;a href=#refsWSP&gt;[WSP]&lt;/a&gt;&lt;/li&gt;
 

Modified: source
===================================================================
--- source	2013-11-19 20:20:46 UTC (rev 8297)
+++ source	2013-11-19 21:15:37 UTC (rev 8298)
@@ -88740,6 +88740,7 @@
   string &quot;&lt;code data-x=&quot;&quot;&gt;blob&lt;/code&gt;&quot;. On getting, it must return the last value it was set to. On
   setting, the user agent must set the IDL attribute to the new value.&lt;/p&gt;
 
+&lt;!--CLEANUP--&gt;
   &lt;p class=&quot;note&quot;&gt;This attribute allows authors to control how binary data is exposed to scripts. By
   setting the attribute to &quot;&lt;code data-x=&quot;&quot;&gt;blob&lt;/code&gt;&quot;, binary data is returned in
   &lt;code&gt;Blob&lt;/code&gt; form; by setting it to &quot;&lt;code data-x=&quot;&quot;&gt;arraybuffer&lt;/code&gt;&quot;, it is returned in
@@ -88765,14 +88766,15 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;Let &lt;var data-x=&quot;&quot;&gt;data&lt;/var&gt; be the result of &lt;span data-x=&quot;convert a DOMString to a sequence
     of Unicode characters&quot;&gt;converting the &lt;var data-x=&quot;&quot;&gt;data&lt;/var&gt; argument to a sequence of Unicode
     characters&lt;/span&gt;. If &lt;i&gt;the WebSocket connection is established&lt;/i&gt; and &lt;i data-x=&quot;the WebSocket
     closing handshake is started&quot;&gt;the WebSocket closing handshake has not yet started&lt;/i&gt;, then the
     user agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var data-x=&quot;&quot;&gt;data&lt;/var&gt; using a
     text frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;close the WebSocket connection&lt;/i&gt; &lt;span
-    data-x=&quot;concept-websocket-close-fail&quot;&gt;with prejudice&lt;/span&gt;. Any invocation of this method with a
+    buffer is full, the user agent must &lt;span data-x=&quot;concept-websocket-close-fail&quot;&gt;flag the WebSocket
+    as full&lt;/span&gt; and then &lt;i&gt;close the WebSocket connection&lt;/i&gt;. Any invocation of this method with a
     string argument that does not throw an exception must increase the &lt;code
     data-x=&quot;dom-WebSocket-bufferedAmount&quot;&gt;bufferedAmount&lt;/code&gt; attribute by the number of bytes
     needed to express the argument as UTF-8. &lt;a href=&quot;#refsUNICODE&quot;&gt;[UNICODE]&lt;/a&gt; &lt;a
@@ -88785,12 +88787,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;the WebSocket connection is established&lt;/i&gt;, and &lt;i data-x=&quot;the WebSocket closing
     handshake is started&quot;&gt;the WebSocket closing handshake has not yet started&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var data-x=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;close the WebSocket connection&lt;/i&gt; &lt;span
-    data-x=&quot;concept-websocket-close-fail&quot;&gt;with prejudice&lt;/span&gt;. The data to be sent is the raw data
+    buffer is full, the user agent must &lt;span data-x=&quot;concept-websocket-close-fail&quot;&gt;flag the WebSocket
+    as full&lt;/span&gt; and then &lt;i&gt;close the WebSocket connection&lt;/i&gt;. The data to be sent is the raw data
     represented by the &lt;code&gt;Blob&lt;/code&gt; object. &lt;!-- that sentence is meant to invoke &quot;This
     interface represents immutable raw data.&quot; --&gt; Any invocation of this method with a
     &lt;code&gt;Blob&lt;/code&gt; argument that does not throw an exception must increase the &lt;code
@@ -88805,12 +88808,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;the WebSocket connection is established&lt;/i&gt;, and &lt;i data-x=&quot;the WebSocket closing
     handshake is started&quot;&gt;the WebSocket closing handshake has not yet started&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var data-x=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;close the WebSocket connection&lt;/i&gt; &lt;span
-    data-x=&quot;concept-websocket-close-fail&quot;&gt;with prejudice&lt;/span&gt;. The data to be sent is the data
+    buffer is full, the user agent must &lt;span data-x=&quot;concept-websocket-close-fail&quot;&gt;flag the WebSocket
+    as full&lt;/span&gt; and then &lt;i&gt;close the WebSocket connection&lt;/i&gt;. The data to be sent is the data
     stored in the buffer described by the &lt;code&gt;ArrayBuffer&lt;/code&gt; object. &lt;!-- that sentence is
     meant to invoke &quot;The ArrayBuffer type describes a buffer used to store data for the array buffer
     views.&quot; at the top of the Typed Array spec, and &quot;Optional byteOffset and length can be used to
@@ -88828,12 +88832,13 @@
 
    &lt;dd&gt;
 
+&lt;!--CLEANUP--&gt;
     &lt;p&gt;If &lt;i&gt;the WebSocket connection is established&lt;/i&gt;, and &lt;i data-x=&quot;the WebSocket closing
     handshake is started&quot;&gt;the WebSocket closing handshake has not yet started&lt;/i&gt;, then the user
     agent must &lt;i&gt;send a WebSocket Message&lt;/i&gt; comprised of &lt;var data-x=&quot;&quot;&gt;data&lt;/var&gt; using a binary
     frame opcode; if the data cannot be sent, e.g. because it would need to be buffered but the
-    buffer is full, the user agent must &lt;i&gt;close the WebSocket connection&lt;/i&gt; &lt;span
-    data-x=&quot;concept-websocket-close-fail&quot;&gt;with prejudice&lt;/span&gt;. The data to be sent is the data
+    buffer is full, the user agent must &lt;span data-x=&quot;concept-websocket-close-fail&quot;&gt;flag the WebSocket
+    as full&lt;/span&gt; and then &lt;i&gt;close the WebSocket connection&lt;/i&gt;. The data to be sent is the data
     stored in the section of the buffer described by the &lt;code&gt;ArrayBuffer&lt;/code&gt; object that the
     &lt;code&gt;ArrayBufferView&lt;/code&gt; object references. &lt;!-- that sentence is meant to invoke &quot;The
     ArrayBuffer type describes a buffer used to store data for the array buffer views.&quot; at the top
@@ -89012,8 +89017,10 @@
    &lt;li&gt;&lt;p&gt;Change the &lt;code data-x=&quot;dom-WebSocket-readyState&quot;&gt;readyState&lt;/code&gt; attribute's value to
    &lt;code data-x=&quot;dom-WebSocket-CLOSED&quot;&gt;CLOSED&lt;/code&gt; (3).&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If the user agent was required to &lt;i&gt;fail the WebSocket connection&lt;/i&gt; or &lt;i&gt;the WebSocket
-   connection is closed&lt;/i&gt; &lt;dfn data-x=&quot;concept-websocket-close-fail&quot;&gt;with prejudice&lt;/dfn&gt;,
+&lt;!--CLEANUP--&gt;
+   &lt;li&gt;&lt;p&gt;If the user agent was required to &lt;i&gt;fail the WebSocket connection&lt;/i&gt;, or if the &lt;i
+   data-x=&quot;the WebSocket connection is closed&quot;&gt;the WebSocket connection was closed&lt;/i&gt; after being
+   &lt;dfn data-x=&quot;concept-websocket-close-fail&quot;&gt;flagged as full&lt;/dfn&gt;,
    &lt;span&gt;fire a simple event&lt;/span&gt; named &lt;code data-x=&quot;&quot;&gt;error&lt;/code&gt; at the &lt;code&gt;WebSocket&lt;/code&gt;
    object. &lt;a href=&quot;#refsWSP&quot;&gt;[WSP]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
 


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015152.html">[html5] r8297 - [giow] (3) Move more towards the browsers for	&lt;option&gt; selectedness vs dirtiness [...]
</A></li>
	<LI>Next message: <A HREF="015154.html">[html5] r8299 - [c] (2) Remove the parts of the script content	model that could lead to unbalanc [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15153">[ date ]</a>
              <a href="thread.html#15153">[ thread ]</a>
              <a href="subject.html#15153">[ subject ]</a>
              <a href="author.html#15153">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
