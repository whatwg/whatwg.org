<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r7914 - [giow] (3) pushing &lt;embed&gt;'s specification further	towards its reality Fixing ht [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7914%20-%20%5Bgiow%5D%20%283%29%20pushing%20%3Cembed%3E%27s%20specification%20further%0A%09towards%20its%20reality%20Fixing%20ht%20%5B...%5D&In-Reply-To=%3C20130605232422.AE9441C8405C%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014771.html">
   <LINK REL="Next"  HREF="014773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r7914 - [giow] (3) pushing &lt;embed&gt;'s specification further	towards its reality Fixing ht [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r7914%20-%20%5Bgiow%5D%20%283%29%20pushing%20%3Cembed%3E%27s%20specification%20further%0A%09towards%20its%20reality%20Fixing%20ht%20%5B...%5D&In-Reply-To=%3C20130605232422.AE9441C8405C%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r7914 - [giow] (3) pushing &lt;embed&gt;'s specification further	towards its reality Fixing ht [...]">whatwg at whatwg.org
       </A><BR>
    <I>Wed Jun  5 16:24:22 PDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="014771.html">[html5] r7913 - [e] (0) Fix some typos or copypasta. Affected	topics: HTML, Video and Audio
</A></li>
        <LI>Next message: <A HREF="014773.html">[html5] r7915 - [e] (0) Move .style to CSSOM Fixing	https://www.w3.org/Bugs/Public/show_bug.cgi? [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14772">[ date ]</a>
              <a href="thread.html#14772">[ thread ]</a>
              <a href="subject.html#14772">[ subject ]</a>
              <a href="author.html#14772">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2013-06-05 16:24:21 -0700 (Wed, 05 Jun 2013)
New Revision: 7914

Modified:
   complete.html
   index
   source
Log:
[giow] (3) pushing &lt;embed&gt;'s specification further towards its reality
Fixing <A HREF="https://www.w3.org/Bugs/Public/show_bug.cgi?id=16136">https://www.w3.org/Bugs/Public/show_bug.cgi?id=16136</A>
Affected topics: HTML

Modified: complete.html
===================================================================
--- complete.html	2013-06-05 21:49:40 UTC (rev 7913)
+++ complete.html	2013-06-05 23:24:21 UTC (rev 7914)
@@ -24983,7 +24983,7 @@
     interfaces.&lt;/p&gt;
     &lt;/div&gt;
    &lt;/dd&gt;
-  &lt;/dl&gt;&lt;!--TOPIC:HTML--&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; an integration point for an external
+  &lt;/dl&gt;&lt;!--TOPIC:HTML--&gt;&lt;!--CLEANUP--&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element provides an integration point for an external
   (typically non-HTML) application or interactive content.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=attr-embed-src title=attr-embed-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; attribute gives the address of the
@@ -25004,8 +25004,8 @@
   nor a &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, and when attributes are removed such
   that neither attribute is present on the element anymore, and when the element has a &lt;a href=#media-element&gt;media
   element&lt;/a&gt; ancestor, and when the element has an ancestor &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element that is
-  &lt;em&gt;not&lt;/em&gt; showing its &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;, any plugins instantiated for the element
-  must be removed, and the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element represents nothing.&lt;/p&gt;
+  &lt;em&gt;not&lt;/em&gt; showing its &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;, any &lt;a href=#plugin&gt;plugin&lt;/a&gt; instantiated for
+  the element must be removed, and the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element then represents nothing.&lt;/p&gt;
 
   &lt;p&gt;An &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element is said to be &lt;dfn id=concept-embed-active title=concept-embed-active&gt;potentially
   active&lt;/dfn&gt; when the following conditions are all met simultaneously:&lt;/p&gt;
@@ -25030,11 +25030,14 @@
 
   &lt;/ul&gt;&lt;p&gt;Whenever an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that was not &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt; becomes &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt;, and whenever a &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt; &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that is
   remaining &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt; and has its &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;src&lt;/a&gt;&lt;/code&gt; attribute set, changed, or removed or its &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute set, changed, or removed, the user agent must
-  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; using the &lt;dfn id=embed-task-source&gt;embed task source&lt;/dfn&gt; to run the following steps:&lt;/p&gt;
+  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; using the &lt;dfn id=embed-task-source&gt;embed task source&lt;/dfn&gt; to run
+  &lt;a href=#the-embed-element-setup-steps&gt;the &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If another &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; has since been queued to run these steps
-   for this element, then abort these steps.&lt;/li&gt;
+  &lt;p&gt;&lt;dfn id=the-embed-element-setup-steps&gt;The &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/dfn&gt; are as follows:&lt;/p&gt;
 
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If another &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; has since been queued to run &lt;a href=#the-embed-element-setup-steps&gt;the
+   &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/a&gt; for this element, then abort these steps.&lt;/li&gt;
+
    &lt;li&gt;
 
     &lt;dl class=switch&gt;&lt;dt&gt;If the element has a &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute set&lt;/dt&gt;
@@ -25047,12 +25050,90 @@
       URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope origin&lt;/a&gt; if it has one&lt;!--
       potentially http-origin privacy sensitive --&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that
       is &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; once
-      the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must find and instantiate an
-      appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
-      type&lt;/a&gt;, and hand that &lt;a href=#plugin&gt;plugin&lt;/a&gt; the content of the resource, replacing any
-      previously instantiated plugin for the element.&lt;/p&gt;
+      the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must run the following steps:&lt;/p&gt;
       &lt;!-- Note that this doesn't happen when the base URL changes. --&gt;
 
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;If another &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; has since been queued to run
+       &lt;a href=#the-embed-element-setup-steps&gt;the &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/a&gt; for this element, then abort these
+       steps.&lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;Determine the &lt;dfn id=concept-embed-type title=concept-embed-type&gt;type of the content&lt;/dfn&gt; being embedded, as
+        follows (stopping at the first substep that determines the type):&lt;/p&gt;
+
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the element has a &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, and that
+         attribute's value is a type that a &lt;a href=#plugin&gt;plugin&lt;/a&gt; supports, then the value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
+         type&lt;/a&gt;.&lt;/li&gt;
+
+         &lt;li&gt;
+
+          &lt;!-- if we get to this point we know we can successfully parsed the URL, since this algorithm is
+          only used after fetching the resource in the steps above --&gt;
+
+          &lt;p&gt;Otherwise, if applying the &lt;a href=#url-parser&gt;URL parser&lt;/a&gt; algorithm to the &lt;a href=#url&gt;URL&lt;/a&gt; of the
+          specified resource (after any redirects) results in a &lt;a href=#parsed-url&gt;parsed URL&lt;/a&gt; whose &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; component matches a pattern that a &lt;a href=#plugin&gt;plugin&lt;/a&gt;
+          supports, then the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt; is the type that that
+          plugin can handle.&lt;/p&gt;
+
+          &lt;p class=example&gt;For example, a plugin might say that it can handle resources with &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; components that end with the four character string &quot;&lt;code title=&quot;&quot;&gt;.swf&lt;/code&gt;&quot;.&lt;/p&gt;
+
+          &lt;!-- it's sad that we have to do extension sniffing. sigh. --&gt;
+          &lt;!-- see also &lt;object&gt; which has a similar step --&gt;
+
+         &lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;Otherwise, if the specified resource has &lt;a href=#content-type title=Content-Type&gt;explicit Content-Type
+         metadata&lt;/a&gt;, then that is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
+         type&lt;/a&gt;.&lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;Otherwise, the content has no &lt;a href=#concept-embed-type title=concept-embed-type&gt;type&lt;/a&gt; and there can
+         be no appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; for it.&lt;/li&gt;
+
+         &lt;!-- This algorithm is a monument to bad design. Go legacy! --&gt;
+
+        &lt;/ol&gt;&lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;If the previous step determined that the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
+        type&lt;/a&gt; is &lt;code title=&quot;&quot;&gt;image/svg+xml&lt;/code&gt;, then run the following substeps:&lt;/p&gt;
+
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element is not associated with a &lt;a href=#nested-browsing-context&gt;nested browsing
+         context&lt;/a&gt;, associate the element with a newly created &lt;a href=#nested-browsing-context&gt;nested browsing
+         context&lt;/a&gt;, and, if the element has a &lt;code title=attr-embed-name&gt;&lt;a href=#attr-embed-name&gt;name&lt;/a&gt;&lt;/code&gt;
+         attribute, set the &lt;a href=#browsing-context-name&gt;browsing context name&lt;/a&gt; of the element's &lt;a href=#nested-browsing-context&gt;nested
+         browsing context&lt;/a&gt; to the value of this attribute.&lt;/p&gt;
+         &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2291">http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2291</A> - dynamic changes to 'name' don't do anything --&gt;
+
+         &lt;li&gt;&lt;p&gt;&lt;a href=#navigate&gt;Navigate&lt;/a&gt;&lt;!--DONAV object--&gt; the &lt;a href=#nested-browsing-context&gt;nested browsing context&lt;/a&gt; to
+         the fetched resource, with &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt;, and with the
+         &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element's document's &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; as the &lt;a href=#source-browsing-context&gt;source
+         browsing context&lt;/a&gt;. (The &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the
+         &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element doesn't get updated if the browsing context gets further
+         navigated to other locations.)&lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element now &lt;a href=#represents&gt;represents&lt;/a&gt; its associated
+         &lt;a href=#nested-browsing-context&gt;nested browsing context&lt;/a&gt;.&lt;/li&gt;
+
+        &lt;/ol&gt;&lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;Otherwise, find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt;, and hand that &lt;a href=#plugin&gt;plugin&lt;/a&gt; the
+        content of the resource, replacing any previously instantiated plugin for the element. The
+        &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element now represents this &lt;a href=#plugin&gt;plugin&lt;/a&gt; instance.&lt;/p&gt;
+
+       &lt;/li&gt;
+
+      &lt;/ol&gt;&lt;p&gt;Whether the resource is fetched successfully or not (e.g. whether the response code was a
+      2xx code &lt;a href=#concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;or equivalent&lt;/a&gt;) must be ignored
+      when determining the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt; and when handing
+      the resource to the plugin.&lt;/p&gt;
+
+      &lt;p class=note&gt;This allows servers to return data for plugins even with error responses (e.g.
+      HTTP 500 Internal Server Error codes can still contain plugin data).&lt;/p&gt;
+
       &lt;p&gt;Fetching the resource must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of the element's document.&lt;/p&gt;
       &lt;!-- if we add load/error events, then replace the previous paragraph with the text one: --&gt;
       &lt;!-- similar text in various places --&gt;
@@ -25065,12 +25146,22 @@
 
      &lt;dt&gt;If the element has no &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute set&lt;/dt&gt;
 
-     &lt;dd&gt;&lt;p&gt;The user agent should find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on
-     the value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute.&lt;/p&gt;
+     &lt;dd&gt;
 
+      &lt;p&gt;The user agent should find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the
+      value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute. The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt;
+      element now represents this &lt;a href=#plugin&gt;plugin&lt;/a&gt; instance.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
     &lt;/dl&gt;&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p&gt;Whenever an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that was &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially
+  &lt;/ol&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element has no &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;. If the user agent can't
+  find a suitable plugin when attempting to find and instantiate one for the algorithm above, then
+  the user agent must use a default plugin. This default could be as simple as saying &quot;Unsupported
+  Format&quot;.&lt;/p&gt;
+
+  &lt;p&gt;Whenever an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that was &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially
   active&lt;/a&gt; stops being &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt;, any
   &lt;a href=#plugin&gt;plugin&lt;/a&gt; that had been instantiated for that element must be unloaded.&lt;/p&gt;
 
@@ -25088,50 +25179,6 @@
   agents should convey the danger of overriding the sandbox to the user if an option to do so is
   provided.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn id=concept-embed-type title=concept-embed-type&gt;type of the content&lt;/dfn&gt; being embedded is defined as
-  follows:&lt;/p&gt;
-
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the element has a &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, and that
-   attribute's value is a type that a &lt;a href=#plugin&gt;plugin&lt;/a&gt; supports, then the value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
-   type&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;!-- if we get to this point we know we can successfully parsed the URL, since this algorithm is
-    only used after fetching the resource in the steps above --&gt;
-
-    &lt;p&gt;Otherwise, if applying the &lt;a href=#url-parser&gt;URL parser&lt;/a&gt; algorithm to the &lt;a href=#url&gt;URL&lt;/a&gt; of the
-    specified resource (after any redirects) results in a &lt;a href=#parsed-url&gt;parsed URL&lt;/a&gt; whose &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; component matches a pattern that a &lt;a href=#plugin&gt;plugin&lt;/a&gt;
-    supports, then the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt; is the type that that
-    plugin can handle.&lt;/p&gt;
-
-    &lt;p class=example&gt;For example, a plugin might say that it can handle resources with &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; components that end with the four character string &quot;&lt;code title=&quot;&quot;&gt;.swf&lt;/code&gt;&quot;.&lt;/p&gt;
-
-    &lt;!-- it's sad that we have to do extension sniffing. sigh. --&gt;
-    &lt;!-- see also &lt;object&gt; which has a similar step --&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the specified resource has &lt;a href=#content-type title=Content-Type&gt;explicit Content-Type
-   metadata&lt;/a&gt;, then that is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
-   type&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, the content has no type and there can be no appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; for
-   it.&lt;/li&gt;
-
-   &lt;!-- This algorithm is a monument to bad design. Go legacy! --&gt;
-
-  &lt;/ol&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element has no &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;. If the user agent can't
-  find a suitable plugin, then the user agent must use a default plugin. (This default could be as
-  simple as saying &quot;Unsupported Format&quot;.)&lt;/p&gt;
-
-  &lt;p&gt;Whether the resource is fetched successfully or not (e.g. whether the response code was a 2xx
-  code &lt;a href=#concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;or equivalent&lt;/a&gt;) must be ignored when
-  determining the resource's type and when handing the resource to the plugin.&lt;/p&gt;
-
-  &lt;p class=note&gt;This allows servers to return data for plugins even with error responses (e.g.
-  HTTP 500 Internal Server Error codes can still contain plugin data).&lt;/p&gt;
-
   &lt;/div&gt;
 
   &lt;p&gt;Any namespace-less attribute other than &lt;code title=attr-embed-name&gt;&lt;a href=#attr-embed-name&gt;name&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-embed-align&gt;&lt;a href=#attr-embed-align&gt;align&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-embed-hspace&gt;&lt;a href=#attr-embed-hspace&gt;hspace&lt;/a&gt;&lt;/code&gt;, and &lt;code title=attr-embed-vspace&gt;&lt;a href=#attr-embed-vspace&gt;vspace&lt;/a&gt;&lt;/code&gt; &lt;!-- when editing, see also note below --&gt; may be
@@ -25148,10 +25195,10 @@
   &lt;div class=impl&gt;
 
   &lt;p&gt;The user agent should pass the names and values of all the attributes of the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt;
-  element that have no namespace to the &lt;a href=#plugin&gt;plugin&lt;/a&gt; used, when it is instantiated.&lt;/p&gt;
+  element that have no namespace to the &lt;a href=#plugin&gt;plugin&lt;/a&gt; used, when one is instantiated.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=#htmlembedelement&gt;HTMLEmbedElement&lt;/a&gt;&lt;/code&gt; object representing the element must expose the scriptable
-  interface of the &lt;a href=#plugin&gt;plugin&lt;/a&gt; instantiated for the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element. At a
+  interface of the &lt;a href=#plugin&gt;plugin&lt;/a&gt; instantiated for the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element, if any. At a
   minimum, this interface must implement the &lt;dfn id=dom-embed-caller title=dom-embed-caller&gt;legacy caller
   operation&lt;/dfn&gt;. (It is suggested that the default behavior of this legacy caller operation, e.g.
   the behavior of the default plugin's legacy caller operation, be to throw a

Modified: index
===================================================================
--- index	2013-06-05 21:49:40 UTC (rev 7913)
+++ index	2013-06-05 23:24:21 UTC (rev 7914)
@@ -24983,7 +24983,7 @@
     interfaces.&lt;/p&gt;
     &lt;/div&gt;
    &lt;/dd&gt;
-  &lt;/dl&gt;&lt;!--TOPIC:HTML--&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element &lt;a href=#represents&gt;represents&lt;/a&gt; an integration point for an external
+  &lt;/dl&gt;&lt;!--TOPIC:HTML--&gt;&lt;!--CLEANUP--&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element provides an integration point for an external
   (typically non-HTML) application or interactive content.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=attr-embed-src title=attr-embed-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; attribute gives the address of the
@@ -25004,8 +25004,8 @@
   nor a &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, and when attributes are removed such
   that neither attribute is present on the element anymore, and when the element has a &lt;a href=#media-element&gt;media
   element&lt;/a&gt; ancestor, and when the element has an ancestor &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element that is
-  &lt;em&gt;not&lt;/em&gt; showing its &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;, any plugins instantiated for the element
-  must be removed, and the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element represents nothing.&lt;/p&gt;
+  &lt;em&gt;not&lt;/em&gt; showing its &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;, any &lt;a href=#plugin&gt;plugin&lt;/a&gt; instantiated for
+  the element must be removed, and the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element then represents nothing.&lt;/p&gt;
 
   &lt;p&gt;An &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element is said to be &lt;dfn id=concept-embed-active title=concept-embed-active&gt;potentially
   active&lt;/dfn&gt; when the following conditions are all met simultaneously:&lt;/p&gt;
@@ -25030,11 +25030,14 @@
 
   &lt;/ul&gt;&lt;p&gt;Whenever an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that was not &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt; becomes &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt;, and whenever a &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt; &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that is
   remaining &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt; and has its &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;src&lt;/a&gt;&lt;/code&gt; attribute set, changed, or removed or its &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute set, changed, or removed, the user agent must
-  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; using the &lt;dfn id=embed-task-source&gt;embed task source&lt;/dfn&gt; to run the following steps:&lt;/p&gt;
+  &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; using the &lt;dfn id=embed-task-source&gt;embed task source&lt;/dfn&gt; to run
+  &lt;a href=#the-embed-element-setup-steps&gt;the &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If another &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; has since been queued to run these steps
-   for this element, then abort these steps.&lt;/li&gt;
+  &lt;p&gt;&lt;dfn id=the-embed-element-setup-steps&gt;The &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/dfn&gt; are as follows:&lt;/p&gt;
 
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If another &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; has since been queued to run &lt;a href=#the-embed-element-setup-steps&gt;the
+   &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/a&gt; for this element, then abort these steps.&lt;/li&gt;
+
    &lt;li&gt;
 
     &lt;dl class=switch&gt;&lt;dt&gt;If the element has a &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute set&lt;/dt&gt;
@@ -25047,12 +25050,90 @@
       URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope origin&lt;/a&gt; if it has one&lt;!--
       potentially http-origin privacy sensitive --&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that
       is &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; once
-      the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must find and instantiate an
-      appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
-      type&lt;/a&gt;, and hand that &lt;a href=#plugin&gt;plugin&lt;/a&gt; the content of the resource, replacing any
-      previously instantiated plugin for the element.&lt;/p&gt;
+      the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must run the following steps:&lt;/p&gt;
       &lt;!-- Note that this doesn't happen when the base URL changes. --&gt;
 
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;If another &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; has since been queued to run
+       &lt;a href=#the-embed-element-setup-steps&gt;the &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/a&gt; for this element, then abort these
+       steps.&lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;Determine the &lt;dfn id=concept-embed-type title=concept-embed-type&gt;type of the content&lt;/dfn&gt; being embedded, as
+        follows (stopping at the first substep that determines the type):&lt;/p&gt;
+
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the element has a &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, and that
+         attribute's value is a type that a &lt;a href=#plugin&gt;plugin&lt;/a&gt; supports, then the value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
+         type&lt;/a&gt;.&lt;/li&gt;
+
+         &lt;li&gt;
+
+          &lt;!-- if we get to this point we know we can successfully parsed the URL, since this algorithm is
+          only used after fetching the resource in the steps above --&gt;
+
+          &lt;p&gt;Otherwise, if applying the &lt;a href=#url-parser&gt;URL parser&lt;/a&gt; algorithm to the &lt;a href=#url&gt;URL&lt;/a&gt; of the
+          specified resource (after any redirects) results in a &lt;a href=#parsed-url&gt;parsed URL&lt;/a&gt; whose &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; component matches a pattern that a &lt;a href=#plugin&gt;plugin&lt;/a&gt;
+          supports, then the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt; is the type that that
+          plugin can handle.&lt;/p&gt;
+
+          &lt;p class=example&gt;For example, a plugin might say that it can handle resources with &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; components that end with the four character string &quot;&lt;code title=&quot;&quot;&gt;.swf&lt;/code&gt;&quot;.&lt;/p&gt;
+
+          &lt;!-- it's sad that we have to do extension sniffing. sigh. --&gt;
+          &lt;!-- see also &lt;object&gt; which has a similar step --&gt;
+
+         &lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;Otherwise, if the specified resource has &lt;a href=#content-type title=Content-Type&gt;explicit Content-Type
+         metadata&lt;/a&gt;, then that is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
+         type&lt;/a&gt;.&lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;Otherwise, the content has no &lt;a href=#concept-embed-type title=concept-embed-type&gt;type&lt;/a&gt; and there can
+         be no appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; for it.&lt;/li&gt;
+
+         &lt;!-- This algorithm is a monument to bad design. Go legacy! --&gt;
+
+        &lt;/ol&gt;&lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;If the previous step determined that the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
+        type&lt;/a&gt; is &lt;code title=&quot;&quot;&gt;image/svg+xml&lt;/code&gt;, then run the following substeps:&lt;/p&gt;
+
+        &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element is not associated with a &lt;a href=#nested-browsing-context&gt;nested browsing
+         context&lt;/a&gt;, associate the element with a newly created &lt;a href=#nested-browsing-context&gt;nested browsing
+         context&lt;/a&gt;, and, if the element has a &lt;code title=attr-embed-name&gt;&lt;a href=#attr-embed-name&gt;name&lt;/a&gt;&lt;/code&gt;
+         attribute, set the &lt;a href=#browsing-context-name&gt;browsing context name&lt;/a&gt; of the element's &lt;a href=#nested-browsing-context&gt;nested
+         browsing context&lt;/a&gt; to the value of this attribute.&lt;/p&gt;
+         &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2291">http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2291</A> - dynamic changes to 'name' don't do anything --&gt;
+
+         &lt;li&gt;&lt;p&gt;&lt;a href=#navigate&gt;Navigate&lt;/a&gt;&lt;!--DONAV object--&gt; the &lt;a href=#nested-browsing-context&gt;nested browsing context&lt;/a&gt; to
+         the fetched resource, with &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt;, and with the
+         &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element's document's &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; as the &lt;a href=#source-browsing-context&gt;source
+         browsing context&lt;/a&gt;. (The &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the
+         &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element doesn't get updated if the browsing context gets further
+         navigated to other locations.)&lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element now &lt;a href=#represents&gt;represents&lt;/a&gt; its associated
+         &lt;a href=#nested-browsing-context&gt;nested browsing context&lt;/a&gt;.&lt;/li&gt;
+
+        &lt;/ol&gt;&lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;Otherwise, find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt;, and hand that &lt;a href=#plugin&gt;plugin&lt;/a&gt; the
+        content of the resource, replacing any previously instantiated plugin for the element. The
+        &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element now represents this &lt;a href=#plugin&gt;plugin&lt;/a&gt; instance.&lt;/p&gt;
+
+       &lt;/li&gt;
+
+      &lt;/ol&gt;&lt;p&gt;Whether the resource is fetched successfully or not (e.g. whether the response code was a
+      2xx code &lt;a href=#concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;or equivalent&lt;/a&gt;) must be ignored
+      when determining the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt; and when handing
+      the resource to the plugin.&lt;/p&gt;
+
+      &lt;p class=note&gt;This allows servers to return data for plugins even with error responses (e.g.
+      HTTP 500 Internal Server Error codes can still contain plugin data).&lt;/p&gt;
+
       &lt;p&gt;Fetching the resource must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt; of the element's document.&lt;/p&gt;
       &lt;!-- if we add load/error events, then replace the previous paragraph with the text one: --&gt;
       &lt;!-- similar text in various places --&gt;
@@ -25065,12 +25146,22 @@
 
      &lt;dt&gt;If the element has no &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute set&lt;/dt&gt;
 
-     &lt;dd&gt;&lt;p&gt;The user agent should find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on
-     the value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute.&lt;/p&gt;
+     &lt;dd&gt;
 
+      &lt;p&gt;The user agent should find and instantiate an appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the
+      value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute. The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt;
+      element now represents this &lt;a href=#plugin&gt;plugin&lt;/a&gt; instance.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
     &lt;/dl&gt;&lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p&gt;Whenever an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that was &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially
+  &lt;/ol&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element has no &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;. If the user agent can't
+  find a suitable plugin when attempting to find and instantiate one for the algorithm above, then
+  the user agent must use a default plugin. This default could be as simple as saying &quot;Unsupported
+  Format&quot;.&lt;/p&gt;
+
+  &lt;p&gt;Whenever an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element that was &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially
   active&lt;/a&gt; stops being &lt;a href=#concept-embed-active title=concept-embed-active&gt;potentially active&lt;/a&gt;, any
   &lt;a href=#plugin&gt;plugin&lt;/a&gt; that had been instantiated for that element must be unloaded.&lt;/p&gt;
 
@@ -25088,50 +25179,6 @@
   agents should convey the danger of overriding the sandbox to the user if an option to do so is
   provided.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn id=concept-embed-type title=concept-embed-type&gt;type of the content&lt;/dfn&gt; being embedded is defined as
-  follows:&lt;/p&gt;
-
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the element has a &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, and that
-   attribute's value is a type that a &lt;a href=#plugin&gt;plugin&lt;/a&gt; supports, then the value of the &lt;code title=attr-embed-type&gt;&lt;a href=#attr-embed-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
-   type&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;!-- if we get to this point we know we can successfully parsed the URL, since this algorithm is
-    only used after fetching the resource in the steps above --&gt;
-
-    &lt;p&gt;Otherwise, if applying the &lt;a href=#url-parser&gt;URL parser&lt;/a&gt; algorithm to the &lt;a href=#url&gt;URL&lt;/a&gt; of the
-    specified resource (after any redirects) results in a &lt;a href=#parsed-url&gt;parsed URL&lt;/a&gt; whose &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; component matches a pattern that a &lt;a href=#plugin&gt;plugin&lt;/a&gt;
-    supports, then the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt; is the type that that
-    plugin can handle.&lt;/p&gt;
-
-    &lt;p class=example&gt;For example, a plugin might say that it can handle resources with &lt;a href=#concept-url-path title=concept-url-path&gt;path&lt;/a&gt; components that end with the four character string &quot;&lt;code title=&quot;&quot;&gt;.swf&lt;/code&gt;&quot;.&lt;/p&gt;
-
-    &lt;!-- it's sad that we have to do extension sniffing. sigh. --&gt;
-    &lt;!-- see also &lt;object&gt; which has a similar step --&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the specified resource has &lt;a href=#content-type title=Content-Type&gt;explicit Content-Type
-   metadata&lt;/a&gt;, then that is the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's
-   type&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, the content has no type and there can be no appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; for
-   it.&lt;/li&gt;
-
-   &lt;!-- This algorithm is a monument to bad design. Go legacy! --&gt;
-
-  &lt;/ol&gt;&lt;p&gt;The &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element has no &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;. If the user agent can't
-  find a suitable plugin, then the user agent must use a default plugin. (This default could be as
-  simple as saying &quot;Unsupported Format&quot;.)&lt;/p&gt;
-
-  &lt;p&gt;Whether the resource is fetched successfully or not (e.g. whether the response code was a 2xx
-  code &lt;a href=#concept-http-equivalent-codes title=concept-http-equivalent-codes&gt;or equivalent&lt;/a&gt;) must be ignored when
-  determining the resource's type and when handing the resource to the plugin.&lt;/p&gt;
-
-  &lt;p class=note&gt;This allows servers to return data for plugins even with error responses (e.g.
-  HTTP 500 Internal Server Error codes can still contain plugin data).&lt;/p&gt;
-
   &lt;/div&gt;
 
   &lt;p&gt;Any namespace-less attribute other than &lt;code title=attr-embed-name&gt;&lt;a href=#attr-embed-name&gt;name&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-embed-align&gt;&lt;a href=#attr-embed-align&gt;align&lt;/a&gt;&lt;/code&gt;, &lt;code title=attr-embed-hspace&gt;&lt;a href=#attr-embed-hspace&gt;hspace&lt;/a&gt;&lt;/code&gt;, and &lt;code title=attr-embed-vspace&gt;&lt;a href=#attr-embed-vspace&gt;vspace&lt;/a&gt;&lt;/code&gt; &lt;!-- when editing, see also note below --&gt; may be
@@ -25148,10 +25195,10 @@
   &lt;div class=impl&gt;
 
   &lt;p&gt;The user agent should pass the names and values of all the attributes of the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt;
-  element that have no namespace to the &lt;a href=#plugin&gt;plugin&lt;/a&gt; used, when it is instantiated.&lt;/p&gt;
+  element that have no namespace to the &lt;a href=#plugin&gt;plugin&lt;/a&gt; used, when one is instantiated.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=#htmlembedelement&gt;HTMLEmbedElement&lt;/a&gt;&lt;/code&gt; object representing the element must expose the scriptable
-  interface of the &lt;a href=#plugin&gt;plugin&lt;/a&gt; instantiated for the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element. At a
+  interface of the &lt;a href=#plugin&gt;plugin&lt;/a&gt; instantiated for the &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element, if any. At a
   minimum, this interface must implement the &lt;dfn id=dom-embed-caller title=dom-embed-caller&gt;legacy caller
   operation&lt;/dfn&gt;. (It is suggested that the default behavior of this legacy caller operation, e.g.
   the behavior of the default plugin's legacy caller operation, be to throw a

Modified: source
===================================================================
--- source	2013-06-05 21:49:40 UTC (rev 7913)
+++ source	2013-06-05 23:24:21 UTC (rev 7914)
@@ -26280,8 +26280,9 @@
     &lt;/div&gt;
    &lt;/dd&gt;
   &lt;/dl&gt;&lt;!--TOPIC:HTML--&gt;
+&lt;!--CLEANUP--&gt;
 
-  &lt;p&gt;The &lt;code&gt;embed&lt;/code&gt; element &lt;span&gt;represents&lt;/span&gt; an integration point for an external
+  &lt;p&gt;The &lt;code&gt;embed&lt;/code&gt; element provides an integration point for an external
   (typically non-HTML) application or interactive content.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn title=&quot;attr-embed-src&quot;&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; attribute gives the address of the
@@ -26305,8 +26306,8 @@
   nor a &lt;code title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute, and when attributes are removed such
   that neither attribute is present on the element anymore, and when the element has a &lt;span&gt;media
   element&lt;/span&gt; ancestor, and when the element has an ancestor &lt;code&gt;object&lt;/code&gt; element that is
-  &lt;em&gt;not&lt;/em&gt; showing its &lt;span&gt;fallback content&lt;/span&gt;, any plugins instantiated for the element
-  must be removed, and the &lt;code&gt;embed&lt;/code&gt; element represents nothing.&lt;/p&gt;
+  &lt;em&gt;not&lt;/em&gt; showing its &lt;span&gt;fallback content&lt;/span&gt;, any &lt;span&gt;plugin&lt;/span&gt; instantiated for
+  the element must be removed, and the &lt;code&gt;embed&lt;/code&gt; element then represents nothing.&lt;/p&gt;
 
   &lt;p&gt;An &lt;code&gt;embed&lt;/code&gt; element is said to be &lt;dfn title=&quot;concept-embed-active&quot;&gt;potentially
   active&lt;/dfn&gt; when the following conditions are all met simultaneously:&lt;/p&gt;
@@ -26342,12 +26343,15 @@
   remaining &lt;span title=&quot;concept-embed-active&quot;&gt;potentially active&lt;/span&gt; and has its &lt;code
   title=&quot;attr-embed-type&quot;&gt;src&lt;/code&gt; attribute set, changed, or removed or its &lt;code
   title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute set, changed, or removed, the user agent must
-  &lt;span&gt;queue a task&lt;/span&gt; using the &lt;dfn&gt;embed task source&lt;/dfn&gt; to run the following steps:&lt;/p&gt;
+  &lt;span&gt;queue a task&lt;/span&gt; using the &lt;dfn&gt;embed task source&lt;/dfn&gt; to run
+  &lt;span&gt;the &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/span&gt;.&lt;/p&gt;
 
+  &lt;p&gt;&lt;dfn&gt;The &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/dfn&gt; are as follows:&lt;/p&gt;
+
   &lt;ol&gt;
 
-   &lt;li&gt;&lt;p&gt;If another &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; has since been queued to run these steps
-   for this element, then abort these steps.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;If another &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; has since been queued to run &lt;span&gt;the
+   &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/span&gt; for this element, then abort these steps.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;
 
@@ -26363,12 +26367,107 @@
       URL&lt;/span&gt;, from the element's &lt;span&gt;browsing context scope origin&lt;/span&gt; if it has one&lt;!--
       potentially http-origin privacy sensitive --&gt;. The &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that
       is &lt;span title=&quot;queue a task&quot;&gt;queued&lt;/span&gt; by the &lt;span&gt;networking task source&lt;/span&gt; once
-      the resource has been &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; must find and instantiate an
-      appropriate &lt;span&gt;plugin&lt;/span&gt; based on the &lt;span title=&quot;concept-embed-type&quot;&gt;content's
-      type&lt;/span&gt;, and hand that &lt;span&gt;plugin&lt;/span&gt; the content of the resource, replacing any
-      previously instantiated plugin for the element.&lt;/p&gt;
+      the resource has been &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; must run the following steps:&lt;/p&gt;
       &lt;!-- Note that this doesn't happen when the base URL changes. --&gt;
 
+      &lt;ol&gt;
+
+       &lt;li&gt;&lt;p&gt;If another &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; has since been queued to run
+       &lt;span&gt;the &lt;code&gt;embed&lt;/code&gt; element setup steps&lt;/span&gt; for this element, then abort these
+       steps.&lt;/p&gt;&lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;Determine the &lt;dfn title=&quot;concept-embed-type&quot;&gt;type of the content&lt;/dfn&gt; being embedded, as
+        follows (stopping at the first substep that determines the type):&lt;/p&gt;
+
+        &lt;ol&gt;
+
+         &lt;li&gt;&lt;p&gt;If the element has a &lt;code title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute, and that
+         attribute's value is a type that a &lt;span&gt;plugin&lt;/span&gt; supports, then the value of the &lt;code
+         title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute is the &lt;span title=&quot;concept-embed-type&quot;&gt;content's
+         type&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+         &lt;li&gt;
+
+          &lt;!-- if we get to this point we know we can successfully parsed the URL, since this algorithm is
+          only used after fetching the resource in the steps above --&gt;
+
+          &lt;p&gt;Otherwise, if applying the &lt;span&gt;URL parser&lt;/span&gt; algorithm to the &lt;span&gt;URL&lt;/span&gt; of the
+          specified resource (after any redirects) results in a &lt;span&gt;parsed URL&lt;/span&gt; whose &lt;span
+          title=&quot;concept-url-path&quot;&gt;path&lt;/span&gt; component matches a pattern that a &lt;span&gt;plugin&lt;/span&gt;
+          supports, then the &lt;span title=&quot;concept-embed-type&quot;&gt;content's type&lt;/span&gt; is the type that that
+          plugin can handle.&lt;/p&gt;
+
+          &lt;p class=&quot;example&quot;&gt;For example, a plugin might say that it can handle resources with &lt;span
+          title=&quot;concept-url-path&quot;&gt;path&lt;/span&gt; components that end with the four character string &quot;&lt;code
+          title=&quot;&quot;&gt;.swf&lt;/code&gt;&quot;.&lt;/p&gt;
+
+          &lt;!-- it's sad that we have to do extension sniffing. sigh. --&gt;
+          &lt;!-- see also &lt;object&gt; which has a similar step --&gt;
+
+         &lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;Otherwise, if the specified resource has &lt;span title=&quot;Content-Type&quot;&gt;explicit Content-Type
+         metadata&lt;/span&gt;, then that is the &lt;span title=&quot;concept-embed-type&quot;&gt;content's
+         type&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;Otherwise, the content has no &lt;span title=&quot;concept-embed-type&quot;&gt;type&lt;/span&gt; and there can
+         be no appropriate &lt;span&gt;plugin&lt;/span&gt; for it.&lt;/p&gt;&lt;/li&gt;
+
+         &lt;!-- This algorithm is a monument to bad design. Go legacy! --&gt;
+
+        &lt;/ol&gt;
+
+       &lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;If the previous step determined that the &lt;span title=&quot;concept-embed-type&quot;&gt;content's
+        type&lt;/span&gt; is &lt;code title=&quot;&quot;&gt;image/svg+xml&lt;/code&gt;, then run the following substeps:&lt;/p&gt;
+
+        &lt;ol&gt;
+
+         &lt;li&gt;&lt;p&gt;If the &lt;code&gt;embed&lt;/code&gt; element is not associated with a &lt;span&gt;nested browsing
+         context&lt;/span&gt;, associate the element with a newly created &lt;span&gt;nested browsing
+         context&lt;/span&gt;, and, if the element has a &lt;code title=&quot;attr-embed-name&quot;&gt;name&lt;/code&gt;
+         attribute, set the &lt;span&gt;browsing context name&lt;/span&gt; of the element's &lt;span&gt;nested
+         browsing context&lt;/span&gt; to the value of this attribute.&lt;/p&gt;
+         &lt;!-- <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2291">http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2291</A> - dynamic changes to 'name' don't do anything --&gt;
+
+         &lt;li&gt;&lt;p&gt;&lt;span&gt;Navigate&lt;/span&gt;&lt;!--DONAV object--&gt; the &lt;span&gt;nested browsing context&lt;/span&gt; to
+         the fetched resource, with &lt;span&gt;replacement enabled&lt;/span&gt;, and with the
+         &lt;code&gt;embed&lt;/code&gt; element's document's &lt;span&gt;browsing context&lt;/span&gt; as the &lt;span&gt;source
+         browsing context&lt;/span&gt;. (The &lt;code title=&quot;attr-embed-src&quot;&gt;src&lt;/code&gt; attribute of the
+         &lt;code&gt;embed&lt;/code&gt; element doesn't get updated if the browsing context gets further
+         navigated to other locations.)&lt;/p&gt;&lt;/li&gt;
+
+         &lt;li&gt;&lt;p&gt;The &lt;code&gt;object&lt;/code&gt; element now &lt;span&gt;represents&lt;/span&gt; its associated
+         &lt;span&gt;nested browsing context&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+        &lt;/ol&gt;
+
+       &lt;/li&gt;
+
+       &lt;li&gt;
+
+        &lt;p&gt;Otherwise, find and instantiate an appropriate &lt;span&gt;plugin&lt;/span&gt; based on the &lt;span
+        title=&quot;concept-embed-type&quot;&gt;content's type&lt;/span&gt;, and hand that &lt;span&gt;plugin&lt;/span&gt; the
+        content of the resource, replacing any previously instantiated plugin for the element. The
+        &lt;code&gt;embed&lt;/code&gt; element now represents this &lt;span&gt;plugin&lt;/span&gt; instance.&lt;/p&gt;
+
+       &lt;/li&gt;
+
+      &lt;/ol&gt;
+
+      &lt;p&gt;Whether the resource is fetched successfully or not (e.g. whether the response code was a
+      2xx code &lt;span title=&quot;concept-http-equivalent-codes&quot;&gt;or equivalent&lt;/span&gt;) must be ignored
+      when determining the &lt;span title=&quot;concept-embed-type&quot;&gt;content's type&lt;/span&gt; and when handing
+      the resource to the plugin.&lt;/p&gt;
+
+      &lt;p class=&quot;note&quot;&gt;This allows servers to return data for plugins even with error responses (e.g.
+      HTTP 500 Internal Server Error codes can still contain plugin data).&lt;/p&gt;
+
       &lt;p&gt;Fetching the resource must &lt;span&gt;delay the load event&lt;/span&gt; of the element's document.&lt;/p&gt;
       &lt;!-- if we add load/error events, then replace the previous paragraph with the text one: --&gt;
       &lt;!-- similar text in various places --&gt;
@@ -26381,15 +26480,25 @@
 
      &lt;dt&gt;If the element has no &lt;code title=&quot;attr-embed-src&quot;&gt;src&lt;/code&gt; attribute set&lt;/dt&gt;
 
-     &lt;dd&gt;&lt;p&gt;The user agent should find and instantiate an appropriate &lt;span&gt;plugin&lt;/span&gt; based on
-     the value of the &lt;code title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute.&lt;/p&gt;
+     &lt;dd&gt;
 
+      &lt;p&gt;The user agent should find and instantiate an appropriate &lt;span&gt;plugin&lt;/span&gt; based on the
+      value of the &lt;code title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute. The &lt;code&gt;embed&lt;/code&gt;
+      element now represents this &lt;span&gt;plugin&lt;/span&gt; instance.&lt;/p&gt;
+
+     &lt;/dd&gt;
+
     &lt;/dl&gt;
 
    &lt;/li&gt;
 
   &lt;/ol&gt;
 
+  &lt;p&gt;The &lt;code&gt;embed&lt;/code&gt; element has no &lt;span&gt;fallback content&lt;/span&gt;. If the user agent can't
+  find a suitable plugin when attempting to find and instantiate one for the algorithm above, then
+  the user agent must use a default plugin. This default could be as simple as saying &quot;Unsupported
+  Format&quot;.&lt;/p&gt;
+
   &lt;p&gt;Whenever an &lt;code&gt;embed&lt;/code&gt; element that was &lt;span title=&quot;concept-embed-active&quot;&gt;potentially
   active&lt;/span&gt; stops being &lt;span title=&quot;concept-embed-active&quot;&gt;potentially active&lt;/span&gt;, any
   &lt;span&gt;plugin&lt;/span&gt; that had been instantiated for that element must be unloaded.&lt;/p&gt;
@@ -26409,58 +26518,6 @@
   agents should convey the danger of overriding the sandbox to the user if an option to do so is
   provided.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn title=&quot;concept-embed-type&quot;&gt;type of the content&lt;/dfn&gt; being embedded is defined as
-  follows:&lt;/p&gt;
-
-  &lt;ol&gt;
-
-   &lt;li&gt;&lt;p&gt;If the element has a &lt;code title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute, and that
-   attribute's value is a type that a &lt;span&gt;plugin&lt;/span&gt; supports, then the value of the &lt;code
-   title=&quot;attr-embed-type&quot;&gt;type&lt;/code&gt; attribute is the &lt;span title=&quot;concept-embed-type&quot;&gt;content's
-   type&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;!-- if we get to this point we know we can successfully parsed the URL, since this algorithm is
-    only used after fetching the resource in the steps above --&gt;
-
-    &lt;p&gt;Otherwise, if applying the &lt;span&gt;URL parser&lt;/span&gt; algorithm to the &lt;span&gt;URL&lt;/span&gt; of the
-    specified resource (after any redirects) results in a &lt;span&gt;parsed URL&lt;/span&gt; whose &lt;span
-    title=&quot;concept-url-path&quot;&gt;path&lt;/span&gt; component matches a pattern that a &lt;span&gt;plugin&lt;/span&gt;
-    supports, then the &lt;span title=&quot;concept-embed-type&quot;&gt;content's type&lt;/span&gt; is the type that that
-    plugin can handle.&lt;/p&gt;
-
-    &lt;p class=&quot;example&quot;&gt;For example, a plugin might say that it can handle resources with &lt;span
-    title=&quot;concept-url-path&quot;&gt;path&lt;/span&gt; components that end with the four character string &quot;&lt;code
-    title=&quot;&quot;&gt;.swf&lt;/code&gt;&quot;.&lt;/p&gt;
-
-    &lt;!-- it's sad that we have to do extension sniffing. sigh. --&gt;
-    &lt;!-- see also &lt;object&gt; which has a similar step --&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, if the specified resource has &lt;span title=&quot;Content-Type&quot;&gt;explicit Content-Type
-   metadata&lt;/span&gt;, then that is the &lt;span title=&quot;concept-embed-type&quot;&gt;content's
-   type&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Otherwise, the content has no type and there can be no appropriate &lt;span&gt;plugin&lt;/span&gt; for
-   it.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;!-- This algorithm is a monument to bad design. Go legacy! --&gt;
-
-  &lt;/ol&gt;
-
-  &lt;p&gt;The &lt;code&gt;embed&lt;/code&gt; element has no &lt;span&gt;fallback content&lt;/span&gt;. If the user agent can't
-  find a suitable plugin, then the user agent must use a default plugin. (This default could be as
-  simple as saying &quot;Unsupported Format&quot;.)&lt;/p&gt;
-
-  &lt;p&gt;Whether the resource is fetched successfully or not (e.g. whether the response code was a 2xx
-  code &lt;span title=&quot;concept-http-equivalent-codes&quot;&gt;or equivalent&lt;/span&gt;) must be ignored when
-  determining the resource's type and when handing the resource to the plugin.&lt;/p&gt;
-
-  &lt;p class=&quot;note&quot;&gt;This allows servers to return data for plugins even with error responses (e.g.
-  HTTP 500 Internal Server Error codes can still contain plugin data).&lt;/p&gt;
-
   &lt;/div&gt;
 
   &lt;p&gt;Any namespace-less attribute other than &lt;code title=&quot;attr-embed-name&quot;&gt;name&lt;/code&gt;, &lt;code
@@ -26479,10 +26536,10 @@
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;p&gt;The user agent should pass the names and values of all the attributes of the &lt;code&gt;embed&lt;/code&gt;
-  element that have no namespace to the &lt;span&gt;plugin&lt;/span&gt; used, when it is instantiated.&lt;/p&gt;
+  element that have no namespace to the &lt;span&gt;plugin&lt;/span&gt; used, when one is instantiated.&lt;/p&gt;
 
   &lt;p&gt;The &lt;code&gt;HTMLEmbedElement&lt;/code&gt; object representing the element must expose the scriptable
-  interface of the &lt;span&gt;plugin&lt;/span&gt; instantiated for the &lt;code&gt;embed&lt;/code&gt; element. At a
+  interface of the &lt;span&gt;plugin&lt;/span&gt; instantiated for the &lt;code&gt;embed&lt;/code&gt; element, if any. At a
   minimum, this interface must implement the &lt;dfn title=&quot;dom-embed-caller&quot;&gt;legacy caller
   operation&lt;/dfn&gt;. (It is suggested that the default behavior of this legacy caller operation, e.g.
   the behavior of the default plugin's legacy caller operation, be to throw a


</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014771.html">[html5] r7913 - [e] (0) Fix some typos or copypasta. Affected	topics: HTML, Video and Audio
</A></li>
	<LI>Next message: <A HREF="014773.html">[html5] r7915 - [e] (0) Move .style to CSSOM Fixing	https://www.w3.org/Bugs/Public/show_bug.cgi? [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14772">[ date ]</a>
              <a href="thread.html#14772">[ thread ]</a>
              <a href="subject.html#14772">[ subject ]</a>
              <a href="author.html#14772">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
