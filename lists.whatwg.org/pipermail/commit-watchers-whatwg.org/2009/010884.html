<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r4011 - [] (0) Synchronise with the latest Origin spec	rules and semantics. Fixing http: [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r4011%20-%20%5B%5D%20%280%29%20Synchronise%20with%20the%20latest%20Origin%20spec%0A%09rules%20and%20semantics.%20Fixing%20http%3A%20%5B...%5D&In-Reply-To=%3C20090928235110.4531738E20C%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010883.html">
   <LINK REL="Next"  HREF="010885.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r4011 - [] (0) Synchronise with the latest Origin spec	rules and semantics. Fixing http: [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r4011%20-%20%5B%5D%20%280%29%20Synchronise%20with%20the%20latest%20Origin%20spec%0A%09rules%20and%20semantics.%20Fixing%20http%3A%20%5B...%5D&In-Reply-To=%3C20090928235110.4531738E20C%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r4011 - [] (0) Synchronise with the latest Origin spec	rules and semantics. Fixing http: [...]">whatwg at whatwg.org
       </A><BR>
    <I>Mon Sep 28 16:51:10 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="010883.html">[html5] r4010 - [e] (0) Clarify that 'invalid' sometimes has a	default action and sometimes does [...]
</A></li>
        <LI>Next message: <A HREF="010885.html">[html5] r4012 - [e] (0) Add an example for pushState(). Fixing	http://www.w3.org/Bugs/Public/sho [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10884">[ date ]</a>
              <a href="thread.html#10884">[ thread ]</a>
              <a href="subject.html#10884">[ subject ]</a>
              <a href="author.html#10884">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2009-09-28 16:51:09 -0700 (Mon, 28 Sep 2009)
New Revision: 4011

Modified:
   index
   source
Log:
[] (0) Synchronise with the latest Origin spec rules and semantics.
Fixing <A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=7599">http://www.w3.org/Bugs/Public/show_bug.cgi?id=7599</A>

Modified: index
===================================================================
--- index	2009-09-28 21:00:58 UTC (rev 4010)
+++ index	2009-09-28 23:51:09 UTC (rev 4011)
@@ -5003,8 +5003,9 @@
 
   &lt;h3 id=fetching-resources&gt;&lt;span class=secno&gt;2.6 &lt;/span&gt;Fetching resources&lt;/h3&gt;
 
-  &lt;p&gt;When a user agent is to &lt;dfn id=fetch&gt;fetch&lt;/dfn&gt; a resource, the
-  following steps must be run:&lt;/p&gt;
+  &lt;p&gt;When a user agent is to &lt;dfn id=fetch&gt;fetch&lt;/dfn&gt; a resource, optionally
+  from an origin &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, the following steps must be
+  run:&lt;/p&gt;
 
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the resource is identified by the &lt;a href=#url&gt;URL&lt;/a&gt;
    &lt;dfn id=about:blank&gt;&lt;code&gt;about:blank&lt;/code&gt;&lt;/dfn&gt;, then return the empty string
@@ -5018,11 +5019,11 @@
     and the resource is to be obtained using an idempotent action
     (such as an HTTP GET &lt;a href=#concept-http-equivalent-get title=concept-http-equivalent-get&gt;or
     equivalent&lt;/a&gt;), and it is already being downloaded for other
-    reasons (e.g. another invocation of this algorithm), and the user
-    agent is configured such that it is to reuse the data from the
-    existing download instead of initiating a new one, then use the
-    results of the existing download instead of starting a new
-    one.&lt;/p&gt;
+    reasons (e.g. another invocation of this algorithm), and this
+    request would be identical to the previous one (e.g. same &lt;code title=http-accept&gt;Accept&lt;/code&gt; and &lt;code title=http-origin&gt;Origin&lt;/code&gt; headers), and the user agent is
+    configured such that it is to reuse the data from the existing
+    download instead of initiating a new one, then use the results of
+    the existing download instead of starting a new one.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, at a time convenient to the user and the user agent,
     download (or otherwise obtain) the resource, applying the
@@ -5052,8 +5053,13 @@
      browsing context&quot;&gt;browsing context&lt;/a&gt; of the &lt;a href=#first-script&gt;first
      script&lt;/a&gt;.&lt;/dd&gt;
 
-    &lt;/dl&gt;&lt;/li&gt;
+    &lt;/dl&gt;&lt;p&gt;For the purposes of the &lt;code title=http-origin&gt;Origin&lt;/code&gt;
+    header, if the &lt;a href=#fetch title=fetch&gt;fetching algorithm&lt;/a&gt; was
+    explicitly initiated from an &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, then &lt;i title=&quot;&quot;&gt;the origin that initiated the HTTP request&lt;/i&gt; is &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;. Otherwise, this is &lt;i title=&quot;&quot;&gt;a request from
+    a &quot;privacy-sensitive&quot; context&lt;/i&gt;. &lt;a href=#refsORIGIN&gt;[ORIGIN]&lt;/a&gt;&lt;/p&gt;
 
+   &lt;/li&gt;
+
    &lt;li&gt;
 
     &lt;p&gt;If there are cookies to be set, then the user agent must run
@@ -10550,14 +10556,13 @@
   applied (as defined below). &lt;span class=impl&gt;For external
   resources that are represented in the DOM (for example, style
   sheets), the DOM representation must be made available even if the
-  resource is not applied. To obtain the resource, the user agent must
-  &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt; the &lt;a href=#url&gt;URL&lt;/a&gt;
-  given by the &lt;code title=attr-link-href&gt;&lt;a href=#attr-link-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute,
-  relative to the element, and then &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting
-  &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;. User agents may opt to only
-  &lt;a href=#fetch&gt;fetch&lt;/a&gt; such resources when they are needed, instead of
-  pro-actively &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; all the external
-  resources that are not applied.&lt;/span&gt;&lt;/p&gt;
+  resource is not applied. To &lt;dfn id=concept-link-obtain title=concept-link-obtain&gt;obtain
+  the resource&lt;/dfn&gt;, the user agent must &lt;a href=#resolve-a-url title=&quot;resolve a
+  url&quot;&gt;resolve&lt;/a&gt; the &lt;a href=#url&gt;URL&lt;/a&gt; given by the &lt;code title=attr-link-href&gt;&lt;a href=#attr-link-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute, relative to the
+  element, and then &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute
+  URL&lt;/a&gt;. User agents may opt to only &lt;a href=#fetch&gt;fetch&lt;/a&gt; such
+  resources when they are needed, instead of pro-actively &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; all the external resources that are
+  not applied.&lt;/span&gt;&lt;/p&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;div class=impl&gt;
 
@@ -10671,15 +10676,14 @@
   the given type. If the attribute is omitted, but the external
   resource link type has a default type defined, then the user agent
   must assume that the resource is of that type. If the UA does not
-  support the given &lt;a href=#mime-type&gt;MIME type&lt;/a&gt; for the given link relationship, then
-  the UA should not fetch the resource; if the UA does support the
-  given &lt;a href=#mime-type&gt;MIME type&lt;/a&gt; for the given link relationship, then the UA should
-  &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resource. If the attribute is omitted, and
-  the external resource link type does not have a default type
-  defined, but the user agent would fetch the resource if the type was
-  known and supported, then the user agent should &lt;a href=#fetch&gt;fetch&lt;/a&gt;
-  the resource under the assumption that it will be
-  supported.&lt;/span&gt;&lt;/p&gt;
+  support the given &lt;a href=#mime-type&gt;MIME type&lt;/a&gt; for the given link
+  relationship, then the UA should not &lt;a href=#concept-link-obtain title=concept-link-obtain&gt;obtain&lt;/a&gt; the resource; if the UA
+  does support the given &lt;a href=#mime-type&gt;MIME type&lt;/a&gt; for the given link
+  relationship, then the UA should &lt;a href=#concept-link-obtain title=concept-link-obtain&gt;obtain&lt;/a&gt; the resource. If the
+  attribute is omitted, and the external resource link type does not
+  have a default type defined, but the user agent would &lt;a href=#concept-link-obtain title=concept-link-obtain&gt;obtain&lt;/a&gt; the resource if the type
+  was known and supported, then the user agent should &lt;a href=#concept-link-obtain title=concept-link-obtain&gt;obtain&lt;/a&gt; the resource under the
+  assumption that it will be supported.&lt;/span&gt;&lt;/p&gt;
 
   &lt;div class=impl&gt;
 
@@ -12117,7 +12121,9 @@
 
     &lt;p&gt;If the element has a &lt;code title=attr-script-src&gt;&lt;a href=#attr-script-src&gt;src&lt;/a&gt;&lt;/code&gt;
     attribute, then the value of that attribute must be &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt; relative to the element, and
-    if that is successful, the specified resource must then be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;.&lt;/p&gt;
+    if that is successful, the specified resource must then be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;, from the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
+    element's &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt; &lt;!-- not http-origin privacy
+    sensitive --&gt;
 
     &lt;p&gt;For historical reasons, if the &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;a href=#javascript-protocol title=&quot;javascript protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt;
     URL&lt;/a&gt;, then the user agent must not, despite the requirements
@@ -18356,7 +18362,8 @@
   user agent must &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolve&lt;/a&gt; the value
   of that attribute, relative to the element, and if that is
   successful must then &lt;a href=#fetch&gt;fetch&lt;/a&gt; that resource.&lt;/p&gt; &lt;!-- Note
-  how this does NOT happen when the base URL changes. --&gt;
+  how this does NOT happen when the base URL changes. --&gt; &lt;!--
+  http-origin privacy sensitive --&gt;
 
   &lt;p&gt;The &lt;code title=attr-img-src&gt;&lt;a href=#attr-img-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute's value is an
   &lt;i&gt;ignored self-reference&lt;/i&gt; if its value is the empty string, and
@@ -20257,7 +20264,9 @@
     the value of the element's &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt;
     attribute, relative to the element. If that is successful, the
     user agent should &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute
-    URL&lt;/a&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is
+    URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope
+    origin&lt;/a&gt; if it has one&lt;!-- potentially http-origin privacy
+    sensitive --&gt;. The &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; that is
     &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; by the &lt;a href=#networking-task-source&gt;networking
     task source&lt;/a&gt; once the resource has been &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt; must find and instantiate an
     appropriate &lt;a href=#plugin&gt;plugin&lt;/a&gt; based on the &lt;a href=#concept-embed-type title=concept-embed-type&gt;content's type&lt;/a&gt;, and hand that
@@ -20558,7 +20567,9 @@
       element.&lt;/p&gt;
 
       &lt;p&gt;If that is successful, &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting
-      &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;.&lt;/p&gt;
+      &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, from the element's &lt;a href=#browsing-context-scope-origin&gt;browsing
+      context scope origin&lt;/a&gt; if it has one&lt;!-- potentially
+      http-origin privacy sensitive --&gt;.&lt;/p&gt;
 
       &lt;!-- similar text in various places --&gt;
       &lt;p&gt;Fetching the resource must &lt;a href=#delay-the-load-event&gt;delay the load event&lt;/a&gt;
@@ -21051,10 +21062,12 @@
   or when the &lt;code title=attr-video-poster&gt;&lt;a href=#attr-video-poster&gt;poster&lt;/a&gt;&lt;/code&gt; attribute
   is set, its value must be &lt;a href=#resolve-a-url title=&quot;resolve a
   url&quot;&gt;resolved&lt;/a&gt; relative to the element, and if that is
-  successful, the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; must be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;; this must &lt;a href=#delay-the-load-event&gt;delay the load
-  event&lt;/a&gt; of the element's document. The &lt;dfn id=poster-frame&gt;poster frame&lt;/dfn&gt;
-  is then the image obtained from that resource, if any.&lt;/span&gt;&lt;/p&gt;
-  &lt;!-- thus it is unaffected by changes to the base URL. --&gt;
+  successful, the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; must be &lt;a href=#fetch title=fetch&gt;fetched&lt;/a&gt;, from the element's
+  &lt;code&gt;Document&lt;/code&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;; this must &lt;a href=#delay-the-load-event&gt;delay
+  the load event&lt;/a&gt; of the element's document. The &lt;dfn id=poster-frame&gt;poster
+  frame&lt;/dfn&gt; is then the image obtained from that resource, if
+  any.&lt;/span&gt;&lt;/p&gt; &lt;!-- thus it is unaffected by changes to the base
+  URL. --&gt;
 
   &lt;p class=note&gt;The image given by the &lt;code title=attr-video-poster&gt;&lt;a href=#attr-video-poster&gt;poster&lt;/a&gt;&lt;/code&gt; attribute, the &lt;i&gt;&lt;a href=#poster-frame&gt;poster
   frame&lt;/a&gt;&lt;/i&gt;, is intended to be a representative frame of the video
@@ -22296,7 +22309,9 @@
    &lt;li&gt;
 
     &lt;p&gt;Begin to &lt;a href=#fetch&gt;fetch&lt;/a&gt; the &lt;var title=&quot;&quot;&gt;current media
-    resource&lt;/var&gt;.&lt;/p&gt;
+    resource&lt;/var&gt;, from the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s
+    &lt;code&gt;Document&lt;/code&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;.&lt;/p&gt; &lt;!-- not
+    http-origin privacy sensitive (looking forward to CORS here) --&gt;
 
     &lt;p&gt;Every 350ms (&plusmn;200ms) or for every byte received, whichever
     is &lt;em&gt;least&lt;/em&gt; frequent, &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to
@@ -34676,7 +34691,8 @@
   &lt;code title=attr-input-src&gt;&lt;a href=#attr-input-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute, relative to the
   element, and if that is successful, must &lt;a href=#fetch&gt;fetch&lt;/a&gt; the
   resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT
-  happen when the base URL changes. --&gt;
+  happen when the base URL changes. --&gt; &lt;!-- http-origin privacy
+  sensitive --&gt;
 
   &lt;ul&gt;&lt;li&gt;The &lt;code&gt;&lt;a href=#the-input-element&gt;input&lt;/a&gt;&lt;/code&gt; element's &lt;code title=attr-input-type&gt;&lt;a href=#attr-input-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute is first set to the
    &lt;a href=#image-button-state title=attr-input-type-image&gt;Image Button&lt;/a&gt; state
@@ -42341,14 +42357,15 @@
    &lt;dd&gt;Append the command to the menu, respecting its &lt;a href=#concept-facet title=concept-facet&gt;facets&lt;/a&gt;&lt;!-- we might need to be
    explicit about what this means for each facet, if testing shows
    this isn't well-implemented. e.g.: If there's an Icon facet for the
-   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;, and then
-   that image should be associated with the command, such that each
-   command only has its image fetched once, to prevent changes to the
-   base URL from having effects after the image has been fetched
-   once. (no need to resolve the Icon facet, it's an absolute URL)
-   --&gt;. &lt;!--If the element is a &lt;code&gt;command&lt;/code&gt; element with a
-   &lt;code title=&quot;attr-command-default&quot;&gt;default&lt;/code&gt; attribute, mark
-   the command as being a default command.--&gt;&lt;/dd&gt;
+   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; (this
+   would be http-origin privacy-sensitive), and then that image should
+   be associated with the command, such that each command only has its
+   image fetched once, to prevent changes to the base URL from having
+   effects after the image has been fetched once. (no need to resolve
+   the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the element is a
+   &lt;code&gt;command&lt;/code&gt; element with a &lt;code
+   title=&quot;attr-command-default&quot;&gt;default&lt;/code&gt; attribute, mark the
+   command as being a default command.--&gt;&lt;/dd&gt;
 
 
    &lt;dt&gt;An &lt;code&gt;&lt;a href=#the-hr-element&gt;hr&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
@@ -48227,9 +48244,19 @@
    document&lt;/a&gt; of &lt;var title=&quot;&quot;&gt;A&lt;/var&gt; (possibly in fact being
    &lt;var title=&quot;&quot;&gt;A&lt;/var&gt; itself).&lt;/li&gt;
 
-  &lt;/ul&gt;&lt;/div&gt;
+  &lt;/ul&gt;&lt;hr&gt;&lt;p&gt;An element has a &lt;dfn id=browsing-context-scope-origin&gt;browsing context scope origin&lt;/dfn&gt; if its
+  &lt;code&gt;Document&lt;/code&gt;'s &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; is a
+  &lt;a href=#top-level-browsing-context&gt;top-level browsing context&lt;/a&gt; or if all of its
+  &lt;code&gt;Document&lt;/code&gt;'s &lt;a href=#ancestor-browsing-context title=&quot;ancestor browsing
+  context&quot;&gt;ancestor browsing contexts&lt;/a&gt; all have &lt;a href=#active-document title=&quot;active document&quot;&gt;active documents&lt;/a&gt; whose
+  &lt;a href=#origin&gt;origin&lt;/a&gt; are the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the
+  element's &lt;code&gt;Document&lt;/code&gt;'s &lt;a href=#origin&gt;origin&lt;/a&gt;. If an element
+  has a &lt;a href=#browsing-context-scope-origin&gt;browsing context scope origin&lt;/a&gt;, then its value is
+  the &lt;a href=#origin&gt;origin&lt;/a&gt; of the element's &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
 
+  &lt;/div&gt;
 
+
   &lt;div class=impl&gt;
 
   &lt;h4 id=groupings-of-browsing-contexts&gt;&lt;span class=secno&gt;6.1.5 &lt;/span&gt;Groupings of browsing contexts&lt;/h4&gt;
@@ -52709,7 +52736,9 @@
    &lt;li&gt;
 
     &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource
-    from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; be that resource.&lt;/p&gt;
+    from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, and let &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; be that resource.&lt;/p&gt; &lt;!-- http-origin
+    privacy sensitive, though it doesn't matter, since this can never
+    be cross-origin --&gt;
 
     &lt;p&gt;If the resource is labeled with the &lt;a href=#mime-type&gt;MIME type&lt;/a&gt;
     &lt;code&gt;&lt;a href=#text/cache-manifest&gt;text/cache-manifest&lt;/a&gt;&lt;/code&gt;, parse &lt;var title=&quot;&quot;&gt;manifest&lt;/var&gt; according to the &lt;a href=#parse-a-manifest title=&quot;parse a
@@ -52922,18 +52951,20 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource. If this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade attempt&lt;/a&gt;, then
-      use the &lt;a href=#concept-appcache-newer title=concept-appcache-newer&gt;newest&lt;/a&gt;
-      &lt;a href=#application-cache&gt;application cache&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;cache
-      group&lt;/var&gt; as an HTTP cache, and honor HTTP caching semantics
-      (such as expiration, ETags, and so forth) with respect to that
-      cache. User agents may also have other caches in place that are
-      also honored.&lt;/p&gt;
+      &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource, from the &lt;a href=#origin&gt;origin&lt;/a&gt;
+      of the &lt;a href=#url&gt;URL&lt;/a&gt; &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;. If
+      this is an &lt;a href=#concept-appcache-upgrade title=concept-appcache-upgrade&gt;upgrade
+      attempt&lt;/a&gt;, then use the &lt;a href=#concept-appcache-newer title=concept-appcache-newer&gt;newest&lt;/a&gt; &lt;a href=#application-cache&gt;application
+      cache&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;cache group&lt;/var&gt; as an HTTP
+      cache, and honor HTTP caching semantics (such as expiration,
+      ETags, and so forth) with respect to that cache. User agents may
+      also have other caches in place that are also honored.&lt;/p&gt; &lt;!--
+      not http-origin privacy sensitive --&gt;
 
       &lt;p class=note&gt;If the resource in question is already being
       downloaded for other reasons then the existing download process
-      can be used for the purposes of this step, as defined by the
-      &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; algorithm.&lt;/p&gt;
+      can sometimes be used for the purposes of this step, as defined
+      by the &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; algorithm.&lt;/p&gt;
 
       &lt;p class=example&gt;An example of a resource that might already
       be being downloaded is a large image on a Web page that is being
@@ -53088,7 +53119,8 @@
 
     &lt;p&gt;&lt;a href=#fetch&gt;Fetch&lt;/a&gt; the resource from &lt;var title=&quot;&quot;&gt;manifest
     URL&lt;/var&gt; again, and let &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be
-    that resource.&lt;/p&gt;
+    that resource.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it
+    doesn't matter, since this can never be cross-origin --&gt;
 
    &lt;/li&gt;
 
@@ -54464,26 +54496,29 @@
 
     &lt;p&gt;Otherwise, &lt;a href=#fetch&gt;fetch&lt;/a&gt; the new resource, if it has not
     already been obtained&lt;!-- it's obtained by &lt;object&gt;, for instance
-    --&gt;. If the resource is being fetched using HTTP, and the method
-    is not GET&lt;!-- or HEAD (but that can't happen) --&gt;, then the user
-    agent must include an &lt;code title=http-origin&gt;Origin&lt;/code&gt;
-    header whose value is determined as follows:&lt;/p&gt;
+    --&gt;.&lt;/p&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;a href=#navigate title=navigate&gt;navigation&lt;/a&gt; algorithm has
-     so far contacted more than one &lt;a href=#origin&gt;origin&lt;/a&gt;&lt;/dt&gt;
-     &lt;dt&gt;If there is no &lt;a href=#source-browsing-context&gt;source browsing context&lt;/a&gt;&lt;/dt&gt;
+    &lt;p&gt;If the resource is being fetched using a method other than one
+    &lt;a href=#concept-http-equivalent-get title=concept-http-equivalent-get&gt;equivalent to&lt;/a&gt;
+    HTTP's GET&lt;!-- or HEAD (but that can't happen) --&gt;, or, if the
+    &lt;a href=#navigate title=navigate&gt;navigation algorithm&lt;/a&gt; was invoked as
+    a result of the &lt;a href=#concept-form-submit title=concept-form-submit&gt;form submission
+    algorithm&lt;/a&gt;, then the &lt;a href=#fetch title=fetch&gt;fetching
+    algorithm&lt;/a&gt; must be invoked from the &lt;a href=#origin&gt;origin&lt;/a&gt; of
+    the &lt;a href=#active-document&gt;active document&lt;/a&gt; of the &lt;a href=#source-browsing-context&gt;source browsing
+    context&lt;/a&gt;, if any.&lt;/p&gt; &lt;!-- potentially http-origin privacy
+    sensitive --&gt;
 
-     &lt;dd&gt;The value must be the string &quot;&lt;code title=&quot;&quot;&gt;null&lt;/code&gt;&quot;.&lt;/dd&gt;
+    &lt;p&gt;If the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; being navigated is a
+    &lt;a href=#child-browsing-context&gt;child browsing context&lt;/a&gt; for an &lt;code&gt;&lt;a href=#the-iframe-element&gt;iframe&lt;/a&gt;&lt;/code&gt; or
+    &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element, then the &lt;a href=#fetch title=fetch&gt;fetching
+    algorithm&lt;/a&gt; must be invoked from the &lt;code&gt;&lt;a href=#the-iframe-element&gt;iframe&lt;/a&gt;&lt;/code&gt; or
+    &lt;code&gt;&lt;a href=#the-object-element&gt;object&lt;/a&gt;&lt;/code&gt; element's &lt;a href=#browsing-context-scope-origin&gt;browsing context scope
+    origin&lt;/a&gt;, if it has one.&lt;/p&gt; &lt;!-- potentially http-origin
+    privacy sensitive --&gt;
 
-     &lt;dt&gt;Otherwise&lt;/dt&gt;
+   &lt;/li&gt;
 
-     &lt;dd&gt;The value must be the &lt;a href=#ascii-serialization-of-an-origin title=&quot;ASCII serialization of an
-     origin&quot;&gt;ASCII serialization&lt;/a&gt; of the &lt;a href=#origin&gt;origin&lt;/a&gt; of
-     the &lt;a href=#active-document&gt;active document&lt;/a&gt; of the &lt;a href=#source-browsing-context&gt;source browsing
-     context&lt;/a&gt; at the time the navigation was started.&lt;/dd&gt;
-
-    &lt;/dl&gt;&lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;If fetching the resource is synchronous (i.e. for &lt;a href=#javascript-protocol title=&quot;javascript protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt;
@@ -55429,7 +55464,9 @@
   &lt;a href=#fetch title=fetch&gt;fetching&lt;/a&gt; the specified URLs using the
   POST method, with an entity body with the &lt;a href=#mime-type&gt;MIME type&lt;/a&gt;
   &lt;code&gt;&lt;a href=#text/ping&gt;text/ping&lt;/a&gt;&lt;/code&gt; consisting of the four-character string
-  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;. All relevant cookie and HTTP
+  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;, from the &lt;a href=#origin&gt;origin&lt;/a&gt; of the
+  &lt;code&gt;Document&lt;/code&gt; containing the &lt;a href=#hyperlink&gt;hyperlink&lt;/a&gt;. &lt;!--
+  not http-origin privacy sensitive --&gt; All relevant cookie and HTTP
   authentication headers must be included in the request. Which other
   headers are required depends on the URLs involved.&lt;/p&gt;
 
@@ -55466,13 +55503,7 @@
    nor include a &lt;code title=http-ping-from&gt;Ping-From&lt;/code&gt; HTTP
    header.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;p&gt;In addition, an &lt;code title=http-origin&gt;Origin&lt;/code&gt; header
-  must always be included, whose value is the &lt;a href=#ascii-serialization-of-an-origin title=&quot;ASCII
-  serialization of an origin&quot;&gt;ASCII serialization&lt;/a&gt; of the
-  &lt;a href=#origin&gt;origin&lt;/a&gt; of the &lt;code&gt;Document&lt;/code&gt; containing the
-  &lt;a href=#hyperlink&gt;hyperlink&lt;/a&gt;.&lt;/p&gt;
-
-  &lt;p class=note&gt;To save bandwidth, implementors might also wish to
+  &lt;/dl&gt;&lt;p class=note&gt;To save bandwidth, implementors might also wish to
   consider omitting optional headers such as &lt;code&gt;Accept&lt;/code&gt; from
   these requests.&lt;/p&gt;
 
@@ -74053,8 +74084,10 @@
   its &lt;a href=#fallback-content&gt;fallback content&lt;/a&gt;, the element must be ignored (it
   represents nothing).&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, &lt;span class=XXX&gt;define how the element works,
-  if supported&lt;/span&gt;.&lt;/p&gt; &lt;!-- remember to delay the laod event --&gt;
+  &lt;p&gt;Otherwise, &lt;span class=XXX&gt;define how the element works, if
+  supported&lt;/span&gt;.&lt;/p&gt; &lt;!-- remember to delay the load event --&gt; &lt;!--
+  remember to include &quot;, from the element's &lt;span&gt;browsing context
+  scope origin&lt;/span&gt; if it has one&quot; when fetching --&gt;
 
   &lt;p&gt;The &lt;code&gt;&lt;a href=#the-applet-element&gt;applet&lt;/a&gt;&lt;/code&gt; element must implement the
   &lt;code&gt;&lt;a href=#htmlappletelement&gt;HTMLAppletElement&lt;/a&gt;&lt;/code&gt; interface.&lt;/p&gt;
@@ -74651,7 +74684,8 @@
 
    &lt;li&gt;&lt;p&gt;For each token that is successfully resolved,
    &lt;a href=#fetch&gt;fetch&lt;/a&gt; the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; and
-   apply the appropriate processing.&lt;/li&gt;
+   apply the appropriate processing.&lt;/li&gt; &lt;!-- http-origin privacy
+   sensitive --&gt;
 
   &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=dom-head-profile title=dom-head-profile&gt;&lt;code&gt;profile&lt;/code&gt;&lt;/dfn&gt; IDL
   attribute of the &lt;code&gt;&lt;a href=#the-head-element-0&gt;head&lt;/a&gt;&lt;/code&gt; element must &lt;a href=#reflect&gt;reflect&lt;/a&gt;
@@ -75871,6 +75905,11 @@
    in HTML/XHTML&lt;/a&gt;&lt;/cite&gt;. In &lt;cite&gt;OpenSearch 1.1 Draft 4&lt;/cite&gt;,
    Section 4.6.2. OpenSearch.org.&lt;/dd&gt;
 
+   &lt;dt id=refsORIGIN&gt;[ORIGIN]&lt;/dt&gt;
+   &lt;dd&gt;&lt;cite&gt;&lt;a href=<A HREF="http://tools.ietf.org/html/draft-abarth-origin">http://tools.ietf.org/html/draft-abarth-origin</A>&gt;The HTTP
+   Origin Header&lt;/a&gt;&lt;/cite&gt;, A. Barth, C. Jackson, I. Hickson. IETF,
+   September 2009.&lt;/dd&gt;
+
    &lt;dt id=refsPINGBACK&gt;[PINGBACK]&lt;/dt&gt;
    &lt;dd&gt;&lt;cite&gt;&lt;a href=<A HREF="http://www.hixie.ch/specs/pingback/pingback">http://www.hixie.ch/specs/pingback/pingback</A>&gt;Pingback
    1.0&lt;/a&gt;&lt;/cite&gt;, S. Langridge, I. Hickson. January 2007.&lt;/dd&gt;

Modified: source
===================================================================
--- source	2009-09-28 21:00:58 UTC (rev 4010)
+++ source	2009-09-28 23:51:09 UTC (rev 4011)
@@ -4662,8 +4662,9 @@
 
   &lt;h3&gt;Fetching resources&lt;/h3&gt;
 
-  &lt;p&gt;When a user agent is to &lt;dfn&gt;fetch&lt;/dfn&gt; a resource, the
-  following steps must be run:&lt;/p&gt;
+  &lt;p&gt;When a user agent is to &lt;dfn&gt;fetch&lt;/dfn&gt; a resource, optionally
+  from an origin &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, the following steps must be
+  run:&lt;/p&gt;
 
   &lt;ol&gt;
 
@@ -4679,11 +4680,13 @@
     and the resource is to be obtained using an idempotent action
     (such as an HTTP GET &lt;span title=&quot;concept-http-equivalent-get&quot;&gt;or
     equivalent&lt;/span&gt;), and it is already being downloaded for other
-    reasons (e.g. another invocation of this algorithm), and the user
-    agent is configured such that it is to reuse the data from the
-    existing download instead of initiating a new one, then use the
-    results of the existing download instead of starting a new
-    one.&lt;/p&gt;
+    reasons (e.g. another invocation of this algorithm), and this
+    request would be identical to the previous one (e.g. same &lt;code
+    title=&quot;http-accept&quot;&gt;Accept&lt;/code&gt; and &lt;code
+    title=&quot;http-origin&quot;&gt;Origin&lt;/code&gt; headers), and the user agent is
+    configured such that it is to reuse the data from the existing
+    download instead of initiating a new one, then use the results of
+    the existing download instead of starting a new one.&lt;/p&gt;
 
     &lt;p&gt;Otherwise, at a time convenient to the user and the user agent,
     download (or otherwise obtain) the resource, applying the
@@ -4719,6 +4722,14 @@
 
     &lt;/dl&gt;
 
+    &lt;p&gt;For the purposes of the &lt;code title=&quot;http-origin&quot;&gt;Origin&lt;/code&gt;
+    header, if the &lt;span title=&quot;fetch&quot;&gt;fetching algorithm&lt;/span&gt; was
+    explicitly initiated from an &lt;i title=&quot;&quot;&gt;origin&lt;/i&gt;, then &lt;i
+    title=&quot;&quot;&gt;the origin that initiated the HTTP request&lt;/i&gt; is &lt;i
+    title=&quot;&quot;&gt;origin&lt;/i&gt;. Otherwise, this is &lt;i title=&quot;&quot;&gt;a request from
+    a &quot;privacy-sensitive&quot; context&lt;/i&gt;. &lt;a
+    href=&quot;#refsORIGIN&quot;&gt;[ORIGIN]&lt;/a&gt;&lt;/p&gt;
+
    &lt;/li&gt;
 
    &lt;li&gt;
@@ -11019,14 +11030,15 @@
   applied (as defined below). &lt;span class=&quot;impl&quot;&gt;For external
   resources that are represented in the DOM (for example, style
   sheets), the DOM representation must be made available even if the
-  resource is not applied. To obtain the resource, the user agent must
-  &lt;span title=&quot;resolve a url&quot;&gt;resolve&lt;/span&gt; the &lt;span&gt;URL&lt;/span&gt;
-  given by the &lt;code title=&quot;attr-link-href&quot;&gt;href&lt;/code&gt; attribute,
-  relative to the element, and then &lt;span&gt;fetch&lt;/span&gt; the resulting
-  &lt;span&gt;absolute URL&lt;/span&gt;. User agents may opt to only
-  &lt;span&gt;fetch&lt;/span&gt; such resources when they are needed, instead of
-  pro-actively &lt;span title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; all the external
-  resources that are not applied.&lt;/span&gt;&lt;/p&gt;
+  resource is not applied. To &lt;dfn title=&quot;concept-link-obtain&quot;&gt;obtain
+  the resource&lt;/dfn&gt;, the user agent must &lt;span title=&quot;resolve a
+  url&quot;&gt;resolve&lt;/span&gt; the &lt;span&gt;URL&lt;/span&gt; given by the &lt;code
+  title=&quot;attr-link-href&quot;&gt;href&lt;/code&gt; attribute, relative to the
+  element, and then &lt;span&gt;fetch&lt;/span&gt; the resulting &lt;span&gt;absolute
+  URL&lt;/span&gt;. User agents may opt to only &lt;span&gt;fetch&lt;/span&gt; such
+  resources when they are needed, instead of pro-actively &lt;span
+  title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; all the external resources that are
+  not applied.&lt;/span&gt;&lt;/p&gt; &lt;!-- http-origin privacy sensitive --&gt;
 
   &lt;div class=&quot;impl&quot;&gt;
 
@@ -11161,15 +11173,18 @@
   the given type. If the attribute is omitted, but the external
   resource link type has a default type defined, then the user agent
   must assume that the resource is of that type. If the UA does not
-  support the given &lt;span&gt;MIME type&lt;/span&gt; for the given link relationship, then
-  the UA should not fetch the resource; if the UA does support the
-  given &lt;span&gt;MIME type&lt;/span&gt; for the given link relationship, then the UA should
-  &lt;span&gt;fetch&lt;/span&gt; the resource. If the attribute is omitted, and
-  the external resource link type does not have a default type
-  defined, but the user agent would fetch the resource if the type was
-  known and supported, then the user agent should &lt;span&gt;fetch&lt;/span&gt;
-  the resource under the assumption that it will be
-  supported.&lt;/span&gt;&lt;/p&gt;
+  support the given &lt;span&gt;MIME type&lt;/span&gt; for the given link
+  relationship, then the UA should not &lt;span
+  title=&quot;concept-link-obtain&quot;&gt;obtain&lt;/span&gt; the resource; if the UA
+  does support the given &lt;span&gt;MIME type&lt;/span&gt; for the given link
+  relationship, then the UA should &lt;span
+  title=&quot;concept-link-obtain&quot;&gt;obtain&lt;/span&gt; the resource. If the
+  attribute is omitted, and the external resource link type does not
+  have a default type defined, but the user agent would &lt;span
+  title=&quot;concept-link-obtain&quot;&gt;obtain&lt;/span&gt; the resource if the type
+  was known and supported, then the user agent should &lt;span
+  title=&quot;concept-link-obtain&quot;&gt;obtain&lt;/span&gt; the resource under the
+  assumption that it will be supported.&lt;/span&gt;&lt;/p&gt;
 
   &lt;div class=&quot;impl&quot;&gt;
 
@@ -12829,7 +12844,9 @@
     attribute, then the value of that attribute must be &lt;span
     title=&quot;resolve a url&quot;&gt;resolved&lt;/span&gt; relative to the element, and
     if that is successful, the specified resource must then be &lt;span
-    title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;.&lt;/p&gt;
+    title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;, from the &lt;span&gt;origin&lt;/span&gt; of the
+    element's &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt; &lt;!-- not http-origin privacy
+    sensitive --&gt;
 
     &lt;p&gt;For historical reasons, if the &lt;span&gt;URL&lt;/span&gt; is a &lt;span
     title=&quot;javascript protocol&quot;&gt;&lt;code title=&quot;&quot;&gt;javascript:&lt;/code&gt;
@@ -19644,7 +19661,8 @@
   user agent must &lt;span title=&quot;resolve a url&quot;&gt;resolve&lt;/span&gt; the value
   of that attribute, relative to the element, and if that is
   successful must then &lt;span&gt;fetch&lt;/span&gt; that resource.&lt;/p&gt; &lt;!-- Note
-  how this does NOT happen when the base URL changes. --&gt;
+  how this does NOT happen when the base URL changes. --&gt; &lt;!--
+  http-origin privacy sensitive --&gt;
 
   &lt;p&gt;The &lt;code title=&quot;attr-img-src&quot;&gt;src&lt;/code&gt; attribute's value is an
   &lt;i&gt;ignored self-reference&lt;/i&gt; if its value is the empty string, and
@@ -21716,7 +21734,9 @@
     the value of the element's &lt;code title=&quot;attr-embed-src&quot;&gt;src&lt;/code&gt;
     attribute, relative to the element. If that is successful, the
     user agent should &lt;span&gt;fetch&lt;/span&gt; the resulting &lt;span&gt;absolute
-    URL&lt;/span&gt;. The &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that is
+    URL&lt;/span&gt;, from the element's &lt;span&gt;browsing context scope
+    origin&lt;/span&gt; if it has one&lt;!-- potentially http-origin privacy
+    sensitive --&gt;. The &lt;span title=&quot;concept-task&quot;&gt;task&lt;/span&gt; that is
     &lt;span title=&quot;queue a task&quot;&gt;queued&lt;/span&gt; by the &lt;span&gt;networking
     task source&lt;/span&gt; once the resource has been &lt;span
     title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; must find and instantiate an
@@ -22048,7 +22068,9 @@
       element.&lt;/p&gt;
 
       &lt;p&gt;If that is successful, &lt;span&gt;fetch&lt;/span&gt; the resulting
-      &lt;span&gt;absolute URL&lt;/span&gt;.&lt;/p&gt;
+      &lt;span&gt;absolute URL&lt;/span&gt;, from the element's &lt;span&gt;browsing
+      context scope origin&lt;/span&gt; if it has one&lt;!-- potentially
+      http-origin privacy sensitive --&gt;.&lt;/p&gt;
 
       &lt;!-- similar text in various places --&gt;
       &lt;p&gt;Fetching the resource must &lt;span&gt;delay the load event&lt;/span&gt;
@@ -22592,10 +22614,12 @@
   is set, its value must be &lt;span title=&quot;resolve a
   url&quot;&gt;resolved&lt;/span&gt; relative to the element, and if that is
   successful, the resulting &lt;span&gt;absolute URL&lt;/span&gt; must be &lt;span
-  title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;; this must &lt;span&gt;delay the load
-  event&lt;/span&gt; of the element's document. The &lt;dfn&gt;poster frame&lt;/dfn&gt;
-  is then the image obtained from that resource, if any.&lt;/span&gt;&lt;/p&gt;
-  &lt;!-- thus it is unaffected by changes to the base URL. --&gt;
+  title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;, from the element's
+  &lt;code&gt;Document&lt;/code&gt;'s &lt;span&gt;origin&lt;/span&gt;; this must &lt;span&gt;delay
+  the load event&lt;/span&gt; of the element's document. The &lt;dfn&gt;poster
+  frame&lt;/dfn&gt; is then the image obtained from that resource, if
+  any.&lt;/span&gt;&lt;/p&gt; &lt;!-- thus it is unaffected by changes to the base
+  URL. --&gt;
 
   &lt;p class=&quot;note&quot;&gt;The image given by the &lt;code
   title=&quot;attr-video-poster&quot;&gt;poster&lt;/code&gt; attribute, the &lt;i&gt;poster
@@ -24053,7 +24077,9 @@
    &lt;li&gt;
 
     &lt;p&gt;Begin to &lt;span&gt;fetch&lt;/span&gt; the &lt;var title=&quot;&quot;&gt;current media
-    resource&lt;/var&gt;.&lt;/p&gt;
+    resource&lt;/var&gt;, from the &lt;span&gt;media element&lt;/span&gt;'s
+    &lt;code&gt;Document&lt;/code&gt;'s &lt;span&gt;origin&lt;/span&gt;.&lt;/p&gt; &lt;!-- not
+    http-origin privacy sensitive (looking forward to CORS here) --&gt;
 
     &lt;p&gt;Every 350ms (&amp;#xB1;200ms) or for every byte received, whichever
     is &lt;em&gt;least&lt;/em&gt; frequent, &lt;span&gt;queue a task&lt;/span&gt; to
@@ -38564,7 +38590,8 @@
   &lt;code title=&quot;attr-input-src&quot;&gt;src&lt;/code&gt; attribute, relative to the
   element, and if that is successful, must &lt;span&gt;fetch&lt;/span&gt; the
   resulting &lt;span&gt;absolute URL&lt;/span&gt;:&lt;/p&gt; &lt;!-- Note how this does NOT
-  happen when the base URL changes. --&gt;
+  happen when the base URL changes. --&gt; &lt;!-- http-origin privacy
+  sensitive --&gt;
 
   &lt;ul&gt;
 
@@ -47238,14 +47265,15 @@
    title=&quot;concept-facet&quot;&gt;facets&lt;/span&gt;&lt;!-- we might need to be
    explicit about what this means for each facet, if testing shows
    this isn't well-implemented. e.g.: If there's an Icon facet for the
-   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt;, and then
-   that image should be associated with the command, such that each
-   command only has its image fetched once, to prevent changes to the
-   base URL from having effects after the image has been fetched
-   once. (no need to resolve the Icon facet, it's an absolute URL)
-   --&gt;. &lt;!--If the element is a &lt;code&gt;command&lt;/code&gt; element with a
-   &lt;code title=&quot;attr-command-default&quot;&gt;default&lt;/code&gt; attribute, mark
-   the command as being a default command.--&gt;&lt;/dd&gt;
+   command, it should be &lt;span title=&quot;fetch&quot;&gt;fetched&lt;/span&gt; (this
+   would be http-origin privacy-sensitive), and then that image should
+   be associated with the command, such that each command only has its
+   image fetched once, to prevent changes to the base URL from having
+   effects after the image has been fetched once. (no need to resolve
+   the Icon facet, it's an absolute URL) --&gt;. &lt;!--If the element is a
+   &lt;code&gt;command&lt;/code&gt; element with a &lt;code
+   title=&quot;attr-command-default&quot;&gt;default&lt;/code&gt; attribute, mark the
+   command as being a default command.--&gt;&lt;/dd&gt;
 
 
    &lt;dt&gt;An &lt;code&gt;hr&lt;/code&gt; element&lt;/dt&gt;
@@ -54416,6 +54444,19 @@
 
   &lt;/ul&gt;
 
+  &lt;hr&gt;
+
+  &lt;p&gt;An element has a &lt;dfn&gt;browsing context scope origin&lt;/dfn&gt; if its
+  &lt;code&gt;Document&lt;/code&gt;'s &lt;span&gt;browsing context&lt;/span&gt; is a
+  &lt;span&gt;top-level browsing context&lt;/span&gt; or if all of its
+  &lt;code&gt;Document&lt;/code&gt;'s &lt;span title=&quot;ancestor browsing
+  context&quot;&gt;ancestor browsing contexts&lt;/span&gt; all have &lt;span
+  title=&quot;active document&quot;&gt;active documents&lt;/span&gt; whose
+  &lt;span&gt;origin&lt;/span&gt; are the &lt;span&gt;same origin&lt;/span&gt; as the
+  element's &lt;code&gt;Document&lt;/code&gt;'s &lt;span&gt;origin&lt;/span&gt;. If an element
+  has a &lt;span&gt;browsing context scope origin&lt;/span&gt;, then its value is
+  the &lt;span&gt;origin&lt;/span&gt; of the element's &lt;code&gt;Document&lt;/code&gt;.&lt;/p&gt;
+
   &lt;/div&gt;
 
 
@@ -59591,7 +59632,9 @@
 
     &lt;p&gt;&lt;i&gt;Fetching the manifest&lt;/i&gt;: &lt;span&gt;Fetch&lt;/span&gt; the resource
     from &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;, and let &lt;var
-    title=&quot;&quot;&gt;manifest&lt;/var&gt; be that resource.&lt;/p&gt;
+    title=&quot;&quot;&gt;manifest&lt;/var&gt; be that resource.&lt;/p&gt; &lt;!-- http-origin
+    privacy sensitive, though it doesn't matter, since this can never
+    be cross-origin --&gt;
 
     &lt;p&gt;If the resource is labeled with the &lt;span&gt;MIME type&lt;/span&gt;
     &lt;code&gt;text/cache-manifest&lt;/code&gt;, parse &lt;var
@@ -59850,19 +59893,21 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resource. If this is an &lt;span
-      title=&quot;concept-appcache-upgrade&quot;&gt;upgrade attempt&lt;/span&gt;, then
-      use the &lt;span title=&quot;concept-appcache-newer&quot;&gt;newest&lt;/span&gt;
-      &lt;span&gt;application cache&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;cache
-      group&lt;/var&gt; as an HTTP cache, and honor HTTP caching semantics
-      (such as expiration, ETags, and so forth) with respect to that
-      cache. User agents may also have other caches in place that are
-      also honored.&lt;/p&gt;
+      &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resource, from the &lt;span&gt;origin&lt;/span&gt;
+      of the &lt;span&gt;URL&lt;/span&gt; &lt;var title=&quot;&quot;&gt;manifest URL&lt;/var&gt;. If
+      this is an &lt;span title=&quot;concept-appcache-upgrade&quot;&gt;upgrade
+      attempt&lt;/span&gt;, then use the &lt;span
+      title=&quot;concept-appcache-newer&quot;&gt;newest&lt;/span&gt; &lt;span&gt;application
+      cache&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;cache group&lt;/var&gt; as an HTTP
+      cache, and honor HTTP caching semantics (such as expiration,
+      ETags, and so forth) with respect to that cache. User agents may
+      also have other caches in place that are also honored.&lt;/p&gt; &lt;!--
+      not http-origin privacy sensitive --&gt;
 
       &lt;p class=&quot;note&quot;&gt;If the resource in question is already being
       downloaded for other reasons then the existing download process
-      can be used for the purposes of this step, as defined by the
-      &lt;span title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; algorithm.&lt;/p&gt;
+      can sometimes be used for the purposes of this step, as defined
+      by the &lt;span title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; algorithm.&lt;/p&gt;
 
       &lt;p class=&quot;example&quot;&gt;An example of a resource that might already
       be being downloaded is a large image on a Web page that is being
@@ -60045,7 +60090,8 @@
 
     &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resource from &lt;var title=&quot;&quot;&gt;manifest
     URL&lt;/var&gt; again, and let &lt;var title=&quot;&quot;&gt;second manifest&lt;/var&gt; be
-    that resource.&lt;/p&gt;
+    that resource.&lt;/p&gt; &lt;!-- http-origin privacy sensitive, though it
+    doesn't matter, since this can never be cross-origin --&gt;
 
    &lt;/li&gt;
 
@@ -61662,28 +61708,27 @@
 
     &lt;p&gt;Otherwise, &lt;span&gt;fetch&lt;/span&gt; the new resource, if it has not
     already been obtained&lt;!-- it's obtained by &lt;object&gt;, for instance
-    --&gt;. If the resource is being fetched using HTTP, and the method
-    is not GET&lt;!-- or HEAD (but that can't happen) --&gt;, then the user
-    agent must include an &lt;code title=&quot;http-origin&quot;&gt;Origin&lt;/code&gt;
-    header whose value is determined as follows:&lt;/p&gt;
+    --&gt;.&lt;/p&gt;
 
-    &lt;dl class=&quot;switch&quot;&gt;
+    &lt;p&gt;If the resource is being fetched using a method other than one
+    &lt;span title=&quot;concept-http-equivalent-get&quot;&gt;equivalent to&lt;/span&gt;
+    HTTP's GET&lt;!-- or HEAD (but that can't happen) --&gt;, or, if the
+    &lt;span title=&quot;navigate&quot;&gt;navigation algorithm&lt;/span&gt; was invoked as
+    a result of the &lt;span title=&quot;concept-form-submit&quot;&gt;form submission
+    algorithm&lt;/span&gt;, then the &lt;span title=&quot;fetch&quot;&gt;fetching
+    algorithm&lt;/span&gt; must be invoked from the &lt;span&gt;origin&lt;/span&gt; of
+    the &lt;span&gt;active document&lt;/span&gt; of the &lt;span&gt;source browsing
+    context&lt;/span&gt;, if any.&lt;/p&gt; &lt;!-- potentially http-origin privacy
+    sensitive --&gt;
 
-     &lt;dt&gt;If the &lt;span title=&quot;navigate&quot;&gt;navigation&lt;/span&gt; algorithm has
-     so far contacted more than one &lt;span&gt;origin&lt;/span&gt;&lt;/dt&gt;
-     &lt;dt&gt;If there is no &lt;span&gt;source browsing context&lt;/span&gt;&lt;/dt&gt;
+    &lt;p&gt;If the &lt;span&gt;browsing context&lt;/span&gt; being navigated is a
+    &lt;span&gt;child browsing context&lt;/span&gt; for an &lt;code&gt;iframe&lt;/code&gt; or
+    &lt;code&gt;object&lt;/code&gt; element, then the &lt;span title=&quot;fetch&quot;&gt;fetching
+    algorithm&lt;/span&gt; must be invoked from the &lt;code&gt;iframe&lt;/code&gt; or
+    &lt;code&gt;object&lt;/code&gt; element's &lt;span&gt;browsing context scope
+    origin&lt;/span&gt;, if it has one.&lt;/p&gt; &lt;!-- potentially http-origin
+    privacy sensitive --&gt;
 
-     &lt;dd&gt;The value must be the string &quot;&lt;code title=&quot;&quot;&gt;null&lt;/code&gt;&quot;.&lt;/dd&gt;
-
-     &lt;dt&gt;Otherwise&lt;/dt&gt;
-
-     &lt;dd&gt;The value must be the &lt;span title=&quot;ASCII serialization of an
-     origin&quot;&gt;ASCII serialization&lt;/span&gt; of the &lt;span&gt;origin&lt;/span&gt; of
-     the &lt;span&gt;active document&lt;/span&gt; of the &lt;span&gt;source browsing
-     context&lt;/span&gt; at the time the navigation was started.&lt;/dd&gt;
-
-    &lt;/dl&gt;
-
    &lt;/li&gt;
 
    &lt;li&gt;
@@ -64644,7 +64689,9 @@
   &lt;span title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; the specified URLs using the
   POST method, with an entity body with the &lt;span&gt;MIME type&lt;/span&gt;
   &lt;code&gt;text/ping&lt;/code&gt; consisting of the four-character string
-  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;. All relevant cookie and HTTP
+  &quot;&lt;code title=&quot;&quot;&gt;PING&lt;/code&gt;&quot;, from the &lt;span&gt;origin&lt;/span&gt; of the
+  &lt;code&gt;Document&lt;/code&gt; containing the &lt;span&gt;hyperlink&lt;/span&gt;. &lt;!--
+  not http-origin privacy sensitive --&gt; All relevant cookie and HTTP
   authentication headers must be included in the request. Which other
   headers are required depends on the URLs involved.&lt;/p&gt;
 
@@ -64690,12 +64737,6 @@
 
   &lt;/dl&gt;
 
-  &lt;p&gt;In addition, an &lt;code title=&quot;http-origin&quot;&gt;Origin&lt;/code&gt; header
-  must always be included, whose value is the &lt;span title=&quot;ASCII
-  serialization of an origin&quot;&gt;ASCII serialization&lt;/span&gt; of the
-  &lt;span&gt;origin&lt;/span&gt; of the &lt;code&gt;Document&lt;/code&gt; containing the
-  &lt;span&gt;hyperlink&lt;/span&gt;.&lt;/p&gt;
-
   &lt;p class=&quot;note&quot;&gt;To save bandwidth, implementors might also wish to
   consider omitting optional headers such as &lt;code&gt;Accept&lt;/code&gt; from
   these requests.&lt;/p&gt;
@@ -71065,9 +71106,9 @@
 
   &lt;p&gt;When a user agent is to &lt;dfn&gt;run a worker&lt;/dfn&gt; for a script with
   &lt;span&gt;URL&lt;/span&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt;, a browsing context &lt;var
-  title=&quot;&quot;&gt;owner browsing context&lt;/var&gt;, and with global scope &lt;var
-  title=&quot;&quot;&gt;worker global scope&lt;/var&gt;, it must run the following
-  steps:&lt;/p&gt;
+  title=&quot;&quot;&gt;owner browsing context&lt;/var&gt;, an origin &lt;var title=&quot;&quot;&gt;owner
+  origin&lt;/var&gt;, and with global scope &lt;var title=&quot;&quot;&gt;worker global
+  scope&lt;/var&gt;, it must run the following steps:&lt;/p&gt;
 
   &lt;ol&gt;
 
@@ -71094,7 +71135,8 @@
    &lt;li&gt;
 
     &lt;p&gt;Attempt to &lt;span&gt;fetch&lt;/span&gt; the resource identified by &lt;var
-    title=&quot;&quot;&gt;url&lt;/var&gt;.&lt;/p&gt;
+    title=&quot;&quot;&gt;url&lt;/var&gt;, from the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;.&lt;/p&gt;
+    &lt;!-- not http-origin privacy sensitive --&gt;
 
     &lt;p&gt;If the attempt fails, or if the attempt involves any redirects
     to URIs that do not have the &lt;span&gt;same origin&lt;/span&gt; as &lt;var
@@ -71533,9 +71575,8 @@
 
     &lt;p&gt;If the &lt;span&gt;origin&lt;/span&gt; of the resulting &lt;span&gt;absolute
     URL&lt;/span&gt; is not the &lt;span title=&quot;same origin&quot;&gt;same&lt;/span&gt; as the
-    origin of the &lt;span title=&quot;concept-script&quot;&gt;script&lt;/span&gt; that
-    invoked the constructor, then throw a &lt;span&gt;security
-    exception&lt;/span&gt;.&lt;/p&gt;
+    origin of the &lt;span&gt;first script&lt;/span&gt;, then throw a
+    &lt;span&gt;security exception&lt;/span&gt;.&lt;/p&gt;
 
     &lt;p class=&quot;note&quot;&gt;Thus, scripts must be external files with the same
     scheme as the original page: you can't load a script from a &lt;code
@@ -71619,8 +71660,9 @@
     &lt;p&gt;&lt;span&gt;Run a worker&lt;/span&gt; for the resulting &lt;span&gt;absolute
     URL&lt;/span&gt;, with the &lt;span&gt;script browsing context&lt;/span&gt; of the
     script that invoked the method as the &lt;var title=&quot;&quot;&gt;owner browsing
-    context&lt;/var&gt;, and with &lt;var title=&quot;&quot;&gt;worker global scope&lt;/var&gt; as
-    the global scope.&lt;/p&gt;
+    context&lt;/var&gt;, with the &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;first
+    script&lt;/span&gt; as the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;, and with
+    &lt;var title=&quot;&quot;&gt;worker global scope&lt;/var&gt; as the global scope.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -71667,7 +71709,7 @@
 
     &lt;p&gt;If the &lt;span&gt;origin&lt;/span&gt; of &lt;var title=&quot;&quot;&gt;scriptURL&lt;/var&gt; is
     not the &lt;span title=&quot;same origin&quot;&gt;same&lt;/span&gt; as the origin of the
-    script that invoked the constructor, then throw a &lt;span&gt;security
+    &lt;span&gt;first script&lt;/span&gt;, then throw a &lt;span&gt;security
     exception&lt;/span&gt;.&lt;/p&gt;
 
     &lt;p class=&quot;note&quot;&gt;Thus, scripts must be external files with the same
@@ -71863,8 +71905,9 @@
     &lt;p&gt;&lt;span&gt;Run a worker&lt;/span&gt; for &lt;var title=&quot;&quot;&gt;scriptURL&lt;/var&gt;,
     with the &lt;span&gt;script browsing context&lt;/span&gt; of the script that
     invoked the method as the &lt;var title=&quot;&quot;&gt;owner browsing
-    context&lt;/var&gt;, and with &lt;var title=&quot;&quot;&gt;worker global scope&lt;/var&gt; as
-    the global scope.&lt;/p&gt;
+    context&lt;/var&gt;, with the &lt;span&gt;origin&lt;/span&gt; of the &lt;span&gt;first
+    script&lt;/span&gt; as the &lt;var title=&quot;&quot;&gt;owner origin&lt;/var&gt;, and with
+    &lt;var title=&quot;&quot;&gt;worker global scope&lt;/var&gt; as the global scope.&lt;/p&gt;
 
    &lt;/li&gt;
 
@@ -71923,7 +71966,9 @@
    &lt;li&gt;
 
     &lt;p&gt;Attempt to &lt;span&gt;fetch&lt;/span&gt; each resource identified by the
-    resulting &lt;span title=&quot;absolute URLs&quot;&gt;absolute URL&lt;/span&gt;.&lt;/p&gt;
+    resulting &lt;span title=&quot;absolute URLs&quot;&gt;absolute URL&lt;/span&gt;, from
+    the &lt;span&gt;first script&lt;/span&gt;'s &lt;span&gt;origin&lt;/span&gt;.&lt;/p&gt; &lt;!-- not
+    http-origin privacy sensitive --&gt;
 
    &lt;/li&gt;
 
@@ -72305,7 +72350,9 @@
    &lt;li&gt;
 
     &lt;p&gt;&lt;span&gt;Fetch&lt;/span&gt; the resource identified by the resulting
-    &lt;span&gt;absolute URL&lt;/span&gt;, and process it as described below.&lt;/p&gt;
+    &lt;span&gt;absolute URL&lt;/span&gt;, from the &lt;span&gt;first script&lt;/span&gt;'s
+    &lt;span&gt;origin&lt;/span&gt;, and process it as described below.&lt;/p&gt; &lt;!--
+    not http-origin privacy sensitive --&gt;
 
     &lt;p class=&quot;note&quot;&gt;The definition of the &lt;span
     title=&quot;fetch&quot;&gt;fetching&lt;/span&gt; algorithm is such that if the
@@ -72482,6 +72529,10 @@
   the resource at a later point, it must return to the previously
   specified URL for this event source.&lt;/p&gt;
 
+  &lt;p class=&quot;note&quot;&gt;The Origin specification also introduces some
+  relevant requirements when dealing with redirects. &lt;a
+  href=&quot;#refsORIGIN&quot;&gt;[ORIGIN]&lt;/a&gt;&lt;/p&gt;
+
   &lt;p&gt;HTTP 305 Use Proxy, HTTP 401 Unauthorized, and 407 Proxy
   Authentication Required should be treated transparently as for any
   other subresource.&lt;/p&gt;
@@ -72518,9 +72569,12 @@
   &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the
   &lt;code&gt;EventSource&lt;/code&gt; object, and then &lt;span&gt;fetch&lt;/span&gt; the
   event source resource again after a delay equal to the reconnection
-  time of the event source. &lt;strong&gt;Only if the user agent &lt;span
-  title=&quot;reset the connection&quot;&gt;resets the connection&lt;/span&gt; does the
-  connection get opened anew!&lt;/strong&gt;&lt;/p&gt;
+  time of the event source, from the same &lt;span&gt;origin&lt;/span&gt; as the
+  original request triggered by the &lt;code
+  title=&quot;dom-EventSource&quot;&gt;EventSource()&lt;/code&gt;
+  constructor. &lt;strong&gt;Only if the user agent &lt;span title=&quot;reset the
+  connection&quot;&gt;resets the connection&lt;/span&gt; does the connection get
+  opened anew!&lt;/strong&gt;&lt;/p&gt;
 
   &lt;p&gt;When a user agent is to &lt;dfn&gt;fail the connection&lt;/dfn&gt;, the user
   agent must set the &lt;code
@@ -74166,6 +74220,10 @@
 
     &lt;hr&gt;
 &lt;!--
+redirect support
+we should probably reintroduce this at some point, with the
+multi-origin semantics described in [ORIGIN] applying. (http-origin)
+
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;mode&lt;/var&gt; is &lt;i title=&quot;&quot;&gt;redirect&lt;/i&gt;, then:
     If there is not exactly one entry in the &lt;var
     title=&quot;&quot;&gt;headers&lt;/var&gt; list whose name is &quot;&lt;code
@@ -87828,8 +87886,10 @@
   its &lt;span&gt;fallback content&lt;/span&gt;, the element must be ignored (it
   represents nothing).&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, &lt;span class=&quot;XXX&quot;&gt;define how the element works,
-  if supported&lt;/span&gt;.&lt;/p&gt; &lt;!-- remember to delay the laod event --&gt;
+  &lt;p&gt;Otherwise, &lt;span class=&quot;XXX&quot;&gt;define how the element works, if
+  supported&lt;/span&gt;.&lt;/p&gt; &lt;!-- remember to delay the load event --&gt; &lt;!--
+  remember to include &quot;, from the element's &lt;span&gt;browsing context
+  scope origin&lt;/span&gt; if it has one&quot; when fetching --&gt;
 
   &lt;p&gt;The &lt;code&gt;applet&lt;/code&gt; element must implement the
   &lt;code&gt;HTMLAppletElement&lt;/code&gt; interface.&lt;/p&gt;
@@ -88594,7 +88654,8 @@
 
    &lt;li&gt;&lt;p&gt;For each token that is successfully resolved,
    &lt;span&gt;fetch&lt;/span&gt; the resulting &lt;span&gt;absolute URL&lt;/span&gt; and
-   apply the appropriate processing.&lt;/p&gt;&lt;/li&gt;
+   apply the appropriate processing.&lt;/p&gt;&lt;/li&gt; &lt;!-- http-origin privacy
+   sensitive --&gt;
 
   &lt;/ol&gt;
 
@@ -90082,6 +90143,12 @@
    in HTML/XHTML&lt;/a&gt;&lt;/cite&gt;. In &lt;cite&gt;OpenSearch 1.1 Draft 4&lt;/cite&gt;,
    Section 4.6.2. OpenSearch.org.&lt;/dd&gt;
 
+   &lt;dt id=&quot;refsORIGIN&quot;&gt;[ORIGIN]&lt;/dt&gt;
+   &lt;dd&gt;&lt;cite&gt;&lt;a
+   href=&quot;<A HREF="http://tools.ietf.org/html/draft-abarth-origin">http://tools.ietf.org/html/draft-abarth-origin</A>&quot;&gt;The HTTP
+   Origin Header&lt;/a&gt;&lt;/cite&gt;, A. Barth, C. Jackson, I. Hickson. IETF,
+   September 2009.&lt;/dd&gt;
+
    &lt;dt id=&quot;refsPINGBACK&quot;&gt;[PINGBACK]&lt;/dt&gt;
    &lt;dd&gt;&lt;cite&gt;&lt;a
    href=&quot;<A HREF="http://www.hixie.ch/specs/pingback/pingback">http://www.hixie.ch/specs/pingback/pingback</A>&quot;&gt;Pingback


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010883.html">[html5] r4010 - [e] (0) Clarify that 'invalid' sometimes has a	default action and sometimes does [...]
</A></li>
	<LI>Next message: <A HREF="010885.html">[html5] r4012 - [e] (0) Add an example for pushState(). Fixing	http://www.w3.org/Bugs/Public/sho [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10884">[ date ]</a>
              <a href="thread.html#10884">[ thread ]</a>
              <a href="subject.html#10884">[ subject ]</a>
              <a href="author.html#10884">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
