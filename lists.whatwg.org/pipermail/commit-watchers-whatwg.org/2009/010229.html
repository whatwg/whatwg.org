<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r3351 - [giow] (2) Try to specify the occasional reuse of	Window objects when navigating [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r3351%20-%20%5Bgiow%5D%20%282%29%20Try%20to%20specify%20the%20occasional%20reuse%20of%0A%09Window%20objects%20when%20navigating%20%5B...%5D&In-Reply-To=%3C20090701220823.638561389F2%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010228.html">
   <LINK REL="Next"  HREF="010230.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r3351 - [giow] (2) Try to specify the occasional reuse of	Window objects when navigating [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r3351%20-%20%5Bgiow%5D%20%282%29%20Try%20to%20specify%20the%20occasional%20reuse%20of%0A%09Window%20objects%20when%20navigating%20%5B...%5D&In-Reply-To=%3C20090701220823.638561389F2%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r3351 - [giow] (2) Try to specify the occasional reuse of	Window objects when navigating [...]">whatwg at whatwg.org
       </A><BR>
    <I>Wed Jul  1 15:08:23 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="010228.html">[html5] r3350 - [] (0) Mark impl-specific mirodata sections as	such. Make some non-normative tex [...]
</A></li>
        <LI>Next message: <A HREF="010230.html">[html5] r3352 - [e] (0) Make the markup prettier in the examples.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10229">[ date ]</a>
              <a href="thread.html#10229">[ thread ]</a>
              <a href="subject.html#10229">[ subject ]</a>
              <a href="author.html#10229">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2009-07-01 15:08:21 -0700 (Wed, 01 Jul 2009)
New Revision: 3351

Modified:
   index
   source
Log:
[giow] (2) Try to specify the occasional reuse of Window objects when navigating away from about:blank initial docs to docs in the same origin. (credit: bz, sw)

Modified: index
===================================================================
--- index	2009-07-01 21:38:46 UTC (rev 3350)
+++ index	2009-07-01 22:08:21 UTC (rev 3351)
@@ -45380,19 +45380,29 @@
 
   &lt;div class=impl&gt;
 
-  &lt;p&gt;The &lt;code title=&quot;&quot;&gt;defaultView&lt;/code&gt; attribute on the
-  &lt;code&gt;Document&lt;/code&gt; object's &lt;code&gt;DocumentView&lt;/code&gt; interface
-  must return the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s
-  &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object, not the actual
+  &lt;p&gt;The &lt;code title=dom-document-defaultView&gt;defaultView&lt;/code&gt;
+  attribute on the &lt;code&gt;Document&lt;/code&gt; object's
+  &lt;code&gt;DocumentView&lt;/code&gt; interface must return the &lt;a href=#browsing-context&gt;browsing
+  context&lt;/a&gt;'s &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object, not the actual
   &lt;code&gt;AbstractView&lt;/code&gt; object of the &lt;a href=#default-view&gt;default
   view&lt;/a&gt;. &lt;a href=#refsDOM3VIEWS&gt;[DOM3VIEWS]&lt;/a&gt;&lt;/p&gt;
 
   &lt;/div&gt;
 
-  &lt;p class=note&gt;The &lt;code title=&quot;&quot;&gt;document&lt;/code&gt; attribute of an
-  &lt;code&gt;AbstractView&lt;/code&gt; object representing a &lt;a href=#view&gt;view&lt;/a&gt;
-  gives the view's corresponding &lt;code&gt;Document&lt;/code&gt; object. &lt;a href=#refsDOM2VIEWS&gt;[DOM2VIEWS]&lt;/a&gt;&lt;/p&gt;
+  &lt;p class=note&gt;The &lt;code title=dom-document&gt;document&lt;/code&gt;
+  attribute of an &lt;code&gt;AbstractView&lt;/code&gt; object representing a
+  &lt;a href=#view&gt;view&lt;/a&gt; gives the view's corresponding
+  &lt;code&gt;Document&lt;/code&gt; object. &lt;a href=#refsDOM2VIEWS&gt;[DOM2VIEWS]&lt;/a&gt;&lt;/p&gt;
 
+  &lt;p class=note&gt;In general, there is a 1-to-1 mapping from the
+  &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object to the &lt;code&gt;Document&lt;/code&gt; object. In
+  one particular case, a set of &lt;a href=#view title=view&gt;views&lt;/a&gt; can be
+  reused for the presentation of a second &lt;code&gt;Document&lt;/code&gt; in the
+  same &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, such that the mapping is then
+  2:1. This occurs when a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; is &lt;a href=#navigate title=navigate&gt;navigated&lt;/a&gt; from the initial
+  &lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt; &lt;code&gt;Document&lt;/code&gt; to another, with
+  &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt;.&lt;/p&gt;
+
   &lt;div class=impl&gt;
 
   &lt;p&gt;Events that use the &lt;code&gt;UIEvent&lt;/code&gt; interface are related to
@@ -46279,8 +46289,10 @@
 
   &lt;p class=note&gt;The &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;'s &lt;a href=#default-view&gt;default
   view&lt;/a&gt;'s &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object &lt;a href=#implied-strong-reference title=&quot;implied strong
-  reference&quot;&gt;has a strong reference of its own&lt;/a&gt; to its
-  &lt;code&gt;Document&lt;/code&gt; object.&lt;/p&gt;
+  reference&quot;&gt;has a strong reference&lt;/a&gt; to its
+  &lt;code&gt;Document&lt;/code&gt; object through the &lt;code title=dom-document&gt;document&lt;/code&gt; attribute of the
+  &lt;code&gt;AbstractView&lt;/code&gt; interface. Thus, references from other
+  scripts to either of those objects will keep both alive. &lt;a href=#refsDOMVIEWS&gt;[DOMVIEWS]&lt;/a&gt;&lt;/p&gt;
 
   &lt;p class=note&gt;Whenever a &lt;code&gt;Document&lt;/code&gt; object is &lt;a href=#discard-a-document title=&quot;discard a Document&quot;&gt;discarded&lt;/a&gt;, it is also removed from
   the list of &lt;span&gt;the worker's &lt;code&gt;Document&lt;/code&gt;s&lt;/span&gt; of each
@@ -51757,6 +51769,22 @@
     is set when &lt;a href=#concept-js-deref title=concept-js-deref&gt;dereferencing a
     &lt;code&gt;javascript:&lt;/code&gt; URL&lt;/a&gt;.&lt;/p&gt;
 
+    &lt;p&gt;&lt;dfn id=create-a-document-object title=&quot;create a Document object&quot;&gt;Creating a new
+    &lt;code&gt;Document&lt;/code&gt; object&lt;/dfn&gt;: When a &lt;code&gt;Document&lt;/code&gt;
+    is created as part of the above steps, a new set of &lt;a href=#view title=view&gt;views&lt;/a&gt; along with the associated
+    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object must be created and associated with the
+    &lt;code&gt;Document&lt;/code&gt;, with one exception: if the &lt;a href=#browsing-context&gt;browsing
+    context&lt;/a&gt;'s only entry in its &lt;a href=#session-history&gt;session history&lt;/a&gt; is
+    the &lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt; &lt;code&gt;Document&lt;/code&gt; that was added
+    when the &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; was created, and navigation
+    is occurring with &lt;a href=#replacement-enabled&gt;replacement enabled&lt;/a&gt;, and that
+    &lt;code&gt;Document&lt;/code&gt; has the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as the new
+    &lt;code&gt;Document&lt;/code&gt;, then the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object and
+    associated &lt;a href=#view title=view&gt;views&lt;/a&gt; of that
+    &lt;code&gt;Document&lt;/code&gt; must be used instead, and the &lt;code title=dom-document&gt;document&lt;/code&gt; attribute of the
+    &lt;code&gt;AbstractView&lt;/code&gt; objects of those &lt;a href=#view title=view&gt;views&lt;/a&gt; must be changed to point to the new
+    &lt;code&gt;Document&lt;/code&gt; instead.&lt;/p&gt;
+
    &lt;/li&gt;
 
    &lt;li id=navigate-non-Document&gt;
@@ -51862,11 +51890,11 @@
   &lt;h4 id=read-html&gt;&lt;span class=secno&gt;6.11.2 &lt;/span&gt;&lt;dfn title=navigate-html&gt;Page load processing model for HTML files&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When an HTML document is to be loaded in a &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt;, the user agent must create a &lt;code&gt;Document&lt;/code&gt;
-  object, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML
-  document&lt;/a&gt;, create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, associate it
-  with the document, and begin to use the bytes provided for the
-  document as the &lt;a href=#the-input-stream&gt;input stream&lt;/a&gt; for that parser.&lt;/p&gt;
+  context&lt;/a&gt;, the user agent must &lt;a href=#create-a-document-object&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, create an &lt;a href=#html-parser&gt;HTML
+  parser&lt;/a&gt;, associate it with the document, and begin to use the
+  bytes provided for the document as the &lt;a href=#the-input-stream&gt;input stream&lt;/a&gt; for
+  that parser.&lt;/p&gt;
 
   &lt;p class=note&gt;The &lt;a href=#the-input-stream&gt;input stream&lt;/a&gt; converts bytes into
   characters for use in the &lt;a href=#tokenization title=tokenization&gt;tokenizer&lt;/a&gt;. This process relies, in part,
@@ -51894,9 +51922,9 @@
   &lt;h4 id=read-xml&gt;&lt;span class=secno&gt;6.11.3 &lt;/span&gt;&lt;dfn title=navigate-xml&gt;Page load processing model for XML files&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When faced with displaying an XML file inline, user agents must
-  first create a &lt;code&gt;Document&lt;/code&gt; object, following the
-  requirements of the XML and Namespaces in XML recommendations, RFC
-  3023, DOM3 Core, and other relevant specifications. &lt;a href=#refsXML&gt;[XML]&lt;/a&gt; &lt;a href=#refsXMLNS&gt;[XMLNS]&lt;/a&gt; &lt;a href=#refsRFC3023&gt;[RFC3023]&lt;/a&gt; &lt;a href=#refsDOM3CORE&gt;[DOM3CORE]&lt;/a&gt;&lt;/p&gt;
+  first &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, following
+  the requirements of the XML and Namespaces in XML recommendations,
+  RFC 3023, DOM3 Core, and other relevant specifications. &lt;a href=#refsXML&gt;[XML]&lt;/a&gt; &lt;a href=#refsXMLNS&gt;[XMLNS]&lt;/a&gt; &lt;a href=#refsRFC3023&gt;[RFC3023]&lt;/a&gt; &lt;a href=#refsDOM3CORE&gt;[DOM3CORE]&lt;/a&gt;&lt;/p&gt;
 
   &lt;p&gt;The actual HTTP headers and other metadata, not the headers as
   mutated or implied by the algorithms given in this specification,
@@ -51948,14 +51976,13 @@
   &lt;h4 id=read-text&gt;&lt;span class=secno&gt;6.11.4 &lt;/span&gt;&lt;dfn title=navigate-text&gt;Page load processing model for text files&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When a plain text document is to be loaded in a &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt;, the user agent should create a &lt;code&gt;Document&lt;/code&gt;
-  object, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML
-  document&lt;/a&gt;, create an &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;, associate it
-  with the document, act as if the tokenizer had emitted a start tag
-  token with the tag name &quot;pre&quot;, set the &lt;a href=#tokenization&gt;tokenization&lt;/a&gt;
-  stage's &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to &lt;i&gt;PLAINTEXT&lt;/i&gt;, and
-  begin to pass the stream of characters in the plain text document to
-  that tokenizer.&lt;/p&gt;
+  context&lt;/a&gt;, the user agent should &lt;a href=#create-a-document-object&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, create an &lt;a href=#html-parser&gt;HTML
+  parser&lt;/a&gt;, associate it with the document, act as if the
+  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;, set
+  the &lt;a href=#tokenization&gt;tokenization&lt;/a&gt; stage's &lt;a href=#content-model-flag&gt;content model
+  flag&lt;/a&gt; to &lt;i&gt;PLAINTEXT&lt;/i&gt;, and begin to pass the stream of
+  characters in the plain text document to that tokenizer.&lt;/p&gt;
 
   &lt;p&gt;The rules for how to convert the bytes of the plain text document
   into actual characters are defined in RFC 2046, RFC 2646, and
@@ -51990,14 +52017,13 @@
   &lt;h4 id=read-image&gt;&lt;span class=secno&gt;6.11.5 &lt;/span&gt;&lt;dfn title=navigate-image&gt;Page load processing model for images&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When an image resource is to be loaded in a &lt;a href=#browsing-context&gt;browsing
-  context&lt;/a&gt;, the user agent should create a &lt;code&gt;Document&lt;/code&gt;
-  object, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML
-  document&lt;/a&gt;, append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the
-  &lt;code&gt;Document&lt;/code&gt;, append a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a
-  &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element to the &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append
-  an &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; to the &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set the
-  &lt;code title=attr-img-src&gt;&lt;a href=#attr-img-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the
-  &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; element to the address of the image.&lt;/p&gt;
+  context&lt;/a&gt;, the user agent should &lt;a href=#create-a-document-object&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, append an
+  &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the &lt;code&gt;Document&lt;/code&gt;, append a
+  &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element to the
+  &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append an &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt; to the
+  &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set the &lt;code title=attr-img-src&gt;&lt;a href=#attr-img-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the &lt;code&gt;&lt;a href=#the-img-element&gt;img&lt;/a&gt;&lt;/code&gt;
+  element to the address of the image.&lt;/p&gt;
 
   &lt;!-- next three paragraphs are similar to the navigate-text section,
   keep them in sync --&gt;
@@ -52024,12 +52050,12 @@
 
   &lt;p&gt;When a resource that requires an external resource to be rendered
   is to be loaded in a &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent
-  should create a &lt;code&gt;Document&lt;/code&gt; object, mark it as being an
-  &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, append an
-  &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the &lt;code&gt;Document&lt;/code&gt;, append a
-  &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element to the
-  &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; to the
-  &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set the &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the
+  should &lt;a href=#create-a-document-object&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it
+  as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;,
+  append an &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element to the &lt;code&gt;Document&lt;/code&gt;,
+  append a &lt;code&gt;&lt;a href=#the-head-element&gt;head&lt;/a&gt;&lt;/code&gt; element and a &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element
+  to the &lt;code&gt;&lt;a href=#the-html-element&gt;html&lt;/a&gt;&lt;/code&gt; element, append an &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; to
+  the &lt;code&gt;&lt;a href=#the-body-element&gt;body&lt;/a&gt;&lt;/code&gt; element, and set the &lt;code title=attr-embed-src&gt;&lt;a href=#attr-embed-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of the
   &lt;code&gt;&lt;a href=#the-embed-element&gt;embed&lt;/a&gt;&lt;/code&gt; element to the address of the resource.&lt;/p&gt;
 
   &lt;!-- next three paragraphs are similar to the navigate-text section,
@@ -52060,13 +52086,12 @@
   &lt;h4 id=read-ua-inline&gt;&lt;span class=secno&gt;6.11.7 &lt;/span&gt;&lt;dfn title=navigate-ua-inline&gt;Page load processing model for inline content that doesn't have a DOM&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When the user agent is to display a user agent page inline in a
-  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent should create a
-  &lt;code&gt;Document&lt;/code&gt; object, mark it as being an &lt;a href=#html-documents title=&quot;HTML
-  documents&quot;&gt;HTML document&lt;/a&gt;, and then either associate that
-  &lt;code&gt;Document&lt;/code&gt; with a custom rendering that is not rendered
-  using the normal &lt;code&gt;Document&lt;/code&gt; rendering rules, or mutate
-  that &lt;code&gt;Document&lt;/code&gt; until it represents the content the user
-  agent wants to render.&lt;/p&gt;
+  &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt;, the user agent should &lt;a href=#create-a-document-object&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, and then either
+  associate that &lt;code&gt;Document&lt;/code&gt; with a custom rendering that is
+  not rendered using the normal &lt;code&gt;Document&lt;/code&gt; rendering rules,
+  or mutate that &lt;code&gt;Document&lt;/code&gt; until it represents the content
+  the user agent wants to render.&lt;/p&gt;
 
   &lt;!-- next two paragraphs are similar to the navigate-text section,
   keep them in sync --&gt;
@@ -55480,8 +55505,8 @@
   &lt;pre class=idl&gt;interface &lt;dfn id=dragevent&gt;DragEvent&lt;/dfn&gt; : MouseEvent {
   readonly attribute &lt;a href=#datatransfer&gt;DataTransfer&lt;/a&gt; &lt;a href=#dom-dragevent-datatransfer title=dom-DragEvent-dataTransfer&gt;dataTransfer&lt;/a&gt;;
 
-  void &lt;a href=#dom-dragevent-initdragevent title=dom-DragEvent-initDragEvent&gt;initDragEvent&lt;/a&gt;(in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in AbstractView viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in boolean ctrlKeyArg, in boolean altKeyArg, in boolean shiftKeyArg, in boolean metaKeyArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in &lt;a href=#datatransfer&gt;DataTransfer&lt;/a&gt; dataTransferArg);
-  void &lt;a href=#dom-dragevent-initdrageventns title=dom-DragEvent-initDragEventNS&gt;initDragEventNS&lt;/a&gt;(in DOMString namespaceURIArg, in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in AbstractView viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in DOMString modifiersListArg, in &lt;a href=#datatransfer&gt;DataTransfer&lt;/a&gt; dataTransferArg);
+  void &lt;a href=#dom-dragevent-initdragevent title=dom-DragEvent-initDragEvent&gt;initDragEvent&lt;/a&gt;(in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in &lt;span&gt;AbstractView&lt;/span&gt; viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in boolean ctrlKeyArg, in boolean altKeyArg, in boolean shiftKeyArg, in boolean metaKeyArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in &lt;a href=#datatransfer&gt;DataTransfer&lt;/a&gt; dataTransferArg);
+  void &lt;a href=#dom-dragevent-initdrageventns title=dom-DragEvent-initDragEventNS&gt;initDragEventNS&lt;/a&gt;(in DOMString namespaceURIArg, in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in &lt;span&gt;AbstractView&lt;/span&gt; viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in DOMString modifiersListArg, in &lt;a href=#datatransfer&gt;DataTransfer&lt;/a&gt; dataTransferArg);
 };&lt;/pre&gt;
 
   &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;event&lt;/var&gt; . &lt;code title=dom-DragEvent-dataTransfer&gt;&lt;a href=#dom-dragevent-datatransfer&gt;dataTransfer&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;

Modified: source
===================================================================
--- source	2009-07-01 21:38:46 UTC (rev 3350)
+++ source	2009-07-01 22:08:21 UTC (rev 3351)
@@ -51669,20 +51669,31 @@
 
   &lt;div class=&quot;impl&quot;&gt;
 
-  &lt;p&gt;The &lt;code title=&quot;&quot;&gt;defaultView&lt;/code&gt; attribute on the
-  &lt;code&gt;Document&lt;/code&gt; object's &lt;code&gt;DocumentView&lt;/code&gt; interface
-  must return the &lt;span&gt;browsing context&lt;/span&gt;'s
-  &lt;code&gt;WindowProxy&lt;/code&gt; object, not the actual
+  &lt;p&gt;The &lt;code title=&quot;dom-document-defaultView&quot;&gt;defaultView&lt;/code&gt;
+  attribute on the &lt;code&gt;Document&lt;/code&gt; object's
+  &lt;code&gt;DocumentView&lt;/code&gt; interface must return the &lt;span&gt;browsing
+  context&lt;/span&gt;'s &lt;code&gt;WindowProxy&lt;/code&gt; object, not the actual
   &lt;code&gt;AbstractView&lt;/code&gt; object of the &lt;span&gt;default
   view&lt;/span&gt;. &lt;a href=&quot;#refsDOM3VIEWS&quot;&gt;[DOM3VIEWS]&lt;/a&gt;&lt;/p&gt;
 
   &lt;/div&gt;
 
-  &lt;p class=&quot;note&quot;&gt;The &lt;code title=&quot;&quot;&gt;document&lt;/code&gt; attribute of an
-  &lt;code&gt;AbstractView&lt;/code&gt; object representing a &lt;span&gt;view&lt;/span&gt;
-  gives the view's corresponding &lt;code&gt;Document&lt;/code&gt; object. &lt;a
+  &lt;p class=&quot;note&quot;&gt;The &lt;code title=&quot;dom-document&quot;&gt;document&lt;/code&gt;
+  attribute of an &lt;code&gt;AbstractView&lt;/code&gt; object representing a
+  &lt;span&gt;view&lt;/span&gt; gives the view's corresponding
+  &lt;code&gt;Document&lt;/code&gt; object. &lt;a
   href=&quot;#refsDOM2VIEWS&quot;&gt;[DOM2VIEWS]&lt;/a&gt;&lt;/p&gt;
 
+  &lt;p class=&quot;note&quot;&gt;In general, there is a 1-to-1 mapping from the
+  &lt;code&gt;Window&lt;/code&gt; object to the &lt;code&gt;Document&lt;/code&gt; object. In
+  one particular case, a set of &lt;span title=&quot;view&quot;&gt;views&lt;/span&gt; can be
+  reused for the presentation of a second &lt;code&gt;Document&lt;/code&gt; in the
+  same &lt;span&gt;browsing context&lt;/span&gt;, such that the mapping is then
+  2:1. This occurs when a &lt;span&gt;browsing context&lt;/span&gt; is &lt;span
+  title=&quot;navigate&quot;&gt;navigated&lt;/span&gt; from the initial
+  &lt;code&gt;about:blank&lt;/code&gt; &lt;code&gt;Document&lt;/code&gt; to another, with
+  &lt;span&gt;replacement enabled&lt;/span&gt;.&lt;/p&gt;
+
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;p&gt;Events that use the &lt;code&gt;UIEvent&lt;/code&gt; interface are related to
@@ -52682,8 +52693,12 @@
 
   &lt;p class=&quot;note&quot;&gt;The &lt;span&gt;browsing context&lt;/span&gt;'s &lt;span&gt;default
   view&lt;/span&gt;'s &lt;code&gt;Window&lt;/code&gt; object &lt;span title=&quot;implied strong
-  reference&quot;&gt;has a strong reference of its own&lt;/span&gt; to its
-  &lt;code&gt;Document&lt;/code&gt; object.&lt;/p&gt;
+  reference&quot;&gt;has a strong reference&lt;/span&gt; to its
+  &lt;code&gt;Document&lt;/code&gt; object through the &lt;code
+  title=&quot;dom-document&quot;&gt;document&lt;/code&gt; attribute of the
+  &lt;code&gt;AbstractView&lt;/code&gt; interface. Thus, references from other
+  scripts to either of those objects will keep both alive. &lt;a
+  href=&quot;#refsDOMVIEWS&quot;&gt;[DOMVIEWS]&lt;/a&gt;&lt;/p&gt;
 
   &lt;p class=&quot;note&quot;&gt;Whenever a &lt;code&gt;Document&lt;/code&gt; object is &lt;span
   title=&quot;discard a Document&quot;&gt;discarded&lt;/span&gt;, it is also removed from
@@ -59044,6 +59059,25 @@
     is set when &lt;span title=&quot;concept-js-deref&quot;&gt;dereferencing a
     &lt;code&gt;javascript:&lt;/code&gt; URL&lt;/span&gt;.&lt;/p&gt;
 
+    &lt;p&gt;&lt;dfn title=&quot;create a Document object&quot;&gt;Creating a new
+    &lt;code&gt;Document&lt;/code&gt; object&lt;/dfn&gt;: When a &lt;code&gt;Document&lt;/code&gt;
+    is created as part of the above steps, a new set of &lt;span
+    title=&quot;view&quot;&gt;views&lt;/span&gt; along with the associated
+    &lt;code&gt;Window&lt;/code&gt; object must be created and associated with the
+    &lt;code&gt;Document&lt;/code&gt;, with one exception: if the &lt;span&gt;browsing
+    context&lt;/span&gt;'s only entry in its &lt;span&gt;session history&lt;/span&gt; is
+    the &lt;code&gt;about:blank&lt;/code&gt; &lt;code&gt;Document&lt;/code&gt; that was added
+    when the &lt;span&gt;browsing context&lt;/span&gt; was created, and navigation
+    is occurring with &lt;span&gt;replacement enabled&lt;/span&gt;, and that
+    &lt;code&gt;Document&lt;/code&gt; has the &lt;span&gt;same origin&lt;/span&gt; as the new
+    &lt;code&gt;Document&lt;/code&gt;, then the &lt;code&gt;Window&lt;/code&gt; object and
+    associated &lt;span title=&quot;view&quot;&gt;views&lt;/span&gt; of that
+    &lt;code&gt;Document&lt;/code&gt; must be used instead, and the &lt;code
+    title=&quot;dom-document&quot;&gt;document&lt;/code&gt; attribute of the
+    &lt;code&gt;AbstractView&lt;/code&gt; objects of those &lt;span
+    title=&quot;view&quot;&gt;views&lt;/span&gt; must be changed to point to the new
+    &lt;code&gt;Document&lt;/code&gt; instead.&lt;/p&gt;
+
    &lt;/li&gt;
 
    &lt;li id=&quot;navigate-non-Document&quot;&gt;
@@ -59175,11 +59209,12 @@
   &lt;h4 id=&quot;read-html&quot;&gt;&lt;dfn title=&quot;navigate-html&quot;&gt;Page load processing model for HTML files&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When an HTML document is to be loaded in a &lt;span&gt;browsing
-  context&lt;/span&gt;, the user agent must create a &lt;code&gt;Document&lt;/code&gt;
-  object, mark it as being an &lt;span title=&quot;HTML documents&quot;&gt;HTML
-  document&lt;/span&gt;, create an &lt;span&gt;HTML parser&lt;/span&gt;, associate it
-  with the document, and begin to use the bytes provided for the
-  document as the &lt;span&gt;input stream&lt;/span&gt; for that parser.&lt;/p&gt;
+  context&lt;/span&gt;, the user agent must &lt;span&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being an &lt;span
+  title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, create an &lt;span&gt;HTML
+  parser&lt;/span&gt;, associate it with the document, and begin to use the
+  bytes provided for the document as the &lt;span&gt;input stream&lt;/span&gt; for
+  that parser.&lt;/p&gt;
 
   &lt;p class=&quot;note&quot;&gt;The &lt;span&gt;input stream&lt;/span&gt; converts bytes into
   characters for use in the &lt;span
@@ -59209,9 +59244,9 @@
   &lt;h4 id=&quot;read-xml&quot;&gt;&lt;dfn title=&quot;navigate-xml&quot;&gt;Page load processing model for XML files&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When faced with displaying an XML file inline, user agents must
-  first create a &lt;code&gt;Document&lt;/code&gt; object, following the
-  requirements of the XML and Namespaces in XML recommendations, RFC
-  3023, DOM3 Core, and other relevant specifications. &lt;a
+  first &lt;span&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, following
+  the requirements of the XML and Namespaces in XML recommendations,
+  RFC 3023, DOM3 Core, and other relevant specifications. &lt;a
   href=&quot;#refsXML&quot;&gt;[XML]&lt;/a&gt; &lt;a href=&quot;#refsXMLNS&quot;&gt;[XMLNS]&lt;/a&gt; &lt;a
   href=&quot;#refsRFC3023&quot;&gt;[RFC3023]&lt;/a&gt; &lt;a
   href=&quot;#refsDOM3CORE&quot;&gt;[DOM3CORE]&lt;/a&gt;&lt;/p&gt;
@@ -59274,14 +59309,14 @@
   &lt;h4 id=&quot;read-text&quot;&gt;&lt;dfn title=&quot;navigate-text&quot;&gt;Page load processing model for text files&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When a plain text document is to be loaded in a &lt;span&gt;browsing
-  context&lt;/span&gt;, the user agent should create a &lt;code&gt;Document&lt;/code&gt;
-  object, mark it as being an &lt;span title=&quot;HTML documents&quot;&gt;HTML
-  document&lt;/span&gt;, create an &lt;span&gt;HTML parser&lt;/span&gt;, associate it
-  with the document, act as if the tokenizer had emitted a start tag
-  token with the tag name &quot;pre&quot;, set the &lt;span&gt;tokenization&lt;/span&gt;
-  stage's &lt;span&gt;content model flag&lt;/span&gt; to &lt;i&gt;PLAINTEXT&lt;/i&gt;, and
-  begin to pass the stream of characters in the plain text document to
-  that tokenizer.&lt;/p&gt;
+  context&lt;/span&gt;, the user agent should &lt;span&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being an &lt;span
+  title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, create an &lt;span&gt;HTML
+  parser&lt;/span&gt;, associate it with the document, act as if the
+  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;, set
+  the &lt;span&gt;tokenization&lt;/span&gt; stage's &lt;span&gt;content model
+  flag&lt;/span&gt; to &lt;i&gt;PLAINTEXT&lt;/i&gt;, and begin to pass the stream of
+  characters in the plain text document to that tokenizer.&lt;/p&gt;
 
   &lt;p&gt;The rules for how to convert the bytes of the plain text document
   into actual characters are defined in RFC 2046, RFC 2646, and
@@ -59318,14 +59353,15 @@
   &lt;h4 id=&quot;read-image&quot;&gt;&lt;dfn title=&quot;navigate-image&quot;&gt;Page load processing model for images&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When an image resource is to be loaded in a &lt;span&gt;browsing
-  context&lt;/span&gt;, the user agent should create a &lt;code&gt;Document&lt;/code&gt;
-  object, mark it as being an &lt;span title=&quot;HTML documents&quot;&gt;HTML
-  document&lt;/span&gt;, append an &lt;code&gt;html&lt;/code&gt; element to the
-  &lt;code&gt;Document&lt;/code&gt;, append a &lt;code&gt;head&lt;/code&gt; element and a
-  &lt;code&gt;body&lt;/code&gt; element to the &lt;code&gt;html&lt;/code&gt; element, append
-  an &lt;code&gt;img&lt;/code&gt; to the &lt;code&gt;body&lt;/code&gt; element, and set the
-  &lt;code title=&quot;attr-img-src&quot;&gt;src&lt;/code&gt; attribute of the
-  &lt;code&gt;img&lt;/code&gt; element to the address of the image.&lt;/p&gt;
+  context&lt;/span&gt;, the user agent should &lt;span&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being an &lt;span
+  title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, append an
+  &lt;code&gt;html&lt;/code&gt; element to the &lt;code&gt;Document&lt;/code&gt;, append a
+  &lt;code&gt;head&lt;/code&gt; element and a &lt;code&gt;body&lt;/code&gt; element to the
+  &lt;code&gt;html&lt;/code&gt; element, append an &lt;code&gt;img&lt;/code&gt; to the
+  &lt;code&gt;body&lt;/code&gt; element, and set the &lt;code
+  title=&quot;attr-img-src&quot;&gt;src&lt;/code&gt; attribute of the &lt;code&gt;img&lt;/code&gt;
+  element to the address of the image.&lt;/p&gt;
 
   &lt;!-- next three paragraphs are similar to the navigate-text section,
   keep them in sync --&gt;
@@ -59352,12 +59388,12 @@
 
   &lt;p&gt;When a resource that requires an external resource to be rendered
   is to be loaded in a &lt;span&gt;browsing context&lt;/span&gt;, the user agent
-  should create a &lt;code&gt;Document&lt;/code&gt; object, mark it as being an
-  &lt;span title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, append an
-  &lt;code&gt;html&lt;/code&gt; element to the &lt;code&gt;Document&lt;/code&gt;, append a
-  &lt;code&gt;head&lt;/code&gt; element and a &lt;code&gt;body&lt;/code&gt; element to the
-  &lt;code&gt;html&lt;/code&gt; element, append an &lt;code&gt;embed&lt;/code&gt; to the
-  &lt;code&gt;body&lt;/code&gt; element, and set the &lt;code
+  should &lt;span&gt;create a &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it
+  as being an &lt;span title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;,
+  append an &lt;code&gt;html&lt;/code&gt; element to the &lt;code&gt;Document&lt;/code&gt;,
+  append a &lt;code&gt;head&lt;/code&gt; element and a &lt;code&gt;body&lt;/code&gt; element
+  to the &lt;code&gt;html&lt;/code&gt; element, append an &lt;code&gt;embed&lt;/code&gt; to
+  the &lt;code&gt;body&lt;/code&gt; element, and set the &lt;code
   title=&quot;attr-embed-src&quot;&gt;src&lt;/code&gt; attribute of the
   &lt;code&gt;embed&lt;/code&gt; element to the address of the resource.&lt;/p&gt;
 
@@ -59390,13 +59426,13 @@
   &lt;h4 id=&quot;read-ua-inline&quot;&gt;&lt;dfn title=&quot;navigate-ua-inline&quot;&gt;Page load processing model for inline content that doesn't have a DOM&lt;/dfn&gt;&lt;/h4&gt;
 
   &lt;p&gt;When the user agent is to display a user agent page inline in a
-  &lt;span&gt;browsing context&lt;/span&gt;, the user agent should create a
-  &lt;code&gt;Document&lt;/code&gt; object, mark it as being an &lt;span title=&quot;HTML
-  documents&quot;&gt;HTML document&lt;/span&gt;, and then either associate that
-  &lt;code&gt;Document&lt;/code&gt; with a custom rendering that is not rendered
-  using the normal &lt;code&gt;Document&lt;/code&gt; rendering rules, or mutate
-  that &lt;code&gt;Document&lt;/code&gt; until it represents the content the user
-  agent wants to render.&lt;/p&gt;
+  &lt;span&gt;browsing context&lt;/span&gt;, the user agent should &lt;span&gt;create a
+  &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being an &lt;span
+  title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, and then either
+  associate that &lt;code&gt;Document&lt;/code&gt; with a custom rendering that is
+  not rendered using the normal &lt;code&gt;Document&lt;/code&gt; rendering rules,
+  or mutate that &lt;code&gt;Document&lt;/code&gt; until it represents the content
+  the user agent wants to render.&lt;/p&gt;
 
   &lt;!-- next two paragraphs are similar to the navigate-text section,
   keep them in sync --&gt;
@@ -64959,8 +64995,8 @@
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;DragEvent&lt;/dfn&gt; : MouseEvent {
   readonly attribute &lt;span&gt;DataTransfer&lt;/span&gt; &lt;span title=&quot;dom-DragEvent-dataTransfer&quot;&gt;dataTransfer&lt;/span&gt;;
 
-  void &lt;span title=&quot;dom-DragEvent-initDragEvent&quot;&gt;initDragEvent&lt;/span&gt;(in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in AbstractView viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in boolean ctrlKeyArg, in boolean altKeyArg, in boolean shiftKeyArg, in boolean metaKeyArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in &lt;span&gt;DataTransfer&lt;/span&gt; dataTransferArg);
-  void &lt;span title=&quot;dom-DragEvent-initDragEventNS&quot;&gt;initDragEventNS&lt;/span&gt;(in DOMString namespaceURIArg, in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in AbstractView viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in DOMString modifiersListArg, in &lt;span&gt;DataTransfer&lt;/span&gt; dataTransferArg);
+  void &lt;span title=&quot;dom-DragEvent-initDragEvent&quot;&gt;initDragEvent&lt;/span&gt;(in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in &lt;span&gt;AbstractView&lt;/span&gt; viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in boolean ctrlKeyArg, in boolean altKeyArg, in boolean shiftKeyArg, in boolean metaKeyArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in &lt;span&gt;DataTransfer&lt;/span&gt; dataTransferArg);
+  void &lt;span title=&quot;dom-DragEvent-initDragEventNS&quot;&gt;initDragEventNS&lt;/span&gt;(in DOMString namespaceURIArg, in DOMString typeArg, in boolean canBubbleArg, in boolean cancelableArg, in &lt;span&gt;AbstractView&lt;/span&gt; viewArg, in long detailArg, in long screenXArg, in long screenYArg, in long clientXArg, in long clientYArg, in unsigned short buttonArg, in EventTarget relatedTargetArg, in DOMString modifiersListArg, in &lt;span&gt;DataTransfer&lt;/span&gt; dataTransferArg);
 };&lt;/pre&gt;
 
   &lt;dl class=&quot;domintro&quot;&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010228.html">[html5] r3350 - [] (0) Mark impl-specific mirodata sections as	such. Make some non-normative tex [...]
</A></li>
	<LI>Next message: <A HREF="010230.html">[html5] r3352 - [e] (0) Make the markup prettier in the examples.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10229">[ date ]</a>
              <a href="thread.html#10229">[ thread ]</a>
              <a href="subject.html#10229">[ subject ]</a>
              <a href="author.html#10229">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
