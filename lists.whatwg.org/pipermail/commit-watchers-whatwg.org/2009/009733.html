<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r2849 - [gw] (2) Change the way resources are loaded for	media elements to make it actua [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2849%20-%20%5Bgw%5D%20%282%29%20Change%20the%20way%20resources%20are%20loaded%20for%0A%09media%20elements%20to%20make%20it%20actua%20%5B...%5D&In-Reply-To=%3C20090223071950.96DD4138A05%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009732.html">
   <LINK REL="Next"  HREF="009734.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r2849 - [gw] (2) Change the way resources are loaded for	media elements to make it actua [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r2849%20-%20%5Bgw%5D%20%282%29%20Change%20the%20way%20resources%20are%20loaded%20for%0A%09media%20elements%20to%20make%20it%20actua%20%5B...%5D&In-Reply-To=%3C20090223071950.96DD4138A05%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r2849 - [gw] (2) Change the way resources are loaded for	media elements to make it actua [...]">whatwg at whatwg.org
       </A><BR>
    <I>Sun Feb 22 23:19:50 PST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="009732.html">[html5] r2848 - [gw] (2) Avoid firing 'canplay' twice if media	buffers slowly. Also, what's this [...]
</A></li>
        <LI>Next message: <A HREF="009734.html">[html5] r2850 - [] (0) Tweak document.domain to handle IPv6	addresses.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9733">[ date ]</a>
              <a href="thread.html#9733">[ thread ]</a>
              <a href="subject.html#9733">[ subject ]</a>
              <a href="author.html#9733">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2009-02-22 23:19:49 -0800 (Sun, 22 Feb 2009)
New Revision: 2849

Modified:
   index
   source
Log:
[gw] (2) Change the way resources are loaded for media elements to make it actually work.

Modified: index
===================================================================
--- index	2009-02-22 09:28:30 UTC (rev 2848)
+++ index	2009-02-23 07:19:49 UTC (rev 2849)
@@ -34,7 +34,7 @@
   &lt;div class=head&gt;
    &lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;h1&gt;HTML 5&lt;/h1&gt;
-   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 22 February 2009&lt;/h2&gt;
+   &lt;h2 class=&quot;no-num no-toc&quot; id=draft-recommendation-&mdash;-date:-01-jan-1901&gt;Draft Recommendation &mdash; 23 February 2009&lt;/h2&gt;
    &lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;dl&gt;&lt;dt&gt;Multiple-page version:&lt;/dt&gt;
@@ -18006,7 +18006,7 @@
   these must return a new &lt;code&gt;&lt;a href=#htmlaudioelement&gt;HTMLAudioElement&lt;/a&gt;&lt;/code&gt; object (a new
   &lt;code&gt;&lt;a href=#audio&gt;audio&lt;/a&gt;&lt;/code&gt; element). If the &lt;var title=&quot;&quot;&gt;src&lt;/var&gt; argument
   is present, the object created must have its &lt;code title=dom-media-src&gt;&lt;a href=#dom-media-src&gt;src&lt;/a&gt;&lt;/code&gt; content attribute set to the
-  provided value, and the user agent must invoke the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method on the object before
+  provided value, and the user agent must invoke the object's &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt; before
   returning.&lt;/p&gt;
 
 
@@ -18155,14 +18155,6 @@
   &lt;a href=#media-resource&gt;media resource&lt;/a&gt; is useful to the user before fetching
   it. Its value must be a valid &lt;a href=#mq&gt;media query&lt;/a&gt;. &lt;a href=#refsMQ&gt;[MQ]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;If a &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; element is inserted into a &lt;a href=#media-element&gt;media
-  element&lt;/a&gt; that is already in a document and whose &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; is in the &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt; state, the user
-  agent must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that implicitly invokes the
-  &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method on the &lt;a href=#media-element&gt;media
-  element&lt;/a&gt;, and ignores any resulting exceptions. The &lt;a href=#task-source&gt;task
-  source&lt;/a&gt; for this task is the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s own
-  &lt;a href=#media-element-new-resource-task-source&gt;media element new resource task source&lt;/a&gt;.&lt;/p&gt;
-
   &lt;p&gt;The DOM attributes &lt;dfn id=dom-source-src title=dom-source-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn id=dom-source-type title=dom-source-type&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn id=dom-source-media title=dom-source-media&gt;&lt;code&gt;media&lt;/code&gt;&lt;/dfn&gt; must
   &lt;a href=#reflect&gt;reflect&lt;/a&gt; the respective content attributes of the same
   name.&lt;/p&gt;
@@ -18186,6 +18178,7 @@
   const unsigned short &lt;a href=#dom-media-network_idle title=dom-media-NETWORK_IDLE&gt;NETWORK_IDLE&lt;/a&gt; = 1;
   const unsigned short &lt;a href=#dom-media-network_loading title=dom-media-NETWORK_LOADING&gt;NETWORK_LOADING&lt;/a&gt; = 2;
   const unsigned short &lt;a href=#dom-media-network_loaded title=dom-media-NETWORK_LOADED&gt;NETWORK_LOADED&lt;/a&gt; = 3;
+  const unsigned short &lt;a href=#dom-media-network_no_source title=dom-media-NETWORK_NO_SOURCE&gt;NETWORK_NO_SOURCE&lt;/a&gt; = 4;
   readonly attribute unsigned short &lt;a href=#dom-media-networkstate title=dom-media-networkState&gt;networkState&lt;/a&gt;;
   readonly attribute float &lt;a href=#dom-media-bufferingrate title=dom-media-bufferingRate&gt;bufferingRate&lt;/a&gt;;
   readonly attribute boolean &lt;a href=#dom-media-bufferingthrottled title=dom-media-bufferingThrottled&gt;bufferingThrottled&lt;/a&gt;;
@@ -18276,23 +18269,21 @@
   resource&lt;/dfn&gt; is used to refer to the complete set of media data,
   e.g. the complete video file, or complete audio file.&lt;/p&gt;
 
-  &lt;p&gt;&lt;a href=#media-element title=&quot;media element&quot;&gt;Media elements&lt;/a&gt; use two &lt;a href=#task-queue title=&quot;task queue&quot;&gt;task queues&lt;/a&gt;, the &lt;dfn id=media-element-event-task-source&gt;media element event
-  task source&lt;/dfn&gt; for asynchronous events and callbacks, and the
-  &lt;dfn id=media-element-new-resource-task-source&gt;media element new resource task source&lt;/dfn&gt; for handling
-  implicit loads. Unless otherwise specified, the &lt;a href=#task-source&gt;task
-  source&lt;/a&gt; for all the tasks &lt;a href=#queue-a-task title=&quot;queue a
-  task&quot;&gt;queued&lt;/a&gt; in this section and its subsections is the
-  &lt;a href=#media-element-event-task-source&gt;media element event task source&lt;/a&gt;.&lt;/p&gt;
+  &lt;p&gt;Unless otherwise specified, the &lt;a href=#task-source&gt;task source&lt;/a&gt; for all
+  the tasks &lt;a href=#queue-a-task title=&quot;queue a task&quot;&gt;queued&lt;/a&gt; in this section
+  and its subsections is the &lt;dfn id=media-element-event-task-source&gt;media element event task
+  source&lt;/dfn&gt;.&lt;/p&gt;
 
 
   &lt;h5 id=error-codes&gt;&lt;span class=secno&gt;4.8.10.1 &lt;/span&gt;Error codes&lt;/h5&gt;
 
   &lt;p&gt;All &lt;a href=#media-element title=&quot;media element&quot;&gt;media elements&lt;/a&gt; have an
   associated error status, which records the last error the element
-  encountered since the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
-  method was last invoked. The &lt;dfn id=dom-media-error title=dom-media-error&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt; attribute, on
-  getting, must return the &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object created for
-  this last error, or null if there has not been an error.&lt;/p&gt;
+  encountered since its &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt; was last
+  invoked. The &lt;dfn id=dom-media-error title=dom-media-error&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt;
+  attribute, on getting, must return the &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt;
+  object created for this last error, or null if there has not been an
+  error.&lt;/p&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=mediaerror&gt;MediaError&lt;/dfn&gt; {
   const unsigned short &lt;a href=#dom-mediaerror-media_err_aborted title=dom-MediaError-MEDIA_ERR_ABORTED&gt;MEDIA_ERR_ABORTED&lt;/a&gt; = 1;
@@ -18334,22 +18325,6 @@
   the address of the media resource (video, audio) to show. The
   attribute, if present, must contain a &lt;a href=#valid-url&gt;valid URL&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;If the &lt;code title=attr-media-src&gt;&lt;a href=#attr-media-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute of a
-  &lt;a href=#media-element&gt;media element&lt;/a&gt; that is already in a document and whose
-  &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; is in the
-  &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt; state is
-  added, changed, or removed, the user agent must &lt;a href=#queue-a-task&gt;queue a
-  task&lt;/a&gt; that implicitly invokes the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method on the &lt;a href=#media-element&gt;media
-  element&lt;/a&gt;, and ignores any resulting exceptions. The &lt;a href=#task-source&gt;task
-  source&lt;/a&gt; for this task is the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s own
-  &lt;a href=#media-element-new-resource-task-source&gt;media element new resource task source&lt;/a&gt;.&lt;/p&gt;
-
-  &lt;p class=note&gt;If a &lt;code title=attr-media-src&gt;&lt;a href=#attr-media-src&gt;src&lt;/a&gt;&lt;/code&gt;
-  attribute is specified, the resource it specifies is the &lt;a href=#media-resource&gt;media
-  resource&lt;/a&gt; that will be used. Otherwise, the resource specified
-  by the first suitable &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; element child of the
-  &lt;a href=#media-element&gt;media element&lt;/a&gt; is the one used.&lt;/p&gt;
-
   &lt;p&gt;The &lt;dfn id=dom-media-src title=dom-media-src&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; DOM
   attribute on &lt;a href=#media-element title=&quot;media element&quot;&gt;media elements&lt;/a&gt; must
   &lt;a href=#reflect&gt;reflect&lt;/a&gt; the respective content attribute of the same
@@ -18357,88 +18332,18 @@
 
   &lt;p&gt;The &lt;dfn id=dom-media-currentsrc title=dom-media-currentSrc&gt;&lt;code&gt;currentSrc&lt;/code&gt;&lt;/dfn&gt; DOM
   attribute is initially the empty string. Its value is changed by the
-  algorithm for the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method
+  &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt;
   defined below.&lt;/p&gt;
 
-  &lt;p&gt;To &lt;dfn id=generate-the-list-of-potential-media-resources&gt;generate the list of potential media resources&lt;/dfn&gt; for
-  a &lt;a href=#media-element&gt;media element&lt;/a&gt;, a user agent must use the following
-  steps. These steps return a list of &lt;a href=#absolute-url title=&quot;absolute
-  URL&quot;&gt;absolute URLs&lt;/a&gt; giving a resource's address.&lt;/p&gt;
+  &lt;p class=note&gt;There are two ways to specify a &lt;a href=#media-resource&gt;media
+  resource&lt;/a&gt;, the &lt;code title=attr-media-src&gt;&lt;a href=#attr-media-src&gt;src&lt;/a&gt;&lt;/code&gt;
+  attribute, or &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; elements. The attribute overrides
+  the elements.&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;
 
-    &lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt; has a &lt;code title=attr-media-src&gt;&lt;a href=#attr-media-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute, then run these
-    substeps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;Resolve&lt;/a&gt; the
-     &lt;a href=#url&gt;URL&lt;/a&gt; given in that attribute, relative to the
-     &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/p&gt;
+  &lt;h5 id=media-types&gt;&lt;span class=secno&gt;4.8.10.3 &lt;/span&gt;Media types&lt;/h5&gt;
 
-     &lt;li&gt;&lt;p&gt;If that is successful, then return a list consisting of
-     only one entry, the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; as the
-     resource's address.&lt;/li&gt;
-
-     &lt;li&gt;&lt;p&gt;Otherwise, return the empty list.&lt;/li&gt;
-
-     &lt;li&gt;&lt;p&gt;Abort the algorithm.&lt;/li&gt;
-
-    &lt;/ol&gt;&lt;p&gt;Otherwise, the &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; elements will be used.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt; has no &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt;
-   element children, then return the empty the list and abort these
-   steps.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be an empty list.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the first
-   &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; element child in the &lt;a href=#media-element&gt;media
-   element&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Loop&lt;/i&gt;: this is the start of the loop that looks at the
-   &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; elements.&lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;If all the following conditions are true:&lt;/p&gt;
-
-    &lt;ul&gt;&lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute.&lt;/li&gt;
-
-     &lt;li&gt;&lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;Resolving&lt;/a&gt; the
-     &lt;a href=#url&gt;URL&lt;/a&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
-     element's &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute
-     relative to &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; does not fail.&lt;/li&gt;
-
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute, or its &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute's value, when
-     parsed as a MIME type (including any codecs described by the
-     &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter), does not represent
-     &lt;a href=#a-type-that-the-user-agent-knows-it-cannot-render&gt;a type that the user agent knows it cannot
-     render&lt;/a&gt;.&lt;/li&gt;
-
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code title=attr-source-media&gt;&lt;a href=#attr-source-media&gt;media&lt;/a&gt;&lt;/code&gt; attribute, or its &lt;code title=attr-source-media&gt;&lt;a href=#attr-source-media&gt;media&lt;/a&gt;&lt;/code&gt; attribute's value, when
-     processed according to the rules for &lt;a href=#mq&gt;media
-     queries&lt;/a&gt;, matches the current environment. &lt;a href=#refsMQ&gt;[MQ]&lt;/a&gt;&lt;/li&gt;
-
-    &lt;/ul&gt;&lt;p&gt;...then append the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; resulting from
-    &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolving&lt;/a&gt; the &lt;a href=#url&gt;URL&lt;/a&gt;
-    given in that &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element's &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute relative to &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;
-    list.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the next
-   &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; element child in the &lt;a href=#media-element&gt;media
-   element&lt;/a&gt;, or null if there are no more such
-   children.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is not null, return to the
-   step labeled &lt;i&gt;loop&lt;/i&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/li&gt;
-
-  &lt;/ol&gt;&lt;h5 id=media-types&gt;&lt;span class=secno&gt;4.8.10.3 &lt;/span&gt;Media types&lt;/h5&gt;
-
   &lt;p&gt;A &lt;a href=#media-resource&gt;media resource&lt;/a&gt; can be described in terms of its
   &lt;em&gt;type&lt;/em&gt;, specifically a MIME type, optionally with a &lt;code title=&quot;&quot;&gt;codecs&lt;/code&gt; parameter. &lt;a href=#refsRFC2046&gt;[RFC2046]&lt;/a&gt; &lt;a href=#refsRFC4281&gt;[RFC4281]&lt;/a&gt;.&lt;/p&gt;
 
@@ -18521,9 +18426,9 @@
 
    &lt;dt&gt;&lt;dfn id=dom-media-network_idle title=dom-media-NETWORK_IDLE&gt;&lt;code&gt;NETWORK_IDLE&lt;/code&gt;&lt;/dfn&gt; (numeric value 1)&lt;/dt&gt;
 
-   &lt;dd&gt;The element's &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method
-   algorithm is active, but it is not actually using the network at
-   this time.&lt;/dd&gt;
+   &lt;dd&gt;The element's &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+   algorithm&lt;/a&gt; is active and has selected a resource, but it is
+   not actually using the network at this time.&lt;/dd&gt;
 
    &lt;dt&gt;&lt;dfn id=dom-media-network_loading title=dom-media-NETWORK_LOADING&gt;&lt;code&gt;NETWORK_LOADING&lt;/code&gt;&lt;/dfn&gt; (numeric value 2)&lt;/dt&gt;
 
@@ -18535,8 +18440,14 @@
    available to the user agent locally. Network connectivity could be
    lost without affecting the media playback.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;p&gt;The algorithm for the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
-  method defined below describes exactly when the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute changes
+   &lt;dt&gt;&lt;dfn id=dom-media-network_no_source title=dom-media-NETWORK_NO_SOURCE&gt;&lt;code&gt;NETWORK_NO_SOURCE&lt;/code&gt;&lt;/dfn&gt; (numeric value 4)&lt;/dt&gt;
+
+   &lt;dd&gt;The element's &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+   algorithm&lt;/a&gt; is active, but it has failed to find a resource to
+   use.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p&gt;The &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+  algorithm&lt;/a&gt; defined below describes exactly when the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute changes
   value and what events fire to indicate changes in this state.&lt;/p&gt;
 
   &lt;p class=note&gt;Some resources, e.g. streaming Web radio, can never
@@ -18545,8 +18456,7 @@
 
   &lt;h5 id=loading-the-media-resource&gt;&lt;span class=secno&gt;4.8.10.5 &lt;/span&gt;Loading the media resource&lt;/h5&gt;
 
-  &lt;p&gt;All &lt;a href=#media-element title=&quot;media element&quot;&gt;media elements&lt;/a&gt; have a
-  &lt;dfn id=begun-flag&gt;begun flag&lt;/dfn&gt;, which must begin in the false state, an
+  &lt;p&gt;All &lt;a href=#media-element title=&quot;media element&quot;&gt;media elements&lt;/a&gt; have an
   &lt;dfn id=autoplaying-flag&gt;autoplaying flag&lt;/dfn&gt;, which must begin in the true state, and
   a &lt;dfn id=delaying-the-load-event-flag&gt;delaying-the-load-event flag&lt;/dfn&gt;, which must begin in the
   false state. While the &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event flag&lt;/a&gt; is
@@ -18558,32 +18468,27 @@
   aborted, e.g. if the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
   method itself is invoked again.&lt;/p&gt;
 
-  &lt;ol&gt;&lt;li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method for
+   this element is already being invoked, then abort these
+   steps.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Abort any already-running instance of the &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt; for this
+   element.&lt;/li&gt;
+
+   &lt;li&gt;
+
     &lt;p&gt;If there are any &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; from
-    the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#media-element-new-resource-task-source&gt;media element new resource
-    task source&lt;/a&gt; or its &lt;a href=#media-element-event-task-source&gt;media element event task
+    the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#media-element-event-task-source&gt;media element event task
     source&lt;/a&gt; in one of the &lt;a href=#task-queue title=&quot;task queue&quot;&gt;task
     queues&lt;/a&gt;, then remove those tasks.&lt;/p&gt;
 
-    &lt;p class=note&gt;Basically, pending events, callbacks, and loads
-    for the media element are discarded when the media element starts
-    loading a new resource.&lt;/p&gt;
+    &lt;p class=note&gt;Basically, pending events and callbacks for the
+    media element are discarded when the media element starts loading
+    a new resource.&lt;/p&gt;
 
    &lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Abort any already-running instance of this algorithm for
-   this element. If those method calls have not yet returned, they
-   must finish the step they are on, and then immediately return. This
-   is not blocking; this algorithm must not wait for the earlier
-   instances to abort before continuing.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event flag&lt;/a&gt;
-   to true. This &lt;a href=#delay-the-load-event title=&quot;delay the load event&quot;&gt;delays the load
-   event&lt;/a&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If the element's &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; is true, then set
-   the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to false, set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt; attribute to a new
+   &lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; is set to &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt; or &lt;code title=dom-media-NETWORK_IDLE&gt;&lt;a href=#dom-media-network_idle&gt;NETWORK_IDLE&lt;/a&gt;&lt;/code&gt;, set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt; attribute to a new
    &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to &lt;code title=dom-MediaError-MEDIA_ERR_ABORTED&gt;&lt;a href=#dom-mediaerror-media_err_aborted&gt;MEDIA_ERR_ABORTED&lt;/a&gt;&lt;/code&gt;,
    and &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-abort&gt;&lt;a href=#event-abort&gt;abort&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
    element&lt;/a&gt;.&lt;/li&gt;
@@ -18595,10 +18500,12 @@
    value of the &lt;code title=dom-media-defaultPlaybackRate&gt;&lt;a href=#dom-media-defaultplaybackrate&gt;defaultPlaybackRate&lt;/a&gt;&lt;/code&gt;
    attribute.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; is not set to
-   &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt;, then
-   run these substeps:&lt;/p&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; is not set to
+    &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt;, then
+    run these substeps:&lt;/p&gt;
+
     &lt;ol&gt;&lt;li&gt;&lt;p&gt;If a fetching process is in progress for the &lt;a href=#media-element&gt;media
      element&lt;/a&gt;, the user agent should stop it.&lt;/li&gt;
 
@@ -18635,348 +18542,496 @@
 
     &lt;/ol&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#generate-the-list-of-potential-media-resources&gt;Generate the list of potential media resources&lt;/a&gt;
-   and let the resulting list be &lt;var title=&quot;&quot;&gt;candidates&lt;/var&gt;.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Asynchronously invoke the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Set the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to true and &lt;a href=#queue-a-task&gt;queue a
-   task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-loadstart&gt;&lt;a href=#event-loadstart&gt;loadstart&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
-   element&lt;/a&gt;.&lt;/li&gt;
-
    &lt;li&gt;
 
-    &lt;p&gt;The method must return, but these steps must continue.&lt;/p&gt;
-
     &lt;p class=note&gt;Playback of any previously playing &lt;a href=#media-resource&gt;media
     resource&lt;/a&gt; for this element stops.&lt;/p&gt;
 
    &lt;/li&gt;
 
+  &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+  algorithm&lt;/dfn&gt; for a &lt;a href=#media-element&gt;media element&lt;/a&gt; is as follows. This
+  algorithm is always invoked asynchronously, meaning that it runs in
+  the background with scripts and other &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; running in parallel.&lt;/p&gt;
 
-   &lt;!-- SYNCHRONOUS / ASYNCHRONOUS BOUNDARY FOR EVENT DISPATCH --&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;While the &lt;a href=#media-element&gt;media element&lt;/a&gt; has neither a &lt;code title=attr-media-src&gt;&lt;a href=#attr-media-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute nor any
+   &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; element children, wait. (This steps might wait
+   forever.)&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event flag&lt;/a&gt;
+   to true. This &lt;a href=#delay-the-load-event title=&quot;delay the load event&quot;&gt;delays the load
+   event&lt;/a&gt;.&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress
+   event&lt;/a&gt; called &lt;code title=event-loadstart&gt;&lt;a href=#event-loadstart&gt;loadstart&lt;/a&gt;&lt;/code&gt;
+   at the &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/li&gt;
+
    &lt;li&gt;
 
-    &lt;p&gt;&lt;i&gt;Candidate loop&lt;/i&gt;: For each item in &lt;var title=&quot;&quot;&gt;candidates&lt;/var&gt;, if any, and in the same order as they
-    were added to the list, run the following steps:&lt;/p&gt;
+    &lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt; has a &lt;code title=attr-media-src&gt;&lt;a href=#attr-media-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute, then run these
+    substeps:&lt;/p&gt;
 
-    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; be the
-     resource given by the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; for the current
-     item in &lt;var title=&quot;&quot;&gt;candidates&lt;/var&gt;. This is now the element's
-     &lt;a href=#media-resource&gt;media resource&lt;/a&gt;.&lt;/li&gt;
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;Resolve&lt;/a&gt; the
+     &lt;a href=#url&gt;URL&lt;/a&gt; given in that attribute, relative to the
+     &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/p&gt;
 
-     &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-currentSrc&gt;&lt;a href=#dom-media-currentsrc&gt;currentSrc&lt;/a&gt;&lt;/code&gt; attribute to the
-     &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; of the &lt;var title=&quot;&quot;&gt;current media
-     resource&lt;/var&gt;.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;If that is successful, then run the &lt;a href=#concept-media-load-resource title=concept-media-load-resource&gt;resource-load
+     algorithm&lt;/a&gt; with the resulting &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;. If
+     that algorithm returns without aborting &lt;em&gt;this&lt;/em&gt; one, then
+     the load failed.&lt;/li&gt;
 
+     &lt;li&gt;&lt;p&gt;Reaching this step indicates that either the URL failed to
+     resolve, or the media resource failed to load. Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt; attribute to a new
+     &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to &lt;code title=dom-MediaError-MEDIA_ERR_NONE_SUPPORTED&gt;&lt;a href=#dom-mediaerror-media_err_none_supported&gt;MEDIA_ERR_NONE_SUPPORTED&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
+     the &lt;a href=#dom-media-network_no_source title=dom-media-NETWORK_NO_SOURCE&gt;NETWORK_NO_SOURCE&lt;/a&gt;
+     value.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress
+     event&lt;/a&gt; called &lt;code title=event-error&gt;&lt;a href=#event-error&gt;error&lt;/a&gt;&lt;/code&gt; at the
+     &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event flag&lt;/a&gt;
+     to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load event&quot;&gt;delaying
+     the load event&lt;/a&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Abort these steps. Until the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method is invoked, the
+     element won't attempt to load another resource.&lt;/li&gt;
+     &lt;!-- it took its ball and went home, sulking. --&gt;
+
+    &lt;/ol&gt;&lt;p&gt;Otherwise, the &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; elements will be used; run
+    these substeps:&lt;/p&gt;
+
+    &lt;ol&gt;&lt;li&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be a position defined by two
+      adjacent nodes in the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s child list,
+      treating the start of the list (before the first child in the
+      list, if any) and end of the list (after the last child in the
+      list, if any) as nodes in their own right. One node is the node
+      before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;, and the other node is the
+      node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;. Initially, let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be the position between the start of the
+      list and the next node (either the first child node of the
+      &lt;a href=#media-element&gt;media element&lt;/a&gt;, if there are any, or the end of the
+      list, if it is empty).&lt;/p&gt;
+
+      &lt;p&gt;As elements are inserted and removed into the &lt;a href=#media-element&gt;media
+      element&lt;/a&gt;, &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; must be updated as
+      follows:&lt;/p&gt;
+
+      &lt;dl&gt;&lt;dt&gt;If a new element is inserted between the two nodes that
+       define &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be the point between the
+       node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; and the new node. In
+       other words, insertions at &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; go after
+       &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;.&lt;/dd&gt;
+
+       &lt;dt&gt;If the node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is removed&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be the point between the
+       node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; and the node before the
+       node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;. In other words, &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; doesn't move relative to the remaining
+       nodes.&lt;/dd&gt;
+
+       &lt;dt&gt;If the node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is removed&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be the point between the
+       node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; and the node after the
+       node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;. Just as with the
+       previous case, &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; doesn't move
+       relative to the remaining nodes.&lt;/dd&gt;
+
+      &lt;/dl&gt;&lt;p&gt;Other changes don't affect &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;.&lt;/p&gt;
+
+     &lt;/li&gt;
+
      &lt;li&gt;
 
-      &lt;p&gt;Begin to &lt;a href=#fetch&gt;fetch&lt;/a&gt; the &lt;var title=&quot;&quot;&gt;current media
-      resource&lt;/var&gt;.&lt;/p&gt;
+      &lt;p&gt;&lt;i&gt;Search loop:&lt;/i&gt; Run these substeps atomically (so that
+      the DOM cannot change while they are running):&lt;/p&gt;
 
-      &lt;p&gt;Every 350ms (&plusmn;200ms) or for every byte received,
-      whichever is &lt;em&gt;least&lt;/em&gt; frequent, &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt;
-      to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-progress&gt;&lt;a href=#event-progress&gt;progress&lt;/a&gt;&lt;/code&gt; at the element.&lt;/p&gt;
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is the end
+       of the list, then jump to the step below labeled
+       &lt;i&gt;waiting&lt;/i&gt;.&lt;/li&gt;
 
-      &lt;p&gt;If at any point the user agent has received no data for more
-      than about three seconds, then &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to
-      &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-stalled&gt;&lt;a href=#event-stalled&gt;stalled&lt;/a&gt;&lt;/code&gt; at the element.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If the node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is a
+       &lt;code&gt;&lt;a href=#the-source-element&gt;source&lt;/a&gt;&lt;/code&gt; element, let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+       be that element; otherwise, let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+       be null.&lt;/li&gt;
 
-      &lt;p&gt;User agents may allow users to selectively block or slow
-      &lt;a href=#media-data&gt;media data&lt;/a&gt; downloads. When a &lt;a href=#media-element&gt;media
-      element&lt;/a&gt;'s download has been blocked altogether, the user
-      agent must act as if it was stalled (as opposed to acting as if
-      the connection was closed). The rate of the download may also be
-      throttled automatically by the user agent, e.g. to balance the
-      download with other connections sharing the same bandwidth.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Advance &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; so that the node
+       before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is now the node that was
+       after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;, and the node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is the node after the node that used to
+       be after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;.&lt;/li&gt;
 
-      &lt;p&gt;User agents may decide to not download more content at any
-      time, e.g. after buffering five minutes of a one hour media
-      resource, while waiting for the user to decide whether to play
-      the resource or not, or while waiting for user input in an
-      interactive resource. When a &lt;a href=#media-element&gt;media element&lt;/a&gt;'s
-      download has been suspended, the user agent must set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_IDLE&gt;&lt;a href=#dom-media-network_idle&gt;NETWORK_IDLE&lt;/a&gt;&lt;/code&gt; and
-      &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt;
-      called &lt;code title=event-suspend&gt;&lt;a href=#event-suspend&gt;suspend&lt;/a&gt;&lt;/code&gt; at the
-      element. If and when downloading of the resource resumes, the
-      user agent must set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is null, restart the
+       step labelled &lt;i&gt;search loop&lt;/i&gt; from the first
+       substep.&lt;/li&gt;
 
-      &lt;p&gt;The user agent may use whatever means necessary to fetch the
-      resource (within the constraints put forward by this and other
-      specifications); for example, reconnecting to the server in the
-      face of network errors, using HTTP partial range requests, or
-      switching to a streaming protocol. The user agent must consider a
-      resource erroneous only if it has given up trying to fetch it.&lt;/p&gt;
+      &lt;/ol&gt;&lt;/li&gt;
 
-      &lt;p&gt;The &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; to process the data as it is
-      being fetched must, when appropriate, include the relevant
-      substeps from the following list:&lt;/p&gt;
+     &lt;li&gt;
 
-      &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; cannot be fetched at all, due
-       to network errors, causing the user agent to give up trying to
-       fetch the resource&lt;/dt&gt;
+      &lt;p&gt;If any of the following conditions are true, then jump back
+      to the step labelled &lt;i&gt;search loop&lt;/i&gt;:&lt;/p&gt;
 
-       &lt;dt&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; can be fetched but is in an
-       unsupported format, or can otherwise not be rendered at
-       all&lt;/dt&gt;
+      &lt;ul&gt;&lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element does not have a
+       &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute.&lt;/li&gt;
 
-       &lt;dd&gt;
+       &lt;li&gt;&lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;Resolving&lt;/a&gt; the
+       &lt;a href=#url&gt;URL&lt;/a&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+       element's &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute
+       relative to &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; fails.&lt;/li&gt;
 
-        &lt;p&gt;DNS errors, HTTP 4xx and 5xx errors (and equivalents in
-        other protocols), and other fatal network errors that occur
-        before the user agent has established whether the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable, as well as
-        the file using an unsupported container format, or using
-        unsupported codecs for all the data, must cause the user agent
-        to execute the following steps:&lt;/p&gt;
+       &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code title=attr-source-type&gt;&lt;a href=#attr-source-type&gt;type&lt;/a&gt;&lt;/code&gt; attribute whose value,
+       when parsed as a MIME type (including any codecs described by
+       the &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter), represents &lt;a href=#a-type-that-the-user-agent-knows-it-cannot-render&gt;a
+       type that the user agent knows it cannot render&lt;/a&gt;.&lt;/li&gt;
 
-        &lt;ol&gt;&lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
-         process.&lt;/li&gt;
+       &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code title=attr-source-media&gt;&lt;a href=#attr-source-media&gt;media&lt;/a&gt;&lt;/code&gt; attribute whose value,
+       when processed according to the rules for &lt;a href=#mq&gt;media
+       queries&lt;/a&gt;, does not match the current environment. &lt;a href=#refsMQ&gt;[MQ]&lt;/a&gt;&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;If there are more items in the &lt;var title=&quot;&quot;&gt;candidates&lt;/var&gt; list, then move on to the next one,
-         jumping back to the top of the &lt;i&gt;candidate loop&lt;/i&gt;;
-         otherwise, jump to the final step in the overall algorithm
-         (the &lt;i&gt;failure step&lt;/i&gt;).&lt;/p&gt;
+      &lt;/ul&gt;&lt;/li&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+     &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt; again,
+     in case it was set to &lt;code title=dom-media-NETWORK_NO_SOURCE&gt;&lt;a href=#dom-media-network_no_source&gt;NETWORK_NO_SOURCE&lt;/a&gt;&lt;/code&gt;
+     above.&lt;/li&gt;
 
+     &lt;li&gt;&lt;p&gt;Run the &lt;a href=#concept-media-load-resource title=concept-media-load-resource&gt;resource-load
+     algorithm&lt;/a&gt; with the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; that resulted
+     from &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolving&lt;/a&gt; the
+     &lt;a href=#url&gt;URL&lt;/a&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+     element's &lt;code title=attr-source-src&gt;&lt;a href=#attr-source-src&gt;src&lt;/a&gt;&lt;/code&gt; attribute
+     relative to &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;. If that algorithm
+     returns without aborting &lt;em&gt;this&lt;/em&gt; one, then the load
+     failed.&lt;/li&gt;
 
-       &lt;dt id=getting-media-metadata&gt;Once enough of the &lt;a href=#media-data&gt;media
-       data&lt;/a&gt; has been fetched to determine the duration of the
-       &lt;a href=#media-resource&gt;media resource&lt;/a&gt;, its dimensions, and other
-       metadata&lt;/dt&gt;
+     &lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;search loop&lt;/i&gt;.&lt;/li&gt;
 
-       &lt;dd&gt;
+     &lt;li&gt;&lt;p&gt;&lt;i&gt;Waiting:&lt;/i&gt; Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt; attribute to a new
+     &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to &lt;code title=dom-MediaError-MEDIA_ERR_NONE_SUPPORTED&gt;&lt;a href=#dom-mediaerror-media_err_none_supported&gt;MEDIA_ERR_NONE_SUPPORTED&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
 
-        &lt;p&gt;This indicates that the resource is usable. The user agent
-        must follow these substeps:&lt;/p&gt;
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
+     the &lt;a href=#dom-media-network_no_source title=dom-media-NETWORK_NO_SOURCE&gt;NETWORK_NO_SOURCE&lt;/a&gt;
+     value&lt;/li&gt;
 
-        &lt;ol&gt;&lt;li&gt;&lt;p&gt;Set the &lt;a href=#current-playback-position&gt;current playback position&lt;/a&gt; to the
-         &lt;var&gt;&lt;a href=#earliest-possible-position&gt;earliest possible position&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress
+     event&lt;/a&gt; called &lt;code title=event-error&gt;&lt;a href=#event-error&gt;error&lt;/a&gt;&lt;/code&gt; at the
+     &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute to
-         &lt;code title=dom-media-HAVE_METADATA&gt;&lt;a href=#dom-media-have_metadata&gt;HAVE_METADATA&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event flag&lt;/a&gt;
+     to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load event&quot;&gt;delaying
+     the load event&lt;/a&gt;.&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;For &lt;code&gt;&lt;a href=#video&gt;video&lt;/a&gt;&lt;/code&gt; elements, set the &lt;code title=dom-video-videoWidth&gt;&lt;a href=#dom-video-videowidth&gt;videoWidth&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-video-videoHeight&gt;&lt;a href=#dom-video-videoheight&gt;videoHeight&lt;/a&gt;&lt;/code&gt;
-         attributes.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Wait until the node after &lt;var title=&quot;&quot;&gt;painter&lt;/var&gt; is a
+     node other than the end of the list. (This step might wait
+     forever.)&lt;/li&gt;
 
-         &lt;li&gt;
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
+     flag&lt;/a&gt; back to true. This &lt;a href=#delay-the-load-event title=&quot;delay the load
+     event&quot;&gt;delays the load event&lt;/a&gt; again, in case it hasn't gone
+     been fired yet.&lt;/li&gt;
 
-          &lt;p&gt;Set the &lt;code title=dom-media-duration&gt;&lt;a href=#dom-media-duration&gt;duration&lt;/a&gt;&lt;/code&gt;
-          attribute to the duration of the resource.&lt;/p&gt;
+    &lt;/ol&gt;&lt;/li&gt;
 
-          &lt;p class=note&gt;The user agent &lt;a href=#durationChange&gt;will&lt;/a&gt; &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to
-          &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; called &lt;code title=event-durationchange&gt;&lt;a href=#event-durationchange&gt;durationchange&lt;/a&gt;&lt;/code&gt; at the
-          element at this point.&lt;/p&gt;
+  &lt;/ol&gt;&lt;p&gt;The &lt;dfn id=concept-media-load-resource title=concept-media-load-resource&gt;resource-load
+  algorithm&lt;/dfn&gt; for a &lt;a href=#media-element&gt;media element&lt;/a&gt; and a given
+  &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is as follows:&lt;/p&gt;
 
-         &lt;/li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; be the
+   resource given by the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; passed to this
+   algorithm. This is now the element's &lt;a href=#media-resource&gt;media
+   resource&lt;/a&gt;.&lt;/li&gt;
 
-         &lt;li id=fire-loadedmetadata&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to
-         &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; called &lt;code title=event-loadedmetadata&gt;&lt;a href=#event-loadedmetadata&gt;loadedmetadata&lt;/a&gt;&lt;/code&gt; at the
-         element.&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-currentSrc&gt;&lt;a href=#dom-media-currentsrc&gt;currentSrc&lt;/a&gt;&lt;/code&gt; attribute to the
+   &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; of the &lt;var title=&quot;&quot;&gt;current media
+   resource&lt;/var&gt;.&lt;/li&gt;
 
-         &lt;li&gt;
+   &lt;li&gt;
 
-          &lt;p&gt;If either the &lt;a href=#media-resource&gt;media resource&lt;/a&gt; or the address
-          of the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; indicate a
-          particular start time, then &lt;a href=#dom-media-seek title=dom-media-seek&gt;seek&lt;/a&gt; to that time. Ignore any
-          resulting exceptions (if the position is out of range, it is
-          effectively ignored).&lt;/p&gt;
+    &lt;p&gt;Begin to &lt;a href=#fetch&gt;fetch&lt;/a&gt; the &lt;var title=&quot;&quot;&gt;current media
+    resource&lt;/var&gt;.&lt;/p&gt;
 
-          &lt;p class=example&gt;For example, a fragment identifier could be
-          used to indicate a start position.&lt;/p&gt;
+    &lt;p&gt;Every 350ms (&plusmn;200ms) or for every byte received,
+    whichever is &lt;em&gt;least&lt;/em&gt; frequent, &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt;
+    to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-progress&gt;&lt;a href=#event-progress&gt;progress&lt;/a&gt;&lt;/code&gt; at the element.&lt;/p&gt;
 
-         &lt;/li&gt;
+    &lt;p&gt;If at any point the user agent has received no data for more
+    than about three seconds, then &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to
+    &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-stalled&gt;&lt;a href=#event-stalled&gt;stalled&lt;/a&gt;&lt;/code&gt; at the element.&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
-         flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
+    &lt;p&gt;User agents may allow users to selectively block or slow
+    &lt;a href=#media-data&gt;media data&lt;/a&gt; downloads. When a &lt;a href=#media-element&gt;media
+    element&lt;/a&gt;'s download has been blocked altogether, the user
+    agent must act as if it was stalled (as opposed to acting as if
+    the connection was closed). The rate of the download may also be
+    throttled automatically by the user agent, e.g. to balance the
+    download with other connections sharing the same bandwidth.&lt;/p&gt;
 
-        &lt;/ol&gt;&lt;p class=note&gt;The user agent is &lt;em&gt;required&lt;/em&gt; to
-        determine the duration of the &lt;a href=#media-resource&gt;media resource&lt;/a&gt; and
-        go through this step before playing.&lt;/p&gt; &lt;!-- actually defined
-        in the 'duration' section --&gt;
+    &lt;p&gt;User agents may decide to not download more content at any
+    time, e.g. after buffering five minutes of a one hour media
+    resource, while waiting for the user to decide whether to play
+    the resource or not, or while waiting for user input in an
+    interactive resource. When a &lt;a href=#media-element&gt;media element&lt;/a&gt;'s
+    download has been suspended, the user agent must set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_IDLE&gt;&lt;a href=#dom-media-network_idle&gt;NETWORK_IDLE&lt;/a&gt;&lt;/code&gt; and
+    &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt;
+    called &lt;code title=event-suspend&gt;&lt;a href=#event-suspend&gt;suspend&lt;/a&gt;&lt;/code&gt; at the
+    element. If and when downloading of the resource resumes, the
+    user agent must set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; to &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
 
-       &lt;/dd&gt;
+    &lt;p&gt;The user agent may use whatever means necessary to fetch the
+    resource (within the constraints put forward by this and other
+    specifications); for example, reconnecting to the server in the
+    face of network errors, using HTTP partial range requests, or
+    switching to a streaming protocol. The user agent must consider a
+    resource erroneous only if it has given up trying to fetch it.&lt;/p&gt;
 
+    &lt;p&gt;The &lt;a href=#networking-task-source&gt;networking task source&lt;/a&gt; &lt;a href=#concept-task title=concept-task&gt;tasks&lt;/a&gt; to process the data as it is
+    being fetched must, when appropriate, include the relevant
+    substeps from the following list:&lt;/p&gt;
 
-       &lt;dt&gt;If the connection is interrupted, causing the user agent to
-       give up trying to fetch the resource&lt;/dt&gt;
+    &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; cannot be fetched at all, due
+     to network errors, causing the user agent to give up trying to
+     fetch the resource&lt;/dt&gt;
 
-       &lt;dd&gt;
+     &lt;dt&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; can be fetched but is in an
+     unsupported format, or can otherwise not be rendered at
+     all&lt;/dt&gt;
 
-        &lt;p&gt;Fatal network errors that occur after the user agent has
-        established whether the &lt;var title=&quot;&quot;&gt;current media
-        resource&lt;/var&gt; is usable must cause the user agent to execute
-        the following steps:&lt;/p&gt;
+     &lt;dd&gt;
 
-        &lt;ol&gt;&lt;li&gt;The user agent should cancel the fetching process.&lt;/li&gt;
+      &lt;p&gt;DNS errors, HTTP 4xx and 5xx errors (and equivalents in
+      other protocols), and other fatal network errors that occur
+      before the user agent has established whether the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable, as well as
+      the file using an unsupported container format, or using
+      unsupported codecs for all the data, must cause the user agent
+      to execute the following steps:&lt;/p&gt;
 
-         &lt;li&gt;Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt;
-         attribute to a new &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to
-         &lt;code title=dom-MediaError-MEDIA_ERR_NETWORK&gt;&lt;a href=#dom-mediaerror-media_err_network&gt;MEDIA_ERR_NETWORK&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/li&gt;
 
-         &lt;li&gt;Set the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to false and &lt;a href=#queue-a-task&gt;queue
-         a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called
-         &lt;code title=event-error&gt;&lt;a href=#event-error&gt;error&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
-         element&lt;/a&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Abort this subalgorithm, returning to the &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt;.&lt;/p&gt;
 
-         &lt;li&gt;Set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute
-         to the &lt;a href=#dom-media-network_empty title=dom-media-NETWORK_EMPTY&gt;NETWORK_EMPTY&lt;/a&gt; value
-         and &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
-         event&lt;/a&gt; called &lt;code title=event-emptied&gt;&lt;a href=#event-emptied&gt;emptied&lt;/a&gt;&lt;/code&gt; at the element.&lt;/li&gt;
+      &lt;/ol&gt;&lt;/dd&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
-         flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
 
-         &lt;li&gt;Abort the overall &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method algorithm.&lt;/li&gt;
+     &lt;dt id=getting-media-metadata&gt;Once enough of the &lt;a href=#media-data&gt;media
+     data&lt;/a&gt; has been fetched to determine the duration of the
+     &lt;a href=#media-resource&gt;media resource&lt;/a&gt;, its dimensions, and other
+     metadata&lt;/dt&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+     &lt;dd&gt;
 
-       &lt;dt id=fatal-decode-error&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; is
-       corrupted&lt;/dt&gt;
+      &lt;p&gt;This indicates that the resource is usable. The user agent
+      must follow these substeps:&lt;/p&gt;
 
-       &lt;dd&gt;
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;Set the &lt;a href=#current-playback-position&gt;current playback position&lt;/a&gt; to the
+       &lt;var&gt;&lt;a href=#earliest-possible-position&gt;earliest possible position&lt;/a&gt;&lt;/var&gt;.&lt;/li&gt;
 
-        &lt;p&gt;Fatal errors in decoding the &lt;a href=#media-data&gt;media data&lt;/a&gt; that
-        occur after the user agent has established whether the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable must cause the
-        user agent to execute the following steps:&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute to
+       &lt;code title=dom-media-HAVE_METADATA&gt;&lt;a href=#dom-media-have_metadata&gt;HAVE_METADATA&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
 
-        &lt;ol&gt;&lt;li&gt;The user agent should cancel the fetching process.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;For &lt;code&gt;&lt;a href=#video&gt;video&lt;/a&gt;&lt;/code&gt; elements, set the &lt;code title=dom-video-videoWidth&gt;&lt;a href=#dom-video-videowidth&gt;videoWidth&lt;/a&gt;&lt;/code&gt; and &lt;code title=dom-video-videoHeight&gt;&lt;a href=#dom-video-videoheight&gt;videoHeight&lt;/a&gt;&lt;/code&gt;
+       attributes.&lt;/li&gt;
 
-         &lt;li&gt;Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt;
-         attribute to a new &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to
-         &lt;code title=dom-MediaError-MEDIA_ERR_DECODE&gt;&lt;a href=#dom-mediaerror-media_err_decode&gt;MEDIA_ERR_DECODE&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
+       &lt;li&gt;
 
-         &lt;li&gt;Set the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to false and &lt;a href=#queue-a-task&gt;queue
-         a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called
-         &lt;code title=event-error&gt;&lt;a href=#event-error&gt;error&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
-         element&lt;/a&gt;.&lt;/li&gt;
+        &lt;p&gt;Set the &lt;code title=dom-media-duration&gt;&lt;a href=#dom-media-duration&gt;duration&lt;/a&gt;&lt;/code&gt;
+        attribute to the duration of the resource.&lt;/p&gt;
 
-         &lt;li&gt;Set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute
-         to the &lt;a href=#dom-media-network_empty title=dom-media-NETWORK_EMPTY&gt;NETWORK_EMPTY&lt;/a&gt; value
-         and &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
-         event&lt;/a&gt; called &lt;code title=event-emptied&gt;&lt;a href=#event-emptied&gt;emptied&lt;/a&gt;&lt;/code&gt; at the element.&lt;/li&gt;
+        &lt;p class=note&gt;The user agent &lt;a href=#durationChange&gt;will&lt;/a&gt; &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to
+        &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; called &lt;code title=event-durationchange&gt;&lt;a href=#event-durationchange&gt;durationchange&lt;/a&gt;&lt;/code&gt; at the
+        element at this point.&lt;/p&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
-         flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
+       &lt;/li&gt;
 
-         &lt;li&gt;Abort the overall &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method algorithm.&lt;/li&gt;
+       &lt;li id=fire-loadedmetadata&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to
+       &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; called &lt;code title=event-loadedmetadata&gt;&lt;a href=#event-loadedmetadata&gt;loadedmetadata&lt;/a&gt;&lt;/code&gt; at the
+       element.&lt;/li&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+       &lt;li&gt;
 
-       &lt;dt&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; fetching process is aborted by
-       the user&lt;/dt&gt;
+        &lt;p&gt;If either the &lt;a href=#media-resource&gt;media resource&lt;/a&gt; or the address
+        of the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; indicate a
+        particular start time, then &lt;a href=#dom-media-seek title=dom-media-seek&gt;seek&lt;/a&gt; to that time. Ignore any
+        resulting exceptions (if the position is out of range, it is
+        effectively ignored).&lt;/p&gt;
 
-       &lt;dd&gt;
+        &lt;p class=example&gt;For example, a fragment identifier could be
+        used to indicate a start position.&lt;/p&gt;
 
-        &lt;p&gt;The fetching process is aborted by the user, e.g. because
-        the user navigated the browsing context to another page, the
-        user agent must execute the following steps. These steps are
-        not followed if the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
-        method itself is reinvoked, as the steps above handle that
-        particular kind of abort.&lt;/p&gt;
+       &lt;/li&gt;
 
-        &lt;ol&gt;&lt;li&gt;The user agent should cancel the fetching process.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
+       flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
 
-         &lt;li&gt;Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt;
-         attribute to a new &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to
-         &lt;code title=dom-MediaError-MEDIA_ERR_ABORT&gt;MEDIA_ERR_ABORT&lt;/code&gt;.&lt;/li&gt;
+      &lt;/ol&gt;&lt;p class=note&gt;The user agent is &lt;em&gt;required&lt;/em&gt; to
+      determine the duration of the &lt;a href=#media-resource&gt;media resource&lt;/a&gt; and
+      go through this step before playing.&lt;/p&gt; &lt;!-- actually defined
+      in the 'duration' section --&gt;
 
-         &lt;li&gt;Set the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to false and &lt;a href=#queue-a-task&gt;queue
-         a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called
-         &lt;code title=event-abort&gt;&lt;a href=#event-abort&gt;abort&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
-         element&lt;/a&gt;.&lt;/li&gt;
+     &lt;/dd&gt;
 
-         &lt;li&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute has
-         a value equal to &lt;code title=dom-media-HAVE_NOTHING&gt;&lt;a href=#dom-media-have_nothing&gt;HAVE_NOTHING&lt;/a&gt;&lt;/code&gt;, set the
-         element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute
-         to the &lt;a href=#dom-media-network_empty title=dom-media-NETWORK_EMPTY&gt;NETWORK_EMPTY&lt;/a&gt; value
-         and &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
-         event&lt;/a&gt; called &lt;code title=event-emptied&gt;&lt;a href=#event-emptied&gt;emptied&lt;/a&gt;&lt;/code&gt; at the element. (If the
-         &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt;
-         attribute has a value greater than &lt;code title=dom-media-HAVE_NOTHING&gt;&lt;a href=#dom-media-have_nothing&gt;HAVE_NOTHING&lt;/a&gt;&lt;/code&gt;, then this
-         doesn't happen; the available data, if any, will be
-         playable.)&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
-         flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
+     &lt;dt&gt;If the connection is interrupted, causing the user agent to
+     give up trying to fetch the resource&lt;/dt&gt;
 
-         &lt;li&gt;Abort the overall &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method algorithm.&lt;/li&gt;
+     &lt;dd&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+      &lt;p&gt;Fatal network errors that occur after the user agent has
+      established whether the &lt;var title=&quot;&quot;&gt;current media
+      resource&lt;/var&gt; is usable must cause the user agent to execute
+      the following steps:&lt;/p&gt;
 
-       &lt;dt id=non-fatal-media-error&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; can
-       be fetched but has non-fatal errors or uses, in part, codecs that
-       are unsupported, preventing the user agent from rendering the
-       content completely correctly but not preventing playback
-       altogether&lt;/dt&gt;
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/li&gt;
 
-       &lt;dd&gt;
+       &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt;
+       attribute to a new &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to
+       &lt;code title=dom-MediaError-MEDIA_ERR_NETWORK&gt;&lt;a href=#dom-mediaerror-media_err_network&gt;MEDIA_ERR_NETWORK&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
 
-        &lt;p&gt;The server returning data that is partially usable but cannot
-        be optimally rendered must cause the user agent to execute the
-        following steps.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress
+       event&lt;/a&gt; called &lt;code title=event-error&gt;&lt;a href=#event-error&gt;error&lt;/a&gt;&lt;/code&gt; at
+       the &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/li&gt;
 
-        &lt;ol&gt;&lt;li class=XXX&gt;Should we fire a 'warning' event? Set the
-         'error' flag to 'MEDIA_ERR_SUBOPTIMAL' or something?&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
+       the &lt;a href=#dom-media-network_empty title=dom-media-NETWORK_EMPTY&gt;NETWORK_EMPTY&lt;/a&gt;
+       value and &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
+       event&lt;/a&gt; called &lt;code title=event-emptied&gt;&lt;a href=#event-emptied&gt;emptied&lt;/a&gt;&lt;/code&gt;
+       at the element.&lt;/li&gt;
 
-        &lt;/ol&gt;&lt;/dd&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
+       flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
 
-      &lt;/dl&gt;&lt;p&gt;When the user agent has completely fetched of the entire
-      &lt;a href=#media-resource&gt;media resource&lt;/a&gt;, it must move on to the next
-      step. This might never happen, e.g. when streaming an infinite
-      resource such as Web radio.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Abort the overall &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+       algorithm&lt;/a&gt;.&lt;/li&gt;
 
-     &lt;/li&gt;
+      &lt;/ol&gt;&lt;/dd&gt;
 
-     &lt;li&gt;&lt;p&gt;If the fetching process completes without errors, then set
-     the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to false, set the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
-     &lt;code title=dom-media-NETWORK_LOADED&gt;&lt;a href=#dom-media-network_loaded&gt;NETWORK_LOADED&lt;/a&gt;&lt;/code&gt;, and
-     &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt;
-     called &lt;code title=event-load&gt;&lt;a href=#event-load&gt;load&lt;/a&gt;&lt;/code&gt; at the
-     element.&lt;/li&gt;
+     &lt;dt id=fatal-decode-error&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; is
+     corrupted&lt;/dt&gt;
 
-     &lt;li&gt;Then, abort the overall &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method algorithm.&lt;/li&gt;
+     &lt;dd&gt;
 
-    &lt;/ol&gt;&lt;/li&gt;
+      &lt;p&gt;Fatal errors in decoding the &lt;a href=#media-data&gt;media data&lt;/a&gt; that
+      occur after the user agent has established whether the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable must cause the
+      user agent to execute the following steps:&lt;/p&gt;
 
-   &lt;li&gt;
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/li&gt;
 
-    &lt;p&gt;&lt;i&gt;Failure step&lt;/i&gt;: No usable resource was found. Run the
-    following steps:&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt;
+       attribute to a new &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to
+       &lt;code title=dom-MediaError-MEDIA_ERR_DECODE&gt;&lt;a href=#dom-mediaerror-media_err_decode&gt;MEDIA_ERR_DECODE&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
 
-    &lt;ol&gt;&lt;li&gt;Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt; attribute
-     to a new &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to &lt;code title=dom-MediaError-MEDIA_ERR_NONE_SUPPORTED&gt;&lt;a href=#dom-mediaerror-media_err_none_supported&gt;MEDIA_ERR_NONE_SUPPORTED&lt;/a&gt;&lt;/code&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress
+       event&lt;/a&gt; called &lt;code title=event-error&gt;&lt;a href=#event-error&gt;error&lt;/a&gt;&lt;/code&gt; at
+       the &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/li&gt;
 
-     &lt;li&gt;Set the &lt;a href=#begun-flag&gt;begun flag&lt;/a&gt; to false and &lt;a href=#queue-a-task&gt;queue a
-     task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt; called &lt;code title=event-error&gt;&lt;a href=#event-error&gt;error&lt;/a&gt;&lt;/code&gt; at the &lt;a href=#media-element&gt;media
-     element&lt;/a&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
+       the &lt;a href=#dom-media-network_empty title=dom-media-NETWORK_EMPTY&gt;NETWORK_EMPTY&lt;/a&gt;
+       value and &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
+       event&lt;/a&gt; called &lt;code title=event-emptied&gt;&lt;a href=#event-emptied&gt;emptied&lt;/a&gt;&lt;/code&gt;
+       at the element.&lt;/li&gt;
 
-     &lt;li&gt;Set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
-     the &lt;a href=#dom-media-network_empty title=dom-media-NETWORK_EMPTY&gt;NETWORK_EMPTY&lt;/a&gt;
-     value and &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
-     event&lt;/a&gt; called &lt;code title=event-emptied&gt;&lt;a href=#event-emptied&gt;emptied&lt;/a&gt;&lt;/code&gt; at
-     the element.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
+       flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
-     flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
-     event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Abort the overall &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+       algorithm&lt;/a&gt;.&lt;/li&gt;
 
-    &lt;/ol&gt;&lt;/li&gt;
+      &lt;/ol&gt;&lt;/dd&gt;
 
+     &lt;dt&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; fetching process is aborted by
+     the user&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;The fetching process is aborted by the user, e.g. because the
+      user navigated the browsing context to another page, the user
+      agent must execute the following steps. These steps are not
+      followed if the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
+      method itself is invoked while these steps are running, as the
+      steps above handle that particular kind of abort.&lt;/p&gt;
+
+      &lt;ol&gt;&lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;Set the &lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt;
+       attribute to a new &lt;code&gt;&lt;a href=#mediaerror&gt;MediaError&lt;/a&gt;&lt;/code&gt; object whose &lt;code title=dom-MediaError-code&gt;&lt;a href=#dom-mediaerror-code&gt;code&lt;/a&gt;&lt;/code&gt; attribute is set to
+       &lt;code title=dom-MediaError-MEDIA_ERR_ABORT&gt;MEDIA_ERR_ABORT&lt;/code&gt;.&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress
+       event&lt;/a&gt; called &lt;code title=event-abort&gt;&lt;a href=#event-abort&gt;abort&lt;/a&gt;&lt;/code&gt; at
+       the &lt;a href=#media-element&gt;media element&lt;/a&gt;.&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute has a
+       value equal to &lt;code title=dom-media-HAVE_NOTHING&gt;&lt;a href=#dom-media-have_nothing&gt;HAVE_NOTHING&lt;/a&gt;&lt;/code&gt;, set the
+       element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
+       the &lt;a href=#dom-media-network_empty title=dom-media-NETWORK_EMPTY&gt;NETWORK_EMPTY&lt;/a&gt;
+       value and &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple
+       event&lt;/a&gt; called &lt;code title=event-emptied&gt;&lt;a href=#event-emptied&gt;emptied&lt;/a&gt;&lt;/code&gt;
+       at the element. Otherwise, set set the element's &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute to
+       the &lt;a href=#dom-media-network_idle title=dom-media-NETWORK_IDLE&gt;NETWORK_IDLE&lt;/a&gt;
+       value.&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;a href=#delaying-the-load-event-flag&gt;delaying-the-load-event
+       flag&lt;/a&gt; to false. This stops &lt;a href=#delay-the-load-event title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/a&gt;.&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;Abort the overall &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+       algorithm&lt;/a&gt;.&lt;/li&gt;
+
+      &lt;/ol&gt;&lt;/dd&gt;
+
+     &lt;dt id=non-fatal-media-error&gt;If the &lt;a href=#media-data&gt;media data&lt;/a&gt; can
+     be fetched but has non-fatal errors or uses, in part, codecs that
+     are unsupported, preventing the user agent from rendering the
+     content completely correctly but not preventing playback
+     altogether&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;The server returning data that is partially usable but cannot
+      be optimally rendered must cause the user agent to execute the
+      following steps.&lt;/p&gt;
+
+      &lt;ol&gt;&lt;li class=XXX&gt;Should we fire a 'warning' event? Set the
+       'error' flag to 'MEDIA_ERR_SUBOPTIMAL' or something?&lt;/li&gt;
+
+      &lt;/ol&gt;&lt;/dd&gt;
+
+    &lt;/dl&gt;&lt;p&gt;When the user agent has completely fetched of the entire
+    &lt;a href=#media-resource&gt;media resource&lt;/a&gt;, it must move on to the next
+    step. This might never happen, e.g. when streaming an infinite
+    resource such as Web radio.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the fetching process completes without errors, then set
+   the &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt;
+   attribute to &lt;code title=dom-media-NETWORK_LOADED&gt;&lt;a href=#dom-media-network_loaded&gt;NETWORK_LOADED&lt;/a&gt;&lt;/code&gt;, and
+   &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-progress-event&gt;fire a progress event&lt;/a&gt;
+   called &lt;code title=event-load&gt;&lt;a href=#event-load&gt;load&lt;/a&gt;&lt;/code&gt; at the
+   element.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Then, abort the overall &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+   algorithm&lt;/a&gt;.&lt;/li&gt;
+
   &lt;/ol&gt;&lt;p&gt;If a &lt;a href=#media-element&gt;media element&lt;/a&gt; whose &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; has the value
   &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt; is &lt;a href=#insert-an-element-into-a-document title=&quot;insert an element into a document&quot;&gt;inserted into a
-  document&lt;/a&gt;, the user agent must &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; that
-  implicitly invokes the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
-  method on the &lt;a href=#media-element&gt;media element&lt;/a&gt;, and ignores any resulting
-  exceptions. The &lt;a href=#task-source&gt;task source&lt;/a&gt; for this task is the
-  &lt;a href=#media-element&gt;media element&lt;/a&gt;'s own &lt;a href=#media-element-new-resource-task-source&gt;media element new resource
-  task source&lt;/a&gt;.&lt;/p&gt;
+  document&lt;/a&gt;, the user agent must asynchronously invoke the
+  &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn id=dom-media-bufferingrate title=dom-media-bufferingRate&gt;&lt;code&gt;bufferingRate&lt;/code&gt;&lt;/dfn&gt;
   attribute must return the average number of bits received per second
@@ -19421,9 +19476,8 @@
 
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute has
    the value &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt;, then the user
-   agent must invoke the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
-   method and wait for it to return. If that raises an exception, that
-   exception must be reraised by the &lt;code title=dom-media-play&gt;&lt;a href=#dom-media-play&gt;play()&lt;/a&gt;&lt;/code&gt; method.&lt;/li&gt;
+   agent must invoke the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+   algorithm&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;
 
@@ -19445,21 +19499,23 @@
     &lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-paused&gt;&lt;a href=#dom-media-paused&gt;paused&lt;/a&gt;&lt;/code&gt; attribute is true, it must
     be set to false.&lt;/p&gt;
 
-    &lt;p&gt;If this changed the value of &lt;code title=dom-media-paused&gt;&lt;a href=#dom-media-paused&gt;paused&lt;/a&gt;&lt;/code&gt;, the user agent must run the following substeps:&lt;/p&gt;
+    &lt;p&gt;If this changed the value of &lt;code title=dom-media-paused&gt;&lt;a href=#dom-media-paused&gt;paused&lt;/a&gt;&lt;/code&gt;, the user agent must run
+    the following substeps:&lt;/p&gt;
 
     &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt;
      called &lt;code title=event-play&gt;&lt;a href=#event-play&gt;play&lt;/a&gt;&lt;/code&gt; at the element.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute has the
-     value &lt;code title=dom-media-HAVE_METADATA&gt;&lt;a href=#dom-media-have_metadata&gt;HAVE_METADATA&lt;/a&gt;&lt;/code&gt;
-     or &lt;code title=dom-media-HAVE_CURRENT_DATA&gt;&lt;a href=#dom-media-have_current_data&gt;HAVE_CURRENT_DATA&lt;/a&gt;&lt;/code&gt;,
+     value &lt;code title=dom-media-HAVE_NOTHING&gt;&lt;a href=#dom-media-have_nothing&gt;HAVE_NOTHING&lt;/a&gt;&lt;/code&gt;,
+     &lt;code title=dom-media-HAVE_METADATA&gt;&lt;a href=#dom-media-have_metadata&gt;HAVE_METADATA&lt;/a&gt;&lt;/code&gt;, or
+     &lt;code title=dom-media-HAVE_CURRENT_DATA&gt;&lt;a href=#dom-media-have_current_data&gt;HAVE_CURRENT_DATA&lt;/a&gt;&lt;/code&gt;,
      &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt;
      called &lt;code title=event-waiting&gt;&lt;a href=#event-waiting&gt;waiting&lt;/a&gt;&lt;/code&gt; at the
      element.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Otherwise, the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute has the value
-     &lt;code title=dom-media-HAVE_FUTURE_DATA&gt;&lt;a href=#dom-media-have_future_data&gt;HAVE_FUTURE_DATA&lt;/a&gt;&lt;/code&gt;
-     or &lt;code title=dom-media-HAVE_ENOUGH_DATA&gt;&lt;a href=#dom-media-have_enough_data&gt;HAVE_ENOUGH_DATA&lt;/a&gt;&lt;/code&gt;;
+     &lt;li&gt;&lt;p&gt;Otherwise, the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-readyState&gt;&lt;a href=#dom-media-readystate&gt;readyState&lt;/a&gt;&lt;/code&gt; attribute has the
+     value &lt;code title=dom-media-HAVE_FUTURE_DATA&gt;&lt;a href=#dom-media-have_future_data&gt;HAVE_FUTURE_DATA&lt;/a&gt;&lt;/code&gt; or
+     &lt;code title=dom-media-HAVE_ENOUGH_DATA&gt;&lt;a href=#dom-media-have_enough_data&gt;HAVE_ENOUGH_DATA&lt;/a&gt;&lt;/code&gt;;
      &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt;
      called &lt;code title=event-playing&gt;&lt;a href=#event-playing&gt;playing&lt;/a&gt;&lt;/code&gt; at the
      element.&lt;/li&gt;
@@ -19476,9 +19532,8 @@
 
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; attribute has
    the value &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt;, then the user
-   agent must invoke the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt;
-   method and wait for it to return. If that raises an exception, that
-   exception must be reraised by the &lt;code title=dom-media-play&gt;&lt;a href=#dom-media-play&gt;pause()&lt;/a&gt;&lt;/code&gt; method.&lt;/li&gt;
+   agent must invoke the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load
+   algorithm&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;code title=dom-media-paused&gt;&lt;a href=#dom-media-paused&gt;paused&lt;/a&gt;&lt;/code&gt; attribute is false, it must
    be set to true.&lt;/li&gt;
@@ -19486,8 +19541,6 @@
    &lt;li&gt;&lt;p&gt;The &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#autoplaying-flag&gt;autoplaying
    flag&lt;/a&gt; must be set to false.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;The method must then return.&lt;/li&gt;
-
    &lt;li&gt;&lt;p&gt;If the second step above changed the value of &lt;code title=dom-media-paused&gt;&lt;a href=#dom-media-paused&gt;paused&lt;/a&gt;&lt;/code&gt;, then the user agent must
    &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt;
    called &lt;code title=event-timeupdate&gt;&lt;a href=#event-timeupdate&gt;timeupdate&lt;/a&gt;&lt;/code&gt; at the
@@ -19849,7 +19902,7 @@
 
    &lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;dfn id=event-loadstart title=event-loadstart&gt;&lt;code&gt;loadstart&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;ProgressEvent&lt;/code&gt; &lt;a href=#refsPROGRESS&gt;[PROGRESS]&lt;/a&gt;
-     &lt;td&gt;The user agent begins fetching the &lt;a href=#media-data&gt;media data&lt;/a&gt;, synchronously during the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method call.
+     &lt;td&gt;The user agent begins looking for &lt;a href=#media-data&gt;media data&lt;/a&gt;, as part of the &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt;.
      &lt;td&gt;&lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; equals &lt;code title=dom-media-NETWORK_LOADING&gt;&lt;a href=#dom-media-network_loading&gt;NETWORK_LOADING&lt;/a&gt;&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-progress title=event-progress&gt;&lt;code&gt;progress&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;ProgressEvent&lt;/code&gt; &lt;a href=#refsPROGRESS&gt;[PROGRESS]&lt;/a&gt;
@@ -19865,7 +19918,7 @@
      &lt;td&gt;&lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; equals &lt;code title=dom-media-NETWORK_LOADED&gt;&lt;a href=#dom-media-network_loaded&gt;NETWORK_LOADED&lt;/a&gt;&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-abort title=event-abort&gt;&lt;code&gt;abort&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;ProgressEvent&lt;/code&gt; &lt;a href=#refsPROGRESS&gt;[PROGRESS]&lt;/a&gt;
-     &lt;td&gt;The user agent stops fetching the &lt;a href=#media-data&gt;media data&lt;/a&gt; before it is completely downloaded. This can be fired synchronously during the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method call.
+     &lt;td&gt;The user agent stops fetching the &lt;a href=#media-data&gt;media data&lt;/a&gt; before it is completely downloaded.
      &lt;td&gt;&lt;code title=dom-media-error&gt;&lt;a href=#dom-media-error&gt;error&lt;/a&gt;&lt;/code&gt; is an object with the code &lt;code title=dom-MediaError-MEDIA_ERR_ABORTED&gt;&lt;a href=#dom-mediaerror-media_err_aborted&gt;MEDIA_ERR_ABORTED&lt;/a&gt;&lt;/code&gt;.
          &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; equals either &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt; or &lt;code title=dom-media-NETWORK_LOADED&gt;&lt;a href=#dom-media-network_loaded&gt;NETWORK_LOADED&lt;/a&gt;&lt;/code&gt;, depending on when the download was aborted.
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-error title=event-error&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt;
@@ -19875,7 +19928,7 @@
          &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; equals either &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt; or &lt;code title=dom-media-NETWORK_LOADED&gt;&lt;a href=#dom-media-network_loaded&gt;NETWORK_LOADED&lt;/a&gt;&lt;/code&gt;, depending on when the download was aborted.
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-emptied title=event-emptied&gt;&lt;code&gt;emptied&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
-     &lt;td&gt;A &lt;a href=#media-element&gt;media element&lt;/a&gt; whose &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; was previously not in the &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt; state has just switched to that state (either because of a fatal error during load that's about to be reported, or because the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method was reinvoked, in which case it is fired synchronously during the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method call).
+     &lt;td&gt;A &lt;a href=#media-element&gt;media element&lt;/a&gt; whose &lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; was previously not in the &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt; state has just switched to that state (either because of a fatal error during load that's about to be reported, or because the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method was invoked while the &lt;a href=#concept-media-load-algorithm title=concept-media-load-algorithm&gt;load algorithm&lt;/a&gt; was already running, in which case it is fired synchronously during the &lt;code title=dom-media-load&gt;&lt;a href=#dom-media-load&gt;load()&lt;/a&gt;&lt;/code&gt; method call).
      &lt;td&gt;&lt;code title=dom-media-networkState&gt;&lt;a href=#dom-media-networkstate&gt;networkState&lt;/a&gt;&lt;/code&gt; is &lt;code title=dom-media-NETWORK_EMPTY&gt;&lt;a href=#dom-media-network_empty&gt;NETWORK_EMPTY&lt;/a&gt;&lt;/code&gt;; all the DOM attributes are in their initial states.
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=event-stalled title=event-stalled&gt;&lt;code&gt;stalled&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;ProgressEvent&lt;/code&gt;

Modified: source
===================================================================
--- source	2009-02-22 09:28:30 UTC (rev 2848)
+++ source	2009-02-23 07:19:49 UTC (rev 2849)
@@ -19291,8 +19291,8 @@
   &lt;code&gt;audio&lt;/code&gt; element). If the &lt;var title=&quot;&quot;&gt;src&lt;/var&gt; argument
   is present, the object created must have its &lt;code
   title=&quot;dom-media-src&quot;&gt;src&lt;/code&gt; content attribute set to the
-  provided value, and the user agent must invoke the &lt;code
-  title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method on the object before
+  provided value, and the user agent must invoke the object's &lt;span
+  title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt; before
   returning.&lt;/p&gt;
 
 
@@ -19455,16 +19455,6 @@
   it. Its value must be a valid &lt;a href=&quot;#mq&quot;&gt;media query&lt;/a&gt;. &lt;a
   href=&quot;#refsMQ&quot;&gt;[MQ]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;If a &lt;code&gt;source&lt;/code&gt; element is inserted into a &lt;span&gt;media
-  element&lt;/span&gt; that is already in a document and whose &lt;code
-  title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; is in the &lt;code
-  title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt; state, the user
-  agent must &lt;span&gt;queue a task&lt;/span&gt; that implicitly invokes the
-  &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method on the &lt;span&gt;media
-  element&lt;/span&gt;, and ignores any resulting exceptions. The &lt;span&gt;task
-  source&lt;/span&gt; for this task is the &lt;span&gt;media element&lt;/span&gt;'s own
-  &lt;span&gt;media element new resource task source&lt;/span&gt;.&lt;/p&gt;
-
   &lt;p&gt;The DOM attributes &lt;dfn
   title=&quot;dom-source-src&quot;&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt;, &lt;dfn
   title=&quot;dom-source-type&quot;&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dfn&gt;, and &lt;dfn
@@ -19491,6 +19481,7 @@
   const unsigned short &lt;span title=&quot;dom-media-NETWORK_IDLE&quot;&gt;NETWORK_IDLE&lt;/span&gt; = 1;
   const unsigned short &lt;span title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/span&gt; = 2;
   const unsigned short &lt;span title=&quot;dom-media-NETWORK_LOADED&quot;&gt;NETWORK_LOADED&lt;/span&gt; = 3;
+  const unsigned short &lt;span title=&quot;dom-media-NETWORK_NO_SOURCE&quot;&gt;NETWORK_NO_SOURCE&lt;/span&gt; = 4;
   readonly attribute unsigned short &lt;span title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/span&gt;;
   readonly attribute float &lt;span title=&quot;dom-media-bufferingRate&quot;&gt;bufferingRate&lt;/span&gt;;
   readonly attribute boolean &lt;span title=&quot;dom-media-bufferingThrottled&quot;&gt;bufferingThrottled&lt;/span&gt;;
@@ -19586,25 +19577,22 @@
   resource&lt;/dfn&gt; is used to refer to the complete set of media data,
   e.g. the complete video file, or complete audio file.&lt;/p&gt;
 
-  &lt;p&gt;&lt;span title=&quot;media element&quot;&gt;Media elements&lt;/span&gt; use two &lt;span
-  title=&quot;task queue&quot;&gt;task queues&lt;/span&gt;, the &lt;dfn&gt;media element event
-  task source&lt;/dfn&gt; for asynchronous events and callbacks, and the
-  &lt;dfn&gt;media element new resource task source&lt;/dfn&gt; for handling
-  implicit loads. Unless otherwise specified, the &lt;span&gt;task
-  source&lt;/span&gt; for all the tasks &lt;span title=&quot;queue a
-  task&quot;&gt;queued&lt;/span&gt; in this section and its subsections is the
-  &lt;span&gt;media element event task source&lt;/span&gt;.&lt;/p&gt;
+  &lt;p&gt;Unless otherwise specified, the &lt;span&gt;task source&lt;/span&gt; for all
+  the tasks &lt;span title=&quot;queue a task&quot;&gt;queued&lt;/span&gt; in this section
+  and its subsections is the &lt;dfn&gt;media element event task
+  source&lt;/dfn&gt;.&lt;/p&gt;
 
 
   &lt;h5&gt;Error codes&lt;/h5&gt;
 
   &lt;p&gt;All &lt;span title=&quot;media element&quot;&gt;media elements&lt;/span&gt; have an
   associated error status, which records the last error the element
-  encountered since the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
-  method was last invoked. The &lt;dfn
-  title=&quot;dom-media-error&quot;&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt; attribute, on
-  getting, must return the &lt;code&gt;MediaError&lt;/code&gt; object created for
-  this last error, or null if there has not been an error.&lt;/p&gt;
+  encountered since its &lt;span
+  title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt; was last
+  invoked. The &lt;dfn title=&quot;dom-media-error&quot;&gt;&lt;code&gt;error&lt;/code&gt;&lt;/dfn&gt;
+  attribute, on getting, must return the &lt;code&gt;MediaError&lt;/code&gt;
+  object created for this last error, or null if there has not been an
+  error.&lt;/p&gt;
 
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;MediaError&lt;/dfn&gt; {
   const unsigned short &lt;span title=&quot;dom-MediaError-MEDIA_ERR_ABORTED&quot;&gt;MEDIA_ERR_ABORTED&lt;/span&gt; = 1;
@@ -19652,23 +19640,6 @@
   the address of the media resource (video, audio) to show. The
   attribute, if present, must contain a &lt;span&gt;valid URL&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;If the &lt;code title=&quot;attr-media-src&quot;&gt;src&lt;/code&gt; attribute of a
-  &lt;span&gt;media element&lt;/span&gt; that is already in a document and whose
-  &lt;code title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; is in the
-  &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt; state is
-  added, changed, or removed, the user agent must &lt;span&gt;queue a
-  task&lt;/span&gt; that implicitly invokes the &lt;code
-  title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method on the &lt;span&gt;media
-  element&lt;/span&gt;, and ignores any resulting exceptions. The &lt;span&gt;task
-  source&lt;/span&gt; for this task is the &lt;span&gt;media element&lt;/span&gt;'s own
-  &lt;span&gt;media element new resource task source&lt;/span&gt;.&lt;/p&gt;
-
-  &lt;p class=&quot;note&quot;&gt;If a &lt;code title=&quot;attr-media-src&quot;&gt;src&lt;/code&gt;
-  attribute is specified, the resource it specifies is the &lt;span&gt;media
-  resource&lt;/span&gt; that will be used. Otherwise, the resource specified
-  by the first suitable &lt;code&gt;source&lt;/code&gt; element child of the
-  &lt;span&gt;media element&lt;/span&gt; is the one used.&lt;/p&gt;
-
   &lt;p&gt;The &lt;dfn title=&quot;dom-media-src&quot;&gt;&lt;code&gt;src&lt;/code&gt;&lt;/dfn&gt; DOM
   attribute on &lt;span title=&quot;media element&quot;&gt;media elements&lt;/span&gt; must
   &lt;span&gt;reflect&lt;/span&gt; the respective content attribute of the same
@@ -19677,109 +19648,16 @@
   &lt;p&gt;The &lt;dfn
   title=&quot;dom-media-currentSrc&quot;&gt;&lt;code&gt;currentSrc&lt;/code&gt;&lt;/dfn&gt; DOM
   attribute is initially the empty string. Its value is changed by the
-  algorithm for the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method
+  &lt;span title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt;
   defined below.&lt;/p&gt;
 
-  &lt;p&gt;To &lt;dfn&gt;generate the list of potential media resources&lt;/dfn&gt; for
-  a &lt;span&gt;media element&lt;/span&gt;, a user agent must use the following
-  steps. These steps return a list of &lt;span title=&quot;absolute
-  URL&quot;&gt;absolute URLs&lt;/span&gt; giving a resource's address.&lt;/p&gt;
+  &lt;p class=&quot;note&quot;&gt;There are two ways to specify a &lt;span&gt;media
+  resource&lt;/span&gt;, the &lt;code title=&quot;attr-media-src&quot;&gt;src&lt;/code&gt;
+  attribute, or &lt;code&gt;source&lt;/code&gt; elements. The attribute overrides
+  the elements.&lt;/p&gt;
 
-  &lt;ol&gt;
 
-   &lt;li&gt;
 
-    &lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt; has a &lt;code
-    title=&quot;attr-media-src&quot;&gt;src&lt;/code&gt; attribute, then run these
-    substeps:&lt;/p&gt;
-
-    &lt;ol&gt;
-
-     &lt;li&gt;&lt;p&gt;&lt;span title=&quot;resolve a url&quot;&gt;Resolve&lt;/span&gt; the
-     &lt;span&gt;URL&lt;/span&gt; given in that attribute, relative to the
-     &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;
-
-     &lt;li&gt;&lt;p&gt;If that is successful, then return a list consisting of
-     only one entry, the resulting &lt;span&gt;absolute URL&lt;/span&gt; as the
-     resource's address.&lt;/p&gt;&lt;/li&gt;
-
-     &lt;li&gt;&lt;p&gt;Otherwise, return the empty list.&lt;/p&gt;&lt;/li&gt;
-
-     &lt;li&gt;&lt;p&gt;Abort the algorithm.&lt;/p&gt;&lt;/li&gt;
-
-    &lt;/ol&gt;
-
-    &lt;p&gt;Otherwise, the &lt;code&gt;source&lt;/code&gt; elements will be used.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt; has no &lt;code&gt;source&lt;/code&gt;
-   element children, then return the empty the list and abort these
-   steps.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;result&lt;/var&gt; be an empty list.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the first
-   &lt;code&gt;source&lt;/code&gt; element child in the &lt;span&gt;media
-   element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;&lt;i&gt;Loop&lt;/i&gt;: this is the start of the loop that looks at the
-   &lt;code&gt;source&lt;/code&gt; elements.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;If all the following conditions are true:&lt;/p&gt;
-
-    &lt;ul&gt;
-
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code
-     title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute.&lt;/li&gt;
-
-     &lt;li&gt;&lt;span title=&quot;resolve a url&quot;&gt;Resolving&lt;/span&gt; the
-     &lt;span&gt;URL&lt;/span&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
-     element's &lt;code title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute
-     relative to &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; does not fail.&lt;/li&gt;
-
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code
-     title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute, or its &lt;code
-     title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute's value, when
-     parsed as a MIME type (including any codecs described by the
-     &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter), does not represent
-     &lt;span&gt;a type that the user agent knows it cannot
-     render&lt;/span&gt;.&lt;/li&gt;
-
-     &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element either has no &lt;code
-     title=&quot;attr-source-media&quot;&gt;media&lt;/code&gt; attribute, or its &lt;code
-     title=&quot;attr-source-media&quot;&gt;media&lt;/code&gt; attribute's value, when
-     processed according to the rules for &lt;a href=&quot;#mq&quot;&gt;media
-     queries&lt;/a&gt;, matches the current environment. &lt;a
-     href=&quot;#refsMQ&quot;&gt;[MQ]&lt;/a&gt;&lt;/li&gt;
-
-    &lt;/ul&gt;
-
-    &lt;p&gt;...then append the &lt;span&gt;absolute URL&lt;/span&gt; resulting from
-    &lt;span title=&quot;resolve a url&quot;&gt;resolving&lt;/span&gt; the &lt;span&gt;URL&lt;/span&gt;
-    given in that &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element's &lt;code
-    title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute relative to &lt;var
-    title=&quot;&quot;&gt;candidate&lt;/var&gt; to the &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;
-    list.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; be the next
-   &lt;code&gt;source&lt;/code&gt; element child in the &lt;span&gt;media
-   element&lt;/span&gt;, or null if there are no more such
-   children.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is not null, return to the
-   step labeled &lt;i&gt;loop&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;result&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
-
-  &lt;/ol&gt;
-
-
-
   &lt;h5&gt;Media types&lt;/h5&gt;
 
   &lt;p&gt;A &lt;span&gt;media resource&lt;/span&gt; can be described in terms of its
@@ -19874,9 +19752,9 @@
 
    &lt;dt&gt;&lt;dfn title=&quot;dom-media-NETWORK_IDLE&quot;&gt;&lt;code&gt;NETWORK_IDLE&lt;/code&gt;&lt;/dfn&gt; (numeric value 1)&lt;/dt&gt;
 
-   &lt;dd&gt;The element's &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method
-   algorithm is active, but it is not actually using the network at
-   this time.&lt;/dd&gt;
+   &lt;dd&gt;The element's &lt;span title=&quot;concept-media-load-algorithm&quot;&gt;load
+   algorithm&lt;/span&gt; is active and has selected a resource, but it is
+   not actually using the network at this time.&lt;/dd&gt;
 
    &lt;dt&gt;&lt;dfn title=&quot;dom-media-NETWORK_LOADING&quot;&gt;&lt;code&gt;NETWORK_LOADING&lt;/code&gt;&lt;/dfn&gt; (numeric value 2)&lt;/dt&gt;
 
@@ -19888,10 +19766,16 @@
    available to the user agent locally. Network connectivity could be
    lost without affecting the media playback.&lt;/dd&gt;
 
+   &lt;dt&gt;&lt;dfn title=&quot;dom-media-NETWORK_NO_SOURCE&quot;&gt;&lt;code&gt;NETWORK_NO_SOURCE&lt;/code&gt;&lt;/dfn&gt; (numeric value 4)&lt;/dt&gt;
+
+   &lt;dd&gt;The element's &lt;span title=&quot;concept-media-load-algorithm&quot;&gt;load
+   algorithm&lt;/span&gt; is active, but it has failed to find a resource to
+   use.&lt;/dd&gt;
+
   &lt;/dl&gt;
 
-  &lt;p&gt;The algorithm for the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
-  method defined below describes exactly when the &lt;code
+  &lt;p&gt;The &lt;span title=&quot;concept-media-load-algorithm&quot;&gt;load
+  algorithm&lt;/span&gt; defined below describes exactly when the &lt;code
   title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute changes
   value and what events fire to indicate changes in this state.&lt;/p&gt;
 
@@ -19902,8 +19786,7 @@
 
   &lt;h5&gt;Loading the media resource&lt;/h5&gt;
 
-  &lt;p&gt;All &lt;span title=&quot;media element&quot;&gt;media elements&lt;/span&gt; have a
-  &lt;dfn&gt;begun flag&lt;/dfn&gt;, which must begin in the false state, an
+  &lt;p&gt;All &lt;span title=&quot;media element&quot;&gt;media elements&lt;/span&gt; have an
   &lt;dfn&gt;autoplaying flag&lt;/dfn&gt;, which must begin in the true state, and
   a &lt;dfn&gt;delaying-the-load-event flag&lt;/dfn&gt;, which must begin in the
   false state. While the &lt;span&gt;delaying-the-load-event flag&lt;/span&gt; is
@@ -19917,32 +19800,31 @@
 
   &lt;ol&gt;
 
+   &lt;li&gt;&lt;p&gt;If the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method for
+   this element is already being invoked, then abort these
+   steps.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Abort any already-running instance of the &lt;span
+   title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt; for this
+   element.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;
 
     &lt;p&gt;If there are any &lt;span title=&quot;concept-task&quot;&gt;tasks&lt;/span&gt; from
-    the &lt;span&gt;media element&lt;/span&gt;'s &lt;span&gt;media element new resource
-    task source&lt;/span&gt; or its &lt;span&gt;media element event task
+    the &lt;span&gt;media element&lt;/span&gt;'s &lt;span&gt;media element event task
     source&lt;/span&gt; in one of the &lt;span title=&quot;task queue&quot;&gt;task
     queues&lt;/span&gt;, then remove those tasks.&lt;/p&gt;
 
-    &lt;p class=&quot;note&quot;&gt;Basically, pending events, callbacks, and loads
-    for the media element are discarded when the media element starts
-    loading a new resource.&lt;/p&gt;
+    &lt;p class=&quot;note&quot;&gt;Basically, pending events and callbacks for the
+    media element are discarded when the media element starts loading
+    a new resource.&lt;/p&gt;
 
    &lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Abort any already-running instance of this algorithm for
-   this element. If those method calls have not yet returned, they
-   must finish the step they are on, and then immediately return. This
-   is not blocking; this algorithm must not wait for the earlier
-   instances to abort before continuing.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event flag&lt;/span&gt;
-   to true. This &lt;span title=&quot;delay the load event&quot;&gt;delays the load
-   event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
-
-   &lt;li&gt;&lt;p&gt;If the element's &lt;span&gt;begun flag&lt;/span&gt; is true, then set
-   the &lt;span&gt;begun flag&lt;/span&gt; to false, set the &lt;code
+   &lt;li&gt;&lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
+   title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; is set to &lt;code
+   title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/code&gt; or &lt;code
+   title=&quot;dom-media-NETWORK_IDLE&quot;&gt;NETWORK_IDLE&lt;/code&gt;, set the &lt;code
    title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt; attribute to a new
    &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
    title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to &lt;code
@@ -19960,11 +19842,13 @@
    title=&quot;dom-media-defaultPlaybackRate&quot;&gt;defaultPlaybackRate&lt;/code&gt;
    attribute.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
-   title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; is not set to
-   &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt;, then
-   run these substeps:&lt;/p&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
+    title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; is not set to
+    &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt;, then
+    run these substeps:&lt;/p&gt;
+
     &lt;ol&gt;
 
      &lt;li&gt;&lt;p&gt;If a fetching process is in progress for the &lt;span&gt;media
@@ -20008,439 +19892,621 @@
 
    &lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span&gt;Generate the list of potential media resources&lt;/span&gt;
-   and let the resulting list be &lt;var
-   title=&quot;&quot;&gt;candidates&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Asynchronously invoke the &lt;span&gt;media element&lt;/span&gt;'s &lt;span
+   title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt;.&lt;/li&gt;
 
+   &lt;li&gt;
+
+    &lt;p class=&quot;note&quot;&gt;Playback of any previously playing &lt;span&gt;media
+    resource&lt;/span&gt; for this element stops.&lt;/p&gt;
+
+   &lt;/li&gt;
+
+  &lt;/ol&gt;
+
+  &lt;p&gt;The &lt;dfn title=&quot;concept-media-load-algorithm&quot;&gt;load
+  algorithm&lt;/dfn&gt; for a &lt;span&gt;media element&lt;/span&gt; is as follows. This
+  algorithm is always invoked asynchronously, meaning that it runs in
+  the background with scripts and other &lt;span
+  title=&quot;concept-task&quot;&gt;tasks&lt;/span&gt; running in parallel.&lt;/p&gt;
+
+  &lt;ol&gt;
+
+   &lt;li&gt;&lt;p&gt;While the &lt;span&gt;media element&lt;/span&gt; has neither a &lt;code
+   title=&quot;attr-media-src&quot;&gt;src&lt;/code&gt; attribute nor any
+   &lt;code&gt;source&lt;/code&gt; element children, wait. (This steps might wait
+   forever.)&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event flag&lt;/span&gt;
+   to true. This &lt;span title=&quot;delay the load event&quot;&gt;delays the load
+   event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;Set the &lt;code
    title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; to &lt;code
    title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Set the &lt;span&gt;begun flag&lt;/span&gt; to true and &lt;span&gt;queue a
-   task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
-   title=&quot;event-loadstart&quot;&gt;loadstart&lt;/code&gt; at the &lt;span&gt;media
-   element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a progress
+   event&lt;/span&gt; called &lt;code title=&quot;event-loadstart&quot;&gt;loadstart&lt;/code&gt;
+   at the &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;The method must return, but these steps must continue.&lt;/p&gt;
+    &lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt; has a &lt;code
+    title=&quot;attr-media-src&quot;&gt;src&lt;/code&gt; attribute, then run these
+    substeps:&lt;/p&gt;
 
-    &lt;p class=&quot;note&quot;&gt;Playback of any previously playing &lt;span&gt;media
-    resource&lt;/span&gt; for this element stops.&lt;/p&gt;
+    &lt;ol&gt;
 
-   &lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;span title=&quot;resolve a url&quot;&gt;Resolve&lt;/span&gt; the
+     &lt;span&gt;URL&lt;/span&gt; given in that attribute, relative to the
+     &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;
 
+     &lt;li&gt;&lt;p&gt;If that is successful, then run the &lt;span
+     title=&quot;concept-media-load-resource&quot;&gt;resource-load
+     algorithm&lt;/span&gt; with the resulting &lt;span&gt;absolute URL&lt;/span&gt;. If
+     that algorithm returns without aborting &lt;em&gt;this&lt;/em&gt; one, then
+     the load failed.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;!-- SYNCHRONOUS / ASYNCHRONOUS BOUNDARY FOR EVENT DISPATCH --&gt;
+     &lt;li&gt;&lt;p&gt;Reaching this step indicates that either the URL failed to
+     resolve, or the media resource failed to load. Set the &lt;code
+     title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt; attribute to a new
+     &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
+     title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to &lt;code
+     title=&quot;dom-MediaError-MEDIA_ERR_NONE_SUPPORTED&quot;&gt;MEDIA_ERR_NONE_SUPPORTED&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
 
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;code
+     title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
+     the &lt;span
+     title=&quot;dom-media-NETWORK_NO_SOURCE&quot;&gt;NETWORK_NO_SOURCE&lt;/span&gt;
+     value.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a progress
+     event&lt;/span&gt; called &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the
+     &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-    &lt;p&gt;&lt;i&gt;Candidate loop&lt;/i&gt;: For each item in &lt;var
-    title=&quot;&quot;&gt;candidates&lt;/var&gt;, if any, and in the same order as they
-    were added to the list, run the following steps:&lt;/p&gt;
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event flag&lt;/span&gt;
+     to false. This stops &lt;span title=&quot;delay the load event&quot;&gt;delaying
+     the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
+     &lt;li&gt;&lt;p&gt;Abort these steps. Until the &lt;code
+     title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method is invoked, the
+     element won't attempt to load another resource.&lt;/p&gt;&lt;/li&gt;
+     &lt;!-- it took its ball and went home, sulking. --&gt;
+
+    &lt;/ol&gt;
+
+    &lt;p&gt;Otherwise, the &lt;code&gt;source&lt;/code&gt; elements will be used; run
+    these substeps:&lt;/p&gt;
+
     &lt;ol&gt;
 
-     &lt;li&gt;&lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; be the
-     resource given by the &lt;span&gt;absolute URL&lt;/span&gt; for the current
-     item in &lt;var title=&quot;&quot;&gt;candidates&lt;/var&gt;. This is now the element's
-     &lt;span&gt;media resource&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;
 
-     &lt;li&gt;&lt;p&gt;Set the &lt;code
-     title=&quot;dom-media-currentSrc&quot;&gt;currentSrc&lt;/code&gt; attribute to the
-     &lt;span&gt;absolute URL&lt;/span&gt; of the &lt;var title=&quot;&quot;&gt;current media
-     resource&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be a position defined by two
+      adjacent nodes in the &lt;span&gt;media element&lt;/span&gt;'s child list,
+      treating the start of the list (before the first child in the
+      list, if any) and end of the list (after the last child in the
+      list, if any) as nodes in their own right. One node is the node
+      before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;, and the other node is the
+      node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;. Initially, let &lt;var
+      title=&quot;&quot;&gt;pointer&lt;/var&gt; be the position between the start of the
+      list and the next node (either the first child node of the
+      &lt;span&gt;media element&lt;/span&gt;, if there are any, or the end of the
+      list, if it is empty).&lt;/p&gt;
 
+      &lt;p&gt;As elements are inserted and removed into the &lt;span&gt;media
+      element&lt;/span&gt;, &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; must be updated as
+      follows:&lt;/p&gt;
+
+      &lt;dl&gt;
+
+       &lt;dt&gt;If a new element is inserted between the two nodes that
+       define &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be the point between the
+       node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; and the new node. In
+       other words, insertions at &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; go after
+       &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;.&lt;/dd&gt;
+
+       &lt;dt&gt;If the node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is removed&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be the point between the
+       node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; and the node before the
+       node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;. In other words, &lt;var
+       title=&quot;&quot;&gt;pointer&lt;/var&gt; doesn't move relative to the remaining
+       nodes.&lt;/dd&gt;
+
+       &lt;dt&gt;If the node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is removed&lt;/dt&gt;
+
+       &lt;dd&gt;Let &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; be the point between the
+       node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; and the node after the
+       node before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;. Just as with the
+       previous case, &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; doesn't move
+       relative to the remaining nodes.&lt;/dd&gt;
+
+      &lt;/dl&gt;
+
+      &lt;p&gt;Other changes don't affect &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;.&lt;/p&gt;
+
+     &lt;/li&gt;
+
      &lt;li&gt;
 
-      &lt;p&gt;Begin to &lt;span&gt;fetch&lt;/span&gt; the &lt;var title=&quot;&quot;&gt;current media
-      resource&lt;/var&gt;.&lt;/p&gt;
+      &lt;p&gt;&lt;i&gt;Search loop:&lt;/i&gt; Run these substeps atomically (so that
+      the DOM cannot change while they are running):&lt;/p&gt;
 
-      &lt;p&gt;Every 350ms (&amp;#xB1;200ms) or for every byte received,
-      whichever is &lt;em&gt;least&lt;/em&gt; frequent, &lt;span&gt;queue a task&lt;/span&gt;
-      to &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
-      title=&quot;event-progress&quot;&gt;progress&lt;/code&gt; at the element.&lt;/p&gt;
+      &lt;ol&gt;
 
-      &lt;p&gt;If at any point the user agent has received no data for more
-      than about three seconds, then &lt;span&gt;queue a task&lt;/span&gt; to
-      &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
-      title=&quot;event-stalled&quot;&gt;stalled&lt;/code&gt; at the element.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If the node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is the end
+       of the list, then jump to the step below labeled
+       &lt;i&gt;waiting&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;User agents may allow users to selectively block or slow
-      &lt;span&gt;media data&lt;/span&gt; downloads. When a &lt;span&gt;media
-      element&lt;/span&gt;'s download has been blocked altogether, the user
-      agent must act as if it was stalled (as opposed to acting as if
-      the connection was closed). The rate of the download may also be
-      throttled automatically by the user agent, e.g. to balance the
-      download with other connections sharing the same bandwidth.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If the node after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is a
+       &lt;code&gt;source&lt;/code&gt; element, let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+       be that element; otherwise, let &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+       be null.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;User agents may decide to not download more content at any
-      time, e.g. after buffering five minutes of a one hour media
-      resource, while waiting for the user to decide whether to play
-      the resource or not, or while waiting for user input in an
-      interactive resource. When a &lt;span&gt;media element&lt;/span&gt;'s
-      download has been suspended, the user agent must set the &lt;code
-      title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; to &lt;code
-      title=&quot;dom-media-NETWORK_IDLE&quot;&gt;NETWORK_IDLE&lt;/code&gt; and
-      &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt;
-      called &lt;code title=&quot;event-suspend&quot;&gt;suspend&lt;/code&gt; at the
-      element. If and when downloading of the resource resumes, the
-      user agent must set the &lt;code
-      title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; to &lt;code
-      title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/code&gt;.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Advance &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; so that the node
+       before &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt; is now the node that was
+       after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;, and the node after &lt;var
+       title=&quot;&quot;&gt;pointer&lt;/var&gt; is the node after the node that used to
+       be after &lt;var title=&quot;&quot;&gt;pointer&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;The user agent may use whatever means necessary to fetch the
-      resource (within the constraints put forward by this and other
-      specifications); for example, reconnecting to the server in the
-      face of network errors, using HTTP partial range requests, or
-      switching to a streaming protocol. The user agent must consider a
-      resource erroneous only if it has given up trying to fetch it.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; is null, restart the
+       step labelled &lt;i&gt;search loop&lt;/i&gt; from the first
+       substep.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;The &lt;span&gt;networking task source&lt;/span&gt; &lt;span
-      title=&quot;concept-task&quot;&gt;tasks&lt;/span&gt; to process the data as it is
-      being fetched must, when appropriate, include the relevant
-      substeps from the following list:&lt;/p&gt;
+      &lt;/ol&gt;
 
-      &lt;dl class=&quot;switch&quot;&gt;
+     &lt;/li&gt;
 
-       &lt;dt&gt;If the &lt;span&gt;media data&lt;/span&gt; cannot be fetched at all, due
-       to network errors, causing the user agent to give up trying to
-       fetch the resource&lt;/dt&gt;
+     &lt;li&gt;
 
-       &lt;dt&gt;If the &lt;span&gt;media data&lt;/span&gt; can be fetched but is in an
-       unsupported format, or can otherwise not be rendered at
-       all&lt;/dt&gt;
+      &lt;p&gt;If any of the following conditions are true, then jump back
+      to the step labelled &lt;i&gt;search loop&lt;/i&gt;:&lt;/p&gt;
 
-       &lt;dd&gt;
+      &lt;ul&gt;
 
-        &lt;p&gt;DNS errors, HTTP 4xx and 5xx errors (and equivalents in
-        other protocols), and other fatal network errors that occur
-        before the user agent has established whether the &lt;var
-        title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable, as well as
-        the file using an unsupported container format, or using
-        unsupported codecs for all the data, must cause the user agent
-        to execute the following steps:&lt;/p&gt;
+       &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element does not have a
+       &lt;code title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute.&lt;/li&gt;
 
-        &lt;ol&gt;
+       &lt;li&gt;&lt;span title=&quot;resolve a url&quot;&gt;Resolving&lt;/span&gt; the
+       &lt;span&gt;URL&lt;/span&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+       element's &lt;code title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute
+       relative to &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; fails.&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
-         process.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code
+       title=&quot;attr-source-type&quot;&gt;type&lt;/code&gt; attribute whose value,
+       when parsed as a MIME type (including any codecs described by
+       the &lt;code title=&quot;&quot;&gt;codec&lt;/code&gt; parameter), represents &lt;span&gt;a
+       type that the user agent knows it cannot render&lt;/span&gt;.&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;If there are more items in the &lt;var
-         title=&quot;&quot;&gt;candidates&lt;/var&gt; list, then move on to the next one,
-         jumping back to the top of the &lt;i&gt;candidate loop&lt;/i&gt;;
-         otherwise, jump to the final step in the overall algorithm
-         (the &lt;i&gt;failure step&lt;/i&gt;).&lt;/p&gt;
+       &lt;li&gt;The &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt; element has a &lt;code
+       title=&quot;attr-source-media&quot;&gt;media&lt;/code&gt; attribute whose value,
+       when processed according to the rules for &lt;a href=&quot;#mq&quot;&gt;media
+       queries&lt;/a&gt;, does not match the current environment. &lt;a
+       href=&quot;#refsMQ&quot;&gt;[MQ]&lt;/a&gt;&lt;/li&gt;
 
-        &lt;/ol&gt;
+      &lt;/ul&gt;
 
-       &lt;/dd&gt;
+     &lt;/li&gt;
 
+     &lt;li&gt;&lt;p&gt;Set the &lt;code
+     title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; to &lt;code
+     title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/code&gt; again,
+     in case it was set to &lt;code
+     title=&quot;dom-media-NETWORK_NO_SOURCE&quot;&gt;NETWORK_NO_SOURCE&lt;/code&gt;
+     above.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;dt id=&quot;getting-media-metadata&quot;&gt;Once enough of the &lt;span&gt;media
-       data&lt;/span&gt; has been fetched to determine the duration of the
-       &lt;span&gt;media resource&lt;/span&gt;, its dimensions, and other
-       metadata&lt;/dt&gt;
+     &lt;li&gt;&lt;p&gt;Run the &lt;span
+     title=&quot;concept-media-load-resource&quot;&gt;resource-load
+     algorithm&lt;/span&gt; with the &lt;span&gt;absolute URL&lt;/span&gt; that resulted
+     from &lt;span title=&quot;resolve a url&quot;&gt;resolving&lt;/span&gt; the
+     &lt;span&gt;URL&lt;/span&gt; given by the &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;
+     element's &lt;code title=&quot;attr-source-src&quot;&gt;src&lt;/code&gt; attribute
+     relative to &lt;var title=&quot;&quot;&gt;candidate&lt;/var&gt;. If that algorithm
+     returns without aborting &lt;em&gt;this&lt;/em&gt; one, then the load
+     failed.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;dd&gt;
+     &lt;li&gt;&lt;p&gt;Return to the step labeled &lt;i&gt;search loop&lt;/i&gt;.&lt;/p&gt;&lt;/li&gt;
 
-        &lt;p&gt;This indicates that the resource is usable. The user agent
-        must follow these substeps:&lt;/p&gt;
+     &lt;li&gt;&lt;p&gt;&lt;i&gt;Waiting:&lt;/i&gt; Set the &lt;code
+     title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt; attribute to a new
+     &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
+     title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to &lt;code
+     title=&quot;dom-MediaError-MEDIA_ERR_NONE_SUPPORTED&quot;&gt;MEDIA_ERR_NONE_SUPPORTED&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
 
-        &lt;ol&gt;
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;code
+     title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
+     the &lt;span
+     title=&quot;dom-media-NETWORK_NO_SOURCE&quot;&gt;NETWORK_NO_SOURCE&lt;/span&gt;
+     value&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the &lt;span&gt;current playback position&lt;/span&gt; to the
-         &lt;var&gt;earliest possible position&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a progress
+     event&lt;/span&gt; called &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the
+     &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the &lt;code
-         title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt; attribute to
-         &lt;code
-         title=&quot;dom-media-HAVE_METADATA&quot;&gt;HAVE_METADATA&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event flag&lt;/span&gt;
+     to false. This stops &lt;span title=&quot;delay the load event&quot;&gt;delaying
+     the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;For &lt;code&gt;video&lt;/code&gt; elements, set the &lt;code
-         title=&quot;dom-video-videoWidth&quot;&gt;videoWidth&lt;/code&gt; and &lt;code
-         title=&quot;dom-video-videoHeight&quot;&gt;videoHeight&lt;/code&gt;
-         attributes.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Wait until the node after &lt;var title=&quot;&quot;&gt;painter&lt;/var&gt; is a
+     node other than the end of the list. (This step might wait
+     forever.)&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;
+     &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
+     flag&lt;/span&gt; back to true. This &lt;span title=&quot;delay the load
+     event&quot;&gt;delays the load event&lt;/span&gt; again, in case it hasn't gone
+     been fired yet.&lt;/p&gt;&lt;/li&gt;
 
-          &lt;p&gt;Set the &lt;code title=&quot;dom-media-duration&quot;&gt;duration&lt;/code&gt;
-          attribute to the duration of the resource.&lt;/p&gt;
+    &lt;/ol&gt;
 
-          &lt;p class=&quot;note&quot;&gt;The user agent &lt;a
-          href=&quot;#durationChange&quot;&gt;will&lt;/a&gt; &lt;span&gt;queue a task&lt;/span&gt; to
-          &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
-          title=&quot;event-durationchange&quot;&gt;durationchange&lt;/code&gt; at the
-          element at this point.&lt;/p&gt;
+   &lt;/li&gt;
 
-         &lt;/li&gt;
+  &lt;/ol&gt;
 
-         &lt;li id=&quot;fire-loadedmetadata&quot;&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to
-         &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
-         title=&quot;event-loadedmetadata&quot;&gt;loadedmetadata&lt;/code&gt; at the
-         element.&lt;/li&gt;
+  &lt;p&gt;The &lt;dfn title=&quot;concept-media-load-resource&quot;&gt;resource-load
+  algorithm&lt;/dfn&gt; for a &lt;span&gt;media element&lt;/span&gt; and a given
+  &lt;span&gt;absolute URL&lt;/span&gt; is as follows:&lt;/p&gt;
 
-         &lt;li&gt;
+  &lt;ol&gt;
 
-          &lt;p&gt;If either the &lt;span&gt;media resource&lt;/span&gt; or the address
-          of the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; indicate a
-          particular start time, then &lt;span
-          title=&quot;dom-media-seek&quot;&gt;seek&lt;/span&gt; to that time. Ignore any
-          resulting exceptions (if the position is out of range, it is
-          effectively ignored).&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;Let the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; be the
+   resource given by the &lt;span&gt;absolute URL&lt;/span&gt; passed to this
+   algorithm. This is now the element's &lt;span&gt;media
+   resource&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-          &lt;p class=&quot;example&quot;&gt;For example, a fragment identifier could be
-          used to indicate a start position.&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;Set the &lt;code
+   title=&quot;dom-media-currentSrc&quot;&gt;currentSrc&lt;/code&gt; attribute to the
+   &lt;span&gt;absolute URL&lt;/span&gt; of the &lt;var title=&quot;&quot;&gt;current media
+   resource&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;/li&gt;
+   &lt;li&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
-         flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+    &lt;p&gt;Begin to &lt;span&gt;fetch&lt;/span&gt; the &lt;var title=&quot;&quot;&gt;current media
+    resource&lt;/var&gt;.&lt;/p&gt;
 
-        &lt;/ol&gt;
+    &lt;p&gt;Every 350ms (&amp;#xB1;200ms) or for every byte received,
+    whichever is &lt;em&gt;least&lt;/em&gt; frequent, &lt;span&gt;queue a task&lt;/span&gt;
+    to &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
+    title=&quot;event-progress&quot;&gt;progress&lt;/code&gt; at the element.&lt;/p&gt;
 
-        &lt;p class=&quot;note&quot;&gt;The user agent is &lt;em&gt;required&lt;/em&gt; to
-        determine the duration of the &lt;span&gt;media resource&lt;/span&gt; and
-        go through this step before playing.&lt;/p&gt; &lt;!-- actually defined
-        in the 'duration' section --&gt;
+    &lt;p&gt;If at any point the user agent has received no data for more
+    than about three seconds, then &lt;span&gt;queue a task&lt;/span&gt; to
+    &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
+    title=&quot;event-stalled&quot;&gt;stalled&lt;/code&gt; at the element.&lt;/p&gt;
 
-       &lt;/dd&gt;
+    &lt;p&gt;User agents may allow users to selectively block or slow
+    &lt;span&gt;media data&lt;/span&gt; downloads. When a &lt;span&gt;media
+    element&lt;/span&gt;'s download has been blocked altogether, the user
+    agent must act as if it was stalled (as opposed to acting as if
+    the connection was closed). The rate of the download may also be
+    throttled automatically by the user agent, e.g. to balance the
+    download with other connections sharing the same bandwidth.&lt;/p&gt;
 
+    &lt;p&gt;User agents may decide to not download more content at any
+    time, e.g. after buffering five minutes of a one hour media
+    resource, while waiting for the user to decide whether to play
+    the resource or not, or while waiting for user input in an
+    interactive resource. When a &lt;span&gt;media element&lt;/span&gt;'s
+    download has been suspended, the user agent must set the &lt;code
+    title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; to &lt;code
+    title=&quot;dom-media-NETWORK_IDLE&quot;&gt;NETWORK_IDLE&lt;/code&gt; and
+    &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt;
+    called &lt;code title=&quot;event-suspend&quot;&gt;suspend&lt;/code&gt; at the
+    element. If and when downloading of the resource resumes, the
+    user agent must set the &lt;code
+    title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; to &lt;code
+    title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/code&gt;.&lt;/p&gt;
 
-       &lt;dt&gt;If the connection is interrupted, causing the user agent to
-       give up trying to fetch the resource&lt;/dt&gt;
+    &lt;p&gt;The user agent may use whatever means necessary to fetch the
+    resource (within the constraints put forward by this and other
+    specifications); for example, reconnecting to the server in the
+    face of network errors, using HTTP partial range requests, or
+    switching to a streaming protocol. The user agent must consider a
+    resource erroneous only if it has given up trying to fetch it.&lt;/p&gt;
 
-       &lt;dd&gt;
+    &lt;p&gt;The &lt;span&gt;networking task source&lt;/span&gt; &lt;span
+    title=&quot;concept-task&quot;&gt;tasks&lt;/span&gt; to process the data as it is
+    being fetched must, when appropriate, include the relevant
+    substeps from the following list:&lt;/p&gt;
 
-        &lt;p&gt;Fatal network errors that occur after the user agent has
-        established whether the &lt;var title=&quot;&quot;&gt;current media
-        resource&lt;/var&gt; is usable must cause the user agent to execute
-        the following steps:&lt;/p&gt;
+    &lt;dl class=&quot;switch&quot;&gt;
 
-        &lt;ol&gt;
+     &lt;dt&gt;If the &lt;span&gt;media data&lt;/span&gt; cannot be fetched at all, due
+     to network errors, causing the user agent to give up trying to
+     fetch the resource&lt;/dt&gt;
 
-         &lt;li&gt;The user agent should cancel the fetching process.&lt;/li&gt;
+     &lt;dt&gt;If the &lt;span&gt;media data&lt;/span&gt; can be fetched but is in an
+     unsupported format, or can otherwise not be rendered at
+     all&lt;/dt&gt;
 
-         &lt;li&gt;Set the &lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt;
-         attribute to a new &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
-         title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to
-         &lt;code
-         title=&quot;dom-MediaError-MEDIA_ERR_NETWORK&quot;&gt;MEDIA_ERR_NETWORK&lt;/code&gt;.&lt;/li&gt;
+     &lt;dd&gt;
 
-         &lt;li&gt;Set the &lt;span&gt;begun flag&lt;/span&gt; to false and &lt;span&gt;queue
-         a task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt; called
-         &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the &lt;span&gt;media
-         element&lt;/span&gt;.&lt;/li&gt;
+      &lt;p&gt;DNS errors, HTTP 4xx and 5xx errors (and equivalents in
+      other protocols), and other fatal network errors that occur
+      before the user agent has established whether the &lt;var
+      title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable, as well as
+      the file using an unsupported container format, or using
+      unsupported codecs for all the data, must cause the user agent
+      to execute the following steps:&lt;/p&gt;
 
-         &lt;li&gt;Set the element's &lt;code
-         title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute
-         to the &lt;span
-         title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/span&gt; value
-         and &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
-         event&lt;/span&gt; called &lt;code
-         title=&quot;event-emptied&quot;&gt;emptied&lt;/code&gt; at the element.&lt;/li&gt;
+      &lt;ol&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
-         flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;Abort the overall &lt;code
-         title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method algorithm.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Abort this subalgorithm, returning to the &lt;span
+       title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt;.&lt;/p&gt;
 
-        &lt;/ol&gt;
+      &lt;/ol&gt;
 
-       &lt;/dd&gt;
+     &lt;/dd&gt;
 
-       &lt;dt id=&quot;fatal-decode-error&quot;&gt;If the &lt;span&gt;media data&lt;/span&gt; is
-       corrupted&lt;/dt&gt;
 
-       &lt;dd&gt;
+     &lt;dt id=&quot;getting-media-metadata&quot;&gt;Once enough of the &lt;span&gt;media
+     data&lt;/span&gt; has been fetched to determine the duration of the
+     &lt;span&gt;media resource&lt;/span&gt;, its dimensions, and other
+     metadata&lt;/dt&gt;
 
-        &lt;p&gt;Fatal errors in decoding the &lt;span&gt;media data&lt;/span&gt; that
-        occur after the user agent has established whether the &lt;var
-        title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable must cause the
-        user agent to execute the following steps:&lt;/p&gt;
+     &lt;dd&gt;
 
-        &lt;ol&gt;
+      &lt;p&gt;This indicates that the resource is usable. The user agent
+      must follow these substeps:&lt;/p&gt;
 
-         &lt;li&gt;The user agent should cancel the fetching process.&lt;/li&gt;
+      &lt;ol&gt;
 
-         &lt;li&gt;Set the &lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt;
-         attribute to a new &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
-         title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to
-         &lt;code
-         title=&quot;dom-MediaError-MEDIA_ERR_DECODE&quot;&gt;MEDIA_ERR_DECODE&lt;/code&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the &lt;span&gt;current playback position&lt;/span&gt; to the
+       &lt;var&gt;earliest possible position&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;Set the &lt;span&gt;begun flag&lt;/span&gt; to false and &lt;span&gt;queue
-         a task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt; called
-         &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the &lt;span&gt;media
-         element&lt;/span&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the &lt;code
+       title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt; attribute to
+       &lt;code
+       title=&quot;dom-media-HAVE_METADATA&quot;&gt;HAVE_METADATA&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;Set the element's &lt;code
-         title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute
-         to the &lt;span
-         title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/span&gt; value
-         and &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
-         event&lt;/span&gt; called &lt;code
-         title=&quot;event-emptied&quot;&gt;emptied&lt;/code&gt; at the element.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;For &lt;code&gt;video&lt;/code&gt; elements, set the &lt;code
+       title=&quot;dom-video-videoWidth&quot;&gt;videoWidth&lt;/code&gt; and &lt;code
+       title=&quot;dom-video-videoHeight&quot;&gt;videoHeight&lt;/code&gt;
+       attributes.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
-         flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;
 
-         &lt;li&gt;Abort the overall &lt;code
-         title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method algorithm.&lt;/li&gt;
+        &lt;p&gt;Set the &lt;code title=&quot;dom-media-duration&quot;&gt;duration&lt;/code&gt;
+        attribute to the duration of the resource.&lt;/p&gt;
 
-        &lt;/ol&gt;
+        &lt;p class=&quot;note&quot;&gt;The user agent &lt;a
+        href=&quot;#durationChange&quot;&gt;will&lt;/a&gt; &lt;span&gt;queue a task&lt;/span&gt; to
+        &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
+        title=&quot;event-durationchange&quot;&gt;durationchange&lt;/code&gt; at the
+        element at this point.&lt;/p&gt;
 
-       &lt;/dd&gt;
+       &lt;/li&gt;
 
-       &lt;dt&gt;If the &lt;span&gt;media data&lt;/span&gt; fetching process is aborted by
-       the user&lt;/dt&gt;
+       &lt;li id=&quot;fire-loadedmetadata&quot;&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to
+       &lt;span&gt;fire a simple event&lt;/span&gt; called &lt;code
+       title=&quot;event-loadedmetadata&quot;&gt;loadedmetadata&lt;/code&gt; at the
+       element.&lt;/li&gt;
 
-       &lt;dd&gt;
+       &lt;li&gt;
 
-        &lt;p&gt;The fetching process is aborted by the user, e.g. because
-        the user navigated the browsing context to another page, the
-        user agent must execute the following steps. These steps are
-        not followed if the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
-        method itself is reinvoked, as the steps above handle that
-        particular kind of abort.&lt;/p&gt;
+        &lt;p&gt;If either the &lt;span&gt;media resource&lt;/span&gt; or the address
+        of the &lt;var title=&quot;&quot;&gt;current media resource&lt;/var&gt; indicate a
+        particular start time, then &lt;span
+        title=&quot;dom-media-seek&quot;&gt;seek&lt;/span&gt; to that time. Ignore any
+        resulting exceptions (if the position is out of range, it is
+        effectively ignored).&lt;/p&gt;
 
-        &lt;ol&gt;
+        &lt;p class=&quot;example&quot;&gt;For example, a fragment identifier could be
+        used to indicate a start position.&lt;/p&gt;
 
-         &lt;li&gt;The user agent should cancel the fetching process.&lt;/li&gt;
+       &lt;/li&gt;
 
-         &lt;li&gt;Set the &lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt;
-         attribute to a new &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
-         title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to
-         &lt;code
-         title=&quot;dom-MediaError-MEDIA_ERR_ABORT&quot;&gt;MEDIA_ERR_ABORT&lt;/code&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
+       flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li&gt;Set the &lt;span&gt;begun flag&lt;/span&gt; to false and &lt;span&gt;queue
-         a task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt; called
-         &lt;code title=&quot;event-abort&quot;&gt;abort&lt;/code&gt; at the &lt;span&gt;media
-         element&lt;/span&gt;.&lt;/li&gt;
+      &lt;/ol&gt;
 
-         &lt;li&gt;If the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
-         title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt; attribute has
-         a value equal to &lt;code
-         title=&quot;dom-media-HAVE_NOTHING&quot;&gt;HAVE_NOTHING&lt;/code&gt;, set the
-         element's &lt;code
-         title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute
-         to the &lt;span
-         title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/span&gt; value
-         and &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
-         event&lt;/span&gt; called &lt;code
-         title=&quot;event-emptied&quot;&gt;emptied&lt;/code&gt; at the element. (If the
-         &lt;code title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt;
-         attribute has a value greater than &lt;code
-         title=&quot;dom-media-HAVE_NOTHING&quot;&gt;HAVE_NOTHING&lt;/code&gt;, then this
-         doesn't happen; the available data, if any, will be
-         playable.)&lt;/li&gt;
+      &lt;p class=&quot;note&quot;&gt;The user agent is &lt;em&gt;required&lt;/em&gt; to
+      determine the duration of the &lt;span&gt;media resource&lt;/span&gt; and
+      go through this step before playing.&lt;/p&gt; &lt;!-- actually defined
+      in the 'duration' section --&gt;
 
-         &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
-         flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
-         event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+     &lt;/dd&gt;
 
-         &lt;li&gt;Abort the overall &lt;code
-         title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method algorithm.&lt;/li&gt;
 
-        &lt;/ol&gt;
+     &lt;dt&gt;If the connection is interrupted, causing the user agent to
+     give up trying to fetch the resource&lt;/dt&gt;
 
-       &lt;/dd&gt;
+     &lt;dd&gt;
 
-       &lt;dt id=&quot;non-fatal-media-error&quot;&gt;If the &lt;span&gt;media data&lt;/span&gt; can
-       be fetched but has non-fatal errors or uses, in part, codecs that
-       are unsupported, preventing the user agent from rendering the
-       content completely correctly but not preventing playback
-       altogether&lt;/dt&gt;
+      &lt;p&gt;Fatal network errors that occur after the user agent has
+      established whether the &lt;var title=&quot;&quot;&gt;current media
+      resource&lt;/var&gt; is usable must cause the user agent to execute
+      the following steps:&lt;/p&gt;
 
-       &lt;dd&gt;
+      &lt;ol&gt;
 
-        &lt;p&gt;The server returning data that is partially usable but cannot
-        be optimally rendered must cause the user agent to execute the
-        following steps.&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/p&gt;&lt;/li&gt;
 
-        &lt;ol&gt;
+       &lt;li&gt;&lt;p&gt;Set the &lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt;
+       attribute to a new &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
+       title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to
+       &lt;code
+       title=&quot;dom-MediaError-MEDIA_ERR_NETWORK&quot;&gt;MEDIA_ERR_NETWORK&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
 
-         &lt;li class=&quot;XXX&quot;&gt;Should we fire a 'warning' event? Set the
-         'error' flag to 'MEDIA_ERR_SUBOPTIMAL' or something?&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a progress
+       event&lt;/span&gt; called &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at
+       the &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-        &lt;/ol&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;code
+       title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
+       the &lt;span title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/span&gt;
+       value and &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
+       event&lt;/span&gt; called &lt;code title=&quot;event-emptied&quot;&gt;emptied&lt;/code&gt;
+       at the element.&lt;/p&gt;&lt;/li&gt;
 
-       &lt;/dd&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
+       flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;/dl&gt;
+       &lt;li&gt;&lt;p&gt;Abort the overall &lt;span
+       title=&quot;concept-media-load-algorithm&quot;&gt;load
+       algorithm&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-      &lt;p&gt;When the user agent has completely fetched of the entire
-      &lt;span&gt;media resource&lt;/span&gt;, it must move on to the next
-      step. This might never happen, e.g. when streaming an infinite
-      resource such as Web radio.&lt;/p&gt;
+      &lt;/ol&gt;
 
-     &lt;/li&gt;
+     &lt;/dd&gt;
 
-     &lt;li&gt;&lt;p&gt;If the fetching process completes without errors, then set
-     the &lt;span&gt;begun flag&lt;/span&gt; to false, set the &lt;code
-     title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
-     &lt;code title=&quot;dom-media-NETWORK_LOADED&quot;&gt;NETWORK_LOADED&lt;/code&gt;, and
-     &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt;
-     called &lt;code title=&quot;event-load&quot;&gt;load&lt;/code&gt; at the
-     element.&lt;/p&gt;&lt;/li&gt;
+     &lt;dt id=&quot;fatal-decode-error&quot;&gt;If the &lt;span&gt;media data&lt;/span&gt; is
+     corrupted&lt;/dt&gt;
 
-     &lt;li&gt;Then, abort the overall &lt;code
-     title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method algorithm.&lt;/li&gt;
+     &lt;dd&gt;
 
-    &lt;/ol&gt;
+      &lt;p&gt;Fatal errors in decoding the &lt;span&gt;media data&lt;/span&gt; that
+      occur after the user agent has established whether the &lt;var
+      title=&quot;&quot;&gt;current media resource&lt;/var&gt; is usable must cause the
+      user agent to execute the following steps:&lt;/p&gt;
 
-   &lt;/li&gt;
+      &lt;ol&gt;
 
-   &lt;li&gt;
+       &lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/p&gt;&lt;/li&gt;
 
-    &lt;p&gt;&lt;i&gt;Failure step&lt;/i&gt;: No usable resource was found. Run the
-    following steps:&lt;/p&gt;
+       &lt;li&gt;&lt;p&gt;Set the &lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt;
+       attribute to a new &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
+       title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to
+       &lt;code
+       title=&quot;dom-MediaError-MEDIA_ERR_DECODE&quot;&gt;MEDIA_ERR_DECODE&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
 
-    &lt;ol&gt;
+       &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a progress
+       event&lt;/span&gt; called &lt;code title=&quot;event-error&quot;&gt;error&lt;/code&gt; at
+       the &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;Set the &lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt; attribute
-     to a new &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
-     title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to &lt;code
-     title=&quot;dom-MediaError-MEDIA_ERR_NONE_SUPPORTED&quot;&gt;MEDIA_ERR_NONE_SUPPORTED&lt;/code&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;code
+       title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
+       the &lt;span title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/span&gt;
+       value and &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
+       event&lt;/span&gt; called &lt;code title=&quot;event-emptied&quot;&gt;emptied&lt;/code&gt;
+       at the element.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;Set the &lt;span&gt;begun flag&lt;/span&gt; to false and &lt;span&gt;queue a
-     task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt; called &lt;code
-     title=&quot;event-error&quot;&gt;error&lt;/code&gt; at the &lt;span&gt;media
-     element&lt;/span&gt;.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
+       flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;Set the element's &lt;code
-     title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
-     the &lt;span title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/span&gt;
-     value and &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
-     event&lt;/span&gt; called &lt;code title=&quot;event-emptied&quot;&gt;emptied&lt;/code&gt; at
-     the element.&lt;/li&gt;
+       &lt;li&gt;&lt;p&gt;Abort the overall &lt;span
+       title=&quot;concept-media-load-algorithm&quot;&gt;load
+       algorithm&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
-     flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
-     event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+      &lt;/ol&gt;
 
-    &lt;/ol&gt;
+     &lt;/dd&gt;
 
+     &lt;dt&gt;If the &lt;span&gt;media data&lt;/span&gt; fetching process is aborted by
+     the user&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;The fetching process is aborted by the user, e.g. because the
+      user navigated the browsing context to another page, the user
+      agent must execute the following steps. These steps are not
+      followed if the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
+      method itself is invoked while these steps are running, as the
+      steps above handle that particular kind of abort.&lt;/p&gt;
+
+      &lt;ol&gt;
+
+       &lt;li&gt;&lt;p&gt;The user agent should cancel the fetching
+       process.&lt;/p&gt;&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;Set the &lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt;
+       attribute to a new &lt;code&gt;MediaError&lt;/code&gt; object whose &lt;code
+       title=&quot;dom-MediaError-code&quot;&gt;code&lt;/code&gt; attribute is set to
+       &lt;code
+       title=&quot;dom-MediaError-MEDIA_ERR_ABORT&quot;&gt;MEDIA_ERR_ABORT&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to &lt;span&gt;fire a progress
+       event&lt;/span&gt; called &lt;code title=&quot;event-abort&quot;&gt;abort&lt;/code&gt; at
+       the &lt;span&gt;media element&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
+       title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt; attribute has a
+       value equal to &lt;code
+       title=&quot;dom-media-HAVE_NOTHING&quot;&gt;HAVE_NOTHING&lt;/code&gt;, set the
+       element's &lt;code
+       title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
+       the &lt;span title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/span&gt;
+       value and &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple
+       event&lt;/span&gt; called &lt;code title=&quot;event-emptied&quot;&gt;emptied&lt;/code&gt;
+       at the element. Otherwise, set set the element's &lt;code
+       title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute to
+       the &lt;span title=&quot;dom-media-NETWORK_IDLE&quot;&gt;NETWORK_IDLE&lt;/span&gt;
+       value.&lt;/p&gt;&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;Set the element's &lt;span&gt;delaying-the-load-event
+       flag&lt;/span&gt; to false. This stops &lt;span title=&quot;delay the load
+       event&quot;&gt;delaying the load event&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+       &lt;li&gt;&lt;p&gt;Abort the overall &lt;span
+       title=&quot;concept-media-load-algorithm&quot;&gt;load
+       algorithm&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+      &lt;/ol&gt;
+
+     &lt;/dd&gt;
+
+     &lt;dt id=&quot;non-fatal-media-error&quot;&gt;If the &lt;span&gt;media data&lt;/span&gt; can
+     be fetched but has non-fatal errors or uses, in part, codecs that
+     are unsupported, preventing the user agent from rendering the
+     content completely correctly but not preventing playback
+     altogether&lt;/dt&gt;
+
+     &lt;dd&gt;
+
+      &lt;p&gt;The server returning data that is partially usable but cannot
+      be optimally rendered must cause the user agent to execute the
+      following steps.&lt;/p&gt;
+
+      &lt;ol&gt;
+
+       &lt;li class=&quot;XXX&quot;&gt;Should we fire a 'warning' event? Set the
+       'error' flag to 'MEDIA_ERR_SUBOPTIMAL' or something?&lt;/li&gt;
+
+      &lt;/ol&gt;
+
+     &lt;/dd&gt;
+
+    &lt;/dl&gt;
+
+    &lt;p&gt;When the user agent has completely fetched of the entire
+    &lt;span&gt;media resource&lt;/span&gt;, it must move on to the next
+    step. This might never happen, e.g. when streaming an infinite
+    resource such as Web radio.&lt;/p&gt;
+
    &lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;If the fetching process completes without errors, then set
+   the &lt;code title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt;
+   attribute to &lt;code
+   title=&quot;dom-media-NETWORK_LOADED&quot;&gt;NETWORK_LOADED&lt;/code&gt;, and
+   &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a progress event&lt;/span&gt;
+   called &lt;code title=&quot;event-load&quot;&gt;load&lt;/code&gt; at the
+   element.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Then, abort the overall &lt;span
+   title=&quot;concept-media-load-algorithm&quot;&gt;load
+   algorithm&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
   &lt;/ol&gt;
 
   &lt;p&gt;If a &lt;span&gt;media element&lt;/span&gt; whose &lt;code
   title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; has the value
   &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt; is &lt;span
   title=&quot;insert an element into a document&quot;&gt;inserted into a
-  document&lt;/span&gt;, the user agent must &lt;span&gt;queue a task&lt;/span&gt; that
-  implicitly invokes the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
-  method on the &lt;span&gt;media element&lt;/span&gt;, and ignores any resulting
-  exceptions. The &lt;span&gt;task source&lt;/span&gt; for this task is the
-  &lt;span&gt;media element&lt;/span&gt;'s own &lt;span&gt;media element new resource
-  task source&lt;/span&gt;.&lt;/p&gt;
+  document&lt;/span&gt;, the user agent must asynchronously invoke the
+  &lt;span&gt;media element&lt;/span&gt;'s &lt;span
+  title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;The &lt;dfn
   title=&quot;dom-media-bufferingRate&quot;&gt;&lt;code&gt;bufferingRate&lt;/code&gt;&lt;/dfn&gt;
@@ -20983,10 +21049,9 @@
    title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute has
    the value &lt;code
    title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt;, then the user
-   agent must invoke the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
-   method and wait for it to return. If that raises an exception, that
-   exception must be reraised by the &lt;code
-   title=&quot;dom-media-play&quot;&gt;play()&lt;/code&gt; method.&lt;/p&gt;&lt;/li&gt;
+   agent must invoke the &lt;span&gt;media element&lt;/span&gt;'s &lt;span
+   title=&quot;concept-media-load-algorithm&quot;&gt;load
+   algorithm&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;
 
@@ -21011,7 +21076,8 @@
     be set to false.&lt;/p&gt;
 
     &lt;p&gt;If this changed the value of &lt;code
-    title=&quot;dom-media-paused&quot;&gt;paused&lt;/code&gt;, the user agent must run the following substeps:&lt;/p&gt;
+    title=&quot;dom-media-paused&quot;&gt;paused&lt;/code&gt;, the user agent must run
+    the following substeps:&lt;/p&gt;
 
     &lt;ol&gt;
 
@@ -21020,18 +21086,19 @@
 
      &lt;li&gt;&lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
      title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt; attribute has the
-     value &lt;code title=&quot;dom-media-HAVE_METADATA&quot;&gt;HAVE_METADATA&lt;/code&gt;
-     or &lt;code
+     value &lt;code title=&quot;dom-media-HAVE_NOTHING&quot;&gt;HAVE_NOTHING&lt;/code&gt;,
+     &lt;code title=&quot;dom-media-HAVE_METADATA&quot;&gt;HAVE_METADATA&lt;/code&gt;, or
+     &lt;code
      title=&quot;dom-media-HAVE_CURRENT_DATA&quot;&gt;HAVE_CURRENT_DATA&lt;/code&gt;,
      &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt;
      called &lt;code title=&quot;event-waiting&quot;&gt;waiting&lt;/code&gt; at the
      element.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Otherwise, the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
-     title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt; attribute has the value
-     &lt;code title=&quot;dom-media-HAVE_FUTURE_DATA&quot;&gt;HAVE_FUTURE_DATA&lt;/code&gt;
-     or &lt;code
-     title=&quot;dom-media-HAVE_ENOUGH_DATA&quot;&gt;HAVE_ENOUGH_DATA&lt;/code&gt;;
+     title=&quot;dom-media-readyState&quot;&gt;readyState&lt;/code&gt; attribute has the
+     value &lt;code
+     title=&quot;dom-media-HAVE_FUTURE_DATA&quot;&gt;HAVE_FUTURE_DATA&lt;/code&gt; or
+     &lt;code title=&quot;dom-media-HAVE_ENOUGH_DATA&quot;&gt;HAVE_ENOUGH_DATA&lt;/code&gt;;
      &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt;
      called &lt;code title=&quot;event-playing&quot;&gt;playing&lt;/code&gt; at the
      element.&lt;/p&gt;&lt;/li&gt;
@@ -21058,10 +21125,9 @@
    title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; attribute has
    the value &lt;code
    title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt;, then the user
-   agent must invoke the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt;
-   method and wait for it to return. If that raises an exception, that
-   exception must be reraised by the &lt;code
-   title=&quot;dom-media-play&quot;&gt;pause()&lt;/code&gt; method.&lt;/p&gt;&lt;/li&gt;
+   agent must invoke the &lt;span&gt;media element&lt;/span&gt;'s &lt;span
+   title=&quot;concept-media-load-algorithm&quot;&gt;load
+   algorithm&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the &lt;span&gt;media element&lt;/span&gt;'s &lt;code
    title=&quot;dom-media-paused&quot;&gt;paused&lt;/code&gt; attribute is false, it must
@@ -21070,8 +21136,6 @@
    &lt;li&gt;&lt;p&gt;The &lt;span&gt;media element&lt;/span&gt;'s &lt;span&gt;autoplaying
    flag&lt;/span&gt; must be set to false.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;The method must then return.&lt;/p&gt;&lt;/li&gt;
-
    &lt;li&gt;&lt;p&gt;If the second step above changed the value of &lt;code
    title=&quot;dom-media-paused&quot;&gt;paused&lt;/code&gt;, then the user agent must
    &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt;
@@ -21488,7 +21552,7 @@
     &lt;tr&gt;
      &lt;td&gt;&lt;dfn title=&quot;event-loadstart&quot;&gt;&lt;code&gt;loadstart&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;ProgressEvent&lt;/code&gt; &lt;a href=&quot;#refsPROGRESS&quot;&gt;[PROGRESS]&lt;/a&gt;
-     &lt;td&gt;The user agent begins fetching the &lt;span&gt;media data&lt;/span&gt;, synchronously during the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method call.
+     &lt;td&gt;The user agent begins looking for &lt;span&gt;media data&lt;/span&gt;, as part of the &lt;span title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt;.
      &lt;td&gt;&lt;code title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; equals &lt;code title=&quot;dom-media-NETWORK_LOADING&quot;&gt;NETWORK_LOADING&lt;/code&gt;
     &lt;tr&gt;
      &lt;td&gt;&lt;dfn title=&quot;event-progress&quot;&gt;&lt;code&gt;progress&lt;/code&gt;&lt;/dfn&gt;
@@ -21508,7 +21572,7 @@
     &lt;tr&gt;
      &lt;td&gt;&lt;dfn title=&quot;event-abort&quot;&gt;&lt;code&gt;abort&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;ProgressEvent&lt;/code&gt; &lt;a href=&quot;#refsPROGRESS&quot;&gt;[PROGRESS]&lt;/a&gt;
-     &lt;td&gt;The user agent stops fetching the &lt;span&gt;media data&lt;/span&gt; before it is completely downloaded. This can be fired synchronously during the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method call.
+     &lt;td&gt;The user agent stops fetching the &lt;span&gt;media data&lt;/span&gt; before it is completely downloaded.
      &lt;td&gt;&lt;code title=&quot;dom-media-error&quot;&gt;error&lt;/code&gt; is an object with the code &lt;code title=&quot;dom-MediaError-MEDIA_ERR_ABORTED&quot;&gt;MEDIA_ERR_ABORTED&lt;/code&gt;.
          &lt;code title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; equals either &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt; or &lt;code title=&quot;dom-media-NETWORK_LOADED&quot;&gt;NETWORK_LOADED&lt;/code&gt;, depending on when the download was aborted.
     &lt;tr&gt;
@@ -21520,7 +21584,7 @@
     &lt;tr&gt;
      &lt;td&gt;&lt;dfn title=&quot;event-emptied&quot;&gt;&lt;code&gt;emptied&lt;/code&gt;&lt;/dfn&gt;
      &lt;td&gt;&lt;code&gt;Event&lt;/code&gt;
-     &lt;td&gt;A &lt;span&gt;media element&lt;/span&gt; whose &lt;code title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; was previously not in the &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt; state has just switched to that state (either because of a fatal error during load that's about to be reported, or because the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method was reinvoked, in which case it is fired synchronously during the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method call).
+     &lt;td&gt;A &lt;span&gt;media element&lt;/span&gt; whose &lt;code title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; was previously not in the &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt; state has just switched to that state (either because of a fatal error during load that's about to be reported, or because the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method was invoked while the &lt;span title=&quot;concept-media-load-algorithm&quot;&gt;load algorithm&lt;/span&gt; was already running, in which case it is fired synchronously during the &lt;code title=&quot;dom-media-load&quot;&gt;load()&lt;/code&gt; method call).
      &lt;td&gt;&lt;code title=&quot;dom-media-networkState&quot;&gt;networkState&lt;/code&gt; is &lt;code title=&quot;dom-media-NETWORK_EMPTY&quot;&gt;NETWORK_EMPTY&lt;/code&gt;; all the DOM attributes are in their initial states.
     &lt;tr&gt;
      &lt;td&gt;&lt;dfn title=&quot;event-stalled&quot;&gt;&lt;code&gt;stalled&lt;/code&gt;&lt;/dfn&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009732.html">[html5] r2848 - [gw] (2) Avoid firing 'canplay' twice if media	buffers slowly. Also, what's this [...]
</A></li>
	<LI>Next message: <A HREF="009734.html">[html5] r2850 - [] (0) Tweak document.domain to handle IPv6	addresses.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9733">[ date ]</a>
              <a href="thread.html#9733">[ thread ]</a>
              <a href="subject.html#9733">[ subject ]</a>
              <a href="author.html#9733">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
