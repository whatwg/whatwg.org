<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r4177 - [ct] (0) Remove the 'content model flag' and expand	it into separate states inst [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r4177%20-%20%5Bct%5D%20%280%29%20Remove%20the%20%27content%20model%20flag%27%20and%20expand%0A%09it%20into%20separate%20states%20inst%20%5B...%5D&In-Reply-To=%3C20091019110034.62AFD38E050%40hixie.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011048.html">
   <LINK REL="Next"  HREF="011050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r4177 - [ct] (0) Remove the 'content model flag' and expand	it into separate states inst [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r4177%20-%20%5Bct%5D%20%280%29%20Remove%20the%20%27content%20model%20flag%27%20and%20expand%0A%09it%20into%20separate%20states%20inst%20%5B...%5D&In-Reply-To=%3C20091019110034.62AFD38E050%40hixie.dreamhostps.com%3E"
       TITLE="[html5] r4177 - [ct] (0) Remove the 'content model flag' and expand	it into separate states inst [...]">whatwg at whatwg.org
       </A><BR>
    <I>Mon Oct 19 04:00:34 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="011048.html">[html5] r4176 - [e] (0) Rename an insertion mode to prepare for	more tokenizer modes.
</A></li>
        <LI>Next message: <A HREF="011050.html">[html5] r4178 - [acgiow] (2) Redefine how to parse RCDATA and	RAWTEXT elements, and introduce a  [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11049">[ date ]</a>
              <a href="thread.html#11049">[ thread ]</a>
              <a href="subject.html#11049">[ subject ]</a>
              <a href="author.html#11049">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2009-10-19 04:00:31 -0700 (Mon, 19 Oct 2009)
New Revision: 4177

Modified:
   complete.html
   index
   source
Log:
[ct] (0) Remove the 'content model flag' and expand it into separate states instead. This edit *should* have no effect on black-box conformance requirements. Please report any changes you find.

Modified: complete.html
===================================================================
--- complete.html	2009-10-19 05:52:18 UTC (rev 4176)
+++ complete.html	2009-10-19 11:00:31 UTC (rev 4177)
@@ -1052,47 +1052,65 @@
      &lt;li&gt;&lt;a href=#tokenization&gt;&lt;span class=secno&gt;11.2.4 &lt;/span&gt;Tokenization&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#data-state&gt;&lt;span class=secno&gt;11.2.4.1 &lt;/span&gt;Data state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#character-reference-in-data-state&gt;&lt;span class=secno&gt;11.2.4.2 &lt;/span&gt;Character reference in data state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#tag-open-state&gt;&lt;span class=secno&gt;11.2.4.3 &lt;/span&gt;Tag open state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#close-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.4 &lt;/span&gt;Close tag open state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#tag-name-state&gt;&lt;span class=secno&gt;11.2.4.5 &lt;/span&gt;Tag name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.6 &lt;/span&gt;Before attribute name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.7 &lt;/span&gt;Attribute name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.8 &lt;/span&gt;After attribute name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.9 &lt;/span&gt;Before attribute value state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.10 &lt;/span&gt;Attribute value (double-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.11 &lt;/span&gt;Attribute value (single-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;11.2.4.12 &lt;/span&gt;Attribute value (unquoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.13 &lt;/span&gt;Character reference in attribute value state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;11.2.4.14 &lt;/span&gt;After attribute value (quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#self-closing-start-tag-state&gt;&lt;span class=secno&gt;11.2.4.15 &lt;/span&gt;Self-closing start tag state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#bogus-comment-state&gt;&lt;span class=secno&gt;11.2.4.16 &lt;/span&gt;Bogus comment state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#markup-declaration-open-state&gt;&lt;span class=secno&gt;11.2.4.17 &lt;/span&gt;Markup declaration open state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-start-state&gt;&lt;span class=secno&gt;11.2.4.18 &lt;/span&gt;Comment start state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-start-dash-state&gt;&lt;span class=secno&gt;11.2.4.19 &lt;/span&gt;Comment start dash state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-state&gt;&lt;span class=secno&gt;11.2.4.20 &lt;/span&gt;Comment state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-dash-state&gt;&lt;span class=secno&gt;11.2.4.21 &lt;/span&gt;Comment end dash state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-state&gt;&lt;span class=secno&gt;11.2.4.22 &lt;/span&gt;Comment end state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-bang-state&gt;&lt;span class=secno&gt;11.2.4.23 &lt;/span&gt;Comment end bang state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-space-state&gt;&lt;span class=secno&gt;11.2.4.24 &lt;/span&gt;Comment end space state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-state&gt;&lt;span class=secno&gt;11.2.4.25 &lt;/span&gt;DOCTYPE state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.26 &lt;/span&gt;Before DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.27 &lt;/span&gt;DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.28 &lt;/span&gt;After DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;11.2.4.29 &lt;/span&gt;After DOCTYPE public keyword state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.30 &lt;/span&gt;Before DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.31 &lt;/span&gt;DOCTYPE public identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.32 &lt;/span&gt;DOCTYPE public identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.33 &lt;/span&gt;After DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;11.2.4.34 &lt;/span&gt;Between DOCTYPE public and system identifiers state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;11.2.4.35 &lt;/span&gt;After DOCTYPE system keyword state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.36 &lt;/span&gt;Before DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.37 &lt;/span&gt;DOCTYPE system identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.38 &lt;/span&gt;DOCTYPE system identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.39 &lt;/span&gt;After DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#bogus-doctype-state&gt;&lt;span class=secno&gt;11.2.4.40 &lt;/span&gt;Bogus DOCTYPE state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#cdata-section-state&gt;&lt;span class=secno&gt;11.2.4.41 &lt;/span&gt;CDATA section state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#tokenizing-character-references&gt;&lt;span class=secno&gt;11.2.4.42 &lt;/span&gt;Tokenizing character references&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-state&gt;&lt;span class=secno&gt;11.2.4.2 &lt;/span&gt;RCDATA state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-state&gt;&lt;span class=secno&gt;11.2.4.3 &lt;/span&gt;RAWTEXT state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-state&gt;&lt;span class=secno&gt;11.2.4.4 &lt;/span&gt;Script data state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#plaintext-state&gt;&lt;span class=secno&gt;11.2.4.5 &lt;/span&gt;PLAINTEXT state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#character-reference-in-data-state&gt;&lt;span class=secno&gt;11.2.4.6 &lt;/span&gt;Character reference in data state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#tag-open-state&gt;&lt;span class=secno&gt;11.2.4.7 &lt;/span&gt;Tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#close-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.8 &lt;/span&gt;Close tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#tag-name-state&gt;&lt;span class=secno&gt;11.2.4.9 &lt;/span&gt;Tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-less-than-sign-state&gt;&lt;span class=secno&gt;11.2.4.10 &lt;/span&gt;RCDATA less-than sign state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-end-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.11 &lt;/span&gt;RCDATA end tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-end-tag-name-state&gt;&lt;span class=secno&gt;11.2.4.12 &lt;/span&gt;RCDATA end tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-less-than-sign-state&gt;&lt;span class=secno&gt;11.2.4.13 &lt;/span&gt;RAWTEXT less-than sign state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-end-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.14 &lt;/span&gt;RAWTEXT end tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-end-tag-name-state&gt;&lt;span class=secno&gt;11.2.4.15 &lt;/span&gt;RAWTEXT end tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-less-than-sign-state&gt;&lt;span class=secno&gt;11.2.4.16 &lt;/span&gt;Script data less-than sign state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-end-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.17 &lt;/span&gt;Script data end tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-end-tag-name-state&gt;&lt;span class=secno&gt;11.2.4.18 &lt;/span&gt;Script data end tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escape-start-state&gt;&lt;span class=secno&gt;11.2.4.19 &lt;/span&gt;Script data escape start state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escape-start-dash-state&gt;&lt;span class=secno&gt;11.2.4.20 &lt;/span&gt;Script data escape start dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escaped-state&gt;&lt;span class=secno&gt;11.2.4.21 &lt;/span&gt;Script data escaped state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escaped-dash-state&gt;&lt;span class=secno&gt;11.2.4.22 &lt;/span&gt;Script data escaped dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escaped-dash-dash-state&gt;&lt;span class=secno&gt;11.2.4.23 &lt;/span&gt;Script data escaped dash dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.24 &lt;/span&gt;Before attribute name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.25 &lt;/span&gt;Attribute name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.26 &lt;/span&gt;After attribute name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.27 &lt;/span&gt;Before attribute value state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.28 &lt;/span&gt;Attribute value (double-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.29 &lt;/span&gt;Attribute value (single-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;11.2.4.30 &lt;/span&gt;Attribute value (unquoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.31 &lt;/span&gt;Character reference in attribute value state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;11.2.4.32 &lt;/span&gt;After attribute value (quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#self-closing-start-tag-state&gt;&lt;span class=secno&gt;11.2.4.33 &lt;/span&gt;Self-closing start tag state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#bogus-comment-state&gt;&lt;span class=secno&gt;11.2.4.34 &lt;/span&gt;Bogus comment state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#markup-declaration-open-state&gt;&lt;span class=secno&gt;11.2.4.35 &lt;/span&gt;Markup declaration open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-start-state&gt;&lt;span class=secno&gt;11.2.4.36 &lt;/span&gt;Comment start state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-start-dash-state&gt;&lt;span class=secno&gt;11.2.4.37 &lt;/span&gt;Comment start dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-state&gt;&lt;span class=secno&gt;11.2.4.38 &lt;/span&gt;Comment state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-dash-state&gt;&lt;span class=secno&gt;11.2.4.39 &lt;/span&gt;Comment end dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-state&gt;&lt;span class=secno&gt;11.2.4.40 &lt;/span&gt;Comment end state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-bang-state&gt;&lt;span class=secno&gt;11.2.4.41 &lt;/span&gt;Comment end bang state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-space-state&gt;&lt;span class=secno&gt;11.2.4.42 &lt;/span&gt;Comment end space state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-state&gt;&lt;span class=secno&gt;11.2.4.43 &lt;/span&gt;DOCTYPE state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.44 &lt;/span&gt;Before DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.45 &lt;/span&gt;DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.46 &lt;/span&gt;After DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;11.2.4.47 &lt;/span&gt;After DOCTYPE public keyword state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.48 &lt;/span&gt;Before DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.49 &lt;/span&gt;DOCTYPE public identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.50 &lt;/span&gt;DOCTYPE public identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.51 &lt;/span&gt;After DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;11.2.4.52 &lt;/span&gt;Between DOCTYPE public and system identifiers state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;11.2.4.53 &lt;/span&gt;After DOCTYPE system keyword state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.54 &lt;/span&gt;Before DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.55 &lt;/span&gt;DOCTYPE system identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.56 &lt;/span&gt;DOCTYPE system identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.57 &lt;/span&gt;After DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#bogus-doctype-state&gt;&lt;span class=secno&gt;11.2.4.58 &lt;/span&gt;Bogus DOCTYPE state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#cdata-section-state&gt;&lt;span class=secno&gt;11.2.4.59 &lt;/span&gt;CDATA section state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#tokenizing-character-references&gt;&lt;span class=secno&gt;11.2.4.60 &lt;/span&gt;Tokenizing character references&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#tree-construction&gt;&lt;span class=secno&gt;11.2.5 &lt;/span&gt;Tree construction&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#creating-and-inserting-elements&gt;&lt;span class=secno&gt;11.2.5.1 &lt;/span&gt;Creating and inserting elements&lt;/a&gt;&lt;/li&gt;
@@ -9785,9 +9803,9 @@
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; is &lt;em&gt;not&lt;/em&gt; now an &lt;a href=#ascii-case-insensitive&gt;ASCII
     case-insensitive&lt;/a&gt; match for the string
     &quot;&lt;code&gt;&lt;a href=#text/html&gt;text/html&lt;/a&gt;&lt;/code&gt;&quot;, then act as if the tokenizer had emitted
-    a start tag token with the tag name &quot;pre&quot;, then set the &lt;a href=#html-parser&gt;HTML
-    parser&lt;/a&gt;'s &lt;a href=#tokenization&gt;tokenization&lt;/a&gt; stage's &lt;a href=#content-model-flag&gt;content
-    model flag&lt;/a&gt; to &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;.&lt;/p&gt;
+    a start tag token with the tag name &quot;pre&quot;, then switch the
+    &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT
+    state&lt;/a&gt;.&lt;/p&gt;
 
     &lt;!--
  <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%3E%3C%2Fiframe%3E%3Cscript%3Eonload%20%3D%20function%20(">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%3E%3C%2Fiframe%3E%3Cscript%3Eonload%20%3D%20function%20(</A>)%20%7B%20%0D%0A%20%20var%20d%20%3D%20document.getElementsByTagName('iframe')%5B0%5D.contentDocument%3B%0D%0A%20%20d.open('image%2Fsvg%2Bxml')%3B%0D%0A%20%20d.write(%22%3Cinput%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml'%20value%3D'(x)html'%2F%3E%22)%3B%0D%0A%20%20d.close()%3B%0D%0A%7D%3B%3C%2Fscript%3E
@@ -55758,9 +55776,9 @@
   context&lt;/a&gt;, the user agent should &lt;a href=#create-a-document-object&gt;create a
   &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, create an &lt;a href=#html-parser&gt;HTML
   parser&lt;/a&gt;, associate it with the document, act as if the
-  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;, set
-  the &lt;a href=#tokenization&gt;tokenization&lt;/a&gt; stage's &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; to &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;, and begin to pass the stream of
+  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;,
+  switch the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s tokenizer to the
+  &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;, and begin to pass the stream of
   characters in the plain text document to that tokenizer.&lt;/p&gt;
 
   &lt;p&gt;The rules for how to convert the bytes of the plain text document
@@ -70362,16 +70380,13 @@
   switches it to a new state (to consume the next character), or
   repeats the same state (to consume the next character). Some states
   have more complicated behavior and can consume several characters
-  before switching to another state.&lt;/p&gt;
+  before switching to another state. In some cases, the tokenizer
+  state is also changed by the tree construction stage.&lt;/p&gt;
 
-  &lt;p&gt;The exact behavior of certain states depends on a &lt;dfn id=content-model-flag&gt;content
-  model flag&lt;/dfn&gt; that is set after certain tokens are emitted. The
-  flag has several states: &lt;i title=&quot;&quot;&gt;PCDATA&lt;/i&gt;, &lt;i title=&quot;&quot;&gt;RCDATA&lt;/i&gt;, &lt;i title=&quot;&quot;&gt;RAWTEXT&lt;/i&gt;, and &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;. Initially, it must be in the PCDATA
-  state. In the RCDATA and RAWTEXT states, a further &lt;dfn id=escape-flag&gt;escape
-  flag&lt;/dfn&gt; is used to control the behavior of the tokenizer. It is
-  either true or false, and initially must be set to the false
-  state. The &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt; and the &lt;a href=#stack-of-open-elements&gt;stack of open
-  elements&lt;/a&gt; also affects tokenization.&lt;/p&gt;
+  &lt;p&gt;The exact behavior of certain states depends on the
+  &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt; and the &lt;a href=#stack-of-open-elements&gt;stack of open
+  elements&lt;/a&gt;. Certain states also use a &lt;dfn id=temporary-buffer&gt;&lt;var&gt;temporary
+  buffer&lt;/var&gt;&lt;/dfn&gt; to track progress.&lt;/p&gt;
 
   &lt;p&gt;The output of the tokenization step is a series of zero or more
   of the following tokens: DOCTYPE, start tag, end tag, comment,
@@ -70390,8 +70405,8 @@
 
   &lt;p&gt;When a token is emitted, it must immediately be handled by the
   &lt;a href=#tree-construction&gt;tree construction&lt;/a&gt; stage. The tree construction stage
-  can affect the state of the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt;, and can
-  insert additional characters into the stream. (For example, the
+  can affect the state of the tokenization stage, and can insert
+  additional characters into the stream. (For example, the
   &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element can result in scripts executing and
   using the &lt;a href=#dynamic-markup-insertion&gt;dynamic markup insertion&lt;/a&gt; APIs to insert
   characters into the stream being tokenized.)&lt;/p&gt;
@@ -70401,15 +70416,18 @@
   self-closing flag&quot;&gt;acknowledged&lt;/dfn&gt; when it is processed by the
   tree construction stage, that is a &lt;a href=#parse-error&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;When an end tag token is emitted, the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; must be switched to the PCDATA state.&lt;/p&gt;
-
   &lt;p&gt;When an end tag token is emitted with attributes, that is a
   &lt;a href=#parse-error&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;When an end tag token is emitted with its &lt;i&gt;self-closing
   flag&lt;/i&gt; set, that is a &lt;a href=#parse-error&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
+  &lt;p&gt;An &lt;dfn id=appropriate-end-tag-token&gt;appropriate end tag token&lt;/dfn&gt; is an end tag token whose
+  tag name matches the tag name of the last start tag to have been
+  emitted from this tokenizer, if any. If no start tag has been
+  emitted from this tokenizer, then no end tag token is
+  appropriate.&lt;/p&gt;
+
   &lt;p&gt;Before each step of the tokenizer, the user agent must first
   check the &lt;a href=#parser-pause-flag&gt;parser pause flag&lt;/a&gt;. If it is true, then the
   tokenizer must abort the processing of any nested invocations of the
@@ -70418,187 +70436,152 @@
   &lt;p&gt;The tokenizer state machine consists of the states defined in the
   following subsections.&lt;/p&gt;
 
+
   &lt;!-- Order of the lists below is supposed to be non-error then
   error, by unicode, then EOF, ending with &quot;anything else&quot; --&gt;
 
+
   &lt;h5 id=data-state&gt;&lt;span class=secno&gt;11.2.4.1 &lt;/span&gt;&lt;dfn&gt;Data state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
-   &lt;dd&gt;When the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to one of the
-   PCDATA or RCDATA states and the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt; is
-   false: switch to the &lt;a href=#character-reference-in-data-state&gt;character reference in data
+   &lt;dd&gt;Switch to the &lt;a href=#character-reference-in-data-state&gt;character reference in data
    state&lt;/a&gt;.&lt;/dd&gt;
-   &lt;dd&gt;Otherwise: treat it as per the &quot;anything else&quot; entry
-   below.&lt;/dd&gt;
 
-   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
-   &lt;dd&gt;
+   &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#tag-open-state&gt;tag open state&lt;/a&gt;.&lt;/dd&gt;
 
-    &lt;p&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to either the
-    RCDATA state or the RAWTEXT state, and the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt;
-    is false, and there are at least three characters before this
-    one in the input stream, and the last four characters in the
-    input stream, including this one, are U+003C LESS-THAN SIGN,
-    U+0021 EXCLAMATION MARK, U+002D HYPHEN-MINUS, and U+002D
-    HYPHEN-MINUS (&quot;&lt;!--&quot;), then set the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt;
-    to true.&lt;/p&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-    &lt;p&gt;In any case, emit the input character as a character
-    token. Stay in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
-   &lt;/dd&gt;
+  &lt;/dl&gt;&lt;h5 id=rcdata-state&gt;&lt;span class=secno&gt;11.2.4.2 &lt;/span&gt;&lt;dfn&gt;RCDATA state&lt;/dfn&gt;&lt;/h5&gt;
 
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#character-reference-in-data-state&gt;character reference in data
+   state&lt;/a&gt;.&lt;/dd&gt;
+
    &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
-   &lt;dd&gt;When the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the PCDATA
-   state: switch to the &lt;a href=#tag-open-state&gt;tag open state&lt;/a&gt;.&lt;/dd&gt;
-   &lt;dd&gt;When the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to either the
-   RCDATA state or the RAWTEXT state, and the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt;
-   is false: switch to the &lt;a href=#tag-open-state&gt;tag open state&lt;/a&gt;.&lt;/dd&gt;
-   &lt;dd&gt;Otherwise: treat it as per the &quot;anything else&quot; entry
-   below.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#rcdata-less-than-sign-state&gt;RCDATA less-than sign state&lt;/a&gt;.&lt;/dd&gt;
 
-   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
-   &lt;dd&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-    &lt;p&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to either the
-    RCDATA state or the RAWTEXT state, and the &lt;a href=#escape-flag&gt;escape
-    flag&lt;/a&gt; is true, and the last three characters in the input
-    stream including this one are U+002D HYPHEN-MINUS, U+002D
-    HYPHEN-MINUS, U+003E GREATER-THAN SIGN (&quot;--&gt;&quot;), set the
-    &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt; to false.&lt;/p&gt; &lt;!-- no need to check
-    that there are enough characters, since you can only run into
-    this if the flag is true in the first place, which requires four
-    characters. --&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
 
-    &lt;p&gt;In any case, emit the input character as a character
-    token. Stay in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+  &lt;/dl&gt;&lt;h5 id=rawtext-state&gt;&lt;span class=secno&gt;11.2.4.3 &lt;/span&gt;&lt;dfn&gt;RAWTEXT state&lt;/dfn&gt;&lt;/h5&gt;
 
-   &lt;/dd&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
+  &lt;dl class=switch&gt;&lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#rawtext-less-than-sign-state&gt;RAWTEXT less-than sign state&lt;/a&gt;.&lt;/dd&gt;
+
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Emit the input character as a character token. Stay in the
-   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=character-reference-in-data-state&gt;&lt;span class=secno&gt;11.2.4.2 &lt;/span&gt;&lt;dfn&gt;Character reference in data state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=script-data-state&gt;&lt;span class=secno&gt;11.2.4.4 &lt;/span&gt;&lt;dfn&gt;Script data state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This cannot happen if the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt;
-  is set to the RAWTEXT state.)&lt;/i&gt;&lt;/p&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-  &lt;p&gt;Attempt to &lt;a href=#consume-a-character-reference&gt;consume a character reference&lt;/a&gt;, with no
-  &lt;a href=#additional-allowed-character&gt;additional allowed character&lt;/a&gt;.&lt;/p&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#script-data-less-than-sign-state&gt;script data less-than sign state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;p&gt;If nothing is returned, emit a U+0026 AMPERSAND character
-  token.&lt;/p&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-  &lt;p&gt;Otherwise, emit the character token that was returned.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;p&gt;Finally, switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+  &lt;/dl&gt;&lt;h5 id=plaintext-state&gt;&lt;span class=secno&gt;11.2.4.5 &lt;/span&gt;&lt;dfn&gt;PLAINTEXT state&lt;/dfn&gt;&lt;/h5&gt;
 
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-  &lt;h5 id=tag-open-state&gt;&lt;span class=secno&gt;11.2.4.3 &lt;/span&gt;&lt;dfn&gt;Tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-  &lt;p&gt;The behavior of this state depends on the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt;.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;dl&gt;&lt;dt&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the RCDATA
-   or RAWTEXT states&lt;/dt&gt;
+  &lt;/dl&gt;&lt;h5 id=character-reference-in-data-state&gt;&lt;span class=secno&gt;11.2.4.6 &lt;/span&gt;&lt;dfn&gt;Character reference in data state&lt;/dfn&gt;&lt;/h5&gt;
 
-   &lt;dd&gt;
+  &lt;p&gt;Attempt to &lt;a href=#consume-a-character-reference&gt;consume a character reference&lt;/a&gt;, with no
+  &lt;a href=#additional-allowed-character&gt;additional allowed character&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;. If it is a
-    U+002F SOLIDUS character (/), switch to the &lt;a href=#close-tag-open-state&gt;close tag open
-    state&lt;/a&gt;. Otherwise, emit a U+003C LESS-THAN SIGN character
-    token and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
-    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+  &lt;p&gt;If nothing is returned, emit a U+0026 AMPERSAND character
+  token.&lt;/p&gt;
 
-   &lt;/dd&gt;
+  &lt;p&gt;Otherwise, emit the character token that was returned.&lt;/p&gt;
 
-   &lt;dt&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the PCDATA
-   state&lt;/dt&gt;
+  &lt;p&gt;Finally, switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
 
-   &lt;dd&gt;
 
-    &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+  &lt;h5 id=tag-open-state&gt;&lt;span class=secno&gt;11.2.4.7 &lt;/span&gt;&lt;dfn&gt;Tag open state&lt;/dfn&gt;&lt;/h5&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
-     &lt;dd&gt;Switch to the &lt;a href=#markup-declaration-open-state&gt;markup declaration open state&lt;/a&gt;.&lt;/dd&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-     &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
-     &lt;dd&gt;Switch to the &lt;a href=#close-tag-open-state&gt;close tag open state&lt;/a&gt;.&lt;/dd&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#markup-declaration-open-state&gt;markup declaration open state&lt;/a&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-     &lt;dd&gt;Create a new start tag token, set its tag name to the
-     lowercase version of the input character (add 0x0020 to the
-     character's code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
-     state&lt;/a&gt;. (Don't emit the token yet; further details will
-     be filled in before it is emitted.)&lt;/dd&gt;
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#close-tag-open-state&gt;close tag open state&lt;/a&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
-     &lt;dd&gt;Create a new start tag token, set its tag name to the input
-     character, then switch to the &lt;a href=#tag-name-state&gt;tag name
-     state&lt;/a&gt;. (Don't emit the token yet; further details will
-     be filled in before it is emitted.)&lt;/dd&gt;
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new start tag token, set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add 0x0020 to the
+   character's code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
+   state&lt;/a&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
-     &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
-     &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
-     character token and a U+003E GREATER-THAN SIGN character
-     token. Switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new start tag token, set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, then switch to the &lt;a href=#tag-name-state&gt;tag
+   name state&lt;/a&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
-     &lt;dt&gt;U+003F QUESTION MARK (?)&lt;/dt&gt;
-     &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#bogus-comment-state&gt;bogus
-     comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
+   character token and a U+003E GREATER-THAN SIGN character
+   token. Switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;Anything else&lt;/dt&gt;
-     &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
-     character token and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
-     &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dt&gt;U+003F QUESTION MARK (?)&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#bogus-comment-state&gt;bogus
+   comment state&lt;/a&gt;.&lt;/dd&gt;
 
-    &lt;/dl&gt;&lt;/dd&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
+   character token and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=close-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.4 &lt;/span&gt;&lt;dfn&gt;Close tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=close-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.8 &lt;/span&gt;&lt;dfn&gt;Close tag open state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the RCDATA or
-  RAWTEXT states but no start tag token has ever been emitted by this
-  instance of the tokenizer (&lt;a href=#fragment-case&gt;fragment case&lt;/a&gt;), or, if the
-  &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the RCDATA or RAWTEXT states
-  and the next few characters do not match the tag name of the last
-  start tag token emitted (compared in an &lt;a href=#ascii-case-insensitive&gt;ASCII
-  case-insensitive&lt;/a&gt; manner), or if they do but they are not
-  immediately followed by one of the following characters:&lt;/p&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-  &lt;ul class=brief&gt;&lt;li&gt;U+0009 CHARACTER TABULATION&lt;/li&gt;
-   &lt;li&gt;U+000A LINE FEED (LF)&lt;/li&gt;
-   &lt;li&gt;U+000C FORM FEED (FF)&lt;/li&gt;
-   &lt;!--&lt;li&gt;U+000D CARRIAGE RETURN (CR)&lt;/li&gt;--&gt;
-   &lt;li&gt;U+0020 SPACE&lt;/li&gt;
-   &lt;li&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/li&gt;
-   &lt;li&gt;U+002F SOLIDUS (/)&lt;/li&gt;
-   &lt;li&gt;EOF&lt;/li&gt;
-  &lt;/ul&gt;&lt;p&gt;...then emit a U+003C LESS-THAN SIGN character token, a U+002F
-  SOLIDUS character token, and switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;
-  to process the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;.&lt;/p&gt;
-
-  &lt;p&gt;Otherwise, if the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the
-  PCDATA state, or if the next few characters &lt;em&gt;do&lt;/em&gt; match that tag
-  name, consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
-
   &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Create a new end tag token, set its tag name to the lowercase
-   version of the input character (add 0x0020 to the character's
-   code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
+   version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add 0x0020 to
+   the character's code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
    state&lt;/a&gt;. (Don't emit the token yet; further details will be
    filled in before it is emitted.)&lt;/dd&gt;
 
    &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Create a new end tag token, set its tag name to the input
-   character, then switch to the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;. (Don't
-   emit the token yet; further details will be filled in before it
-   is emitted.)&lt;/dd&gt;
+   &lt;dd&gt;Create a new end tag token, set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, then switch to the &lt;a href=#tag-name-state&gt;tag
+   name state&lt;/a&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#data-state&gt;data
@@ -70613,7 +70596,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#bogus-comment-state&gt;bogus
    comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=tag-name-state&gt;&lt;span class=secno&gt;11.2.4.5 &lt;/span&gt;&lt;dfn&gt;Tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=tag-name-state&gt;&lt;span class=secno&gt;11.2.4.9 &lt;/span&gt;&lt;dfn&gt;Tag name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70632,27 +70615,372 @@
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
-   (add 0x0020 to the character's code point) to the current tag
-   token's tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current tag token's
-   tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.6 &lt;/span&gt;&lt;dfn&gt;Before attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=rcdata-less-than-sign-state&gt;&lt;span class=secno&gt;11.2.4.10 &lt;/span&gt;&lt;dfn&gt;RCDATA less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT less-than sign state, except s/RAWTEXT/RCDATA/g --&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; to the empty string. Switch
+   to the &lt;a href=#rcdata-end-tag-open-state&gt;RCDATA end tag open state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the &lt;a href=#rcdata-state&gt;RCDATA
+   state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rcdata-end-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.11 &lt;/span&gt;&lt;dfn&gt;RCDATA end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT (and Script data) end tag open state, except s/RAWTEXT/RCDATA/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add
+   0x0020 to the character's code point). Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rcdata-end-tag-name-state&gt;&lt;span class=secno&gt;11.2.4.12 &lt;/span&gt;&lt;dfn&gt;RCDATA end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT (and Script data) end tag name state, except s/RAWTEXT/RCDATA/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
   &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
    &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#before-attribute-name-state&gt;before attribute name
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#self-closing-start-tag-state&gt;self-closing start tag
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then emit the current tag token and switch to the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
+   in the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rawtext-less-than-sign-state&gt;&lt;span class=secno&gt;11.2.4.13 &lt;/span&gt;&lt;dfn&gt;RAWTEXT less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA less-than sign state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; to the empty string. Switch
+   to the &lt;a href=#rawtext-end-tag-open-state&gt;RAWTEXT end tag open state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the &lt;a href=#rawtext-state&gt;RAWTEXT
+   state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rawtext-end-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.14 &lt;/span&gt;&lt;dfn&gt;RAWTEXT end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and Script data) end tag open state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add
+   0x0020 to the character's code point). Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rawtext-end-tag-name-state&gt;&lt;span class=secno&gt;11.2.4.15 &lt;/span&gt;&lt;dfn&gt;RAWTEXT end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and Script data) end tag name state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#before-attribute-name-state&gt;before attribute name
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#self-closing-start-tag-state&gt;self-closing start tag
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then emit the current tag token and switch to the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
+   in the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-less-than-sign-state&gt;&lt;span class=secno&gt;11.2.4.16 &lt;/span&gt;&lt;dfn&gt;Script data less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; to the empty string. Switch
+   to the &lt;a href=#script-data-end-tag-open-state&gt;script data end tag open state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and a U+0021
+   EXCLAMATION MARK character token. Switch to the &lt;a href=#script-data-escape-start-state&gt;script data
+   escape start state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the &lt;a href=#script-data-state&gt;script data
+   state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-end-tag-open-state&gt;&lt;span class=secno&gt;11.2.4.17 &lt;/span&gt;&lt;dfn&gt;Script data end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and RAWTEXT) end tag open state, except s/RCDATA/Script data/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add
+   0x0020 to the character's code point). Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#script-data-end-tag-name-state&gt;script data end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#script-data-end-tag-name-state&gt;script data end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-end-tag-name-state&gt;&lt;span class=secno&gt;11.2.4.18 &lt;/span&gt;&lt;dfn&gt;Script data end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and RAWTEXT) end tag name state, except s/RCDATA/Script data/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#before-attribute-name-state&gt;before attribute name
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#self-closing-start-tag-state&gt;self-closing start tag
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then emit the current tag token and switch to the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#script-data-end-tag-name-state&gt;Script data end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#script-data-end-tag-name-state&gt;Script data end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
+   in the &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escape-start-state&gt;&lt;span class=secno&gt;11.2.4.19 &lt;/span&gt;&lt;dfn&gt;Script data escape start state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escape-start-dash-state&gt;script data escape start dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
+   &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escape-start-dash-state&gt;&lt;span class=secno&gt;11.2.4.20 &lt;/span&gt;&lt;dfn&gt;Script data escape start dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escaped-dash-dash-state&gt;script data escaped dash dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
+   &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escaped-state&gt;&lt;span class=secno&gt;11.2.4.21 &lt;/span&gt;&lt;dfn&gt;Script data escaped state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escaped-dash-state&gt;script data escaped dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Stay in
+   the &lt;a href=#script-data-escaped-state&gt;script data escaped state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escaped-dash-state&gt;&lt;span class=secno&gt;11.2.4.22 &lt;/span&gt;&lt;dfn&gt;Script data escaped dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escaped-dash-dash-state&gt;script data escaped dash dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Switch
+   to the &lt;a href=#script-data-escaped-state&gt;script data escaped state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escaped-dash-dash-state&gt;&lt;span class=secno&gt;11.2.4.23 &lt;/span&gt;&lt;dfn&gt;Script data escaped dash dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Stay in the
+   &lt;a href=#script-data-escaped-dash-dash-state&gt;script data escaped dash dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003E GREATER-THAN SIGN character token. Switch to the
+   &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Switch
+   to the &lt;a href=#script-data-escaped-state&gt;script data escaped state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=before-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.24 &lt;/span&gt;&lt;dfn&gt;Before attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
    &lt;dd&gt;Stay in the &lt;a href=#before-attribute-name-state&gt;before attribute name state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
@@ -70686,7 +71014,7 @@
    the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.7 &lt;/span&gt;&lt;dfn&gt;Attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.25 &lt;/span&gt;&lt;dfn&gt;Attribute name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70708,9 +71036,9 @@
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
-   (add 0x0020 to the character's code point) to the current
-   attribute's name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current attribute's name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
@@ -70724,8 +71052,9 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;&lt;p&gt;When the user agent leaves the attribute name state (and before
   emitting the tag token, if appropriate), the complete attribute's
@@ -70736,7 +71065,7 @@
   associated with it (if any).&lt;/p&gt;
 
 
-  &lt;h5 id=after-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.8 &lt;/span&gt;&lt;dfn&gt;After attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=after-attribute-name-state&gt;&lt;span class=secno&gt;11.2.4.26 &lt;/span&gt;&lt;dfn&gt;After attribute name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70759,10 +71088,10 @@
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Start a new attribute in the current tag token. Set that
-   attribute's name to the lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
-   (add 0x0020 to the character's code point), and its value to
-   the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
-   state&lt;/a&gt;.&lt;/dd&gt;
+   attribute's name to the lowercase version of the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; (add 0x0020 to the character's code point),
+   and its value to the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute
+   name state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
    &lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
@@ -70776,11 +71105,11 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Start a new attribute in the current tag token. Set that
-   attribute's name to the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, and its value to
-   the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
+   attribute's name to the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, and
+   its value to the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.9 &lt;/span&gt;&lt;dfn&gt;Before attribute value state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.27 &lt;/span&gt;&lt;dfn&gt;Before attribute value state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70796,7 +71125,7 @@
 
    &lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
    &lt;dd&gt;Switch to the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted) state&lt;/a&gt;
-   and reconsume this input character.&lt;/dd&gt;
+   and reconsume this &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
    &lt;dd&gt;Switch to the &lt;a href=#attribute-value-(single-quoted)-state&gt;attribute value (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
@@ -70820,7 +71149,7 @@
    attribute's value. Switch to the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted)
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.10 &lt;/span&gt;&lt;dfn&gt;Attribute value (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.28 &lt;/span&gt;&lt;dfn&gt;Attribute value (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70838,11 +71167,11 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   value. Stay in the &lt;a href=#attribute-value-(double-quoted)-state&gt;attribute value (double-quoted)
-   state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's value. Stay in the &lt;a href=#attribute-value-(double-quoted)-state&gt;attribute value
+   (double-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.11 &lt;/span&gt;&lt;dfn&gt;Attribute value (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.29 &lt;/span&gt;&lt;dfn&gt;Attribute value (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70860,11 +71189,11 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   value. Stay in the &lt;a href=#attribute-value-(single-quoted)-state&gt;attribute value (single-quoted)
-   state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's value. Stay in the &lt;a href=#attribute-value-(single-quoted)-state&gt;attribute value
+   (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;11.2.4.12 &lt;/span&gt;&lt;dfn&gt;Attribute value (unquoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;11.2.4.30 &lt;/span&gt;&lt;dfn&gt;Attribute value (unquoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70897,11 +71226,11 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   value. Stay in the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted)
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's value. Stay in the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted)
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.13 &lt;/span&gt;&lt;dfn&gt;Character reference in attribute value state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;11.2.4.31 &lt;/span&gt;&lt;dfn&gt;Character reference in attribute value state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Attempt to &lt;a href=#consume-a-character-reference&gt;consume a character reference&lt;/a&gt;.&lt;/p&gt;
 
@@ -70915,7 +71244,7 @@
   in when were switched into this state.&lt;/p&gt;
 
 
-  &lt;h5 id=after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;11.2.4.14 &lt;/span&gt;&lt;dfn&gt;After attribute value (quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;11.2.4.32 &lt;/span&gt;&lt;dfn&gt;After attribute value (quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70941,7 +71270,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the character in
    the &lt;a href=#before-attribute-name-state&gt;before attribute name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=self-closing-start-tag-state&gt;&lt;span class=secno&gt;11.2.4.15 &lt;/span&gt;&lt;dfn&gt;Self-closing start tag state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=self-closing-start-tag-state&gt;&lt;span class=secno&gt;11.2.4.33 &lt;/span&gt;&lt;dfn&gt;Self-closing start tag state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -70958,11 +71287,8 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the character in
    the &lt;a href=#before-attribute-name-state&gt;before attribute name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=bogus-comment-state&gt;&lt;span class=secno&gt;11.2.4.16 &lt;/span&gt;&lt;dfn&gt;Bogus comment state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=bogus-comment-state&gt;&lt;span class=secno&gt;11.2.4.34 &lt;/span&gt;&lt;dfn&gt;Bogus comment state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;Consume every character up to and including the first U+003E
   GREATER-THAN SIGN character (&gt;) or the end of the file (EOF),
   whichever comes first. Emit a comment token whose data is the
@@ -70979,11 +71305,8 @@
   character.&lt;/p&gt;
 
 
-  &lt;h5 id=markup-declaration-open-state&gt;&lt;span class=secno&gt;11.2.4.17 &lt;/span&gt;&lt;dfn&gt;Markup declaration open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=markup-declaration-open-state&gt;&lt;span class=secno&gt;11.2.4.35 &lt;/span&gt;&lt;dfn&gt;Markup declaration open state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;If the next two characters are both U+002D HYPHEN-MINUS (-)
   characters, consume those two characters, create a comment token
   whose data is the empty string, and switch to the &lt;a href=#comment-start-state&gt;comment
@@ -71007,7 +71330,7 @@
   comment.&lt;/p&gt;
 
 
-  &lt;h5 id=comment-start-state&gt;&lt;span class=secno&gt;11.2.4.18 &lt;/span&gt;&lt;dfn&gt;Comment start state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=comment-start-state&gt;&lt;span class=secno&gt;11.2.4.36 &lt;/span&gt;&lt;dfn&gt;Comment start state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71024,10 +71347,10 @@
    the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's
-   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment
+   token's data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-start-dash-state&gt;&lt;span class=secno&gt;11.2.4.19 &lt;/span&gt;&lt;dfn&gt;Comment start dash state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-start-dash-state&gt;&lt;span class=secno&gt;11.2.4.37 &lt;/span&gt;&lt;dfn&gt;Comment start dash state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71044,11 +71367,11 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the input
-   character to the comment token's data. Switch to the
-   &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's
+   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-state&gt;&lt;span class=secno&gt;11.2.4.20 &lt;/span&gt;&lt;dfn id=comment&gt;Comment state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-state&gt;&lt;span class=secno&gt;11.2.4.38 &lt;/span&gt;&lt;dfn id=comment&gt;Comment state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71061,10 +71384,10 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Stay
-   in the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment
+   token's data. Stay in the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-dash-state&gt;&lt;span class=secno&gt;11.2.4.21 &lt;/span&gt;&lt;dfn&gt;Comment end dash state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-dash-state&gt;&lt;span class=secno&gt;11.2.4.39 &lt;/span&gt;&lt;dfn&gt;Comment end dash state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71077,11 +71400,11 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the input
-   character to the comment token's data. Switch to the
-   &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's
+   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-state&gt;&lt;span class=secno&gt;11.2.4.22 &lt;/span&gt;&lt;dfn&gt;Comment end state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-state&gt;&lt;span class=secno&gt;11.2.4.40 &lt;/span&gt;&lt;dfn&gt;Comment end state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71095,8 +71418,9 @@
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Append two U+002D HYPHEN-MINUS (-)
-   characters and the input character to the comment token's
-   data. Switch to the &lt;a href=#comment-end-space-state&gt;comment end space state&lt;/a&gt;.&lt;/dd&gt;
+   characters and the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the
+   comment token's data. Switch to the &lt;a href=#comment-end-space-state&gt;comment end space
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#comment-end-bang-state&gt;comment end bang
@@ -71117,10 +71441,11 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Append two U+002D HYPHEN-MINUS (-)
-   characters and the input character to the comment token's
-   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   characters and the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the
+   comment token's data. Switch to the &lt;a href=#comment-state&gt;comment
+   state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-bang-state&gt;&lt;span class=secno&gt;11.2.4.23 &lt;/span&gt;&lt;dfn&gt;Comment end bang state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-bang-state&gt;&lt;span class=secno&gt;11.2.4.41 &lt;/span&gt;&lt;dfn&gt;Comment end bang state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71140,11 +71465,11 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Append two U+002D HYPHEN-MINUS (-) characters, a U+0021
-   EXCLAMATION MARK character (!), and the input character to the
-   comment token's data. Switch to the &lt;a href=#comment-state&gt;comment
-   state&lt;/a&gt;.&lt;/dd&gt;
+   EXCLAMATION MARK character (!), and the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the comment token's data. Switch to the
+   &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-space-state&gt;&lt;span class=secno&gt;11.2.4.24 &lt;/span&gt;&lt;dfn&gt;Comment end space state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-space-state&gt;&lt;span class=secno&gt;11.2.4.42 &lt;/span&gt;&lt;dfn&gt;Comment end space state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71153,7 +71478,7 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Stay in
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's data. Stay in
    the &lt;a href=#comment-end-space-state&gt;comment end space state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
@@ -71169,10 +71494,10 @@
    comment in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Switch
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's data. Switch
    to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-state&gt;&lt;span class=secno&gt;11.2.4.25 &lt;/span&gt;&lt;dfn&gt;DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-state&gt;&lt;span class=secno&gt;11.2.4.43 &lt;/span&gt;&lt;dfn&gt;DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71192,7 +71517,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the current
    character in the &lt;a href=#before-doctype-name-state&gt;before DOCTYPE name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.26 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.44 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71205,7 +71530,7 @@
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Create a new DOCTYPE token. Set the token's name to the
-   lowercase version of the input character (add 0x0020 to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add 0x0020 to the
    character's code point). Switch to the &lt;a href=#doctype-name-state&gt;DOCTYPE name
    state&lt;/a&gt;.&lt;/dd&gt;
 
@@ -71224,7 +71549,7 @@
    &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Switch to the &lt;a href=#doctype-name-state&gt;DOCTYPE name
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.27 &lt;/span&gt;&lt;dfn&gt;DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.45 &lt;/span&gt;&lt;dfn&gt;DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71240,9 +71565,10 @@
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the input character (add 0x0020
-   to the character's code point) to the current DOCTYPE token's
-   name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current DOCTYPE token's name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
@@ -71250,10 +71576,11 @@
    Reconsume the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current DOCTYPE
-   token's name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   DOCTYPE token's name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.28 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-name-state&gt;&lt;span class=secno&gt;11.2.4.46 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71293,7 +71620,7 @@
 
    &lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;11.2.4.29 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public keyword state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;11.2.4.47 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public keyword state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71314,7 +71641,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the current character in
    the &lt;a href=#before-doctype-public-identifier-state&gt;before DOCTYPE public identifier state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.30 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.48 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71350,7 +71677,7 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.31 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.49 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71372,7 +71699,7 @@
    token's public identifier. Stay in the &lt;a href=#doctype-public-identifier-(double-quoted)-state&gt;DOCTYPE public
    identifier (double-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.32 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.50 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71394,7 +71721,7 @@
    token's public identifier. Stay in the &lt;a href=#doctype-public-identifier-(single-quoted)-state&gt;DOCTYPE public
    identifier (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.33 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;11.2.4.51 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71403,7 +71730,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system identifiers state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system
+   identifiers state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;a href=#data-state&gt;data
@@ -71429,7 +71757,7 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;11.2.4.34 &lt;/span&gt;&lt;dfn&gt;Between DOCTYPE public and system identifiers state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;11.2.4.52 &lt;/span&gt;&lt;dfn&gt;Between DOCTYPE public and system identifiers state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71438,7 +71766,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Stay in the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system identifiers state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Stay in the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system identifiers
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;a href=#data-state&gt;data
@@ -71464,7 +71793,7 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;11.2.4.35 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system keyword state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;11.2.4.53 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system keyword state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71485,7 +71814,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the current character in
    the &lt;a href=#before-doctype-system-identifier-state&gt;before DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.36 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.54 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71521,12 +71850,13 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.37 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.55 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
@@ -71539,16 +71869,17 @@
    Reconsume the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current DOCTYPE
-   token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;DOCTYPE system
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   DOCTYPE token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;DOCTYPE system
    identifier (double-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.38 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;11.2.4.56 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
@@ -71561,11 +71892,11 @@
    Reconsume the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current DOCTYPE
-   token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;DOCTYPE system
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   DOCTYPE token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;DOCTYPE system
    identifier (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.39 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;11.2.4.57 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71574,7 +71905,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Stay in the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Stay in the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;a href=#data-state&gt;data
@@ -71590,7 +71922,7 @@
    state&lt;/a&gt;. (This does &lt;em&gt;not&lt;/em&gt; set the DOCTYPE token's
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;.)&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=bogus-doctype-state&gt;&lt;span class=secno&gt;11.2.4.40 &lt;/span&gt;&lt;dfn&gt;Bogus DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=bogus-doctype-state&gt;&lt;span class=secno&gt;11.2.4.58 &lt;/span&gt;&lt;dfn&gt;Bogus DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -71605,11 +71937,8 @@
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Stay in the &lt;a href=#bogus-doctype-state&gt;bogus DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=cdata-section-state&gt;&lt;span class=secno&gt;11.2.4.41 &lt;/span&gt;&lt;dfn&gt;CDATA section state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=cdata-section-state&gt;&lt;span class=secno&gt;11.2.4.59 &lt;/span&gt;&lt;dfn&gt;CDATA section state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;Consume every character up to the next occurrence of the three
   character sequence U+005D RIGHT SQUARE BRACKET U+005D RIGHT SQUARE
   BRACKET U+003E GREATER-THAN SIGN (&lt;code title=&quot;&quot;&gt;]]&gt;&lt;/code&gt;), or the
@@ -71625,7 +71954,7 @@
 
 
 
-  &lt;h5 id=tokenizing-character-references&gt;&lt;span class=secno&gt;11.2.4.42 &lt;/span&gt;Tokenizing character references&lt;/h5&gt;
+  &lt;h5 id=tokenizing-character-references&gt;&lt;span class=secno&gt;11.2.4.60 &lt;/span&gt;Tokenizing character references&lt;/h5&gt;
 
   &lt;p&gt;This section defines how to &lt;dfn id=consume-a-character-reference&gt;consume a character
   reference&lt;/dfn&gt;. This definition is used when parsing character
@@ -72072,11 +72401,10 @@
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#insert-an-html-element&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the algorithm that was invoked is the &lt;a href=#generic-raw-text-element-parsing-algorithm&gt;generic raw
-   text element parsing algorithm&lt;/a&gt;, switch the tokenizer's
-   &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the RAWTEXT state; otherwise the
-   algorithm invoked was the &lt;a href=#generic-rcdata-element-parsing-algorithm&gt;generic RCDATA element parsing
-   algorithm&lt;/a&gt;, switch the tokenizer's &lt;a href=#content-model-flag&gt;content model
-   flag&lt;/a&gt; to the RCDATA state.&lt;/li&gt;
+   text element parsing algorithm&lt;/a&gt;, switch the tokenizer to the
+   &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;; otherwise the algorithm invoked
+   was the &lt;a href=#generic-rcdata-element-parsing-algorithm&gt;generic RCDATA element parsing algorithm&lt;/a&gt;,
+   switch the tokenizer to the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let the &lt;a href=#original-insertion-mode&gt;original insertion mode&lt;/a&gt; be the current
    &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
@@ -72590,8 +72918,8 @@
      and push it onto the &lt;a href=#stack-of-open-elements&gt;stack of open
      elements&lt;/a&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Switch the tokenizer's &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-     the RAWTEXT state.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Switch the tokenizer to the &lt;a href=#script-data-state&gt;script data
+     state&lt;/a&gt;.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;a href=#original-insertion-mode&gt;original insertion mode&lt;/a&gt; be the current
      &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
@@ -73130,14 +73458,12 @@
 
     &lt;p&gt;&lt;a href=#insert-an-html-element&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the PLAINTEXT
-    state.&lt;/p&gt;
+    &lt;p&gt;Switch the tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p class=note&gt;Once a start tag with the tag name &quot;plaintext&quot;
-    has been seen, that will be the last token ever seen other
-    than character tokens (and the end-of-file token), because
-    there is no way to switch the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt;
-    out of the PLAINTEXT state.&lt;/p&gt;
+    &lt;p class=note&gt;Once a start tag with the tag name &quot;plaintext&quot; has
+    been seen, that will be the last token ever seen other than
+    character tokens (and the end-of-file token), because there is no
+    way to switch out of the &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;.&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -73733,8 +74059,8 @@
      one. (Newlines at the start of &lt;code&gt;&lt;a href=#the-textarea-element&gt;textarea&lt;/a&gt;&lt;/code&gt; elements are
      ignored as an authoring convenience.)&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Switch the tokenizer's &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-     the RCDATA state.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Switch the tokenizer to the the &lt;a href=#rcdata-state&gt;RCDATA
+     state&lt;/a&gt;.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;a href=#original-insertion-mode&gt;original insertion mode&lt;/a&gt; be the
      current &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
@@ -76096,42 +76422,38 @@
 
     &lt;ol&gt;&lt;li&gt;
 
-      &lt;p&gt;Set the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s &lt;a href=#tokenization&gt;tokenization&lt;/a&gt;
-      stage's &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; according to the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element, as follows:&lt;/p&gt;
+      &lt;p&gt;Set the state of the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s
+      &lt;a href=#tokenization&gt;tokenization&lt;/a&gt; stage as follows:&lt;/p&gt;
 
       &lt;dl class=switch&gt;&lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#the-title-element-0&gt;title&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a href=#the-textarea-element&gt;textarea&lt;/a&gt;&lt;/code&gt;
        element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-       the RCDATA state.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;,
        &lt;code&gt;&lt;a href=#xmp&gt;xmp&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#the-iframe-element&gt;iframe&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#noembed&gt;noembed&lt;/a&gt;&lt;/code&gt;, or
        &lt;code&gt;&lt;a href=#noframes&gt;noframes&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-       the RAWTEXT state.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;If the &lt;a href=#scripting-flag&gt;scripting flag&lt;/a&gt; is enabled, set the
-       &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the RAWTEXT
-       state. Otherwise, set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the
-       PCDATA state.&lt;/dd&gt;
+       &lt;dd&gt;If the &lt;a href=#scripting-flag&gt;scripting flag&lt;/a&gt; is enabled, switch the
+       tokenizer to the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.  Otherwise,
+       leave the tokenizer in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#plaintext&gt;plaintext&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-       PLAINTEXT.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT
+       state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;Otherwise&lt;/dt&gt;
 
-       &lt;dd&gt;Leave the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; in the PCDATA
-       state.&lt;/dd&gt;
+       &lt;dd&gt;Leave the tokenizer in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
       &lt;/dl&gt;&lt;/li&gt;
 

Modified: index
===================================================================
--- index	2009-10-19 05:52:18 UTC (rev 4176)
+++ index	2009-10-19 11:00:31 UTC (rev 4177)
@@ -881,47 +881,65 @@
      &lt;li&gt;&lt;a href=#tokenization&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Tokenization&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#data-state&gt;&lt;span class=secno&gt;9.2.4.1 &lt;/span&gt;Data state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#character-reference-in-data-state&gt;&lt;span class=secno&gt;9.2.4.2 &lt;/span&gt;Character reference in data state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#tag-open-state&gt;&lt;span class=secno&gt;9.2.4.3 &lt;/span&gt;Tag open state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#close-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.4 &lt;/span&gt;Close tag open state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#tag-name-state&gt;&lt;span class=secno&gt;9.2.4.5 &lt;/span&gt;Tag name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.6 &lt;/span&gt;Before attribute name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.7 &lt;/span&gt;Attribute name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.8 &lt;/span&gt;After attribute name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.9 &lt;/span&gt;Before attribute value state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.10 &lt;/span&gt;Attribute value (double-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.11 &lt;/span&gt;Attribute value (single-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;9.2.4.12 &lt;/span&gt;Attribute value (unquoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.13 &lt;/span&gt;Character reference in attribute value state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;9.2.4.14 &lt;/span&gt;After attribute value (quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#self-closing-start-tag-state&gt;&lt;span class=secno&gt;9.2.4.15 &lt;/span&gt;Self-closing start tag state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#bogus-comment-state&gt;&lt;span class=secno&gt;9.2.4.16 &lt;/span&gt;Bogus comment state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#markup-declaration-open-state&gt;&lt;span class=secno&gt;9.2.4.17 &lt;/span&gt;Markup declaration open state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-start-state&gt;&lt;span class=secno&gt;9.2.4.18 &lt;/span&gt;Comment start state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-start-dash-state&gt;&lt;span class=secno&gt;9.2.4.19 &lt;/span&gt;Comment start dash state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-state&gt;&lt;span class=secno&gt;9.2.4.20 &lt;/span&gt;Comment state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-dash-state&gt;&lt;span class=secno&gt;9.2.4.21 &lt;/span&gt;Comment end dash state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-state&gt;&lt;span class=secno&gt;9.2.4.22 &lt;/span&gt;Comment end state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-bang-state&gt;&lt;span class=secno&gt;9.2.4.23 &lt;/span&gt;Comment end bang state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#comment-end-space-state&gt;&lt;span class=secno&gt;9.2.4.24 &lt;/span&gt;Comment end space state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-state&gt;&lt;span class=secno&gt;9.2.4.25 &lt;/span&gt;DOCTYPE state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.26 &lt;/span&gt;Before DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.27 &lt;/span&gt;DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.28 &lt;/span&gt;After DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;9.2.4.29 &lt;/span&gt;After DOCTYPE public keyword state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.30 &lt;/span&gt;Before DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.31 &lt;/span&gt;DOCTYPE public identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.32 &lt;/span&gt;DOCTYPE public identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.33 &lt;/span&gt;After DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;9.2.4.34 &lt;/span&gt;Between DOCTYPE public and system identifiers state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;9.2.4.35 &lt;/span&gt;After DOCTYPE system keyword state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.36 &lt;/span&gt;Before DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.37 &lt;/span&gt;DOCTYPE system identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.38 &lt;/span&gt;DOCTYPE system identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.39 &lt;/span&gt;After DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#bogus-doctype-state&gt;&lt;span class=secno&gt;9.2.4.40 &lt;/span&gt;Bogus DOCTYPE state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#cdata-section-state&gt;&lt;span class=secno&gt;9.2.4.41 &lt;/span&gt;CDATA section state&lt;/a&gt;&lt;/li&gt;
-       &lt;li&gt;&lt;a href=#tokenizing-character-references&gt;&lt;span class=secno&gt;9.2.4.42 &lt;/span&gt;Tokenizing character references&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-state&gt;&lt;span class=secno&gt;9.2.4.2 &lt;/span&gt;RCDATA state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-state&gt;&lt;span class=secno&gt;9.2.4.3 &lt;/span&gt;RAWTEXT state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-state&gt;&lt;span class=secno&gt;9.2.4.4 &lt;/span&gt;Script data state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#plaintext-state&gt;&lt;span class=secno&gt;9.2.4.5 &lt;/span&gt;PLAINTEXT state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#character-reference-in-data-state&gt;&lt;span class=secno&gt;9.2.4.6 &lt;/span&gt;Character reference in data state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#tag-open-state&gt;&lt;span class=secno&gt;9.2.4.7 &lt;/span&gt;Tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#close-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.8 &lt;/span&gt;Close tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#tag-name-state&gt;&lt;span class=secno&gt;9.2.4.9 &lt;/span&gt;Tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-less-than-sign-state&gt;&lt;span class=secno&gt;9.2.4.10 &lt;/span&gt;RCDATA less-than sign state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-end-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.11 &lt;/span&gt;RCDATA end tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rcdata-end-tag-name-state&gt;&lt;span class=secno&gt;9.2.4.12 &lt;/span&gt;RCDATA end tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-less-than-sign-state&gt;&lt;span class=secno&gt;9.2.4.13 &lt;/span&gt;RAWTEXT less-than sign state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-end-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.14 &lt;/span&gt;RAWTEXT end tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#rawtext-end-tag-name-state&gt;&lt;span class=secno&gt;9.2.4.15 &lt;/span&gt;RAWTEXT end tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-less-than-sign-state&gt;&lt;span class=secno&gt;9.2.4.16 &lt;/span&gt;Script data less-than sign state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-end-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.17 &lt;/span&gt;Script data end tag open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-end-tag-name-state&gt;&lt;span class=secno&gt;9.2.4.18 &lt;/span&gt;Script data end tag name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escape-start-state&gt;&lt;span class=secno&gt;9.2.4.19 &lt;/span&gt;Script data escape start state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escape-start-dash-state&gt;&lt;span class=secno&gt;9.2.4.20 &lt;/span&gt;Script data escape start dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escaped-state&gt;&lt;span class=secno&gt;9.2.4.21 &lt;/span&gt;Script data escaped state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escaped-dash-state&gt;&lt;span class=secno&gt;9.2.4.22 &lt;/span&gt;Script data escaped dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#script-data-escaped-dash-dash-state&gt;&lt;span class=secno&gt;9.2.4.23 &lt;/span&gt;Script data escaped dash dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.24 &lt;/span&gt;Before attribute name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.25 &lt;/span&gt;Attribute name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.26 &lt;/span&gt;After attribute name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.27 &lt;/span&gt;Before attribute value state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.28 &lt;/span&gt;Attribute value (double-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.29 &lt;/span&gt;Attribute value (single-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;9.2.4.30 &lt;/span&gt;Attribute value (unquoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.31 &lt;/span&gt;Character reference in attribute value state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;9.2.4.32 &lt;/span&gt;After attribute value (quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#self-closing-start-tag-state&gt;&lt;span class=secno&gt;9.2.4.33 &lt;/span&gt;Self-closing start tag state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#bogus-comment-state&gt;&lt;span class=secno&gt;9.2.4.34 &lt;/span&gt;Bogus comment state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#markup-declaration-open-state&gt;&lt;span class=secno&gt;9.2.4.35 &lt;/span&gt;Markup declaration open state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-start-state&gt;&lt;span class=secno&gt;9.2.4.36 &lt;/span&gt;Comment start state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-start-dash-state&gt;&lt;span class=secno&gt;9.2.4.37 &lt;/span&gt;Comment start dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-state&gt;&lt;span class=secno&gt;9.2.4.38 &lt;/span&gt;Comment state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-dash-state&gt;&lt;span class=secno&gt;9.2.4.39 &lt;/span&gt;Comment end dash state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-state&gt;&lt;span class=secno&gt;9.2.4.40 &lt;/span&gt;Comment end state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-bang-state&gt;&lt;span class=secno&gt;9.2.4.41 &lt;/span&gt;Comment end bang state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#comment-end-space-state&gt;&lt;span class=secno&gt;9.2.4.42 &lt;/span&gt;Comment end space state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-state&gt;&lt;span class=secno&gt;9.2.4.43 &lt;/span&gt;DOCTYPE state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.44 &lt;/span&gt;Before DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.45 &lt;/span&gt;DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.46 &lt;/span&gt;After DOCTYPE name state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;9.2.4.47 &lt;/span&gt;After DOCTYPE public keyword state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.48 &lt;/span&gt;Before DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.49 &lt;/span&gt;DOCTYPE public identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.50 &lt;/span&gt;DOCTYPE public identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.51 &lt;/span&gt;After DOCTYPE public identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;9.2.4.52 &lt;/span&gt;Between DOCTYPE public and system identifiers state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;9.2.4.53 &lt;/span&gt;After DOCTYPE system keyword state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.54 &lt;/span&gt;Before DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.55 &lt;/span&gt;DOCTYPE system identifier (double-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.56 &lt;/span&gt;DOCTYPE system identifier (single-quoted) state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.57 &lt;/span&gt;After DOCTYPE system identifier state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#bogus-doctype-state&gt;&lt;span class=secno&gt;9.2.4.58 &lt;/span&gt;Bogus DOCTYPE state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#cdata-section-state&gt;&lt;span class=secno&gt;9.2.4.59 &lt;/span&gt;CDATA section state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;&lt;a href=#tokenizing-character-references&gt;&lt;span class=secno&gt;9.2.4.60 &lt;/span&gt;Tokenizing character references&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=#tree-construction&gt;&lt;span class=secno&gt;9.2.5 &lt;/span&gt;Tree construction&lt;/a&gt;
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#creating-and-inserting-elements&gt;&lt;span class=secno&gt;9.2.5.1 &lt;/span&gt;Creating and inserting elements&lt;/a&gt;&lt;/li&gt;
@@ -9614,9 +9632,9 @@
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; is &lt;em&gt;not&lt;/em&gt; now an &lt;a href=#ascii-case-insensitive&gt;ASCII
     case-insensitive&lt;/a&gt; match for the string
     &quot;&lt;code&gt;&lt;a href=#text/html&gt;text/html&lt;/a&gt;&lt;/code&gt;&quot;, then act as if the tokenizer had emitted
-    a start tag token with the tag name &quot;pre&quot;, then set the &lt;a href=#html-parser&gt;HTML
-    parser&lt;/a&gt;'s &lt;a href=#tokenization&gt;tokenization&lt;/a&gt; stage's &lt;a href=#content-model-flag&gt;content
-    model flag&lt;/a&gt; to &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;.&lt;/p&gt;
+    a start tag token with the tag name &quot;pre&quot;, then switch the
+    &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT
+    state&lt;/a&gt;.&lt;/p&gt;
 
     &lt;!--
  <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%3E%3C%2Fiframe%3E%3Cscript%3Eonload%20%3D%20function%20(">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%3E%3C%2Fiframe%3E%3Cscript%3Eonload%20%3D%20function%20(</A>)%20%7B%20%0D%0A%20%20var%20d%20%3D%20document.getElementsByTagName('iframe')%5B0%5D.contentDocument%3B%0D%0A%20%20d.open('image%2Fsvg%2Bxml')%3B%0D%0A%20%20d.write(%22%3Cinput%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml'%20value%3D'(x)html'%2F%3E%22)%3B%0D%0A%20%20d.close()%3B%0D%0A%7D%3B%3C%2Fscript%3E
@@ -52917,9 +52935,9 @@
   context&lt;/a&gt;, the user agent should &lt;a href=#create-a-document-object&gt;create a
   &lt;code&gt;Document&lt;/code&gt; object&lt;/a&gt;, mark it as being an &lt;a href=#html-documents title=&quot;HTML documents&quot;&gt;HTML document&lt;/a&gt;, create an &lt;a href=#html-parser&gt;HTML
   parser&lt;/a&gt;, associate it with the document, act as if the
-  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;, set
-  the &lt;a href=#tokenization&gt;tokenization&lt;/a&gt; stage's &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; to &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;, and begin to pass the stream of
+  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;,
+  switch the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s tokenizer to the
+  &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;, and begin to pass the stream of
   characters in the plain text document to that tokenizer.&lt;/p&gt;
 
   &lt;p&gt;The rules for how to convert the bytes of the plain text document
@@ -61420,16 +61438,13 @@
   switches it to a new state (to consume the next character), or
   repeats the same state (to consume the next character). Some states
   have more complicated behavior and can consume several characters
-  before switching to another state.&lt;/p&gt;
+  before switching to another state. In some cases, the tokenizer
+  state is also changed by the tree construction stage.&lt;/p&gt;
 
-  &lt;p&gt;The exact behavior of certain states depends on a &lt;dfn id=content-model-flag&gt;content
-  model flag&lt;/dfn&gt; that is set after certain tokens are emitted. The
-  flag has several states: &lt;i title=&quot;&quot;&gt;PCDATA&lt;/i&gt;, &lt;i title=&quot;&quot;&gt;RCDATA&lt;/i&gt;, &lt;i title=&quot;&quot;&gt;RAWTEXT&lt;/i&gt;, and &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;. Initially, it must be in the PCDATA
-  state. In the RCDATA and RAWTEXT states, a further &lt;dfn id=escape-flag&gt;escape
-  flag&lt;/dfn&gt; is used to control the behavior of the tokenizer. It is
-  either true or false, and initially must be set to the false
-  state. The &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt; and the &lt;a href=#stack-of-open-elements&gt;stack of open
-  elements&lt;/a&gt; also affects tokenization.&lt;/p&gt;
+  &lt;p&gt;The exact behavior of certain states depends on the
+  &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt; and the &lt;a href=#stack-of-open-elements&gt;stack of open
+  elements&lt;/a&gt;. Certain states also use a &lt;dfn id=temporary-buffer&gt;&lt;var&gt;temporary
+  buffer&lt;/var&gt;&lt;/dfn&gt; to track progress.&lt;/p&gt;
 
   &lt;p&gt;The output of the tokenization step is a series of zero or more
   of the following tokens: DOCTYPE, start tag, end tag, comment,
@@ -61448,8 +61463,8 @@
 
   &lt;p&gt;When a token is emitted, it must immediately be handled by the
   &lt;a href=#tree-construction&gt;tree construction&lt;/a&gt; stage. The tree construction stage
-  can affect the state of the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt;, and can
-  insert additional characters into the stream. (For example, the
+  can affect the state of the tokenization stage, and can insert
+  additional characters into the stream. (For example, the
   &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt; element can result in scripts executing and
   using the &lt;a href=#dynamic-markup-insertion&gt;dynamic markup insertion&lt;/a&gt; APIs to insert
   characters into the stream being tokenized.)&lt;/p&gt;
@@ -61459,15 +61474,18 @@
   self-closing flag&quot;&gt;acknowledged&lt;/dfn&gt; when it is processed by the
   tree construction stage, that is a &lt;a href=#parse-error&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
-  &lt;p&gt;When an end tag token is emitted, the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; must be switched to the PCDATA state.&lt;/p&gt;
-
   &lt;p&gt;When an end tag token is emitted with attributes, that is a
   &lt;a href=#parse-error&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
   &lt;p&gt;When an end tag token is emitted with its &lt;i&gt;self-closing
   flag&lt;/i&gt; set, that is a &lt;a href=#parse-error&gt;parse error&lt;/a&gt;.&lt;/p&gt;
 
+  &lt;p&gt;An &lt;dfn id=appropriate-end-tag-token&gt;appropriate end tag token&lt;/dfn&gt; is an end tag token whose
+  tag name matches the tag name of the last start tag to have been
+  emitted from this tokenizer, if any. If no start tag has been
+  emitted from this tokenizer, then no end tag token is
+  appropriate.&lt;/p&gt;
+
   &lt;p&gt;Before each step of the tokenizer, the user agent must first
   check the &lt;a href=#parser-pause-flag&gt;parser pause flag&lt;/a&gt;. If it is true, then the
   tokenizer must abort the processing of any nested invocations of the
@@ -61476,187 +61494,152 @@
   &lt;p&gt;The tokenizer state machine consists of the states defined in the
   following subsections.&lt;/p&gt;
 
+
   &lt;!-- Order of the lists below is supposed to be non-error then
   error, by unicode, then EOF, ending with &quot;anything else&quot; --&gt;
 
+
   &lt;h5 id=data-state&gt;&lt;span class=secno&gt;9.2.4.1 &lt;/span&gt;&lt;dfn&gt;Data state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
-   &lt;dd&gt;When the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to one of the
-   PCDATA or RCDATA states and the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt; is
-   false: switch to the &lt;a href=#character-reference-in-data-state&gt;character reference in data
+   &lt;dd&gt;Switch to the &lt;a href=#character-reference-in-data-state&gt;character reference in data
    state&lt;/a&gt;.&lt;/dd&gt;
-   &lt;dd&gt;Otherwise: treat it as per the &quot;anything else&quot; entry
-   below.&lt;/dd&gt;
 
-   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
-   &lt;dd&gt;
+   &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#tag-open-state&gt;tag open state&lt;/a&gt;.&lt;/dd&gt;
 
-    &lt;p&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to either the
-    RCDATA state or the RAWTEXT state, and the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt;
-    is false, and there are at least three characters before this
-    one in the input stream, and the last four characters in the
-    input stream, including this one, are U+003C LESS-THAN SIGN,
-    U+0021 EXCLAMATION MARK, U+002D HYPHEN-MINUS, and U+002D
-    HYPHEN-MINUS (&quot;&lt;!--&quot;), then set the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt;
-    to true.&lt;/p&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-    &lt;p&gt;In any case, emit the input character as a character
-    token. Stay in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
-   &lt;/dd&gt;
+  &lt;/dl&gt;&lt;h5 id=rcdata-state&gt;&lt;span class=secno&gt;9.2.4.2 &lt;/span&gt;&lt;dfn&gt;RCDATA state&lt;/dfn&gt;&lt;/h5&gt;
 
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#character-reference-in-data-state&gt;character reference in data
+   state&lt;/a&gt;.&lt;/dd&gt;
+
    &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
-   &lt;dd&gt;When the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the PCDATA
-   state: switch to the &lt;a href=#tag-open-state&gt;tag open state&lt;/a&gt;.&lt;/dd&gt;
-   &lt;dd&gt;When the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to either the
-   RCDATA state or the RAWTEXT state, and the &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt;
-   is false: switch to the &lt;a href=#tag-open-state&gt;tag open state&lt;/a&gt;.&lt;/dd&gt;
-   &lt;dd&gt;Otherwise: treat it as per the &quot;anything else&quot; entry
-   below.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#rcdata-less-than-sign-state&gt;RCDATA less-than sign state&lt;/a&gt;.&lt;/dd&gt;
 
-   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
-   &lt;dd&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-    &lt;p&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to either the
-    RCDATA state or the RAWTEXT state, and the &lt;a href=#escape-flag&gt;escape
-    flag&lt;/a&gt; is true, and the last three characters in the input
-    stream including this one are U+002D HYPHEN-MINUS, U+002D
-    HYPHEN-MINUS, U+003E GREATER-THAN SIGN (&quot;--&gt;&quot;), set the
-    &lt;a href=#escape-flag&gt;escape flag&lt;/a&gt; to false.&lt;/p&gt; &lt;!-- no need to check
-    that there are enough characters, since you can only run into
-    this if the flag is true in the first place, which requires four
-    characters. --&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
 
-    &lt;p&gt;In any case, emit the input character as a character
-    token. Stay in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+  &lt;/dl&gt;&lt;h5 id=rawtext-state&gt;&lt;span class=secno&gt;9.2.4.3 &lt;/span&gt;&lt;dfn&gt;RAWTEXT state&lt;/dfn&gt;&lt;/h5&gt;
 
-   &lt;/dd&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
+  &lt;dl class=switch&gt;&lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#rawtext-less-than-sign-state&gt;RAWTEXT less-than sign state&lt;/a&gt;.&lt;/dd&gt;
+
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Emit the input character as a character token. Stay in the
-   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=character-reference-in-data-state&gt;&lt;span class=secno&gt;9.2.4.2 &lt;/span&gt;&lt;dfn&gt;Character reference in data state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=script-data-state&gt;&lt;span class=secno&gt;9.2.4.4 &lt;/span&gt;&lt;dfn&gt;Script data state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This cannot happen if the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt;
-  is set to the RAWTEXT state.)&lt;/i&gt;&lt;/p&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-  &lt;p&gt;Attempt to &lt;a href=#consume-a-character-reference&gt;consume a character reference&lt;/a&gt;, with no
-  &lt;a href=#additional-allowed-character&gt;additional allowed character&lt;/a&gt;.&lt;/p&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#script-data-less-than-sign-state&gt;script data less-than sign state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;p&gt;If nothing is returned, emit a U+0026 AMPERSAND character
-  token.&lt;/p&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-  &lt;p&gt;Otherwise, emit the character token that was returned.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;p&gt;Finally, switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+  &lt;/dl&gt;&lt;h5 id=plaintext-state&gt;&lt;span class=secno&gt;9.2.4.5 &lt;/span&gt;&lt;dfn&gt;PLAINTEXT state&lt;/dfn&gt;&lt;/h5&gt;
 
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-  &lt;h5 id=tag-open-state&gt;&lt;span class=secno&gt;9.2.4.3 &lt;/span&gt;&lt;dfn&gt;Tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-  &lt;p&gt;The behavior of this state depends on the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt;.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; as a character
+   token. Stay in the &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;dl&gt;&lt;dt&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the RCDATA
-   or RAWTEXT states&lt;/dt&gt;
+  &lt;/dl&gt;&lt;h5 id=character-reference-in-data-state&gt;&lt;span class=secno&gt;9.2.4.6 &lt;/span&gt;&lt;dfn&gt;Character reference in data state&lt;/dfn&gt;&lt;/h5&gt;
 
-   &lt;dd&gt;
+  &lt;p&gt;Attempt to &lt;a href=#consume-a-character-reference&gt;consume a character reference&lt;/a&gt;, with no
+  &lt;a href=#additional-allowed-character&gt;additional allowed character&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;. If it is a
-    U+002F SOLIDUS character (/), switch to the &lt;a href=#close-tag-open-state&gt;close tag open
-    state&lt;/a&gt;. Otherwise, emit a U+003C LESS-THAN SIGN character
-    token and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
-    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
+  &lt;p&gt;If nothing is returned, emit a U+0026 AMPERSAND character
+  token.&lt;/p&gt;
 
-   &lt;/dd&gt;
+  &lt;p&gt;Otherwise, emit the character token that was returned.&lt;/p&gt;
 
-   &lt;dt&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the PCDATA
-   state&lt;/dt&gt;
+  &lt;p&gt;Finally, switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/p&gt;
 
-   &lt;dd&gt;
 
-    &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+  &lt;h5 id=tag-open-state&gt;&lt;span class=secno&gt;9.2.4.7 &lt;/span&gt;&lt;dfn&gt;Tag open state&lt;/dfn&gt;&lt;/h5&gt;
 
-    &lt;dl class=switch&gt;&lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
-     &lt;dd&gt;Switch to the &lt;a href=#markup-declaration-open-state&gt;markup declaration open state&lt;/a&gt;.&lt;/dd&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-     &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
-     &lt;dd&gt;Switch to the &lt;a href=#close-tag-open-state&gt;close tag open state&lt;/a&gt;.&lt;/dd&gt;
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#markup-declaration-open-state&gt;markup declaration open state&lt;/a&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-     &lt;dd&gt;Create a new start tag token, set its tag name to the
-     lowercase version of the input character (add 0x0020 to the
-     character's code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
-     state&lt;/a&gt;. (Don't emit the token yet; further details will
-     be filled in before it is emitted.)&lt;/dd&gt;
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#close-tag-open-state&gt;close tag open state&lt;/a&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
-     &lt;dd&gt;Create a new start tag token, set its tag name to the input
-     character, then switch to the &lt;a href=#tag-name-state&gt;tag name
-     state&lt;/a&gt;. (Don't emit the token yet; further details will
-     be filled in before it is emitted.)&lt;/dd&gt;
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new start tag token, set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add 0x0020 to the
+   character's code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
+   state&lt;/a&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
-     &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
-     &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
-     character token and a U+003E GREATER-THAN SIGN character
-     token. Switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new start tag token, set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, then switch to the &lt;a href=#tag-name-state&gt;tag
+   name state&lt;/a&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
-     &lt;dt&gt;U+003F QUESTION MARK (?)&lt;/dt&gt;
-     &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#bogus-comment-state&gt;bogus
-     comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
+   character token and a U+003E GREATER-THAN SIGN character
+   token. Switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
-     &lt;dt&gt;Anything else&lt;/dt&gt;
-     &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
-     character token and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
-     &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dt&gt;U+003F QUESTION MARK (?)&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#bogus-comment-state&gt;bogus
+   comment state&lt;/a&gt;.&lt;/dd&gt;
 
-    &lt;/dl&gt;&lt;/dd&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Emit a U+003C LESS-THAN SIGN
+   character token and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=close-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.4 &lt;/span&gt;&lt;dfn&gt;Close tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=close-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.8 &lt;/span&gt;&lt;dfn&gt;Close tag open state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;If the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the RCDATA or
-  RAWTEXT states but no start tag token has ever been emitted by this
-  instance of the tokenizer (&lt;a href=#fragment-case&gt;fragment case&lt;/a&gt;), or, if the
-  &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the RCDATA or RAWTEXT states
-  and the next few characters do not match the tag name of the last
-  start tag token emitted (compared in an &lt;a href=#ascii-case-insensitive&gt;ASCII
-  case-insensitive&lt;/a&gt; manner), or if they do but they are not
-  immediately followed by one of the following characters:&lt;/p&gt;
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
-  &lt;ul class=brief&gt;&lt;li&gt;U+0009 CHARACTER TABULATION&lt;/li&gt;
-   &lt;li&gt;U+000A LINE FEED (LF)&lt;/li&gt;
-   &lt;li&gt;U+000C FORM FEED (FF)&lt;/li&gt;
-   &lt;!--&lt;li&gt;U+000D CARRIAGE RETURN (CR)&lt;/li&gt;--&gt;
-   &lt;li&gt;U+0020 SPACE&lt;/li&gt;
-   &lt;li&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/li&gt;
-   &lt;li&gt;U+002F SOLIDUS (/)&lt;/li&gt;
-   &lt;li&gt;EOF&lt;/li&gt;
-  &lt;/ul&gt;&lt;p&gt;...then emit a U+003C LESS-THAN SIGN character token, a U+002F
-  SOLIDUS character token, and switch to the &lt;a href=#data-state&gt;data state&lt;/a&gt;
-  to process the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;.&lt;/p&gt;
-
-  &lt;p&gt;Otherwise, if the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; is set to the
-  PCDATA state, or if the next few characters &lt;em&gt;do&lt;/em&gt; match that tag
-  name, consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
-
   &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Create a new end tag token, set its tag name to the lowercase
-   version of the input character (add 0x0020 to the character's
-   code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
+   version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add 0x0020 to
+   the character's code point), then switch to the &lt;a href=#tag-name-state&gt;tag name
    state&lt;/a&gt;. (Don't emit the token yet; further details will be
    filled in before it is emitted.)&lt;/dd&gt;
 
    &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Create a new end tag token, set its tag name to the input
-   character, then switch to the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;. (Don't
-   emit the token yet; further details will be filled in before it
-   is emitted.)&lt;/dd&gt;
+   &lt;dd&gt;Create a new end tag token, set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, then switch to the &lt;a href=#tag-name-state&gt;tag
+   name state&lt;/a&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#data-state&gt;data
@@ -61671,7 +61654,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#bogus-comment-state&gt;bogus
    comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=tag-name-state&gt;&lt;span class=secno&gt;9.2.4.5 &lt;/span&gt;&lt;dfn&gt;Tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=tag-name-state&gt;&lt;span class=secno&gt;9.2.4.9 &lt;/span&gt;&lt;dfn&gt;Tag name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61690,27 +61673,372 @@
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
-   (add 0x0020 to the character's code point) to the current tag
-   token's tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current tag token's
-   tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Stay in the &lt;a href=#tag-name-state&gt;tag name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.6 &lt;/span&gt;&lt;dfn&gt;Before attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=rcdata-less-than-sign-state&gt;&lt;span class=secno&gt;9.2.4.10 &lt;/span&gt;&lt;dfn&gt;RCDATA less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT less-than sign state, except s/RAWTEXT/RCDATA/g --&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; to the empty string. Switch
+   to the &lt;a href=#rcdata-end-tag-open-state&gt;RCDATA end tag open state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the &lt;a href=#rcdata-state&gt;RCDATA
+   state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rcdata-end-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.11 &lt;/span&gt;&lt;dfn&gt;RCDATA end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT (and Script data) end tag open state, except s/RAWTEXT/RCDATA/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add
+   0x0020 to the character's code point). Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rcdata-end-tag-name-state&gt;&lt;span class=secno&gt;9.2.4.12 &lt;/span&gt;&lt;dfn&gt;RCDATA end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT (and Script data) end tag name state, except s/RAWTEXT/RCDATA/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
   &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
    &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#before-attribute-name-state&gt;before attribute name
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#self-closing-start-tag-state&gt;self-closing start tag
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then emit the current tag token and switch to the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rcdata-end-tag-name-state&gt;RCDATA end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
+   in the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rawtext-less-than-sign-state&gt;&lt;span class=secno&gt;9.2.4.13 &lt;/span&gt;&lt;dfn&gt;RAWTEXT less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA less-than sign state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; to the empty string. Switch
+   to the &lt;a href=#rawtext-end-tag-open-state&gt;RAWTEXT end tag open state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the &lt;a href=#rawtext-state&gt;RAWTEXT
+   state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rawtext-end-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.14 &lt;/span&gt;&lt;dfn&gt;RAWTEXT end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and Script data) end tag open state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add
+   0x0020 to the character's code point). Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=rawtext-end-tag-name-state&gt;&lt;span class=secno&gt;9.2.4.15 &lt;/span&gt;&lt;dfn&gt;RAWTEXT end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and Script data) end tag name state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#before-attribute-name-state&gt;before attribute name
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#self-closing-start-tag-state&gt;self-closing start tag
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then emit the current tag token and switch to the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#rawtext-end-tag-name-state&gt;RAWTEXT end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
+   in the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-less-than-sign-state&gt;&lt;span class=secno&gt;9.2.4.16 &lt;/span&gt;&lt;dfn&gt;Script data less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; to the empty string. Switch
+   to the &lt;a href=#script-data-end-tag-open-state&gt;script data end tag open state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and a U+0021
+   EXCLAMATION MARK character token. Switch to the &lt;a href=#script-data-escape-start-state&gt;script data
+   escape start state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the &lt;a href=#script-data-state&gt;script data
+   state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-end-tag-open-state&gt;&lt;span class=secno&gt;9.2.4.17 &lt;/span&gt;&lt;dfn&gt;Script data end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and RAWTEXT) end tag open state, except s/RCDATA/Script data/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add
+   0x0020 to the character's code point). Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#script-data-end-tag-name-state&gt;script data end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Append the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Finally,
+   switch to the &lt;a href=#script-data-end-tag-name-state&gt;script data end tag name state&lt;/a&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; in the &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-end-tag-name-state&gt;&lt;span class=secno&gt;9.2.4.18 &lt;/span&gt;&lt;dfn&gt;Script data end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and RAWTEXT) end tag name state, except s/RCDATA/Script data/g --&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#before-attribute-name-state&gt;before attribute name
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then switch to the &lt;a href=#self-closing-start-tag-state&gt;self-closing start tag
+   state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;a href=#appropriate-end-tag-token&gt;appropriate end tag
+   token&lt;/a&gt;, then emit the current tag token and switch to the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#script-data-end-tag-name-state&gt;Script data end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   tag token's tag name. Append the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt;. Stay in the
+   &lt;a href=#script-data-end-tag-name-state&gt;Script data end tag name state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;&lt;a href=#temporary-buffer&gt;temporary buffer&lt;/a&gt;&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
+   in the &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escape-start-state&gt;&lt;span class=secno&gt;9.2.4.19 &lt;/span&gt;&lt;dfn&gt;Script data escape start state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escape-start-dash-state&gt;script data escape start dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
+   &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escape-start-dash-state&gt;&lt;span class=secno&gt;9.2.4.20 &lt;/span&gt;&lt;dfn&gt;Script data escape start dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escaped-dash-dash-state&gt;script data escaped dash dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Reconsume the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; in the
+   &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escaped-state&gt;&lt;span class=secno&gt;9.2.4.21 &lt;/span&gt;&lt;dfn&gt;Script data escaped state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escaped-dash-state&gt;script data escaped dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Stay in
+   the &lt;a href=#script-data-escaped-state&gt;script data escaped state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escaped-dash-state&gt;&lt;span class=secno&gt;9.2.4.22 &lt;/span&gt;&lt;dfn&gt;Script data escaped dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;a href=#script-data-escaped-dash-dash-state&gt;script data escaped dash dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Switch
+   to the &lt;a href=#script-data-escaped-state&gt;script data escaped state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=script-data-escaped-dash-dash-state&gt;&lt;span class=secno&gt;9.2.4.23 &lt;/span&gt;&lt;dfn&gt;Script data escaped dash dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Stay in the
+   &lt;a href=#script-data-escaped-dash-dash-state&gt;script data escaped dash dash state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003E GREATER-THAN SIGN character token. Switch to the
+   &lt;a href=#script-data-state&gt;script data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the EOF character in the
+   &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Switch
+   to the &lt;a href=#script-data-escaped-state&gt;script data escaped state&lt;/a&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;h5 id=before-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.24 &lt;/span&gt;&lt;dfn&gt;Before attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
+
+  &lt;dl class=switch&gt;&lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
    &lt;dd&gt;Stay in the &lt;a href=#before-attribute-name-state&gt;before attribute name state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
@@ -61744,7 +62072,7 @@
    the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.7 &lt;/span&gt;&lt;dfn&gt;Attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.25 &lt;/span&gt;&lt;dfn&gt;Attribute name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61766,9 +62094,9 @@
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
-   (add 0x0020 to the character's code point) to the current
-   attribute's name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current attribute's name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
@@ -61782,8 +62110,9 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's name. Stay in the &lt;a href=#attribute-name-state&gt;attribute name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;&lt;p&gt;When the user agent leaves the attribute name state (and before
   emitting the tag token, if appropriate), the complete attribute's
@@ -61794,7 +62123,7 @@
   associated with it (if any).&lt;/p&gt;
 
 
-  &lt;h5 id=after-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.8 &lt;/span&gt;&lt;dfn&gt;After attribute name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=after-attribute-name-state&gt;&lt;span class=secno&gt;9.2.4.26 &lt;/span&gt;&lt;dfn&gt;After attribute name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61817,10 +62146,10 @@
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Start a new attribute in the current tag token. Set that
-   attribute's name to the lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;
-   (add 0x0020 to the character's code point), and its value to
-   the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
-   state&lt;/a&gt;.&lt;/dd&gt;
+   attribute's name to the lowercase version of the &lt;a href=#current-input-character&gt;current
+   input character&lt;/a&gt; (add 0x0020 to the character's code point),
+   and its value to the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute
+   name state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
    &lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
@@ -61834,11 +62163,11 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Start a new attribute in the current tag token. Set that
-   attribute's name to the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, and its value to
-   the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
+   attribute's name to the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;, and
+   its value to the empty string. Switch to the &lt;a href=#attribute-name-state&gt;attribute name
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.9 &lt;/span&gt;&lt;dfn&gt;Before attribute value state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.27 &lt;/span&gt;&lt;dfn&gt;Before attribute value state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61854,7 +62183,7 @@
 
    &lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
    &lt;dd&gt;Switch to the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted) state&lt;/a&gt;
-   and reconsume this input character.&lt;/dd&gt;
+   and reconsume this &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
    &lt;dd&gt;Switch to the &lt;a href=#attribute-value-(single-quoted)-state&gt;attribute value (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
@@ -61878,7 +62207,7 @@
    attribute's value. Switch to the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted)
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.10 &lt;/span&gt;&lt;dfn&gt;Attribute value (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-value-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.28 &lt;/span&gt;&lt;dfn&gt;Attribute value (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61896,11 +62225,11 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   value. Stay in the &lt;a href=#attribute-value-(double-quoted)-state&gt;attribute value (double-quoted)
-   state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's value. Stay in the &lt;a href=#attribute-value-(double-quoted)-state&gt;attribute value
+   (double-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.11 &lt;/span&gt;&lt;dfn&gt;Attribute value (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-value-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.29 &lt;/span&gt;&lt;dfn&gt;Attribute value (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61918,11 +62247,11 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   value. Stay in the &lt;a href=#attribute-value-(single-quoted)-state&gt;attribute value (single-quoted)
-   state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's value. Stay in the &lt;a href=#attribute-value-(single-quoted)-state&gt;attribute value
+   (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;9.2.4.12 &lt;/span&gt;&lt;dfn&gt;Attribute value (unquoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=attribute-value-(unquoted)-state&gt;&lt;span class=secno&gt;9.2.4.30 &lt;/span&gt;&lt;dfn&gt;Attribute value (unquoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61955,11 +62284,11 @@
    &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current attribute's
-   value. Stay in the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted)
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   attribute's value. Stay in the &lt;a href=#attribute-value-(unquoted)-state&gt;attribute value (unquoted)
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.13 &lt;/span&gt;&lt;dfn&gt;Character reference in attribute value state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=character-reference-in-attribute-value-state&gt;&lt;span class=secno&gt;9.2.4.31 &lt;/span&gt;&lt;dfn&gt;Character reference in attribute value state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Attempt to &lt;a href=#consume-a-character-reference&gt;consume a character reference&lt;/a&gt;.&lt;/p&gt;
 
@@ -61973,7 +62302,7 @@
   in when were switched into this state.&lt;/p&gt;
 
 
-  &lt;h5 id=after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;9.2.4.14 &lt;/span&gt;&lt;dfn&gt;After attribute value (quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=after-attribute-value-(quoted)-state&gt;&lt;span class=secno&gt;9.2.4.32 &lt;/span&gt;&lt;dfn&gt;After attribute value (quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -61999,7 +62328,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the character in
    the &lt;a href=#before-attribute-name-state&gt;before attribute name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=self-closing-start-tag-state&gt;&lt;span class=secno&gt;9.2.4.15 &lt;/span&gt;&lt;dfn&gt;Self-closing start tag state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=self-closing-start-tag-state&gt;&lt;span class=secno&gt;9.2.4.33 &lt;/span&gt;&lt;dfn&gt;Self-closing start tag state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62016,11 +62345,8 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the character in
    the &lt;a href=#before-attribute-name-state&gt;before attribute name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=bogus-comment-state&gt;&lt;span class=secno&gt;9.2.4.16 &lt;/span&gt;&lt;dfn&gt;Bogus comment state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=bogus-comment-state&gt;&lt;span class=secno&gt;9.2.4.34 &lt;/span&gt;&lt;dfn&gt;Bogus comment state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;Consume every character up to and including the first U+003E
   GREATER-THAN SIGN character (&gt;) or the end of the file (EOF),
   whichever comes first. Emit a comment token whose data is the
@@ -62037,11 +62363,8 @@
   character.&lt;/p&gt;
 
 
-  &lt;h5 id=markup-declaration-open-state&gt;&lt;span class=secno&gt;9.2.4.17 &lt;/span&gt;&lt;dfn&gt;Markup declaration open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=markup-declaration-open-state&gt;&lt;span class=secno&gt;9.2.4.35 &lt;/span&gt;&lt;dfn&gt;Markup declaration open state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;If the next two characters are both U+002D HYPHEN-MINUS (-)
   characters, consume those two characters, create a comment token
   whose data is the empty string, and switch to the &lt;a href=#comment-start-state&gt;comment
@@ -62065,7 +62388,7 @@
   comment.&lt;/p&gt;
 
 
-  &lt;h5 id=comment-start-state&gt;&lt;span class=secno&gt;9.2.4.18 &lt;/span&gt;&lt;dfn&gt;Comment start state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5 id=comment-start-state&gt;&lt;span class=secno&gt;9.2.4.36 &lt;/span&gt;&lt;dfn&gt;Comment start state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62082,10 +62405,10 @@
    the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's
-   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment
+   token's data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-start-dash-state&gt;&lt;span class=secno&gt;9.2.4.19 &lt;/span&gt;&lt;dfn&gt;Comment start dash state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-start-dash-state&gt;&lt;span class=secno&gt;9.2.4.37 &lt;/span&gt;&lt;dfn&gt;Comment start dash state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62102,11 +62425,11 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the input
-   character to the comment token's data. Switch to the
-   &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's
+   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-state&gt;&lt;span class=secno&gt;9.2.4.20 &lt;/span&gt;&lt;dfn id=comment&gt;Comment state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-state&gt;&lt;span class=secno&gt;9.2.4.38 &lt;/span&gt;&lt;dfn id=comment&gt;Comment state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62119,10 +62442,10 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Stay
-   in the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment
+   token's data. Stay in the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-dash-state&gt;&lt;span class=secno&gt;9.2.4.21 &lt;/span&gt;&lt;dfn&gt;Comment end dash state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-dash-state&gt;&lt;span class=secno&gt;9.2.4.39 &lt;/span&gt;&lt;dfn&gt;Comment end dash state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62135,11 +62458,11 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the input
-   character to the comment token's data. Switch to the
-   &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the
+   &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's
+   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-state&gt;&lt;span class=secno&gt;9.2.4.22 &lt;/span&gt;&lt;dfn&gt;Comment end state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-state&gt;&lt;span class=secno&gt;9.2.4.40 &lt;/span&gt;&lt;dfn&gt;Comment end state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62153,8 +62476,9 @@
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Append two U+002D HYPHEN-MINUS (-)
-   characters and the input character to the comment token's
-   data. Switch to the &lt;a href=#comment-end-space-state&gt;comment end space state&lt;/a&gt;.&lt;/dd&gt;
+   characters and the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the
+   comment token's data. Switch to the &lt;a href=#comment-end-space-state&gt;comment end space
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Switch to the &lt;a href=#comment-end-bang-state&gt;comment end bang
@@ -62175,10 +62499,11 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Append two U+002D HYPHEN-MINUS (-)
-   characters and the input character to the comment token's
-   data. Switch to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
+   characters and the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the
+   comment token's data. Switch to the &lt;a href=#comment-state&gt;comment
+   state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-bang-state&gt;&lt;span class=secno&gt;9.2.4.23 &lt;/span&gt;&lt;dfn&gt;Comment end bang state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-bang-state&gt;&lt;span class=secno&gt;9.2.4.41 &lt;/span&gt;&lt;dfn&gt;Comment end bang state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62198,11 +62523,11 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Append two U+002D HYPHEN-MINUS (-) characters, a U+0021
-   EXCLAMATION MARK character (!), and the input character to the
-   comment token's data. Switch to the &lt;a href=#comment-state&gt;comment
-   state&lt;/a&gt;.&lt;/dd&gt;
+   EXCLAMATION MARK character (!), and the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; to the comment token's data. Switch to the
+   &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=comment-end-space-state&gt;&lt;span class=secno&gt;9.2.4.24 &lt;/span&gt;&lt;dfn&gt;Comment end space state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=comment-end-space-state&gt;&lt;span class=secno&gt;9.2.4.42 &lt;/span&gt;&lt;dfn&gt;Comment end space state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62211,7 +62536,7 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Stay in
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's data. Stay in
    the &lt;a href=#comment-end-space-state&gt;comment end space state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
@@ -62227,10 +62552,10 @@
    comment in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Switch
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the comment token's data. Switch
    to the &lt;a href=#comment-state&gt;comment state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-state&gt;&lt;span class=secno&gt;9.2.4.25 &lt;/span&gt;&lt;dfn&gt;DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-state&gt;&lt;span class=secno&gt;9.2.4.43 &lt;/span&gt;&lt;dfn&gt;DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62250,7 +62575,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the current
    character in the &lt;a href=#before-doctype-name-state&gt;before DOCTYPE name state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.26 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.44 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62263,7 +62588,7 @@
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Create a new DOCTYPE token. Set the token's name to the
-   lowercase version of the input character (add 0x0020 to the
+   lowercase version of the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; (add 0x0020 to the
    character's code point). Switch to the &lt;a href=#doctype-name-state&gt;DOCTYPE name
    state&lt;/a&gt;.&lt;/dd&gt;
 
@@ -62282,7 +62607,7 @@
    &lt;a href=#current-input-character&gt;current input character&lt;/a&gt;. Switch to the &lt;a href=#doctype-name-state&gt;DOCTYPE name
    state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.27 &lt;/span&gt;&lt;dfn&gt;DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.45 &lt;/span&gt;&lt;dfn&gt;DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62298,9 +62623,10 @@
    state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the input character (add 0x0020
-   to the character's code point) to the current DOCTYPE token's
-   name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;a href=#current-input-character&gt;current input
+   character&lt;/a&gt; (add 0x0020 to the character's code point) to the
+   current DOCTYPE token's name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
@@ -62308,10 +62634,11 @@
    Reconsume the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current DOCTYPE
-   token's name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   DOCTYPE token's name. Stay in the &lt;a href=#doctype-name-state&gt;DOCTYPE name
+   state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.28 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-name-state&gt;&lt;span class=secno&gt;9.2.4.46 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62351,7 +62678,7 @@
 
    &lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;9.2.4.29 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public keyword state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-public-keyword-state&gt;&lt;span class=secno&gt;9.2.4.47 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public keyword state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62372,7 +62699,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the current character in
    the &lt;a href=#before-doctype-public-identifier-state&gt;before DOCTYPE public identifier state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.30 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.48 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62408,7 +62735,7 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.31 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.49 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62430,7 +62757,7 @@
    token's public identifier. Stay in the &lt;a href=#doctype-public-identifier-(double-quoted)-state&gt;DOCTYPE public
    identifier (double-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.32 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-public-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.50 &lt;/span&gt;&lt;dfn&gt;DOCTYPE public identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62452,7 +62779,7 @@
    token's public identifier. Stay in the &lt;a href=#doctype-public-identifier-(single-quoted)-state&gt;DOCTYPE public
    identifier (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.33 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-public-identifier-state&gt;&lt;span class=secno&gt;9.2.4.51 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE public identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62461,7 +62788,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system identifiers state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system
+   identifiers state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;a href=#data-state&gt;data
@@ -62487,7 +62815,7 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;9.2.4.34 &lt;/span&gt;&lt;dfn&gt;Between DOCTYPE public and system identifiers state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=between-doctype-public-and-system-identifiers-state&gt;&lt;span class=secno&gt;9.2.4.52 &lt;/span&gt;&lt;dfn&gt;Between DOCTYPE public and system identifiers state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62496,7 +62824,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Stay in the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system identifiers state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Stay in the &lt;a href=#between-doctype-public-and-system-identifiers-state&gt;between DOCTYPE public and system identifiers
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;a href=#data-state&gt;data
@@ -62522,7 +62851,7 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;9.2.4.35 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system keyword state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-system-keyword-state&gt;&lt;span class=secno&gt;9.2.4.53 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system keyword state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62543,7 +62872,7 @@
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Reconsume the current character in
    the &lt;a href=#before-doctype-system-identifier-state&gt;before DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.36 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=before-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.54 &lt;/span&gt;&lt;dfn&gt;Before DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62579,12 +62908,13 @@
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;. Switch to the &lt;a href=#bogus-doctype-state&gt;bogus
    DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.37 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(double-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.55 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (double-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
@@ -62597,16 +62927,17 @@
    Reconsume the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current DOCTYPE
-   token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;DOCTYPE system
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   DOCTYPE token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(double-quoted)-state&gt;DOCTYPE system
    identifier (double-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.38 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=doctype-system-identifier-(single-quoted)-state&gt;&lt;span class=secno&gt;9.2.4.56 &lt;/span&gt;&lt;dfn&gt;DOCTYPE system identifier (single-quoted) state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
   &lt;dl class=switch&gt;&lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;a href=#parse-error&gt;Parse error&lt;/a&gt;. Set the DOCTYPE token's
@@ -62619,11 +62950,11 @@
    Reconsume the EOF character in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current DOCTYPE
-   token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;DOCTYPE system
+   &lt;dd&gt;Append the &lt;a href=#current-input-character&gt;current input character&lt;/a&gt; to the current
+   DOCTYPE token's system identifier. Stay in the &lt;a href=#doctype-system-identifier-(single-quoted)-state&gt;DOCTYPE system
    identifier (single-quoted) state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.39 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=after-doctype-system-identifier-state&gt;&lt;span class=secno&gt;9.2.4.57 &lt;/span&gt;&lt;dfn&gt;After DOCTYPE system identifier state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62632,7 +62963,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Stay in the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier state&lt;/a&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Stay in the &lt;a href=#after-doctype-system-identifier-state&gt;after DOCTYPE system identifier
+   state&lt;/a&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;a href=#data-state&gt;data
@@ -62648,7 +62980,7 @@
    state&lt;/a&gt;. (This does &lt;em&gt;not&lt;/em&gt; set the DOCTYPE token's
    &lt;i&gt;force-quirks flag&lt;/i&gt; to &lt;i&gt;on&lt;/i&gt;.)&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=bogus-doctype-state&gt;&lt;span class=secno&gt;9.2.4.40 &lt;/span&gt;&lt;dfn&gt;Bogus DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=bogus-doctype-state&gt;&lt;span class=secno&gt;9.2.4.58 &lt;/span&gt;&lt;dfn&gt;Bogus DOCTYPE state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;a href=#next-input-character&gt;next input character&lt;/a&gt;:&lt;/p&gt;
 
@@ -62663,11 +62995,8 @@
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Stay in the &lt;a href=#bogus-doctype-state&gt;bogus DOCTYPE state&lt;/a&gt;.&lt;/dd&gt;
 
-  &lt;/dl&gt;&lt;h5 id=cdata-section-state&gt;&lt;span class=secno&gt;9.2.4.41 &lt;/span&gt;&lt;dfn&gt;CDATA section state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;/dl&gt;&lt;h5 id=cdata-section-state&gt;&lt;span class=secno&gt;9.2.4.59 &lt;/span&gt;&lt;dfn&gt;CDATA section state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;a href=#content-model-flag&gt;content model
-  flag&lt;/a&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;Consume every character up to the next occurrence of the three
   character sequence U+005D RIGHT SQUARE BRACKET U+005D RIGHT SQUARE
   BRACKET U+003E GREATER-THAN SIGN (&lt;code title=&quot;&quot;&gt;]]&gt;&lt;/code&gt;), or the
@@ -62683,7 +63012,7 @@
 
 
 
-  &lt;h5 id=tokenizing-character-references&gt;&lt;span class=secno&gt;9.2.4.42 &lt;/span&gt;Tokenizing character references&lt;/h5&gt;
+  &lt;h5 id=tokenizing-character-references&gt;&lt;span class=secno&gt;9.2.4.60 &lt;/span&gt;Tokenizing character references&lt;/h5&gt;
 
   &lt;p&gt;This section defines how to &lt;dfn id=consume-a-character-reference&gt;consume a character
   reference&lt;/dfn&gt;. This definition is used when parsing character
@@ -63130,11 +63459,10 @@
   &lt;ol&gt;&lt;li&gt;&lt;p&gt;&lt;a href=#insert-an-html-element&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the algorithm that was invoked is the &lt;a href=#generic-raw-text-element-parsing-algorithm&gt;generic raw
-   text element parsing algorithm&lt;/a&gt;, switch the tokenizer's
-   &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the RAWTEXT state; otherwise the
-   algorithm invoked was the &lt;a href=#generic-rcdata-element-parsing-algorithm&gt;generic RCDATA element parsing
-   algorithm&lt;/a&gt;, switch the tokenizer's &lt;a href=#content-model-flag&gt;content model
-   flag&lt;/a&gt; to the RCDATA state.&lt;/li&gt;
+   text element parsing algorithm&lt;/a&gt;, switch the tokenizer to the
+   &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;; otherwise the algorithm invoked
+   was the &lt;a href=#generic-rcdata-element-parsing-algorithm&gt;generic RCDATA element parsing algorithm&lt;/a&gt;,
+   switch the tokenizer to the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let the &lt;a href=#original-insertion-mode&gt;original insertion mode&lt;/a&gt; be the current
    &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
@@ -63648,8 +63976,8 @@
      and push it onto the &lt;a href=#stack-of-open-elements&gt;stack of open
      elements&lt;/a&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Switch the tokenizer's &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-     the RAWTEXT state.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Switch the tokenizer to the &lt;a href=#script-data-state&gt;script data
+     state&lt;/a&gt;.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;a href=#original-insertion-mode&gt;original insertion mode&lt;/a&gt; be the current
      &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
@@ -64188,14 +64516,12 @@
 
     &lt;p&gt;&lt;a href=#insert-an-html-element&gt;Insert an HTML element&lt;/a&gt; for the token.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the PLAINTEXT
-    state.&lt;/p&gt;
+    &lt;p&gt;Switch the tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;p class=note&gt;Once a start tag with the tag name &quot;plaintext&quot;
-    has been seen, that will be the last token ever seen other
-    than character tokens (and the end-of-file token), because
-    there is no way to switch the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt;
-    out of the PLAINTEXT state.&lt;/p&gt;
+    &lt;p class=note&gt;Once a start tag with the tag name &quot;plaintext&quot; has
+    been seen, that will be the last token ever seen other than
+    character tokens (and the end-of-file token), because there is no
+    way to switch out of the &lt;a href=#plaintext-state&gt;PLAINTEXT state&lt;/a&gt;.&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -64791,8 +65117,8 @@
      one. (Newlines at the start of &lt;code&gt;&lt;a href=#the-textarea-element&gt;textarea&lt;/a&gt;&lt;/code&gt; elements are
      ignored as an authoring convenience.)&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Switch the tokenizer's &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-     the RCDATA state.&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Switch the tokenizer to the the &lt;a href=#rcdata-state&gt;RCDATA
+     state&lt;/a&gt;.&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;a href=#original-insertion-mode&gt;original insertion mode&lt;/a&gt; be the
      current &lt;a href=#insertion-mode&gt;insertion mode&lt;/a&gt;.&lt;/p&gt;
@@ -67154,42 +67480,38 @@
 
     &lt;ol&gt;&lt;li&gt;
 
-      &lt;p&gt;Set the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s &lt;a href=#tokenization&gt;tokenization&lt;/a&gt;
-      stage's &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; according to the &lt;var title=&quot;&quot;&gt;context&lt;/var&gt; element, as follows:&lt;/p&gt;
+      &lt;p&gt;Set the state of the &lt;a href=#html-parser&gt;HTML parser&lt;/a&gt;'s
+      &lt;a href=#tokenization&gt;tokenization&lt;/a&gt; stage as follows:&lt;/p&gt;
 
       &lt;dl class=switch&gt;&lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#the-title-element-0&gt;title&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a href=#the-textarea-element&gt;textarea&lt;/a&gt;&lt;/code&gt;
        element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-       the RCDATA state.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;a href=#rcdata-state&gt;RCDATA state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#the-style-element&gt;style&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#script&gt;script&lt;/a&gt;&lt;/code&gt;,
        &lt;code&gt;&lt;a href=#xmp&gt;xmp&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#the-iframe-element&gt;iframe&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href=#noembed&gt;noembed&lt;/a&gt;&lt;/code&gt;, or
        &lt;code&gt;&lt;a href=#noframes&gt;noframes&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-       the RAWTEXT state.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#the-noscript-element&gt;noscript&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;If the &lt;a href=#scripting-flag&gt;scripting flag&lt;/a&gt; is enabled, set the
-       &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the RAWTEXT
-       state. Otherwise, set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to the
-       PCDATA state.&lt;/dd&gt;
+       &lt;dd&gt;If the &lt;a href=#scripting-flag&gt;scripting flag&lt;/a&gt; is enabled, switch the
+       tokenizer to the &lt;a href=#rawtext-state&gt;RAWTEXT state&lt;/a&gt;.  Otherwise,
+       leave the tokenizer in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;&lt;a href=#plaintext&gt;plaintext&lt;/a&gt;&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; to
-       PLAINTEXT.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;a href=#plaintext-state&gt;PLAINTEXT
+       state&lt;/a&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;Otherwise&lt;/dt&gt;
 
-       &lt;dd&gt;Leave the &lt;a href=#content-model-flag&gt;content model flag&lt;/a&gt; in the PCDATA
-       state.&lt;/dd&gt;
+       &lt;dd&gt;Leave the tokenizer in the &lt;a href=#data-state&gt;data state&lt;/a&gt;.&lt;/dd&gt;
 
       &lt;/dl&gt;&lt;/li&gt;
 

Modified: source
===================================================================
--- source	2009-10-19 05:52:18 UTC (rev 4176)
+++ source	2009-10-19 11:00:31 UTC (rev 4177)
@@ -9981,9 +9981,9 @@
     &lt;p&gt;If &lt;var title=&quot;&quot;&gt;type&lt;/var&gt; is &lt;em&gt;not&lt;/em&gt; now an &lt;span&gt;ASCII
     case-insensitive&lt;/span&gt; match for the string
     &quot;&lt;code&gt;text/html&lt;/code&gt;&quot;, then act as if the tokenizer had emitted
-    a start tag token with the tag name &quot;pre&quot;, then set the &lt;span&gt;HTML
-    parser&lt;/span&gt;'s &lt;span&gt;tokenization&lt;/span&gt; stage's &lt;span&gt;content
-    model flag&lt;/span&gt; to &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;.&lt;/p&gt;
+    a start tag token with the tag name &quot;pre&quot;, then switch the
+    &lt;span&gt;HTML parser&lt;/span&gt;'s tokenizer to the &lt;span&gt;PLAINTEXT
+    state&lt;/span&gt;.&lt;/p&gt;
 
     &lt;!--
  <A HREF="http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%3E%3C%2Fiframe%3E%3Cscript%3Eonload%20%3D%20function%20(">http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E...%3Ciframe%3E%3C%2Fiframe%3E%3Cscript%3Eonload%20%3D%20function%20(</A>)%20%7B%20%0D%0A%20%20var%20d%20%3D%20document.getElementsByTagName('iframe')%5B0%5D.contentDocument%3B%0D%0A%20%20d.open('image%2Fsvg%2Bxml')%3B%0D%0A%20%20d.write(%22%3Cinput%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml'%20value%3D'(x)html'%2F%3E%22)%3B%0D%0A%20%20d.close()%3B%0D%0A%7D%3B%3C%2Fscript%3E
@@ -62932,9 +62932,9 @@
   &lt;code&gt;Document&lt;/code&gt; object&lt;/span&gt;, mark it as being an &lt;span
   title=&quot;HTML documents&quot;&gt;HTML document&lt;/span&gt;, create an &lt;span&gt;HTML
   parser&lt;/span&gt;, associate it with the document, act as if the
-  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;, set
-  the &lt;span&gt;tokenization&lt;/span&gt; stage's &lt;span&gt;content model
-  flag&lt;/span&gt; to &lt;i title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;, and begin to pass the stream of
+  tokenizer had emitted a start tag token with the tag name &quot;pre&quot;,
+  switch the &lt;span&gt;HTML parser&lt;/span&gt;'s tokenizer to the
+  &lt;span&gt;PLAINTEXT state&lt;/span&gt;, and begin to pass the stream of
   characters in the plain text document to that tokenizer.&lt;/p&gt;
 
   &lt;p&gt;The rules for how to convert the bytes of the plain text document
@@ -79210,18 +79210,13 @@
   switches it to a new state (to consume the next character), or
   repeats the same state (to consume the next character). Some states
   have more complicated behavior and can consume several characters
-  before switching to another state.&lt;/p&gt;
+  before switching to another state. In some cases, the tokenizer
+  state is also changed by the tree construction stage.&lt;/p&gt;
 
-  &lt;p&gt;The exact behavior of certain states depends on a &lt;dfn&gt;content
-  model flag&lt;/dfn&gt; that is set after certain tokens are emitted. The
-  flag has several states: &lt;i title=&quot;&quot;&gt;PCDATA&lt;/i&gt;, &lt;i
-  title=&quot;&quot;&gt;RCDATA&lt;/i&gt;, &lt;i title=&quot;&quot;&gt;RAWTEXT&lt;/i&gt;, and &lt;i
-  title=&quot;&quot;&gt;PLAINTEXT&lt;/i&gt;. Initially, it must be in the PCDATA
-  state. In the RCDATA and RAWTEXT states, a further &lt;dfn&gt;escape
-  flag&lt;/dfn&gt; is used to control the behavior of the tokenizer. It is
-  either true or false, and initially must be set to the false
-  state. The &lt;span&gt;insertion mode&lt;/span&gt; and the &lt;span&gt;stack of open
-  elements&lt;/span&gt; also affects tokenization.&lt;/p&gt;
+  &lt;p&gt;The exact behavior of certain states depends on the
+  &lt;span&gt;insertion mode&lt;/span&gt; and the &lt;span&gt;stack of open
+  elements&lt;/span&gt;. Certain states also use a &lt;dfn&gt;&lt;var&gt;temporary
+  buffer&lt;/var&gt;&lt;/dfn&gt; to track progress.&lt;/p&gt;
 
   &lt;p&gt;The output of the tokenization step is a series of zero or more
   of the following tokens: DOCTYPE, start tag, end tag, comment,
@@ -79240,8 +79235,8 @@
 
   &lt;p&gt;When a token is emitted, it must immediately be handled by the
   &lt;span&gt;tree construction&lt;/span&gt; stage. The tree construction stage
-  can affect the state of the &lt;span&gt;content model flag&lt;/span&gt;, and can
-  insert additional characters into the stream. (For example, the
+  can affect the state of the tokenization stage, and can insert
+  additional characters into the stream. (For example, the
   &lt;code&gt;script&lt;/code&gt; element can result in scripts executing and
   using the &lt;span&gt;dynamic markup insertion&lt;/span&gt; APIs to insert
   characters into the stream being tokenized.)&lt;/p&gt;
@@ -79251,15 +79246,18 @@
   self-closing flag&quot;&gt;acknowledged&lt;/dfn&gt; when it is processed by the
   tree construction stage, that is a &lt;span&gt;parse error&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;When an end tag token is emitted, the &lt;span&gt;content model
-  flag&lt;/span&gt; must be switched to the PCDATA state.&lt;/p&gt;
-
   &lt;p&gt;When an end tag token is emitted with attributes, that is a
   &lt;span&gt;parse error&lt;/span&gt;.&lt;/p&gt;
 
   &lt;p&gt;When an end tag token is emitted with its &lt;i&gt;self-closing
   flag&lt;/i&gt; set, that is a &lt;span&gt;parse error&lt;/span&gt;.&lt;/p&gt;
 
+  &lt;p&gt;An &lt;dfn&gt;appropriate end tag token&lt;/dfn&gt; is an end tag token whose
+  tag name matches the tag name of the last start tag to have been
+  emitted from this tokenizer, if any. If no start tag has been
+  emitted from this tokenizer, then no end tag token is
+  appropriate.&lt;/p&gt;
+
   &lt;p&gt;Before each step of the tokenizer, the user agent must first
   check the &lt;span&gt;parser pause flag&lt;/span&gt;. If it is true, then the
   tokenizer must abort the processing of any nested invocations of the
@@ -79268,9 +79266,11 @@
   &lt;p&gt;The tokenizer state machine consists of the states defined in the
   following subsections.&lt;/p&gt;
 
+
   &lt;!-- Order of the lists below is supposed to be non-error then
   error, by unicode, then EOF, ending with &quot;anything else&quot; --&gt;
 
+
   &lt;h5&gt;&lt;dfn&gt;Data state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
@@ -79278,196 +79278,172 @@
   &lt;dl class=&quot;switch&quot;&gt;
 
    &lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
-   &lt;dd&gt;When the &lt;span&gt;content model flag&lt;/span&gt; is set to one of the
-   PCDATA or RCDATA states and the &lt;span&gt;escape flag&lt;/span&gt; is
-   false: switch to the &lt;span&gt;character reference in data
+   &lt;dd&gt;Switch to the &lt;span&gt;character reference in data
    state&lt;/span&gt;.&lt;/dd&gt;
-   &lt;dd&gt;Otherwise: treat it as per the &quot;anything else&quot; entry
-   below.&lt;/dd&gt;
 
-   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
-   &lt;dd&gt;
+   &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;tag open state&lt;/span&gt;.&lt;/dd&gt;
 
-    &lt;p&gt;If the &lt;span&gt;content model flag&lt;/span&gt; is set to either the
-    RCDATA state or the RAWTEXT state, and the &lt;span&gt;escape flag&lt;/span&gt;
-    is false, and there are at least three characters before this
-    one in the input stream, and the last four characters in the
-    input stream, including this one, are U+003C LESS-THAN SIGN,
-    U+0021 EXCLAMATION MARK, U+002D HYPHEN-MINUS, and U+002D
-    HYPHEN-MINUS (&quot;&lt;!--&quot;), then set the &lt;span&gt;escape flag&lt;/span&gt;
-    to true.&lt;/p&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-    &lt;p&gt;In any case, emit the input character as a character
-    token. Stay in the &lt;span&gt;data state&lt;/span&gt;.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;span&gt;current input character&lt;/span&gt; as a character
+   token. Stay in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
-   &lt;/dd&gt;
+  &lt;/dl&gt;
 
+
+  &lt;h5&gt;&lt;dfn&gt;RCDATA state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;character reference in data
+   state&lt;/span&gt;.&lt;/dd&gt;
+
    &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
-   &lt;dd&gt;When the &lt;span&gt;content model flag&lt;/span&gt; is set to the PCDATA
-   state: switch to the &lt;span&gt;tag open state&lt;/span&gt;.&lt;/dd&gt;
-   &lt;dd&gt;When the &lt;span&gt;content model flag&lt;/span&gt; is set to either the
-   RCDATA state or the RAWTEXT state, and the &lt;span&gt;escape flag&lt;/span&gt;
-   is false: switch to the &lt;span&gt;tag open state&lt;/span&gt;.&lt;/dd&gt;
-   &lt;dd&gt;Otherwise: treat it as per the &quot;anything else&quot; entry
-   below.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;RCDATA less-than sign state&lt;/span&gt;.&lt;/dd&gt;
 
-   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
-   &lt;dd&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-    &lt;p&gt;If the &lt;span&gt;content model flag&lt;/span&gt; is set to either the
-    RCDATA state or the RAWTEXT state, and the &lt;span&gt;escape
-    flag&lt;/span&gt; is true, and the last three characters in the input
-    stream including this one are U+002D HYPHEN-MINUS, U+002D
-    HYPHEN-MINUS, U+003E GREATER-THAN SIGN (&quot;--&gt;&quot;), set the
-    &lt;span&gt;escape flag&lt;/span&gt; to false.&lt;/p&gt; &lt;!-- no need to check
-    that there are enough characters, since you can only run into
-    this if the flag is true in the first place, which requires four
-    characters. --&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;span&gt;current input character&lt;/span&gt; as a character
+   token. Stay in the &lt;span&gt;RCDATA state&lt;/span&gt;.&lt;/dd&gt;
 
-    &lt;p&gt;In any case, emit the input character as a character
-    token. Stay in the &lt;span&gt;data state&lt;/span&gt;.&lt;/p&gt;
+  &lt;/dl&gt;
 
-   &lt;/dd&gt;
 
+  &lt;h5&gt;&lt;dfn&gt;RAWTEXT state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;RAWTEXT less-than sign state&lt;/span&gt;.&lt;/dd&gt;
+
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Emit the input character as a character token. Stay in the
-   &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Emit the &lt;span&gt;current input character&lt;/span&gt; as a character
+   token. Stay in the &lt;span&gt;RAWTEXT state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
 
-  &lt;h5&gt;&lt;dfn&gt;Character reference in data state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;h5&gt;&lt;dfn&gt;Script data state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This cannot happen if the &lt;span&gt;content model flag&lt;/span&gt;
-  is set to the RAWTEXT state.)&lt;/i&gt;&lt;/p&gt;
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
 
-  &lt;p&gt;Attempt to &lt;span&gt;consume a character reference&lt;/span&gt;, with no
-  &lt;span&gt;additional allowed character&lt;/span&gt;.&lt;/p&gt;
+  &lt;dl class=&quot;switch&quot;&gt;
 
-  &lt;p&gt;If nothing is returned, emit a U+0026 AMPERSAND character
-  token.&lt;/p&gt;
+   &lt;dt&gt;U+003C LESS-THAN SIGN (&lt;)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;script data less-than sign state&lt;/span&gt;.&lt;/dd&gt;
 
-  &lt;p&gt;Otherwise, emit the character token that was returned.&lt;/p&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-  &lt;p&gt;Finally, switch to the &lt;span&gt;data state&lt;/span&gt;.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;span&gt;current input character&lt;/span&gt; as a character
+   token. Stay in the &lt;span&gt;script data state&lt;/span&gt;.&lt;/dd&gt;
 
+  &lt;/dl&gt;
 
-  &lt;h5&gt;&lt;dfn&gt;Tag open state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;The behavior of this state depends on the &lt;span&gt;content model
-  flag&lt;/span&gt;.&lt;/p&gt;
+  &lt;h5&gt;&lt;dfn&gt;PLAINTEXT state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;dl&gt;
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
 
-   &lt;dt&gt;If the &lt;span&gt;content model flag&lt;/span&gt; is set to the RCDATA
-   or RAWTEXT states&lt;/dt&gt;
+  &lt;dl class=&quot;switch&quot;&gt;
 
-   &lt;dd&gt;
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;Emit an end-of-file token.&lt;/dd&gt;
 
-    &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;. If it is a
-    U+002F SOLIDUS character (/), switch to the &lt;span&gt;close tag open
-    state&lt;/span&gt;. Otherwise, emit a U+003C LESS-THAN SIGN character
-    token and reconsume the &lt;span&gt;current input character&lt;/span&gt; in the
-    &lt;span&gt;data state&lt;/span&gt;.&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the &lt;span&gt;current input character&lt;/span&gt; as a character
+   token. Stay in the &lt;span&gt;PLAINTEXT state&lt;/span&gt;.&lt;/dd&gt;
 
-   &lt;/dd&gt;
+  &lt;/dl&gt;
 
-   &lt;dt&gt;If the &lt;span&gt;content model flag&lt;/span&gt; is set to the PCDATA
-   state&lt;/dt&gt;
 
-   &lt;dd&gt;
+  &lt;h5&gt;&lt;dfn&gt;Character reference in data state&lt;/dfn&gt;&lt;/h5&gt;
 
-    &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+  &lt;p&gt;Attempt to &lt;span&gt;consume a character reference&lt;/span&gt;, with no
+  &lt;span&gt;additional allowed character&lt;/span&gt;.&lt;/p&gt;
 
-    &lt;dl class=&quot;switch&quot;&gt;
+  &lt;p&gt;If nothing is returned, emit a U+0026 AMPERSAND character
+  token.&lt;/p&gt;
 
-     &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
-     &lt;dd&gt;Switch to the &lt;span&gt;markup declaration open state&lt;/span&gt;.&lt;/dd&gt;
+  &lt;p&gt;Otherwise, emit the character token that was returned.&lt;/p&gt;
 
-     &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
-     &lt;dd&gt;Switch to the &lt;span&gt;close tag open state&lt;/span&gt;.&lt;/dd&gt;
+  &lt;p&gt;Finally, switch to the &lt;span&gt;data state&lt;/span&gt;.&lt;/p&gt;
 
-     &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-     &lt;dd&gt;Create a new start tag token, set its tag name to the
-     lowercase version of the input character (add 0x0020 to the
-     character's code point), then switch to the &lt;span&gt;tag name
-     state&lt;/span&gt;. (Don't emit the token yet; further details will
-     be filled in before it is emitted.)&lt;/dd&gt;
 
-     &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
-     &lt;dd&gt;Create a new start tag token, set its tag name to the input
-     character, then switch to the &lt;span&gt;tag name
-     state&lt;/span&gt;. (Don't emit the token yet; further details will
-     be filled in before it is emitted.)&lt;/dd&gt;
+  &lt;h5&gt;&lt;dfn&gt;Tag open state&lt;/dfn&gt;&lt;/h5&gt;
 
-     &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
-     &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Emit a U+003C LESS-THAN SIGN
-     character token and a U+003E GREATER-THAN SIGN character
-     token. Switch to the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
 
-     &lt;dt&gt;U+003F QUESTION MARK (?)&lt;/dt&gt;
-     &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Switch to the &lt;span&gt;bogus
-     comment state&lt;/span&gt;.&lt;/dd&gt;
+  &lt;dl class=&quot;switch&quot;&gt;
 
-     &lt;dt&gt;Anything else&lt;/dt&gt;
-     &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Emit a U+003C LESS-THAN SIGN
-     character token and reconsume the &lt;span&gt;current input character&lt;/span&gt; in the
-     &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;markup declaration open state&lt;/span&gt;.&lt;/dd&gt;
 
-    &lt;/dl&gt;
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;close tag open state&lt;/span&gt;.&lt;/dd&gt;
 
-   &lt;/dd&gt;
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new start tag token, set its tag name to the
+   lowercase version of the &lt;span&gt;current input character&lt;/span&gt; (add 0x0020 to the
+   character's code point), then switch to the &lt;span&gt;tag name
+   state&lt;/span&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
-  &lt;/dl&gt;
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new start tag token, set its tag name to the
+   &lt;span&gt;current input character&lt;/span&gt;, then switch to the &lt;span&gt;tag
+   name state&lt;/span&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Emit a U+003C LESS-THAN SIGN
+   character token and a U+003E GREATER-THAN SIGN character
+   token. Switch to the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
-  &lt;h5&gt;&lt;dfn&gt;Close tag open state&lt;/dfn&gt;&lt;/h5&gt;
+   &lt;dt&gt;U+003F QUESTION MARK (?)&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Switch to the &lt;span&gt;bogus
+   comment state&lt;/span&gt;.&lt;/dd&gt;
 
-  &lt;p&gt;If the &lt;span&gt;content model flag&lt;/span&gt; is set to the RCDATA or
-  RAWTEXT states but no start tag token has ever been emitted by this
-  instance of the tokenizer (&lt;span&gt;fragment case&lt;/span&gt;), or, if the
-  &lt;span&gt;content model flag&lt;/span&gt; is set to the RCDATA or RAWTEXT states
-  and the next few characters do not match the tag name of the last
-  start tag token emitted (compared in an &lt;span&gt;ASCII
-  case-insensitive&lt;/span&gt; manner), or if they do but they are not
-  immediately followed by one of the following characters:&lt;/p&gt;
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Emit a U+003C LESS-THAN SIGN
+   character token and reconsume the &lt;span&gt;current input
+   character&lt;/span&gt; in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
-  &lt;ul class=&quot;brief&quot;&gt;
-   &lt;li&gt;U+0009 CHARACTER TABULATION&lt;/li&gt;
-   &lt;li&gt;U+000A LINE FEED (LF)&lt;/li&gt;
-   &lt;li&gt;U+000C FORM FEED (FF)&lt;/li&gt;
-   &lt;!--&lt;li&gt;U+000D CARRIAGE RETURN (CR)&lt;/li&gt;--&gt;
-   &lt;li&gt;U+0020 SPACE&lt;/li&gt;
-   &lt;li&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/li&gt;
-   &lt;li&gt;U+002F SOLIDUS (/)&lt;/li&gt;
-   &lt;li&gt;EOF&lt;/li&gt;
-  &lt;/ul&gt;
+  &lt;/dl&gt;
 
-  &lt;p&gt;...then emit a U+003C LESS-THAN SIGN character token, a U+002F
-  SOLIDUS character token, and switch to the &lt;span&gt;data state&lt;/span&gt;
-  to process the &lt;span&gt;next input character&lt;/span&gt;.&lt;/p&gt;
 
-  &lt;p&gt;Otherwise, if the &lt;span&gt;content model flag&lt;/span&gt; is set to the
-  PCDATA state, or if the next few characters &lt;em&gt;do&lt;/em&gt; match that tag
-  name, consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+  &lt;h5&gt;&lt;dfn&gt;Close tag open state&lt;/dfn&gt;&lt;/h5&gt;
 
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
   &lt;dl class=&quot;switch&quot;&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Create a new end tag token, set its tag name to the lowercase
-   version of the input character (add 0x0020 to the character's
-   code point), then switch to the &lt;span&gt;tag name
+   version of the &lt;span&gt;current input character&lt;/span&gt; (add 0x0020 to
+   the character's code point), then switch to the &lt;span&gt;tag name
    state&lt;/span&gt;. (Don't emit the token yet; further details will be
    filled in before it is emitted.)&lt;/dd&gt;
 
    &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Create a new end tag token, set its tag name to the input
-   character, then switch to the &lt;span&gt;tag name state&lt;/span&gt;. (Don't
-   emit the token yet; further details will be filled in before it
-   is emitted.)&lt;/dd&gt;
+   &lt;dd&gt;Create a new end tag token, set its tag name to the
+   &lt;span&gt;current input character&lt;/span&gt;, then switch to the &lt;span&gt;tag
+   name state&lt;/span&gt;. (Don't emit the token yet; further details will
+   be filled in before it is emitted.)&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Switch to the &lt;span&gt;data
@@ -79506,21 +79482,436 @@
    state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input character&lt;/span&gt;
-   (add 0x0020 to the character's code point) to the current tag
-   token's tag name. Stay in the &lt;span&gt;tag name state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input
+   character&lt;/span&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Stay in the &lt;span&gt;tag name
+   state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Reconsume the EOF character in the
    &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current tag token's
-   tag name. Stay in the &lt;span&gt;tag name state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   tag token's tag name. Stay in the &lt;span&gt;tag name state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
 
+  &lt;h5&gt;&lt;dfn&gt;RCDATA less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT less-than sign state, except s/RAWTEXT/RCDATA/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;temporary buffer&lt;/var&gt; to the empty string. Switch
+   to the &lt;span&gt;RCDATA end tag open state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;span&gt;current input character&lt;/span&gt; in the &lt;span&gt;RCDATA
+   state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;RCDATA end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT (and Script data) end tag open state, except s/RAWTEXT/RCDATA/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;span&gt;current input character&lt;/span&gt; (add
+   0x0020 to the character's code point). Append the &lt;span&gt;current
+   input character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Finally,
+   switch to the &lt;span&gt;RCDATA end tag name state&lt;/span&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;span&gt;current input character&lt;/span&gt;. Append the &lt;span&gt;current
+   input character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Finally,
+   switch to the &lt;span&gt;RCDATA end tag name state&lt;/span&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;span&gt;current input
+   character&lt;/span&gt; in the &lt;span&gt;RCDATA state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;RCDATA end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RAWTEXT (and Script data) end tag name state, except s/RAWTEXT/RCDATA/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then switch to the &lt;span&gt;before attribute name
+   state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then switch to the &lt;span&gt;self-closing start tag
+   state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then emit the current tag token and switch to the
+   &lt;span&gt;data state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input
+   character&lt;/span&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;span&gt;current input
+   character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Stay in the
+   &lt;span&gt;RCDATA end tag name state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   tag token's tag name. Append the &lt;span&gt;current input
+   character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Stay in the
+   &lt;span&gt;RCDATA end tag name state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;temporary buffer&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;span&gt;current input character&lt;/span&gt;
+   in the &lt;span&gt;RCDATA state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;RAWTEXT less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA less-than sign state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;temporary buffer&lt;/var&gt; to the empty string. Switch
+   to the &lt;span&gt;RAWTEXT end tag open state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;span&gt;current input character&lt;/span&gt; in the &lt;span&gt;RAWTEXT
+   state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;RAWTEXT end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and Script data) end tag open state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;span&gt;current input character&lt;/span&gt; (add
+   0x0020 to the character's code point). Append the &lt;span&gt;current
+   input character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Finally,
+   switch to the &lt;span&gt;RAWTEXT end tag name state&lt;/span&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;span&gt;current input character&lt;/span&gt;. Append the &lt;span&gt;current
+   input character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Finally,
+   switch to the &lt;span&gt;RAWTEXT end tag name state&lt;/span&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;span&gt;current input
+   character&lt;/span&gt; in the &lt;span&gt;RAWTEXT state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;RAWTEXT end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and Script data) end tag name state, except s/RCDATA/RAWTEXT/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then switch to the &lt;span&gt;before attribute name
+   state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then switch to the &lt;span&gt;self-closing start tag
+   state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then emit the current tag token and switch to the
+   &lt;span&gt;data state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input
+   character&lt;/span&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;span&gt;current input
+   character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Stay in the
+   &lt;span&gt;RAWTEXT end tag name state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   tag token's tag name. Append the &lt;span&gt;current input
+   character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Stay in the
+   &lt;span&gt;RAWTEXT end tag name state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;temporary buffer&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;span&gt;current input character&lt;/span&gt;
+   in the &lt;span&gt;RAWTEXT state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data less-than sign state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;Set the &lt;var&gt;temporary buffer&lt;/var&gt; to the empty string. Switch
+   to the &lt;span&gt;script data end tag open state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and a U+0021
+   EXCLAMATION MARK character token. Switch to the &lt;span&gt;script data
+   escape start state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token and reconsume the
+   &lt;span&gt;current input character&lt;/span&gt; in the &lt;span&gt;script data
+   state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data end tag open state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and RAWTEXT) end tag open state, except s/RCDATA/Script data/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   lowercase version of the &lt;span&gt;current input character&lt;/span&gt; (add
+   0x0020 to the character's code point). Append the &lt;span&gt;current
+   input character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Finally,
+   switch to the &lt;span&gt;script data end tag name state&lt;/span&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Create a new end tag token, and set its tag name to the
+   &lt;span&gt;current input character&lt;/span&gt;. Append the &lt;span&gt;current
+   input character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Finally,
+   switch to the &lt;span&gt;script data end tag name state&lt;/span&gt;. (Don't emit
+   the token yet; further details will be filled in before it is
+   emitted.)&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, and reconsume the &lt;span&gt;current input
+   character&lt;/span&gt; in the &lt;span&gt;script data state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data end tag name state&lt;/dfn&gt;&lt;/h5&gt;
+  &lt;!-- identical to the RCDATA (and RAWTEXT) end tag name state, except s/RCDATA/Script data/g --&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+0009 CHARACTER TABULATION&lt;/dt&gt;
+   &lt;dt&gt;U+000A LINE FEED (LF)&lt;/dt&gt;
+   &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
+   &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
+   &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then switch to the &lt;span&gt;before attribute name
+   state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+002F SOLIDUS (/)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then switch to the &lt;span&gt;self-closing start tag
+   state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything else&quot; entry
+   below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;If the current end tag token is an &lt;span&gt;appropriate end tag
+   token&lt;/span&gt;, then emit the current tag token and switch to the
+   &lt;span&gt;data state&lt;/span&gt;. Otherwise, treat it as per the &quot;anything
+   else&quot; entry below.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input
+   character&lt;/span&gt; (add 0x0020 to the character's code point) to the
+   current tag token's tag name. Append the &lt;span&gt;current input
+   character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Stay in the
+   &lt;span&gt;Script data end tag name state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+0061 LATIN SMALL LETTER A through to U+007A LATIN SMALL LETTER Z&lt;/dt&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   tag token's tag name. Append the &lt;span&gt;current input
+   character&lt;/span&gt; to the &lt;var&gt;temporary buffer&lt;/var&gt;. Stay in the
+   &lt;span&gt;Script data end tag name state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003C LESS-THAN SIGN character token, a U+002F SOLIDUS
+   character token, a character token for each of the characters in
+   the &lt;var&gt;temporary buffer&lt;/var&gt; (in the order they were added to
+   the buffer), and reconsume the &lt;span&gt;current input character&lt;/span&gt;
+   in the &lt;span&gt;script data state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data escape start state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;span&gt;script data escape start dash state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Reconsume the &lt;span&gt;current input character&lt;/span&gt; in the
+   &lt;span&gt;script data state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data escape start dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;span&gt;script data escaped dash dash state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Reconsume the &lt;span&gt;current input character&lt;/span&gt; in the
+   &lt;span&gt;script data state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data escaped state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;span&gt;script data escaped dash state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Reconsume the EOF character in the
+   &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Stay in
+   the &lt;span&gt;script data escaped state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data escaped dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Switch to the
+   &lt;span&gt;script data escaped dash dash state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Reconsume the EOF character in the
+   &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Switch
+   to the &lt;span&gt;script data escaped state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
+  &lt;h5&gt;&lt;dfn&gt;Script data escaped dash dash state&lt;/dfn&gt;&lt;/h5&gt;
+
+  &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
+
+  &lt;dl class=&quot;switch&quot;&gt;
+
+   &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+002D HYPHEN-MINUS character token. Stay in the
+   &lt;span&gt;script data escaped dash dash state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
+   &lt;dd&gt;Emit a U+003E GREATER-THAN SIGN character token. Switch to the
+   &lt;span&gt;script data state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;EOF&lt;/dt&gt;
+   &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Reconsume the EOF character in the
+   &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
+
+   &lt;dt&gt;Anything else&lt;/dt&gt;
+   &lt;dd&gt;Emit the current input character as a character token. Switch
+   to the &lt;span&gt;script data escaped state&lt;/span&gt;.&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+
   &lt;h5&gt;&lt;dfn&gt;Before attribute name state&lt;/dfn&gt;&lt;/h5&gt;
 
   &lt;p&gt;Consume the &lt;span&gt;next input character&lt;/span&gt;:&lt;/p&gt;
@@ -79592,9 +79983,9 @@
    state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input character&lt;/span&gt;
-   (add 0x0020 to the character's code point) to the current
-   attribute's name. Stay in the &lt;span&gt;attribute name
+   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input
+   character&lt;/span&gt; (add 0x0020 to the character's code point) to the
+   current attribute's name. Stay in the &lt;span&gt;attribute name
    state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
@@ -79608,8 +79999,9 @@
    &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current attribute's
-   name. Stay in the &lt;span&gt;attribute name state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   attribute's name. Stay in the &lt;span&gt;attribute name
+   state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -79647,10 +80039,10 @@
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Start a new attribute in the current tag token. Set that
-   attribute's name to the lowercase version of the &lt;span&gt;current input character&lt;/span&gt;
-   (add 0x0020 to the character's code point), and its value to
-   the empty string. Switch to the &lt;span&gt;attribute name
-   state&lt;/span&gt;.&lt;/dd&gt;
+   attribute's name to the lowercase version of the &lt;span&gt;current
+   input character&lt;/span&gt; (add 0x0020 to the character's code point),
+   and its value to the empty string. Switch to the &lt;span&gt;attribute
+   name state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
    &lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
@@ -79664,8 +80056,8 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Start a new attribute in the current tag token. Set that
-   attribute's name to the &lt;span&gt;current input character&lt;/span&gt;, and its value to
-   the empty string. Switch to the &lt;span&gt;attribute name
+   attribute's name to the &lt;span&gt;current input character&lt;/span&gt;, and
+   its value to the empty string. Switch to the &lt;span&gt;attribute name
    state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
@@ -79689,7 +80081,7 @@
 
    &lt;dt&gt;U+0026 AMPERSAND (&amp;)&lt;/dt&gt;
    &lt;dd&gt;Switch to the &lt;span&gt;attribute value (unquoted) state&lt;/span&gt;
-   and reconsume this input character.&lt;/dd&gt;
+   and reconsume this &lt;span&gt;current input character&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
    &lt;dd&gt;Switch to the &lt;span&gt;attribute value (single-quoted) state&lt;/span&gt;.&lt;/dd&gt;
@@ -79736,9 +80128,9 @@
    &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current attribute's
-   value. Stay in the &lt;span&gt;attribute value (double-quoted)
-   state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   attribute's value. Stay in the &lt;span&gt;attribute value
+   (double-quoted) state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -79763,9 +80155,9 @@
    &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current attribute's
-   value. Stay in the &lt;span&gt;attribute value (single-quoted)
-   state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   attribute's value. Stay in the &lt;span&gt;attribute value
+   (single-quoted) state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -79805,8 +80197,8 @@
    &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current attribute's
-   value. Stay in the &lt;span&gt;attribute value (unquoted)
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   attribute's value. Stay in the &lt;span&gt;attribute value (unquoted)
    state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
@@ -79881,9 +80273,6 @@
 
   &lt;h5&gt;&lt;dfn&gt;Bogus comment state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;span&gt;content model
-  flag&lt;/span&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;Consume every character up to and including the first U+003E
   GREATER-THAN SIGN character (&gt;) or the end of the file (EOF),
   whichever comes first. Emit a comment token whose data is the
@@ -79902,9 +80291,6 @@
 
   &lt;h5&gt;&lt;dfn&gt;Markup declaration open state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;span&gt;content model
-  flag&lt;/span&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;If the next two characters are both U+002D HYPHEN-MINUS (-)
   characters, consume those two characters, create a comment token
   whose data is the empty string, and switch to the &lt;span&gt;comment
@@ -79948,8 +80334,8 @@
    the EOF character in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's
-   data. Switch to the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the comment
+   token's data. Switch to the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -79973,9 +80359,9 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the input
-   character to the comment token's data. Switch to the
-   &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the
+   &lt;span&gt;current input character&lt;/span&gt; to the comment token's
+   data. Switch to the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -79995,8 +80381,8 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Stay
-   in the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the comment
+   token's data. Stay in the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -80016,9 +80402,9 @@
    in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the input
-   character to the comment token's data. Switch to the
-   &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append a U+002D HYPHEN-MINUS character (-) and the
+   &lt;span&gt;current input character&lt;/span&gt; to the comment token's
+   data. Switch to the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -80039,8 +80425,9 @@
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Append two U+002D HYPHEN-MINUS (-)
-   characters and the input character to the comment token's
-   data. Switch to the &lt;span&gt;comment end space state&lt;/span&gt;.&lt;/dd&gt;
+   characters and the &lt;span&gt;current input character&lt;/span&gt; to the
+   comment token's data. Switch to the &lt;span&gt;comment end space
+   state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0021 EXCLAMATION MARK (!)&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Switch to the &lt;span&gt;comment end bang
@@ -80061,8 +80448,9 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Append two U+002D HYPHEN-MINUS (-)
-   characters and the input character to the comment token's
-   data. Switch to the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
+   characters and the &lt;span&gt;current input character&lt;/span&gt; to the
+   comment token's data. Switch to the &lt;span&gt;comment
+   state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -80089,9 +80477,9 @@
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
    &lt;dd&gt;Append two U+002D HYPHEN-MINUS (-) characters, a U+0021
-   EXCLAMATION MARK character (!), and the input character to the
-   comment token's data. Switch to the &lt;span&gt;comment
-   state&lt;/span&gt;.&lt;/dd&gt;
+   EXCLAMATION MARK character (!), and the &lt;span&gt;current input
+   character&lt;/span&gt; to the comment token's data. Switch to the
+   &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -80107,7 +80495,7 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Stay in
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the comment token's data. Stay in
    the &lt;span&gt;comment end space state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+002D HYPHEN-MINUS (-)&lt;/dt&gt;
@@ -80123,7 +80511,7 @@
    comment in comment end state --&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the input character to the comment token's data. Switch
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the comment token's data. Switch
    to the &lt;span&gt;comment state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
@@ -80169,7 +80557,7 @@
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
    &lt;dd&gt;Create a new DOCTYPE token. Set the token's name to the
-   lowercase version of the input character (add 0x0020 to the
+   lowercase version of the &lt;span&gt;current input character&lt;/span&gt; (add 0x0020 to the
    character's code point). Switch to the &lt;span&gt;DOCTYPE name
    state&lt;/span&gt;.&lt;/dd&gt;
 
@@ -80209,9 +80597,10 @@
    state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+0041 LATIN CAPITAL LETTER A through to U+005A LATIN CAPITAL LETTER Z&lt;/dt&gt;
-   &lt;dd&gt;Append the lowercase version of the input character (add 0x0020
-   to the character's code point) to the current DOCTYPE token's
-   name. Stay in the &lt;span&gt;DOCTYPE name state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the lowercase version of the &lt;span&gt;current input
+   character&lt;/span&gt; (add 0x0020 to the character's code point) to the
+   current DOCTYPE token's name. Stay in the &lt;span&gt;DOCTYPE name
+   state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;EOF&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Set the DOCTYPE token's
@@ -80219,8 +80608,9 @@
    Reconsume the EOF character in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current DOCTYPE
-   token's name. Stay in the &lt;span&gt;DOCTYPE name state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   DOCTYPE token's name. Stay in the &lt;span&gt;DOCTYPE name
+   state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
 
@@ -80402,7 +80792,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;span&gt;between DOCTYPE public and system identifiers state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;between DOCTYPE public and system
+   identifiers state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;span&gt;data
@@ -80442,7 +80833,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Stay in the &lt;span&gt;between DOCTYPE public and system identifiers state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Stay in the &lt;span&gt;between DOCTYPE public and system identifiers
+   state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;span&gt;data
@@ -80545,7 +80937,8 @@
   &lt;dl class=&quot;switch&quot;&gt;
 
    &lt;dt&gt;U+0022 QUOTATION MARK (&quot;)&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;span&gt;after DOCTYPE system identifier state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;after DOCTYPE system identifier
+   state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Set the DOCTYPE token's
@@ -80558,8 +80951,8 @@
    Reconsume the EOF character in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current DOCTYPE
-   token's system identifier. Stay in the &lt;span&gt;DOCTYPE system
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   DOCTYPE token's system identifier. Stay in the &lt;span&gt;DOCTYPE system
    identifier (double-quoted) state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
@@ -80572,7 +80965,8 @@
   &lt;dl class=&quot;switch&quot;&gt;
 
    &lt;dt&gt;U+0027 APOSTROPHE (')&lt;/dt&gt;
-   &lt;dd&gt;Switch to the &lt;span&gt;after DOCTYPE system identifier state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Switch to the &lt;span&gt;after DOCTYPE system identifier
+   state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;&lt;span&gt;Parse error&lt;/span&gt;. Set the DOCTYPE token's
@@ -80585,8 +80979,8 @@
    Reconsume the EOF character in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;Anything else&lt;/dt&gt;
-   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current DOCTYPE
-   token's system identifier. Stay in the &lt;span&gt;DOCTYPE system
+   &lt;dd&gt;Append the &lt;span&gt;current input character&lt;/span&gt; to the current
+   DOCTYPE token's system identifier. Stay in the &lt;span&gt;DOCTYPE system
    identifier (single-quoted) state&lt;/span&gt;.&lt;/dd&gt;
 
   &lt;/dl&gt;
@@ -80603,7 +80997,8 @@
    &lt;dt&gt;U+000C FORM FEED (FF)&lt;/dt&gt;
    &lt;!--&lt;dt&gt;U+000D CARRIAGE RETURN (CR)&lt;/dt&gt;--&gt;
    &lt;dt&gt;U+0020 SPACE&lt;/dt&gt;
-   &lt;dd&gt;Stay in the &lt;span&gt;after DOCTYPE system identifier state&lt;/span&gt;.&lt;/dd&gt;
+   &lt;dd&gt;Stay in the &lt;span&gt;after DOCTYPE system identifier
+   state&lt;/span&gt;.&lt;/dd&gt;
 
    &lt;dt&gt;U+003E GREATER-THAN SIGN (&gt;)&lt;/dt&gt;
    &lt;dd&gt;Emit the current DOCTYPE token. Switch to the &lt;span&gt;data
@@ -80644,9 +81039,6 @@
 
   &lt;h5&gt;&lt;dfn&gt;CDATA section state&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p&gt;&lt;i&gt;(This can only happen if the &lt;span&gt;content model
-  flag&lt;/span&gt; is set to the PCDATA state.)&lt;/i&gt;&lt;/p&gt;
-
   &lt;p&gt;Consume every character up to the next occurrence of the three
   character sequence U+005D RIGHT SQUARE BRACKET U+005D RIGHT SQUARE
   BRACKET U+003E GREATER-THAN SIGN (&lt;code title=&quot;&quot;&gt;]]&gt;&lt;/code&gt;), or the
@@ -81162,11 +81554,10 @@
    &lt;li&gt;&lt;p&gt;&lt;span&gt;Insert an HTML element&lt;/span&gt; for the token.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the algorithm that was invoked is the &lt;span&gt;generic raw
-   text element parsing algorithm&lt;/span&gt;, switch the tokenizer's
-   &lt;span&gt;content model flag&lt;/span&gt; to the RAWTEXT state; otherwise the
-   algorithm invoked was the &lt;span&gt;generic RCDATA element parsing
-   algorithm&lt;/span&gt;, switch the tokenizer's &lt;span&gt;content model
-   flag&lt;/span&gt; to the RCDATA state.&lt;/p&gt;&lt;/li&gt;
+   text element parsing algorithm&lt;/span&gt;, switch the tokenizer to the
+   &lt;span&gt;RAWTEXT state&lt;/span&gt;; otherwise the algorithm invoked
+   was the &lt;span&gt;generic RCDATA element parsing algorithm&lt;/span&gt;,
+   switch the tokenizer to the &lt;span&gt;RCDATA state&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;Let the &lt;span&gt;original insertion mode&lt;/span&gt; be the current
    &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
@@ -81744,8 +82135,8 @@
      and push it onto the &lt;span&gt;stack of open
      elements&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Switch the tokenizer's &lt;span&gt;content model flag&lt;/span&gt; to
-     the RAWTEXT state.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Switch the tokenizer to the &lt;span&gt;script data
+     state&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;span&gt;original insertion mode&lt;/span&gt; be the current
      &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
@@ -82328,14 +82719,12 @@
 
     &lt;p&gt;&lt;span&gt;Insert an HTML element&lt;/span&gt; for the token.&lt;/p&gt;
 
-    &lt;p&gt;Switch the &lt;span&gt;content model flag&lt;/span&gt; to the PLAINTEXT
-    state.&lt;/p&gt;
+    &lt;p&gt;Switch the tokenizer to the &lt;span&gt;PLAINTEXT state&lt;/span&gt;.&lt;/p&gt;
 
-    &lt;p class=&quot;note&quot;&gt;Once a start tag with the tag name &quot;plaintext&quot;
-    has been seen, that will be the last token ever seen other
-    than character tokens (and the end-of-file token), because
-    there is no way to switch the &lt;span&gt;content model flag&lt;/span&gt;
-    out of the PLAINTEXT state.&lt;/p&gt;
+    &lt;p class=&quot;note&quot;&gt;Once a start tag with the tag name &quot;plaintext&quot; has
+    been seen, that will be the last token ever seen other than
+    character tokens (and the end-of-file token), because there is no
+    way to switch out of the &lt;span&gt;PLAINTEXT state&lt;/span&gt;.&lt;/p&gt;
 
    &lt;/dd&gt;
 
@@ -82990,8 +83379,8 @@
      one. (Newlines at the start of &lt;code&gt;textarea&lt;/code&gt; elements are
      ignored as an authoring convenience.)&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p&gt;Switch the tokenizer's &lt;span&gt;content model flag&lt;/span&gt; to
-     the RCDATA state.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;Switch the tokenizer to the the &lt;span&gt;RCDATA
+     state&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
      &lt;li&gt;&lt;p&gt;Let the &lt;span&gt;original insertion mode&lt;/span&gt; be the
      current &lt;span&gt;insertion mode&lt;/span&gt;.&lt;/p&gt;
@@ -85633,45 +86022,40 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;Set the &lt;span&gt;HTML parser&lt;/span&gt;'s &lt;span&gt;tokenization&lt;/span&gt;
-      stage's &lt;span&gt;content model flag&lt;/span&gt; according to the &lt;var
-      title=&quot;&quot;&gt;context&lt;/var&gt; element, as follows:&lt;/p&gt;
+      &lt;p&gt;Set the state of the &lt;span&gt;HTML parser&lt;/span&gt;'s
+      &lt;span&gt;tokenization&lt;/span&gt; stage as follows:&lt;/p&gt;
 
       &lt;dl class=&quot;switch&quot;&gt;
 
        &lt;dt&gt;If it is a &lt;code&gt;title&lt;/code&gt; or &lt;code&gt;textarea&lt;/code&gt;
        element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;span&gt;content model flag&lt;/span&gt; to
-       the RCDATA state.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;span&gt;RCDATA state&lt;/span&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;style&lt;/code&gt;, &lt;code&gt;script&lt;/code&gt;,
        &lt;code&gt;xmp&lt;/code&gt;, &lt;code&gt;iframe&lt;/code&gt;, &lt;code&gt;noembed&lt;/code&gt;, or
        &lt;code&gt;noframes&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;span&gt;content model flag&lt;/span&gt; to
-       the RAWTEXT state.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;span&gt;RAWTEXT state&lt;/span&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;noscript&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;If the &lt;span&gt;scripting flag&lt;/span&gt; is enabled, set the
-       &lt;span&gt;content model flag&lt;/span&gt; to the RAWTEXT
-       state. Otherwise, set the &lt;span&gt;content model flag&lt;/span&gt; to the
-       PCDATA state.&lt;/dd&gt;
+       &lt;dd&gt;If the &lt;span&gt;scripting flag&lt;/span&gt; is enabled, switch the
+       tokenizer to the &lt;span&gt;RAWTEXT state&lt;/span&gt;.  Otherwise,
+       leave the tokenizer in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;If it is a &lt;code&gt;plaintext&lt;/code&gt; element&lt;/dt&gt;
 
-       &lt;dd&gt;Set the &lt;span&gt;content model flag&lt;/span&gt; to
-       PLAINTEXT.&lt;/dd&gt;
+       &lt;dd&gt;Switch the tokenizer to the &lt;span&gt;PLAINTEXT
+       state&lt;/span&gt;.&lt;/dd&gt;
 
 
        &lt;dt&gt;Otherwise&lt;/dt&gt;
 
-       &lt;dd&gt;Leave the &lt;span&gt;content model flag&lt;/span&gt; in the PCDATA
-       state.&lt;/dd&gt;
+       &lt;dd&gt;Leave the tokenizer in the &lt;span&gt;data state&lt;/span&gt;.&lt;/dd&gt;
 
       &lt;/dl&gt;
 


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011048.html">[html5] r4176 - [e] (0) Rename an insertion mode to prepare for	more tokenizer modes.
</A></li>
	<LI>Next message: <A HREF="011050.html">[html5] r4178 - [acgiow] (2) Redefine how to parse RCDATA and	RAWTEXT elements, and introduce a  [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11049">[ date ]</a>
              <a href="thread.html#11049">[ thread ]</a>
              <a href="subject.html#11049">[ subject ]</a>
              <a href="author.html#11049">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
