<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r5150 - [giow] (0) Captions - Stage 21.4: rendering:	binding to CSS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5150%20-%20%5Bgiow%5D%20%280%29%20Captions%20-%20Stage%2021.4%3A%20rendering%3A%0A%09binding%20to%20CSS&In-Reply-To=%3C20100712222650.DAFCB1C8C003%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012019.html">
   <LINK REL="Next"  HREF="012021.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r5150 - [giow] (0) Captions - Stage 21.4: rendering:	binding to CSS</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5150%20-%20%5Bgiow%5D%20%280%29%20Captions%20-%20Stage%2021.4%3A%20rendering%3A%0A%09binding%20to%20CSS&In-Reply-To=%3C20100712222650.DAFCB1C8C003%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r5150 - [giow] (0) Captions - Stage 21.4: rendering:	binding to CSS">whatwg at whatwg.org
       </A><BR>
    <I>Mon Jul 12 15:26:50 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="012019.html">[html5] r5149 - [giow] (0) Captions - Stage 21.3: rendering:	direction and size calculations
</A></li>
        <LI>Next message: <A HREF="012021.html">[html5] r5151 - [giow] (0) Captions - Stage 21.5: rendering:	property mappings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12020">[ date ]</a>
              <a href="thread.html#12020">[ thread ]</a>
              <a href="subject.html#12020">[ subject ]</a>
              <a href="author.html#12020">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2010-07-12 15:26:49 -0700 (Mon, 12 Jul 2010)
New Revision: 5150

Modified:
   complete.html
   index
   source
Log:
[giow] (0) Captions - Stage 21.4: rendering: binding to CSS

Modified: complete.html
===================================================================
--- complete.html	2010-07-12 20:08:21 UTC (rev 5149)
+++ complete.html	2010-07-12 22:26:49 UTC (rev 5150)
@@ -86415,7 +86415,7 @@
       &lt;p&gt;Apply the Unicode Bidirectional Algorithm's Paragraph Level
       steps to &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt; using the following
       constraints, to determine the &lt;i&gt;paragraph embedding level&lt;/i&gt;
-      of the cue:&lt;/p&gt;
+      of the cue: &lt;a href=#BIDI&gt;[BIDI]&lt;/a&gt;&lt;/p&gt;
 
       &lt;ul&gt;&lt;li&gt;&lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt; represents a single paragraph.&lt;/li&gt;
 
@@ -86437,8 +86437,9 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;Determine the value of &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt; as per the
-      appropriate rules from the following list:&lt;/p&gt;
+      &lt;p&gt;Determine the value of &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt; for
+      &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt; as per the appropriate rules from the
+      following list:&lt;/p&gt;
 
       &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;a href=#timed-track-cue-writing-direction&gt;timed track cue writing direction&lt;/a&gt; is &lt;a href=#timed-track-cue-horizontal-writing-direction title=&quot;timed track cue horizontal writing direction&quot;&gt;horizontal&lt;/a&gt;,
               the &lt;a href=#timed-track-cue-alignment&gt;timed track cue alignment&lt;/a&gt; is &lt;a href=#timed-track-cue-start-alignment title=&quot;timed track cue start alignment&quot;&gt;start&lt;/a&gt;,
@@ -86513,21 +86514,10 @@
      &lt;li&gt;&lt;p&gt;If the &lt;a href=#timed-track-cue-size&gt;timed track cue size&lt;/a&gt; is less than &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;size&lt;/var&gt; be
      &lt;a href=#timed-track-cue-size&gt;timed track cue size&lt;/a&gt;. Otherwise, let &lt;var title=&quot;&quot;&gt;size&lt;/var&gt; be &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;apply css rules (styles and min/max dimensions) to get dimensions for the boxes; regardless of 'white-space', force wrapping at the max width and at line breaks&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;/p&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;turn the nodes into css boxes&lt;/li&gt;
-
-&lt;!-- XXX
-construct a CSS box model tree [or whatever] from the WebSRT Node
-Object tree rooted at /whatever/, witin the following constraints:
-
- + mappings of nodes to css 'display' values
- + dimensions
- + white-space rules
-
---&gt;
-
-&lt;!--
+&lt;pre class=XXX&gt;
+ calculate 'top' and 'left':
  * If D=horizontal:
      Let H = the height of the first line box of /lines/
      If A=start and 'direction' is 'ltr':
@@ -86536,9 +86526,9 @@
      If A=end and 'direction' is 'ltr':
      If A=start and 'direction' is 'rtl':
        Let X = min(T * VW - width of /container/, 0)
-     If A=middle and T &lt;= 50%:
+     If A=middle and T &lt;= 50%:
        Let X = max(T * VW - (width of /container/)/2, 0)
-     If A=middle and T &gt; 50%:
+     If A=middle and T &gt; 50%:
        Let X = min(T * VW + (width of /container/)/2, VW) - (width of /container/)
    If D=vertical:
      Let H = the width of the first line box of /lines/
@@ -86546,24 +86536,91 @@
        Let Y = min(T * VH, VH - height of /container/)
      If A=end:
        Let Y = min(T * VH - height of /container/, 0)
-     If A=middle and T &lt;= 50%:
+     If A=middle and T &lt;= 50%:
        Let Y = max(T * VH - (height of /container/)/2, 0)
-     If A=middle and T &gt; 50%:
+     If A=middle and T &gt; 50%:
        Let Y = min(T * VH + (height of /container/)/2, VH) - (height of /container/)
---&gt;
+&lt;/pre&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;if not snap-to-lines: position the box according to the given position information, and then spiral around clockwise until no overlap is found&lt;/li&gt;
+     &lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;otherwise: position the block in the inline direction; then determine the block-direction position of the first line, then slide the line away from the reference edge until it fits, or if that goes off the edge slide it in the other direction; sliding must snap to multiples of the height of the first line box.&lt;/li&gt;
+     &lt;li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;from the resulting position, remove any lines that don't completely render on the video&lt;/li&gt;
+      &lt;p&gt;Apply the terms of the CSS specifications to &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt; within the following constraints, thus
+      obtaining a set of CSS boxes positioned relative to an initial
+      containing block: &lt;a href=#refsCSS&gt;[CSS]&lt;/a&gt;&lt;/p&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;add the boxes to the output&lt;/li&gt;
+      &lt;ul&gt;&lt;li&gt;The &lt;i&gt;document tree&lt;/i&gt; is the tree of &lt;a href=#websrt-node-object title=&quot;WebSRT
+       Node Object&quot;&gt;WebSRT Node Objects&lt;/a&gt; rooted at &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;save the boxes to the &lt;a href=#timed-track-cue-display-state&gt;timed track cue display state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;For the purposes of processing by the CSS specification,
+       &lt;a href=#websrt-internal-node-object title=&quot;WebSRT Internal Node Object&quot;&gt;WebSRT Internal Node
+       Objects&lt;/a&gt; are equivalent to elements with the same
+       contents. The name of these elements is not explicitly
+       specified. These elements have no attributes.&lt;/li&gt;
 
+       &lt;li&gt;For the purposes of processing by the CSS
+       specification, &lt;a href=#websrt-text-object title=&quot;WebSRT Text Object&quot;&gt;WebSRT Text
+       Objects&lt;/a&gt; are equivalent to text nodes.&lt;/li&gt;
+
+       &lt;li&gt;No style sheets are associated with &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt;.&lt;/li&gt;
+
+       &lt;li&gt;All properties have their initial values, except as
+       explicitly overridden for specific nodes in the next
+       section.&lt;/li&gt;
+
+       &lt;li&gt;The viewport (and initial containing block) is the
+       &lt;a href=#media-element&gt;media element&lt;/a&gt;'s rendering area.&lt;/li&gt;
+
+      &lt;/ul&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; be the boxes generated as
+      descendants of the initial containing block, along with their
+      positions.&lt;/p&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;
+
+      &lt;p&gt;Adjust the positions of &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; according
+      to the appropriate steps from the following list:&lt;/p&gt;
+
+      &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;a href=#timed-track-cue-snap-to-lines-flag&gt;timed track cue snap-to-lines flag&lt;/a&gt; is set&lt;/dt&gt;
+
+       &lt;dd&gt;
+
+        &lt;p class=XXX&gt;determine the block-direction position of the
+        first line, then slide the line away from the reference edge
+        until it fits, or if that goes off the edge slide it in the
+        other direction; sliding must snap to multiples of the height
+        of the first line box.&lt;/p&gt;
+
+       &lt;/dd&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;a href=#timed-track-cue-snap-to-lines-flag&gt;timed track cue snap-to-lines flag&lt;/a&gt; is not set&lt;/dt&gt;
+
+       &lt;dd&gt;
+
+        &lt;p class=XXX&gt;position the box according to the given
+        position information, and then spiral around clockwise until
+        no overlap is found&lt;/p&gt;
+
+       &lt;/dd&gt;
+
+      &lt;/dl&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If there are any line boxes in the (possibly now
+     repositioned) &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; that do not completely
+     fit inside the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s rendering area,
+     remove those offending line boxes from &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;a href=#timed-track-cue-display-state&gt;timed track cue
+     display state&lt;/a&gt; have the CSS boxes in &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Add the CSS boxes in &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/li&gt;
+
     &lt;/ol&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/li&gt;
+
   &lt;/ol&gt;&lt;h5 id=css-extensions&gt;&lt;span class=secno&gt;14.3.2.2 &lt;/span&gt;CSS extensions&lt;/h5&gt;
 
   &lt;p class=note&gt;This section is intended to be moved to a CSS
@@ -86584,6 +86641,8 @@
 
   &lt;!-- XXX
 
+   map display types
+
    rules for rendering the list of active cues:
     - for each segment, decide if it's before or after the current
       playback position.
@@ -86607,6 +86666,8 @@
     - outline
     - anything else that doesn't affect the size or position or kind of CSS boxes
 
+   force wrapping at viewport edge
+
   --&gt;
 
   &lt;p class=XXX&gt;...&lt;/p&gt;

Modified: index
===================================================================
--- index	2010-07-12 20:08:21 UTC (rev 5149)
+++ index	2010-07-12 22:26:49 UTC (rev 5150)
@@ -79656,7 +79656,7 @@
       &lt;p&gt;Apply the Unicode Bidirectional Algorithm's Paragraph Level
       steps to &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt; using the following
       constraints, to determine the &lt;i&gt;paragraph embedding level&lt;/i&gt;
-      of the cue:&lt;/p&gt;
+      of the cue: &lt;a href=#BIDI&gt;[BIDI]&lt;/a&gt;&lt;/p&gt;
 
       &lt;ul&gt;&lt;li&gt;&lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt; represents a single paragraph.&lt;/li&gt;
 
@@ -79678,8 +79678,9 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;Determine the value of &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt; as per the
-      appropriate rules from the following list:&lt;/p&gt;
+      &lt;p&gt;Determine the value of &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt; for
+      &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt; as per the appropriate rules from the
+      following list:&lt;/p&gt;
 
       &lt;dl class=switch&gt;&lt;dt&gt;If the &lt;a href=#timed-track-cue-writing-direction&gt;timed track cue writing direction&lt;/a&gt; is &lt;a href=#timed-track-cue-horizontal-writing-direction title=&quot;timed track cue horizontal writing direction&quot;&gt;horizontal&lt;/a&gt;,
               the &lt;a href=#timed-track-cue-alignment&gt;timed track cue alignment&lt;/a&gt; is &lt;a href=#timed-track-cue-start-alignment title=&quot;timed track cue start alignment&quot;&gt;start&lt;/a&gt;,
@@ -79754,21 +79755,10 @@
      &lt;li&gt;&lt;p&gt;If the &lt;a href=#timed-track-cue-size&gt;timed track cue size&lt;/a&gt; is less than &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt;, then let &lt;var title=&quot;&quot;&gt;size&lt;/var&gt; be
      &lt;a href=#timed-track-cue-size&gt;timed track cue size&lt;/a&gt;. Otherwise, let &lt;var title=&quot;&quot;&gt;size&lt;/var&gt; be &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;apply css rules (styles and min/max dimensions) to get dimensions for the boxes; regardless of 'white-space', force wrapping at the max width and at line breaks&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;/p&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;turn the nodes into css boxes&lt;/li&gt;
-
-&lt;!-- XXX
-construct a CSS box model tree [or whatever] from the WebSRT Node
-Object tree rooted at /whatever/, witin the following constraints:
-
- + mappings of nodes to css 'display' values
- + dimensions
- + white-space rules
-
---&gt;
-
-&lt;!--
+&lt;pre class=XXX&gt;
+ calculate 'top' and 'left':
  * If D=horizontal:
      Let H = the height of the first line box of /lines/
      If A=start and 'direction' is 'ltr':
@@ -79777,9 +79767,9 @@
      If A=end and 'direction' is 'ltr':
      If A=start and 'direction' is 'rtl':
        Let X = min(T * VW - width of /container/, 0)
-     If A=middle and T &lt;= 50%:
+     If A=middle and T &lt;= 50%:
        Let X = max(T * VW - (width of /container/)/2, 0)
-     If A=middle and T &gt; 50%:
+     If A=middle and T &gt; 50%:
        Let X = min(T * VW + (width of /container/)/2, VW) - (width of /container/)
    If D=vertical:
      Let H = the width of the first line box of /lines/
@@ -79787,24 +79777,91 @@
        Let Y = min(T * VH, VH - height of /container/)
      If A=end:
        Let Y = min(T * VH - height of /container/, 0)
-     If A=middle and T &lt;= 50%:
+     If A=middle and T &lt;= 50%:
        Let Y = max(T * VH - (height of /container/)/2, 0)
-     If A=middle and T &gt; 50%:
+     If A=middle and T &gt; 50%:
        Let Y = min(T * VH + (height of /container/)/2, VH) - (height of /container/)
---&gt;
+&lt;/pre&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;if not snap-to-lines: position the box according to the given position information, and then spiral around clockwise until no overlap is found&lt;/li&gt;
+     &lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;otherwise: position the block in the inline direction; then determine the block-direction position of the first line, then slide the line away from the reference edge until it fits, or if that goes off the edge slide it in the other direction; sliding must snap to multiples of the height of the first line box.&lt;/li&gt;
+     &lt;li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;from the resulting position, remove any lines that don't completely render on the video&lt;/li&gt;
+      &lt;p&gt;Apply the terms of the CSS specifications to &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt; within the following constraints, thus
+      obtaining a set of CSS boxes positioned relative to an initial
+      containing block: &lt;a href=#refsCSS&gt;[CSS]&lt;/a&gt;&lt;/p&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;add the boxes to the output&lt;/li&gt;
+      &lt;ul&gt;&lt;li&gt;The &lt;i&gt;document tree&lt;/i&gt; is the tree of &lt;a href=#websrt-node-object title=&quot;WebSRT
+       Node Object&quot;&gt;WebSRT Node Objects&lt;/a&gt; rooted at &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt;.&lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=XXX&gt;save the boxes to the &lt;a href=#timed-track-cue-display-state&gt;timed track cue display state&lt;/a&gt;&lt;/li&gt;
+       &lt;li&gt;For the purposes of processing by the CSS specification,
+       &lt;a href=#websrt-internal-node-object title=&quot;WebSRT Internal Node Object&quot;&gt;WebSRT Internal Node
+       Objects&lt;/a&gt; are equivalent to elements with the same
+       contents. The name of these elements is not explicitly
+       specified. These elements have no attributes.&lt;/li&gt;
 
+       &lt;li&gt;For the purposes of processing by the CSS
+       specification, &lt;a href=#websrt-text-object title=&quot;WebSRT Text Object&quot;&gt;WebSRT Text
+       Objects&lt;/a&gt; are equivalent to text nodes.&lt;/li&gt;
+
+       &lt;li&gt;No style sheets are associated with &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt;.&lt;/li&gt;
+
+       &lt;li&gt;All properties have their initial values, except as
+       explicitly overridden for specific nodes in the next
+       section.&lt;/li&gt;
+
+       &lt;li&gt;The viewport (and initial containing block) is the
+       &lt;a href=#media-element&gt;media element&lt;/a&gt;'s rendering area.&lt;/li&gt;
+
+      &lt;/ul&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; be the boxes generated as
+      descendants of the initial containing block, along with their
+      positions.&lt;/p&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;
+
+      &lt;p&gt;Adjust the positions of &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; according
+      to the appropriate steps from the following list:&lt;/p&gt;
+
+      &lt;dl class=switch&gt;&lt;dt&gt;If &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;a href=#timed-track-cue-snap-to-lines-flag&gt;timed track cue snap-to-lines flag&lt;/a&gt; is set&lt;/dt&gt;
+
+       &lt;dd&gt;
+
+        &lt;p class=XXX&gt;determine the block-direction position of the
+        first line, then slide the line away from the reference edge
+        until it fits, or if that goes off the edge slide it in the
+        other direction; sliding must snap to multiples of the height
+        of the first line box.&lt;/p&gt;
+
+       &lt;/dd&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;a href=#timed-track-cue-snap-to-lines-flag&gt;timed track cue snap-to-lines flag&lt;/a&gt; is not set&lt;/dt&gt;
+
+       &lt;dd&gt;
+
+        &lt;p class=XXX&gt;position the box according to the given
+        position information, and then spiral around clockwise until
+        no overlap is found&lt;/p&gt;
+
+       &lt;/dd&gt;
+
+      &lt;/dl&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If there are any line boxes in the (possibly now
+     repositioned) &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; that do not completely
+     fit inside the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s rendering area,
+     remove those offending line boxes from &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;a href=#timed-track-cue-display-state&gt;timed track cue
+     display state&lt;/a&gt; have the CSS boxes in &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Add the CSS boxes in &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; to &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/li&gt;
+
     &lt;/ol&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/li&gt;
+
   &lt;/ol&gt;&lt;h5 id=css-extensions&gt;&lt;span class=secno&gt;12.3.2.2 &lt;/span&gt;CSS extensions&lt;/h5&gt;
 
   &lt;p class=note&gt;This section is intended to be moved to a CSS
@@ -79825,6 +79882,8 @@
 
   &lt;!-- XXX
 
+   map display types
+
    rules for rendering the list of active cues:
     - for each segment, decide if it's before or after the current
       playback position.
@@ -79848,6 +79907,8 @@
     - outline
     - anything else that doesn't affect the size or position or kind of CSS boxes
 
+   force wrapping at viewport edge
+
   --&gt;
 
   &lt;p class=XXX&gt;...&lt;/p&gt;

Modified: source
===================================================================
--- source	2010-07-12 20:08:21 UTC (rev 5149)
+++ source	2010-07-12 22:26:49 UTC (rev 5150)
@@ -98583,7 +98583,7 @@
       &lt;p&gt;Apply the Unicode Bidirectional Algorithm's Paragraph Level
       steps to &lt;var title=&quot;&quot;&gt;nodes&lt;/var&gt; using the following
       constraints, to determine the &lt;i&gt;paragraph embedding level&lt;/i&gt;
-      of the cue:&lt;/p&gt;
+      of the cue: &lt;a href=&quot;#BIDI&quot;&gt;[BIDI]&lt;/a&gt;&lt;/p&gt;
 
       &lt;ul&gt;
 
@@ -98610,8 +98610,9 @@
 
      &lt;li&gt;
 
-      &lt;p&gt;Determine the value of &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt; as per the
-      appropriate rules from the following list:&lt;/p&gt;
+      &lt;p&gt;Determine the value of &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt; for
+      &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt; as per the appropriate rules from the
+      following list:&lt;/p&gt;
 
       &lt;dl class=&quot;switch&quot;&gt;
 
@@ -98692,21 +98693,10 @@
      &lt;span&gt;timed track cue size&lt;/span&gt;. Otherwise, let &lt;var
      title=&quot;&quot;&gt;size&lt;/var&gt; be &lt;var title=&quot;&quot;&gt;maximum size&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;apply css rules (styles and min/max dimensions) to get dimensions for the boxes; regardless of 'white-space', force wrapping at the max width and at line breaks&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;p&gt;&lt;/p&gt;
 
-     &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;turn the nodes into css boxes&lt;/p&gt;&lt;/li&gt;
-
-&lt;!-- XXX
-construct a CSS box model tree [or whatever] from the WebSRT Node
-Object tree rooted at /whatever/, witin the following constraints:
-
- + mappings of nodes to css 'display' values
- + dimensions
- + white-space rules
-
---&gt;
-
-&lt;!--
+&lt;pre class=&quot;XXX&quot;&gt;
+ calculate 'top' and 'left':
  * If D=horizontal:
      Let H = the height of the first line box of /lines/
      If A=start and 'direction' is 'ltr':
@@ -98715,7 +98705,7 @@
      If A=end and 'direction' is 'ltr':
      If A=start and 'direction' is 'rtl':
        Let X = min(T * VW - width of /container/, 0)
-     If A=middle and T &lt;= 50%:
+     If A=middle and T &lt;= 50%:
        Let X = max(T * VW - (width of /container/)/2, 0)
      If A=middle and T &gt; 50%:
        Let X = min(T * VW + (width of /container/)/2, VW) - (width of /container/)
@@ -98725,28 +98715,110 @@
        Let Y = min(T * VH, VH - height of /container/)
      If A=end:
        Let Y = min(T * VH - height of /container/, 0)
-     If A=middle and T &lt;= 50%:
+     If A=middle and T &lt;= 50%:
        Let Y = max(T * VH - (height of /container/)/2, 0)
      If A=middle and T &gt; 50%:
        Let Y = min(T * VH + (height of /container/)/2, VH) - (height of /container/)
---&gt;
+&lt;/pre&gt;
 
-     &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;if not snap-to-lines: position the box according to the given position information, and then spiral around clockwise until no overlap is found&lt;/p&gt;&lt;/li&gt;
+     &lt;/li&gt;
 
-     &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;otherwise: position the block in the inline direction; then determine the block-direction position of the first line, then slide the line away from the reference edge until it fits, or if that goes off the edge slide it in the other direction; sliding must snap to multiples of the height of the first line box.&lt;/p&gt;&lt;/li&gt;
+     &lt;li&gt;
 
-     &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;from the resulting position, remove any lines that don't completely render on the video&lt;/p&gt;&lt;/li&gt;
+      &lt;p&gt;Apply the terms of the CSS specifications to &lt;var
+      title=&quot;&quot;&gt;nodes&lt;/var&gt; within the following constraints, thus
+      obtaining a set of CSS boxes positioned relative to an initial
+      containing block: &lt;a href=&quot;#refsCSS&quot;&gt;[CSS]&lt;/a&gt;&lt;/p&gt;
 
-     &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;add the boxes to the output&lt;/p&gt;&lt;/li&gt;
+      &lt;ul&gt;
 
-     &lt;li&gt;&lt;p class=&quot;XXX&quot;&gt;save the boxes to the &lt;span&gt;timed track cue display state&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
+       &lt;li&gt;The &lt;i&gt;document tree&lt;/i&gt; is the tree of &lt;span title=&quot;WebSRT
+       Node Object&quot;&gt;WebSRT Node Objects&lt;/span&gt; rooted at &lt;var
+       title=&quot;&quot;&gt;nodes&lt;/var&gt;.&lt;/li&gt;
 
+       &lt;li&gt;For the purposes of processing by the CSS specification,
+       &lt;span title=&quot;WebSRT Internal Node Object&quot;&gt;WebSRT Internal Node
+       Objects&lt;/span&gt; are equivalent to elements with the same
+       contents. The name of these elements is not explicitly
+       specified. These elements have no attributes.&lt;/li&gt;
+
+       &lt;li&gt;For the purposes of processing by the CSS
+       specification, &lt;span title=&quot;WebSRT Text Object&quot;&gt;WebSRT Text
+       Objects&lt;/span&gt; are equivalent to text nodes.&lt;/li&gt;
+
+       &lt;li&gt;No style sheets are associated with &lt;var
+       title=&quot;&quot;&gt;nodes&lt;/var&gt;.&lt;/li&gt;
+
+       &lt;li&gt;All properties have their initial values, except as
+       explicitly overridden for specific nodes in the next
+       section.&lt;/li&gt;
+
+       &lt;li&gt;The viewport (and initial containing block) is the
+       &lt;span&gt;media element&lt;/span&gt;'s rendering area.&lt;/li&gt;
+
+      &lt;/ul&gt;
+
+      &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; be the boxes generated as
+      descendants of the initial containing block, along with their
+      positions.&lt;/p&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;
+
+      &lt;p&gt;Adjust the positions of &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; according
+      to the appropriate steps from the following list:&lt;/p&gt;
+
+      &lt;dl class=&quot;switch&quot;&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;span&gt;timed track cue snap-to-lines flag&lt;/span&gt; is set&lt;/dt&gt;
+
+       &lt;dd&gt;
+
+        &lt;p class=&quot;XXX&quot;&gt;determine the block-direction position of the
+        first line, then slide the line away from the reference edge
+        until it fits, or if that goes off the edge slide it in the
+        other direction; sliding must snap to multiples of the height
+        of the first line box.&lt;/p&gt;
+
+       &lt;/dd&gt;
+
+       &lt;dt&gt;If &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;span&gt;timed track cue snap-to-lines flag&lt;/span&gt; is not set&lt;/dt&gt;
+
+       &lt;dd&gt;
+
+        &lt;p class=&quot;XXX&quot;&gt;position the box according to the given
+        position information, and then spiral around clockwise until
+        no overlap is found&lt;/p&gt;
+
+       &lt;/dd&gt;
+
+      &lt;/dl&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If there are any line boxes in the (possibly now
+     repositioned) &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; that do not completely
+     fit inside the &lt;span&gt;media element&lt;/span&gt;'s rendering area,
+     remove those offending line boxes from &lt;var
+     title=&quot;&quot;&gt;boxes&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;cue&lt;/var&gt;'s &lt;span&gt;timed track cue
+     display state&lt;/span&gt; have the CSS boxes in &lt;var
+     title=&quot;&quot;&gt;boxes&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Add the CSS boxes in &lt;var title=&quot;&quot;&gt;boxes&lt;/var&gt; to &lt;var
+     title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
     &lt;/ol&gt;
 
    &lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;Return &lt;var title=&quot;&quot;&gt;output&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
   &lt;/ol&gt;
 
+
   &lt;h5&gt;CSS extensions&lt;/h5&gt;
 
   &lt;p class=&quot;note&quot;&gt;This section is intended to be moved to a CSS
@@ -98767,6 +98839,8 @@
 
   &lt;!-- XXX
 
+   map display types
+
    rules for rendering the list of active cues:
     - for each segment, decide if it's before or after the current
       playback position.
@@ -98790,6 +98864,8 @@
     - outline
     - anything else that doesn't affect the size or position or kind of CSS boxes
 
+   force wrapping at viewport edge
+
   --&gt;
 
   &lt;p class=&quot;XXX&quot;&gt;...&lt;/p&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012019.html">[html5] r5149 - [giow] (0) Captions - Stage 21.3: rendering:	direction and size calculations
</A></li>
	<LI>Next message: <A HREF="012021.html">[html5] r5151 - [giow] (0) Captions - Stage 21.5: rendering:	property mappings
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12020">[ date ]</a>
              <a href="thread.html#12020">[ thread ]</a>
              <a href="subject.html#12020">[ subject ]</a>
              <a href="author.html#12020">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
