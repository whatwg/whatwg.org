<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r4974 - [e] (0) Move things more towards what people want	(details to be sorted out late [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r4974%20-%20%5Be%5D%20%280%29%20Move%20things%20more%20towards%20what%20people%20want%0A%09%28details%20to%20be%20sorted%20out%20late%20%5B...%5D&In-Reply-To=%3C20100406000812.6607B1C8C003%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011844.html">
   <LINK REL="Next"  HREF="011846.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r4974 - [e] (0) Move things more towards what people want	(details to be sorted out late [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r4974%20-%20%5Be%5D%20%280%29%20Move%20things%20more%20towards%20what%20people%20want%0A%09%28details%20to%20be%20sorted%20out%20late%20%5B...%5D&In-Reply-To=%3C20100406000812.6607B1C8C003%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r4974 - [e] (0) Move things more towards what people want	(details to be sorted out late [...]">whatwg at whatwg.org
       </A><BR>
    <I>Mon Apr  5 17:08:12 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="011844.html">[html5] r4973 - [e] (0) Clarify that the validityMessage must be	synthesised if necessary.
</A></li>
        <LI>Next message: <A HREF="011846.html">[html5] r4975 - [giow] (0) Make 'fetch' algorithm have a mode where	it doesn't do redirects. Mak [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11845">[ date ]</a>
              <a href="thread.html#11845">[ thread ]</a>
              <a href="subject.html#11845">[ subject ]</a>
              <a href="author.html#11845">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2010-04-05 17:08:11 -0700 (Mon, 05 Apr 2010)
New Revision: 4974

Modified:
   complete.html
   index
   source
Log:
[e] (0) Move things more towards what people want (details to be sorted out later by change proposal, I expect).

Modified: complete.html
===================================================================
--- complete.html	2010-04-05 22:52:20 UTC (rev 4973)
+++ complete.html	2010-04-06 00:08:11 UTC (rev 4974)
@@ -181,7 +181,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1&gt;Web Applications 1.0&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 5 April 2010&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 6 April 2010&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;!--&lt;p class=&quot;impl&quot;&gt;&lt;strong&gt;Implementors!&lt;/strong&gt; We have a &lt;a href=&quot;<A HREF="http://www.whatwg.org/mailing-list#implementors">http://www.whatwg.org/mailing-list#implementors</A>&quot;&gt;mailing list&lt;/a&gt; for you too!&lt;/p&gt;--&gt;
@@ -5609,38 +5609,35 @@
 
   &lt;h4 id=terminology-0&gt;&lt;span class=secno&gt;2.5.1 &lt;/span&gt;Terminology&lt;/h4&gt;
 
+  &lt;!-- see also: svn diff -r3244:3245 source --&gt;
+
   &lt;p&gt;A &lt;dfn id=url&gt;URL&lt;/dfn&gt; is a string used to identify a resource.&lt;/p&gt;
 
-  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-url&gt;valid URL&lt;/dfn&gt; if it is a
-  &lt;span&gt;valid Web address&lt;/span&gt; as defined by the Web addresses
-  specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-url&gt;valid URL&lt;/dfn&gt; if at least one of
+  the following conditions holds:&lt;/p&gt;
 
-  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-non-empty-url&gt;valid non-empty URL&lt;/dfn&gt; if it is a
-  &lt;a href=#valid-url&gt;valid URL&lt;/a&gt; but it is not the empty string.&lt;/p&gt;
+  &lt;ul&gt;&lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid URI reference &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;.&lt;/li&gt;
 
-  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is an &lt;dfn id=absolute-url&gt;absolute URL&lt;/dfn&gt; if it is an
-  &lt;span&gt;absolute Web address&lt;/span&gt; as defined by the Web addresses
-  specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid IRI reference and it has no
+   query component. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
 
-  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is a &lt;dfn id=hierarchical-url&gt;hierarchical URL&lt;/dfn&gt; if,
-  when &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there is a character
-  immediately after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt;
-  component and it is a U+002F SOLIDUS character (/).&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid IRI reference and its query
+   component contains no unescaped non-ASCII characters. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
 
-  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is an &lt;dfn id=authority-based-url&gt;authority-based URL&lt;/dfn&gt;
-  if, when &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there are two
-  characters immediately after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component and they are both
-  U+002F SOLIDUS characters (//).&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid IRI reference and the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character encoding&quot;&gt;character encoding&lt;/a&gt; of
+   the URL's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is UTF-8 or UTF-16. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
 
+  &lt;/ul&gt;&lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-non-empty-url&gt;valid non-empty URL&lt;/dfn&gt; if it is a
+  &lt;a href=#valid-url&gt;valid URL&lt;/a&gt; but it is not the empty string.&lt;/p&gt;
+
   &lt;div class=impl&gt;
 
   &lt;p&gt;To &lt;dfn id=parse-a-url&gt;parse a URL&lt;/dfn&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; into its
-  component parts, the user agent must use the &lt;span&gt;parse a Web
-  address&lt;/span&gt; algorithm defined by the Web addresses
-  specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  component parts, the user agent must use the &lt;span class=XXX&gt;parse
+  an address&lt;/span&gt; algorithm defined by the IRI specification. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;Parsing a URL results in the following components, again as
-  defined by the Web addresses specification:&lt;/p&gt;
+  &lt;p&gt;Parsing a URL can fail. If it does not, then results in the
+  following components, again as defined by the IRI specification:&lt;/p&gt;
 
   &lt;ul class=brief&gt;&lt;li&gt;&lt;dfn id=url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn id=url-host title=url-host&gt;&lt;host&gt;&lt;/dfn&gt;&lt;/li&gt;
@@ -5650,54 +5647,126 @@
    &lt;li&gt;&lt;dfn id=url-query title=url-query&gt;&lt;query&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn id=url-fragment title=url-fragment&gt;&lt;fragment&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn id=url-host-specific title=url-host-specific&gt;&lt;host-specific&gt;&lt;/dfn&gt;&lt;/li&gt;
-  &lt;/ul&gt;&lt;p&gt;To &lt;dfn id=resolve-a-url&gt;resolve a URL&lt;/dfn&gt; to an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
+  &lt;/ul&gt;&lt;hr&gt;&lt;p&gt;To &lt;dfn id=resolve-a-url&gt;resolve a URL&lt;/dfn&gt; to an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
   relative to either another &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; or an element,
-  the user agent must use the &lt;span&gt;resolve a Web address&lt;/span&gt;
-  algorithm defined by the Web addresses specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  the user agent must use the following steps. Resolving a URL can
+  result in an error, in which case the URL is not resolvable.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn id=document-base-url&gt;document base URL&lt;/dfn&gt; of a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
-  object is the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; obtained by running these
-  substeps:&lt;/p&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the &lt;a href=#url&gt;URL&lt;/a&gt; being
+   resolved.&lt;/li&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; be &lt;a href=&quot;#the-document's-address&quot;&gt;the
-   document's address&lt;/a&gt;.&lt;/li&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; be determined as follows:&lt;/p&gt;
+
+    &lt;dl class=switch&gt;&lt;dt&gt;If the URL had a character encoding defined when the URL was
+     created or defined&lt;/dt&gt;
+
+     &lt;dd&gt;The URL character encoding is as defined.&lt;/dd&gt;
+
+     &lt;dt&gt;If the URL came from a script (e.g. as an argument to a
+     method)&lt;/dt&gt;
+
+     &lt;dd&gt;The URL character encoding is the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character
+     encoding&lt;/a&gt;.&lt;/dd&gt;
+
+     &lt;dt&gt;If the URL came from a DOM node (e.g. from an element)&lt;/dt&gt;
+
+     &lt;dd&gt;The node has a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the URL character
+     encoding is the &lt;a href=&quot;#document's-character-encoding&quot;&gt;document's character encoding&lt;/a&gt;.&lt;/dd&gt;
+
+    &lt;/dl&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; is a UTF-16 encoding, then
+   change the value of &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; to UTF-8.&lt;/li&gt;
+
    &lt;li&gt;
 
-    &lt;!-- <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/">http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/</A> --&gt;
+    &lt;p&gt;If the algorithm was invoked with an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
+    to use as the base URL, let &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; be that
+    &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;!-- this should be tested in the case of a browsing context that
-    was navigated to about:blank after having been elsewhere, as
-    opposed to the about:blank used at the time of the browsing
-    context's creation. --&gt;
+    &lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; be the &lt;i&gt;base URI of
+    the element&lt;/i&gt;, as defined by the XML Base specification, with
+    &lt;i&gt;the base URI of the document entity&lt;/i&gt; being defined as the
+    &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; that
+    owns the element. &lt;a href=#refsXMLBASE&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
 
-    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; is
-    &lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt;, and the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s
-    &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; has a &lt;a href=#creator-browsing-context&gt;creator browsing
-    context&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;
-    be the &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the &lt;a href=#creator-document&gt;creator
-    &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt; instead.&lt;/p&gt;
+    &lt;p&gt;For the purposes of the XML Base specification, user agents
+    must act as if all &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; objects represented XML
+    documents.&lt;/p&gt;
 
-   &lt;/li&gt;
+    &lt;p class=note&gt;It is possible for &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes to be present
+    even in HTML fragments, as such attributes can be added
+    dynamically using script. (Such scripts would not be conforming,
+    however, as &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes
+    are not allowed in &lt;a href=#html-documents&gt;HTML documents&lt;/a&gt;.)&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;If there is no &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; element that is both a
-   child of &lt;a href=#the-head-element&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/a&gt; and has an
-   &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute, then the
-   &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is &lt;var title=&quot;&quot;&gt;fallback base
-   url&lt;/var&gt;.&lt;/li&gt;
+    &lt;p&gt;The &lt;dfn id=document-base-url&gt;document base URL&lt;/dfn&gt; of a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
+    object is the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; obtained by running these
+    substeps:&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the value of the
-   &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute of the first
-   such element.&lt;/li&gt;
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; be &lt;a href=&quot;#the-document's-address&quot;&gt;the
+     document's address&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#resolve-a-url title=&quot;resolve a URL&quot;&gt;Resolve&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;fallback base
-   url&lt;/var&gt; (thus, the &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute isn't affected by
-   &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes).&lt;/li&gt;
+     &lt;li&gt;
 
-   &lt;li&gt;&lt;p&gt;The &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is the result of the
-   previous step if it was successful; otherwise it is &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;.&lt;/li&gt;
+      &lt;!-- <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/">http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/</A> --&gt;
 
-  &lt;/ol&gt;&lt;p&gt;This specification defines the URL
+      &lt;!-- this should be tested in the case of a browsing context that
+      was navigated to about:blank after having been elsewhere, as
+      opposed to the about:blank used at the time of the browsing
+      context's creation. --&gt;
+
+      &lt;p&gt;If &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; is
+      &lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt;, and the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s
+      &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; has a &lt;a href=#creator-browsing-context&gt;creator browsing
+      context&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;
+      be the &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the &lt;a href=#creator-document&gt;creator
+      &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt; instead.&lt;/p&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If there is no &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; element that is both a
+     child of &lt;a href=#the-head-element&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/a&gt; and has an
+     &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute, then the
+     &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is &lt;var title=&quot;&quot;&gt;fallback base
+     url&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the value of the
+     &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute of the first
+     such element.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;a href=#resolve-a-url title=&quot;resolve a URL&quot;&gt;Resolve&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;fallback base
+     url&lt;/var&gt; (thus, the &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute isn't affected by
+     &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes).&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;The &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is the result of the
+     previous step if it was successful; otherwise it is &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return the result of applying the &lt;span class=XXX&gt;resolve
+   an address&lt;/span&gt; algorithm defined by the IRI specification to
+   resolve &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; using encoding &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt;. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;/div&gt;
+
+  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is an &lt;dfn id=absolute-url&gt;absolute URL&lt;/dfn&gt; if &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolving&lt;/a&gt; it results in the same output
+  regardless of what it is resolved relative to, and that output is
+  not a failure.&lt;/p&gt;
+
+  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is a &lt;dfn id=hierarchical-url&gt;hierarchical URL&lt;/dfn&gt; if,
+  when &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt; and then &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there is a character immediately
+  after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component
+  and it is a U+002F SOLIDUS character (/).&lt;/p&gt;
+
+  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is an &lt;dfn id=authority-based-url&gt;authority-based URL&lt;/dfn&gt;
+  if, when &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt; and then &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there are two characters
+  immediately after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt;
+  component and they are both U+002F SOLIDUS characters (//).&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;This specification defines the URL
   &lt;dfn id=about:legacy-compat&gt;&lt;code&gt;about:legacy-compat&lt;/code&gt;&lt;/dfn&gt; as a reserved, though
   unresolvable, &lt;code title=&quot;&quot;&gt;about:&lt;/code&gt; URI, for use in &lt;a href=#syntax-doctype title=syntax-doctype&gt;DOCTYPE&lt;/a&gt;s in &lt;a href=#html-documents&gt;HTML
   documents&lt;/a&gt; when needed for compatibility with XML tools. &lt;a href=#refsABOUT&gt;[ABOUT]&lt;/a&gt;&lt;/p&gt;
@@ -5708,8 +5777,6 @@
   &lt;a href=&quot;#the-document's-address&quot;&gt;the document's address&lt;/a&gt; of &lt;a href=#an-iframe-srcdoc-document title=&quot;an iframe srcdoc
   document&quot;&gt;&lt;code&gt;iframe&lt;/code&gt; &lt;code title=attr-iframe-srcdoc&gt;srcdoc&lt;/code&gt; documents&lt;/a&gt;. &lt;a href=#refsABOUT&gt;[ABOUT]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;/div&gt;
-
   &lt;p class=note&gt;The term &quot;URL&quot; in this specification is used in a
   manner distinct from the precise technical meaning it is given in
   RFC 3986. Readers familiar with that RFC will find it easier to read

Modified: index
===================================================================
--- index	2010-04-05 22:52:20 UTC (rev 4973)
+++ index	2010-04-06 00:08:11 UTC (rev 4974)
@@ -185,7 +185,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1&gt;HTML5 (including next generation additions still in development)&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 5 April 2010&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 6 April 2010&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;!--&lt;p class=&quot;impl&quot;&gt;&lt;strong&gt;Implementors!&lt;/strong&gt; We have a &lt;a href=&quot;<A HREF="http://www.whatwg.org/mailing-list#implementors">http://www.whatwg.org/mailing-list#implementors</A>&quot;&gt;mailing list&lt;/a&gt; for you too!&lt;/p&gt;--&gt;
@@ -5507,38 +5507,35 @@
 
   &lt;h4 id=terminology-0&gt;&lt;span class=secno&gt;2.5.1 &lt;/span&gt;Terminology&lt;/h4&gt;
 
+  &lt;!-- see also: svn diff -r3244:3245 source --&gt;
+
   &lt;p&gt;A &lt;dfn id=url&gt;URL&lt;/dfn&gt; is a string used to identify a resource.&lt;/p&gt;
 
-  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-url&gt;valid URL&lt;/dfn&gt; if it is a
-  &lt;span&gt;valid Web address&lt;/span&gt; as defined by the Web addresses
-  specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-url&gt;valid URL&lt;/dfn&gt; if at least one of
+  the following conditions holds:&lt;/p&gt;
 
-  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-non-empty-url&gt;valid non-empty URL&lt;/dfn&gt; if it is a
-  &lt;a href=#valid-url&gt;valid URL&lt;/a&gt; but it is not the empty string.&lt;/p&gt;
+  &lt;ul&gt;&lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid URI reference &lt;a href=#refsRFC3986&gt;[RFC3986]&lt;/a&gt;.&lt;/li&gt;
 
-  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is an &lt;dfn id=absolute-url&gt;absolute URL&lt;/dfn&gt; if it is an
-  &lt;span&gt;absolute Web address&lt;/span&gt; as defined by the Web addresses
-  specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid IRI reference and it has no
+   query component. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
 
-  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is a &lt;dfn id=hierarchical-url&gt;hierarchical URL&lt;/dfn&gt; if,
-  when &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there is a character
-  immediately after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt;
-  component and it is a U+002F SOLIDUS character (/).&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid IRI reference and its query
+   component contains no unescaped non-ASCII characters. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
 
-  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is an &lt;dfn id=authority-based-url&gt;authority-based URL&lt;/dfn&gt;
-  if, when &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there are two
-  characters immediately after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component and they are both
-  U+002F SOLIDUS characters (//).&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;a href=#url&gt;URL&lt;/a&gt; is a valid IRI reference and the &lt;a href=&quot;#document's-character-encoding&quot; title=&quot;document's character encoding&quot;&gt;character encoding&lt;/a&gt; of
+   the URL's &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; is UTF-8 or UTF-16. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
 
+  &lt;/ul&gt;&lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is a &lt;dfn id=valid-non-empty-url&gt;valid non-empty URL&lt;/dfn&gt; if it is a
+  &lt;a href=#valid-url&gt;valid URL&lt;/a&gt; but it is not the empty string.&lt;/p&gt;
+
   &lt;div class=impl&gt;
 
   &lt;p&gt;To &lt;dfn id=parse-a-url&gt;parse a URL&lt;/dfn&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; into its
-  component parts, the user agent must use the &lt;span&gt;parse a Web
-  address&lt;/span&gt; algorithm defined by the Web addresses
-  specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  component parts, the user agent must use the &lt;span class=XXX&gt;parse
+  an address&lt;/span&gt; algorithm defined by the IRI specification. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;Parsing a URL results in the following components, again as
-  defined by the Web addresses specification:&lt;/p&gt;
+  &lt;p&gt;Parsing a URL can fail. If it does not, then results in the
+  following components, again as defined by the IRI specification:&lt;/p&gt;
 
   &lt;ul class=brief&gt;&lt;li&gt;&lt;dfn id=url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn id=url-host title=url-host&gt;&lt;host&gt;&lt;/dfn&gt;&lt;/li&gt;
@@ -5548,54 +5545,126 @@
    &lt;li&gt;&lt;dfn id=url-query title=url-query&gt;&lt;query&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn id=url-fragment title=url-fragment&gt;&lt;fragment&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn id=url-host-specific title=url-host-specific&gt;&lt;host-specific&gt;&lt;/dfn&gt;&lt;/li&gt;
-  &lt;/ul&gt;&lt;p&gt;To &lt;dfn id=resolve-a-url&gt;resolve a URL&lt;/dfn&gt; to an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
+  &lt;/ul&gt;&lt;hr&gt;&lt;p&gt;To &lt;dfn id=resolve-a-url&gt;resolve a URL&lt;/dfn&gt; to an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
   relative to either another &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; or an element,
-  the user agent must use the &lt;span&gt;resolve a Web address&lt;/span&gt;
-  algorithm defined by the Web addresses specification. &lt;a href=#refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  the user agent must use the following steps. Resolving a URL can
+  result in an error, in which case the URL is not resolvable.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn id=document-base-url&gt;document base URL&lt;/dfn&gt; of a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
-  object is the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; obtained by running these
-  substeps:&lt;/p&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the &lt;a href=#url&gt;URL&lt;/a&gt; being
+   resolved.&lt;/li&gt;
 
-  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; be &lt;a href=&quot;#the-document's-address&quot;&gt;the
-   document's address&lt;/a&gt;.&lt;/li&gt;
+   &lt;li&gt;
 
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; be determined as follows:&lt;/p&gt;
+
+    &lt;dl class=switch&gt;&lt;dt&gt;If the URL had a character encoding defined when the URL was
+     created or defined&lt;/dt&gt;
+
+     &lt;dd&gt;The URL character encoding is as defined.&lt;/dd&gt;
+
+     &lt;dt&gt;If the URL came from a script (e.g. as an argument to a
+     method)&lt;/dt&gt;
+
+     &lt;dd&gt;The URL character encoding is the &lt;a href=&quot;#script's-url-character-encoding&quot;&gt;script's URL character
+     encoding&lt;/a&gt;.&lt;/dd&gt;
+
+     &lt;dt&gt;If the URL came from a DOM node (e.g. from an element)&lt;/dt&gt;
+
+     &lt;dd&gt;The node has a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;, and the URL character
+     encoding is the &lt;a href=&quot;#document's-character-encoding&quot;&gt;document's character encoding&lt;/a&gt;.&lt;/dd&gt;
+
+    &lt;/dl&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; is a UTF-16 encoding, then
+   change the value of &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; to UTF-8.&lt;/li&gt;
+
    &lt;li&gt;
 
-    &lt;!-- <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/">http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/</A> --&gt;
+    &lt;p&gt;If the algorithm was invoked with an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;
+    to use as the base URL, let &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; be that
+    &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;.&lt;/p&gt;
 
-    &lt;!-- this should be tested in the case of a browsing context that
-    was navigated to about:blank after having been elsewhere, as
-    opposed to the about:blank used at the time of the browsing
-    context's creation. --&gt;
+    &lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; be the &lt;i&gt;base URI of
+    the element&lt;/i&gt;, as defined by the XML Base specification, with
+    &lt;i&gt;the base URI of the document entity&lt;/i&gt; being defined as the
+    &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; that
+    owns the element. &lt;a href=#refsXMLBASE&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
 
-    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; is
-    &lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt;, and the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s
-    &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; has a &lt;a href=#creator-browsing-context&gt;creator browsing
-    context&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;
-    be the &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the &lt;a href=#creator-document&gt;creator
-    &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt; instead.&lt;/p&gt;
+    &lt;p&gt;For the purposes of the XML Base specification, user agents
+    must act as if all &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; objects represented XML
+    documents.&lt;/p&gt;
 
-   &lt;/li&gt;
+    &lt;p class=note&gt;It is possible for &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes to be present
+    even in HTML fragments, as such attributes can be added
+    dynamically using script. (Such scripts would not be conforming,
+    however, as &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes
+    are not allowed in &lt;a href=#html-documents&gt;HTML documents&lt;/a&gt;.)&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;If there is no &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; element that is both a
-   child of &lt;a href=#the-head-element&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/a&gt; and has an
-   &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute, then the
-   &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is &lt;var title=&quot;&quot;&gt;fallback base
-   url&lt;/var&gt;.&lt;/li&gt;
+    &lt;p&gt;The &lt;dfn id=document-base-url&gt;document base URL&lt;/dfn&gt; of a &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;
+    object is the &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; obtained by running these
+    substeps:&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the value of the
-   &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute of the first
-   such element.&lt;/li&gt;
+    &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; be &lt;a href=&quot;#the-document's-address&quot;&gt;the
+     document's address&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;a href=#resolve-a-url title=&quot;resolve a URL&quot;&gt;Resolve&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;fallback base
-   url&lt;/var&gt; (thus, the &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute isn't affected by
-   &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes).&lt;/li&gt;
+     &lt;li&gt;
 
-   &lt;li&gt;&lt;p&gt;The &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is the result of the
-   previous step if it was successful; otherwise it is &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;.&lt;/li&gt;
+      &lt;!-- <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/">http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/</A> --&gt;
 
-  &lt;/ol&gt;&lt;p&gt;This specification defines the URL
+      &lt;!-- this should be tested in the case of a browsing context that
+      was navigated to about:blank after having been elsewhere, as
+      opposed to the about:blank used at the time of the browsing
+      context's creation. --&gt;
+
+      &lt;p&gt;If &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; is
+      &lt;code&gt;&lt;a href=#about:blank&gt;about:blank&lt;/a&gt;&lt;/code&gt;, and the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;'s
+      &lt;a href=#browsing-context&gt;browsing context&lt;/a&gt; has a &lt;a href=#creator-browsing-context&gt;creator browsing
+      context&lt;/a&gt;, then let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;
+      be the &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; of the &lt;a href=#creator-document&gt;creator
+      &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt; instead.&lt;/p&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If there is no &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; element that is both a
+     child of &lt;a href=#the-head-element&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/a&gt; and has an
+     &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute, then the
+     &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is &lt;var title=&quot;&quot;&gt;fallback base
+     url&lt;/var&gt;.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the value of the
+     &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute of the first
+     such element.&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;a href=#resolve-a-url title=&quot;resolve a URL&quot;&gt;Resolve&lt;/a&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;fallback base
+     url&lt;/var&gt; (thus, the &lt;code&gt;&lt;a href=#the-base-element&gt;base&lt;/a&gt;&lt;/code&gt; &lt;code title=attr-base-href&gt;&lt;a href=#attr-base-href&gt;href&lt;/a&gt;&lt;/code&gt; attribute isn't affected by
+     &lt;code title=attr-xml-base&gt;&lt;a href=#the-xml:base-attribute-(xml-only)&gt;xml:base&lt;/a&gt;&lt;/code&gt; attributes).&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;The &lt;a href=#document-base-url&gt;document base URL&lt;/a&gt; is the result of the
+     previous step if it was successful; otherwise it is &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;.&lt;/li&gt;
+
+    &lt;/ol&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return the result of applying the &lt;span class=XXX&gt;resolve
+   an address&lt;/span&gt; algorithm defined by the IRI specification to
+   resolve &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; using encoding &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt;. &lt;a href=#refsRFC3987&gt;[RFC3987]&lt;/a&gt;&lt;/li&gt;
+
+  &lt;/ol&gt;&lt;/div&gt;
+
+  &lt;p&gt;A &lt;a href=#url&gt;URL&lt;/a&gt; is an &lt;dfn id=absolute-url&gt;absolute URL&lt;/dfn&gt; if &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolving&lt;/a&gt; it results in the same output
+  regardless of what it is resolved relative to, and that output is
+  not a failure.&lt;/p&gt;
+
+  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is a &lt;dfn id=hierarchical-url&gt;hierarchical URL&lt;/dfn&gt; if,
+  when &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt; and then &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there is a character immediately
+  after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt; component
+  and it is a U+002F SOLIDUS character (/).&lt;/p&gt;
+
+  &lt;p&gt;An &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; is an &lt;dfn id=authority-based-url&gt;authority-based URL&lt;/dfn&gt;
+  if, when &lt;a href=#resolve-a-url title=&quot;resolve a url&quot;&gt;resolved&lt;/a&gt; and then &lt;a href=#parse-a-url title=&quot;parse a url&quot;&gt;parsed&lt;/a&gt;, there are two characters
+  immediately after the &lt;a href=#url-scheme title=url-scheme&gt;&lt;scheme&gt;&lt;/a&gt;
+  component and they are both U+002F SOLIDUS characters (//).&lt;/p&gt;
+
+  &lt;hr&gt;&lt;p&gt;This specification defines the URL
   &lt;dfn id=about:legacy-compat&gt;&lt;code&gt;about:legacy-compat&lt;/code&gt;&lt;/dfn&gt; as a reserved, though
   unresolvable, &lt;code title=&quot;&quot;&gt;about:&lt;/code&gt; URI, for use in &lt;a href=#syntax-doctype title=syntax-doctype&gt;DOCTYPE&lt;/a&gt;s in &lt;a href=#html-documents&gt;HTML
   documents&lt;/a&gt; when needed for compatibility with XML tools. &lt;a href=#refsABOUT&gt;[ABOUT]&lt;/a&gt;&lt;/p&gt;
@@ -5606,8 +5675,6 @@
   &lt;a href=&quot;#the-document's-address&quot;&gt;the document's address&lt;/a&gt; of &lt;a href=#an-iframe-srcdoc-document title=&quot;an iframe srcdoc
   document&quot;&gt;&lt;code&gt;iframe&lt;/code&gt; &lt;code title=attr-iframe-srcdoc&gt;srcdoc&lt;/code&gt; documents&lt;/a&gt;. &lt;a href=#refsABOUT&gt;[ABOUT]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;/div&gt;
-
   &lt;p class=note&gt;The term &quot;URL&quot; in this specification is used in a
   manner distinct from the precise technical meaning it is given in
   RFC 3986. Readers familiar with that RFC will find it easier to read
@@ -83012,11 +83079,6 @@
    Guidelines (WCAG) 2.0&lt;/a&gt;&lt;/cite&gt;, B. Caldwell, M. Cooper, L. Reid,
    G. Vanderheiden. W3C.&lt;/dd&gt;
 
-   &lt;dt id=refsWEBADDRESSES&gt;[WEBADDRESSES]&lt;/dt&gt;
-   &lt;dd&gt;&lt;cite&gt;&lt;a href=<A HREF="http://www.w3.org/html/wg/href/draft">http://www.w3.org/html/wg/href/draft</A>&gt;Web
-   addresses in HTML5&lt;/a&gt;&lt;/cite&gt;, D. Connolly,
-   C. Sperberg-McQueen.&lt;/dd&gt;
-
    &lt;dt id=refsWEBIDL&gt;[WEBIDL]&lt;/dt&gt;
    &lt;!--
    &lt;dd&gt;&lt;cite&gt;&lt;a href=&quot;<A HREF="http://www.w3.org/TR/WebIDL/">http://www.w3.org/TR/WebIDL/</A>&quot;&gt;Web

Modified: source
===================================================================
--- source	2010-04-05 22:52:20 UTC (rev 4973)
+++ source	2010-04-06 00:08:11 UTC (rev 4974)
@@ -5072,39 +5072,44 @@
 
   &lt;h4&gt;Terminology&lt;/h4&gt;
 
+  &lt;!-- see also: svn diff -r3244:3245 source --&gt;
+
   &lt;p&gt;A &lt;dfn&gt;URL&lt;/dfn&gt; is a string used to identify a resource.&lt;/p&gt;
 
-  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is a &lt;dfn&gt;valid URL&lt;/dfn&gt; if it is a
-  &lt;span&gt;valid Web address&lt;/span&gt; as defined by the Web addresses
-  specification. &lt;a href=&quot;#refsWEBADDRESSES&quot;&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is a &lt;dfn&gt;valid URL&lt;/dfn&gt; if at least one of
+  the following conditions holds:&lt;/p&gt;
 
-  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is a &lt;dfn&gt;valid non-empty URL&lt;/dfn&gt; if it is a
-  &lt;span&gt;valid URL&lt;/span&gt; but it is not the empty string.&lt;/p&gt;
+  &lt;ul&gt;
 
-  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is an &lt;dfn&gt;absolute URL&lt;/dfn&gt; if it is an
-  &lt;span&gt;absolute Web address&lt;/span&gt; as defined by the Web addresses
-  specification. &lt;a href=&quot;#refsWEBADDRESSES&quot;&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid URI reference &lt;a
+   href=&quot;#refsRFC3986&quot;&gt;[RFC3986]&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
 
-  &lt;p&gt;An &lt;span&gt;absolute URL&lt;/span&gt; is a &lt;dfn&gt;hierarchical URL&lt;/dfn&gt; if,
-  when &lt;span title=&quot;parse a url&quot;&gt;parsed&lt;/span&gt;, there is a character
-  immediately after the &lt;span title=&quot;url-scheme&quot;&gt;&lt;scheme&gt;&lt;/span&gt;
-  component and it is a U+002F SOLIDUS character (/).&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid IRI reference and it has no
+   query component. &lt;a href=&quot;#refsRFC3987&quot;&gt;[RFC3987]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
 
-  &lt;p&gt;An &lt;span&gt;absolute URL&lt;/span&gt; is an &lt;dfn&gt;authority-based URL&lt;/dfn&gt;
-  if, when &lt;span title=&quot;parse a url&quot;&gt;parsed&lt;/span&gt;, there are two
-  characters immediately after the &lt;span
-  title=&quot;url-scheme&quot;&gt;&lt;scheme&gt;&lt;/span&gt; component and they are both
-  U+002F SOLIDUS characters (//).&lt;/p&gt;
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid IRI reference and its query
+   component contains no unescaped non-ASCII characters. &lt;a
+   href=&quot;#refsRFC3987&quot;&gt;[RFC3987]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
 
+   &lt;li&gt;&lt;p&gt;The &lt;span&gt;URL&lt;/span&gt; is a valid IRI reference and the &lt;span
+   title=&quot;document's character encoding&quot;&gt;character encoding&lt;/span&gt; of
+   the URL's &lt;code&gt;Document&lt;/code&gt; is UTF-8 or UTF-16. &lt;a
+   href=&quot;#refsRFC3987&quot;&gt;[RFC3987]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
+
+  &lt;/ul&gt;
+
+  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is a &lt;dfn&gt;valid non-empty URL&lt;/dfn&gt; if it is a
+  &lt;span&gt;valid URL&lt;/span&gt; but it is not the empty string.&lt;/p&gt;
+
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;p&gt;To &lt;dfn&gt;parse a URL&lt;/dfn&gt; &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; into its
-  component parts, the user agent must use the &lt;span&gt;parse a Web
-  address&lt;/span&gt; algorithm defined by the Web addresses
-  specification. &lt;a href=&quot;#refsWEBADDRESSES&quot;&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  component parts, the user agent must use the &lt;span class=&quot;XXX&quot;&gt;parse
+  an address&lt;/span&gt; algorithm defined by the IRI specification. &lt;a
+  href=&quot;#refsRFC3987&quot;&gt;[RFC3987]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;p&gt;Parsing a URL results in the following components, again as
-  defined by the Web addresses specification:&lt;/p&gt;
+  &lt;p&gt;Parsing a URL can fail. If it does not, then results in the
+  following components, again as defined by the IRI specification:&lt;/p&gt;
 
   &lt;ul class=&quot;brief&quot;&gt;
    &lt;li&gt;&lt;dfn title=&quot;url-scheme&quot;&gt;&lt;scheme&gt;&lt;/dfn&gt;&lt;/li&gt;
@@ -5115,63 +5120,152 @@
    &lt;li&gt;&lt;dfn title=&quot;url-query&quot;&gt;&lt;query&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn title=&quot;url-fragment&quot;&gt;&lt;fragment&gt;&lt;/dfn&gt;&lt;/li&gt;
    &lt;li&gt;&lt;dfn title=&quot;url-host-specific&quot;&gt;&lt;host-specific&gt;&lt;/dfn&gt;&lt;/li&gt;
-  &lt;/ul&gt; 
+  &lt;/ul&gt;
 
+  &lt;hr&gt;
+
   &lt;p&gt;To &lt;dfn&gt;resolve a URL&lt;/dfn&gt; to an &lt;span&gt;absolute URL&lt;/span&gt;
   relative to either another &lt;span&gt;absolute URL&lt;/span&gt; or an element,
-  the user agent must use the &lt;span&gt;resolve a Web address&lt;/span&gt;
-  algorithm defined by the Web addresses specification. &lt;a
-  href=&quot;#refsWEBADDRESSES&quot;&gt;[WEBADDRESSES]&lt;/a&gt;&lt;/p&gt;
+  the user agent must use the following steps. Resolving a URL can
+  result in an error, in which case the URL is not resolvable.&lt;/p&gt;
 
-  &lt;p&gt;The &lt;dfn&gt;document base URL&lt;/dfn&gt; of a &lt;code&gt;Document&lt;/code&gt;
-  object is the &lt;span&gt;absolute URL&lt;/span&gt; obtained by running these
-  substeps:&lt;/p&gt;
-
   &lt;ol&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; be &lt;span&gt;the
-   document's address&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the &lt;span&gt;URL&lt;/span&gt; being
+   resolved.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;!-- <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/">http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/</A> --&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; be determined as follows:&lt;/p&gt;
 
-    &lt;!-- this should be tested in the case of a browsing context that
-    was navigated to about:blank after having been elsewhere, as
-    opposed to the about:blank used at the time of the browsing
-    context's creation. --&gt;
+    &lt;dl class=&quot;switch&quot;&gt;
 
-    &lt;p&gt;If &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; is
-    &lt;code&gt;about:blank&lt;/code&gt;, and the &lt;code&gt;Document&lt;/code&gt;'s
-    &lt;span&gt;browsing context&lt;/span&gt; has a &lt;span&gt;creator browsing
-    context&lt;/span&gt;, then let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;
-    be the &lt;span&gt;document base URL&lt;/span&gt; of the &lt;span&gt;creator
-    &lt;code&gt;Document&lt;/code&gt;&lt;/span&gt; instead.&lt;/p&gt;
+     &lt;dt&gt;If the URL had a character encoding defined when the URL was
+     created or defined&lt;/dt&gt;
 
+     &lt;dd&gt;The URL character encoding is as defined.&lt;/dd&gt;
+
+     &lt;dt&gt;If the URL came from a script (e.g. as an argument to a
+     method)&lt;/dt&gt;
+
+     &lt;dd&gt;The URL character encoding is the &lt;span&gt;script's URL character
+     encoding&lt;/span&gt;.&lt;/dd&gt;
+
+     &lt;dt&gt;If the URL came from a DOM node (e.g. from an element)&lt;/dt&gt;
+
+     &lt;dd&gt;The node has a &lt;code&gt;Document&lt;/code&gt;, and the URL character
+     encoding is the &lt;span&gt;document's character encoding&lt;/span&gt;.&lt;/dd&gt;
+
+    &lt;/dl&gt;
+
    &lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;If there is no &lt;code&gt;base&lt;/code&gt; element that is both a
-   child of &lt;span&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/span&gt; and has an
-   &lt;code title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute, then the
-   &lt;span&gt;document base URL&lt;/span&gt; is &lt;var title=&quot;&quot;&gt;fallback base
-   url&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;If &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; is a UTF-16 encoding, then
+   change the value of &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt; to UTF-8.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the value of the
-   &lt;code title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute of the first
-   such element.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;
 
-   &lt;li&gt;&lt;p&gt;&lt;span title=&quot;resolve a URL&quot;&gt;Resolve&lt;/span&gt; &lt;var
-   title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;fallback base
-   url&lt;/var&gt; (thus, the &lt;code&gt;base&lt;/code&gt; &lt;code
-   title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute isn't affected by
-   &lt;code title=&quot;attr-xml-base&quot;&gt;xml:base&lt;/code&gt; attributes).&lt;/p&gt;&lt;/li&gt;
+    &lt;p&gt;If the algorithm was invoked with an &lt;span&gt;absolute URL&lt;/span&gt;
+    to use as the base URL, let &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; be that
+    &lt;span&gt;absolute URL&lt;/span&gt;.&lt;/p&gt;
 
-   &lt;li&gt;&lt;p&gt;The &lt;span&gt;document base URL&lt;/span&gt; is the result of the
-   previous step if it was successful; otherwise it is &lt;var
-   title=&quot;&quot;&gt;fallback base url&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+    &lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;base&lt;/var&gt; be the &lt;i&gt;base URI of
+    the element&lt;/i&gt;, as defined by the XML Base specification, with
+    &lt;i&gt;the base URI of the document entity&lt;/i&gt; being defined as the
+    &lt;span&gt;document base URL&lt;/span&gt; of the &lt;code&gt;Document&lt;/code&gt; that
+    owns the element. &lt;a href=&quot;#refsXMLBASE&quot;&gt;[XMLBASE]&lt;/a&gt;&lt;/p&gt;
 
+    &lt;p&gt;For the purposes of the XML Base specification, user agents
+    must act as if all &lt;code&gt;Document&lt;/code&gt; objects represented XML
+    documents.&lt;/p&gt;
+
+    &lt;p class=&quot;note&quot;&gt;It is possible for &lt;code
+    title=&quot;attr-xml-base&quot;&gt;xml:base&lt;/code&gt; attributes to be present
+    even in HTML fragments, as such attributes can be added
+    dynamically using script. (Such scripts would not be conforming,
+    however, as &lt;code title=&quot;attr-xml-base&quot;&gt;xml:base&lt;/code&gt; attributes
+    are not allowed in &lt;span&gt;HTML documents&lt;/span&gt;.)&lt;/p&gt;
+
+    &lt;p&gt;The &lt;dfn&gt;document base URL&lt;/dfn&gt; of a &lt;code&gt;Document&lt;/code&gt;
+    object is the &lt;span&gt;absolute URL&lt;/span&gt; obtained by running these
+    substeps:&lt;/p&gt;
+
+    &lt;ol&gt;
+
+     &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; be &lt;span&gt;the
+     document's address&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;
+
+      &lt;!-- <A HREF="http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/">http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/</A> --&gt;
+
+      &lt;!-- this should be tested in the case of a browsing context that
+      was navigated to about:blank after having been elsewhere, as
+      opposed to the about:blank used at the time of the browsing
+      context's creation. --&gt;
+
+      &lt;p&gt;If &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt; is
+      &lt;code&gt;about:blank&lt;/code&gt;, and the &lt;code&gt;Document&lt;/code&gt;'s
+      &lt;span&gt;browsing context&lt;/span&gt; has a &lt;span&gt;creator browsing
+      context&lt;/span&gt;, then let &lt;var title=&quot;&quot;&gt;fallback base url&lt;/var&gt;
+      be the &lt;span&gt;document base URL&lt;/span&gt; of the &lt;span&gt;creator
+      &lt;code&gt;Document&lt;/code&gt;&lt;/span&gt; instead.&lt;/p&gt;
+
+     &lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;If there is no &lt;code&gt;base&lt;/code&gt; element that is both a
+     child of &lt;span&gt;the &lt;code&gt;head&lt;/code&gt; element&lt;/span&gt; and has an
+     &lt;code title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute, then the
+     &lt;span&gt;document base URL&lt;/span&gt; is &lt;var title=&quot;&quot;&gt;fallback base
+     url&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;Otherwise, let &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; be the value of the
+     &lt;code title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute of the first
+     such element.&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;&lt;span title=&quot;resolve a URL&quot;&gt;Resolve&lt;/span&gt; &lt;var
+     title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var title=&quot;&quot;&gt;fallback base
+     url&lt;/var&gt; (thus, the &lt;code&gt;base&lt;/code&gt; &lt;code
+     title=&quot;attr-base-href&quot;&gt;href&lt;/code&gt; attribute isn't affected by
+     &lt;code title=&quot;attr-xml-base&quot;&gt;xml:base&lt;/code&gt; attributes).&lt;/p&gt;&lt;/li&gt;
+
+     &lt;li&gt;&lt;p&gt;The &lt;span&gt;document base URL&lt;/span&gt; is the result of the
+     previous step if it was successful; otherwise it is &lt;var
+     title=&quot;&quot;&gt;fallback base url&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+    &lt;/ol&gt;
+
+   &lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Return the result of applying the &lt;span class=&quot;XXX&quot;&gt;resolve
+   an address&lt;/span&gt; algorithm defined by the IRI specification to
+   resolve &lt;var title=&quot;&quot;&gt;url&lt;/var&gt; relative to &lt;var
+   title=&quot;&quot;&gt;base&lt;/var&gt; using encoding &lt;var title=&quot;&quot;&gt;encoding&lt;/var&gt;. &lt;a
+   href=&quot;#refsRFC3987&quot;&gt;[RFC3987]&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
+
   &lt;/ol&gt;
 
+  &lt;/div&gt;
+
+  &lt;p&gt;A &lt;span&gt;URL&lt;/span&gt; is an &lt;dfn&gt;absolute URL&lt;/dfn&gt; if &lt;span
+  title=&quot;resolve a url&quot;&gt;resolving&lt;/span&gt; it results in the same output
+  regardless of what it is resolved relative to, and that output is
+  not a failure.&lt;/p&gt;
+
+  &lt;p&gt;An &lt;span&gt;absolute URL&lt;/span&gt; is a &lt;dfn&gt;hierarchical URL&lt;/dfn&gt; if,
+  when &lt;span title=&quot;resolve a url&quot;&gt;resolved&lt;/span&gt; and then &lt;span
+  title=&quot;parse a url&quot;&gt;parsed&lt;/span&gt;, there is a character immediately
+  after the &lt;span title=&quot;url-scheme&quot;&gt;&lt;scheme&gt;&lt;/span&gt; component
+  and it is a U+002F SOLIDUS character (/).&lt;/p&gt;
+
+  &lt;p&gt;An &lt;span&gt;absolute URL&lt;/span&gt; is an &lt;dfn&gt;authority-based URL&lt;/dfn&gt;
+  if, when &lt;span title=&quot;resolve a url&quot;&gt;resolved&lt;/span&gt; and then &lt;span
+  title=&quot;parse a url&quot;&gt;parsed&lt;/span&gt;, there are two characters
+  immediately after the &lt;span title=&quot;url-scheme&quot;&gt;&lt;scheme&gt;&lt;/span&gt;
+  component and they are both U+002F SOLIDUS characters (//).&lt;/p&gt;
+
+  &lt;hr&gt;
+
   &lt;p&gt;This specification defines the URL
   &lt;dfn&gt;&lt;code&gt;about:legacy-compat&lt;/code&gt;&lt;/dfn&gt; as a reserved, though
   unresolvable, &lt;code title=&quot;&quot;&gt;about:&lt;/code&gt; URI, for use in &lt;span
@@ -5187,8 +5281,6 @@
   title=&quot;attr-iframe-srcdoc&quot;&gt;srcdoc&lt;/code&gt; documents&lt;/span&gt;. &lt;a
   href=&quot;#refsABOUT&quot;&gt;[ABOUT]&lt;/a&gt;&lt;/p&gt;
 
-  &lt;/div&gt;
-
   &lt;p class=&quot;note&quot;&gt;The term &quot;URL&quot; in this specification is used in a
   manner distinct from the precise technical meaning it is given in
   RFC 3986. Readers familiar with that RFC will find it easier to read


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011844.html">[html5] r4973 - [e] (0) Clarify that the validityMessage must be	synthesised if necessary.
</A></li>
	<LI>Next message: <A HREF="011846.html">[html5] r4975 - [giow] (0) Make 'fetch' algorithm have a mode where	it doesn't do redirects. Mak [...]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11845">[ date ]</a>
              <a href="thread.html#11845">[ thread ]</a>
              <a href="subject.html#11845">[ subject ]</a>
              <a href="author.html#11845">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
