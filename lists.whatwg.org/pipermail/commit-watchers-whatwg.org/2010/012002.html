<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r5132 - [e] (0) Captions - Stage 17: The logic for updating	active cues, firing events, [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5132%20-%20%5Be%5D%20%280%29%20Captions%20-%20Stage%2017%3A%20The%20logic%20for%20updating%0A%09active%20cues%2C%20firing%20events%2C%20%5B...%5D&In-Reply-To=%3C20100702225708.431231C8C003%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="012001.html">
   <LINK REL="Next"  HREF="012003.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r5132 - [e] (0) Captions - Stage 17: The logic for updating	active cues, firing events, [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5132%20-%20%5Be%5D%20%280%29%20Captions%20-%20Stage%2017%3A%20The%20logic%20for%20updating%0A%09active%20cues%2C%20firing%20events%2C%20%5B...%5D&In-Reply-To=%3C20100702225708.431231C8C003%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r5132 - [e] (0) Captions - Stage 17: The logic for updating	active cues, firing events, [...]">whatwg at whatwg.org
       </A><BR>
    <I>Fri Jul  2 15:57:08 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="012001.html">[html5] r5131 - [e] (0) Captions - Stage 16.2: Rendering rules:	some notes.
</A></li>
        <LI>Next message: <A HREF="012003.html">[html5] r5133 - [e] (0) Captions - Stage 18: domintro blocks for	timed track APIs.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12002">[ date ]</a>
              <a href="thread.html#12002">[ thread ]</a>
              <a href="subject.html#12002">[ subject ]</a>
              <a href="author.html#12002">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2010-07-02 15:57:06 -0700 (Fri, 02 Jul 2010)
New Revision: 5132

Modified:
   complete.html
   index
   source
Log:
[e] (0) Captions - Stage 17: The logic for updating active cues, firing events, and triggering rendering updates; start of the domintro stuff.

Modified: complete.html
===================================================================
--- complete.html	2010-07-01 23:23:47 UTC (rev 5131)
+++ complete.html	2010-07-02 22:57:06 UTC (rev 5132)
@@ -209,7 +209,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1&gt;Web Applications 1.0&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 1 July 2010&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 2 July 2010&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;!--&lt;p class=&quot;impl&quot;&gt;&lt;strong&gt;Implementors!&lt;/strong&gt; We have a &lt;a href=&quot;<A HREF="http://www.whatwg.org/mailing-list#implementors">http://www.whatwg.org/mailing-list#implementors</A>&quot;&gt;mailing list&lt;/a&gt; for you too!&lt;/p&gt;--&gt;
@@ -7920,6 +7920,9 @@
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onchange title=handler-onchange&gt;onchange&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onclick title=handler-onclick&gt;onclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;;
+&lt;!--TT--&gt;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;oncuechange&lt;/a&gt;;
+&lt;!--TT--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;ondblclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondrag title=handler-ondrag&gt;ondrag&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondragend title=handler-ondragend&gt;ondragend&lt;/a&gt;;
@@ -8895,6 +8898,9 @@
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onchange title=handler-onchange&gt;onchange&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onclick title=handler-onclick&gt;onclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;;
+&lt;!--TT--&gt;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;oncuechange&lt;/a&gt;;
+&lt;!--TT--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;ondblclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondrag title=handler-ondrag&gt;ondrag&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondragend title=handler-ondragend&gt;ondragend&lt;/a&gt;;
@@ -8998,6 +9004,9 @@
    &lt;li&gt;&lt;code title=handler-onchange&gt;&lt;a href=#handler-onchange&gt;onchange&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-onclick&gt;&lt;a href=#handler-onclick&gt;onclick&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-oncontextmenu&gt;&lt;a href=#handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
+&lt;!--TT--&gt;
+   &lt;li&gt;&lt;code title=handler-oncuechange&gt;&lt;a href=#handler-oncuechange&gt;oncuechange&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
+&lt;!--TT--&gt;
    &lt;li&gt;&lt;code title=handler-ondblclick&gt;&lt;a href=#handler-ondblclick&gt;ondblclick&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-ondrag&gt;&lt;a href=#handler-ondrag&gt;ondrag&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-ondragend&gt;&lt;a href=#handler-ondragend&gt;ondragend&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
@@ -25683,25 +25692,28 @@
   agent must wait for the steps to complete, and then must immediately
   rerun the steps. (These steps are thus run as often as possible or
   needed &mdash; if one iteration takes a long time, this can cause
-  certain ranges to be skipped over as the user agent rushes ahead to
-  &quot;catch up&quot;.)&lt;/p&gt;
+  certain &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; to be skipped over
+  as the user agent rushes ahead to &quot;catch up&quot;.)&lt;/p&gt;
 
-  &lt;ol&gt;&lt;!--XXXTT - the text below is wrong, but we need to do something similar, updating the timed tracks, pausing if necessary (more below)
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; be an ordered list of
-   &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt;, initialized to contain
-   all the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; of the
-   &lt;span&gt;media element&lt;/span&gt; whose start times are less than or equal
-   to the &lt;span&gt;current playback position&lt;/span&gt; and whose end times
-   are greater than the &lt;span&gt;current playback position&lt;/span&gt;, in the
-   order they were added to the element.&lt;/p&gt;&lt;/li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; be an ordered list of
+   &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;, initialized to contain
+   all the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; of all the &lt;a href=#timed-track-hidden title=&quot;timed track hidden&quot;&gt;hidden&lt;/a&gt; or &lt;a href=#timed-track-showing title=&quot;timed
+   track showing&quot;&gt;showing&lt;/a&gt; &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; of the &lt;a href=#media-element&gt;media element&lt;/a&gt; (not not the &lt;a href=#timed-track-disabled title=&quot;timed track disabled&quot;&gt;disabled&lt;/a&gt; ones) whose &lt;a href=#timed-track-cue-start-time title=&quot;timed track cue start time&quot;&gt;start times&lt;/a&gt; are less than
+   or equal to the &lt;a href=#current-playback-position&gt;current playback position&lt;/a&gt; and whose
+   &lt;a href=#timed-track-cue-end-time title=&quot;timed track cue end time&quot;&gt;end times&lt;/a&gt; are greater
+   than the &lt;a href=#current-playback-position&gt;current playback position&lt;/a&gt;, in &lt;a href=#timed-track-cue-order&gt;timed
+   track cue order&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;other ranges&lt;/var&gt; be an ordered list of
-   &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt;, initialized to contain
-   all the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; of the
-   &lt;span&gt;media element&lt;/span&gt; that are not present in &lt;var
-   title=&quot;&quot;&gt;current ranges&lt;/var&gt;, in the order they were added to the
-   element.&lt;/p&gt;&lt;/li&gt;
---&gt;&lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; be an ordered list of
+   &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;, initialized to contain
+   all the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; of &lt;a href=#timed-track-hidden title=&quot;timed track hidden&quot;&gt;hidden&lt;/a&gt; and &lt;a href=#timed-track-showing title=&quot;timed
+   track showing&quot;&gt;showing&lt;/a&gt; &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; of the &lt;a href=#media-element&gt;media element&lt;/a&gt; that are not
+   present in &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt;, also in &lt;a href=#timed-track-cue-order&gt;timed
+   track cue order&lt;/a&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
    of the current playback position during normal playback, and if the
    user agent has not fired a &lt;code title=event-media-timeupdate&gt;&lt;a href=#event-media-timeupdate&gt;timeupdate&lt;/a&gt;&lt;/code&gt; event at the
    element in the past 15 to 250ms and is not still running event
@@ -25719,47 +25731,69 @@
    not any more frequent than the user agent can comfortably handle
    while decoding the video.&lt;/li&gt;
 
-&lt;!--XXXTT [beware - - nested comments]
-   &lt;li&gt;&lt;p&gt;If none of the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in
-   &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; have their &quot;active&quot; boolean set
-   to &quot;false&quot; (inactive) and none of the &lt;span title=&quot;cue range&quot;&gt;cue
-   ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other ranges&lt;/var&gt; have their
-   &quot;active&quot; boolean set to &quot;true&quot; (active), then abort these
-   steps.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;If all of the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; in
+   &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; have their &lt;a href=#timed-track-cue-active-flag&gt;timed track cue
+   active flag&lt;/a&gt; set, and none of the &lt;a href=#timed-track-cue title=&quot;timed track
+   cue&quot;&gt;cues&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; have their
+   &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; set, then abort these
+   steps.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
    of the current playback position during normal playback, and there
-   are &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var
-   title=&quot;&quot;&gt;other ranges&lt;/var&gt; that have both their &quot;active&quot; boolean
-   and their &quot;pause&quot; boolean set to &quot;true&quot;, then immediately act as if
-   the element's &lt;code title=&quot;dom-media-pause&quot;&gt;pause()&lt;/code&gt; method
-   had been invoked. &lt;!- - pause() can in theory call load(), but never
-   can it do so as part of this invokation, since we wouldn't be in
-   this algorithm if the media element was empty. So, no need to couch
-   all this in a task. - -&gt; (In the other cases, such as explicit
-   seeks, playback is not paused by exiting a cue range, even if that
-   cue range has its &quot;pause&quot; boolean set to &quot;true&quot;.)&lt;/p&gt;&lt;/li&gt;
+   are &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; that have both their &lt;a href=#timed-track-cue-active-flag&gt;timed track
+   cue active flag&lt;/a&gt; set and their &lt;a href=#timed-track-cue-pause-on-exit-flag&gt;timed track cue
+   pause-on-exit flag&lt;/a&gt; set, then immediately act as if the
+   element's &lt;code title=dom-media-pause&gt;&lt;a href=#dom-media-pause&gt;pause()&lt;/a&gt;&lt;/code&gt; method had
+   been invoked. &lt;!-- pause() can in theory call load(), but never can
+   it do so as part of this invokation, since we wouldn't be in this
+   algorithm if the media element was empty. So, no need to couch all
+   this in a task. --&gt; (In the other cases, such as explicit seeks,
+   playback is not paused by going past the end time of a &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cue&lt;/a&gt;, even if that &lt;a href=#timed-track-cue title=&quot;timed
+   track cue&quot;&gt;cue&lt;/a&gt; has its &lt;a href=#timed-track-cue-pause-on-exit-flag&gt;timed track cue pause-on-exit
+   flag&lt;/a&gt; set.)&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;For each non-null &quot;exit&quot; callback of the &lt;span
-   title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other
-   ranges&lt;/var&gt; that have their &quot;active&quot; boolean set to &quot;true&quot;
-   (active), in list order, &lt;span&gt;queue a task&lt;/span&gt; that invokes the
-   callback, passing the cue range's identifier as the callback's only
-   argument.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;affected tracks&lt;/var&gt; be a list of &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed tracks&lt;/a&gt;, initially empty.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;For each non-null &quot;enter&quot; callback of the &lt;span title=&quot;cue
-   range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; that
-   have their &quot;active&quot; boolean set to &quot;false&quot; (inactive), in list
-   order, &lt;span&gt;queue a task&lt;/span&gt; that invokes the callback, passing
-   the cue range's identifier as the callback's only
-   argument.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;For each &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track
+   cue&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; that has its
+   &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; set, in list order,
+   &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named
+   &lt;code title=event-exit&gt;exit&lt;/code&gt; at the
+   &lt;code&gt;&lt;a href=#timedtrackcue&gt;TimedTrackCue&lt;/a&gt;&lt;/code&gt; object, and add the &lt;a href=#timed-track-cue title=&quot;timed
+   track cue&quot;&gt;cue&lt;/a&gt;'s &lt;a href=#timed-track&gt;timed track&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;affected tracks&lt;/var&gt;, if it's not already in the
+   list.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Set the &quot;active&quot; boolean of all the &lt;span title=&quot;cue
-   range&quot;&gt;cue ranges&lt;/span&gt; in the &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt;
-   list to &quot;true&quot; (active), and the &quot;active&quot; boolean of all the &lt;span
-   title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in the &lt;var title=&quot;&quot;&gt;other
-   ranges&lt;/var&gt; list to &quot;false&quot; (inactive).&lt;/p&gt;&lt;/li&gt;
---&gt;
+   &lt;li&gt;&lt;p&gt;For each &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track
+   cue&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; that does not have
+   its &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; set, in list order,
+   &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named
+   &lt;code title=event-enter&gt;enter&lt;/code&gt; at the
+   &lt;code&gt;&lt;a href=#timedtrackcue&gt;TimedTrackCue&lt;/a&gt;&lt;/code&gt; object, and add the &lt;a href=#timed-track-cue title=&quot;timed
+   track cue&quot;&gt;cue&lt;/a&gt;'s &lt;a href=#timed-track&gt;timed track&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;affected tracks&lt;/var&gt;, if it's not already in the
+   list.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;For each &lt;a href=#timed-track&gt;timed track&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;affected
+   tracks&lt;/var&gt;, in the order they were added to the list (which will
+   match the relative order of the &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; in the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#list-of-timed-tracks&gt;list of
+   timed tracks&lt;/a&gt;), &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a
+   simple event&lt;/a&gt; named &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt; at the
+   &lt;code&gt;&lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt;&lt;/code&gt; object, and, if the &lt;a href=#timed-track&gt;timed
+   track&lt;/a&gt; has a corresponding &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; element, to
+   then &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt; at the &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt;
+   element as well.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set the &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; of all the
+   &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; in the &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt;, and unset the &lt;a href=#timed-track-cue-active-flag&gt;timed track cue
+   active flag&lt;/a&gt; of all the &lt;a href=#timed-track-cue title=&quot;timed track
+   cue&quot;&gt;cues&lt;/a&gt; in the &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Run the rules for rendering the cues of each of the &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed tracks&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;affected
+   tracks&lt;/var&gt; that are &lt;a href=#timed-track-showing title=&quot;timed track
+   showing&quot;&gt;showing&lt;/a&gt; (e.g., for &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; based on &lt;a href=#websrt&gt;WebSRT&lt;/a&gt;, the &lt;a href=#rules-for-updating-the-display-of-websrt-timed-tracks&gt;rules for
+   updating the display of WebSRT timed tracks&lt;/a&gt;).&lt;/li&gt;
+
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#media-element&gt;media element&lt;/a&gt; is &lt;a href=#remove-an-element-from-a-document title=&quot;remove an
   element from a document&quot;&gt;removed from a
   &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt;, if the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s
@@ -26098,7 +26132,10 @@
 
    &lt;dd&gt;
 
-    &lt;p&gt;A list of &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track cues&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;A list of &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track
+    cues&lt;/a&gt;, along with rules for their rendering (e.g., for
+    &lt;a href=#websrt&gt;WebSRT&lt;/a&gt;, the &lt;a href=#rules-for-updating-the-display-of-websrt-timed-tracks&gt;rules for updating the display of
+    WebSRT timed tracks&lt;/a&gt;).&lt;/p&gt;
 
     &lt;p&gt;The &lt;a href=#timed-track-list-of-cues title=&quot;timed track list of cues&quot;&gt;list of cues of a
     timed track&lt;/a&gt; can change dynamically, either because the
@@ -26253,7 +26290,41 @@
   cue&lt;/a&gt; is associated with a particular &lt;a href=#timed-track&gt;timed track&lt;/a&gt;,
   the association is permanent.&lt;/p&gt;
 
+  &lt;p&gt;In addition, each &lt;a href=#timed-track-cue&gt;timed track cue&lt;/a&gt; has two pieces of
+  dynamic information:&lt;/p&gt;
 
+  &lt;dl&gt;&lt;dt&gt;The &lt;dfn id=timed-track-cue-active-flag title=&quot;timed track cue active flag&quot;&gt;active flag&lt;/dfn&gt;
+   &lt;dd&gt;
+    &lt;p&gt;This flag must be initially unset. It is used to ensure events
+    are fired appropriately when the cue becomes active or
+    inactive.&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt&gt;The &lt;dfn id=timed-track-cue-display-state title=&quot;timed track cue display state&quot;&gt;display state&lt;/dfn&gt;
+   &lt;dd&gt;
+    &lt;p&gt;This is used as part of the rendering model.&lt;/p&gt;
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p&gt;The &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track cues&lt;/a&gt; of a
+  &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+  tracks&lt;/a&gt; are ordered relative to each other in the &lt;dfn id=timed-track-cue-order&gt;timed
+  track cue order&lt;/dfn&gt;, which is determined as follows: first group
+  the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; by their &lt;a href=#timed-track&gt;timed
+  track&lt;/a&gt;, with the groups being sorted in the same order as
+  their &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed tracks&lt;/a&gt; appear in the
+  &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#list-of-timed-tracks&gt;list of timed tracks&lt;/a&gt;;
+  then, within each group, &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;
+  must be sorted by their &lt;a href=#timed-track-cue-start-time title=&quot;timed track cue start
+  time&quot;&gt;start time&lt;/a&gt;, earliest first; then, any &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; with the same &lt;a href=#timed-track-cue-start-time title=&quot;timed
+  track cue start time&quot;&gt;start time&lt;/a&gt; must be sorted by their
+  &lt;a href=#timed-track-cue-end-time title=&quot;timed track cue end time&quot;&gt;end time&lt;/a&gt;, earliest
+  first; and finally, any &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;
+  with identical &lt;a href=#timed-track-cue-end-time title=&quot;timed track cue end time&quot;&gt;end
+  times&lt;/a&gt; must be sorted in the order they were created (so
+  e.g. for cues from a &lt;a href=#websrt&gt;WebSRT&lt;/a&gt; file, that would be the
+  order in which the cues were listed in the file).&lt;/p&gt;
+
+
   &lt;h6 id=sourcing-in-band-timed-tracks&gt;&lt;span class=secno&gt;4.8.10.10.2 &lt;/span&gt;Sourcing in-band timed tracks&lt;/h6&gt;
 
   &lt;p&gt;A &lt;dfn id=media-resource-specific-timed-track&gt;media-resource-specific timed track&lt;/dfn&gt; is a &lt;a href=#timed-track&gt;timed
@@ -26634,6 +26705,8 @@
   // timed tracks
   readonly attribute &lt;span&gt;TimedTrack&lt;/span&gt;[] &lt;span title=&quot;dom-media-tracks&quot;&gt;tracks&lt;/span&gt;;
   &lt;span&gt;MutableTimedTrack&lt;/span&gt; &lt;span title=&quot;dom-media-addTrack&quot;&gt;addTrack&lt;/span&gt;(in DOMString label, in DOMString kind, in DOMString language);
+
+ - addTrack should add it as Loaded, Disabled, and with the rules for WebSRT.
 --&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=timedtrack&gt;TimedTrack&lt;/dfn&gt; {
@@ -26656,8 +26729,8 @@
 
   readonly attribute &lt;a href=#timedtrackcuelist&gt;TimedTrackCueList&lt;/a&gt; &lt;span title=dom-TimedTrack-cues&gt;cues&lt;/span&gt;;
   readonly attribute &lt;a href=#timedtrackcuelist&gt;TimedTrackCueList&lt;/a&gt; &lt;span title=dom-TimedTrack-activeCues&gt;activeCues&lt;/span&gt;;
-  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrack-onentercue&gt;onentercue&lt;/span&gt;;
-  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrack-onexitcue&gt;onexitcue&lt;/span&gt;;
+
+  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrack-oncuechange&gt;oncuechange&lt;/span&gt;;
 };
 
 interface &lt;dfn id=mutabletimedtrack&gt;MutableTimedTrack&lt;/dfn&gt; : &lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt; {
@@ -26690,12 +26763,31 @@
   readonly attribute DOMString &lt;span title=dom-TimedTrackCue-voice&gt;voice&lt;/span&gt;;
   DOMString &lt;span title=dom-TimedTrackCue-getCueAsSource()&gt;getCueAsSource&lt;/span&gt;();
   &lt;a href=#documentfragment&gt;DocumentFragment&lt;/a&gt; &lt;span title=dom-TimedTrackCue-getCueAsHTML()&gt;getCueAsHTML&lt;/span&gt;();
+
+  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrackCue-onenter&gt;onenter&lt;/span&gt;;
+  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrackCue-onexit&gt;onexit&lt;/span&gt;;
 };&lt;/pre&gt;
 
-  &lt;p class=XXX&gt;domintro
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;media&lt;/var&gt; . &lt;code title=dom-media-tracks&gt;tracks&lt;/code&gt; . &lt;code title=&quot;&quot;&gt;length&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the number of timed tracks associated with the element (e.g. from &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; elements).&lt;/p&gt;
+   &lt;/dd&gt;
 
-  &lt;div class=impl&gt;
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;media&lt;/var&gt; . &lt;code title=dom-media-tracks&gt;tracks[&lt;var title=&quot;&quot;&gt;n&lt;/var&gt;]&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the &lt;code&gt;&lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt;&lt;/code&gt; object representing the &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th timed track.&lt;/p&gt;
+   &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;track&lt;/var&gt; . &lt;code title=dom-track-track&gt;&lt;a href=#dom-track-track&gt;track&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the &lt;code&gt;&lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt;&lt;/code&gt; object representing the &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; element's timed track.&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt class=XXX&gt;...&lt;/dt&gt;
+   &lt;dd class=XXX&gt;...&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;div class=impl&gt;
+
   &lt;p class=XXX&gt;...
 
   &lt;!-- XXX
@@ -26707,6 +26799,10 @@
   entirely prior to the &lt;span&gt;media resource&lt;/span&gt;'s &lt;span&gt;earliest
   possible position&lt;/span&gt;.&lt;/p&gt;
 
+  changing dom-TimedTrack-mode to disabled/hidden should hide all the
+  titles, changing it to showing should show them. (Only 'showing'
+  tracks get updated automatically.)
+
   --&gt;
 
   &lt;/div&gt;
@@ -26716,12 +26812,7 @@
 
   &lt;p class=XXX&gt;...
 
-&lt;!-- XXX
-CueEvent
- readonly attribute TimedTrackCue cue;
---&gt;
 
-
   &lt;h5 id=websrt-0&gt;&lt;span class=secno&gt;4.8.10.11 &lt;/span&gt;WebSRT&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=websrt&gt;WebSRT&lt;/dfn&gt; format (Web Subtitle Resource Tracks) is a
@@ -56323,6 +56414,9 @@
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onchange title=handler-onchange&gt;onchange&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onclick title=handler-onclick&gt;onclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;;
+&lt;!--TT--&gt;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;oncuechange&lt;/a&gt;;
+&lt;!--TT--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;ondblclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondrag title=handler-ondrag&gt;ondrag&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondragend title=handler-ondragend&gt;ondragend&lt;/a&gt;;
@@ -62579,6 +62673,9 @@
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-onchange title=handler-onchange&gt;&lt;code&gt;onchange&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-change&gt;change&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-onclick title=handler-onclick&gt;&lt;code&gt;onclick&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-click&gt;&lt;a href=#event-click&gt;click&lt;/a&gt;&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-oncontextmenu title=handler-oncontextmenu&gt;&lt;code&gt;oncontextmenu&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-contextmenu&gt;contextmenu&lt;/code&gt; &lt;!-- widely used --&gt;
+&lt;!--TT--&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-oncuechange title=handler-oncuechange&gt;&lt;code&gt;oncuechange&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt;
+&lt;!--TT--&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-ondblclick title=handler-ondblclick&gt;&lt;code&gt;ondblclick&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-dblclick&gt;dblclick&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-ondrag title=handler-ondrag&gt;&lt;code&gt;ondrag&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-drag&gt;&lt;a href=#event-drag&gt;drag&lt;/a&gt;&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-ondragend title=handler-ondragend&gt;&lt;code&gt;ondragend&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-dragend&gt;&lt;a href=#event-dragend&gt;dragend&lt;/a&gt;&lt;/code&gt;
@@ -85594,7 +85691,7 @@
 
   &lt;h5 id=websrt-cue-text-rendering-rules&gt;&lt;span class=secno&gt;14.3.2.1 &lt;/span&gt;&lt;dfn&gt;WebSRT cue text rendering rules&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p class=XXX&gt;
+  &lt;p class=XXX&gt;The &lt;dfn id=rules-for-updating-the-display-of-websrt-timed-tracks&gt;rules for updating the display of WebSRT timed tracks&lt;/dfn&gt;
 
   &lt;!--
 
@@ -91194,6 +91291,12 @@
      &lt;td&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;HTML elements&lt;/a&gt;
      &lt;td&gt; &lt;code title=event-contextmenu&gt;contextmenu&lt;/code&gt; event handler
      &lt;td&gt; &lt;a href=#event-handler-content-attributes title=&quot;event handler content attributes&quot;&gt;Event handler content attribute&lt;/a&gt;
+&lt;!--TT--&gt;
+    &lt;tr&gt;&lt;th&gt; &lt;code title=&quot;&quot;&gt;oncuechange&lt;/code&gt;
+     &lt;td&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;HTML elements&lt;/a&gt;
+     &lt;td&gt; &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt; event handler
+     &lt;td&gt; &lt;a href=#event-handler-content-attributes title=&quot;event handler content attributes&quot;&gt;Event handler content attribute&lt;/a&gt;
+&lt;!--TT--&gt;
 
     &lt;tr&gt;&lt;th&gt; &lt;code title=&quot;&quot;&gt;ondblclick&lt;/code&gt;
      &lt;td&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;HTML elements&lt;/a&gt;

Modified: index
===================================================================
--- index	2010-07-01 23:23:47 UTC (rev 5131)
+++ index	2010-07-02 22:57:06 UTC (rev 5132)
@@ -213,7 +213,7 @@
 
   &lt;header class=head id=head&gt;&lt;p&gt;&lt;a class=logo href=<A HREF="http://www.whatwg.org/">http://www.whatwg.org/</A> rel=home&gt;&lt;img alt=WHATWG src=/images/logo&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;hgroup&gt;&lt;h1&gt;HTML5 (including next generation additions still in development)&lt;/h1&gt;
-    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 1 July 2010&lt;/h2&gt;
+    &lt;h2 class=&quot;no-num no-toc&quot;&gt;Draft Standard &mdash; 2 July 2010&lt;/h2&gt;
    &lt;/hgroup&gt;&lt;p&gt;You can take part in this work. &lt;a href=<A HREF="http://www.whatwg.org/mailing-list">http://www.whatwg.org/mailing-list</A>&gt;Join the working group's discussion list.&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;Web designers!&lt;/strong&gt; We have a &lt;a href=<A HREF="http://blog.whatwg.org/faq/">http://blog.whatwg.org/faq/</A>&gt;FAQ&lt;/a&gt;, a &lt;a href=<A HREF="http://forums.whatwg.org/">http://forums.whatwg.org/</A>&gt;forum&lt;/a&gt;, and a &lt;a href=<A HREF="http://www.whatwg.org/mailing-list#help">http://www.whatwg.org/mailing-list#help</A>&gt;help mailing list&lt;/a&gt; for you!&lt;/p&gt;
    &lt;!--&lt;p class=&quot;impl&quot;&gt;&lt;strong&gt;Implementors!&lt;/strong&gt; We have a &lt;a href=&quot;<A HREF="http://www.whatwg.org/mailing-list#implementors">http://www.whatwg.org/mailing-list#implementors</A>&quot;&gt;mailing list&lt;/a&gt; for you too!&lt;/p&gt;--&gt;
@@ -7844,6 +7844,9 @@
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onchange title=handler-onchange&gt;onchange&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onclick title=handler-onclick&gt;onclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;;
+&lt;!--TT--&gt;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;oncuechange&lt;/a&gt;;
+&lt;!--TT--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;ondblclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondrag title=handler-ondrag&gt;ondrag&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondragend title=handler-ondragend&gt;ondragend&lt;/a&gt;;
@@ -8819,6 +8822,9 @@
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onchange title=handler-onchange&gt;onchange&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onclick title=handler-onclick&gt;onclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;;
+&lt;!--TT--&gt;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;oncuechange&lt;/a&gt;;
+&lt;!--TT--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;ondblclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondrag title=handler-ondrag&gt;ondrag&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondragend title=handler-ondragend&gt;ondragend&lt;/a&gt;;
@@ -8922,6 +8928,9 @@
    &lt;li&gt;&lt;code title=handler-onchange&gt;&lt;a href=#handler-onchange&gt;onchange&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-onclick&gt;&lt;a href=#handler-onclick&gt;onclick&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-oncontextmenu&gt;&lt;a href=#handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
+&lt;!--TT--&gt;
+   &lt;li&gt;&lt;code title=handler-oncuechange&gt;&lt;a href=#handler-oncuechange&gt;oncuechange&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
+&lt;!--TT--&gt;
    &lt;li&gt;&lt;code title=handler-ondblclick&gt;&lt;a href=#handler-ondblclick&gt;ondblclick&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-ondrag&gt;&lt;a href=#handler-ondrag&gt;ondrag&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=handler-ondragend&gt;&lt;a href=#handler-ondragend&gt;ondragend&lt;/a&gt;&lt;/code&gt;&lt;/li&gt;
@@ -25610,25 +25619,28 @@
   agent must wait for the steps to complete, and then must immediately
   rerun the steps. (These steps are thus run as often as possible or
   needed &mdash; if one iteration takes a long time, this can cause
-  certain ranges to be skipped over as the user agent rushes ahead to
-  &quot;catch up&quot;.)&lt;/p&gt;
+  certain &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; to be skipped over
+  as the user agent rushes ahead to &quot;catch up&quot;.)&lt;/p&gt;
 
-  &lt;ol&gt;&lt;!--XXXTT - the text below is wrong, but we need to do something similar, updating the timed tracks, pausing if necessary (more below)
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; be an ordered list of
-   &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt;, initialized to contain
-   all the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; of the
-   &lt;span&gt;media element&lt;/span&gt; whose start times are less than or equal
-   to the &lt;span&gt;current playback position&lt;/span&gt; and whose end times
-   are greater than the &lt;span&gt;current playback position&lt;/span&gt;, in the
-   order they were added to the element.&lt;/p&gt;&lt;/li&gt;
+  &lt;ol&gt;&lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; be an ordered list of
+   &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;, initialized to contain
+   all the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; of all the &lt;a href=#timed-track-hidden title=&quot;timed track hidden&quot;&gt;hidden&lt;/a&gt; or &lt;a href=#timed-track-showing title=&quot;timed
+   track showing&quot;&gt;showing&lt;/a&gt; &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; of the &lt;a href=#media-element&gt;media element&lt;/a&gt; (not not the &lt;a href=#timed-track-disabled title=&quot;timed track disabled&quot;&gt;disabled&lt;/a&gt; ones) whose &lt;a href=#timed-track-cue-start-time title=&quot;timed track cue start time&quot;&gt;start times&lt;/a&gt; are less than
+   or equal to the &lt;a href=#current-playback-position&gt;current playback position&lt;/a&gt; and whose
+   &lt;a href=#timed-track-cue-end-time title=&quot;timed track cue end time&quot;&gt;end times&lt;/a&gt; are greater
+   than the &lt;a href=#current-playback-position&gt;current playback position&lt;/a&gt;, in &lt;a href=#timed-track-cue-order&gt;timed
+   track cue order&lt;/a&gt;.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;other ranges&lt;/var&gt; be an ordered list of
-   &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt;, initialized to contain
-   all the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; of the
-   &lt;span&gt;media element&lt;/span&gt; that are not present in &lt;var
-   title=&quot;&quot;&gt;current ranges&lt;/var&gt;, in the order they were added to the
-   element.&lt;/p&gt;&lt;/li&gt;
---&gt;&lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; be an ordered list of
+   &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;, initialized to contain
+   all the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; of &lt;a href=#timed-track-hidden title=&quot;timed track hidden&quot;&gt;hidden&lt;/a&gt; and &lt;a href=#timed-track-showing title=&quot;timed
+   track showing&quot;&gt;showing&lt;/a&gt; &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; of the &lt;a href=#media-element&gt;media element&lt;/a&gt; that are not
+   present in &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt;, also in &lt;a href=#timed-track-cue-order&gt;timed
+   track cue order&lt;/a&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
    of the current playback position during normal playback, and if the
    user agent has not fired a &lt;code title=event-media-timeupdate&gt;&lt;a href=#event-media-timeupdate&gt;timeupdate&lt;/a&gt;&lt;/code&gt; event at the
    element in the past 15 to 250ms and is not still running event
@@ -25646,47 +25658,69 @@
    not any more frequent than the user agent can comfortably handle
    while decoding the video.&lt;/li&gt;
 
-&lt;!--XXXTT [beware - - nested comments]
-   &lt;li&gt;&lt;p&gt;If none of the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in
-   &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; have their &quot;active&quot; boolean set
-   to &quot;false&quot; (inactive) and none of the &lt;span title=&quot;cue range&quot;&gt;cue
-   ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other ranges&lt;/var&gt; have their
-   &quot;active&quot; boolean set to &quot;true&quot; (active), then abort these
-   steps.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;If all of the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; in
+   &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; have their &lt;a href=#timed-track-cue-active-flag&gt;timed track cue
+   active flag&lt;/a&gt; set, and none of the &lt;a href=#timed-track-cue title=&quot;timed track
+   cue&quot;&gt;cues&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; have their
+   &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; set, then abort these
+   steps.&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
    of the current playback position during normal playback, and there
-   are &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var
-   title=&quot;&quot;&gt;other ranges&lt;/var&gt; that have both their &quot;active&quot; boolean
-   and their &quot;pause&quot; boolean set to &quot;true&quot;, then immediately act as if
-   the element's &lt;code title=&quot;dom-media-pause&quot;&gt;pause()&lt;/code&gt; method
-   had been invoked. &lt;!- - pause() can in theory call load(), but never
-   can it do so as part of this invokation, since we wouldn't be in
-   this algorithm if the media element was empty. So, no need to couch
-   all this in a task. - -&gt; (In the other cases, such as explicit
-   seeks, playback is not paused by exiting a cue range, even if that
-   cue range has its &quot;pause&quot; boolean set to &quot;true&quot;.)&lt;/p&gt;&lt;/li&gt;
+   are &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; that have both their &lt;a href=#timed-track-cue-active-flag&gt;timed track
+   cue active flag&lt;/a&gt; set and their &lt;a href=#timed-track-cue-pause-on-exit-flag&gt;timed track cue
+   pause-on-exit flag&lt;/a&gt; set, then immediately act as if the
+   element's &lt;code title=dom-media-pause&gt;&lt;a href=#dom-media-pause&gt;pause()&lt;/a&gt;&lt;/code&gt; method had
+   been invoked. &lt;!-- pause() can in theory call load(), but never can
+   it do so as part of this invokation, since we wouldn't be in this
+   algorithm if the media element was empty. So, no need to couch all
+   this in a task. --&gt; (In the other cases, such as explicit seeks,
+   playback is not paused by going past the end time of a &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cue&lt;/a&gt;, even if that &lt;a href=#timed-track-cue title=&quot;timed
+   track cue&quot;&gt;cue&lt;/a&gt; has its &lt;a href=#timed-track-cue-pause-on-exit-flag&gt;timed track cue pause-on-exit
+   flag&lt;/a&gt; set.)&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;For each non-null &quot;exit&quot; callback of the &lt;span
-   title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other
-   ranges&lt;/var&gt; that have their &quot;active&quot; boolean set to &quot;true&quot;
-   (active), in list order, &lt;span&gt;queue a task&lt;/span&gt; that invokes the
-   callback, passing the cue range's identifier as the callback's only
-   argument.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;affected tracks&lt;/var&gt; be a list of &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed tracks&lt;/a&gt;, initially empty.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;For each non-null &quot;enter&quot; callback of the &lt;span title=&quot;cue
-   range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; that
-   have their &quot;active&quot; boolean set to &quot;false&quot; (inactive), in list
-   order, &lt;span&gt;queue a task&lt;/span&gt; that invokes the callback, passing
-   the cue range's identifier as the callback's only
-   argument.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;For each &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track
+   cue&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; that has its
+   &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; set, in list order,
+   &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named
+   &lt;code title=event-exit&gt;exit&lt;/code&gt; at the
+   &lt;code&gt;&lt;a href=#timedtrackcue&gt;TimedTrackCue&lt;/a&gt;&lt;/code&gt; object, and add the &lt;a href=#timed-track-cue title=&quot;timed
+   track cue&quot;&gt;cue&lt;/a&gt;'s &lt;a href=#timed-track&gt;timed track&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;affected tracks&lt;/var&gt;, if it's not already in the
+   list.&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Set the &quot;active&quot; boolean of all the &lt;span title=&quot;cue
-   range&quot;&gt;cue ranges&lt;/span&gt; in the &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt;
-   list to &quot;true&quot; (active), and the &quot;active&quot; boolean of all the &lt;span
-   title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in the &lt;var title=&quot;&quot;&gt;other
-   ranges&lt;/var&gt; list to &quot;false&quot; (inactive).&lt;/p&gt;&lt;/li&gt;
---&gt;
+   &lt;li&gt;&lt;p&gt;For each &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track
+   cue&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; that does not have
+   its &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; set, in list order,
+   &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named
+   &lt;code title=event-enter&gt;enter&lt;/code&gt; at the
+   &lt;code&gt;&lt;a href=#timedtrackcue&gt;TimedTrackCue&lt;/a&gt;&lt;/code&gt; object, and add the &lt;a href=#timed-track-cue title=&quot;timed
+   track cue&quot;&gt;cue&lt;/a&gt;'s &lt;a href=#timed-track&gt;timed track&lt;/a&gt; to &lt;var title=&quot;&quot;&gt;affected tracks&lt;/var&gt;, if it's not already in the
+   list.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;For each &lt;a href=#timed-track&gt;timed track&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;affected
+   tracks&lt;/var&gt;, in the order they were added to the list (which will
+   match the relative order of the &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; in the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#list-of-timed-tracks&gt;list of
+   timed tracks&lt;/a&gt;), &lt;a href=#queue-a-task&gt;queue a task&lt;/a&gt; to &lt;a href=#fire-a-simple-event&gt;fire a
+   simple event&lt;/a&gt; named &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt; at the
+   &lt;code&gt;&lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt;&lt;/code&gt; object, and, if the &lt;a href=#timed-track&gt;timed
+   track&lt;/a&gt; has a corresponding &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; element, to
+   then &lt;a href=#fire-a-simple-event&gt;fire a simple event&lt;/a&gt; named &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt; at the &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt;
+   element as well.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set the &lt;a href=#timed-track-cue-active-flag&gt;timed track cue active flag&lt;/a&gt; of all the
+   &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; in the &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt;, and unset the &lt;a href=#timed-track-cue-active-flag&gt;timed track cue
+   active flag&lt;/a&gt; of all the &lt;a href=#timed-track-cue title=&quot;timed track
+   cue&quot;&gt;cues&lt;/a&gt; in the &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt;.&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Run the rules for rendering the cues of each of the &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed tracks&lt;/a&gt; in &lt;var title=&quot;&quot;&gt;affected
+   tracks&lt;/var&gt; that are &lt;a href=#timed-track-showing title=&quot;timed track
+   showing&quot;&gt;showing&lt;/a&gt; (e.g., for &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/a&gt; based on &lt;a href=#websrt&gt;WebSRT&lt;/a&gt;, the &lt;a href=#rules-for-updating-the-display-of-websrt-timed-tracks&gt;rules for
+   updating the display of WebSRT timed tracks&lt;/a&gt;).&lt;/li&gt;
+
   &lt;/ol&gt;&lt;p&gt;When a &lt;a href=#media-element&gt;media element&lt;/a&gt; is &lt;a href=#remove-an-element-from-a-document title=&quot;remove an
   element from a document&quot;&gt;removed from a
   &lt;code&gt;Document&lt;/code&gt;&lt;/a&gt;, if the &lt;a href=#media-element&gt;media element&lt;/a&gt;'s
@@ -26025,7 +26059,10 @@
 
    &lt;dd&gt;
 
-    &lt;p&gt;A list of &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track cues&lt;/a&gt;.&lt;/p&gt;
+    &lt;p&gt;A list of &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track
+    cues&lt;/a&gt;, along with rules for their rendering (e.g., for
+    &lt;a href=#websrt&gt;WebSRT&lt;/a&gt;, the &lt;a href=#rules-for-updating-the-display-of-websrt-timed-tracks&gt;rules for updating the display of
+    WebSRT timed tracks&lt;/a&gt;).&lt;/p&gt;
 
     &lt;p&gt;The &lt;a href=#timed-track-list-of-cues title=&quot;timed track list of cues&quot;&gt;list of cues of a
     timed track&lt;/a&gt; can change dynamically, either because the
@@ -26180,7 +26217,41 @@
   cue&lt;/a&gt; is associated with a particular &lt;a href=#timed-track&gt;timed track&lt;/a&gt;,
   the association is permanent.&lt;/p&gt;
 
+  &lt;p&gt;In addition, each &lt;a href=#timed-track-cue&gt;timed track cue&lt;/a&gt; has two pieces of
+  dynamic information:&lt;/p&gt;
 
+  &lt;dl&gt;&lt;dt&gt;The &lt;dfn id=timed-track-cue-active-flag title=&quot;timed track cue active flag&quot;&gt;active flag&lt;/dfn&gt;
+   &lt;dd&gt;
+    &lt;p&gt;This flag must be initially unset. It is used to ensure events
+    are fired appropriately when the cue becomes active or
+    inactive.&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt&gt;The &lt;dfn id=timed-track-cue-display-state title=&quot;timed track cue display state&quot;&gt;display state&lt;/dfn&gt;
+   &lt;dd&gt;
+    &lt;p&gt;This is used as part of the rendering model.&lt;/p&gt;
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;p&gt;The &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;timed track cues&lt;/a&gt; of a
+  &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed
+  tracks&lt;/a&gt; are ordered relative to each other in the &lt;dfn id=timed-track-cue-order&gt;timed
+  track cue order&lt;/dfn&gt;, which is determined as follows: first group
+  the &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; by their &lt;a href=#timed-track&gt;timed
+  track&lt;/a&gt;, with the groups being sorted in the same order as
+  their &lt;a href=#timed-track title=&quot;timed track&quot;&gt;timed tracks&lt;/a&gt; appear in the
+  &lt;a href=#media-element&gt;media element&lt;/a&gt;'s &lt;a href=#list-of-timed-tracks&gt;list of timed tracks&lt;/a&gt;;
+  then, within each group, &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;
+  must be sorted by their &lt;a href=#timed-track-cue-start-time title=&quot;timed track cue start
+  time&quot;&gt;start time&lt;/a&gt;, earliest first; then, any &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt; with the same &lt;a href=#timed-track-cue-start-time title=&quot;timed
+  track cue start time&quot;&gt;start time&lt;/a&gt; must be sorted by their
+  &lt;a href=#timed-track-cue-end-time title=&quot;timed track cue end time&quot;&gt;end time&lt;/a&gt;, earliest
+  first; and finally, any &lt;a href=#timed-track-cue title=&quot;timed track cue&quot;&gt;cues&lt;/a&gt;
+  with identical &lt;a href=#timed-track-cue-end-time title=&quot;timed track cue end time&quot;&gt;end
+  times&lt;/a&gt; must be sorted in the order they were created (so
+  e.g. for cues from a &lt;a href=#websrt&gt;WebSRT&lt;/a&gt; file, that would be the
+  order in which the cues were listed in the file).&lt;/p&gt;
+
+
   &lt;h6 id=sourcing-in-band-timed-tracks&gt;&lt;span class=secno&gt;4.8.10.10.2 &lt;/span&gt;Sourcing in-band timed tracks&lt;/h6&gt;
 
   &lt;p&gt;A &lt;dfn id=media-resource-specific-timed-track&gt;media-resource-specific timed track&lt;/dfn&gt; is a &lt;a href=#timed-track&gt;timed
@@ -26561,6 +26632,8 @@
   // timed tracks
   readonly attribute &lt;span&gt;TimedTrack&lt;/span&gt;[] &lt;span title=&quot;dom-media-tracks&quot;&gt;tracks&lt;/span&gt;;
   &lt;span&gt;MutableTimedTrack&lt;/span&gt; &lt;span title=&quot;dom-media-addTrack&quot;&gt;addTrack&lt;/span&gt;(in DOMString label, in DOMString kind, in DOMString language);
+
+ - addTrack should add it as Loaded, Disabled, and with the rules for WebSRT.
 --&gt;
 
   &lt;pre class=idl&gt;interface &lt;dfn id=timedtrack&gt;TimedTrack&lt;/dfn&gt; {
@@ -26583,8 +26656,8 @@
 
   readonly attribute &lt;a href=#timedtrackcuelist&gt;TimedTrackCueList&lt;/a&gt; &lt;span title=dom-TimedTrack-cues&gt;cues&lt;/span&gt;;
   readonly attribute &lt;a href=#timedtrackcuelist&gt;TimedTrackCueList&lt;/a&gt; &lt;span title=dom-TimedTrack-activeCues&gt;activeCues&lt;/span&gt;;
-  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrack-onentercue&gt;onentercue&lt;/span&gt;;
-  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrack-onexitcue&gt;onexitcue&lt;/span&gt;;
+
+  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrack-oncuechange&gt;oncuechange&lt;/span&gt;;
 };
 
 interface &lt;dfn id=mutabletimedtrack&gt;MutableTimedTrack&lt;/dfn&gt; : &lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt; {
@@ -26617,12 +26690,31 @@
   readonly attribute DOMString &lt;span title=dom-TimedTrackCue-voice&gt;voice&lt;/span&gt;;
   DOMString &lt;span title=dom-TimedTrackCue-getCueAsSource()&gt;getCueAsSource&lt;/span&gt;();
   &lt;a href=#documentfragment&gt;DocumentFragment&lt;/a&gt; &lt;span title=dom-TimedTrackCue-getCueAsHTML()&gt;getCueAsHTML&lt;/span&gt;();
+
+  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrackCue-onenter&gt;onenter&lt;/span&gt;;
+  readonly attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;span title=dom-TimedTrackCue-onexit&gt;onexit&lt;/span&gt;;
 };&lt;/pre&gt;
 
-  &lt;p class=XXX&gt;domintro
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;media&lt;/var&gt; . &lt;code title=dom-media-tracks&gt;tracks&lt;/code&gt; . &lt;code title=&quot;&quot;&gt;length&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the number of timed tracks associated with the element (e.g. from &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; elements).&lt;/p&gt;
+   &lt;/dd&gt;
 
-  &lt;div class=impl&gt;
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;media&lt;/var&gt; . &lt;code title=dom-media-tracks&gt;tracks[&lt;var title=&quot;&quot;&gt;n&lt;/var&gt;]&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the &lt;code&gt;&lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt;&lt;/code&gt; object representing the &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th timed track.&lt;/p&gt;
+   &lt;/dd&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;track&lt;/var&gt; . &lt;code title=dom-track-track&gt;&lt;a href=#dom-track-track&gt;track&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the &lt;code&gt;&lt;a href=#timedtrack&gt;TimedTrack&lt;/a&gt;&lt;/code&gt; object representing the &lt;code&gt;&lt;a href=#the-track-element&gt;track&lt;/a&gt;&lt;/code&gt; element's timed track.&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt class=XXX&gt;...&lt;/dt&gt;
+   &lt;dd class=XXX&gt;...&lt;/dd&gt;
+
+  &lt;/dl&gt;&lt;div class=impl&gt;
+
   &lt;p class=XXX&gt;...
 
   &lt;!-- XXX
@@ -26634,6 +26726,10 @@
   entirely prior to the &lt;span&gt;media resource&lt;/span&gt;'s &lt;span&gt;earliest
   possible position&lt;/span&gt;.&lt;/p&gt;
 
+  changing dom-TimedTrack-mode to disabled/hidden should hide all the
+  titles, changing it to showing should show them. (Only 'showing'
+  tracks get updated automatically.)
+
   --&gt;
 
   &lt;/div&gt;
@@ -26643,12 +26739,7 @@
 
   &lt;p class=XXX&gt;...
 
-&lt;!-- XXX
-CueEvent
- readonly attribute TimedTrackCue cue;
---&gt;
 
-
   &lt;h5 id=websrt-0&gt;&lt;span class=secno&gt;4.8.10.11 &lt;/span&gt;WebSRT&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn id=websrt&gt;WebSRT&lt;/dfn&gt; format (Web Subtitle Resource Tracks) is a
@@ -56250,6 +56341,9 @@
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onchange title=handler-onchange&gt;onchange&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onclick title=handler-onclick&gt;onclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;oncontextmenu&lt;/a&gt;;
+&lt;!--TT--&gt;
+           attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;oncuechange&lt;/a&gt;;
+&lt;!--TT--&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;ondblclick&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondrag title=handler-ondrag&gt;ondrag&lt;/a&gt;;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-ondragend title=handler-ondragend&gt;ondragend&lt;/a&gt;;
@@ -62526,6 +62620,9 @@
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-onchange title=handler-onchange&gt;&lt;code&gt;onchange&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-change&gt;change&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-onclick title=handler-onclick&gt;&lt;code&gt;onclick&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-click&gt;&lt;a href=#event-click&gt;click&lt;/a&gt;&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-oncontextmenu title=handler-oncontextmenu&gt;&lt;code&gt;oncontextmenu&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-contextmenu&gt;contextmenu&lt;/code&gt; &lt;!-- widely used --&gt;
+&lt;!--TT--&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-oncuechange title=handler-oncuechange&gt;&lt;code&gt;oncuechange&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt;
+&lt;!--TT--&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-ondblclick title=handler-ondblclick&gt;&lt;code&gt;ondblclick&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-dblclick&gt;dblclick&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-ondrag title=handler-ondrag&gt;&lt;code&gt;ondrag&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-drag&gt;&lt;a href=#event-drag&gt;drag&lt;/a&gt;&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn id=handler-ondragend title=handler-ondragend&gt;&lt;code&gt;ondragend&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=event-dragend&gt;&lt;a href=#event-dragend&gt;dragend&lt;/a&gt;&lt;/code&gt;
@@ -78835,7 +78932,7 @@
 
   &lt;h5 id=websrt-cue-text-rendering-rules&gt;&lt;span class=secno&gt;12.3.2.1 &lt;/span&gt;&lt;dfn&gt;WebSRT cue text rendering rules&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p class=XXX&gt;
+  &lt;p class=XXX&gt;The &lt;dfn id=rules-for-updating-the-display-of-websrt-timed-tracks&gt;rules for updating the display of WebSRT timed tracks&lt;/dfn&gt;
 
   &lt;!--
 
@@ -84435,6 +84532,12 @@
      &lt;td&gt; &lt;a href=#handler-oncontextmenu title=handler-oncontextmenu&gt;HTML elements&lt;/a&gt;
      &lt;td&gt; &lt;code title=event-contextmenu&gt;contextmenu&lt;/code&gt; event handler
      &lt;td&gt; &lt;a href=#event-handler-content-attributes title=&quot;event handler content attributes&quot;&gt;Event handler content attribute&lt;/a&gt;
+&lt;!--TT--&gt;
+    &lt;tr&gt;&lt;th&gt; &lt;code title=&quot;&quot;&gt;oncuechange&lt;/code&gt;
+     &lt;td&gt; &lt;a href=#handler-oncuechange title=handler-oncuechange&gt;HTML elements&lt;/a&gt;
+     &lt;td&gt; &lt;code title=event-cuechange&gt;cuechange&lt;/code&gt; event handler
+     &lt;td&gt; &lt;a href=#event-handler-content-attributes title=&quot;event handler content attributes&quot;&gt;Event handler content attribute&lt;/a&gt;
+&lt;!--TT--&gt;
 
     &lt;tr&gt;&lt;th&gt; &lt;code title=&quot;&quot;&gt;ondblclick&lt;/code&gt;
      &lt;td&gt; &lt;a href=#handler-ondblclick title=handler-ondblclick&gt;HTML elements&lt;/a&gt;

Modified: source
===================================================================
--- source	2010-07-01 23:23:47 UTC (rev 5131)
+++ source	2010-07-02 22:57:06 UTC (rev 5132)
@@ -7750,6 +7750,9 @@
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-onchange&quot;&gt;onchange&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-onclick&quot;&gt;onclick&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-oncontextmenu&quot;&gt;oncontextmenu&lt;/span&gt;;
+&lt;!--END w3c-html--&gt;&lt;!--TT--&gt;
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-oncuechange&quot;&gt;oncuechange&lt;/span&gt;;
+&lt;!--START w3c-html--&gt;&lt;!--TT--&gt;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondblclick&quot;&gt;ondblclick&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondrag&quot;&gt;ondrag&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondragend&quot;&gt;ondragend&lt;/span&gt;;
@@ -8894,6 +8897,9 @@
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-onchange&quot;&gt;onchange&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-onclick&quot;&gt;onclick&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-oncontextmenu&quot;&gt;oncontextmenu&lt;/span&gt;;
+&lt;!--END w3c-html--&gt;&lt;!--TT--&gt;
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-oncuechange&quot;&gt;oncuechange&lt;/span&gt;;
+&lt;!--START w3c-html--&gt;&lt;!--TT--&gt;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondblclick&quot;&gt;ondblclick&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondrag&quot;&gt;ondrag&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondragend&quot;&gt;ondragend&lt;/span&gt;;
@@ -9003,6 +9009,9 @@
    &lt;li&gt;&lt;code title=&quot;handler-onchange&quot;&gt;onchange&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=&quot;handler-onclick&quot;&gt;onclick&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=&quot;handler-oncontextmenu&quot;&gt;oncontextmenu&lt;/code&gt;&lt;/li&gt;
+&lt;!--END w3c-html--&gt;&lt;!--TT--&gt;
+   &lt;li&gt;&lt;code title=&quot;handler-oncuechange&quot;&gt;oncuechange&lt;/code&gt;&lt;/li&gt;
+&lt;!--START w3c-html--&gt;&lt;!--TT--&gt;
    &lt;li&gt;&lt;code title=&quot;handler-ondblclick&quot;&gt;ondblclick&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=&quot;handler-ondrag&quot;&gt;ondrag&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code title=&quot;handler-ondragend&quot;&gt;ondragend&lt;/code&gt;&lt;/li&gt;
@@ -27764,27 +27773,33 @@
   agent must wait for the steps to complete, and then must immediately
   rerun the steps. (These steps are thus run as often as possible or
   needed &mdash; if one iteration takes a long time, this can cause
-  certain ranges to be skipped over as the user agent rushes ahead to
-  &quot;catch up&quot;.)&lt;/p&gt;
+  certain &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; to be skipped over
+  as the user agent rushes ahead to &quot;catch up&quot;.)&lt;/p&gt;
 
   &lt;ol&gt;
 
-&lt;!--XXXTT - the text below is wrong, but we need to do something similar, updating the timed tracks, pausing if necessary (more below)
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; be an ordered list of
-   &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt;, initialized to contain
-   all the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; of the
-   &lt;span&gt;media element&lt;/span&gt; whose start times are less than or equal
-   to the &lt;span&gt;current playback position&lt;/span&gt; and whose end times
-   are greater than the &lt;span&gt;current playback position&lt;/span&gt;, in the
-   order they were added to the element.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; be an ordered list of
+   &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt;, initialized to contain
+   all the &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; of all the &lt;span
+   title=&quot;timed track hidden&quot;&gt;hidden&lt;/span&gt; or &lt;span title=&quot;timed
+   track showing&quot;&gt;showing&lt;/span&gt; &lt;span title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/span&gt; of the &lt;span&gt;media element&lt;/span&gt; (not not the &lt;span
+   title=&quot;timed track disabled&quot;&gt;disabled&lt;/span&gt; ones) whose &lt;span
+   title=&quot;timed track cue start time&quot;&gt;start times&lt;/span&gt; are less than
+   or equal to the &lt;span&gt;current playback position&lt;/span&gt; and whose
+   &lt;span title=&quot;timed track cue end time&quot;&gt;end times&lt;/span&gt; are greater
+   than the &lt;span&gt;current playback position&lt;/span&gt;, in &lt;span&gt;timed
+   track cue order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;other ranges&lt;/var&gt; be an ordered list of
-   &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt;, initialized to contain
-   all the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; of the
-   &lt;span&gt;media element&lt;/span&gt; that are not present in &lt;var
-   title=&quot;&quot;&gt;current ranges&lt;/var&gt;, in the order they were added to the
-   element.&lt;/p&gt;&lt;/li&gt;
---&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; be an ordered list of
+   &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt;, initialized to contain
+   all the &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; of &lt;span
+   title=&quot;timed track hidden&quot;&gt;hidden&lt;/span&gt; and &lt;span title=&quot;timed
+   track showing&quot;&gt;showing&lt;/span&gt; &lt;span title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/span&gt; of the &lt;span&gt;media element&lt;/span&gt; that are not
+   present in &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt;, also in &lt;span&gt;timed
+   track cue order&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
+
    &lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
    of the current playback position during normal playback, and if the
    user agent has not fired a &lt;code
@@ -27805,47 +27820,78 @@
    not any more frequent than the user agent can comfortably handle
    while decoding the video.&lt;/p&gt;&lt;/li&gt;
 
-&lt;!--XXXTT [beware - - nested comments]
-   &lt;li&gt;&lt;p&gt;If none of the &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in
-   &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; have their &quot;active&quot; boolean set
-   to &quot;false&quot; (inactive) and none of the &lt;span title=&quot;cue range&quot;&gt;cue
-   ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other ranges&lt;/var&gt; have their
-   &quot;active&quot; boolean set to &quot;true&quot; (active), then abort these
+   &lt;li&gt;&lt;p&gt;If all of the &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; in
+   &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; have their &lt;span&gt;timed track cue
+   active flag&lt;/span&gt; set, and none of the &lt;span title=&quot;timed track
+   cue&quot;&gt;cues&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; have their
+   &lt;span&gt;timed track cue active flag&lt;/span&gt; set, then abort these
    steps.&lt;/p&gt;&lt;/li&gt;
 
    &lt;li&gt;&lt;p&gt;If the time was reached through the usual monotonic increase
    of the current playback position during normal playback, and there
-   are &lt;span title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var
-   title=&quot;&quot;&gt;other ranges&lt;/var&gt; that have both their &quot;active&quot; boolean
-   and their &quot;pause&quot; boolean set to &quot;true&quot;, then immediately act as if
-   the element's &lt;code title=&quot;dom-media-pause&quot;&gt;pause()&lt;/code&gt; method
-   had been invoked. &lt;!- - pause() can in theory call load(), but never
-   can it do so as part of this invokation, since we wouldn't be in
-   this algorithm if the media element was empty. So, no need to couch
-   all this in a task. - -&gt; (In the other cases, such as explicit
-   seeks, playback is not paused by exiting a cue range, even if that
-   cue range has its &quot;pause&quot; boolean set to &quot;true&quot;.)&lt;/p&gt;&lt;/li&gt;
+   are &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; in &lt;var
+   title=&quot;&quot;&gt;other cues&lt;/var&gt; that have both their &lt;span&gt;timed track
+   cue active flag&lt;/span&gt; set and their &lt;span&gt;timed track cue
+   pause-on-exit flag&lt;/span&gt; set, then immediately act as if the
+   element's &lt;code title=&quot;dom-media-pause&quot;&gt;pause()&lt;/code&gt; method had
+   been invoked. &lt;!-- pause() can in theory call load(), but never can
+   it do so as part of this invokation, since we wouldn't be in this
+   algorithm if the media element was empty. So, no need to couch all
+   this in a task. --&gt; (In the other cases, such as explicit seeks,
+   playback is not paused by going past the end time of a &lt;span
+   title=&quot;timed track cue&quot;&gt;cue&lt;/span&gt;, even if that &lt;span title=&quot;timed
+   track cue&quot;&gt;cue&lt;/span&gt; has its &lt;span&gt;timed track cue pause-on-exit
+   flag&lt;/span&gt; set.)&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;For each non-null &quot;exit&quot; callback of the &lt;span
-   title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other
-   ranges&lt;/var&gt; that have their &quot;active&quot; boolean set to &quot;true&quot;
-   (active), in list order, &lt;span&gt;queue a task&lt;/span&gt; that invokes the
-   callback, passing the cue range's identifier as the callback's only
-   argument.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;Let &lt;var title=&quot;&quot;&gt;affected tracks&lt;/var&gt; be a list of &lt;span
+   title=&quot;timed track&quot;&gt;timed tracks&lt;/span&gt;, initially empty.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;For each non-null &quot;enter&quot; callback of the &lt;span title=&quot;cue
-   range&quot;&gt;cue ranges&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt; that
-   have their &quot;active&quot; boolean set to &quot;false&quot; (inactive), in list
-   order, &lt;span&gt;queue a task&lt;/span&gt; that invokes the callback, passing
-   the cue range's identifier as the callback's only
-   argument.&lt;/p&gt;&lt;/li&gt;
+   &lt;li&gt;&lt;p&gt;For each &lt;span title=&quot;timed track cue&quot;&gt;timed track
+   cue&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt; that has its
+   &lt;span&gt;timed track cue active flag&lt;/span&gt; set, in list order,
+   &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt; named
+   &lt;code title=&quot;event-exit&quot;&gt;exit&lt;/code&gt; at the
+   &lt;code&gt;TimedTrackCue&lt;/code&gt; object, and add the &lt;span title=&quot;timed
+   track cue&quot;&gt;cue&lt;/span&gt;'s &lt;span&gt;timed track&lt;/span&gt; to &lt;var
+   title=&quot;&quot;&gt;affected tracks&lt;/var&gt;, if it's not already in the
+   list.&lt;/p&gt;&lt;/li&gt;
 
-   &lt;li&gt;&lt;p&gt;Set the &quot;active&quot; boolean of all the &lt;span title=&quot;cue
-   range&quot;&gt;cue ranges&lt;/span&gt; in the &lt;var title=&quot;&quot;&gt;current ranges&lt;/var&gt;
-   list to &quot;true&quot; (active), and the &quot;active&quot; boolean of all the &lt;span
-   title=&quot;cue range&quot;&gt;cue ranges&lt;/span&gt; in the &lt;var title=&quot;&quot;&gt;other
-   ranges&lt;/var&gt; list to &quot;false&quot; (inactive).&lt;/p&gt;&lt;/li&gt;
---&gt;
+   &lt;li&gt;&lt;p&gt;For each &lt;span title=&quot;timed track cue&quot;&gt;timed track
+   cue&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;current cues&lt;/var&gt; that does not have
+   its &lt;span&gt;timed track cue active flag&lt;/span&gt; set, in list order,
+   &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a simple event&lt;/span&gt; named
+   &lt;code title=&quot;event-enter&quot;&gt;enter&lt;/code&gt; at the
+   &lt;code&gt;TimedTrackCue&lt;/code&gt; object, and add the &lt;span title=&quot;timed
+   track cue&quot;&gt;cue&lt;/span&gt;'s &lt;span&gt;timed track&lt;/span&gt; to &lt;var
+   title=&quot;&quot;&gt;affected tracks&lt;/var&gt;, if it's not already in the
+   list.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;For each &lt;span&gt;timed track&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;affected
+   tracks&lt;/var&gt;, in the order they were added to the list (which will
+   match the relative order of the &lt;span title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/span&gt; in the &lt;span&gt;media element&lt;/span&gt;'s &lt;span&gt;list of
+   timed tracks&lt;/span&gt;), &lt;span&gt;queue a task&lt;/span&gt; to &lt;span&gt;fire a
+   simple event&lt;/span&gt; named &lt;code
+   title=&quot;event-cuechange&quot;&gt;cuechange&lt;/code&gt; at the
+   &lt;code&gt;TimedTrack&lt;/code&gt; object, and, if the &lt;span&gt;timed
+   track&lt;/span&gt; has a corresponding &lt;code&gt;track&lt;/code&gt; element, to
+   then &lt;span&gt;fire a simple event&lt;/span&gt; named &lt;code
+   title=&quot;event-cuechange&quot;&gt;cuechange&lt;/code&gt; at the &lt;code&gt;track&lt;/code&gt;
+   element as well.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Set the &lt;span&gt;timed track cue active flag&lt;/span&gt; of all the
+   &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; in the &lt;var
+   title=&quot;&quot;&gt;current cues&lt;/var&gt;, and unset the &lt;span&gt;timed track cue
+   active flag&lt;/span&gt; of all the &lt;span title=&quot;timed track
+   cue&quot;&gt;cues&lt;/span&gt; in the &lt;var title=&quot;&quot;&gt;other cues&lt;/var&gt;.&lt;/p&gt;&lt;/li&gt;
+
+   &lt;li&gt;&lt;p&gt;Run the rules for rendering the cues of each of the &lt;span
+   title=&quot;timed track&quot;&gt;timed tracks&lt;/span&gt; in &lt;var title=&quot;&quot;&gt;affected
+   tracks&lt;/var&gt; that are &lt;span title=&quot;timed track
+   showing&quot;&gt;showing&lt;/span&gt; (e.g., for &lt;span title=&quot;timed track&quot;&gt;timed
+   tracks&lt;/span&gt; based on &lt;span&gt;WebSRT&lt;/span&gt;, the &lt;span&gt;rules for
+   updating the display of WebSRT timed tracks&lt;/span&gt;).&lt;/p&gt;&lt;/li&gt;
+
   &lt;/ol&gt;
 
   &lt;p&gt;When a &lt;span&gt;media element&lt;/span&gt; is &lt;span title=&quot;remove an
@@ -28237,7 +28283,10 @@
 
    &lt;dd&gt;
 
-    &lt;p&gt;A list of &lt;span title=&quot;timed track cue&quot;&gt;timed track cues&lt;/span&gt;.&lt;/p&gt;
+    &lt;p&gt;A list of &lt;span title=&quot;timed track cue&quot;&gt;timed track
+    cues&lt;/span&gt;, along with rules for their rendering (e.g., for
+    &lt;span&gt;WebSRT&lt;/span&gt;, the &lt;span&gt;rules for updating the display of
+    WebSRT timed tracks&lt;/span&gt;).&lt;/p&gt;
 
     &lt;p&gt;The &lt;span title=&quot;timed track list of cues&quot;&gt;list of cues of a
     timed track&lt;/span&gt; can change dynamically, either because the
@@ -28403,7 +28452,46 @@
   cue&lt;/span&gt; is associated with a particular &lt;span&gt;timed track&lt;/span&gt;,
   the association is permanent.&lt;/p&gt;
 
+  &lt;p&gt;In addition, each &lt;span&gt;timed track cue&lt;/span&gt; has two pieces of
+  dynamic information:&lt;/p&gt;
 
+  &lt;dl&gt;
+
+   &lt;dt&gt;The &lt;dfn title=&quot;timed track cue active flag&quot;&gt;active flag&lt;/dfn&gt;
+   &lt;dd&gt;
+    &lt;p&gt;This flag must be initially unset. It is used to ensure events
+    are fired appropriately when the cue becomes active or
+    inactive.&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt&gt;The &lt;dfn title=&quot;timed track cue display state&quot;&gt;display state&lt;/dfn&gt;
+   &lt;dd&gt;
+    &lt;p&gt;This is used as part of the rendering model.&lt;/p&gt;
+   &lt;/dd&gt;
+
+  &lt;/dl&gt;
+
+  &lt;p&gt;The &lt;span title=&quot;timed track cue&quot;&gt;timed track cues&lt;/span&gt; of a
+  &lt;span&gt;media element&lt;/span&gt;'s &lt;span title=&quot;timed track&quot;&gt;timed
+  tracks&lt;/span&gt; are ordered relative to each other in the &lt;dfn&gt;timed
+  track cue order&lt;/dfn&gt;, which is determined as follows: first group
+  the &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; by their &lt;span&gt;timed
+  track&lt;/span&gt;, with the groups being sorted in the same order as
+  their &lt;span title=&quot;timed track&quot;&gt;timed tracks&lt;/span&gt; appear in the
+  &lt;span&gt;media element&lt;/span&gt;'s &lt;span&gt;list of timed tracks&lt;/span&gt;;
+  then, within each group, &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt;
+  must be sorted by their &lt;span title=&quot;timed track cue start
+  time&quot;&gt;start time&lt;/span&gt;, earliest first; then, any &lt;span
+  title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt; with the same &lt;span title=&quot;timed
+  track cue start time&quot;&gt;start time&lt;/span&gt; must be sorted by their
+  &lt;span title=&quot;timed track cue end time&quot;&gt;end time&lt;/span&gt;, earliest
+  first; and finally, any &lt;span title=&quot;timed track cue&quot;&gt;cues&lt;/span&gt;
+  with identical &lt;span title=&quot;timed track cue end time&quot;&gt;end
+  times&lt;/span&gt; must be sorted in the order they were created (so
+  e.g. for cues from a &lt;span&gt;WebSRT&lt;/span&gt; file, that would be the
+  order in which the cues were listed in the file).&lt;/p&gt;
+
+
   &lt;h6&gt;Sourcing in-band timed tracks&lt;/h6&gt;
 
   &lt;p&gt;A &lt;dfn&gt;media-resource-specific timed track&lt;/dfn&gt; is a &lt;span&gt;timed
@@ -28839,6 +28927,8 @@
   // timed tracks
   readonly attribute &lt;span&gt;TimedTrack&lt;/span&gt;[] &lt;span title=&quot;dom-media-tracks&quot;&gt;tracks&lt;/span&gt;;
   &lt;span&gt;MutableTimedTrack&lt;/span&gt; &lt;span title=&quot;dom-media-addTrack&quot;&gt;addTrack&lt;/span&gt;(in DOMString label, in DOMString kind, in DOMString language);
+
+ - addTrack should add it as Loaded, Disabled, and with the rules for WebSRT.
 --&gt;
 
   &lt;pre class=&quot;idl&quot;&gt;interface &lt;dfn&gt;TimedTrack&lt;/dfn&gt; {
@@ -28861,8 +28951,8 @@
 
   readonly attribute &lt;span&gt;TimedTrackCueList&lt;/span&gt; &lt;span title=&quot;dom-TimedTrack-cues&quot;&gt;cues&lt;/span&gt;;
   readonly attribute &lt;Span&gt;TimedTrackCueList&lt;/span&gt; &lt;span title=&quot;dom-TimedTrack-activeCues&quot;&gt;activeCues&lt;/span&gt;;
-  readonly attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;dom-TimedTrack-onentercue&quot;&gt;onentercue&lt;/span&gt;;
-  readonly attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;dom-TimedTrack-onexitcue&quot;&gt;onexitcue&lt;/span&gt;;
+
+  readonly attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;dom-TimedTrack-oncuechange&quot;&gt;oncuechange&lt;/span&gt;;
 };
 
 interface &lt;dfn&gt;MutableTimedTrack&lt;/dfn&gt; : &lt;span&gt;TimedTrack&lt;/span&gt; {
@@ -28895,10 +28985,33 @@
   readonly attribute DOMString &lt;span title=&quot;dom-TimedTrackCue-voice&quot;&gt;voice&lt;/span&gt;;
   DOMString &lt;span title=&quot;dom-TimedTrackCue-getCueAsSource()&quot;&gt;getCueAsSource&lt;/span&gt;();
   &lt;span&gt;DocumentFragment&lt;/span&gt; &lt;span title=&quot;dom-TimedTrackCue-getCueAsHTML()&quot;&gt;getCueAsHTML&lt;/span&gt;();
+
+  readonly attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;dom-TimedTrackCue-onenter&quot;&gt;onenter&lt;/span&gt;;
+  readonly attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;dom-TimedTrackCue-onexit&quot;&gt;onexit&lt;/span&gt;;
 };&lt;/pre&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;domintro
+  &lt;dl class=&quot;domintro&quot;&gt;
 
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;media&lt;/var&gt; . &lt;code title=&quot;dom-media-tracks&quot;&gt;tracks&lt;/code&gt; . &lt;code title=&quot;&quot;&gt;length&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the number of timed tracks associated with the element (e.g. from &lt;code&gt;track&lt;/code&gt; elements).&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;media&lt;/var&gt; . &lt;code title=&quot;dom-media-tracks&quot;&gt;tracks[&lt;var title=&quot;&quot;&gt;n&lt;/var&gt;]&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the &lt;code&gt;TimedTrack&lt;/code&gt; object representing the &lt;var title=&quot;&quot;&gt;n&lt;/var&gt;th timed track.&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;track&lt;/var&gt; . &lt;code title=&quot;dom-track-track&quot;&gt;track&lt;/code&gt;&lt;/dt&gt;
+   &lt;dd&gt;
+    &lt;p&gt;Returns the &lt;code&gt;TimedTrack&lt;/code&gt; object representing the &lt;code&gt;track&lt;/code&gt; element's timed track.&lt;/p&gt;
+   &lt;/dd&gt;
+
+   &lt;dt class=&quot;XXX&quot;&gt;...&lt;/dt&gt;
+   &lt;dd class=&quot;XXX&quot;&gt;...&lt;/dd&gt;
+
+  &lt;/dl&gt;
+
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;p class=&quot;XXX&quot;&gt;...
@@ -28912,6 +29025,10 @@
   entirely prior to the &lt;span&gt;media resource&lt;/span&gt;'s &lt;span&gt;earliest
   possible position&lt;/span&gt;.&lt;/p&gt;
 
+  changing dom-TimedTrack-mode to disabled/hidden should hide all the
+  titles, changing it to showing should show them. (Only 'showing'
+  tracks get updated automatically.)
+
   --&gt;
 
   &lt;/div&gt;
@@ -28921,12 +29038,7 @@
 
   &lt;p class=&quot;XXX&quot;&gt;...
 
-&lt;!-- XXX
-CueEvent
- readonly attribute TimedTrackCue cue;
---&gt;
 
-
   &lt;h5&gt;WebSRT&lt;/h5&gt;
 
   &lt;p&gt;The &lt;dfn&gt;WebSRT&lt;/dfn&gt; format (Web Subtitle Resource Tracks) is a
@@ -63529,6 +63641,9 @@
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-onchange&quot;&gt;onchange&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-onclick&quot;&gt;onclick&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-oncontextmenu&quot;&gt;oncontextmenu&lt;/span&gt;;
+&lt;!--END w3c-html--&gt;&lt;!--TT--&gt;
+           attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-oncuechange&quot;&gt;oncuechange&lt;/span&gt;;
+&lt;!--START w3c-html--&gt;&lt;!--TT--&gt;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondblclick&quot;&gt;ondblclick&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondrag&quot;&gt;ondrag&lt;/span&gt;;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-ondragend&quot;&gt;ondragend&lt;/span&gt;;
@@ -70807,6 +70922,9 @@
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-onchange&quot;&gt;&lt;code&gt;onchange&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-change&quot;&gt;change&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-onclick&quot;&gt;&lt;code&gt;onclick&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-click&quot;&gt;click&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-oncontextmenu&quot;&gt;&lt;code&gt;oncontextmenu&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-contextmenu&quot;&gt;contextmenu&lt;/code&gt; &lt;!-- widely used --&gt;
+&lt;!--END w3c-html--&gt;&lt;!--TT--&gt;
+    &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-oncuechange&quot;&gt;&lt;code&gt;oncuechange&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-cuechange&quot;&gt;cuechange&lt;/code&gt;
+&lt;!--START w3c-html--&gt;&lt;!--TT--&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-ondblclick&quot;&gt;&lt;code&gt;ondblclick&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-dblclick&quot;&gt;dblclick&lt;/code&gt; &lt;!-- widely used --&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-ondrag&quot;&gt;&lt;code&gt;ondrag&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-drag&quot;&gt;drag&lt;/code&gt;
     &lt;tr&gt;&lt;td&gt;&lt;dfn title=&quot;handler-ondragend&quot;&gt;&lt;code&gt;ondragend&lt;/code&gt;&lt;/dfn&gt; &lt;td&gt; &lt;code title=&quot;event-dragend&quot;&gt;dragend&lt;/code&gt;
@@ -97607,7 +97725,7 @@
 
   &lt;h5&gt;&lt;dfn&gt;WebSRT cue text rendering rules&lt;/dfn&gt;&lt;/h5&gt;
 
-  &lt;p class=&quot;XXX&quot;&gt;
+  &lt;p class=&quot;XXX&quot;&gt;The &lt;dfn&gt;rules for updating the display of WebSRT timed tracks&lt;/dfn&gt;
 
   &lt;!--
 
@@ -104260,6 +104378,13 @@
      &lt;td&gt; &lt;span title=&quot;handler-oncontextmenu&quot;&gt;HTML elements&lt;/span&gt;
      &lt;td&gt; &lt;code title=&quot;event-contextmenu&quot;&gt;contextmenu&lt;/code&gt; event handler
      &lt;td&gt; &lt;span title=&quot;event handler content attributes&quot;&gt;Event handler content attribute&lt;/span&gt;
+&lt;!--END w3c-html--&gt;&lt;!--TT--&gt;
+    &lt;tr&gt;
+     &lt;th&gt; &lt;code title=&quot;&quot;&gt;oncuechange&lt;/code&gt;
+     &lt;td&gt; &lt;span title=&quot;handler-oncuechange&quot;&gt;HTML elements&lt;/span&gt;
+     &lt;td&gt; &lt;code title=&quot;event-cuechange&quot;&gt;cuechange&lt;/code&gt; event handler
+     &lt;td&gt; &lt;span title=&quot;event handler content attributes&quot;&gt;Event handler content attribute&lt;/span&gt;
+&lt;!--START w3c-html--&gt;&lt;!--TT--&gt;
 
     &lt;tr&gt;
      &lt;th&gt; &lt;code title=&quot;&quot;&gt;ondblclick&lt;/code&gt;


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="012001.html">[html5] r5131 - [e] (0) Captions - Stage 16.2: Rendering rules:	some notes.
</A></li>
	<LI>Next message: <A HREF="012003.html">[html5] r5133 - [e] (0) Captions - Stage 18: domintro blocks for	timed track APIs.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#12002">[ date ]</a>
              <a href="thread.html#12002">[ thread ]</a>
              <a href="subject.html#12002">[ subject ]</a>
              <a href="author.html#12002">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
