<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [html5] r5002 - [e] (0) Merge the two postMessage algorithsm back	into one. Fixing http://www.w3 [...]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5002%20-%20%5Be%5D%20%280%29%20Merge%20the%20two%20postMessage%20algorithsm%20back%0A%09into%20one.%20Fixing%20http%3A//www.w3%20%5B...%5D&In-Reply-To=%3C20100412230441.411281C84005%40ps20323.dreamhostps.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="011872.html">
   <LINK REL="Next"  HREF="011874.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[html5] r5002 - [e] (0) Merge the two postMessage algorithsm back	into one. Fixing http://www.w3 [...]</H1>
<!--htdig_noindex-->
    <B>whatwg at whatwg.org</B> 
    <A HREF="mailto:commit-watchers%40lists.whatwg.org?Subject=Re%3A%20%5Bhtml5%5D%20r5002%20-%20%5Be%5D%20%280%29%20Merge%20the%20two%20postMessage%20algorithsm%20back%0A%09into%20one.%20Fixing%20http%3A//www.w3%20%5B...%5D&In-Reply-To=%3C20100412230441.411281C84005%40ps20323.dreamhostps.com%3E"
       TITLE="[html5] r5002 - [e] (0) Merge the two postMessage algorithsm back	into one. Fixing http://www.w3 [...]">whatwg at whatwg.org
       </A><BR>
    <I>Mon Apr 12 16:04:41 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="011872.html">[html5] r5001 - [e] (0) fix domintro which had gotten out of sync	with reality Fixing http://www [...]
</A></li>
        <LI>Next message: <A HREF="011874.html">[html5] r5003 - [e] (0) i can't type Fixing	http://www.w3.org/Bugs/Public/show_bug.cgi?id=9385
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11873">[ date ]</a>
              <a href="thread.html#11873">[ thread ]</a>
              <a href="subject.html#11873">[ subject ]</a>
              <a href="author.html#11873">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Author: ianh
Date: 2010-04-12 16:04:40 -0700 (Mon, 12 Apr 2010)
New Revision: 5002

Modified:
   complete.html
   index
   source
Log:
[e] (0) Merge the two postMessage algorithsm back into one.
Fixing <A HREF="http://www.w3.org/Bugs/Public/show_bug.cgi?id=9395">http://www.w3.org/Bugs/Public/show_bug.cgi?id=9395</A>

Modified: complete.html
===================================================================
--- complete.html	2010-04-12 22:51:22 UTC (rev 5001)
+++ complete.html	2010-04-12 23:04:40 UTC (rev 5002)
@@ -1046,8 +1046,7 @@
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#authors&gt;&lt;span class=secno&gt;10.4.2.1 &lt;/span&gt;Authors&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#user-agents&gt;&lt;span class=secno&gt;10.4.2.2 &lt;/span&gt;User agents&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#posting-messages&gt;&lt;span class=secno&gt;10.4.3 &lt;/span&gt;Posting messages&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#posting-messages-with-message-ports&gt;&lt;span class=secno&gt;10.4.4 &lt;/span&gt;Posting messages with message ports&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#posting-messages&gt;&lt;span class=secno&gt;10.4.3 &lt;/span&gt;Posting messages&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#channel-messaging&gt;&lt;span class=secno&gt;10.5 &lt;/span&gt;Channel messaging&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-9&gt;&lt;span class=secno&gt;10.5.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
@@ -53915,8 +53914,7 @@
   any &lt;a href=#dom-showmodaldialog title=dom-showModalDialog&gt;showModalDialog&lt;/a&gt;(in DOMString url, in optional any argument&lt;!--, in optional DOMString features--&gt;);
 
   // &lt;a href=#crossDocumentMessages&gt;cross-document messaging&lt;/a&gt;
-  void &lt;a href=#dom-window-postmessage-2 title=dom-window-postMessage-2&gt;postMessage&lt;/a&gt;(in any message, in DOMString targetOrigin);
-  void &lt;a href=#dom-window-postmessage-3 title=dom-window-postMessage-3&gt;postMessage&lt;/a&gt;(in any message, in DOMString targetOrigin, in &lt;a href=#messageportarray&gt;MessagePortArray&lt;/a&gt; ports);
+  void &lt;a href=#dom-window-postmessage title=dom-window-postMessage&gt;postMessage&lt;/a&gt;(in any message, in DOMString targetOrigin, in optional &lt;a href=#messageportarray&gt;MessagePortArray&lt;/a&gt; ports);
 
   // &lt;a href=#event-handler-idl-attributes&gt;event handler IDL attributes&lt;/a&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onabort title=handler-onabort&gt;onabort&lt;/a&gt;;
@@ -54058,12 +54056,8 @@
 
   &lt;ul&gt;&lt;li&gt;The &lt;code title=dom-location&gt;&lt;a href=#dom-location&gt;location&lt;/a&gt;&lt;/code&gt; object
 
-   &lt;li&gt;The &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt;
-   method with two arguments
+   &lt;li&gt;The &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method
 
-   &lt;li&gt;The &lt;code title=dom-window-postMessage-3&gt;&lt;a href=#dom-window-postmessage-3&gt;postMessage()&lt;/a&gt;&lt;/code&gt;
-   method with three arguments
-
    &lt;li&gt;The &lt;code title=dom-frames&gt;&lt;a href=#dom-frames&gt;frames&lt;/a&gt;&lt;/code&gt; attribute
 
    &lt;li&gt;The &lt;a href=#dynamic-nested-browsing-context-properties&gt;dynamic nested browsing context properties&lt;/a&gt;
@@ -54089,7 +54083,7 @@
 
    &lt;p&gt;For instance, if two frames containing &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;s
    from different &lt;a href=#origin title=origin&gt;origins&lt;/a&gt; access the same
-   &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object's &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, they
+   &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object's &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, they
    will get distinct objects that are not equal.&lt;/p&gt;
 
   &lt;/div&gt;
@@ -71553,7 +71547,7 @@
 
    &lt;p&gt;For example, if document A contains an &lt;code&gt;&lt;a href=#the-iframe-element&gt;iframe&lt;/a&gt;&lt;/code&gt;
    element that contains document B, and script in document A calls
-   &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; on the
+   &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; on the
    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of document B, then a message event will
    be fired on that object, marked as originating from the
    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; of document A. The script in document A might
@@ -71607,7 +71601,7 @@
   should also check that the data in question is of the expected
   format. Otherwise, if the source of the event has been attacked
   using a cross-site scripting flaw, further unchecked processing of
-  information sent using the &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method could
+  information sent using the &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method could
   result in the attack being propagated into the receiver.&lt;/p&gt;
 
   &lt;p&gt;Authors should not use the wildcard keyword (*) in the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument in messages that contain any
@@ -71636,7 +71630,7 @@
 
   &lt;h4 id=posting-messages&gt;&lt;span class=secno&gt;10.4.3 &lt;/span&gt;Posting messages&lt;/h4&gt;
 
-  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; ])&lt;/dt&gt;
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; ])&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -71657,7 +71651,7 @@
 
   &lt;/dl&gt;&lt;div class=impl&gt;
 
-  &lt;p&gt;When a script invokes the &lt;dfn id=dom-window-postmessage-2 title=dom-window-postMessage-2&gt;&lt;code&gt;postMessage(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with only two
+  &lt;p&gt;When a script invokes the &lt;dfn id=dom-window-postmessage title=dom-window-postMessage&gt;&lt;code&gt;postMessage(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with two or three
   arguments) on a &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object, the user agent must
   follow these steps:
 
@@ -71683,123 +71677,35 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Return from the &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, but
-    asynchronously continue running these steps.&lt;/p&gt;
+    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is present but either
+    any of the entries in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; are null, or any
+    &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; object is listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; more than once, or any of the
+    &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; objects listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; have already been cloned once before, then
+    throw an &lt;code&gt;&lt;a href=#invalid_state_err&gt;INVALID_STATE_ERR&lt;/a&gt;&lt;/code&gt; exception and abort these
+    steps.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is a single
-    literal U+002F SOLIDUS character (/), and the
-    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which
-    the method was invoked does not have the &lt;a href=#same-origin&gt;same origin&lt;/a&gt;
-    as the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-document&quot; title=&quot;script's
-    document&quot;&gt;document&lt;/a&gt;, then abort these steps silently.&lt;/p&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; be an empty array.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, if the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is
-    an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, and the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the
-    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the method was invoked does
-    not have the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, then abort these steps silently.&lt;/p&gt;
+    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is present, then for
+    each port in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; in turn, obtain a new port
+    by &lt;a href=#clone-a-port title=&quot;clone a port&quot;&gt;cloning&lt;/a&gt; the port with the
+    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the method was invoked as the
+    owner of the clone, and append the clone to the &lt;var title=&quot;&quot;&gt;new
+    ports&lt;/var&gt; array.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is a
-    single literal U+002A ASTERISK character (*), and no origin check
-    is made.&lt;/p&gt;
+    &lt;p class=note&gt;If the original &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument
+    was omitted or empty, then the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array
+    will be empty.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;Create an event that uses the &lt;code&gt;&lt;a href=#messageevent&gt;MessageEvent&lt;/a&gt;&lt;/code&gt;
-    interface, with the event name &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt;, which does not bubble, is
-    not cancelable, and has no default action. The &lt;code title=dom-MessageEvent-data&gt;&lt;a href=#dom-messageevent-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute must be set to
-    the value of &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt;, the &lt;code title=dom-MessageEvent-origin&gt;&lt;a href=#dom-messageevent-origin&gt;origin&lt;/a&gt;&lt;/code&gt; attribute must be
-    set to the &lt;a href=#unicode-serialization-of-an-origin title=&quot;Unicode serialization of an
-    origin&quot;&gt;Unicode serialization&lt;/a&gt; of the &lt;a href=#origin&gt;origin&lt;/a&gt; of
-    the script that invoked the method, and the &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt; attribute must be
-    set to the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;'s
-    &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt; &lt;!-- invariant: the global
-    object is always a Window if the script can see this method --&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to dispatch the event created in the
-    previous step at the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the
-    method was invoked. The &lt;a href=#task-source&gt;task source&lt;/a&gt; for this &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; is the &lt;a href=#posted-message-task-source&gt;posted message task
-    source&lt;/a&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-  &lt;/ol&gt;&lt;/div&gt;
-
-
-  &lt;div class=impl&gt;
-
-  &lt;h4 id=posting-messages-with-message-ports&gt;&lt;span class=secno&gt;10.4.4 &lt;/span&gt;Posting messages with message ports&lt;/h4&gt;
-
-  &lt;p&gt;When a script invokes the &lt;dfn id=dom-window-postmessage-3 title=dom-window-postMessage-3&gt;&lt;code&gt;postMessage(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with three arguments) on
-  a &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object, the user agent must follow these
-  steps:
-
-  &lt;ol&gt;&lt;!-- EXCEPT WHERE NOTED, THESE STEPS ARE IDENTICAL TO THE PREVIOUS SECTION --&gt;&lt;!-- one exception is the use of -3 instead of -2 in the xrefs --&gt;&lt;li&gt;
-
-    &lt;p&gt;If the value of the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument
-    is neither a single U+002A ASTERISK character (*), a single U+002F
-    SOLIDUS character (/), nor an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; with a
-    &lt;code title=url-host-specific&gt;&lt;a href=#url-host-specific&gt;&lt;host-specific&gt;&lt;/a&gt;&lt;/code&gt;
-    component that is either empty or a single U+002F SOLIDUS
-    character (/), then throw a &lt;code&gt;&lt;a href=#syntax_err&gt;SYNTAX_ERR&lt;/a&gt;&lt;/code&gt; exception and
-    abort the overall set of steps.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt; be the result of
-    obtaining a &lt;a href=#structured-clone&gt;structured clone&lt;/a&gt; of the &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; argument. If this throws an exception, then
-    throw that exception and abort these steps.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is empty&lt;!-- or null
-    (if we make it nullable)--&gt;, then act as if the method had just
-    been &lt;a href=#dom-window-postmessage-2 title=dom-window-postMessage-2&gt;called with two
-    arguments&lt;/a&gt;, &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;If any of the entries in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; are null, if
-    any &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; object is listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; more than once, or if any of the
-    &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; objects listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; have already been cloned once before, then
-    throw an &lt;code&gt;&lt;a href=#invalid_state_err&gt;INVALID_STATE_ERR&lt;/a&gt;&lt;/code&gt; exception.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; be an empty array.&lt;/p&gt;
-
-    &lt;p&gt;For each port in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; in turn,
-    obtain a new port by &lt;a href=#clone-a-port title=&quot;clone a port&quot;&gt;cloning&lt;/a&gt; the
-    port with the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the method was
-    invoked as the owner of the clone, and append the clone to the
-    &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt;
-&lt;!--
-    &lt;p class=&quot;note&quot;&gt;If the original &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt;
-    array was empty, then the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array will
-    also be empty.&lt;/p&gt;
---&gt;
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Return from the &lt;code title=dom-window-postMessage-3&gt;&lt;a href=#dom-window-postmessage-3&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, but
+    &lt;p&gt;Return from the &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, but
     asynchronously continue running these steps.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -71832,20 +71738,15 @@
     the value of &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt;, the &lt;code title=dom-MessageEvent-origin&gt;&lt;a href=#dom-messageevent-origin&gt;origin&lt;/a&gt;&lt;/code&gt; attribute must be
     set to the &lt;a href=#unicode-serialization-of-an-origin title=&quot;Unicode serialization of an
     origin&quot;&gt;Unicode serialization&lt;/a&gt; of the &lt;a href=#origin&gt;origin&lt;/a&gt; of
-    the script that invoked the method, and the &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt; attribute must be
+    the script that invoked the method, the &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt; attribute must be
     set to the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;'s
-    &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt; &lt;!-- invariant: the global
-    object is always a Window if the script can see this method --&gt;
+    &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object, and the &lt;code title=dom-MessageEvent-ports&gt;&lt;a href=#dom-messageevent-ports&gt;ports&lt;/a&gt;&lt;/code&gt; attribute must be set
+    to the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt; &lt;!-- invariant:
+    the global object is always a Window if the script can see this
+    method --&gt;
 
    &lt;/li&gt;
 
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;Let the &lt;code title=dom-MessageEvent-ports&gt;&lt;a href=#dom-messageevent-ports&gt;ports&lt;/a&gt;&lt;/code&gt; attribute
-    of the event be the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt;
-
-   &lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to dispatch the event created in the
@@ -71855,19 +71756,10 @@
 
    &lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p class=note&gt;These steps, with the exception of the third,
-  fourth, and fifth steps and the penultimate step, are identical to
-  those in the previous section.&lt;/p&gt;
+  &lt;/ol&gt;&lt;/div&gt;
 
-  &lt;!-- v2: we can merge this section and the previous section when
-  implementations have shipped postMessage(). Anne asked that these
-  sections be kept separate so that implementors can avoid getting
-  confused with the 'port' step. --&gt;
 
-  &lt;/div&gt;
 
-
-
   &lt;h3 id=channel-messaging&gt;&lt;span class=secno&gt;10.5 &lt;/span&gt;&lt;dfn&gt;Channel messaging&lt;/dfn&gt;&lt;/h3&gt;
 
   &lt;h4 id=introduction-9&gt;&lt;span class=secno&gt;10.5.1 &lt;/span&gt;Introduction&lt;/h4&gt;
@@ -71889,7 +71781,7 @@
   &lt;pre&gt;var channel = new MessageChannel();&lt;/pre&gt;
 
   &lt;p&gt;One of the ports is kept as the local port, and the other port is
-  sent to the remote code, e.g. using &lt;code title=dom-window-postMessage-3&gt;&lt;a href=#dom-window-postmessage-3&gt;postMessage()&lt;/a&gt;&lt;/code&gt;:&lt;/p&gt;
+  sent to the remote code, e.g. using &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt;:&lt;/p&gt;
 
   &lt;pre&gt;otherWindow.postMessage('hello', '<A HREF="http://example.com">http://example.com</A>', [channel.port2]);&lt;/pre&gt;
 

Modified: index
===================================================================
--- index	2010-04-12 22:51:22 UTC (rev 5001)
+++ index	2010-04-12 23:04:40 UTC (rev 5002)
@@ -940,8 +940,7 @@
       &lt;ol&gt;
        &lt;li&gt;&lt;a href=#authors&gt;&lt;span class=secno&gt;9.2.2.1 &lt;/span&gt;Authors&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=#user-agents&gt;&lt;span class=secno&gt;9.2.2.2 &lt;/span&gt;User agents&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#posting-messages&gt;&lt;span class=secno&gt;9.2.3 &lt;/span&gt;Posting messages&lt;/a&gt;&lt;/li&gt;
-     &lt;li&gt;&lt;a href=#posting-messages-with-message-ports&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Posting messages with message ports&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
+     &lt;li&gt;&lt;a href=#posting-messages&gt;&lt;span class=secno&gt;9.2.3 &lt;/span&gt;Posting messages&lt;/a&gt;&lt;/ol&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=#channel-messaging&gt;&lt;span class=secno&gt;9.3 &lt;/span&gt;Channel messaging&lt;/a&gt;
     &lt;ol&gt;
      &lt;li&gt;&lt;a href=#introduction-7&gt;&lt;span class=secno&gt;9.3.1 &lt;/span&gt;Introduction&lt;/a&gt;&lt;/li&gt;
@@ -53816,8 +53815,7 @@
   any &lt;a href=#dom-showmodaldialog title=dom-showModalDialog&gt;showModalDialog&lt;/a&gt;(in DOMString url, in optional any argument&lt;!--, in optional DOMString features--&gt;);
 
   // &lt;a href=#crossDocumentMessages&gt;cross-document messaging&lt;/a&gt;
-  void &lt;a href=#dom-window-postmessage-2 title=dom-window-postMessage-2&gt;postMessage&lt;/a&gt;(in any message, in DOMString targetOrigin);
-  void &lt;a href=#dom-window-postmessage-3 title=dom-window-postMessage-3&gt;postMessage&lt;/a&gt;(in any message, in DOMString targetOrigin, in &lt;a href=#messageportarray&gt;MessagePortArray&lt;/a&gt; ports);
+  void &lt;a href=#dom-window-postmessage title=dom-window-postMessage&gt;postMessage&lt;/a&gt;(in any message, in DOMString targetOrigin, in optional &lt;a href=#messageportarray&gt;MessagePortArray&lt;/a&gt; ports);
 
   // &lt;a href=#event-handler-idl-attributes&gt;event handler IDL attributes&lt;/a&gt;
            attribute &lt;a href=#function&gt;Function&lt;/a&gt; &lt;a href=#handler-onabort title=handler-onabort&gt;onabort&lt;/a&gt;;
@@ -53959,12 +53957,8 @@
 
   &lt;ul&gt;&lt;li&gt;The &lt;code title=dom-location&gt;&lt;a href=#dom-location&gt;location&lt;/a&gt;&lt;/code&gt; object
 
-   &lt;li&gt;The &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt;
-   method with two arguments
+   &lt;li&gt;The &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method
 
-   &lt;li&gt;The &lt;code title=dom-window-postMessage-3&gt;&lt;a href=#dom-window-postmessage-3&gt;postMessage()&lt;/a&gt;&lt;/code&gt;
-   method with three arguments
-
    &lt;li&gt;The &lt;code title=dom-frames&gt;&lt;a href=#dom-frames&gt;frames&lt;/a&gt;&lt;/code&gt; attribute
 
    &lt;li&gt;The &lt;a href=#dynamic-nested-browsing-context-properties&gt;dynamic nested browsing context properties&lt;/a&gt;
@@ -53990,7 +53984,7 @@
 
    &lt;p&gt;For instance, if two frames containing &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt;s
    from different &lt;a href=#origin title=origin&gt;origins&lt;/a&gt; access the same
-   &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object's &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, they
+   &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object's &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, they
    will get distinct objects that are not equal.&lt;/p&gt;
 
   &lt;/div&gt;
@@ -65530,7 +65524,7 @@
 
    &lt;p&gt;For example, if document A contains an &lt;code&gt;&lt;a href=#the-iframe-element&gt;iframe&lt;/a&gt;&lt;/code&gt;
    element that contains document B, and script in document A calls
-   &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; on the
+   &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; on the
    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object of document B, then a message event will
    be fired on that object, marked as originating from the
    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; of document A. The script in document A might
@@ -65584,7 +65578,7 @@
   should also check that the data in question is of the expected
   format. Otherwise, if the source of the event has been attacked
   using a cross-site scripting flaw, further unchecked processing of
-  information sent using the &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method could
+  information sent using the &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method could
   result in the attack being propagated into the receiver.&lt;/p&gt;
 
   &lt;p&gt;Authors should not use the wildcard keyword (*) in the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument in messages that contain any
@@ -65613,7 +65607,7 @@
 
   &lt;h4 id=posting-messages&gt;&lt;span class=secno&gt;9.2.3 &lt;/span&gt;Posting messages&lt;/h4&gt;
 
-  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; ])&lt;/dt&gt;
+  &lt;dl class=domintro&gt;&lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage&lt;/a&gt;&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; ])&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -65634,7 +65628,7 @@
 
   &lt;/dl&gt;&lt;div class=impl&gt;
 
-  &lt;p&gt;When a script invokes the &lt;dfn id=dom-window-postmessage-2 title=dom-window-postMessage-2&gt;&lt;code&gt;postMessage(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with only two
+  &lt;p&gt;When a script invokes the &lt;dfn id=dom-window-postmessage title=dom-window-postMessage&gt;&lt;code&gt;postMessage(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with two or three
   arguments) on a &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object, the user agent must
   follow these steps:
 
@@ -65660,123 +65654,35 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Return from the &lt;code title=dom-window-postMessage-2&gt;&lt;a href=#dom-window-postmessage-2&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, but
-    asynchronously continue running these steps.&lt;/p&gt;
+    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is present but either
+    any of the entries in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; are null, or any
+    &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; object is listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; more than once, or any of the
+    &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; objects listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; have already been cloned once before, then
+    throw an &lt;code&gt;&lt;a href=#invalid_state_err&gt;INVALID_STATE_ERR&lt;/a&gt;&lt;/code&gt; exception and abort these
+    steps.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is a single
-    literal U+002F SOLIDUS character (/), and the
-    &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which
-    the method was invoked does not have the &lt;a href=#same-origin&gt;same origin&lt;/a&gt;
-    as the &lt;a href=#entry-script&gt;entry script&lt;/a&gt;'s &lt;a href=&quot;#script's-document&quot; title=&quot;script's
-    document&quot;&gt;document&lt;/a&gt;, then abort these steps silently.&lt;/p&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; be an empty array.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, if the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is
-    an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt;, and the &lt;code&gt;&lt;a href=#document&gt;Document&lt;/a&gt;&lt;/code&gt; of the
-    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the method was invoked does
-    not have the &lt;a href=#same-origin&gt;same origin&lt;/a&gt; as &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, then abort these steps silently.&lt;/p&gt;
+    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is present, then for
+    each port in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; in turn, obtain a new port
+    by &lt;a href=#clone-a-port title=&quot;clone a port&quot;&gt;cloning&lt;/a&gt; the port with the
+    &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the method was invoked as the
+    owner of the clone, and append the clone to the &lt;var title=&quot;&quot;&gt;new
+    ports&lt;/var&gt; array.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is a
-    single literal U+002A ASTERISK character (*), and no origin check
-    is made.&lt;/p&gt;
+    &lt;p class=note&gt;If the original &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument
+    was omitted or empty, then the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array
+    will be empty.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;Create an event that uses the &lt;code&gt;&lt;a href=#messageevent&gt;MessageEvent&lt;/a&gt;&lt;/code&gt;
-    interface, with the event name &lt;code title=event-message&gt;&lt;a href=#event-message&gt;message&lt;/a&gt;&lt;/code&gt;, which does not bubble, is
-    not cancelable, and has no default action. The &lt;code title=dom-MessageEvent-data&gt;&lt;a href=#dom-messageevent-data&gt;data&lt;/a&gt;&lt;/code&gt; attribute must be set to
-    the value of &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt;, the &lt;code title=dom-MessageEvent-origin&gt;&lt;a href=#dom-messageevent-origin&gt;origin&lt;/a&gt;&lt;/code&gt; attribute must be
-    set to the &lt;a href=#unicode-serialization-of-an-origin title=&quot;Unicode serialization of an
-    origin&quot;&gt;Unicode serialization&lt;/a&gt; of the &lt;a href=#origin&gt;origin&lt;/a&gt; of
-    the script that invoked the method, and the &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt; attribute must be
-    set to the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;'s
-    &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt; &lt;!-- invariant: the global
-    object is always a Window if the script can see this method --&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to dispatch the event created in the
-    previous step at the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the
-    method was invoked. The &lt;a href=#task-source&gt;task source&lt;/a&gt; for this &lt;a href=#concept-task title=concept-task&gt;task&lt;/a&gt; is the &lt;a href=#posted-message-task-source&gt;posted message task
-    source&lt;/a&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-  &lt;/ol&gt;&lt;/div&gt;
-
-
-  &lt;div class=impl&gt;
-
-  &lt;h4 id=posting-messages-with-message-ports&gt;&lt;span class=secno&gt;9.2.4 &lt;/span&gt;Posting messages with message ports&lt;/h4&gt;
-
-  &lt;p&gt;When a script invokes the &lt;dfn id=dom-window-postmessage-3 title=dom-window-postMessage-3&gt;&lt;code&gt;postMessage(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with three arguments) on
-  a &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object, the user agent must follow these
-  steps:
-
-  &lt;ol&gt;&lt;!-- EXCEPT WHERE NOTED, THESE STEPS ARE IDENTICAL TO THE PREVIOUS SECTION --&gt;&lt;!-- one exception is the use of -3 instead of -2 in the xrefs --&gt;&lt;li&gt;
-
-    &lt;p&gt;If the value of the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument
-    is neither a single U+002A ASTERISK character (*), a single U+002F
-    SOLIDUS character (/), nor an &lt;a href=#absolute-url&gt;absolute URL&lt;/a&gt; with a
-    &lt;code title=url-host-specific&gt;&lt;a href=#url-host-specific&gt;&lt;host-specific&gt;&lt;/a&gt;&lt;/code&gt;
-    component that is either empty or a single U+002F SOLIDUS
-    character (/), then throw a &lt;code&gt;&lt;a href=#syntax_err&gt;SYNTAX_ERR&lt;/a&gt;&lt;/code&gt; exception and
-    abort the overall set of steps.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt; be the result of
-    obtaining a &lt;a href=#structured-clone&gt;structured clone&lt;/a&gt; of the &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; argument. If this throws an exception, then
-    throw that exception and abort these steps.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is empty&lt;!-- or null
-    (if we make it nullable)--&gt;, then act as if the method had just
-    been &lt;a href=#dom-window-postmessage-2 title=dom-window-postMessage-2&gt;called with two
-    arguments&lt;/a&gt;, &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; and &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;If any of the entries in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; are null, if
-    any &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; object is listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; more than once, or if any of the
-    &lt;code&gt;&lt;a href=#messageport&gt;MessagePort&lt;/a&gt;&lt;/code&gt; objects listed in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; have already been cloned once before, then
-    throw an &lt;code&gt;&lt;a href=#invalid_state_err&gt;INVALID_STATE_ERR&lt;/a&gt;&lt;/code&gt; exception.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; be an empty array.&lt;/p&gt;
-
-    &lt;p&gt;For each port in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; in turn,
-    obtain a new port by &lt;a href=#clone-a-port title=&quot;clone a port&quot;&gt;cloning&lt;/a&gt; the
-    port with the &lt;code&gt;&lt;a href=#window&gt;Window&lt;/a&gt;&lt;/code&gt; object on which the method was
-    invoked as the owner of the clone, and append the clone to the
-    &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt;
-&lt;!--
-    &lt;p class=&quot;note&quot;&gt;If the original &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt;
-    array was empty, then the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array will
-    also be empty.&lt;/p&gt;
---&gt;
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Return from the &lt;code title=dom-window-postMessage-3&gt;&lt;a href=#dom-window-postmessage-3&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, but
+    &lt;p&gt;Return from the &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt; method, but
     asynchronously continue running these steps.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -65809,20 +65715,15 @@
     the value of &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt;, the &lt;code title=dom-MessageEvent-origin&gt;&lt;a href=#dom-messageevent-origin&gt;origin&lt;/a&gt;&lt;/code&gt; attribute must be
     set to the &lt;a href=#unicode-serialization-of-an-origin title=&quot;Unicode serialization of an
     origin&quot;&gt;Unicode serialization&lt;/a&gt; of the &lt;a href=#origin&gt;origin&lt;/a&gt; of
-    the script that invoked the method, and the &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt; attribute must be
+    the script that invoked the method, the &lt;code title=dom-MessageEvent-source&gt;&lt;a href=#dom-messageevent-source&gt;source&lt;/a&gt;&lt;/code&gt; attribute must be
     set to the &lt;a href=&quot;#script's-global-object&quot;&gt;script's global object&lt;/a&gt;'s
-    &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object.&lt;/p&gt; &lt;!-- invariant: the global
-    object is always a Window if the script can see this method --&gt;
+    &lt;code&gt;&lt;a href=#windowproxy&gt;WindowProxy&lt;/a&gt;&lt;/code&gt; object, and the &lt;code title=dom-MessageEvent-ports&gt;&lt;a href=#dom-messageevent-ports&gt;ports&lt;/a&gt;&lt;/code&gt; attribute must be set
+    to the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt; &lt;!-- invariant:
+    the global object is always a Window if the script can see this
+    method --&gt;
 
    &lt;/li&gt;
 
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;Let the &lt;code title=dom-MessageEvent-ports&gt;&lt;a href=#dom-messageevent-ports&gt;ports&lt;/a&gt;&lt;/code&gt; attribute
-    of the event be the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt;
-
-   &lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;&lt;a href=#queue-a-task&gt;Queue a task&lt;/a&gt; to dispatch the event created in the
@@ -65832,19 +65733,10 @@
 
    &lt;/li&gt;
 
-  &lt;/ol&gt;&lt;p class=note&gt;These steps, with the exception of the third,
-  fourth, and fifth steps and the penultimate step, are identical to
-  those in the previous section.&lt;/p&gt;
+  &lt;/ol&gt;&lt;/div&gt;
 
-  &lt;!-- v2: we can merge this section and the previous section when
-  implementations have shipped postMessage(). Anne asked that these
-  sections be kept separate so that implementors can avoid getting
-  confused with the 'port' step. --&gt;
 
-  &lt;/div&gt;
 
-
-
   &lt;h3 id=channel-messaging&gt;&lt;span class=secno&gt;9.3 &lt;/span&gt;&lt;dfn&gt;Channel messaging&lt;/dfn&gt;&lt;/h3&gt;
 
   &lt;h4 id=introduction-7&gt;&lt;span class=secno&gt;9.3.1 &lt;/span&gt;Introduction&lt;/h4&gt;
@@ -65866,7 +65758,7 @@
   &lt;pre&gt;var channel = new MessageChannel();&lt;/pre&gt;
 
   &lt;p&gt;One of the ports is kept as the local port, and the other port is
-  sent to the remote code, e.g. using &lt;code title=dom-window-postMessage-3&gt;&lt;a href=#dom-window-postmessage-3&gt;postMessage()&lt;/a&gt;&lt;/code&gt;:&lt;/p&gt;
+  sent to the remote code, e.g. using &lt;code title=dom-window-postMessage&gt;&lt;a href=#dom-window-postmessage&gt;postMessage()&lt;/a&gt;&lt;/code&gt;:&lt;/p&gt;
 
   &lt;pre&gt;otherWindow.postMessage('hello', '<A HREF="http://example.com">http://example.com</A>', [channel.port2]);&lt;/pre&gt;
 

Modified: source
===================================================================
--- source	2010-04-12 22:51:22 UTC (rev 5001)
+++ source	2010-04-12 23:04:40 UTC (rev 5002)
@@ -60628,8 +60628,7 @@
   any &lt;span title=&quot;dom-showModalDialog&quot;&gt;showModalDialog&lt;/span&gt;(in DOMString url, in optional any argument&lt;!--, in optional DOMString features--&gt;);
 
 &lt;!--END w3c-html--&gt;  // &lt;span&gt;cross-document messaging&lt;/span&gt;
-  void &lt;span title=&quot;dom-window-postMessage-2&quot;&gt;postMessage&lt;/span&gt;(in any message, in DOMString targetOrigin);
-  void &lt;span title=&quot;dom-window-postMessage-3&quot;&gt;postMessage&lt;/span&gt;(in any message, in DOMString targetOrigin, in &lt;span&gt;MessagePortArray&lt;/span&gt; ports);
+  void &lt;span title=&quot;dom-window-postMessage&quot;&gt;postMessage&lt;/span&gt;(in any message, in DOMString targetOrigin, in optional &lt;span&gt;MessagePortArray&lt;/span&gt; ports);
 &lt;!--START w3c-html--&gt;
   // &lt;span&gt;event handler IDL attributes&lt;/span&gt;
            attribute &lt;span&gt;Function&lt;/span&gt; &lt;span title=&quot;handler-onabort&quot;&gt;onabort&lt;/span&gt;;
@@ -60780,12 +60779,8 @@
 
    &lt;li&gt;The &lt;code title=&quot;dom-location&quot;&gt;location&lt;/code&gt; object
 
-   &lt;li&gt;The &lt;code title=&quot;dom-window-postMessage-2&quot;&gt;postMessage()&lt;/code&gt;
-   method with two arguments
+   &lt;li&gt;The &lt;code title=&quot;dom-window-postMessage&quot;&gt;postMessage()&lt;/code&gt; method
 
-   &lt;li&gt;The &lt;code title=&quot;dom-window-postMessage-3&quot;&gt;postMessage()&lt;/code&gt;
-   method with three arguments
-
    &lt;li&gt;The &lt;code title=&quot;dom-frames&quot;&gt;frames&lt;/code&gt; attribute
 
    &lt;li&gt;The &lt;span&gt;dynamic nested browsing context properties&lt;/span&gt;
@@ -60814,7 +60809,7 @@
    &lt;p&gt;For instance, if two frames containing &lt;code&gt;Document&lt;/code&gt;s
    from different &lt;span title=&quot;origin&quot;&gt;origins&lt;/span&gt; access the same
    &lt;code&gt;Window&lt;/code&gt; object's &lt;code
-   title=&quot;dom-window-postMessage-2&quot;&gt;postMessage()&lt;/code&gt; method, they
+   title=&quot;dom-window-postMessage&quot;&gt;postMessage()&lt;/code&gt; method, they
    will get distinct objects that are not equal.&lt;/p&gt;
 
   &lt;/div&gt;
@@ -80346,7 +80341,7 @@
 
    &lt;p&gt;For example, if document A contains an &lt;code&gt;iframe&lt;/code&gt;
    element that contains document B, and script in document A calls
-   &lt;code title=&quot;dom-window-postMessage-2&quot;&gt;postMessage()&lt;/code&gt; on the
+   &lt;code title=&quot;dom-window-postMessage&quot;&gt;postMessage()&lt;/code&gt; on the
    &lt;code&gt;Window&lt;/code&gt; object of document B, then a message event will
    be fired on that object, marked as originating from the
    &lt;code&gt;Window&lt;/code&gt; of document A. The script in document A might
@@ -80403,7 +80398,7 @@
   format. Otherwise, if the source of the event has been attacked
   using a cross-site scripting flaw, further unchecked processing of
   information sent using the &lt;code
-  title=&quot;dom-window-postMessage-2&quot;&gt;postMessage()&lt;/code&gt; method could
+  title=&quot;dom-window-postMessage&quot;&gt;postMessage()&lt;/code&gt; method could
   result in the attack being propagated into the receiver.&lt;/p&gt;
 
   &lt;p&gt;Authors should not use the wildcard keyword (*) in the &lt;var
@@ -80436,7 +80431,7 @@
 
   &lt;dl class=&quot;domintro&quot;&gt;
 
-   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=&quot;dom-window-postMessage-2&quot;&gt;postMessage&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; ])&lt;/dt&gt;
+   &lt;dt&gt;&lt;var title=&quot;&quot;&gt;window&lt;/var&gt; . &lt;code title=&quot;dom-window-postMessage&quot;&gt;postMessage&lt;/code&gt;(&lt;var title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; [, &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; ])&lt;/dt&gt;
 
    &lt;dd&gt;
 
@@ -80462,9 +80457,9 @@
   &lt;div class=&quot;impl&quot;&gt;
 
   &lt;p&gt;When a script invokes the &lt;dfn
-  title=&quot;dom-window-postMessage-2&quot;&gt;&lt;code&gt;postMessage(&lt;var
-  title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var
-  title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with only two
+  title=&quot;dom-window-postMessage&quot;&gt;&lt;code&gt;postMessage(&lt;var
+  title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, &lt;var
+  title=&quot;&quot;&gt;ports&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with two or three
   arguments) on a &lt;code&gt;Window&lt;/code&gt; object, the user agent must
   follow these steps:
 
@@ -80493,145 +80488,38 @@
 
    &lt;li&gt;
 
-    &lt;p&gt;Return from the &lt;code
-    title=&quot;dom-window-postMessage-2&quot;&gt;postMessage()&lt;/code&gt; method, but
-    asynchronously continue running these steps.&lt;/p&gt;
+    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is present but either
+    any of the entries in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; are null, or any
+    &lt;code&gt;MessagePort&lt;/code&gt; object is listed in &lt;var
+    title=&quot;&quot;&gt;ports&lt;/var&gt; more than once, or any of the
+    &lt;code&gt;MessagePort&lt;/code&gt; objects listed in &lt;var
+    title=&quot;&quot;&gt;ports&lt;/var&gt; have already been cloned once before, then
+    throw an &lt;code&gt;INVALID_STATE_ERR&lt;/code&gt; exception and abort these
+    steps.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is a single
-    literal U+002F SOLIDUS character (/), and the
-    &lt;code&gt;Document&lt;/code&gt; of the &lt;code&gt;Window&lt;/code&gt; object on which
-    the method was invoked does not have the &lt;span&gt;same origin&lt;/span&gt;
-    as the &lt;span&gt;entry script&lt;/span&gt;'s &lt;span title=&quot;script's
-    document&quot;&gt;document&lt;/span&gt;, then abort these steps silently.&lt;/p&gt;
+    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; be an empty array.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, if the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is
-    an &lt;span&gt;absolute URL&lt;/span&gt;, and the &lt;code&gt;Document&lt;/code&gt; of the
-    &lt;code&gt;Window&lt;/code&gt; object on which the method was invoked does
-    not have the &lt;span&gt;same origin&lt;/span&gt; as &lt;var
-    title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, then abort these steps silently.&lt;/p&gt;
+    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is present, then for
+    each port in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; in turn, obtain a new port
+    by &lt;span title=&quot;clone a port&quot;&gt;cloning&lt;/span&gt; the port with the
+    &lt;code&gt;Window&lt;/code&gt; object on which the method was invoked as the
+    owner of the clone, and append the clone to the &lt;var title=&quot;&quot;&gt;new
+    ports&lt;/var&gt; array.&lt;/p&gt;
 
-    &lt;p&gt;Otherwise, the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument is a
-    single literal U+002A ASTERISK character (*), and no origin check
-    is made.&lt;/p&gt;
+    &lt;p class=&quot;note&quot;&gt;If the original &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument
+    was omitted or empty, then the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array
+    will be empty.&lt;/p&gt;
 
    &lt;/li&gt;
 
    &lt;li&gt;
 
-    &lt;p&gt;Create an event that uses the &lt;code&gt;MessageEvent&lt;/code&gt;
-    interface, with the event name &lt;code
-    title=&quot;event-message&quot;&gt;message&lt;/code&gt;, which does not bubble, is
-    not cancelable, and has no default action. The &lt;code
-    title=&quot;dom-MessageEvent-data&quot;&gt;data&lt;/code&gt; attribute must be set to
-    the value of &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt;, the &lt;code
-    title=&quot;dom-MessageEvent-origin&quot;&gt;origin&lt;/code&gt; attribute must be
-    set to the &lt;span title=&quot;Unicode serialization of an
-    origin&quot;&gt;Unicode serialization&lt;/span&gt; of the &lt;span&gt;origin&lt;/span&gt; of
-    the script that invoked the method, and the &lt;code
-    title=&quot;dom-MessageEvent-source&quot;&gt;source&lt;/code&gt; attribute must be
-    set to the &lt;span&gt;script's global object&lt;/span&gt;'s
-    &lt;code&gt;WindowProxy&lt;/code&gt; object.&lt;/p&gt; &lt;!-- invariant: the global
-    object is always a Window if the script can see this method --&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to dispatch the event created in the
-    previous step at the &lt;code&gt;Window&lt;/code&gt; object on which the
-    method was invoked. The &lt;span&gt;task source&lt;/span&gt; for this &lt;span
-    title=&quot;concept-task&quot;&gt;task&lt;/span&gt; is the &lt;span&gt;posted message task
-    source&lt;/span&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-  &lt;/ol&gt;
-
-  &lt;/div&gt;
-
-
-  &lt;div class=&quot;impl&quot;&gt;
-
-  &lt;h4&gt;Posting messages with message ports&lt;/h4&gt;
-
-  &lt;p&gt;When a script invokes the &lt;dfn
-  title=&quot;dom-window-postMessage-3&quot;&gt;&lt;code&gt;postMessage(&lt;var
-  title=&quot;&quot;&gt;message&lt;/var&gt;, &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;, &lt;var
-  title=&quot;&quot;&gt;ports&lt;/var&gt;)&lt;/code&gt;&lt;/dfn&gt; method (with three arguments) on
-  a &lt;code&gt;Window&lt;/code&gt; object, the user agent must follow these
-  steps:
-
-  &lt;ol&gt;
-
-   &lt;!-- EXCEPT WHERE NOTED, THESE STEPS ARE IDENTICAL TO THE PREVIOUS SECTION --&gt;
-   &lt;!-- one exception is the use of -3 instead of -2 in the xrefs --&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;If the value of the &lt;var title=&quot;&quot;&gt;targetOrigin&lt;/var&gt; argument
-    is neither a single U+002A ASTERISK character (*), a single U+002F
-    SOLIDUS character (/), nor an &lt;span&gt;absolute URL&lt;/span&gt; with a
-    &lt;code title=&quot;url-host-specific&quot;&gt;&lt;host-specific&gt;&lt;/code&gt;
-    component that is either empty or a single U+002F SOLIDUS
-    character (/), then throw a &lt;code&gt;SYNTAX_ERR&lt;/code&gt; exception and
-    abort the overall set of steps.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
-    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;message clone&lt;/var&gt; be the result of
-    obtaining a &lt;span&gt;structured clone&lt;/span&gt; of the &lt;var
-    title=&quot;&quot;&gt;message&lt;/var&gt; argument. If this throws an exception, then
-    throw that exception and abort these steps.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;If the &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; argument is empty&lt;!-- or null
-    (if we make it nullable)--&gt;, then act as if the method had just
-    been &lt;span title=&quot;dom-window-postMessage-2&quot;&gt;called with two
-    arguments&lt;/span&gt;, &lt;var title=&quot;&quot;&gt;message&lt;/var&gt; and &lt;var
-    title=&quot;&quot;&gt;targetOrigin&lt;/var&gt;.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;If any of the entries in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; are null, if
-    any &lt;code&gt;MessagePort&lt;/code&gt; object is listed in &lt;var
-    title=&quot;&quot;&gt;ports&lt;/var&gt; more than once, or if any of the
-    &lt;code&gt;MessagePort&lt;/code&gt; objects listed in &lt;var
-    title=&quot;&quot;&gt;ports&lt;/var&gt; have already been cloned once before, then
-    throw an &lt;code&gt;INVALID_STATE_ERR&lt;/code&gt; exception.&lt;/p&gt;
-
-   &lt;/li&gt;
-
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;Let &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; be an empty array.&lt;/p&gt;
-
-    &lt;p&gt;For each port in &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt; in turn,
-    obtain a new port by &lt;span title=&quot;clone a port&quot;&gt;cloning&lt;/span&gt; the
-    port with the &lt;code&gt;Window&lt;/code&gt; object on which the method was
-    invoked as the owner of the clone, and append the clone to the
-    &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt;
-&lt;!--
-    &lt;p class=&quot;note&quot;&gt;If the original &lt;var title=&quot;&quot;&gt;ports&lt;/var&gt;
-    array was empty, then the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array will
-    also be empty.&lt;/p&gt;
---&gt;
-   &lt;/li&gt;
-
-   &lt;li&gt;
-
     &lt;p&gt;Return from the &lt;code
-    title=&quot;dom-window-postMessage-3&quot;&gt;postMessage()&lt;/code&gt; method, but
+    title=&quot;dom-window-postMessage&quot;&gt;postMessage()&lt;/code&gt; method, but
     asynchronously continue running these steps.&lt;/p&gt;
 
    &lt;/li&gt;
@@ -80668,22 +80556,17 @@
     title=&quot;dom-MessageEvent-origin&quot;&gt;origin&lt;/code&gt; attribute must be
     set to the &lt;span title=&quot;Unicode serialization of an
     origin&quot;&gt;Unicode serialization&lt;/span&gt; of the &lt;span&gt;origin&lt;/span&gt; of
-    the script that invoked the method, and the &lt;code
+    the script that invoked the method, the &lt;code
     title=&quot;dom-MessageEvent-source&quot;&gt;source&lt;/code&gt; attribute must be
     set to the &lt;span&gt;script's global object&lt;/span&gt;'s
-    &lt;code&gt;WindowProxy&lt;/code&gt; object.&lt;/p&gt; &lt;!-- invariant: the global
-    object is always a Window if the script can see this method --&gt;
+    &lt;code&gt;WindowProxy&lt;/code&gt; object, and the &lt;code
+    title=&quot;dom-MessageEvent-ports&quot;&gt;ports&lt;/code&gt; attribute must be set
+    to the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt; &lt;!-- invariant:
+    the global object is always a Window if the script can see this
+    method --&gt;
 
    &lt;/li&gt;
 
-   &lt;li&gt; &lt;!-- NEW STEP --&gt;
-
-    &lt;p&gt;Let the &lt;code
-    title=&quot;dom-MessageEvent-ports&quot;&gt;ports&lt;/code&gt; attribute
-    of the event be the &lt;var title=&quot;&quot;&gt;new ports&lt;/var&gt; array.&lt;/p&gt;
-
-   &lt;/li&gt;
-
    &lt;li&gt;
 
     &lt;p&gt;&lt;span&gt;Queue a task&lt;/span&gt; to dispatch the event created in the
@@ -80696,15 +80579,6 @@
 
   &lt;/ol&gt;
 
-  &lt;p class=&quot;note&quot;&gt;These steps, with the exception of the third,
-  fourth, and fifth steps and the penultimate step, are identical to
-  those in the previous section.&lt;/p&gt;
-
-  &lt;!-- v2: we can merge this section and the previous section when
-  implementations have shipped postMessage(). Anne asked that these
-  sections be kept separate so that implementors can avoid getting
-  confused with the 'port' step. --&gt;
-
   &lt;/div&gt;
 
 
@@ -80732,7 +80606,7 @@
 
   &lt;p&gt;One of the ports is kept as the local port, and the other port is
   sent to the remote code, e.g. using &lt;code
-  title=&quot;dom-window-postMessage-3&quot;&gt;postMessage()&lt;/code&gt;:&lt;/p&gt;
+  title=&quot;dom-window-postMessage&quot;&gt;postMessage()&lt;/code&gt;:&lt;/p&gt;
 
   &lt;pre&gt;otherWindow.postMessage('hello', '<A HREF="http://example.com">http://example.com</A>', [channel.port2]);&lt;/pre&gt;
 


</PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="011872.html">[html5] r5001 - [e] (0) fix domintro which had gotten out of sync	with reality Fixing http://www [...]
</A></li>
	<LI>Next message: <A HREF="011874.html">[html5] r5003 - [e] (0) i can't type Fixing	http://www.w3.org/Bugs/Public/show_bug.cgi?id=9385
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11873">[ date ]</a>
              <a href="thread.html#11873">[ thread ]</a>
              <a href="subject.html#11873">[ subject ]</a>
              <a href="author.html#11873">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.whatwg.org/listinfo.cgi/commit-watchers-whatwg.org">More information about the Commit-Watchers
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
