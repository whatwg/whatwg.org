<!DOCTYPE html>
<!DOCTYPE html><html class="split chapter" lang="en-US-x-hixie"><title>10 The XHTML syntax &mdash; HTML5</title><link href="/style/specification" rel="stylesheet"><link href="/images/icon" rel="icon"><style>
   .proposal { border: blue solid; padding: 1em; }
   .bad, .bad *:not(.XXX) { color: gray; border-color: gray; background: transparent; }
   #updatesStatus { display: none; }
   #updatesStatus.relevant { display: block; position: fixed; right: 1em; top: 1em; padding: 0.5em; font: bold small sans-serif; min-width: 25em; width: 30%; max-width: 40em; height: auto; border: ridge 4px gray; background: #EEEEEE; color: black; }
   div.head .logo { width: 11em; margin-bottom: 20em; }
   #configUI { position: absolute; z-index: 20; top: 10em; right: 1em; width: 11em; font-size: small; }
   #configUI p { margin: 0.5em 0; padding: 0.3em; background: #EEEEEE; color: black; border: inset thin; }
   #configUI p label { display: block; }
   #configUI #updateUI, #configUI .loginUI { text-align: center; }
   #configUI input[type=button] { display: block; margin: auto; }
   #reviewer { position: fixed; bottom: 0; right: 0; white-space: nowrap; border: thin; border-style: inset none none inset; background: #EEEEEE; color: black; overflow: hidden; z-index: 30; }
   #reviewer * { font-size: small; }
   #reviewer.off > :not(:first-child) { display: none; }
   @media print { #configUI { display: none; } }
   .rfc2119 { font-variant: small-caps; text-shadow: 0 0 0.5em yellow; position: static; }
   .rfc2119::after { position: absolute; left: 0; width: 25px; text-align: center; color: yellow; text-shadow: 0.075em 0.075em 0.2em black; }
   .rfc2119.m\ust::after { content: '\2605'; }
   .rfc2119.s\hould::after { content: '\2606'; }
   [hidden] { display: none; }
  </style><style type="text/css">

   .applies thead th > * { display: block; }
   .applies thead code { display: block; }
   .applies tbody th { whitespace: nowrap; }
   .applies td { text-align: center; }
   .applies .yes { background: yellow; }

   .matrix, .matrix td { border: none; text-align: right; }
   .matrix { margin-left: 2em; }

   .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
   .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
   .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

   #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
   #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
   #table-example-1 caption { padding-bottom: 0.5em; }
   #table-example-1 thead, #table-example-1 tbody { border: none; }
   #table-example-1 th, #table-example-1 td { border: solid thin; }
   #table-example-1 th { font-weight: normal; }
   #table-example-1 td { border-style: none solid; vertical-align: top; }
   #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
   #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
   #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
   #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
   #table-example-1 tbody td:first-child::after { content: leader(". "); }
   #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
   #table-example-1 tbody td:first-child + td { width: 10em; }
   #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
   #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

   .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
   .apple-table-examples * { font-family: "Times", serif; }
   .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
   .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
   .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
   .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
   .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
   .apple-table-examples td { text-align: right; vertical-align: top; }
   .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
   .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
   .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
   .apple-table-examples sup { line-height: 0; }

  </style><link href="data:text/css," id="complete" rel="stylesheet" title="Complete specification"><link href="data:text/css,.impl%20{%20display:%20none;%20}" id="author" rel="alternate stylesheet" title="Author documentation only"><link href="data:text/css,.impl%20{%20background:%20%23FFEEEE;%20}" id="highlight" rel="alternate stylesheet" title="Highlight implementation requirements"><script>
   var loadTimer = new Date();
   var current_revision = "r" + "$Revision: 4372 $".substr(11);
   current_revision = current_revision.substr(0, current_revision.length - 2);
   var last_known_revision = current_revision;
   function getCookie(name) {
     var params = location.search.substr(1).split("&");
     for (var index = 0; index < params.length; index++) {
       if (params[index] == name)
         return "1";
       var data = params[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     var cookies = document.cookie.split("; ");
     for (var index = 0; index < cookies.length; index++) {
       var data = cookies[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     return null;
   }
   function load(script) {
     var e = document.createElement('script');
     e.setAttribute('src', script);
     document.body.appendChild(e);
   }
   function init() {
     if (location.search == '?slow-browser')
       return;
     var configUI = document.createElement('div');
     configUI.id = 'configUI';
     document.body.appendChild(configUI);
     if (document.documentElement.className == "" || document.documentElement.className == "split index")
       load('toc.js');
     load('styler.js');
     if (document.documentElement.className == "")
       load('dfn.js');
     if (getCookie('profile') == '1')
       document.getElementsByTagName('h2')[0].textContent += '; load: ' + (new Date() - loadTimer) + 'ms';
   }
  </script>
  <script src="link-fixup.js"></script>
  <link href="named-character-references.html" rel="prev" title="9.6 Named character references">
  <link href="index.html#contents" rel="index" title="Table of contents">
  <link href="rendering.html" rel="next" title="11 Rendering">
  <body class="cfc" onload="fixBrokenLink(); init()">
  <style scoped>
   * { color: gray ! important; background: none ! important; border-color: silver ! important; }
   img, object, iframe { filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); -webkit-filter: grayscale(100%); }
   .obsolete { border: double thick red ! important; background: yellow ! important; margin: 4em auto 0 auto; max-width: 50em; width: 70%; text-align: center; position: fixed;  z-index: 10000; top: 0; left: 0; right: 0; }
   .obsolete a { color: blue ! important; }
   .obsolete p { font: 900 2em sans-serif; color: red ! important; margin: 1em 1.5em ! important; }
  </style>
  <div class=obsolete>
   <p>This is a snapshot of an early working draft and has therefore
   been superseded by the <a href="http://whatwg.org/html">HTML
   standard</a>.</p>
   <p>This document will not be further updated.</p>
  </div>
<header class="head"><p><a class="logo" href="http://www.whatwg.org/" rel="home"><img alt="WHATWG" src="/images/logo"></a></p>
   <hgroup><h1>HTML5</h1>
    <h2 class="no-num no-toc">Draft Standard &mdash; Call For Comments &mdash; 27 October 2009</h2>
   </hgroup></header><nav>
   <a href="named-character-references.html">&larr; 9.6 Named character references</a> &ndash;
   <a href="index.html#contents">Table of contents</a> &ndash;
   <a href="rendering.html">11 Rendering &rarr;</a>
  <ol class="toc"><li><a href="the-xhtml-syntax.html#the-xhtml-syntax"><span class="secno">10 </span>The XHTML syntax</a>
  <ol><li><a href="the-xhtml-syntax.html#writing-xhtml-documents"><span class="secno">10.1 </span>Writing XHTML documents</a><li><a href="the-xhtml-syntax.html#parsing-xhtml-documents"><span class="secno">10.2 </span>Parsing XHTML documents</a><li><a href="the-xhtml-syntax.html#serializing-xhtml-fragments"><span class="secno">10.3 </span>Serializing XHTML fragments</a><li><a href="the-xhtml-syntax.html#parsing-xhtml-fragments"><span class="secno">10.4 </span>Parsing XHTML fragments</a></ol></ol></nav>

  <h2 id="the-xhtml-syntax"><span class="secno">10 </span><dfn id="xhtml">The XHTML syntax</dfn></h2>

  <p class="note">This section only describes the rules for XML
  resources. Rules for <code><a href="iana.html#text/html">text/html</a></code> resources are discussed
  in the section above entitled "<a href="syntax.html#syntax">The HTML syntax</a>".</p>


  <div class="impl">

  <h3 id="writing-xhtml-documents"><span class="secno">10.1 </span>Writing XHTML documents</h3>

  </div>

  <p>The syntax for using HTML with XML, whether in XHTML documents or
  embedded in other XML documents, is defined in the XML and
  Namespaces in XML specifications. <a href="references.html#refsXML">[XML]</a> <a href="references.html#refsXMLNS">[XMLNS]</a></p>

  <p>This specification does not define any syntax-level requirements
  beyond those defined for XML proper.</p>

  <p>XML documents may contain a <code>DOCTYPE</code> if desired, but
  this is not required to conform to this specification. This
  specification does not define a public or system identifier, nor
  provide a format DTD.</p>

  <p class="note">According to the XML specification, XML processors
  are not guaranteed to process the external DTD subset referenced in
  the DOCTYPE. This means, for example, that using entity references
  for characters in XHTML documents is unsafe if they are defined in
  an external file (except for <code title="">&amp;lt;</code>, <code title="">&amp;gt;</code>, <code title="">&amp;amp;</code>, <code title="">&amp;quot;</code> and <code title="">&amp;apos;</code>).</p>


  <div class="impl">

  <h3 id="parsing-xhtml-documents"><span class="secno">10.2 </span>Parsing XHTML documents</h3>

  <p>This section describes the relationship between XML and the DOM,
  with a particular emphasis on how this interacts with HTML.</p>

  <p>An <dfn id="xml-parser">XML parser</dfn>, for the purposes of this specification,
  is a construct that follows the rules given in the XML specification
  to map a string of bytes or characters into a <code>Document</code>
  object.</p>

  <p>An <a href="#xml-parser">XML parser</a> is either associated with a
  <code>Document</code> object when it is created, or creates one
  implicitly.</p>

  <p>This <code>Document</code> must then be populated with DOM nodes
  that represent the tree structure of the input passed to the parser,
  as defined by the XML specification, the Namespaces in XML
  specification, and the DOM Core specification. DOM mutation events
  must not fire for the operations that the <a href="#xml-parser">XML parser</a>
  performs on the <code>Document</code>'s tree, but the user agent
  must act as if elements and attributes were individually appended
  and set respectively so as to trigger rules in this specification
  regarding what happens when an element in inserted into a document
  or has its attributes set. <a href="references.html#refsXML">[XML]</a> <a href="references.html#refsXMLNS">[XMLNS]</a> <a href="references.html#refsDOMCORE">[DOMCORE]</a>
  <a href="references.html#refsDOMEVENTS">[DOMEVENTS]</a></p>

  <p>Certain algorithms in this specification <dfn id="feed-the-parser" title="feed the
  parser">spoon-feed the parser</dfn> characters one string at a
  time. In such cases, the <a href="#xml-parser">XML parser</a> must act as it
  would have if faced with a single string consisting of the
  concatenation of all those characters.</p>

  <p>When an <a href="#xml-parser">XML parser</a> creates a <code><a href="scripting-1.html#script">script</a></code>
  element, it must be marked as being <a href="scripting-1.html#parser-inserted">"parser-inserted"</a>.
  If the parser was originally created for the <a href="#xml-fragment-parsing-algorithm">XML fragment
  parsing algorithm</a>, then the element must be marked as
  <a href="scripting-1.html#already-started">"already started"</a> also. When the element's end tag is
  parsed, the user agent must <a href="scripting-1.html#running-a-script" title="running a
  script">run</a> the <code><a href="scripting-1.html#script">script</a></code> element. If this causes
  there to be a <a href="scripting-1.html#pending-parsing-blocking-script">pending parsing-blocking script</a>, then the
  user agent must run the following steps:</p>

  <ol><li><p>Block this instance of the <a href="#xml-parser">XML parser</a>, such
   that the <a href="origin-0.html#event-loop">event loop</a> will not run <a href="origin-0.html#concept-task" title="concept-task">tasks</a> that invoke it.</li>

   <li><p><a href="origin-0.html#spin-the-event-loop">Spin the event loop</a> until there is no <a href="semantics.html#a-style-sheet-blocking-scripts" title="a style sheet blocking scripts">style sheet blocking
   scripts</a> and the <a href="scripting-1.html#pending-parsing-blocking-script">pending parsing-blocking
   script</a>'s <a href="scripting-1.html#ready-to-be-parser-executed">"ready to be parser-executed"</a> flag is
   set.</li>

   <li><p>Unblock this instance of the <a href="#xml-parser">XML parser</a>, such
   that <a href="origin-0.html#concept-task" title="concept-task">tasks</a> that invoke it can
   again be run.</li>

   <li><p><a href="scripting-1.html#executing-a-script-block" title="executing a script block">Execute</a> the
   <a href="scripting-1.html#pending-parsing-blocking-script">pending parsing-blocking script</a>.</li>

   <li><p>There is no longer a <a href="scripting-1.html#pending-parsing-blocking-script">pending parsing-blocking
   script</a>.</li>

  </ol><p class="note">Since the <code title="dom-document-write"><a href="apis-in-html-documents.html#dom-document-write">document.write()</a></code> API is not
  available for <a href="dom.html#xml-documents">XML documents</a>, much of the complexity in
  the <a href="parsing.html#html-parser">HTML parser</a> is not needed in the <a href="#xml-parser">XML
  parser</a>.</p>

  <p>When an <a href="#xml-parser">XML parser</a> reaches the end of its input, it
  must <a href="the-end.html#stop-parsing">stop parsing</a>, following the same rules as the
  <a href="parsing.html#html-parser">HTML parser</a>.</p>

  <p>For the purposes of conformance checkers, if a resource is
  determined to be in <a href="#the-xhtml-syntax">the XHTML syntax</a>, then it is an
  <a href="dom.html#xml-documents" title="XML documents">XML document</a>.</p>



  <h3 id="serializing-xhtml-fragments"><span class="secno">10.3 </span>Serializing XHTML fragments</h3>

  <p>The <dfn id="xml-fragment-serialization-algorithm">XML fragment serialization algorithm</dfn> for a
  <code>Document</code> or <code>Element</code> node either returns a
  fragment of XML that represents that node or raises an
  exception.</p>

  <p>For <code>Document</code>s, the algorithm must return a string in
  the form of a <a href="http://www.w3.org/TR/xml/#sec-well-formed">document
  entity</a>, if none of the error cases below apply.</p>

  <p>For <code>Element</code>s, the algorithm must return a string in
  the form of an <a href="http://www.w3.org/TR/xml/#wf-entities">internal general parsed
  entity</a>, if none of the error cases below apply.</p>

  <p>In both cases, the string returned must be XML
  namespace-well-formed and must be an isomorphic serialization of all
  of that node's child nodes, in <a href="infrastructure.html#tree-order">tree order</a>. User agents
  may adjust prefixes and namespace declarations in the serialization
  (and indeed might be forced to do so in some cases to obtain
  namespace-well-formed XML). User agents may use a combination of
  regular text, character references, and CDATA sections to represent
  <a href="infrastructure.html#text-node" title="text node">text nodes</a> in the DOM (and indeed
  might be forced to use representations that don't match the DOM's,
  e.g. if a <code>CDATASection</code> node contains the string "<code title="">]]&gt;</code>").</p>

  <p>For <code>Element</code>s, if any of the elements in the
  serialization are in no namespace, the default namespace in scope
  for those elements must be explicitly declared as the empty
  string.<!-- because otherwise round-tripping might break since it'll
  pick up the surrounding default ns when setting --> (This doesn't
  apply in the <code>Document</code> case.) <a href="references.html#refsXML">[XML]</a> <a href="references.html#refsXMLNS">[XMLNS]</a></p>

  <p>For the purposes of this section, an internal general parsed
  entity is considered XML namespace-well-formed if a document
  consisting of an element with no namespace declarations whose
  contents are the internal general parsed entity would itself be XML
  namespace-well-formed.</p>

  <p>If any of the following error cases are found in the DOM subtree
  being serialized, then the algorithm must raise an
  <code><a href="urls.html#invalid_state_err">INVALID_STATE_ERR</a></code> exception instead of returning a
  string:</p>

  <ul><li>A <code>Document</code> node with no child element nodes.</li>

   <li>A <code>DocumentType</code> node that has an external subset
   public identifier that contains characters that are not matched by
   the XML <code title="">PubidChar</code> production. <a href="references.html#refsXML">[XML]</a></li>

   <li>A <code>DocumentType</code> node that has an external subset
   system identifier that contains both a U+0022 QUOTATION MARK (")
   and a U+0027 APOSTROPHE (') or that contains characters that are
   not matched by the XML <code title="">Char</code> production. <a href="references.html#refsXML">[XML]</a></li>

   <li>A node with a <!--prefix or--> local name containing a U+003A
   COLON (:).</li> <!--(prefixes can get adjusted, so this isn't an
   excuse) -->

   <li>A node with a <!--prefix or--> local name that does not match
   the XML <code title="">Name</code> production. <a href="references.html#refsXML">[XML]</a></li> <!--(again, prefixes can get
   adjusted, so this isn't an excuse) -->

   <li>An <code>Attr</code> node with no namespace whose local name is
   the lowercase string "<code title="">xmlns</code>". <a href="references.html#refsXMLNS">[XMLNS]</a></li>

   <li>An <code>Element</code> node with two or more attributes with
   the same local name and namespace.</li>

   <li>An <code>Attr</code> node, <code>Text</code> node,
   <code>CDATASection</code> node, <code>Comment</code> node, or
   <code>ProcessingInstruction</code> node whose data contains
   characters that are not matched by the XML <code title="">Char</code> production. <a href="references.html#refsXML">[XML]</a></li>

   <!--<li>A <code>CDATASection</code> node whose data contains the
   string "<code title="">]]&gt;</code>".</li> (these can be split)-->

   <li>A <code>Comment</code> node whose data contains two adjacent
   U+002D HYPHEN-MINUS characters (-) or ends with such a
   character.</li>

   <li>A <code>ProcessingInstruction</code> node whose target name is
   an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for the string "<code title="">xml</code>".</li>

   <li>A <code>ProcessingInstruction</code> node whose target name
   contains a U+003A COLON (:).</li>

   <li>A <code>ProcessingInstruction</code> node whose data contains
   the string "<code title="">?&gt;</code>".</li>

  </ul><p class="note">These are the only ways to make a DOM
  unserializable. The DOM enforces all the other XML constraints; for
  example, trying to append two elements to a <code>Document</code>
  node will raise a <code><a href="urls.html#hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code> exception.</p>



  <h3 id="parsing-xhtml-fragments"><span class="secno">10.4 </span>Parsing XHTML fragments</h3>

  <p>The <dfn id="xml-fragment-parsing-algorithm">XML fragment parsing algorithm</dfn> for either returns
  a <code>Document</code> or raises a <code><a href="urls.html#syntax_err">SYNTAX_ERR</a></code>
  exception. Given a string <var title="">input</var> and an optional
  context element <var title="">context</var>, the algorithm is as
  follows:</p>

  <ol><li>

    <p>Create a new <a href="#xml-parser">XML parser</a>.</p>

   </li>

   <li>

    <p>If there is a <var title="">context</var> element, <a href="#feed-the-parser">feed
    the parser</a> just created the string corresponding to the
    start tag of that element, declaring all the namespace prefixes
    that are in scope on that element in the DOM, as well as declaring
    the default namespace (if any) that is in scope on that element in
    the DOM.</p>

    <p>A namespace prefix is in scope if the DOM Core <code title="">lookupNamespaceURI()</code> method on the element would
    return a non-null value for that prefix.</p>

    <p>The default namespace is the namespace for which the DOM Core
    <code title="">isDefaultNamespace()</code> method on the element
    would return true.</p>

   </li>

   <li>

    <p><a href="#feed-the-parser">Feed the parser</a> just created the string <var title="">input</var>.</p>

   </li>

   <li>

    <p>If there is a <var title="">context</var> element, <a href="#feed-the-parser">feed
    the parser</a> just created the string corresponding to the
    end tag of that element.</p>

   </li>

   <li>

    <p>If there is an XML well-formedness or XML namespace
    well-formedness error, then raise a <code><a href="urls.html#syntax_err">SYNTAX_ERR</a></code>
    exception and abort these steps.</p>

   </li>

   <li>

    <p>If there is a <var title="">context</var> element, then return
    the child nodes of the root element of the resulting
    <code>Document</code>, in <a href="infrastructure.html#tree-order">tree order</a>.</p>

    <p>Otherwise, return the children of the <code>Document</code>
    object, in <a href="infrastructure.html#tree-order">tree order</a>.</p>

   </li>

  </ol></div>


  
