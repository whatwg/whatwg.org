<!DOCTYPE html>
<!DOCTYPE html><html class="split chapter" lang="en-US-x-hixie"><title>7 User Interaction &mdash; HTML5</title><link href="/style/specification" rel="stylesheet"><link href="/images/icon" rel="icon"><style>
   .proposal { border: blue solid; padding: 1em; }
   .bad, .bad *:not(.XXX) { color: gray; border-color: gray; background: transparent; }
   #updatesStatus { display: none; }
   #updatesStatus.relevant { display: block; position: fixed; right: 1em; top: 1em; padding: 0.5em; font: bold small sans-serif; min-width: 25em; width: 30%; max-width: 40em; height: auto; border: ridge 4px gray; background: #EEEEEE; color: black; }
   div.head .logo { width: 11em; margin-bottom: 20em; }
   #configUI { position: absolute; z-index: 20; top: 10em; right: 1em; width: 11em; font-size: small; }
   #configUI p { margin: 0.5em 0; padding: 0.3em; background: #EEEEEE; color: black; border: inset thin; }
   #configUI p label { display: block; }
   #configUI #updateUI, #configUI .loginUI { text-align: center; }
   #configUI input[type=button] { display: block; margin: auto; }
   #reviewer { position: fixed; bottom: 0; right: 0; white-space: nowrap; border: thin; border-style: inset none none inset; background: #EEEEEE; color: black; overflow: hidden; z-index: 30; }
   #reviewer * { font-size: small; }
   #reviewer.off > :not(:first-child) { display: none; }
   @media print { #configUI { display: none; } }
   .rfc2119 { font-variant: small-caps; text-shadow: 0 0 0.5em yellow; position: static; }
   .rfc2119::after { position: absolute; left: 0; width: 25px; text-align: center; color: yellow; text-shadow: 0.075em 0.075em 0.2em black; }
   .rfc2119.m\ust::after { content: '\2605'; }
   .rfc2119.s\hould::after { content: '\2606'; }
   [hidden] { display: none; }
  </style><style type="text/css">

   .applies thead th > * { display: block; }
   .applies thead code { display: block; }
   .applies tbody th { whitespace: nowrap; }
   .applies td { text-align: center; }
   .applies .yes { background: yellow; }

   .matrix, .matrix td { border: none; text-align: right; }
   .matrix { margin-left: 2em; }

   .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
   .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
   .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

   #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
   #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
   #table-example-1 caption { padding-bottom: 0.5em; }
   #table-example-1 thead, #table-example-1 tbody { border: none; }
   #table-example-1 th, #table-example-1 td { border: solid thin; }
   #table-example-1 th { font-weight: normal; }
   #table-example-1 td { border-style: none solid; vertical-align: top; }
   #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
   #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
   #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
   #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
   #table-example-1 tbody td:first-child::after { content: leader(". "); }
   #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
   #table-example-1 tbody td:first-child + td { width: 10em; }
   #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
   #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

   .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
   .apple-table-examples * { font-family: "Times", serif; }
   .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
   .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
   .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
   .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
   .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
   .apple-table-examples td { text-align: right; vertical-align: top; }
   .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
   .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
   .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
   .apple-table-examples sup { line-height: 0; }

  </style><link href="data:text/css," id="complete" rel="stylesheet" title="Complete specification"><link href="data:text/css,.impl%20{%20display:%20none;%20}" id="author" rel="alternate stylesheet" title="Author documentation only"><link href="data:text/css,.impl%20{%20background:%20%23FFEEEE;%20}" id="highlight" rel="alternate stylesheet" title="Highlight implementation requirements"><script>
   var loadTimer = new Date();
   var current_revision = "r" + "$Revision: 4372 $".substr(11);
   current_revision = current_revision.substr(0, current_revision.length - 2);
   var last_known_revision = current_revision;
   function getCookie(name) {
     var params = location.search.substr(1).split("&");
     for (var index = 0; index < params.length; index++) {
       if (params[index] == name)
         return "1";
       var data = params[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     var cookies = document.cookie.split("; ");
     for (var index = 0; index < cookies.length; index++) {
       var data = cookies[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     return null;
   }
   function load(script) {
     var e = document.createElement('script');
     e.setAttribute('src', script);
     document.body.appendChild(e);
   }
   function init() {
     if (location.search == '?slow-browser')
       return;
     var configUI = document.createElement('div');
     configUI.id = 'configUI';
     document.body.appendChild(configUI);
     if (document.documentElement.className == "" || document.documentElement.className == "split index")
       load('toc.js');
     load('styler.js');
     if (document.documentElement.className == "")
       load('dfn.js');
     if (getCookie('profile') == '1')
       document.getElementsByTagName('h2')[0].textContent += '; load: ' + (new Date() - loadTimer) + 'ms';
   }
  </script>
  <script src="link-fixup.js"></script>
  <link href="links.html" rel="prev" title="6.12 Links">
  <link href="index.html#contents" rel="index" title="Table of contents">
  <link href="dnd.html" rel="next" title="7.9 Drag and drop">
  <body class="cfc" onload="fixBrokenLink(); init()">
  <style scoped>
   * { color: gray ! important; background: none ! important; border-color: silver ! important; }
   img, object, iframe { filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); -webkit-filter: grayscale(100%); }
   .obsolete { border: double thick red ! important; background: yellow ! important; margin: 4em auto 0 auto; max-width: 50em; width: 70%; text-align: center; position: fixed;  z-index: 10000; top: 0; left: 0; right: 0; }
   .obsolete a { color: blue ! important; }
   .obsolete p { font: 900 2em sans-serif; color: red ! important; margin: 1em 1.5em ! important; }
  </style>
  <div class=obsolete>
   <p>This is a snapshot of an early working draft and has therefore
   been superseded by the <a href="http://whatwg.org/html">HTML
   standard</a>.</p>
   <p>This document will not be further updated.</p>
  </div>
<header class="head"><p><a class="logo" href="http://www.whatwg.org/" rel="home"><img alt="WHATWG" src="/images/logo"></a></p>
   <hgroup><h1>HTML5</h1>
    <h2 class="no-num no-toc">Draft Standard &mdash; Call For Comments &mdash; 27 October 2009</h2>
   </hgroup></header><nav>
   <a href="links.html">&larr; 6.12 Links</a> &ndash;
   <a href="index.html#contents">Table of contents</a> &ndash;
   <a href="dnd.html">7.9 Drag and drop &rarr;</a>
  <ol class="toc"><li><a href="editing.html#editing"><span class="secno">7 </span>User Interaction</a>
  <ol><li><a href="editing.html#the-hidden-attribute"><span class="secno">7.1 </span>The <code>hidden</code> attribute</a><li><a href="editing.html#activation"><span class="secno">7.2 </span>Activation</a><li><a href="editing.html#scrolling-elements-into-view"><span class="secno">7.3 </span>Scrolling elements into view</a><li><a href="editing.html#focus"><span class="secno">7.4 </span>Focus</a>
    <ol><li><a href="editing.html#sequential-focus-navigation"><span class="secno">7.4.1 </span>Sequential focus navigation</a><li><a href="editing.html#focus-management"><span class="secno">7.4.2 </span>Focus management</a><li><a href="editing.html#document-level-focus-apis"><span class="secno">7.4.3 </span>Document-level focus APIs</a><li><a href="editing.html#element-level-focus-apis"><span class="secno">7.4.4 </span>Element-level focus APIs</a></ol><li><a href="editing.html#the-accesskey-attribute"><span class="secno">7.5 </span>The <code>accesskey</code> attribute</a><li><a href="editing.html#selection"><span class="secno">7.6 </span>The text selection APIs</a>
    <ol><li><a href="editing.html#documentSelection"><span class="secno">7.6.1 </span>APIs for the browsing context selection</a><li><a href="editing.html#textFieldSelection"><span class="secno">7.6.2 </span>APIs for the text field selections</a></ol><li><a href="editing.html#contenteditable"><span class="secno">7.7 </span>The <code title="attr-contenteditable">contenteditable</code> attribute</a>
    <ol><li><a href="editing.html#user-editing-actions"><span class="secno">7.7.1 </span>User editing actions</a><li><a href="editing.html#making-entire-documents-editable"><span class="secno">7.7.2 </span>Making entire documents editable</a></ol><li><a href="editing.html#spelling-and-grammar-checking"><span class="secno">7.8 </span>Spelling and grammar checking</a></ol></ol></nav>

  <h2 id="editing"><span class="secno">7 </span><dfn>User Interaction</dfn></h2>

  <p>This section describes various features that allow authors to
  enable users to edit documents and parts of documents
  interactively.</p>



  <h3 id="the-hidden-attribute"><span class="secno">7.1 </span>The <dfn title="attr-hidden"><code>hidden</code></dfn> attribute</h3>

  <p>All <a href="infrastructure.html#html-elements">HTML elements</a> may have the <code title="attr-hidden"><a href="#the-hidden-attribute">hidden</a></code> content attribute set. The <code title="attr-hidden"><a href="#the-hidden-attribute">hidden</a></code> attribute is a <a href="common-microsyntaxes.html#boolean-attribute">boolean
  attribute</a>. When specified on an element, it indicates that
  the element is not yet, or is no longer, relevant. <span class="impl">User agents should not render elements that have the
  <code title="attr-hidden"><a href="#the-hidden-attribute">hidden</a></code> attribute
  specified.</span></p>

  <div class="example">

   <p>In the following skeletal example, the attribute is used to hide
   the Web game's main screen until the user logs in:</p>

   <pre>  &lt;h1&gt;The Example Game&lt;/h1&gt;
  &lt;section id="login"&gt;
   &lt;h2&gt;Login&lt;/h2&gt;
   &lt;form&gt;
    ...
    &lt;!-- calls login() once the user's credentials have been checked --&gt;
   &lt;/form&gt;
   &lt;script&gt;
    function login() {
      // switch screens
      document.getElementById('login').hidden = true;
      document.getElementById('game').hidden = false;
    }
   &lt;/script&gt;
  &lt;/section&gt;
  &lt;section id="game" hidden&gt;
   ...
  &lt;/section&gt;</pre>

  </div>

  <p>The <code title="attr-hidden"><a href="#the-hidden-attribute">hidden</a></code> attribute must not be
  used to hide content that could legitimately be shown in another
  presentation. For example, it is incorrect to use <code title="attr-hidden"><a href="#the-hidden-attribute">hidden</a></code> to hide panels in a tabbed dialog,
  because the tabbed interface is merely a kind of overflow
  presentation &mdash; showing all the form controls in one big page
  with a scrollbar would be equivalent, and no less correct.</p>

  <p>Elements in a section hidden by the <code title="attr-hidden"><a href="#the-hidden-attribute">hidden</a></code> attribute are still active,
  e.g. scripts and form controls in such sections still render execute
  and submit respectively. Only their presentation to the user
  changes.</p>

  <div class="impl">

  <p>The <dfn id="dom-hidden" title="dom-hidden"><code>hidden</code></dfn> IDL
  attribute must <a href="urls.html#reflect">reflect</a> the content attribute of the
  same name.</p>

  </div>



  <h3 id="activation"><span class="secno">7.2 </span>Activation</h3>

  <!-- v2 idea: HTMLImageElement.click(x, y); or clickPoint(), if
       click() can't be done in IE; can this be emulated in IE by
       posting a synthetic mouse click event with those X and Y
       coords? (ack Csaba Gabor)
  -->

  <dl class="domintro"><dt><var title="">element</var> . <code title="dom-click"><a href="#dom-click">click</a></code>()</dt>

   <dd>

    <p>Acts as if the element was clicked.</p>

   </dd>

  </dl><div class="impl">

  <p>Each element has a <var title="">click in progress</var> flag,
  initially set to false.</p>

  <p>The <dfn id="dom-click" title="dom-click"><code>click()</code></dfn> method must
  run these steps:</p>

  <ol><li><p>If the element's <var title="">click in progress</var> flag
   is set to true, then abort these steps.</li>

   <li><p>Set the <var title="">click in progress</var> flag on the
   element to true.</li>

   <li><p>If the element has a defined <a href="content-models.html#activation-behavior">activation behavior</a>,
   <a href="content-models.html#run-synthetic-click-activation-steps">run synthetic click activation steps</a> on the
   element. Otherwise, <a href="origin-0.html#fire-a-click-event">fire a <code>click</code> event</a> at
   the element.</li>

   <li><p>Set the <var title="">click in progress</var> flag on the
   element to false.</li>

  </ol></div>


  <h3 id="scrolling-elements-into-view"><span class="secno">7.3 </span>Scrolling elements into view</h3> <!-- maybe this should move to [CSSOM] -->

  <dl class="domintro"><dt><var title="">element</var> . <code title="dom-scrollIntoView"><a href="#dom-scrollintoview">scrollIntoView</a></code>( [ <var title="">top</var> ] )</dt>

   <dd>

    <p>Scrolls the element into view. If the <var title="">top</var>
    argument is true, then the element will be scrolled to the top of
    the viewport, otherwise it'll be scrolled to the bottom. The
    default is the top.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-scrollintoview" title="dom-scrollIntoView"><code>scrollIntoView([<var title="">top</var>])</code></dfn> method, when called, must cause
  the element on which the method was called to have the attention of
  the user called to it.</p>

  <p class="note">In a speech browser, this could happen by having the
  current playback position move to the start of the given
  element.</p>

  <p>In visual user agents, if the argument is present and has the
  value false, the user agent should scroll the element into view such
  that both the bottom and the top of the element are in the viewport,
  with the bottom of the element aligned with the bottom of the
  viewport. If it isn't possible to show the entire element in that
  way, or if the argument is omitted or is true, then the user agent
  should instead align the top of the element with the top of the
  viewport. If the entire scrollable part of the content is visible
  all at once (e.g. if a page is shorter than the viewport), then the
  user agent should not scroll anything. Visual user agents should
  further scroll horizontally as necessary to bring the element to the
  attention of the user.</p>

  <p>Non-visual user agents may ignore the argument, or may treat it
  in some media-specific manner most useful to the user.</p>

  </div>


  <h3 id="focus"><span class="secno">7.4 </span>Focus</h3>

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%20%0A...%3Cform%3E%3Cinput%20name%3Da%20onfocus%3D%22value%2B%3D1%3Bd.name%3D%27a%27%3Bname%3D%27d%27%3Bb.focus()%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22value%2B%3D1%3Bc.focus()%22%3E%0A%3Cinput%20name%3Dc%20onfocus%3D%22value%2B%3D1%3Bd.focus()%22%3E%0A%3Cinput%20name%3Dd%20onfocus%3D%22value%2B%3D1%3Ba.focus()%22%3E -->

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A...%3Cform%3E%0A%3Ctextarea%20name%3Dt%20cols%3D100%20rows%3D3%3E%3C%2Ftextarea%3E%3Cp%3E%0A%3Cinput%20name%3Da%20onfocus%3D%22t.value%2B%3D%27af1%20%27%3Bb.focus()%3Balert(document.activeElement.name)%3Bt.value%2B%3D%27af2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27ab%20%27%3B%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22t.value%2B%3D%27bf1%20%27%3Bc.focus()%3Bt.value%2B%3D%27bf2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27bb%20%27%3B%22%3E%0A%3Cinput%20name%3Dc%20onfocus%3D%22t.value%2B%3D%27cf1%20%27%3Bc.focus()%3Bt.value%2B%3D%27cf2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27cb%20%27%3B%22%3E%0A -->

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%3Cbody%20onload%3D%22document.forms%5B0%5D.a.focus()%22%3E%0A...%3Cform%3E%0A%3Ctextarea%20name%3Dt%20cols%3D100%20rows%3D3%3E%3C%2Ftextarea%3E%3Cp%3E%0A%3Cinput%20name%3Da%20onblur%3D%22t.value%2B%3D'ab%20'%3B%20b.focus()%3B%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22t.value%2B%3D'bf1%20'%3Ba.focus()%3Bt.value%2B%3D'bf2%20'%3B%22%20onblur%3D%22t.value%2B%3D'bb%20'%3B%22%3E -->

  <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%3Cbody%3E...%3Cform%3E%0A%3Ctextarea%20name%3Dt%20cols%3D100%20rows%3D3%3E%3C%2Ftextarea%3E%3Cp%3E%0A%3Cinput%20name%3Da%20onfocus%3D%22t.value%2B%3D%27af%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27ab1%20%27%3Bb.focus()%3Bt.value%2B%3D%27ab2%20%27%3B%22%3E%0A%3Cinput%20name%3Db%20onfocus%3D%22t.value%2B%3D%27bf1%20%27%3Ba.focus()%3Bt.value%2B%3D%27bf2%20%27%3B%22%20onblur%3D%22t.value%2B%3D%27bb%20%27%3B%22%3E -->

  <!-- v2: more things to define, if no other specs define them:
   - define onfocus/onblur behaviour for Window
   - Other things to look at are IE's focus APIs (HTMLElement.setActive(),
     onBeforeActivate, onActivate, onBeforeDeactivate, onDeactivate):
       https://bugzilla.mozilla.org/show_bug.cgi?id=296471
       https://bugzilla.mozilla.org/show_bug.cgi?id=296469
       http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/setactive.asp
       http://msdn.microsoft.com/workshop/author/dhtml/reference/events/onbeforeactivate.asp
  -->

  <div class="impl">

  <p>When an element is <i>focused</i>, key events received by the
  document must be targeted at that element. There may be no element
  focused; when no element is focused, key events received by the
  document must be targeted at <a href="dom.html#the-body-element">the body element</a>.</p>

  <p>User agents may track focus for each <a href="browsers.html#browsing-context">browsing
  context</a> or <code>Document</code> individually, or may support
  only one focused element per <a href="browsers.html#top-level-browsing-context">top-level browsing context</a>
  &mdash; user agents should follow platform conventions in this
  regard.</p>

  <p>Which elements within a <a href="browsers.html#top-level-browsing-context">top-level browsing context</a>
  currently have focus must be independent of whether or not the
  <a href="browsers.html#top-level-browsing-context">top-level browsing context</a> itself has the <i>system
  focus</i>.</p>

  <p class="note">When an element is focused, the element matches the
  CSS <code>:focus</code> pseudo-class.</p>

  </div>


  <h4 id="sequential-focus-navigation"><span class="secno">7.4.1 </span>Sequential focus navigation</h4>

  <p>The <dfn id="attr-tabindex" title="attr-tabindex"><code>tabindex</code></dfn>
  content attribute specifies whether the element is focusable,
  whether it can be reached using sequential focus navigation, and the
  relative order of the element for the purposes of sequential focus
  navigation. The name "tab index" comes from the common use of the
  "tab" key to navigate through the focusable elements. The term
  "tabbing" refers to moving forward through the focusable elements
  that can be reached using sequential focus navigation.</p>

  <p>The <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute, if
  specified, must have a value that is a <a href="common-microsyntaxes.html#valid-integer">valid
  integer</a>.</p>

  <div class="impl">

  <p>If the attribute is specified, it must be parsed using the
  <a href="common-microsyntaxes.html#rules-for-parsing-integers">rules for parsing integers</a>. The attribute's values have
  the following meanings:</p>

  <dl><dt>If the attribute is omitted or parsing the value returns an
   error</dt>

   <dd>

    <p>The user agent should follow platform conventions to determine if
    the element is to be focusable and, if so, whether the element can
    be reached using sequential focus navigation, and if so, what its
    relative order should be.</p>

   </dd>

   <dt id="negative-tabindex">If the value is a negative integer</dt>

   <dd>

    <p>The user agent must allow the element to be focused, but should
    not allow the element to be reached using sequential focus
    navigation.</p>

   </dd>

   <dt>If the value is a zero</dt>

   <dd>

    <p>The user agent must allow the element to be focused, should
    allow the element to be reached using sequential focus navigation,
    and should follow platform conventions to determine the element's
    relative order.</p>

   </dd>

   <dt>If the value is greater than zero</dt>

   <dd>

    <p>The user agent must allow the element to be focused, should
    allow the element to be reached using sequential focus navigation,
    and should place the element in the sequential focus navigation
    order so that it is:</p>

    <ul><li>before any focusable element whose <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute has been
     omitted or whose value, when parsed, returns an error,</li>

     <li>before any focusable element whose <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute has a value equal
     to or less than zero,</li>

     <li>after any element whose <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute has a value
     greater than zero but less than the value of the <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute on the
     element,</li>

     <li>after any element whose <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute has a value equal
     to the value of the <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code>
     attribute on the element but that is earlier in the document in
     <a href="infrastructure.html#tree-order">tree order</a> than the element,</li>

     <li>before any element whose <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute has a value equal
     to the value of the <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code>
     attribute on the element but that is later in the document in
     <a href="infrastructure.html#tree-order">tree order</a> than the element, and</li>

     <li>before any element whose <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute has a value
     greater than the value of the <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute on the
     element.</li>

    </ul></dd>

  </dl><p>An element is <dfn id="specially-focusable">specially focusable</dfn> if the <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute's definition above
  defines the element to be focusable.</p>

  <p>An element that is <a href="#specially-focusable">specially focusable</a> but does not
  otherwise have an <a href="content-models.html#activation-behavior">activation behavior</a> defined has an
  <a href="content-models.html#activation-behavior">activation behavior</a> that does nothing.</p>

  <p class="note">This means that an element that is only focusable
  because of its <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> attribute
  will fire a <code title="event-click">click</code> event in response
  to a non-mouse activation (e.g. hitting the "enter" key while the
  element is focused).</p>

  <p>The <dfn id="dom-tabindex" title="dom-tabIndex"><code>tabIndex</code></dfn> IDL
  attribute must <a href="urls.html#reflect">reflect</a> the value of the <code title="attr-tabindex"><a href="#attr-tabindex">tabindex</a></code> content attribute. If the
  attribute is not present, or parsing its value returns an error,
  then the IDL attribute must return 0 for elements that are focusable
  and &minus;1 for elements that are not focusable.</p>

  </div>



  <div class="impl">

  <h4 id="focus-management"><span class="secno">7.4.2 </span>Focus management</h4>

  <p>An element is <dfn id="focusable">focusable</dfn> if the user agent's default
  behavior allows it to be focusable or if the element is
  <a href="#specially-focusable">specially focusable</a>, but only if the element is either
  <a href="rendering.html#being-rendered">being rendered</a> or <!-- CANVAS-FOCUS-FALLBACK --> is a
  descendant of a <code><a href="the-canvas-element.html#the-canvas-element">canvas</a></code> element that
  <a href="rendering.html#represents">represents</a> <a href="content-models.html#embedded-content">embedded content</a>.</p>

  <p>User agents should make the following elements
  <a href="#focusable">focusable</a>, unless platform conventions dictate
  otherwise:</p>

  <ul><li><code><a href="text-level-semantics.html#the-a-element">a</a></code> elements that have an <code title="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute</li>

   <li><code><a href="semantics.html#the-link-element">link</a></code> elements that have an <code title="attr-link-href"><a href="semantics.html#attr-link-href">href</a></code> attribute</li>

   <li><code><a href="the-button-element.html#the-button-element">button</a></code> elements that are not <a href="association-of-controls-and-forms.html#concept-fe-disabled" title="concept-fe-disabled">disabled</a></li>

   <li><code><a href="the-input-element.html#the-input-element">input</a></code> elements whose <code title="attr-input-type"><a href="the-input-element.html#attr-input-type">type</a></code> attribute are not in the
   <a href="states-of-the-type-attribute.html#hidden-state" title="attr-input-type-hidden">Hidden</a> state and that
   are not <a href="association-of-controls-and-forms.html#concept-fe-disabled" title="concept-fe-disabled">disabled</a></li>

   <li><code><a href="the-button-element.html#the-select-element">select</a></code> elements that are not <a href="association-of-controls-and-forms.html#concept-fe-disabled" title="concept-fe-disabled">disabled</a></li>

   <li><code><a href="the-button-element.html#the-textarea-element">textarea</a></code> elements that are not <a href="association-of-controls-and-forms.html#concept-fe-disabled" title="concept-fe-disabled">disabled</a></li>

   <li><code><a href="interactive-elements.html#the-command">command</a></code> elements that do not have a <code title="attr-command-disabled"><a href="interactive-elements.html#attr-command-disabled">disabled</a></code> attribute</li>

   <li>Elements with a <code title="attr-draggable"><a href="dnd.html#the-draggable-attribute">draggable</a></code>
   attribute set, if that would enable the user agent to allow the
   user to begin a drag operations for those elements without the use
   of a pointing device</li>

  </ul><p>In addition, each shape that is generated for an
  <code><a href="the-map-element.html#the-area-element">area</a></code> element should be <a href="#focusable">focusable</a>, unless
  platform conventions dictate otherwise. (A single <code><a href="the-map-element.html#the-area-element">area</a></code>
  element can correspond to multiple shapes, since image maps can be
  reused with multiple images on a page.)</p>

  <hr><p>The <dfn id="focusing-steps">focusing steps</dfn> are as follows:</p>

  <ol><li><p>If focusing the element will remove the focus from another
   element, then run the <a href="#unfocusing-steps">unfocusing steps</a> for that
   element.</li>

   <li>

    <p>Make the element the currently focused element in its
    <a href="browsers.html#top-level-browsing-context">top-level browsing context</a>.</p>

    <p>Some elements, most notably <code><a href="the-map-element.html#the-area-element">area</a></code>, can correspond
    to more than one distinct focusable area. If a particular area was
    indicated when the element was focused, then that is the area that
    must get focus; otherwise, e.g. when using the <code title="dom-focus"><a href="#dom-focus">focus()</a></code> method, the first such region in
    tree order is the one that must be focused.</p>

   </li>

   <li><p><a href="origin-0.html#fire-a-simple-event">Fire a simple event</a> named <code title="event-focus">focus</code> at the element.</li>

  </ol><p>User agents must run the <a href="#focusing-steps">focusing steps</a> for an
  element whenever the user moves the focus to a
  <a href="#focusable">focusable</a> element.</p>

  <p>The <dfn id="unfocusing-steps">unfocusing steps</dfn> are as follows:</p>

  <ol><li><p>If the element is an <code><a href="the-input-element.html#the-input-element">input</a></code> element, and the
   <code title="event-input-change"><a href="common-input-element-attributes.html#event-input-change">change</a></code> event applies to the
   element, and the element does not have a defined <a href="content-models.html#activation-behavior">activation
   behavior</a>, and the user has changed the element's <a href="association-of-controls-and-forms.html#concept-fe-value" title="concept-fe-value">value</a> or its list of <a href="number-state.html#concept-input-type-file-selected" title="concept-input-type-file-selected">selected files</a>
   while the control was focused without committing that change, then
   <a href="origin-0.html#fire-a-simple-event">fire a simple event</a> that bubbles named <code title="event-change">change</code> at the element, then
   <a href="association-of-controls-and-forms.html#broadcast-formchange-events">broadcast <code title="event-formchange">formchange</code>
   events</a> at the element's <a href="association-of-controls-and-forms.html#form-owner">form owner</a>.</p>

   <li><p>Unfocus the element.</li>

   <li><p><a href="origin-0.html#fire-a-simple-event">Fire a simple event</a> named <code title="event-blur">blur</code> at the element.</li>

  </ol><p>When an element that is focused stops being a
  <a href="#focusable">focusable</a> element, or stops being focused without
  another element being explicitly focused in its stead, the user
  agent should run the <a href="#focusing-steps">focusing steps</a> for <a href="dom.html#the-body-element">the body
  element</a>, if there is one; if there is not, then the user
  agent should run the <a href="#unfocusing-steps">unfocusing steps</a> for the affected
  element only.</p>

  <p class="example">For example, this might happen because the
  element is removed from its <code>Document</code>, or has a <code title="attr-hidden"><a href="#the-hidden-attribute">hidden</a></code> attribute added. It would also
  happen to an <code><a href="the-input-element.html#the-input-element">input</a></code> element when the element gets <a href="association-of-controls-and-forms.html#concept-fe-disabled" title="concept-fe-disabled">disabled</a>.</p>

  </div>


  <h4 id="document-level-focus-apis"><span class="secno">7.4.3 </span>Document-level focus APIs</h4>

  <dl class="domintro"><dt><var title="">document</var> . <code title="dom-document-activeElement"><a href="#dom-document-activeelement">activeElement</a></code></dt>

   <dd>

    <p>Returns the currently focused element.</p>

   </dd>

   <dt><var title="">document</var> . <code title="dom-document-hasFocus"><a href="#dom-document-hasfocus">hasFocus</a></code>()</dt>

   <dd>

    <p>Returns true if the document has focus; otherwise, returns false.</p>

   </dd>

   <dt><var title="">window</var> . <code title="dom-window-focus"><a href="#dom-window-focus">focus</a></code>()</dt>

   <dd>

    <p>Focuses the window. Use of this method is discouraged. Allow the user to control window focus instead.</p>

   </dd>

   <dt><var title="">window</var> . <code title="dom-window-blur"><a href="#dom-window-blur">blur</a></code>()</dt>

   <dd>

    <p>Unfocuses the window. Use of this method is discouraged. Allow the user to control window focus instead.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-document-activeelement" title="dom-document-activeElement"><code>activeElement</code></dfn>
  attribute on <code>DocumentHTML</code> objects must return the
  element in the document that is focused. If no element in the
  <code>Document</code> is focused, this must return <a href="dom.html#the-body-element">the body
  element</a>.</p>

  <p>The <dfn id="dom-document-hasfocus" title="dom-document-hasFocus"><code>hasFocus()</code></dfn> method
  on <code>DocumentHTML</code> objects must return true if the
  document's <a href="browsers.html#browsing-context">browsing context</a> is focused, and all its
  <a href="browsers.html#ancestor-browsing-context" title="ancestor browsing context">ancestor browsing
  contexts</a> are also focused, and the <a href="browsers.html#top-level-browsing-context">top-level browsing
  context</a> has the <i>system focus</i>.</p>

  <p>The <dfn id="dom-window-focus" title="dom-window-focus"><code>focus()</code></dfn>
  method on the <code><a href="browsers.html#window">Window</a></code> object, when invoked, provides a
  hint to the user agent that the script believes the user might be
  interested in the contents of the <a href="browsers.html#browsing-context">browsing context</a> of
  the <code><a href="browsers.html#window">Window</a></code> object on which the method was invoked.</p>

  <p>User agents are encouraged to have this <code title="dom-window-focus"><a href="#dom-window-focus">focus()</a></code> method trigger some kind of
  notification.</p>

  <p>The <dfn id="dom-window-blur" title="dom-window-blur"><code>blur()</code></dfn> method
  on the <code><a href="browsers.html#window">Window</a></code> object, when invoked, provides a hint to
  the user agent that the script believes the user probably is not
  currently interested in the contents of the <a href="browsers.html#browsing-context">browsing
  context</a> of the <code><a href="browsers.html#window">Window</a></code> object on which the method
  was invoked, but that the contents might become interesting again in
  the future.</p>

  <p>User agents are encouraged to ignore calls to this <code title="dom-window-blur"><a href="#dom-window-blur">blur()</a></code> method entirely.</p>

  <p class="note">Historically the <code title="dom-window-blur"><a href="#dom-window-blur">focus()</a></code> and <code title="dom-window-blur"><a href="#dom-window-blur">blur()</a></code> methods actually affected the
  system focus, but hostile sites widely abuse this behavior to the
  user's detriment.</p>

  </div>


  <h4 id="element-level-focus-apis"><span class="secno">7.4.4 </span>Element-level focus APIs</h4>

  <dl class="domintro"><dt><var title="">element</var> . <code title="dom-focus"><a href="#dom-focus">focus</a></code>()</dt>

   <dd>

    <p>Focuses the element.</p>

   </dd>

   <dt><var title="">element</var> . <code title="dom-blur"><a href="#dom-blur">blur</a></code>()</dt>

   <dd>

    <p>Unfocuses the element. Use of this method is discouraged. Focus another element instead.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-focus" title="dom-focus"><code>focus()</code></dfn> method,
  when invoked, must run the following algorithm:</p>

  <ol><li><p>If the element is marked as <i><a href="#locked-for-focus">locked for focus</a></i>, then abort
   these steps.</li>

   <li><p>If the element is not <a href="#focusable">focusable</a>, then abort these
   steps.</li>

   <li><p>Mark the element as <dfn id="locked-for-focus">locked for focus</dfn>.</li>

   <li><p>If the element is not already focused, run the <a href="#focusing-steps">focusing
   steps</a> for the element.</li>

   <li><p>Unmark the element as <i><a href="#locked-for-focus">locked for focus</a></i>.</li>

  </ol><p>The <dfn id="dom-blur" title="dom-blur"><code>blur()</code></dfn> method, when
  invoked, should run the <a href="#focusing-steps">focusing steps</a> for <a href="dom.html#the-body-element">the
  body element</a>, if there is one; if there is not, then it
  should run the <a href="#unfocusing-steps">unfocusing steps</a> for the element on
  which the method was called instead. User agents may selectively or
  uniformly ignore calls to this method for usability reasons.</p>

  </div>





  <h3 id="the-accesskey-attribute"><span class="secno">7.5 </span>The <dfn title="attr-accesskey"><code>accesskey</code></dfn> attribute</h3>

  <p>All <a href="infrastructure.html#html-elements">HTML elements</a> may have the <code title="attr-accesskey"><a href="#the-accesskey-attribute">accesskey</a></code> content attribute set. The
  <code title="attr-accesskey"><a href="#the-accesskey-attribute">accesskey</a></code> attribute's value is
  used by the user agent as a guide for creating a keyboard shortcut
  that activates or focuses the element.</p>

  <p>If specified, the value must be an <a href="common-microsyntaxes.html#ordered-set-of-unique-space-separated-tokens">ordered set of unique
  space-separated tokens</a>, each of which must be exactly one
  Unicode code point in length.</p>

  <div class="impl">

  <p>An element's <dfn id="assigned-access-key">assigned access key</dfn> is a key combination
  derived from the element's <code title="attr-accesskey"><a href="#the-accesskey-attribute">accesskey</a></code> content attribute as
  follows:</p>

  <ol><li><p>If the element has no <code title="attr-accesskey"><a href="#the-accesskey-attribute">accesskey</a></code> attribute, then skip to the
   <i>fallback</i> step below.</li>

   <li><p>Otherwise, the user agent must must <a href="common-microsyntaxes.html#split-a-string-on-spaces" title="split a
   string on spaces">split the attribute's value on spaces</a>, and
   let <var title="">keys</var> be the resulting tokens.</li>

   <li>

    <p>For each value in <var title="">keys</var> in turn, in the
    order the tokens appeared in the attribute's value, run the
    following substeps:</p>

    <ol><li><p>If the value is not a string exactly one Unicode code
     point in length, then skip the remainder of these steps for this
     value.</li>

     <li><p>If the value does not correspond to a key on the system's
     keyboard, then skip the remainder of these steps for this
     value.</li>

     <li><p>If the user agent can find a combination of modifier keys
     that, with the key that corresponds to the value given in the
     attribute, can be used as a shortcut key, then the user agent may
     assign that combination of keys as the element's <a href="#assigned-access-key">assigned
     access key</a> and abort these steps.</li>

    </ol></li>

   <li><p><i>Fallback</i>: Optionally, the user agent may assign a key
   combination of its choosing as the element's <a href="#assigned-access-key">assigned access
   key</a> and then abort these steps.</li>

   <li><p>If this step is reached, the element has no <a href="#assigned-access-key">assigned
   access key</a>.</li>

  </ol><p>Once a user agent has selected and assigned an access key for an
  element, the user agent should not change the element's
  <a href="#assigned-access-key">assigned access key</a> unless the <code title="attr-accesskey"><a href="#the-accesskey-attribute">accesskey</a></code> content attribute is changed
  or the element is moved to another <code>Document</code>.</p>

  <p>When the user presses the key combination corresponding to the
  <a href="#assigned-access-key">assigned access key</a> for an element, if the element
  <a href="commands.html#concept-command" title="concept-command">defines a command</a>, and the
  command's <a href="commands.html#command-facet-hiddenstate" title="command-facet-HiddenState">Hidden
  State</a> facet is false (visible), and the command's <a href="commands.html#command-facet-disabledstate" title="command-facet-DisabledState">Disabled State</a> facet is
  also false (enabled), then the user agent must trigger the <a href="commands.html#command-facet-action" title="command-facet-Action">Action</a> of the command.</p>

  <p>User agents may expose elements that have an <code title="attr-accesskey"><a href="#the-accesskey-attribute">accesskey</a></code> attribute in other ways as
  well, e.g. in a menu displayed in response to a specific key
  combination.</p>

  </div>

  <div class="impl">

  <p>The <dfn id="dom-accesskey" title="dom-accessKey"><code>accessKey</code></dfn> IDL
  attribute must <a href="urls.html#reflect">reflect</a> the <code title="attr-accesskey"><a href="#the-accesskey-attribute">accesskey</a></code> content attribute.</p>

  <p>The <dfn id="dom-accesskeylabel" title="dom-accessKeyLabel"><code>accessKeyLabel</code></dfn> IDL
  attribute must return a string that represents the element's
  <a href="#assigned-access-key">assigned access key</a>, if any. If the element does not
  have one, then the IDL attribute must return the empty string.</p>

  </div>

  <div class="example">

   <p>In the following example, a variety of links are given with
   access keys so that keyboard users familiar with the site can
   more quickly navigate to the relevant pages:</p>

   <pre>&lt;nav&gt;
 &lt;p&gt;
  &lt;a title="Consortium Activities" accesskey="A" href="/Consortium/activities"&gt;Activities&lt;/a&gt; |
  &lt;a title="Technical Reports and Recommendations" accesskey="T" href="/TR/"&gt;Technical Reports&lt;/a&gt; |
  &lt;a title="Alphabetical Site Index" accesskey="S" href="/Consortium/siteindex"&gt;Site Index&lt;/a&gt; |
  &lt;a title="About This Site" accesskey="B" href="/Consortium/"&gt;About Consortium&lt;/a&gt; |
  &lt;a title="Contact Consortium" accesskey="C" href="/Consortium/contact"&gt;Contact&lt;/a&gt;
 &lt;/p&gt;
&lt;/nav&gt;</pre>

  </div>

  <div class="example">

   <p>In the following example, the search field is given two possible
   access keys, "s" and "0" (in that order). A user agent on a device
   with a full keyboard might pick
   <kbd><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>S</kbd></kbd> as the
   shortcut key, while a user agent on a small device with just a
   numeric keypad might pick just the plain unadorned key
   <kbd><kbd>0</kbd></kbd>:</p>

   <pre>&lt;form action="/search"&gt;
 &lt;label&gt;Search: &lt;input type="search" name="q" accesskey="s 0"&gt;&lt;/label&gt;
 &lt;input type="submit"&gt;
&lt;/form&gt;</pre>

  </div>

  <div class="example">

   <p>In the following example, a button has possible access keys
   described. A script then tries to update the button's label to
   advertise the key combination the user agent selected.</p>

   <pre>&lt;input type=submit accesskey="N @ 1" value="Compose"&gt;
...
&lt;script&gt;
 function labelButton(button) {
   if (button.accessKeyLabel)
     button.value += ' (' + button.accessKeyLabel + ')';
 }
 var inputs = document.getElementsByTagName('input');
 for (var i = 0; i &lt; inputs.length; i += 1) {
   if (inputs[i].type == "submit")
     labelButton(inputs[i]);
 }
&lt;/script&gt;</pre>

   <p>On one user agent, the button's label might become
   "<samp>Compose (&#8984;N)</samp>". On another, it might become
   "<samp>Compose (Alt+&#8679;+1)</samp>". If the user agent doesn't
   assign a key, it will be just "<samp>Compose</samp>". The exact
   string depends on what the <a href="#assigned-access-key">assigned access key</a> is, and
   on how the user agent represents that key combination.</p>

  </div>



  <h3 id="selection"><span class="secno">7.6 </span>The text selection APIs</h3>

  <p>Every <a href="browsers.html#browsing-context">browsing context</a> has <dfn id="the-selection" title="the
  selection">a selection</dfn>. The selection can be empty, and the
  selection can have more than one range (a disjointed selection). The
  user agent should allow the user to change the selection. User
  agents are not required to let the user select more than one range,
  and may collapse multiple ranges in the selection to a single range
  when the user interacts with the selection. (But, of course, the
  user agent may let the user create selections with multiple
  ranges.)</p>

  <p>This one selection must be shared by all the content of the
  browsing context (though not by nested <a href="browsers.html#browsing-context" title="browsing
  context">browsing contexts</a>), including any editing hosts in
  the document. (Editing hosts that are not inside a document cannot
  have a selection.)</p>

  <div class="impl">

  <p>If the selection is empty (collapsed, so that it has only one
  segment and that segment's start and end points are the same) then
  the selection's position should equal the caret position. When the
  selection is not empty, this specification does not define the caret
  position; user agents should follow platform conventions in deciding
  whether the caret is at the start of the selection, the end of the
  selection, or somewhere else.</p>

  <p>On some platforms (such as those using Wordstar editing
  conventions), the caret position is totally independent of the start
  and end of the selection, even when the selection is empty. On such
  platforms, user agents may ignore the requirement that the cursor
  position be linked to the position of the selection altogether.</p>

  </div>

  <p>Mostly for historical reasons, in addition to the <a href="browsers.html#browsing-context">browsing
  context</a>'s <a href="#the-selection" title="the selection">selection</a>, each
  <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> and <code><a href="the-input-element.html#the-input-element">input</a></code> element has an
  independent selection. These are the <dfn id="text-field-selection" title="text field
  selection">text field selections</dfn>.</p>

  <div class="impl">

  <p>User agents may selectively ignore attempts to use the API to
  adjust the selection made after the user has modified the
  selection. For example, if the user has just selected part of a
  word, the user agent could ignore attempts to use the API call to
  immediately unselect the selection altogether, but could allow
  attempts to change the selection to select the entire word.</p>

  <p>User agents may also allow the user to create selections that are
  not exposed to the API.</p>

  </div>

  <!-- v2DATAGRID v2DGS:
  <p>The <code>datagrid</code> and <code>select</code> elements also
  have selections, indicating which items have been picked by the
  user. These are not discussed in this section.</p>
  -->
  <p>The <code><a href="the-button-element.html#the-select-element">select</a></code> element also has a selection, indicating
  which items have been picked by the user. This is not discussed in
  this section.</p>

  <p class="note">This specification does not specify how selections
  are presented to the user. The Selectors specification, in
  conjunction with CSS, can be used to style text selections using the
  <code title="selector-selection">::selection</code>
  pseudo-element. <a href="references.html#refsSELECTORS">[SELECTORS]</a> <a href="references.html#refsCSS">[CSS]</a></p>



  <h4 id="documentSelection"><span class="secno">7.6.1 </span>APIs for the browsing context selection</h4>

  <dl class="domintro"><dt><var title="">window</var> . <code title="dom-getSelection"><a href="#dom-getselection">getSelection</a></code>()</dt>
   <dt><var title="">document</var> . <code title="dom-document-getSelection"><a href="#dom-document-getselection">getSelection</a></code>()</dt>

   <dd>

    <p>Returns the <code><a href="#selection-0">Selection</a></code> object for the window, which
    stringifies to the text of the current selection.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-getselection" title="dom-getSelection"><code>getSelection()</code></dfn> method on
  the <code><a href="browsers.html#window">Window</a></code> interface must return the
  <code><a href="#selection-0">Selection</a></code> object representing <a href="#the-selection">the
  selection</a> of that <code><a href="browsers.html#window">Window</a></code> object's
  <a href="browsers.html#browsing-context">browsing context</a>.

  <p>For historical reasons, the <dfn id="dom-document-getselection" title="dom-document-getSelection"><code>getSelection()</code></dfn>
  method on the <code><a href="dom.html#htmldocument">HTMLDocument</a></code> interface must return the
  same <code><a href="#selection-0">Selection</a></code> object.</p>

  </div>

  <pre class="idl">interface <dfn id="selection-0">Selection</dfn> {
  readonly attribute Node <a href="#dom-selection-anchornode" title="dom-selection-anchorNode">anchorNode</a>;
  readonly attribute long <a href="#dom-selection-anchoroffset" title="dom-selection-anchorOffset">anchorOffset</a>;
  readonly attribute Node <a href="#dom-selection-focusnode" title="dom-selection-focusNode">focusNode</a>;
  readonly attribute long <a href="#dom-selection-focusoffset" title="dom-selection-focusOffset">focusOffset</a>;
  readonly attribute boolean <a href="#dom-selection-iscollapsed" title="dom-selection-isCollapsed">isCollapsed</a>;
  void <a href="#dom-selection-collapse" title="dom-selection-collapse">collapse</a>(in Node parentNode, in long offset);
  void <a href="#dom-selection-collapsetostart" title="dom-selection-collapseToStart">collapseToStart</a>();
  void <a href="#dom-selection-collapsetoend" title="dom-selection-collapseToEnd">collapseToEnd</a>();
  void <a href="#dom-selection-selectallchildren" title="dom-selection-selectAllChildren">selectAllChildren</a>(in Node parentNode);
  void <a href="#dom-selection-deletefromdocument" title="dom-selection-deleteFromDocument">deleteFromDocument</a>();
  readonly attribute long <a href="#dom-selection-rangecount" title="dom-selection-rangeCount">rangeCount</a>;
  Range <a href="#dom-selection-getrangeat" title="dom-selection-getRangeAt">getRangeAt</a>(in long index);
  void <a href="#dom-selection-addrange" title="dom-selection-addRange">addRange</a>(in Range range);
  void <a href="#dom-selection-removerange" title="dom-selection-removeRange">removeRange</a>(in Range range);
  void <a href="#dom-selection-removeallranges" title="dom-selection-removeAllRanges">removeAllRanges</a>();
  <a href="#dom-selection-tostring" title="dom-selection-toString">stringifier</a> DOMString ();
};</pre>
<!--
  See also:
    http://lxr.mozilla.org/mozilla/source/content/base/public/nsISelection.idl
  This spec doesn't have everything from there yet, in particular
  selectionLanguageChange() and containsNode() are missing. They are missing
  because I couldn't work out how to define them in terms of Ranges.

  I also haven't included extend():

    void <span title="dom-selection-extend">extend</span>(in Node parentNode, in long offset);
    // raise if no range
    // raise WRONG_DOCUMENT_ERR if parentNode not in document
    // do something

  ...mostly because I can't work out how to describe what it does quickly.
-->

  <p>The <code><a href="#selection-0">Selection</a></code> interface is represents a list of
  <code>Range</code> objects. The first item in the list has index 0,
  and the last item has index <var title="">count</var>-1, where
  <var title="">count</var> is the number of ranges in the list. <a href="references.html#refsDOMRANGE">[DOMRANGE]</a></p>

  <p>All of the members of the <code><a href="#selection-0">Selection</a></code> interface are
  defined in terms of operations on the <code>Range</code> objects
  represented by this object. These operations can raise exceptions,
  as defined for the <code>Range</code> interface; this can therefore
  result in the members of the <code><a href="#selection-0">Selection</a></code> interface
  raising exceptions as well, in addition to any explicitly called out
  below.</p>

  <dl class="domintro"><dt><var title="">selection</var> . <code title="dom-selection-anchorNode"><a href="#dom-selection-anchornode">anchorNode</a></code></dt>

   <dd>

    <p>Returns the element that contains the start of the selection.</p>

    <p>Returns null if there's no selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-anchorOffset"><a href="#dom-selection-anchoroffset">anchorOffset</a></code></dt>

   <dd>

    <p>Returns the offset of the start of the selection relative to the element that contains the start of the selection.</p>

    <p>Returns 0 if there's no selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-focusNode"><a href="#dom-selection-focusnode">focusNode</a></code></dt>

   <dd>

    <p>Returns the element that contains the end of the selection.</p>

    <p>Returns null if there's no selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-focusOffset"><a href="#dom-selection-focusoffset">focusOffset</a></code></dt>

   <dd>

    <p>Returns the offset of the end of the selection relative to the element that contains the end of the selection.</p>

    <p>Returns 0 if there's no selection.</p>

   </dd>

   <dt><var title="">collapsed</var> = <var title="">selection</var> . <code title="dom-selection-isCollapsed"><a href="#dom-selection-iscollapsed">isCollapsed</a></code>()</dt>

   <dd>

    <p>Returns true if there's no selection or if the selection is empty. Otherwise, returns false.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-collapsed">collapsed</code>(<var title="">parentNode</var>, <var title="">offset</var>)</dt>

   <dd>

    <p>Replaces the selection with an empty one at the given position.</p>

    <p>Throws a <code><a href="urls.html#wrong_document_err">WRONG_DOCUMENT_ERR</a></code> exception if the given node is in a different document.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-collapseToStart"><a href="#dom-selection-collapsetostart">collapseToStart</a></code>()</dt>

   <dd>

    <p>Replaces the selection with an empty one at the position of the start of the current selection.</p>

    <p>Throws an <code><a href="urls.html#invalid_state_err">INVALID_STATE_ERR</a></code> exception if there is no selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-collapseToEnd"><a href="#dom-selection-collapsetoend">collapseToEnd</a></code>()</dt>

   <dd>

    <p>Replaces the selection with an empty one at the position of the end of the current selection.</p>

    <p>Throws an <code><a href="urls.html#invalid_state_err">INVALID_STATE_ERR</a></code> exception if there is no selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-selectAllChildren"><a href="#dom-selection-selectallchildren">selectAllChildren</a></code>(<var title="">parentNode</var>)</dt>

   <dd>

    <p>Replaces the selection with one that contains all the contents of the given element.</p>

    <p>Throws a <code><a href="urls.html#wrong_document_err">WRONG_DOCUMENT_ERR</a></code> exception if the given node is in a different document.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-deleteFromDocument"><a href="#dom-selection-deletefromdocument">deleteFromDocument</a></code>()</dt>

   <dd>

    <p>Deletes the selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-rangeCount"><a href="#dom-selection-rangecount">rangeCount</a></code></dt>

   <dd>

    <p>Returns the number of ranges in the selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-getRangeAt"><a href="#dom-selection-getrangeat">getRangeAt</a></code>(<var title="">index</var>)</dt>

   <dd>

    <p>Returns the given range.</p>

    <p>Throws an <code><a href="urls.html#invalid_state_err">INVALID_STATE_ERR</a></code> exception if the value is out of range.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-addRange"><a href="#dom-selection-addrange">addRange</a></code>(<var title="">range</var>)</dt>

   <dd>

    <p>Adds the given range to the selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-removeRange"><a href="#dom-selection-removerange">removeRange</a></code>(<var title="">range</var>)</dt>

   <dd>

    <p>Removes the given range from the selection, if the range was one of the ones in the selection.</p>

   </dd>

   <dt><var title="">selection</var> . <code title="dom-selection-removeAllRanges"><a href="#dom-selection-removeallranges">removeAllRanges</a></code>()</dt>

   <dd>

    <p>Removes all the ranges in the selection.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-selection-anchornode" title="dom-selection-anchorNode"><code>anchorNode</code></dfn>
  attribute must return the value returned by the <code title="">startContainer</code> attribute of the last
  <code>Range</code> object in the list, or null if the list is
  empty.</p>

  <p>The <dfn id="dom-selection-anchoroffset" title="dom-selection-anchorOffset"><code>anchorOffset</code></dfn>
  attribute must return the value returned by the <code title="">startOffset</code> attribute of the last <code>Range</code>
  object in the list, or 0 if the list is empty.</p>

  <p>The <dfn id="dom-selection-focusnode" title="dom-selection-focusNode"><code>focusNode</code></dfn>
  attribute must return the value returned by the <code title="">endContainer</code> attribute of the last
  <code>Range</code> object in the list, or null if the list is
  empty.</p>

  <p>The <dfn id="dom-selection-focusoffset" title="dom-selection-focusOffset"><code>focusOffset</code></dfn>
  attribute must return the value returned by the <code title="">endOffset</code> attribute of the last <code>Range</code>
  object in the list, or 0 if the list is empty.</p>

  <p>The <dfn id="dom-selection-iscollapsed" title="dom-selection-isCollapsed"><code>isCollapsed</code></dfn>
  attribute must return true if there are zero ranges, or if there is
  exactly one range and its <code title="">collapsed</code> attribute
  is itself true. Otherwise it must return false.</p>

  <p>The <dfn id="dom-selection-collapse" title="dom-selection-collapse"><code>collapse(<var title="">parentNode</var>, <var title="">offset</var>)</code></dfn>
  method must raise a <code><a href="urls.html#wrong_document_err">WRONG_DOCUMENT_ERR</a></code> DOM exception if
  <var title="">parentNode</var>'s <code>Document</code> is not the
  <code><a href="dom.html#htmldocument">HTMLDocument</a></code> object with which the
  <code><a href="#selection-0">Selection</a></code> object is associated. Otherwise it is, and
  the method must remove all the ranges in the <code><a href="#selection-0">Selection</a></code>
  list, then create a new <code>Range</code> object, add it to the
  list, and invoke its <code title="">setStart()</code> and <code title="">setEnd()</code> methods with the <var title="">parentNode</var> and <var title="">offset</var> values as
  their arguments.</p>

  <p>The <dfn id="dom-selection-collapsetostart" title="dom-selection-collapseToStart"><code>collapseToStart()</code></dfn>
  method must raise an <code><a href="urls.html#invalid_state_err">INVALID_STATE_ERR</a></code> DOM exception if
  there are no ranges in the list. Otherwise, it must invoke the <code title="dom-selection-collapse"><a href="#dom-selection-collapse">collapse()</a></code> method with the
  <code title="">startContainer</code> and <code title="">startOffset</code> values of the first <code>Range</code>
  object in the list as the arguments.</p>

  <p>The <dfn id="dom-selection-collapsetoend" title="dom-selection-collapseToEnd"><code>collapseToEnd()</code></dfn>
  method must raise an <code><a href="urls.html#invalid_state_err">INVALID_STATE_ERR</a></code> DOM exception if
  there are no ranges in the list. Otherwise, it must invoke the <code title="dom-selection-collapse"><a href="#dom-selection-collapse">collapse()</a></code> method with the
  <code title="">endContainer</code> and <code title="">endOffset</code> values of the last <code>Range</code>
  object in the list as the arguments.</p>

  <p>The <dfn id="dom-selection-selectallchildren" title="dom-selection-selectAllChildren"><code>selectAllChildren(<var title="">parentNode</var>)</code></dfn>
  method must invoke the <code title="dom-selection-collapse"><a href="#dom-selection-collapse">collapse()</a></code> method with the
  <var title="">parentNode</var> value as the first argument and 0 as the
  second argument, and must then invoke the <code title="">selectNodeContents()</code> method on the first (and only)
  range in the list with the <var title="">parentNode</var> value as the
  argument.</p>

  <p>The <dfn id="dom-selection-deletefromdocument" title="dom-selection-deleteFromDocument"><code>deleteFromDocument()</code></dfn>
  method must invoke the <code title="">deleteContents()</code> method
  on each range in the list, if any, from first to last.</p>

  <p>The <dfn id="dom-selection-rangecount" title="dom-selection-rangeCount"><code>rangeCount</code></dfn>
  attribute must return the number of ranges in the list.</p>

  <p>The <dfn id="dom-selection-getrangeat" title="dom-selection-getRangeAt"><code>getRangeAt(<var title="">index</var>)</code></dfn>
  method must return the <var title="">index</var>th range in the list. If
  <var title="">index</var> is less than zero or greater or equal to the value
  returned by the <code title="dom-selection-rangeCount"><a href="#dom-selection-rangecount">rangeCount</a></code> attribute, then
  the method must raise an <code><a href="urls.html#index_size_err">INDEX_SIZE_ERR</a></code> DOM
  exception.</p>

  <p>The <dfn id="dom-selection-addrange" title="dom-selection-addRange"><code>addRange(<var title="">range</var>)</code></dfn>
  method must add the given <var title="">range</var> Range object to the list
  of selections, at the end (so the newly added range is the new last
  range). Duplicates are not prevented; a range may be added more than
  once in which case it appears in the list more than once, which (for
  example) will cause <a href="#dom-selection-tostring" title="dom-selection-toString">stringification</a> to return the
  range's text twice.</p>

  <p>The <dfn id="dom-selection-removerange" title="dom-selection-removeRange"><code>removeRange(<var title="">range</var>)</code></dfn>
  method must remove the first occurrence of <var title="">range</var> in the
  list of ranges, if it appears at all.</p>

  <p>The <dfn id="dom-selection-removeallranges" title="dom-selection-removeAllRanges"><code>removeAllRanges()</code></dfn>
  method must remove all the ranges from the list of ranges, such that
  the <code title="dom-selection-rangeCount"><a href="#dom-selection-rangecount">rangeCount</a></code>
  attribute returns 0 after the <code title="dom-selection-removeAllRanges"><a href="#dom-selection-removeallranges">removeAllRanges()</a></code>
  method is invoked (and until a new range is added to the list,
  either through this interface or via user interaction).</p>

  <p>Objects implementing this interface must <dfn id="dom-selection-tostring" title="dom-selection-toString">stringify</dfn> to a concatenation
  of the results of invoking the <code title="">toString()</code>
  method of the <code>Range</code> object on each of the ranges of the
  selection, in the order they appear in the list (first to last).</p>

  </div>

  <div class="example">
   <p>In the following document fragment, the emphasized parts
   indicate the selection.</p>
   <pre>&lt;p&gt;The cute girl likes <em>the </em>&lt;cite&gt;<em>Oxford English</em> Dictionary&lt;/cite&gt;.&lt;/p&gt;</pre>
   <p>If a script invoked <code title="">window.getSelection().toString()</code>, the return value
   would be "<code>the Oxford English</code>".</p>
  </div>

  <!-- v2DATAGRID v2DGS:
  <p class="note">The <code>Selection</code> interface has no relation
  to the <code>DataGridSelection</code> interface.</p>
  -->


  <h4 id="textFieldSelection"><span class="secno">7.6.2 </span>APIs for the text field selections</h4>

  <!-- v2 idea: DOM Range APIs to expose the textarea/input edited
  value (ack martijnw) -->

  <p>The <code><a href="the-input-element.html#the-input-element">input</a></code> and <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> elements define
  the following members in their DOM interfaces for handling their
  text selection:</p>

  <pre class="idl extract">  void <a href="#dom-textarea/input-select" title="dom-textarea/input-select">select</a>();
           attribute unsigned long <a href="#dom-textarea/input-selectionstart" title="dom-textarea/input-selectionStart">selectionStart</a>;
           attribute unsigned long <a href="#dom-textarea/input-selectionend" title="dom-textarea/input-selectionEnd">selectionEnd</a>;
  void <a href="#dom-textarea/input-setselectionrange" title="dom-textarea/input-setSelectionRange">setSelectionRange</a>(in unsigned long start, in unsigned long end);</pre>
  <!-- v2: also add textLength? it seems to be widely used -->

  <p>These methods and attributes expose and control the selection of
  <code><a href="the-input-element.html#the-input-element">input</a></code> and <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> text fields.</p>

  <dl class="domintro"><dt><var title="">element</var> . <code title="dom-textarea/input-select"><a href="#dom-textarea/input-select">select</a></code>()</dt>

   <dd>

    <p>Selects everything in the text field.</p>

   </dd>

   <dt><var title="">element</var> . <code title="dom-textarea/input-selecionStart">selectionStart</code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the offset to the start of the selection.</p>

    <p>Can be set, to change the start of the selection.</p>

   </dd>

   <dt><var title="">element</var> . <code title="dom-textarea/input-selecionEnd">selectionEnd</code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the offset to the end of the selection.</p>

    <p>Can be set, to change the end of the selection.</p>

   </dd>

   <dt><var title="">element</var> . <code title="dom-textarea/input-setSelectionRange"><a href="#dom-textarea/input-setselectionrange">setSelectionRange</a></code>(<var title="">start</var>, <var title="">end</var>)</dt>

   <dd>

    <p>Changes the selection to cover the given substring.</p>

   </dd>

  </dl><div class="impl">

  <p>When these methods and attributes are used with
  <code><a href="the-input-element.html#the-input-element">input</a></code> elements while they don't apply, they must raise
  an <code><a href="urls.html#invalid_state_err">INVALID_STATE_ERR</a></code> exception. Otherwise, they must
  act as described below.</p>

  <p>The <dfn id="dom-textarea/input-select" title="dom-textarea/input-select"><code>select()</code></dfn> method
  must cause the contents of the text field to be fully selected.</p>

  <p>The <dfn id="dom-textarea/input-selectionstart" title="dom-textarea/input-selectionStart"><code>selectionStart</code></dfn>
  attribute must, on getting, return the offset (in logical order) to
  the character that immediately follows the start of the
  selection. If there is no selection, then it must return the offset
  (in logical order) to the character that immediately follows the
  text entry cursor.</p>

  <p>On setting, it must act as if the <code title="dom-textarea/input-setSelectionRange"><a href="#dom-textarea/input-setselectionrange">setSelectionRange()</a></code>
  method had been called, with the new value as the first argument,
  and the current value of the <code title="dom-textarea/input-selectionEnd"><a href="#dom-textarea/input-selectionend">selectionEnd</a></code>
  attribute as the second argument, unless the current value of the
  <code title="dom-textarea/input-selectionEnd"><a href="#dom-textarea/input-selectionend">selectionEnd</a></code> is
  less than the new value, in which case the second argument must also
  be the new value.</p>

  <p>The <dfn id="dom-textarea/input-selectionend" title="dom-textarea/input-selectionEnd"><code>selectionEnd</code></dfn>
  attribute must, on getting, return the offset (in logical order) to
  the character that immediately follows the end of the selection. If
  there is no selection, then it must return the offset (in logical
  order) to the character that immediately follows the text entry
  cursor.</p>

  <p>On setting, it must act as if the <code title="dom-textarea/input-setSelectionRange"><a href="#dom-textarea/input-setselectionrange">setSelectionRange()</a></code>
  method had been called, with the current value of the <code title="dom-textarea/input-selectionStart"><a href="#dom-textarea/input-selectionstart">selectionStart</a></code>
  attribute as the first argument, and new value as the second
  argument.</p>

  <p>The <dfn id="dom-textarea/input-setselectionrange" title="dom-textarea/input-setSelectionRange"><code>setSelectionRange(<var title="">start</var>, <var title="">end</var>)</code></dfn> method
  must set the selection of the text field to the sequence of
  characters starting with the character at the <var title="">start</var>th position (in logical order) and ending with
  the character at the <span title="">(<var title="">end</var>-1)</span>th position. Arguments greater than the
  length of the value in the text field must be treated as pointing at
  the end of the text field. If <var title="">end</var> is less than
  or equal to <var title="">start</var> then the start of the
  selection and the end of the selection must both be placed
  immediately before the character with offset <var title="">end</var>. In UAs where there is no concept of an empty
  selection, this must set the cursor to be just before the character
  with offset <var title="">end</var>.</p>

  </div>

  <div class="example">

   <p>To obtain the currently selected text, the following JavaScript
   suffices:</p>

   <pre>var selectionText = control.value.substring(control.selectionStart, control.selectionEnd);</pre>

   <p>...where <var title="">control</var> is the <code><a href="the-input-element.html#the-input-element">input</a></code>
   or <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> element.</p>

  </div>

  <p>Characters with no visible rendering, such as U+200D ZERO WIDTH
  JOINER, still count as characters. Thus, for instance, the selection
  can include just an invisible character, and the text insertion
  cursor can be placed to one side or another of such a character.</p>



  <h3 id="contenteditable"><span class="secno">7.7 </span>The <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute</h3>

  <p>The <dfn id="attr-contenteditable" title="attr-contenteditable"><code>contenteditable</code></dfn>
  attribute is an <a href="common-microsyntaxes.html#enumerated-attribute">enumerated attribute</a> whose keywords are
  the empty string, <code title="">true</code>, and <code title="">false</code>. The empty string and the <code title="">true</code> keyword map to the <i>true</i> state. The <code title="">false</code> keyword maps to the <i>false</i> state. In
  addition, there is a third state, the <i>inherit</i> state, which is
  the <i>missing value default</i> (and the <i>invalid value
  default</i>).</p>

  <p>The <i>true</i> state indicates that the element is editable. The
  <i>inherit</i> state indicates that the element is editable if its
  parent is. The <i>false</i> state indicates that the element is not
  editable.</p>

  <div class="impl">

  <p>Specifically, if an <a href="infrastructure.html#html-elements" title="HTML elements">HTML
  element</a> has a <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute set to
  the true state, or it has its <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute set to
  the inherit state and if its nearest ancestor <a href="infrastructure.html#html-elements" title="HTML
  elements">HTML element</a> with the <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute set to
  a state other than the inherit state has its attribute set to the
  true state, or if it and its ancestors all have their <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute set to
  the inherit state but the <code>Document</code> has <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> enabled, then the
  UA must treat the element as <dfn id="editable">editable</dfn> (as described
  below).</p>

  <p>Otherwise, either the <a href="infrastructure.html#html-elements" title="HTML elements">HTML
  element</a> has a <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute set to
  the false state, or its <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute is set
  to the inherit state and its nearest ancestor <a href="infrastructure.html#html-elements" title="HTML
  elements">HTML element</a> with the <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute set to
  a state other than the inherit state has its attribute set to the
  false state, or all its ancestors have their <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute set to
  the inherit state and the <code>Document</code> itself has <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> disabled; either
  way, the element is not editable.</p>

  </div>

  <dl class="domintro"><dt><var title="">element</var> . <code title="dom-contentEditable"><a href="#dom-contenteditable">contentEditable</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns "<code title="">true</code>", "<code title="">false</code>", or "<code title="">inherit</code>", based
    on the state of the <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code> attribute.</p>

    <p>Can be set, to change that state.</p>

    <p>Throws a <code><a href="urls.html#syntax_err">SYNTAX_ERR</a></code> exception if the new value
    isn't one of those strings.</p>

   </dd>

   <dt><var title="">element</var> . <code title="dom-isContentEditable"><a href="#dom-iscontenteditable">isContentEditable</a></code></dt>

   <dd>

    <p>Returns true if the element is editable; otherwise, returns false.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-contenteditable" title="dom-contentEditable"><code>contentEditable</code></dfn> IDL
  attribute, on getting, must return the string "<code title="">true</code>" if the content attribute is set to the true
  state, <code title="">false</code>" if the content attribute is set
  to the false state, and "<code title="">inherit</code>"
  otherwise. On setting, if the new value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a> match for the string "<code title="">inherit</code>" then the content attribute must be removed,
  if the new value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for
  the string "<code title="">true</code>" then the content attribute
  must be set to the string "<code title="">true</code>", if the new
  value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for the string
  "<code title="">false</code>" then the content attribute must be set
  to the string "<code title="">false</code>", and otherwise the
  attribute setter must raise a <code><a href="urls.html#syntax_err">SYNTAX_ERR</a></code> exception.</p>

  <p>The <dfn id="dom-iscontenteditable" title="dom-isContentEditable"><code>isContentEditable</code></dfn>
  IDL attribute, on getting, must return true if the element is
  <a href="#editable">editable</a>, and false otherwise.</p>

  <p>If an element is <a href="#editable">editable</a> and its parent element is
  not, or if an element is <a href="#editable">editable</a> and it has no parent
  element, then the element is an <dfn id="editing-host">editing host</dfn>. Editable
  elements can be nested. User agents must make editing hosts
  focusable (which typically means they enter the <a href="#attr-tabindex" title="attr-tabindex">tab order</a>). An editing host can contain
  non-editable sections, these are handled as described below. An
  editing host can contain non-editable sections that contain further
  editing hosts.</p>

  <p>When an editing host has focus, it must have a <dfn id="caret-position">caret
  position</dfn> that specifies where the current editing position
  is. It may also have a <a href="#the-selection" title="the
  selection">selection</a>.</p>

  <p class="note">How the caret and selection are represented depends
  entirely on the UA.</p>

  <!-- v2: would be useful to have a way to mark an element as
  unremovable. -->

  </div>


  <div class="impl">

  <h4 id="user-editing-actions"><span class="secno">7.7.1 </span>User editing actions</h4>

  <p>There are several actions that the user agent should allow the
  user to perform while the user is interacting with an editing
  host. How exactly each action is triggered is not defined for every
  action, but when it is not defined, suggested key bindings are
  provided to guide implementors.</p>

  <dl><dt>Move the caret</dt>

   <dd><p>User agents must allow users to move the caret to any
   position within an editing host, even into nested editable
   elements. This could be triggered as the default action of <code title="event-keydown">keydown</code> events with various key
   identifiers and as the default action of <code title="event-mousedown">mousedown</code> events.</dd>


   <dt>Change the selection</dt>

   <dd><p>User agents must allow users to change <a href="#the-selection">the
   selection</a> within an editing host, even into nested editable
   elements. User agents may prevent selections from being made in
   ways that cross from editable elements into non-editable elements
   (e.g. by making each non-editable descendant atomically selectable,
   but not allowing text selection within them). This could be
   triggered as the default action of <code title="event-keydown">keydown</code> events with various key
   identifiers and as the default action of <code title="event-mousedown">mousedown</code> events.</dd>


   <dt id="contenteditable-insertText">Insert text</dt>

   <dd><p>This action must be triggered as the default action of a
   <code title="event-textInput">textInput</code> event, and may be
   triggered by other commands as well. It must cause the user agent
   to insert the specified text (given by the event object's <code title="">data</code> attribute in the case of the <code title="event-textInput">textInput</code> event) at the caret.</p>

   <p>If the caret is positioned somewhere where <a href="content-models.html#phrasing-content">phrasing
   content</a> is not allowed (e.g. inside an empty <code><a href="grouping-content.html#the-ol-element">ol</a></code>
   element), then the user agent must not insert the text directly at
   the caret position. In such cases the behavior is UA-dependent,
   but user agents must not, in response to a request to insert text,
   generate a DOM that is less conformant than the DOM prior to the
   request.</p>

   <p>User agents should allow users to insert new paragraphs into
   elements that contains only content other than paragraphs.</p>

   <div class="example">
    <p>For example, given the markup:</p>
    <pre>&lt;section&gt;
 &lt;dl&gt;
  &lt;dt&gt; Ben &lt;/dt&gt;
  &lt;dd&gt; Goat &lt;/dd&gt;
 &lt;/dl&gt;
&lt;/section&gt;</pre>
    <p>...the user agent should allow the user to insert
    <code><a href="grouping-content.html#the-p-element">p</a></code> elements before and after the <code><a href="grouping-content.html#the-dl-element">dl</a></code>
    element, as children of the <code><a href="sections.html#the-section-element">section</a></code> element.</p>
   </div>

   </dd>


   <dt id="contenteditable-breakBlock">Break block</dt>

   <dd><p>UAs should offer a way for the user to request that the
   current paragraph be broken at the caret, e.g. as the default
   action of a <code title="event-keydown">keydown</code> event whose
   identifier is the "Enter" key and that has no modifiers set.</p>

   <p>The exact behavior is UA-dependent, but user agents must not,
   in response to a request to break a paragraph, generate a DOM that
   is less conformant than the DOM prior to the request.</dd>


   <dt id="contenteditable-br">Insert a line separator</dt>

   <dd><p>UAs should offer a way for the user to request an explicit
   line break at the caret position without breaking the paragraph,
   e.g. as the default action of a <code title="event-keydown">keydown</code> event whose identifier is the
   "Enter" key and that has a shift modifier set. Line separators are
   typically found within a poem verse or an address. To insert a line
   break, the user agent must insert a <code><a href="grouping-content.html#the-br-element">br</a></code> element.</p>

   <p>If the caret is positioned somewhere where <a href="content-models.html#phrasing-content">phrasing
   content</a> is not allowed (e.g. in an empty <code><a href="grouping-content.html#the-ol-element">ol</a></code>
   element), then the user agent must not insert the <code><a href="grouping-content.html#the-br-element">br</a></code>
   element directly at the caret position. In such cases the behavior
   is UA-dependent, but user agents must not, in response to a request
   to insert a line separator, generate a DOM that is less conformant
   than the DOM prior to the request.</dd>


   <dt id="contenteditable-delete">Delete</dt>

   <dd><p>UAs should offer a way for the user to delete text and
   elements, including non-editable descendants, e.g. as the default
   action of <code title="event-keydown">keydown</code> events whose
   identifiers are "U+0008" or "U+007F".</p>

   <p>Five edge cases in particular need to be considered carefully
   when implementing this feature: backspacing at the start of an
   element, backspacing when the caret is immediately after an
   element, forward-deleting at the end of an element,
   forward-deleting when the caret is immediately before an element,
   and deleting a <a href="#the-selection" title="the selection">selection</a> whose
   start and end points do not share a common parent node.</p>

   <p>In any case, the exact behavior is UA-dependent, but user
   agents must not, in response to a request to delete text or an
   element, generate a DOM that is less conformant than the DOM prior
   to the request.</dd>


   <dt id="contenteditable-wrapSemantic">Insert, and wrap text in,
   semantic elements</dt>

   <dd><p>UAs should offer the user the ability to mark text and
   paragraphs with semantics that HTML can express.</p>

   <p>UAs should similarly offer a way for the user to insert empty
   semantic elements to subsequently fill by entering text
   manually.</p>

   <p>UAs should also offer a way to remove those semantics from
   marked up text, and to remove empty semantic element that have been
   inserted.</p>

   <p>In response to a request from a user to mark text up in italics,
   user agents should use the <code><a href="text-level-semantics.html#the-i-element">i</a></code> element to represent the
   semantic. The <code><a href="text-level-semantics.html#the-em-element">em</a></code> element should be used only if the
   user agent is sure that the user means to indicate stress
   emphasis.</p>

   <p>In response to a request from a user to mark text up in bold,
   user agents should use the <code><a href="text-level-semantics.html#the-b-element">b</a></code> element to represent the
   semantic. The <code><a href="text-level-semantics.html#the-strong-element">strong</a></code> element should be used only if
   the user agent is sure that the user means to indicate
   importance.</p>

   <p>The exact behavior is UA-dependent, but user agents must not,
   in response to a request to wrap semantics around some text or to
   insert or remove a semantic element, generate a DOM that is less
   conformant than the DOM prior to the request.</dd>


   <dt>Select and move non-editable elements nested inside editing hosts</dt>

   <dd><p>UAs should offer a way for the user to move images and other
   non-editable parts around the content within an editing host. This
   may be done using the <a href="dnd.html#dnd">drag and drop</a> mechanism. User
   agents must not, in response to a request to move non-editable
   elements nested inside editing hosts, generate a DOM that is less
   conformant than the DOM prior to the request.</dd>


   <dt>Edit form controls nested inside editing hosts</dt>

   <dd><p>When an <a href="#editable">editable</a> form control is edited, the
   changes must be reflected in both its current value <em>and</em>
   its default value. For <code><a href="the-input-element.html#the-input-element">input</a></code> elements this means
   updating the <code title="dom-input-defaultValue"><a href="the-input-element.html#dom-input-defaultvalue">defaultValue</a></code> IDL attribute as
   well as the <code title="dom-input-value"><a href="common-input-element-attributes.html#dom-input-value">value</a></code> IDL
   attribute; for <code><a href="the-button-element.html#the-select-element">select</a></code> elements it means updating the
   <code><a href="the-button-element.html#the-option-element">option</a></code> elements' <code title="dom-option-defaultSelected"><a href="the-button-element.html#dom-option-defaultselected">defaultSelected</a></code> IDL
   attribute as well as the <code title="dom-option-selected"><a href="the-button-element.html#dom-option-selected">selected</a></code> IDL attribute; for
   <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> elements this means updating the <code title="dom-textarea-defaultValue"><a href="the-button-element.html#dom-textarea-defaultvalue">defaultValue</a></code> IDL attribute
   as well as the <code title="dom-textarea-value"><a href="the-button-element.html#dom-textarea-value">value</a></code> IDL
   attribute. (Updating the <code title="">default*</code> IDL
   attributes causes content attributes to be updated as well.)</dd>

  </dl><p>User agents may perform several commands per user request; for
  example if the user selects a block of text and hits
  <kbd><kbd>Enter</kbd></kbd>, the UA might interpret that as a
  request to delete the content of <a href="#the-selection">the selection</a> followed
  by a request to break the paragraph at that position.</p>

  <p>User agents may add <a href="dnd.html#dom-changes">DOM changes</a> entries to the
  <a href="dnd.html#undo-transaction-history">undo transaction history</a> of the <a href="#editing-host">editing
  host</a>'s <code>Document</code> object each time an action is
  triggered.</p>

  <p>All of the actions defined above, whether triggered by the user
  or programmatically (e.g. by <code title="dom-document-execCommand"><a href="dnd.html#execCommand">execCommand()</a></code> commands),
  must fire mutation events as appropriate.</p>

  </div>



  <h4 id="making-entire-documents-editable"><span class="secno">7.7.2 </span>Making entire documents editable</h4>

  <div class="impl">

  <p>Documents have a <dfn id="designMode" title="dom-document-designMode"><code>designMode</code></dfn>, which
  can be either enabled or disabled.</p>

  </div>

  <dl class="domintro"><dt><var title="">document</var> . <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns "<code title="">on</code>" if the document is editable,
    and "<code title="">off</code>" if it isn't.</p>

    <p>Can be set, to change the document's current state.</p>

   </dd>

  </dl><div class="impl">

  <p>The <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> IDL
  attribute on the <code>Document</code> object takes two values,
  "<code title="">on</code>" and "<code title="">off</code>". When it
  is set, the new value must be compared in an <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a> manner to these two values. If it matches
  the "<code title="">on</code>" value, then <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> must be enabled,
  and if it matches the "<code title="">off</code>" value, then <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> must be
  disabled. Other values must be ignored.</p>

  <p>When <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> is
  enabled, the IDL attribute must return the value "<code title="">on</code>", and when it is disabled, it must return the
  value "<code title="">off</code>".</p>

  <p>The last state set must persist until the document is destroyed
  or the state is changed. Initially, documents must have their <code title="dom-document-designMode"><a href="#designMode">designMode</a></code> disabled.</p>

  </div>



  <h3 id="spelling-and-grammar-checking"><span class="secno">7.8 </span>Spelling and grammar checking</h3>

  <div class="impl">

  <p>User agents can support the checking of spelling and grammar of
  editable text, either in form controls (such as the value of
  <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> elements), or in elements in an <a href="#editing-host">editing
  host</a> (using <code title="attr-contenteditable"><a href="#attr-contenteditable">contenteditable</a></code>).</p>

  <p>For each element, user agents must establish a <dfn id="concept-spellcheck-default" title="concept-spellcheck-default">default behavior</dfn>, either
  through defaults or through preferences expressed by the user. There
  are three possible default behaviors for each element:</p>

  <dl><dt><dfn id="concept-spellcheck-default-true" title="concept-spellcheck-default-true">true-by-default</dfn>

   <dd>The element will be checked for spelling and grammar if its
   contents are editable.

   <dt><dfn id="concept-spellcheck-default-false" title="concept-spellcheck-default-false">false-by-default</dfn>

   <dd>The element will never be checked for spelling and grammar.

   <dt><dfn id="concept-spellcheck-default-inherit" title="concept-spellcheck-default-inherit">inherit-by-default</dfn>

   <dd>The element's default behavior is the same as its parent
   element's. Elements that have no parent element cannot have this as
   their default behavior.

  </dl><hr></div>

  <p>The <dfn id="attr-spellcheck" title="attr-spellcheck"><code>spellcheck</code></dfn>
  attribute is an <a href="common-microsyntaxes.html#enumerated-attribute">enumerated attribute</a> whose keywords are
  the empty string, <code title="">true</code> and <code title="">false</code>. The empty string and the <code title="">true</code> keyword map to the <i>true</i> state. The <code title="">false</code> keyword maps to the <i>false</i> state. In
  addition, there is a third state, the <i>default</i> state, which is
  the <i>missing value default</i> (and the <i>invalid value
  default</i>).</p>

  <p>The <i>true</i> state indicates that the element is to have its
  spelling and grammar checked. The <i>default</i> state indicates
  that the element is to act according to a default behavior, possibly
  based on the parent element's own <code title="attr-spellcheck"><a href="#attr-spellcheck">spellcheck</a></code> state. The <i>false</i>
  state indicates that the element is not to be checked.</p>

  <div class="impl">

  <hr></div>

  <dl class="domintro"><dt><var title="">element</var> . <code title="dom-spellcheck"><a href="#dom-spellcheck">spellcheck</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns "<code title="">true</code>", "<code title="">false</code>", or "<code title="">default</code>", based
    on the state of the <code title="attr-spellcheck"><a href="#attr-spellcheck">spellcheck</a></code> attribute.</p>

    <p>Can be set, to change that state.</p>

    <p>Throws a <code><a href="urls.html#syntax_err">SYNTAX_ERR</a></code> exception if the new value
    isn't one of those strings.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-spellcheck" title="dom-spellcheck"><code>spellcheck</code></dfn> IDL
  attribute, on getting, must return the string "<code title="">true</code>" if the content attribute is set to the true
  state, <code title="">false</code>" if the content attribute is set
  to the false state, and "<code title="">default</code>"
  otherwise. On setting, if the new value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a> match for the string "<code title="">default</code>" then the content attribute must be removed,
  if the new value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for
  the string "<code title="">true</code>" then the content attribute
  must be set to the string "<code title="">true</code>", if the new
  value is an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for the string
  "<code title="">false</code>" then the content attribute must be set
  to the string "<code title="">false</code>", and otherwise the
  attribute setter must raise a <code><a href="urls.html#syntax_err">SYNTAX_ERR</a></code> exception.</p>

  <p class="note">The <code title="dom-spellcheck"><a href="#dom-spellcheck">spellcheck</a></code>
  IDL attribute is not affected by user preferences that override the
  <code title="attr-spellcheck"><a href="#attr-spellcheck">spellcheck</a></code> content attribute,
  and therefore might not reflect the actual spellchecking state.</p>

  <p>On setting, if the new value is true, then the element's <code title="attr-spellcheck"><a href="#attr-spellcheck">spellcheck</a></code> content attribute must be
  set to the literal string "<code title="">true</code>", otherwise it
  must be set to the literal string "<code title="">false</code>".

  <hr><p>User agents must only consider the following pieces of text as
  checkable for the purposes of this feature:</p>

  <ul><li>The value of <code><a href="the-input-element.html#the-input-element">input</a></code> elements to which the <code title="attr-input-readonly"><a href="common-input-element-attributes.html#attr-input-readonly">readonly</a></code> attribute applies,
   whose <code title="attr-input-type"><a href="the-input-element.html#attr-input-type">type</a></code> attributes are not
   in the <a href="states-of-the-type-attribute.html#password-state" title="attr-input-type-password">Password</a>
   state, and that are not <i title="concept-input-immutable"><a href="the-input-element.html#concept-input-immutable">immutable</a></i> (i.e. that do not
   have the <code title="attr-input-readonly"><a href="common-input-element-attributes.html#attr-input-readonly">readonly</a></code>
   attribute specified and that are not <a href="association-of-controls-and-forms.html#concept-fe-disabled" title="concept-fe-disabled">disabled</a>).</li>

   <li>The value of <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> elements that do not have a
   <code title="attr-textarea-readonly"><a href="the-button-element.html#attr-textarea-readonly">readonly</a></code> attribute and
   that are not <a href="association-of-controls-and-forms.html#concept-fe-disabled" title="concept-fe-disabled">disabled</a>.</li>

   <li>Text in <a href="infrastructure.html#text-node" title="text node">text nodes</a> that are
   children of <a href="#editable">editable</a> elements.</li>

   <li>Text in attributes of <a href="#editable">editable</a> elements.</li>

  </ul><p>For text that is part of a <a href="infrastructure.html#text-node">text node</a>, the element
  with which the text is associated is the element that is the
  immediate parent of the first character of the word, sentence, or
  other piece of text. For text in attributes, it is the attribute's
  element. For the values of <code><a href="the-input-element.html#the-input-element">input</a></code> and
  <code><a href="the-button-element.html#the-textarea-element">textarea</a></code> elements, it is the element itself.</p>

  <p>To determine if a word, sentence, or other piece of text in an
  applicable element (as defined above) is to have spelling- and/or
  grammar-checking enabled, the UA must use the following
  algorithm:</p>

  <ol><!-- user override --><li>If the user has disabled the checking for this text, then the
   checking is disabled.</li>

   <li>Otherwise, if the user has forced the checking for this text to
   always be enabled, then the checking is enabled.</li>

   <!-- content attribute: on, off -->

   <li>Otherwise, if the element with which the text is associated has
   a <code title="attr-spellcheck"><a href="#attr-spellcheck">spellcheck</a></code> content
   attribute, then: if that attribute is in the <i>true</i> state,
   then checking is enabled; otherwise, if that attribute is in the
   <i>false</i> state, then checking is disabled.</li>

   <!-- inherit, if there is one to inherit from -->

   <li>Otherwise, if there is an ancestor element with a <code title="attr-spellcheck"><a href="#attr-spellcheck">spellcheck</a></code> content attribute that is
   not in the <i>default</i> state, then: if the nearest such
   ancestor's <code title="attr-spellcheck"><a href="#attr-spellcheck">spellcheck</a></code> content
   attribute is in the <i>true</i> state, then checking is enabled;
   otherwise, checking is disabled.</li>

   <!-- default -->

   <li>Otherwise, if the element's <a href="#concept-spellcheck-default" title="concept-spellcheck-default">default behavior</a> is <a href="#concept-spellcheck-default-true" title="concept-spellcheck-default-true">true-by-default</a>,
   then checking is enabled.</li>

   <li>Otherwise, if the element's <a href="#concept-spellcheck-default" title="concept-spellcheck-default">default behavior</a> is <a href="#concept-spellcheck-default-false" title="concept-spellcheck-default-false">false-by-default</a>,
   then checking is disabled.</li>

   <!-- default inheritance -->

   <li>Otherwise, if the element's parent element has <em>its</em>
   checking enabled, then checking is enabled.</li>

   <li>Otherwise, checking is disabled.</li>

  </ol><p>If the checking is enabled for a word/sentence/text, the user
  agent should indicate spelling and/or grammar errors in that
  text. User agents should take into account the other semantics given
  in the document when suggesting spelling and grammar
  corrections. User agents may use the language of the element to
  determine what spelling and grammar rules to use, or may use the
  user's preferred language settings. UAs should use
  <code><a href="the-input-element.html#the-input-element">input</a></code> element attributes such as <code title="attr-input-pattern"><a href="common-input-element-attributes.html#attr-input-pattern">pattern</a></code> to ensure that the
  resulting value is valid, where possible.</p>

  <p>If checking is disabled, the user agent should not indicate
  spelling or grammar errors for that text.</p>

  <div class="example">

   <p>The element with ID "a" in the following example would be the
   one used to determine if the word "Hello" is checked for spelling
   errors. In this example, it would not be.</p>

   <pre>&lt;div contenteditable="true"&gt;
 &lt;span spellcheck="false" id="a"&gt;Hell&lt;/span&gt;&lt;em&gt;o!&lt;/em&gt;
&lt;/div&gt;</pre>

   <p>The element with ID "b" in the following example would have
   checking enabled (the leading space character in the attribute's
   value on the <code><a href="the-input-element.html#the-input-element">input</a></code> element causes the attribute to be
   ignored, so the ancestor's value is used instead, regardless of the
   default).</p>

   <pre>&lt;p spellcheck="true"&gt;
 &lt;label&gt;Name: &lt;input spellcheck=" false" id="b"&gt;&lt;/label&gt;
&lt;/p&gt;</pre>

  </div>

  </div>



  
