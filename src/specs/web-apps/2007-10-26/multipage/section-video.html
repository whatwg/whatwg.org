<!DOCTYPE HTML>


<html lang="en-GB-hixie">
 <head>
  <title>HTML 5</title>
  <link href="/style/specification" type="text/css" rel="stylesheet">
  <link href="/images/icon" rel="icon">

  <style type="text/css">
   h4 + .element { margin-top: -2.5em; padding-top: 2em; }
   h4 + p + .element { margin-top: -5em; padding-top: 4em; }
   .element { background: #EEFFEE; color: black; margin: 0 0 1em -1em; padding: 0 1em 0.25em 0.75em; border-left: solid #99FF99 0.25em; -padding: 0; /* that last decl is for IE6. Try removing it, it's hilarious! */ }
   .proposal { border: blue solid; padding: 1em; }
   table.matrix, table.matrix td { border: none; text-align: right; }
   table.matrix { margin-left: 2em; }
  </style>

 <link href="section-embedded.html#nav-bar" rel="prev" title="3.14. Embedded content"><link href="index.html#contents" rel="index" title="Table of contents"><link href="section-the-canvas.html#nav-bar" rel="next" title="3.14.11. The canvas element"></head><body class="cfc">
  <style scoped>
   * { color: gray ! important; background: none ! important; border-color: silver ! important; }
   img, object, iframe { filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); -webkit-filter: grayscale(100%); }
   .obsolete { border: double thick red ! important; background: yellow ! important; margin: 4em auto 0 auto; max-width: 50em; width: 70%; text-align: center; position: fixed;  z-index: 10000; top: 0; left: 0; right: 0; }
   .obsolete a { color: blue ! important; }
   .obsolete p { font: 900 2em sans-serif; color: red ! important; margin: 1em 1.5em ! important; }
  </style>
  <div class=obsolete>
   <p>This is a snapshot of an early working draft and has therefore
   been superseded by the <a href="http://whatwg.org/html">HTML
   standard</a>.</p>
   <p>This document will not be further updated.</p>
  </div>
<div class="head">
   <p><a href="http://www.whatwg.org/" class="logo" rel="home"><img src="/images/logo" alt="WHATWG"></a></p>

   <h1 id="html-5">HTML 5</h1>

   <h2 id="working" class="no-num no-toc">Call For Comments — 27 October 2007</h2></div><nav id="nav-bar"><a href="section-embedded.html#nav-bar">&lt; 3.14. Embedded content</a> – <a href="index.html#contents">Table of contents</a> – <a href="section-the-canvas.html#nav-bar">3.14.11. The canvas element &gt;</a></nav><h4 id="video"><span class="secno">3.14.7. </span>The <dfn id="video1"><code>video</code></dfn> element</h4>

  <p><a href="section-documents0.html#semi-transparent">Semi-transparent</a> <a href="section-documents0.html#strictly" title="Strictly inline-level content">strictly inline-level</a> <a href="section-documents0.html#embedded0">embedded content</a>.

  </p><dl class="element">
   <dt>Contexts in which this element may be used:

   </dt><dd>As the only <a href="section-documents0.html#embedded0">embedded content</a> child of a
    <code><a href="section-embedded.html#figure">figure</a></code> element.

   </dd><dd>Where <a href="section-documents0.html#strictly">strictly inline-level content</a> is
    allowed.

   </dd><dt>Content model:

   </dt><dd>If the element has a <code title="attr-media-src"><a href="#src5">src</a></code> attribute: <a href="section-documents0.html#transparent0">transparent</a>.

   </dd><dd>If the element does not have a <code title="attr-media-src"><a href="#src5">src</a></code> attribute: one or more <code><a href="#source">source</a></code> elements, then, <a href="section-documents0.html#transparent0">transparent</a>.

   </dd><dt>Element-specific attributes:

   </dt><dd><code title="attr-media-src"><a href="#src5">src</a></code>

   </dd><dd><code title="attr-video-poster"><a href="#poster">poster</a></code>

   </dd><dd><code title="attr-media-autoplay"><a href="#autoplay">autoplay</a></code>

   </dd><dd><code title="attr-media-start"><a href="#start2">start</a></code>

   </dd><dd><code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>

   </dd><dd><code title="attr-media-loopend"><a href="#loopend">loopend</a></code>

   </dd><dd><code title="attr-media-end"><a href="#end">end</a></code>

   </dd><dd><code title="attr-media-playcount"><a href="#playcount">playcount</a></code>

   </dd><dd><code title="attr-media-controls"><a href="#controls">controls</a></code>

   </dd><dd><code title="attr-dim-width"><a href="section-the-canvas.html#width3">width</a></code>

   </dd><dd><code title="attr-dim-height"><a href="section-the-canvas.html#height3">height</a></code>

   </dd><dt>DOM interface:

   </dt><dd>
    <pre class="idl">interface <dfn id="htmlvideoelement">HTMLVideoElement</dfn> : <a href="#htmlmediaelement">HTMLMediaElement</a> {
           attribute long <a href="section-the-canvas.html#width4" title="dom-dim-width">width</a>;
           attribute long <a href="section-the-canvas.html#height4" title="dom-dim-height">height</a>;
  readonly attribute unsigned long <a href="#videowidth" title="dom-video-videoWidth">videoWidth</a>;
  readonly attribute unsigned long <a href="#videoheight" title="dom-video-videoHeight">videoHeight</a>;
           attribute DOMString <a href="#poster0" title="dom-video-poster">poster</a>;
};</pre>
  </dd></dl>

  <p>A <code><a href="#video1">video</a></code> element represents a video or
   movie.

  </p><p>Content may be provided inside the <code><a href="#video1">video</a></code> element. User agents should not show this
   fallback content to the user; it is intended for older Web browsers which
   do not support <code><a href="#video1">video</a></code>, so that legacy
   video plugins can be tried, or to show text to the users of these older
   browser informing them of how to access the video contents.

  </p><p class="note">In particular, the fallback content isn't intended to address
   accessibility concerns. To make video content accessible to the blind,
   deaf, and those with other physical or cognitive disabilities, authors are
   expected to provide alternative media streams and/or to embed
   accessibility aids (such as caption or subtitle tracks) into their media
   streams.

  </p><p>The <code><a href="#video1">video</a></code> element is a <a href="#media5">media element</a> whose <a href="#media7">media data</a> is
   ostensibly video data, possibly with associated audio data.

  </p><p>The <code title="attr-media-src"><a href="#src5">src</a></code>, <code title="attr-media-autoplay"><a href="#autoplay">autoplay</a></code>, <code title="attr-media-start"><a href="#start2">start</a></code>, <code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>,
   <code title="attr-media-loopend"><a href="#loopend">loopend</a></code>,
   <code title="attr-media-end"><a href="#end">end</a></code>, <code title="attr-media-playcount"><a href="#playcount">playcount</a></code>, and
   <code title="attr-media-controls"><a href="#controls">controls</a></code>
   attributes are <a href="#media6" title="media element attributes">the
   attributes common to all media elements</a>.

  </p><p>The <code><a href="#video1">video</a></code> element supports <a href="section-the-canvas.html#dimension0">dimension attributes</a>.

  </p><p>The <dfn id="poster" title="attr-video-poster"><code>poster</code></dfn>
   attribute gives the address of an image file that the user agent can show
   while no video data is available. The attribute, if present, must contain
   a URI (or IRI).

  </p><p>The <dfn id="poster0" title="dom-video-poster"><code>poster</code></dfn> DOM
   attribute must reflect the <code title="attr-video-poster"><a href="#poster">poster</a></code> content attribute.

  </p><p>The <dfn id="videowidth" title="dom-video-videoWidth"><code>videoWidth</code></dfn> DOM attribute
   must return the native width of the video in CSS pixels. The <dfn id="videoheight" title="dom-video-videoHeight"><code>videoHeight</code></dfn>
   DOM attribute must return the native height of the video in CSS pixels. In
   the absence of resolution information defining the mapping of pixels in
   the video to physical dimensions, user agents may assume that one pixel in
   the video corresponds to one CSS pixel. If no video data is available,
   then the attributes must return 0.

  </p><p>When no video data is available (the element's <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute is either <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code>, <code title="dom-media-LOADING"><a href="#loading0">LOADING</a></code>, or <code title="dom-media-LOADED_METADATA"><a href="#loadedmetadata">LOADED_METADATA</a></code>), <code><a href="#video1">video</a></code> elements represent either the image given
   by the <code title="attr-video-poster"><a href="#poster">poster</a></code>
   attribute, or nothing.

  </p><p>When a <code><a href="#video1">video</a></code> element is <a href="#actively">actively playing</a>, it represents the frame of video at
   the continuously increasing <a href="#current" title="current playback
   position">&quot;current&quot; position</a>. When the <a href="#current">current
   playback position</a> changes such that the last frame rendered is no
   longer the frame corresponding to the <a href="#current">current playback
   position</a> in the video, the new frame must be rendered. Similarly, any
   audio associated with the video must, if played, be played synchronised
   with the <a href="#current">current playback position</a>, at the
   specified <a href="#volume" title="dom-media-volume">volume</a> with the
   specified <a href="#muted" title="dom-media-muted">mute state</a>.

  </p><p>When a <code><a href="#video1">video</a></code> element is <a href="#paused" title="dom-media-paused">paused</a>, the element represents
   the frame of video corresponding to the <a href="#current" title="current
   playback position">current playback position</a>, or, if that is not
   available yet (e.g. because the video is seeking or buffering), the last
   rendered frame of video.

  </p><p>When a <code><a href="#video1">video</a></code> element is neither <a href="#actively">actively playing</a> nor <a href="#paused" title="dom-media-paused">paused</a> (e.g. when seeking or stalled), the
   element represents the last frame of the video to have been rendered.

  </p><p class="note">Which frame in a video stream corresponds to a particular
   playback position is defined by the video stream's format.

  </p><p>Video content should be rendered inside the element's playback area such
   that the video content is shown centered in the playback area at the
   largest possible size that fits completely within it, with the video
   content's aspect ratio being preserved. Thus, if the aspect ratio of the
   playback area does not match the aspect ratio of the video, the video will
   be shown letterboxed. Areas of the element's playback area that do not
   contain the video represent nothing.

  </p><p>In addition to the above, the user agent may provide messages to the
   user (such as &quot;buffering&quot;, &quot;no video loaded&quot;, &quot;error&quot;, or more detailed
   information) by overlaying text or icons on the video or other areas of
   the element's playback area, or in another appropriate manner.

  </p><p>User agents that cannot render the video may instead make the element
   represent a link to an external video playback utility or to the video
   data itself.</p>
  <!-- XXX
   make it an interactive element
   default activation behaviour is to do the play() if paused, pause()
   otherwise
  -->

  <p>User agents should provide controls to enable or disable the display of
   closed captions associated with the video stream, though such features
   should, again, not interfere with the page's normal rendering.

  </p><p>User agents may allow users to view the video content in manners more
   suitable to the user (e.g. full-screen or in an independent resizable
   window). As for the other user interface features, controls to enable this
   should not interfere with the page's normal rendering unless the user
   agent is <a href="#expose" title="expose a user interface to the
   user">exposing a user interface</a>. In such an independent context,
   however, user agents may make full user interfaces visible, with, e.g.,
   play, pause, seeking, and volume controls, even if the <code title="attr-media-controls"><a href="#controls">controls</a></code>
   attribute is absent.

  </p><p>User agents may allow video playback to affect system features that
   could interfere with the user's experience; for example, user agents could
   disable screensavers while video playback is in progress.</p>
  <!-- XXX rendering section should mention that resizing a video
  should in no way interrupt playback -->

  <h5 id="video0"><span class="secno">3.14.7.1. </span>Video and audio codecs for
   <code><a href="#video1">video</a></code> elements</h5>

  <p>User agents may support any video and audio codecs and container
   formats.

  </p><p>User agents should support Ogg Theora video and Ogg Vorbis audio, as
   well as the Ogg container format. <a href="#refsOggTheora">[THEORA]</a> <a href="#refsOggVorbis">[VORBIS]</a> <a href="#refsOgg">[OGG]</a></p>
  <!-- (it's not a MUST because some vendors may have legal reasons
  why they can't or won't support it, and there's no point making them
  non-conforming when they have no choice in the matter) -->
  <!-- XXX mention that this spec doesn't require native support or
  plugin support, either is fine -->

  <p class="note">Certain user agents might support no codecs at all, e.g. text
   browsers running over SSH connections.

  </p><h4 id="audio"><span class="secno">3.14.8. </span>The <dfn id="audio1"><code>audio</code></dfn> element</h4>

  <p><a href="section-documents0.html#semi-transparent">Semi-transparent</a> <a href="section-documents0.html#strictly" title="Strictly inline-level content">strictly inline-level</a> <a href="section-documents0.html#embedded0">embedded content</a>.

  </p><dl class="element">
   <dt>Contexts in which this element may be used:

   </dt><dd>As the only <a href="section-documents0.html#embedded0">embedded content</a> child of a
    <code><a href="section-embedded.html#figure">figure</a></code> element.

   </dd><dd>Where <a href="section-documents0.html#strictly">strictly inline-level content</a> is
    allowed.

   </dd><dt>Content model:

   </dt><dd>If the element has a <code title="attr-media-src"><a href="#src5">src</a></code> attribute: <a href="section-documents0.html#transparent0">transparent</a>.

   </dd><dd>If the element does not have a <code title="attr-media-src"><a href="#src5">src</a></code> attribute: one or more <code><a href="#source">source</a></code> elements, then, <a href="section-documents0.html#transparent0">transparent</a>.

   </dd><dt>Element-specific attributes:

   </dt><dd><code title="attr-media-src"><a href="#src5">src</a></code>

   </dd><dd><code title="attr-media-autoplay"><a href="#autoplay">autoplay</a></code>

   </dd><dd><code title="attr-media-start"><a href="#start2">start</a></code>

   </dd><dd><code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>

   </dd><dd><code title="attr-media-loopend"><a href="#loopend">loopend</a></code>

   </dd><dd><code title="attr-media-end"><a href="#end">end</a></code>

   </dd><dd><code title="attr-media-playcount"><a href="#playcount">playcount</a></code>

   </dd><dd><code title="attr-media-controls"><a href="#controls">controls</a></code>

   </dd><dt>DOM interface:

   </dt><dd>
    <pre class="idl">interface <dfn id="htmlaudioelement">HTMLAudioElement</dfn> : <a href="#htmlmediaelement">HTMLMediaElement</a> {
  // no members
};</pre>
  </dd></dl>

  <p>An <code><a href="#audio1">audio</a></code> element represents a sound
   or audio stream.

  </p><p>Content may be provided inside the <code><a href="#audio1">audio</a></code> element. User agents should not show this
   fallback content to the user; it is intended for older Web browsers which
   do not support <code><a href="#audio1">audio</a></code>, so that legacy
   audio plugins can be tried, or to show text to the users of these older
   browser informing them of how to access the audio contents.

  </p><p class="note">In particular, the fallback content isn't intended to address
   accessibility concerns. To make audio content accessible to the deaf or to
   those with other physical or cognitive disabilities, authors are expected
   to provide alternative media streams and/or to embed accessibility aids
   (such as transcriptions) into their media streams.

  </p><p>The <code><a href="#audio1">audio</a></code> element is a <a href="#media5">media element</a> whose <a href="#media7">media data</a> is
   ostensibly audio data.

  </p><p>The <code title="attr-media-src"><a href="#src5">src</a></code>, <code title="attr-media-autoplay"><a href="#autoplay">autoplay</a></code>, <code title="attr-media-start"><a href="#start2">start</a></code>, <code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>,
   <code title="attr-media-loopend"><a href="#loopend">loopend</a></code>,
   <code title="attr-media-end"><a href="#end">end</a></code>, <code title="attr-media-playcount"><a href="#playcount">playcount</a></code>, and
   <code title="attr-media-controls"><a href="#controls">controls</a></code>
   attributes are <a href="#media6" title="media element attributes">the
   attributes common to all media elements</a>.

  </p><p>When an <code><a href="#audio1">audio</a></code> element is <a href="#actively">actively playing</a>, it must have its audio data played
   synchronised with the <a href="#current">current playback position</a>, at
   the specified <a href="#volume" title="dom-media-volume">volume</a> with the
   specified <a href="#muted" title="dom-media-muted">mute state</a>.

  </p><p>When an <code><a href="#audio1">audio</a></code> element is not <a href="#actively">actively playing</a>, audio must not play for the
   element.

  </p><h5 id="audio0"><span class="secno">3.14.8.1. </span>Audio codecs for <code><a href="#audio1">audio</a></code> elements</h5>

  <p>User agents may support any audio codecs and container formats.

  </p><p>User agents must support the WAVE container format with audio encoded
   using the PCM format. <!-- XXX references? #refs --></p>
  <!-- XXX mention that this spec doesn't require native support or
  plugin support, either is fine -->

  <h4 id="media"><span class="secno">3.14.9. </span>Media elements</h4>

  <p><dfn id="media5" title="media element">Media elements</dfn> implement the
   following interface:

  </p><pre class="idl">interface <dfn id="htmlmediaelement">HTMLMediaElement</dfn> : <a href="section-elements.html#htmlelement">HTMLElement</a> {

  // error state
  readonly attribute <a href="#mediaerror">MediaError</a> <a href="#error0" title="dom-media-error">error</a>;

  // network state
           attribute DOMString <a href="#src6" title="dom-media-src">src</a>;
  readonly attribute DOMString <a href="#currentsrc" title="dom-media-currentSrc">currentSrc</a>;
  const unsigned short <a href="#empty" title="dom-media-EMPTY">EMPTY</a> = 0;
  const unsigned short <a href="#loading0" title="dom-media-LOADING">LOADING</a> = 1;
  const unsigned short <a href="#loadedmetadata" title="dom-media-LOADED_METADATA">LOADED_METADATA</a> = 2;
  const unsigned short <a href="#loadedfirstframe" title="dom-media-LOADED_FIRST_FRAME">LOADED_FIRST_FRAME</a> = 3;
  const unsigned short <a href="#loaded" title="dom-media-LOADED">LOADED</a> = 4;
  readonly attribute unsigned short <a href="#networkstate" title="dom-media-networkState">networkState</a>;
  readonly attribute float <a href="#bufferingrate" title="dom-media-bufferingRate">bufferingRate</a>;
  readonly attribute <a href="#timeranges">TimeRanges</a> <a href="#buffered" title="dom-media-buffered">buffered</a>;
  void <a href="#load" title="dom-media-load">load</a>();

  // ready state
  const unsigned short <a href="#dataunavailable" title="dom-media-DATA_UNAVAILABLE">DATA_UNAVAILABLE</a> = 0;
  const unsigned short <a href="#canshowcurrentframe" title="dom-media-CAN_SHOW_CURRENT_FRAME">CAN_SHOW_CURRENT_FRAME</a> = 1;
  const unsigned short <a href="#canplay" title="dom-media-CAN_PLAY">CAN_PLAY</a> = 2;
  const unsigned short <a href="#canplaythrough" title="dom-media-CAN_PLAY_THROUGH">CAN_PLAY_THROUGH</a> = 3;
  readonly attribute unsigned short <a href="#readystate" title="dom-media-readyState">readyState</a>;
  readonly attribute boolean <a href="#seeking0" title="dom-media-seeking">seeking</a>;

  // playback state
           attribute float <a href="#currenttime" title="dom-media-currentTime">currentTime</a>;
  readonly attribute float <a href="#duration" title="dom-media-duration">duration</a>;
  readonly attribute boolean <a href="#paused" title="dom-media-paused">paused</a>;
           attribute float <a href="#defaultplaybackrate" title="dom-media-defaultPlaybackRate">defaultPlaybackRate</a>;
           attribute float <a href="#playbackrate" title="dom-media-playbackRate">playbackRate</a>;
  readonly attribute <a href="#timeranges">TimeRanges</a> <a href="#played" title="dom-media-played">played</a>;
  readonly attribute <a href="#timeranges">TimeRanges</a> <a href="#seekable" title="dom-media-seekable">seekable</a>;
  readonly attribute boolean <a href="#ended0" title="dom-media-ended">ended</a>;
           attribute boolean <a href="#autoplay0" title="dom-media-autoplay">autoplay</a>;
  void <a href="#play" title="dom-media-play">play</a>();
  void <a href="#pause0" title="dom-media-pause">pause</a>();

  // looping
           attribute float <a href="#start3" title="dom-media-start">start</a>;
           attribute float <a href="#end0" title="dom-media-end">end</a>;
           attribute float <a href="#loopstart0" title="dom-media-loopStart">loopStart</a>;
           attribute float <a href="#loopend0" title="dom-media-loopEnd">loopEnd</a>;
           attribute unsigned long <a href="#playcount0" title="dom-media-playCount">playCount</a>;
           attribute unsigned long <a href="#currentloop" title="dom-media-currentLoop">currentLoop</a>;

  // cue ranges
  void <a href="#addcuerange" title="dom-media-addCueRange">addCueRange</a>(in DOMString className, in float start, in float end, in boolean pauseOnExit, in <a href="#voidcallback">VoidCallback</a> enterCallback, in <a href="#voidcallback">VoidCallback</a> exitCallback);
  void <span title="dom-media-removeCueRange">removeCueRanges</span>(in DOMString className);

  // controls
           attribute boolean <a href="#controls0" title="dom-media-controls">controls</a>;
           attribute float <a href="#volume" title="dom-media-volume">volume</a>;
           attribute boolean <a href="#muted" title="dom-media-muted">muted</a>;
};</pre>

  <p>The <dfn id="media6">media element attributes</dfn>, <code title="attr-media-src"><a href="#src5">src</a></code>, <code title="attr-media-autoplay"><a href="#autoplay">autoplay</a></code>, <code title="attr-media-start"><a href="#start2">start</a></code>, <code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>,
   <code title="attr-media-loopend"><a href="#loopend">loopend</a></code>,
   <code title="attr-media-end"><a href="#end">end</a></code>, <code title="attr-media-playcount"><a href="#playcount">playcount</a></code>, and
   <code title="attr-media-controls"><a href="#controls">controls</a></code>,
   apply to all <a href="#media5" title="media element">media elements</a>.
   They are defined in this section.</p>
  <!-- XXX v3 features:
    * frame forward / backwards / step(n) while paused
    * hasAudio, hasVideo, hasCaptions, etc
    * per-frame control: get current frame; set current frame
    * queue of content
      - pause current stream and insert content at front of queue to play immediately
      - pre-download another stream
      - add stream(s) to play at end of current stream
      - pause playback upon reaching a certain time
      - playlists, with the ability to get metadata out of them (e.g. xspf)
    * control over closed captions:
      - enable, disable, select language
      - event that sends caption text to script
    * get byte ranges as well as time ranges for buffered data
    * in-band metadata and cue points to allow:
      - Chapter markers that synchronize to playback (without having to poll
        the playhead position)
      - Annotations on video content (i.e., pop-up video)
      - General custom metadata store (ratings, etc.)
    * notification of chapter labels changing on the fly:
      - onchapterlabelupdate, which has a time and a label
    * cue points that trigger at fixed intervals, so that
      e.g. animation can be synced with the video
    * general meta data, implemented as getters (don't expose the whole thing)
      - getMetadata(key: string, language: string) => HTMLImageElement or string
      - onmetadatachanged (no context info)
    * video: changing the playback aspect ratio 
    * video: applying CSS filters 
    * infinite looping 
  -->

  <p><a href="#media5" title="media element">Media elements</a> are used to
   present audio data, or video and audio data, to the user. This is referred
   to as <dfn id="media7">media data</dfn> in this section, since this section
   applies equally to <a href="#media5" title="media element">media
   elements</a> for audio or for video. The term <dfn id="media8">media
   resource</dfn> is used to refer to the complete set of media data, e.g.
   the complete video file, or complete audio file.

  </p><h5 id="error"><span class="secno">3.14.9.1. </span>Error codes</h5>

  <p>All <a href="#media5" title="media element">media elements</a> have an
   associated error status, which records the last error the element
   encountered since the <code title="dom-media-load"><a href="#load">load()</a></code> method was last invoked. The <dfn id="error0" title="dom-media-error"><code>error</code></dfn> attribute, on getting, must
   return the <code><a href="#mediaerror">MediaError</a></code> object
   created for this last error, or null if there has not been an error.

  </p><pre class="idl">interface <dfn id="mediaerror">MediaError</dfn> {
  const unsigned short <a href="#mediaerraborted" title="dom-MediaError-MEDIA_ERR_ABORTED">MEDIA_ERR_ABORTED</a> = 1;
  const unsigned short <a href="#mediaerrnetwork" title="dom-MediaError-MEDIA_ERR_NETWORK">MEDIA_ERR_NETWORK</a> = 2;
  const unsigned short <a href="#mediaerrdecode" title="dom-MediaError-MEDIA_ERR_DECODE">MEDIA_ERR_DECODE</a> = 3;
  readonly attribute unsigned short <a href="#code0" title="dom-MediaError-code">code</a>;
};</pre>

  <p>The <dfn id="code0" title="dom-MediaError-code"><code>code</code></dfn>
   attribute of a <code><a href="#mediaerror">MediaError</a></code> object
   must return the code for the error, which must be one of the following:

  </p><dl>
   <dt><dfn id="mediaerraborted" title="dom-MediaError-MEDIA_ERR_ABORTED"><code>MEDIA_ERR_ABORTED</code></dfn>
    (numeric value 1)

   </dt><dd>The download of the <a href="#media8">media resource</a> was aborted
    by the user agent at the user's request.

   </dd><dt><dfn id="mediaerrnetwork" title="dom-MediaError-MEDIA_ERR_NETWORK"><code>MEDIA_ERR_NETWORK</code></dfn>
    (numeric value 2)

   </dt><dd>A network error of some description caused the user agent to stop
    downloading the <a href="#media8">media resource</a>.

   </dd><dt><dfn id="mediaerrdecode" title="dom-MediaError-MEDIA_ERR_DECODE"><code>MEDIA_ERR_DECODE</code></dfn>
    (numeric value 3)

   </dt><dd>An error of some description occurred while decoding the <a href="#media8">media resource</a>.
  </dd></dl>

  <h5 id="location"><span class="secno">3.14.9.2. </span>Location of the media
   resource</h5>

  <p>The <dfn id="src5" title="attr-media-src"><code>src</code></dfn> content
   attribute on <a href="#media5" title="media element">media elements</a>
   gives the address of the media resource (video, audio) to show. The
   attribute, if present, must contain a URI (or IRI).

  </p><p>If the <code title="attr-media-src"><a href="#src5">src</a></code>
   attribute of a <a href="#media5">media element</a> that is already in a
   document and whose <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is in the <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> state is added,
   changed, or removed, the user agent must implicitly invoke the <code title="dom-media-load"><a href="#load">load()</a></code> method on the <a href="#media5">media element</a> as soon as all other scripts have
   finished executing. Any exceptions raised must be ignored.

  </p><p class="note">If a <code title="attr-media-src"><a href="#src5">src</a></code> attribute is specified, the resource it
   specifies is the <a href="#media8">media resource</a> that will be used.
   Otherwise, the resource specified by the first suitable <code><a href="#source">source</a></code> element child of the <a href="#media5">media element</a> is the one used.

  </p><p>The <dfn id="src6" title="dom-media-src"><code>src</code></dfn> DOM
   attribute on <a href="#media5" title="media element">media elements</a>
   must <a href="section-elements.html#reflect">reflect</a> the content attribute of the same
   name.

  </p><p>To <dfn id="pick-a">pick a media resource</dfn> for a <a href="#media5">media element</a>, a user agent must use the following
   steps:

  </p><ol>
   <li>
    <p>If the <a href="#media5">media element</a> has a <code title="attr-media-src"><a href="#src5">src</a></code>, then the address
     given in that attribute is the address of the <a href="#media8">media
     resource</a>; jump to the last step.

   </p></li><li>
    <p>Otherwise, let <var title="">candidate</var> be the first <code><a href="#source">source</a></code> element child in the <a href="#media5">media element</a>, or null if there is no such child.

   </p></li><li>
    <p>If either:</p>

    <ul>
     <li><var title="">candidate</var> is null, or

     </li><li>the <var title="">candidate</var> element has no <code title="attr-source-src"><a href="#src7">src</a></code> attribute, or

     </li><li>the <var title="">candidate</var> element has a <code title="attr-source-type"><a href="#type8">type</a></code> attribute and
      that attribute's value, when parsed as a MIME type, does not represent
      a type that the user agent can render (including any codecs described
      by the <code title="">codec</code> parameter), or <a href="#refsRFC2046">[RFC2046]</a> <a href="#refsRFC4281">[RFC4281]</a>

     </li><li>the <var title="">candidate</var> element has a <code title="attr-source-media"><a href="#media9">media</a></code> attribute
      and that attribute's value, when processed according to the rules for
      media queries, does not match the current environment, <a href="#refsMQ">[MQ]</a>
    </li></ul>

    <p>...then the <var title="">candidate</var> is not suitable; go to the
     next step.</p>

    <p>Otherwise, the address given in that <var title="">candidate</var>
     element's <code title="attr-source-src"><a href="#src7">src</a></code>
     attribute is the address of the <a href="#media8">media resource</a>;
     jump to the last step.</p>

   </li><li>
    <p>Let <var title="">candidate</var> be the next <code><a href="#source">source</a></code> element child in the <a href="#media5">media element</a>, or null if there are no more such
     children.

   </p></li><li>
    <p>If <var title="">candidate</var> is not null, return to step 3.

   </p></li><li>
    <p>There is no <a href="#media8">media resource</a>. Abort these steps.

   </p></li><li>
    <p>Let the address of the <dfn id="chosen">chosen media resource</dfn> be
     the one that was found before jumping to this step.
  </p></li></ol>

  <p class="note">A <code><a href="#source">source</a></code> element with no
   <code title="attr-source-src"><a href="#src7">src</a></code> attribute is
   assumed to be the last <code><a href="#source">source</a></code> element
   — any <code><a href="#source">source</a></code> elements after it
   are ignored (and are invalid).

  </p><p>The <dfn id="currentsrc" title="dom-media-currentSrc"><code>currentSrc</code></dfn> DOM attribute
   must return the empty string if the <a href="#media5">media element</a>'s
   <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> has the value <a href="#empty" title="dom-media-EMPTY">EMPTY</a>, and the absolute URL of the
   <a href="#chosen">chosen media resource</a> otherwise.

  </p><h5 id="network0"><span class="secno">3.14.9.3. </span>Network states</h5>

  <p>As <a href="#media5" title="media element">media elements</a> interact
   with the network, they go through several states. The <dfn id="networkstate" title="dom-media-networkState"><code>networkState</code></dfn> attribute, on
   getting, must return the current network state of the element, which must
   be one of the following values:

  </p><dl>
   <dt><dfn id="empty" title="dom-media-EMPTY"><code>EMPTY</code></dfn> (numeric
    value 0)

   </dt><dd>The element has not yet been initialised. All attributes are in their
    initial states.

   </dd><dt><dfn id="loading0" title="dom-media-LOADING"><code>LOADING</code></dfn>
    (numeric value 1)

   </dt><dd>The element has <a href="#pick-a" title="pick a media resource">picked
    a media resource</a> (the <a href="#chosen">chosen media resource</a> is
    available from the <code title="dom-media-currentSrc"><a href="#currentsrc">currentSrc</a></code> attribute), but none of the
    metadata has yet been obtained and therefore all the other attributes are
    still in their initial states.

   </dd><dt><dfn id="loadedmetadata" title="dom-media-LOADED_METADATA"><code>LOADED_METADATA</code></dfn>
    (numeric value 2)

   </dt><dd>Enough of the resource has been obtained that the metadata attributes
    are initialized (e.g. the length is known). The API will no longer raise
    exceptions when used.

   </dd><dt><dfn id="loadedfirstframe" title="dom-media-LOADED_FIRST_FRAME"><code>LOADED_FIRST_FRAME</code></dfn>
    (numeric value 3)

   </dt><dd>Actual <a href="#media7">media data</a> has been obtained. In the case
    of video, this specifically means that a frame of video is available and
    can be shown.

   </dd><dt><dfn id="loaded" title="dom-media-LOADED"><code>LOADED</code></dfn>
    (numeric value 4)

   </dt><dd>The entire <a href="#media8">media resource</a> has been obtained and
    is available to the user agent locally. Network connectivity could be
    lost without affecting the media playback.
  </dd></dl>

  <p>The algorithm for the <code title="dom-media-load"><a href="#load">load()</a></code> method defined below describes exactly when
   the <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute changes value.

  </p><h5 id="loading"><span class="secno">3.14.9.4. </span>Loading the media
   resource</h5>

  <p>All <a href="#media5" title="media element">media elements</a> have a
   <dfn id="begun">begun flag</dfn>, which must begin in the false state, a
   <dfn id="loaded-first-frame">loaded-first-frame flag</dfn>, which must begin
   in the false state, and an <dfn id="autoplaying">autoplaying flag</dfn>,
   which must begin in the true state.

  </p><p>When the <dfn id="load" title="dom-media-load"><code>load()</code></dfn>
   method on a <a href="#media5">media element</a> is invoked, the user agent
   must run the following steps. Note that this algorithm might get aborted,
   e.g. if the <code title="dom-media-load"><a href="#load">load()</a></code>
   method itself is invoked again.

  </p><ol>
   <li>
    <p>Any already-running instance of this algorithm for this element must
     be aborted. If those method calls have not yet returned, they must
     finish the step they are on, and then immediately return.

   </p></li><li>
    <p>If the element's <a href="#begun">begun flag</a> is true, then the <a href="#begun">begun flag</a> must be set to false, the <code title="dom-media-error"><a href="#error0">error</a></code> attribute must
     be set to a new <code><a href="#mediaerror">MediaError</a></code> object
     whose <code title="dom-MediaError-code"><a href="#code0">code</a></code>
     attribute is set to <code title="dom-MediaError-MEDIA_ERR_ABORTED"><a href="#mediaerraborted">MEDIA_ERR_ABORTED</a></code>, and the user agent
     must synchronously <a href="section-scripting.html#firing6">fire a progress event</a> called
     <code title="event-abort"><a href="#abort">abort</a></code> at the <a href="#media5">media element</a>.

   </p></li><li>
    <p>The <code title="dom-media-error"><a href="#error0">error</a></code>
     attribute must be set to null, the <a href="#loaded-first-frame">loaded-first-frame flag</a> must be set to
     false, and the <a href="#autoplaying">autoplaying flag</a> must be set
     to true.

   </p></li><li>
    <p>The <code title="dom-media-playbackRate"><a href="#playbackrate">playbackRate</a></code> attribute must be set to
     the value of the <code title="dom-media-defaultPlaybackRate"><a href="#defaultplaybackrate">defaultPlaybackRate</a></code> attribute.

   </p></li><li>
    <p>If the <a href="#media5">media element</a>'s <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is not set to <a href="#empty" title="dom-media-EMPTY">EMPTY</a>, then the following
     substeps must be followed:

    </p><ol><!--<li>Let <var title="">events</var> be a list of event names,
     initially empty.</li>-->

     <li>The <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be set to
      <a href="#empty" title="dom-media-EMPTY">EMPTY</a><!--, and the user agent must
     add <code title="event-emptied">emptied</code> to the <var
     title="">events</var> list-->.

     </li><li>If <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> is not set to <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code>, it must be set to
      that state<!-- and the user agent must add <code
     title="event-dataunavailable">dataunavailable</code> to the
     <var title="">events</var> list-->.

     </li><li>If the <code title="dom-media-paused"><a href="#paused">paused</a></code> attribute is false, it must be set to
      true<!--, and the user agent must add
     <code title="event-pause">pause</code> to the <var
     title="">events</var> list-->.

     </li><li>If <code title="dom-media-seeking"><a href="#seeking0">seeking</a></code> is true, it must be set to false.

     </li><li>The <a href="#current">current playback position</a> must be set to
      0.

     </li><li>The <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> DOM attribute must be set to
      0.</li>
     <!--<li>The user agent must synchronously <span>fire a simple
     event</span> at the <span>media element</span> for each event
     name in <var title="">events</var>, in the same order that they
     were added to that list.</li>-->

     <li>The user agent must synchronously <a href="section-scripting.html#firing2">fire a simple
      event</a> called <code title="event-emptied"><a href="#emptied">emptied</a></code> at the <a href="#media5">media
      element</a>.
    </li></ol>

   </li><li>
    <p>The user agent must <a href="#pick-a">pick a media resource</a> for
     the <a href="#media5">media element</a>. If that fails, the method must
     raise an <code>INVALID_STATE_ERR</code> exception, and abort these
     steps.

   </p></li><li>
    <p>The <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be set to <a href="#loading0" title="dom-media-LOADING">LOADING</a>.

   </p></li><li>
    <p class="note">The <code title="dom-media-currentSrc"><a href="#currentsrc">currentSrc</a></code> attribute starts returning the
     new value.

   </p></li><li>
    <p>The user agent must then set the <a href="#begun">begun flag</a> to
     true and <a href="section-scripting.html#firing6">fire a progress event</a> called
     <code>begin</code> at the <a href="#media5">media element</a>.

   </p></li><li>
    <p>The method must return, but these steps must continue.

   </p></li><li>
    <p class="note">Playback of any previously playing <a href="#media8">media
     resource</a> for this element stops.

   </p></li><li>
    <p>If a download is in progress for the <a href="#media5">media
     element</a>, the user agent should stop the download.

   </p></li><li>
    <p>The user agent must then begin to download the <a href="#chosen">chosen media resource</a>. The rate of the download may
     be throttled, however, in response to user preferences (including
     throttling it to zero until the user indicates that the download can
     start), or to balance the download with other connections sharing the
     same bandwidth.

   </p></li><li>
    <p>While the download is progressing, the user agent must <a href="section-scripting.html#firing6">fire a progress event</a> called <code title="event-progress"><a href="#progress0">progress</a></code> at the
     element every 350ms (±200ms) or for every byte received, whichever
     is <em>least</em> frequent.</p>

    <p>If at any point the user agent has received no data for more than
     about three seconds, the user agent must <a href="section-scripting.html#firing6">fire a
     progress event</a> called <code title="event-stalled"><a href="#stalled">stalled</a></code> at the element.</p>

    <p>User agents may allow users to selectively block or slow <a href="#media7">media data</a> downloads. When a <a href="#media5">media
     element</a>'s download has been blocked, the user agent must act as if
     it was stalled (as opposed to acting as if the connection was closed).</p>

    <p>The user agent may use whatever means necessary to download the
     resource (within the constraints put forward by this and other
     specifications); for example, reconnecting to the server in the face of
     network errors, using HTTP partial range requests, or switching to a
     streaming protocol. The user agent must only consider a resource
     erroneous if it has given up trying to download it.</p>

    <dl class="switch">
     <dt>If the <a href="#media7">media data</a> cannot be downloaded at all,
      due to network errors, causing the user agent to give up trying to
      download the resource

     </dt><dd>
      <p>DNS errors and HTTP 4xx and 5xx errors (and equivalents in other
       protocols) must cause the user agent to execute the following steps.
       User agents may also follow these steps in response to other network
       errors of similar severity.</p>

      <ol>
       <li>The user agent should cancel the download.

       </li><li>The <code title="dom-media-error"><a href="#error0">error</a></code>
        attribute must be set to a new <code><a href="#mediaerror">MediaError</a></code> object whose <code title="dom-MediaError-code"><a href="#code0">code</a></code> attribute
        is set to <code title="dom-MediaError-MEDIA_ERR_NETWORK"><a href="#mediaerrnetwork">MEDIA_ERR_NETWORK</a></code>.

       </li><li>The <a href="#begun">begun flag</a> must be set to false and the
        user agent must <a href="section-scripting.html#firing6">fire a progress event</a> called
        <code title="event-error"><a href="#error1">error</a></code> at the <a href="#media5">media element</a>.

       </li><li>The element's <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be
        switched to the <a href="#empty" title="dom-media-EMPTY">EMPTY</a>
        value and the user agent must <a href="section-scripting.html#firing2">fire a simple
        event</a> called <code title="event-emptied"><a href="#emptied">emptied</a></code> at the element.

       </li><li>These steps must be aborted.
      </li></ol>

     </dd><dt id="fatal-decode-error">If the <a href="#media7">media data</a> can be
      downloaded but is in an unsupported format, or can otherwise not be
      rendered at all

     </dt><dd>
      <p>The server returning a file of the wrong kind (e.g. one that that
       turns out to not be pure audio when the <a href="#media5">media
       element</a> is an <code><a href="#audio1">audio</a></code> element),
       or the file using unsupported codecs for all the data, must cause the
       user agent to execute the following steps. User agents may also
       execute these steps in response to other codec-related fatal errors,
       such as the file requiring more resources to process than the user
       agent can provide in real time.</p>

      <ol>
       <li>The user agent should cancel the download.

       </li><li>The <code title="dom-media-error"><a href="#error0">error</a></code>
        attribute must be set to a new <code><a href="#mediaerror">MediaError</a></code> object whose <code title="dom-MediaError-code"><a href="#code0">code</a></code> attribute
        is set to <code title="dom-MediaError-MEDIA_ERR_DECODE"><a href="#mediaerrdecode">MEDIA_ERR_DECODE</a></code>.

       </li><li>The <a href="#begun">begun flag</a> must be set to false and the
        user agent must <a href="section-scripting.html#firing6">fire a progress event</a> called
        <code title="event-error"><a href="#error1">error</a></code> at the <a href="#media5">media element</a>.

       </li><li>The element's <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be
        switched to the <a href="#empty" title="dom-media-EMPTY">EMPTY</a>
        value and the user agent must <a href="section-scripting.html#firing2">fire a simple
        event</a> called <code title="event-emptied"><a href="#emptied">emptied</a></code> at the element.

       </li><li>These steps must be aborted.
      </li></ol>

     </dd><dt>If the <a href="#media7">media data</a> download is aborted by the
      user

     </dt><dd>
      <p>The download is aborted by the user, e.g. because the user navigated
       the browsing context to another page, the user agent must execute the
       following steps. These steps are not followed if the <code title="dom-media-load"><a href="#load">load()</a></code> method itself
       is reinvoked, as the steps above handle that particular kind of abort.</p>

      <ol>
       <li>The user agent should cancel the download.

       </li><li>The <code title="dom-media-error"><a href="#error0">error</a></code>
        attribute must be set to a new <code><a href="#mediaerror">MediaError</a></code> object whose <code title="dom-MediaError-code"><a href="#code0">code</a></code> attribute
        is set to <code title="dom-MediaError-MEDIA_ERR_ABORT">MEDIA_ERR_ABORT</code>.

       </li><li>The <a href="#begun">begun flag</a> must be set to false and the
        user agent must <a href="section-scripting.html#firing6">fire a progress event</a> called
        <code title="event-abort"><a href="#abort">abort</a></code> at the <a href="#media5">media element</a>.

       </li><li>If the <a href="#media5">media element</a>'s <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute has the value
        <code title="dom-media-LOADING"><a href="#loading0">LOADING</a></code>,
        the element's <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be
        switched to the <a href="#empty" title="dom-media-EMPTY">EMPTY</a>
        value and the user agent must <a href="section-scripting.html#firing2">fire a simple
        event</a> called <code title="event-emptied"><a href="#emptied">emptied</a></code> at the element. (If the <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute has a value
        greater than <code title="dom-media-LOADING"><a href="#loading0">LOADING</a></code>, then this doesn't happen; the
        available data, if any, will be playable.)

       </li><li>These steps must be aborted.
      </li></ol>

     </dd><dt id="non-fatal-media-error">If the <a href="#media7">media data</a> can
      be downloaded but has non-fatal errors or uses, in part, codecs that
      are unsupported, preventing the user agent from rendering the content
      completely correctly but not preventing playback altogether

     </dt><dd>
      <p>The server returning data that is partially usable but cannot be
       optimally rendered must cause the user agent to execute the following
       steps.</p>

      <ol>
       <li class="big-issue">Should we fire a 'warning' event? Set the 'error'
        flag to 'MEDIA_ERR_SUBOPTIMAL' or something?
      </li></ol>

     </dd><dt>Once enough of the <a href="#media7">media data</a> has been
      downloaded to determine the duration of the <a href="#media8">media
      resource</a>, its dimensions, and other metadata

     </dt><dd>
      <p>The user agent must follow these substeps:</p>

      <ol>
       <li>
        <p>The <a href="#current">current playback position</a> must be set
         to the <var><a href="#effective">effective start</a></var>.

       </p></li><li>
        <p>The <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be set
         to <code title="dom-media-LOADED_METADATA"><a href="#loadedmetadata">LOADED_METADATA</a></code>.

       </p></li><li>
        <p class="note">A number of attributes, including <code title="dom-media-duration"><a href="#duration">duration</a></code>,
         <code title="dom-media-buffered"><a href="#buffered">buffered</a></code>, and <code title="dom-media-played"><a href="#played">played</a></code>, become
         available.

       </p></li><li>
        <p class="note">The user agent will <a href="section-scripting.html#firing2">fire a simple
         event</a> called <code title="event-durationchange"><a href="#durationchange">durationchange</a></code> at the element at
         this point.

       </p></li><li>
        <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a>
         called <code title="event-loadedmetadata"><a href="#loadedmetadata0">loadedmetadata</a></code> at the element.
      </p></li></ol>

     </dd><dt id="handling-first-frame-available">Once enough of the <a href="#media7">media data</a> has been downloaded to enable the user
      agent to display the frame at the <a href="#effective">effective
      start</a> of the <a href="#media8">media resource</a>

     </dt><dd>
      <p>The user agent must follow these substeps:</p>

      <ol>
       <li>
        <p>The <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be set
         to <code title="dom-media-LOADED_FIRST_FRAME"><a href="#loadedfirstframe">LOADED_FIRST_FRAME</a></code>.

       </p></li><li>
        <p>The <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> attribute must change to
         <code title="dom-media-CAN_SHOW_CURRENT_FRAME"><a href="#canshowcurrentframe">CAN_SHOW_CURRENT_FRAME</a></code>.

       </p></li><li>
        <p>The <a href="#loaded-first-frame">loaded-first-frame flag</a> must
         be set to true.

       </p></li><li>
        <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a>
         called <code title="event-loadedfirstframe"><a href="#loadedfirstframe0">loadedfirstframe</a></code> at the
         element.

       </p></li><li>
        <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a>
         called <code title="event-canshowcurrentframe"><a href="#canshowcurrentframe0">canshowcurrentframe</a></code> at the
         element.
      </p></li></ol>
    </dd></dl>

    <p>When the user agent has completed the download of the entire <a href="#media8">media resource</a>, it must move on to the next step.</p>

   </li><li>
    <p>If the download completes without errors, the <a href="#begun">begun
     flag</a> must be set to false, the <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute must be set to
     <code title="dom-media-LOADED"><a href="#loaded">LOADED</a></code>, and
     the user agent must <a href="section-scripting.html#firing6">fire a progress event</a> called
     <code title="event-load"><a href="#load0">load</a></code> at the element.
  </p></li></ol>

  <p>If a <a href="#media5">media element</a> whose <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> has the value <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> is inserted into a
   document, user agents must implicitly invoke the <code title="dom-media-load"><a href="#load">load()</a></code> method on the <a href="#media5">media element</a> as soon as all other scripts have
   finished executing<!-- XXX phrase that better? -->. Any exceptions raised
   must be ignored.

  </p><p>The <dfn id="bufferingrate" title="dom-media-bufferingRate"><code>bufferingRate</code></dfn> attribute
   must return the average number of bits received per second for the current
   download over the past few seconds. If there is no download in progress,
   the attribute must return 0.

  </p><p>The <dfn id="buffered" title="dom-media-buffered"><code>buffered</code></dfn> attribute must return
   a static <a href="#normalised">normalised <code>TimeRanges</code>
   object</a> that represents the ranges of the <a href="#media8">media
   resource</a>, if any, that the user agent has downloaded, at the time the
   attribute is evaluated.

  </p><p class="note">Typically this will be a single range anchored at the zero
   point, but if, e.g. the user agent uses HTTP range requests in response to
   seeking, then there could be multiple ranges.

  </p><h5 id="offsets"><span class="secno">3.14.9.5. </span>Offsets into the media
   resource</h5>

  <p>The <dfn id="duration" title="dom-media-duration"><code>duration</code></dfn> attribute must return
   the length of the <a href="#media8">media resource</a>, in seconds. If no
   <a href="#media7">media data</a> is available, then the attributes must
   return 0. If <a href="#media7">media data</a> is available but the length
   is not known, the attribute must return the Not-a-Number (NaN) value. If
   the <a href="#media8">media resource</a> is known to be unbounded (e.g. a
   streaming radio), then the attribute must return the positive Infinity
   value.

  </p><p>When the length of the <a href="#media8">media resource</a> changes
   (e.g. from being unknown to known, or from indeterminate to known, or from
   a previously established length to a new length) the user agent must, once
   any running scripts have finished, <a href="section-scripting.html#firing2">fire a simple
   event</a> called <code title="event-durationchange"><a href="#durationchange">durationchange</a></code> at the <a href="#media5">media element</a>.

  </p><p><a href="#media5" title="media element">Media elements</a> have a <dfn id="current">current playback position</dfn>, which must initially be zero.
   The current position is a time.

  </p><p>The <dfn id="currenttime" title="dom-media-currentTime"><code>currentTime</code></dfn> attribute must,
   on getting, return the <a href="#current">current playback position</a>,
   expressed in seconds. On setting, the user agent must <a href="#seek" title="dom-media-seek">seek</a> to the new value (which might raise an
   exception).

  </p><p>The <dfn id="start2" title="attr-media-start"><code>start</code></dfn>
   content attribute gives the offset into the <a href="#media8">media
   resource</a> at which playback is to begin. The default value is the
   default start position of the <a href="#media8">media resource</a>, or 0
   if not enough <a href="#media7">media data</a> has been obtained yet to
   determine the default start position or if the resource doesn't specify a
   default start position.

  </p><p>The <dfn id="effective"><var>effective start</var></dfn> is the smaller of
   the <code title="dom-media-start"><a href="#start3">start</a></code> DOM
   attribute and the end of the <a href="#media8">media resource</a>.

  </p><p>

  </p><p>The <dfn id="loopstart" title="attr-media-loopstart"><code>loopstart</code></dfn> content attribute
   gives the offset into the <a href="#media8">media resource</a> at which
   playback is to begin when looping a clip. The default value of the <code title="attr-media-loopStart"><a href="#loopstart">loopstart</a></code>
   content attribute is the value of the <code title="dom-media-start"><a href="#start3">start</a></code> DOM attribute.

  </p><p>The <dfn id="effective0"><var>effective loop start</var></dfn> is the
   smaller of the <code title="dom-media-loopStart"><a href="#loopstart0">loopStart</a></code> DOM attribute and the end of the
   <a href="#media8">media resource</a>.

  </p><p>

  </p><p>The <dfn id="loopend" title="attr-media-loopend"><code>loopend</code></dfn>
   content attribute gives an offset into the <a href="#media8">media
   resource</a> at which playback is to jump back to the <code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>, when
   looping the clip. The default value of the <code title="attr-media-loopEnd"><a href="#loopend">loopend</a></code> content
   attribute is the value of the <code title="dom-media-end"><a href="#end0">end</a></code> DOM attribute.

  </p><p>The <dfn id="effective1"><var>effective loop end</var></dfn> is the
   greater of the <code title="dom-media-start"><a href="#start3">start</a></code>, <code title="dom-media-loopStart"><a href="#loopstart0">loopStart</a></code>, and <code title="dom-media-loopEnd"><a href="#loopend0">loopEnd</a></code> DOM
   attributes, except if that is greater than the end of the <a href="#media8">media resource</a>, in which case that's its value.

  </p><p>

  </p><p>The <dfn id="end" title="attr-media-end"><code>end</code></dfn> content
   attribute gives an offset into the <a href="#media8">media resource</a> at
   which playback is to end. The default value is infinity.

  </p><p>The <dfn id="effective2"><var>effective end</var></dfn> is the greater of
   the <code title="dom-media-start"><a href="#start3">start</a></code>, <code title="dom-media-loopStart"><a href="#loopstart0">loopStart</a></code>, and
   <code title="dom-media-loopEnd"><a href="#loopend0">end</a></code> DOM
   attributes, except if that is greater than the end of the <a href="#media8">media resource</a>, in which case that's its value.

  </p><p>

  </p><p>The <code title="attr-media-start"><a href="#start2">start</a></code>,
   <code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>, <code title="attr-media-loopend"><a href="#loopend">loopend</a></code>, and <code title="attr-media-end"><a href="#end">end</a></code> attributes must, if specified, contain <span title="value time offset">value time offsets</span>. To get the time
   values they represent, user agents must use the <a href="section-common1.html#rules4">rules
   for parsing time offsets</a>.

  </p><p>The <dfn id="start3" title="dom-media-start"><code>start</code></dfn>, <dfn id="loopstart0" title="dom-media-loopStart"><code>loopStart</code></dfn>, <dfn id="loopend0" title="dom-media-loopEnd"><code>loopEnd</code></dfn>, and <dfn id="end0" title="dom-media-end"><code>end</code></dfn> DOM attributes must <a href="section-elements.html#reflect">reflect</a> the <code title="attr-media-start"><a href="#start2">start</a></code>, <code title="attr-media-loopstart"><a href="#loopstart">loopstart</a></code>, <code title="attr-media-loopend"><a href="#loopend">loopend</a></code>, and <code title="attr-media-end"><a href="#end">end</a></code> content attributes on the <a href="#media5">media element</a> respectively.

  </p><p>The <dfn id="playcount" title="attr-media-playcount"><code>playcount</code></dfn> content attribute
   gives the number of times to play the clip. The default value is 1.

  </p><p>The <dfn id="playcount0" title="dom-media-playCount"><code>playCount</code></dfn> DOM attribute must
   <a href="section-elements.html#reflect">reflect</a> the <code title="attr-media-playcount"><a href="#playcount">playcount</a></code> content attribute on the <a href="#media5">media element</a>. The value must be <a href="section-elements.html#limited1">limited to only positive non-zero numbers</a>.

  </p><p>The <dfn id="currentloop" title="dom-media-currentLoop"><code>currentLoop</code></dfn> attribute must
   initially have the value 0. It gives the index of the current loop. It is
   changed during playback as described below.

  </p><p>When any of the <code title="dom-media-start"><a href="#start3">start</a></code>, <code title="dom-media-loopStart"><a href="#loopstart0">loopStart</a></code>, <code title="dom-media-loopEnd"><a href="#loopend0">loopEnd</a></code>, <code title="dom-media-end"><a href="#end0">end</a></code>, and <code title="dom-media-playCount"><a href="#playcount0">playCount</a></code> DOM attributes change value
   (either through content attribute mutations reflecting into the DOM
   attribute, or direct mutations of the DOM attribute), the user agent must
   apply the following steps:

  </p><ol>
   <li>
    <p>If the <code title="dom-media-playCount"><a href="#playcount0">playCount</a></code> DOM attribute's value is less
     than or equal to the <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> DOM attribute's value, then
     the <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> DOM attribute's value must be
     set to <span><code title="dom-media-playCount"><a href="#playcount0">playCount</a></code>-1</span> (which will make the
     current loop the last loop).

   </p></li><li>
    <p>If the <a href="#media5">media element</a>'s <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is in the <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> state or the
     <code title="dom-media-LOADING"><a href="#loading0">LOADING</a></code>
     state, then the user agent must at this point abort these steps.

   </p></li><li>
    <p>If the <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is zero, and the <a href="#current">current playback position</a> is before the <var><a href="#effective">effective start</a></var>, the user agent must <a href="#seek" title="dom-media-seek">seek</a> to the <var><a href="#effective">effective start</a></var>.

   </p></li><li>
    <p>If the <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is greater than zero, and the
     <a href="#current">current playback position</a> is before the <var><a href="#effective0">effective loop start</a></var>, the user agent must
     <a href="#seek" title="dom-media-seek">seek</a> to the <var><a href="#effective0">effective loop start</a></var>.

   </p></li><li>
    <p>If the <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is less than <span><code title="dom-media-playCount"><a href="#playcount0">playCount</a></code>-1</span>, and the <a href="#current">current playback position</a> is after the <var><a href="#effective1">effective loop end</a></var>, the user agent must <a href="#seek" title="dom-media-seek">seek</a> to the <var><a href="#effective0">effective loop start</a></var>, and increase <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> by 1.

   </p></li><li>
    <p>If the <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is equal to <span><code title="dom-media-playCount"><a href="#playcount0">playCount</a></code>-1</span>, and the <a href="#current">current playback position</a> is after the <var><a href="#effective2">effective end</a></var>, the user agent must <a href="#seek" title="dom-media-seek">seek</a> to the <var><a href="#effective2">effective end</a></var> and then the looping will
     end.
  </p></li></ol>

  <h5 id="the-ready"><span class="secno">3.14.9.6. </span>The ready states</h5>

  <p><a href="#media5" title="media element">Media elements</a> have a
   <em>ready state</em>, which describes to what degree they are ready to be
   rendered at the <a href="#current">current playback position</a>. The
   possible values are as follows; the ready state of a media element at any
   particular time is the greatest value describing the state of the element:

  </p><dl>
   <dt><dfn id="dataunavailable" title="dom-media-DATA_UNAVAILABLE"><code>DATA_UNAVAILABLE</code></dfn>
    (numeric value 0)

   </dt><dd>No data for the <a href="#current">current playback position</a> is
    available. <a href="#media5" title="media element">Media elements</a>
    whose <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute is less than <code title="dom-media-LOADED_FIRST_FRAME"><a href="#loadedfirstframe">LOADED_FIRST_FRAME</a></code> are always in the
    <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code> state.

   </dd><dt><dfn id="canshowcurrentframe" title="dom-media-CAN_SHOW_CURRENT_FRAME"><code>CAN_SHOW_CURRENT_FRAME</code></dfn>
    (numeric value 1)

   </dt><dd>Data for the immediate <a href="#current">current playback
    position</a> is available, but not enough data is available that the user
    agent could successfully advance the <a href="#current">current playback
    position</a> at all without immediately reverting to the <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code> state. In video, this
    corresponds to the user agent having data from the current frame, but not
    the next frame. In audio, this corresponds to the user agent only having
    audio up to the <a href="#current">current playback position</a>, but no
    further.

   </dd><dt><dfn id="canplay" title="dom-media-CAN_PLAY"><code>CAN_PLAY</code></dfn>
    (numeric value 2)

   </dt><dd>Data for the immediate <a href="#current">current playback
    position</a> is available, as well as enough data for the user agent to
    advance the <a href="#current">current playback position</a> at least a
    little without immediately reverting to the <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code> state. In video, this
    corresponds to the user agent having data for the current frame and the
    next frame. In audio, this corresponds ot the user agent having data
    beyond the <a href="#current">current playback position</a>.

   </dd><dt><dfn id="canplaythrough" title="dom-media-CAN_PLAY_THROUGH"><code>CAN_PLAY_THROUGH</code></dfn>
    (numeric value 3)

   </dt><dd>Data for the immediate <a href="#current">current playback
    position</a> is available, as well as enough data for the user agent to
    advance the <a href="#current">current playback position</a> at least a
    little without immediately reverting to the <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code> state, and, in
    addition, the user agent estimates that data is being downloaded at a
    rate where the <a href="#current">current playback position</a>, if it
    were to advance at the rate given by the <code title="dom-media-defaultPlaybackRate"><a href="#defaultplaybackrate">defaultPlaybackRate</a></code> attribute,
    would not overtake the available data before playback reaches the <a href="#effective2">effective end</a> of the <a href="#media8">media
    resource</a> on the last <a href="#playcount0" title="dom-media-playCount">loop</a>.
  </dd></dl>

  <p>When the ready state of a <a href="#media5">media element</a> whose
   <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is not <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> changes, the user
   agent must follow the steps given below:

  </p><dl class="switch">
   <dt>If the new ready state is <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code>

   </dt><dd>
    <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called
     <code title="event-dataunavailable"><a href="#dataunavailable0">dataunavailable</a></code> at the element.

   </p></dd><dt>If the new ready state is <code title="dom-media-CAN_SHOW_CURRENT_FRAME"><a href="#canshowcurrentframe">CAN_SHOW_CURRENT_FRAME</a></code>

   </dt><dd>
    <p>If the element's <a href="#loaded-first-frame">loaded-first-frame
     flag</a> is true, the user agent must <a href="section-scripting.html#firing2">fire a simple
     event</a> called <code title="event-canshowcurrentframe"><a href="#canshowcurrentframe0">canshowcurrentframe</a></code> event.</p>

    <p class="note">The first time the <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute switches to this
     value, the <a href="#loaded-first-frame">loaded-first-frame flag</a> is
     false, and the event is fired <a href="#handling-first-frame-available">by the algorithm described
     above</a> for the <code title="dom-media-load"><a href="#load">load()</a></code> method, in conjunction with other steps.</p>

   </dd><dt>If the new ready state is <code title="dom-media-CAN_PLAY"><a href="#canplay">CAN_PLAY</a></code>

   </dt><dd>
    <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called
     <code title="event-canplay"><a href="#canplay0">canplay</a></code>.

   </p></dd><dt>If the new ready state is <code title="dom-media-CAN_PLAY_THROUGH"><a href="#canplaythrough">CAN_PLAY_THROUGH</a></code>

   </dt><dd>
    <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called
     <code title="event-canplaythrough"><a href="#canplaythrough0">canplaythrough</a></code> event. If the <a href="#autoplaying">autoplaying flag</a> is true, and the <code title="dom-media-paused"><a href="#paused">paused</a></code> attribute is
     true, and the <a href="#media5">media element</a> has an <code title="attr-media-autoplay"><a href="#autoplay">autoplay</a></code>
     attribute specified, then the user agent must also set the <code title="dom-media-paused"><a href="#paused">paused</a></code> attribute to
     false and <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-play"><a href="#play0">play</a></code>.
  </p></dd></dl>

  <p class="note">It is possible for the ready state of a media element to jump
   between these states discontinuously. For example, the state of a media
   element whose <span>leaded-first-frame flag</span> is false can jump
   straight from <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code> to <code title="dom-media-CAN_PLAY_THROUGH"><a href="#canplaythrough">CAN_PLAY_THROUGH</a></code> without passing through
   the <code title="dom-media-CAN_SHOW_CURRENT_FRAME"><a href="#canshowcurrentframe">CAN_SHOW_CURRENT_FRAME</a></code> and <code title="dom-media-CAN_PLAY"><a href="#canplay">CAN_PLAY</a></code> states,
   and thus without firing the <code title="event-canshowcurrentframe"><a href="#canshowcurrentframe0">canshowcurrentframe</a></code> and <code title="event-canplay"><a href="#canplay0">canplay</a></code> events. The
   only state that is guarenteed to be reached is the <code title="dom-media-CAN_SHOW_CURRENT_FRAME"><a href="#canshowcurrentframe">CAN_SHOW_CURRENT_FRAME</a></code> state, which
   is reached as part of the <code title="dom-media-load"><a href="#load">load()</a></code> method's processing.

  </p><p>The <dfn id="readystate" title="dom-media-readyState"><code>readyState</code></dfn> DOM attribute
   must, on getting, return the value described above that describes the
   current ready state of the <a href="#media5">media element</a>.

  </p><p>The <dfn id="autoplay" title="attr-media-autoplay"><code>autoplay</code></dfn> attribute is a <a href="section-common1.html#boolean0">boolean attribute</a>. When present, the algorithm
   described herein will cause the user agent to automatically begin playback
   of the <a href="#media8">media resource</a> as soon as it can do so
   without stopping.

  </p><p>The <dfn id="autoplay0" title="dom-media-autoplay"><code>autoplay</code></dfn> DOM attribute must <a href="section-elements.html#reflect">reflect</a> the content attribute of the same name.

  </p><h5 id="playing"><span class="secno">3.14.9.7. </span>Playing the media
   resource</h5>

  <p>The <dfn id="paused" title="dom-media-paused"><code>paused</code></dfn>
   attribute represents whether the <a href="#media5">media element</a> is
   paused or not. The attribute must initially be true.

  </p><p>A <a href="#media5">media element</a> is said to be <dfn id="actively">actively playing</dfn> when its <code title="dom-media-paused"><a href="#paused">paused</a></code> attribute is
   false, the <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> attribute is either <code title="dom-media-CAN_PLAY"><a href="#canplay">CAN_PLAY</a></code> or <code title="dom-media-CAN_PLAY_THROUGH"><a href="#canplaythrough">CAN_PLAY_THROUGH</a></code>, the element has not <a href="#ended">ended playback</a>, playback has not <a href="#stopped">stopped due to errors</a>, and the element has not <a href="#paused0">paused for user interaction</a>.

  </p><p>A <a href="#media5">media element</a> is said to have <dfn id="ended">ended playback</dfn> when the element's <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute is <code title="dom-media-LOADED_METADATA"><a href="#loadedmetadata">LOADED_METADATA</a></code> or greater, the <a href="#current">current playback position</a> is equal to the <var><a href="#effective2">effective end</a></var> of the <a href="#media8">media
   resource</a>, and the <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> attribute is equal to
   <span><code title="dom-media-playCount"><a href="#playcount0">playCount</a></code>-1</span>.

  </p><p>A <a href="#media5">media element</a> is said to have <dfn id="stopped">stopped due to errors</dfn> when the element's <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute is <code title="dom-media-LOADED_METADATA"><a href="#loadedmetadata">LOADED_METADATA</a></code> or greater, and the user
   agent <a href="#non-fatal-media-error">encounters a non-fatal error</a>
   during the processing of the <a href="#media7">media data</a>, and due to
   that error, is not able to play the content at the <a href="#current">current playback position</a>.

  </p><p>A <a href="#media5">media element</a> is said to have <dfn id="paused0">paused for user interaction</dfn> when its <code title="dom-media-paused"><a href="#paused">paused</a></code> attribute is
   false, the <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> attribute is either <code title="dom-media-CAN_PLAY"><a href="#canplay">CAN_PLAY</a></code> or <code title="dom-media-CAN_PLAY_THROUGH"><a href="#canplaythrough">CAN_PLAY_THROUGH</a></code> and the user agent has
   reached a point in the <a href="#media8">media resource</a> where the user
   has to make a selection for the resource to continue.

  </p><p>It is possible for a <a href="#media5">media element</a> to have both <a href="#ended">ended playback</a> and <a href="#paused0">paused for user
   interaction</a> at the same time.

  </p><p>When a <a href="#media5">media element</a> is <a href="#actively">actively playing</a> and its <span title="dom-ownerDocument">owner
   <code>Document</code></span><!-- XXX xref --> is an <a href="section-windows.html#active">active document</a>, its <a href="#current">current
   playback position</a> must increase monotonically at <code title="dom-media-playbackRate"><a href="#playbackrate">playbackRate</a></code> units of media time per unit
   time of wall clock time. If this value is not 1, the user agent may apply
   pitch adjustments to any audio component of the <a href="#media8">media
   resource</a>.

  </p><p><a href="#media8" title="media resource">Media resources</a> might be
   internally scripted or interactive. Thus, a <a href="#media5">media
   element</a> could play in a non-linear fashion. If this happens, the user
   agent must act as if the algorithm for <a href="#seek" title="dom-media-seek">seeking</a> was used whenever the <a href="#current">current playback position</a> changes in a discontinuous
   fashion (so that the relevant events fire).

  </p><p>When a <a href="#media5">media element</a> that is <a href="#actively">actively playing</a> stops playing because its <code title="dom-media-readyState"><a href="#readystate">readyState</a></code>
   attribute changes to a value lower than <code title="dom-media-CAN_PLAY"><a href="#canplay">CAN_PLAY</a></code>, without the element having <a href="#ended">ended playback</a>, or playback having <a href="#stopped">stopped due to errors</a>, or playback having <a href="#paused0">paused for user interaction</a>, the user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code> at the
   element, and then must <a href="section-scripting.html#firing2">fire a simple event</a> called
   <code title="event-waiting"><a href="#waiting">waiting</a></code> at the
   element.

  </p><p>When a <a href="#media5">media element</a> that is <a href="#actively">actively playing</a> stops playing because it has <a href="#paused0">paused for user interaction</a>, the user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code> at the
   element.

  </p><p>When <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is less than <span><code title="dom-media-playCount"><a href="#playcount0">playCount</a></code>-1</span> and the <a href="#current">current playback position</a> reaches the <var><a href="#effective1">effective loop end</a></var>, then the user agent must
   <a href="#seek" title="dom-media-seek">seek</a> to the <var><a href="#effective0">effective loop start</a></var>, increase <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code>
   by 1, and <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code>.

  </p><p>When <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is equal to the <span><code title="dom-media-playCount"><a href="#playcount0">playCount</a></code>-1</span> and the <a href="#current">current playback position</a> reaches the <var><a href="#effective2">effective end</a></var>, then the user agent must
   follow these steps:

  </p><ol>
   <li>
    <p>The user agent must stop playback.

   </p></li><li>
    <p class="note">The <code title="dom-media-ended"><a href="#ended0">ended</a></code> attribute becomes true.

   </p></li><li>
    <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called
     <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code>
     at the element.

   </p></li><li>
    <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called
     <code title="event-ended"><a href="#ended1">ended</a></code> at the
     element.
  </p></li></ol>

  <p>The <dfn id="defaultplaybackrate" title="dom-media-defaultPlaybackRate"><code>defaultPlaybackRate</code></dfn>
   attribute gives the desired speed at which the <a href="#media8">media
   resource</a> is to play, as a multiple of its intrinsic speed. The
   attribute is mutable, but on setting, if the new value is 0.0, a
   <code>NOT_SUPPORTED_ERR</code> exception must be raised instead of the
   value being changed. It must initially have the value 1.0.

  </p><p>The <dfn id="playbackrate" title="dom-media-playbackRate"><code>playbackRate</code></dfn> attribute
   gives the speed at which the <a href="#media8">media resource</a> plays,
   as a multiple of its intrinsic speed. If it is not equal to the <code title="dom-media-defaultPlaybackRate"><a href="#defaultplaybackrate">defaultPlaybackRate</a></code>, then the
   implication is that the user is using a feature such as fast forward or
   slow motion playback. The attribute is mutable, but on setting, if the new
   value is 0.0, a <code>NOT_SUPPORTED_ERR</code> exception must be raised
   instead of the value being changed. Otherwise, the playback must change
   speed (if the element is <a href="#actively">actively playing</a>). It
   must initially have the value 1.0.

  </p><p>When the <code title="dom-media-defaultPlaybackRate"><a href="#defaultplaybackrate">defaultPlaybackRate</a></code> or <code title="dom-media-playbackRate"><a href="#playbackrate">playbackRate</a></code> attributes change value
   (either by being set by script or by being changed directly by the user
   agent, e.g. in response to user control) the user agent must, once any
   running scripts have finished, <a href="section-scripting.html#firing2">fire a simple event</a>
   called <code title="event-ratechange">ratechange</code> at the <a href="#media5">media element</a>.

  </p><p>When the <dfn id="play" title="dom-media-play"><code>play()</code></dfn>
   method on a <a href="#media5">media element</a> is invoked, the user agent
   must run the following steps.

  </p><ol>
   <li>
    <p>If the <a href="#media5">media element</a>'s <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute has the value <a href="#empty" title="dom-media-EMPTY">EMPTY</a>, then the user agent must
     invoke the <code title="dom-media-load"><a href="#load">load()</a></code>
     method and wait for it to return. If that raises an exception, that
     exception must be reraised by the <code title="dom-media-play"><a href="#play">play()</a></code> method.

   </p></li><li>
    <p>If the <a href="#ended" title="ended playback">playback has ended</a>,
     then the user agent must set <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> to zero and <a href="#seek" title="dom-media-seek">seek</a> to the <var><a href="#effective">effective
     start</a></var>.</p>

   </li><li>
    <p>The <code title="dom-media-playbackRate"><a href="#playbackrate">playbackRate</a></code> attribute must be set to
     the value of the <code title="dom-media-defaultPlaybackRate"><a href="#defaultplaybackrate">defaultPlaybackRate</a></code> attribute.

   </p></li><li>
    <p>If the <a href="#media5">media element</a>'s <code title="dom-media-paused"><a href="#paused">paused</a></code> attribute is
     true, it must be set to false.

   </p></li><li>
    <p>The <a href="#media5">media element</a>'s <a href="#autoplaying">autoplaying flag</a> must be set to false.

   </p></li><li>
    <p>The method must then return.
  </p></li></ol>

  <p class="note">If the second step above involved a seek, the user agent will
   <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code> at the
   <a href="#media5">media element</a>.

  </p><p class="note">If the third step above caused the <code title="dom-media-playbackRate"><a href="#playbackrate">playbackRate</a></code> attribute to change value,
   the user agent will <a href="section-scripting.html#firing2">fire a simple event</a> called
   <code title="event-ratechange">ratechange</code> at the <a href="#media5">media element</a>.

  </p><p class="note">If the fourth step above changed the value of <code title="dom-media-paused"><a href="#paused">paused</a></code>, the user agent
   must <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-play"><a href="#play0">play</a></code> at the <a href="#media5">media element</a>.

  </p><p>When the <dfn id="pause0" title="dom-media-pause"><code>pause()</code></dfn>
   method is invoked, the user agent must run the following steps:

  </p><ol>
   <li>
    <p>If the <a href="#media5">media element</a>'s <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> attribute has the value <a href="#empty" title="dom-media-EMPTY">EMPTY</a>, then the user agent must
     invoke the <code title="dom-media-load"><a href="#load">load()</a></code>
     method and wait for it to return. If that raises an exception, that
     exception must be reraised by the <code title="dom-media-play"><a href="#play">pause()</a></code> method.

   </p></li><li>
    <p>If the <a href="#media5">media element</a>'s <code title="dom-media-paused"><a href="#paused">paused</a></code> attribute is
     false, it must be set to true.

   </p></li><li>
    <p>The <a href="#media5">media element</a>'s <a href="#autoplaying">autoplaying flag</a> must be set to false.

   </p></li><li>
    <p>The method must then return.

   </p></li><li>
    <p>If the second step above changed the value of <code title="dom-media-paused"><a href="#paused">paused</a></code>, the user
     agent must first <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code> at
     the element, and then <a href="section-scripting.html#firing2">fire a simple event</a> called
     <code title="event-pause"><a href="#pause1">pause</a></code> at the
     element.
  </p></li></ol>

  <p>When a <a href="#media5">media element</a> is <span>removed from a
   <code>Document</code><!-- XXX xref removed --></span>, the user agent must
   act as if the <code title="dom-media-pause"><a href="#pause0">pause()</a></code> method had been invoked.

  </p><p><a href="#media5" title="media element">Media elements</a> that are <a href="#actively">actively playing</a> while not <span>in a
   <code>Document</code></span><!-- XXX xref --> must not play any video, but
   should play any audio component. Media elements must not stop playing just
   because all references to them have been removed; only once a media
   element to which no references exist has reached a point where no further
   audio remains to be played for that element (e.g. because the element is
   paused or because the end of the clip has been reached) may the element be
   <span>garbage collected</span><!-- XXX xref -->.

  </p><p>The <dfn id="ended0" title="dom-media-ended"><code>ended</code></dfn>
   attribute must return true if the <a href="#media5">media element</a> has
   <a href="#ended">ended playback</a>, and false otherwise.

  </p><p>The <dfn id="played" title="dom-media-played"><code>played</code></dfn>
   attribute must return a static <a href="#normalised">normalised
   <code>TimeRanges</code> object</a> that represents the ranges of the <a href="#media8">media resource</a>, if any, that the user agent has so far
   rendered, at the time the attribute is evaluated.

  </p><h5 id="seeking"><span class="secno">3.14.9.8. </span>Seeking</h5>

  <p>The <dfn id="seeking0" title="dom-media-seeking"><code>seeking</code></dfn>
   attribute must initially have the value false.

  </p><p>When the user agent is required to <dfn id="seek" title="dom-media-seek">seek</dfn> to a particular <var title="">new playback
   position</var> in the <a href="#media8">media resource</a>, it means that
   the user agent must run the following steps:

  </p><ol>
   <li>
    <p>If the <a href="#media5">media element</a>'s <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is less than <code title="dom-media-LOADED_METADATA"><a href="#loadedmetadata">LOADED_METADATA</a></code>, then the user agent
     must raise an <code>INVALID_STATE_ERR</code> exception (if the seek was
     in response to a DOM method call or setting of a DOM attribute), and
     abort these steps.

   </p></li><li>
    <p>If <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is 0, let <var title="">min</var> be the <var><a href="#effective">effective
     start</a></var>. Otherwise, let it be the <var><a href="#effective0">effective loop start</a></var>.

   </p></li><li>
    <p>If <code title="dom-media-currentLoop"><a href="#currentloop">currentLoop</a></code> is equal to the value of
     <code title="dom-media-playCount"><a href="#playcount0">playCount</a></code>, let <var title="">max</var> be
     the <var><a href="#effective2">effective end</a></var>. Otherwise, let
     it be the <var><a href="#effective1">effective loop end</a></var>.

   </p></li><li>
    <p>If the <var title="">new playback position</var> is more than <var title="">max</var>, let it be <var title="">max</var>.

   </p></li><li>
    <p>If the <var title="">new playback position</var> is less than <var title="">min</var>, let it be <var title="">min</var>.

   </p></li><li>
    <p>If the (possibly now changed) <var title="">new playback
     position</var> is not in one of the ranges given in the <code title="dom-media-seekable"><a href="#seekable">seekable</a></code>
     attribute, then the user agent must raise an <code>INDEX_SIZE_ERR</code>
     exception (if the seek was in response to a DOM method call or setting
     of a DOM attribute), and abort these steps.

   </p></li><li>
    <p>The <a href="#current">current playback position</a> must be set to
     the given <var title="">new playback position</var>.

   </p></li><li>
    <p>The <code title="dom-media-seeking"><a href="#seeking0">seeking</a></code> DOM attribute must be set to true.

   </p></li><li>
    <p>The user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called
     <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code>
     at the element.

   </p></li><li>
    <p>As soon as the user agent has established whether or not the <a href="#media7">media data</a> for the <var title="">new playback
     position</var> is available, and, if it is, decoded enough data to play
     back that position, the <code title="dom-media-seeking"><a href="#seeking0">seeking</a></code> DOM attribute must be set to false.
  </p></li></ol>

  <p>The <dfn id="seekable" title="dom-media-seekable"><code>seekable</code></dfn> attribute must return
   a static <a href="#normalised">normalised <code>TimeRanges</code>
   object</a> that represents the ranges of the <a href="#media8">media
   resource</a>, if any, that the user agent is able to seek to, at the time
   the attribute is evaluated, notwithstanding the looping attributes (i.e.
   the <var><a href="#effective">effective start</a></var> and <var><a href="#effective2">effective end</a></var>, etc, don't affect the <code title="dom-media-seekable"><a href="#seekable">seeking</a></code>
   attribute).

  </p><p class="note">If the user agent can seek to anywhere in the <a href="#media8">media resource</a>, e.g. because it a simple movie file and
   the user agent and the server support HTTP Range requests, then the
   attribute would return an object with one range, whose start is the time
   of the first frame (typically zero), and whose end is the same as the time
   of the first frame plus the <code title="dom-media-duration"><a href="#duration">duration</a></code> attribute's value (which would equal
   the time of the last frame).

  </p><h5 id="cue-ranges"><span class="secno">3.14.9.9. </span>Cue ranges</h5>

  <p><a href="#media5" title="media element">Media elements</a> have a set of
   <dfn id="cue-ranges0" title="cue range">cue ranges</dfn>. Each cue range is
   made up of the following information:

  </p><dl>
   <dt>A class name

   </dt><dd>A group of related ranges can be given the same class name so that
    they can all be removed at the same time.

   </dd><dt>A start time

   </dt><dt>An end time

   </dt><dd>The actual time range, using the same timeline as the <a href="#media8">media resource</a> itself.

   </dd><dt>A &quot;pause&quot; boolean

   </dt><dd>A flag indicating whether to pause playback on exit.

   </dd><dt>An &quot;enter&quot; callback

   </dt><dd>A callback that is called when the <a href="#current">current playback
    position</a> enters the range.

   </dd><dt>An &quot;exit&quot; callback

   </dt><dd>A callback that is called when the <a href="#current">current playback
    position</a> exits the range.

   </dd><dt>An &quot;active&quot; boolean

   </dt><dd>A flag indicating whether the range is active or not.
  </dd></dl>

  <p>The <dfn id="addcuerange" title="dom-media-addCueRange"><code>addCueRange(<var title="">className</var>, <var title="">start</var>, <var title="">end</var>, <var title="">pauseOnExit</var>, <var title="">enterCallback</var>, <var title="">exitCallback</var>)</code></dfn> method must, when called, add a
   <a href="#cue-ranges0">cue range</a> to the <a href="#media5">media
   element</a>, that cue range having the class name <var title="">className</var>, the start time <var title="">start</var> (in
   seconds), the end time <var title="">end</var> (in seconds), the &quot;pause&quot;
   boolean with the same value as <var title="">pauseOnExit</var>, the
   &quot;enter&quot; callback <var title="">enterCallback</var>, the &quot;exit&quot; callback
   <var title="">exitCallback</var>, and an &quot;active&quot; boolean that is true if
   the <a href="#current">current playback position</a> is equal to or
   greater than the start time and less than the end time, and false
   otherwise.

  </p><p>The <dfn id="removecueranges" title="dom-media-removeCueRanges"><code>removeCueRanges(<var title="">className</var>)</code></dfn> method must, when called, remove
   all the <a href="#cue-ranges0" title="cue range">cue ranges</a> of the <a href="#media5">media element</a> which have the class name <var title="">className</var>.

  </p><p>When the <a href="#current">current playback position</a> of a <a href="#media5">media element</a> changes (e.g. due to playback or
   seeking), the user agent must run the following steps. If the <a href="#current">current playback position</a> changes while the steps are
   running, then the user agent must wait for the steps to complete, and then
   must immediately rerun the steps. (If one iteration takes a long time,
   this can cause certain ranges to be skipped over as the user agent rushes
   ahead to &quot;catch up&quot;.)

  </p><ol>
   <li>
    <p>Let <var title="">current ranges</var> be an ordered list of <a href="#cue-ranges0" title="cue range">cue ranges</a>, initialised to
     contain all the <a href="#cue-ranges0" title="cue range">cue ranges</a>
     of the <a href="#media5">media element</a> whose start times are less
     than or equal to the <a href="#current">current playback position</a>
     and whose end times are greater than the <a href="#current">current
     playback position</a>, in the order they were added to the element.

   </p></li><li>
    <p>Let <var title="">other ranges</var> be an ordered list of <a href="#cue-ranges0" title="cue range">cue ranges</a>, initialised to
     contain all the <a href="#cue-ranges0" title="cue range">cue ranges</a>
     of the <a href="#media5">media element</a> that are not present in <var title="">current ranges</var>, in the order they were added to the
     element.

   </p></li><li>
    <p>If none of the <a href="#cue-ranges0" title="cue range">cue ranges</a>
     in <var title="">current ranges</var> have their &quot;active&quot; boolean set to
     &quot;false&quot; (inactive) and none of the <a href="#cue-ranges0" title="cue
     range">cue ranges</a> in <var title="">current ranges</var> have their
     &quot;active&quot; boolean set to &quot;true&quot; (active), then abort these steps.

   </p></li><li>
    <p>If the time was reached through the usual monotonic increase of the
     current playback position during normal playback, the user agent must
     then <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-timeupdate"><a href="#timeupdate">timeupdate</a></code> at
     the element. (In the other cases, such as explicit seeks, relevant
     events get fired as part of the overall process of changing the current
     playback position.)

   </p></li><li>
    <p>If there are any <a href="#cue-ranges0" title="cue range">cue
     ranges</a> in <var title="">other ranges</var> that have their &quot;active&quot;
     boolean set to &quot;true&quot; (active) and have their &quot;pause&quot; boolean set to
     &quot;true&quot; as well, then immediately act as if the element's <code title="dom-media-pause"><a href="#pause0">pause()</a></code> method had
     been invoked.

   </p></li><li>
    <p>Invoke all the non-null &quot;exit&quot; callbacks for all of the <a href="#cue-ranges0" title="cue range">cue ranges</a> in <var title="">other ranges</var> that have their &quot;active&quot; boolean set to
     &quot;true&quot; (active), in list order.
   </p></li>
   <!-- XXX queue -->

   <li>
    <p>Invoke all the non-null &quot;enter&quot; callbacks for all of the <a href="#cue-ranges0" title="cue range">cue ranges</a> in <var title="">current ranges</var> that have their &quot;active&quot; boolean set to
     &quot;false&quot; (inactive), in list order.
   </p></li>
   <!-- XXX queue -->

   <li>
    <p>Set the &quot;active&quot; boolean of all the <a href="#cue-ranges0" title="cue
     range">cue ranges</a> in the <var title="">current ranges</var> list to
     &quot;true&quot; (active), and the &quot;active&quot; boolean of all the <a href="#cue-ranges0" title="cue range">cue ranges</a> in the <var title="">other ranges</var> list to &quot;false&quot; (inactive).
  </p></li></ol>
  <!-- XXX the remainder of this subsection will be removed once we
  have a way to mark up callbacks in IDL -->

  <p>Invoking a callback (an object implementing the <code><a href="#voidcallback">VoidCallback</a></code> interface) means calling its
   <code title="dom-VoidCallback-handleEvent"><a href="#handleevent">handleEvent()</a></code> method.

  </p><pre class="idl">interface <dfn id="voidcallback">VoidCallback</dfn> {
  void <a href="#handleevent" title="dom-voidCallback-handleEvent">handleEvent</a>();
};</pre>

  <p>The <dfn id="handleevent" title="dom-voidCallback-handleEvent"><code>handleEvent</code></dfn> method
   of objects implementing the <code><a href="#voidcallback">VoidCallback</a></code> interface is the entrypoint
   for the callback represented by the object.

  </p><p>In the ECMAScript DOM binding, the ECMAScript native
   <code>Function</code> type must implement the <code><a href="#voidcallback">VoidCallback</a></code> interface such that invoking
   the <code>handleEvent()</code> method of that interface on the object from
   another language binding invokes the function itself. In the ECMAScript
   binding itself, however, the <code>handleEvent()</code> method of the
   interface is not directly accessible on <code>Function</code> objects.
   Such functions, when invoked, must be called at the scope of the <a href="section-windows.html#browsing0">browsing context</a>.</p>
  <!--
  XXX if you change this make sure to also look up the other mentions
  of handleEvent() in this file -->

  <h5 id="user-interface"><span class="secno">3.14.9.10. </span>User interface</h5>

  <p>The <dfn id="controls" title="attr-media-controls"><code>controls</code></dfn> attribute is a <a href="section-common1.html#boolean0">boolean attribute</a>. If the attribute is present, or if
   <a href="section-scripting.html#scripting1">scripting is disabled</a>, then the user agent
   should <dfn id="expose">expose a user interface to the user</dfn>. This user
   interface should include features to begin playback, pause playback, seek
   to an arbitrary position in the content (if the content supports arbitrary
   seeking), change the volume, and show the media content in manners more
   suitable to the user (e.g. full-screen video or in an independent
   resizable window). Other controls may also be made available.

  </p><p>If the attribute is absent, then the user agent should avoid making a
   user interface available that could conflict with an author-provided user
   interface. User agents may make the following features available, however,
   even when the attribute is absent:

  </p><p>User agents may provide controls to affect playback of the media
   resource (e.g. play, pause, seeking, and volume controls), but such
   features should not interfere with the page's normal rendering. For
   example, such features could be exposed in the <a href="#media5">media
   element</a>'s context menu.

  </p><p>Where possible (specifically, for starting, stopping, pausing, and
   unpausing playback, for muting or changing the volume of the audio, and
   for seeking), user interface features exposed by the user agent must be
   implemented in terms of the DOM API described above, so that, e.g., all
   the same events fire.

  </p><p>The <dfn id="controls0" title="dom-media-controls"><code>controls</code></dfn> DOM attribute must <a href="section-elements.html#reflect">reflect</a> the content attribute of the same name.

  </p><p>The <dfn id="volume" title="dom-media-volume"><code>volume</code></dfn>
   attribute must return the playback volume of any audio portions of the <a href="#media5">media element</a>, in the range 0.0 (silent) to 1.0
   (loudest). Initially, the volume must be 0.5, but user agents may remember
   the last set value across sessions, on a per-site basis or otherwise, so
   the volume may start at other values. On setting, if the new value is in
   the range 0.0 to 1.0 inclusive, the attribute must be set to the new value
   and the playback volume must be correspondingly adjusted as soon as
   possible after setting the attribute, with 0.0 being silent, and 1.0 being
   the loudest setting, values in between increasing in loudness. The range
   need not be linear. The loudest setting may be lower than the system's
   loudest possible setting; for example the user could have set a maximum
   volume. If the new value is outside the range 0.0 to 1.0 inclusive, then,
   on setting, an <code>INDEX_SIZE_ERR</code> exception must be raised
   instead.

  </p><p>The <dfn id="muted" title="dom-media-muted"><code>muted</code></dfn>
   attribute must return true if the audio channels are muted and false
   otherwise. On setting, the attribute must be set to the new value; if the
   new value is true, audio playback for this <a href="#media8">media
   resource</a> must then be muted, and if false, audio playback must then be
   enabled.

  </p><p>Whenever either the <code title="dom-media-muted"><a href="#muted">muted</a></code> or <code title="dom-media-volume"><a href="#volume">volume</a></code> attributes are changed, after any running
   scripts have finished executing, the user agent must <a href="section-scripting.html#firing2">fire a simple event</a> called <code title="event-volumechange"><a href="#volumechange">volumechange</a></code>
   at the <a href="#media5">media element</a>.

  </p><h5 id="time-range"><span class="secno">3.14.9.11. </span>Time range</h5>

  <p>Objects implementing the <code><a href="#timeranges">TimeRanges</a></code> interface represent a list of
   ranges (periods) of time.

  </p><pre class="idl">interface <dfn id="timeranges">TimeRanges</dfn> {
  readonly attribute unsigned long <a href="#length3" title="dom-TimeRanges-length">length</a>;
  float <a href="#start4" title="dom-TimeRanges-start">start</a>(in unsigned long index);
  float <a href="#endindex" title="dom-TimeRanges-end">end</a>(in unsigned long index);
};</pre>

  <p>The <dfn id="length3" title="dom-TimeRanges-length"><code>length</code></dfn> DOM attribute must
   return the number of ranges represented by the object.

  </p><p>The <dfn id="start4" title="dom-TimeRanges-start"><code>start(<var title="">index</var>)</code></dfn> method must return the position of the
   start of the <var title="">index</var>th range represented by the object,
   in seconds measured from the start of the timeline that the object covers.

  </p><p>The <dfn id="endindex" title="dom-TimeRanges-end"><code>end(<var title="">index</var>)</code></dfn> method must return the position of the
   end of the <var title="">index</var>th range represented by the object, in
   seconds measured from the start of the timeline that the object covers.

  </p><p>These methods must raise <code>INDEX_SIZE_ERR</code> exceptions if
   called with an <var title="">index</var> argument greater than or equal to
   the number of ranges represented by the object.

  </p><p>When a <code><a href="#timeranges">TimeRanges</a></code> object is said
   to be a <dfn id="normalised">normalised <code>TimeRanges</code>
   object</dfn>, the ranges it represents must obey the following criteria:

  </p><ul>
   <li>The start of a range must be greater than the end of all earlier
    ranges.

   </li><li>The start of a range must be less than the end of that same range.
  </li></ul>

  <p>In other words, the ranges in such an object are ordered, don't overlap,
   and don't touch (adjacent ranges are folded into one bigger range).

  </p><p>The timelines used by the objects returned by the <code title="dom-media-buffered"><a href="#buffered">buffered</a></code>, <code title="dom-media-seekable"><a href="#seekable">seekable</a></code> and <code title="dom-media-played"><a href="#played">played</a></code> DOM attributes
   of <a href="#media5" title="media element">media elements</a> must be the
   same as that element's <a href="#media8">media resource</a>'s timeline.

  </p><h5 id="mediaevents"><span class="secno">3.14.9.12. </span>Event summary</h5>

  <p>The following events fire on <a href="#media5" title="media
   element">media elements</a> as part of the processing model described
   above:

  </p><table>
   <thead>
    <tr>
     <th>Event name

     </th><th>Interface

     </th><th>Dispatched when...

     </th><th>Preconditions

   </th></tr></thead><tbody>
    <tr>
     <td><dfn id="begin" title="event-begin"><code>begin</code></dfn>

     </td><td><code>ProgressEvent</code> <a href="#refsPROGRESS">[PROGRESS]</a>

     </td><td>The user agent begins fetching the <a href="#media7">media data</a>,
      synchronously during the <code title="dom-media-load"><a href="#load">load()</a></code> method call.

     </td><td><code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> equals <code title="dom-media-LOADING"><a href="#loading0">LOADING</a></code>

    </td></tr><tr>
     <td><dfn id="progress0" title="event-progress"><code>progress</code></dfn>

     </td><td><code>ProgressEvent</code> <a href="#refsPROGRESS">[PROGRESS]</a>

     </td><td>The user agent is fetching <a href="#media7">media data</a>.

     </td><td><code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is more than <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> and less than
      <code title="dom-media-LOADED"><a href="#loaded">LOADED</a></code>

    </td></tr><tr>
     <td><dfn id="loadedmetadata0" title="event-loadedmetadata"><code>loadedmetadata</code></dfn>

     </td><td><code>Event</code>

     </td><td>The user agent is fetching <a href="#media7">media data</a>, and the
      <a href="#media8">media resource</a>'s metadata has just been received.
      

     </td><td><code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> equals <code title="dom-media-LOADED_METADATA"><a href="#loadedmetadata">LOADED_METADATA</a></code>

    </td></tr><tr>
     <td><dfn id="loadedfirstframe0" title="event-loadedfirstframe"><code>loadedfirstframe</code></dfn>

     </td><td><code>Event</code>

     </td><td>The user agent is fetching <a href="#media7">media data</a>, and the
      <a href="#media8">media resource</a>'s first frame has just been
      received.

     </td><td><code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> equals <code title="dom-media-LOADED_FIRST_FRAME"><a href="#loadedfirstframe">LOADED_FIRST_FRAME</a></code>

    </td></tr><tr>
     <td><dfn id="load0" title="event-load"><code>load</code></dfn>

     </td><td><code>ProgressEvent</code> <a href="#refsPROGRESS">[PROGRESS]</a>

     </td><td>The user agent finishes downloading the entire <a href="#media8">media resource</a>.

     </td><td><code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> equals <code title="dom-media-LOADED"><a href="#loaded">LOADED</a></code>

    </td></tr><tr>
     <td><dfn id="abort" title="event-abort"><code>abort</code></dfn>

     </td><td><code>ProgressEvent</code> <a href="#refsPROGRESS">[PROGRESS]</a>

     </td><td>The user agent stops fetching the <a href="#media7">media data</a>
      before it is completely downloaded. This can be fired synchronously
      during the <code title="dom-media-load"><a href="#load">load()</a></code>
      method call.

     </td><td><code title="dom-media-error"><a href="#error0">error</a></code> is an
      object with the code <code title="dom-MediaError-MEDIA_ERR_ABORTED"><a href="#mediaerraborted">MEDIA_ERR_ABORTED</a></code>. <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> equals either <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> or <code title="dom-media-LOADED"><a href="#loaded">LOADED</a></code>, depending
      on when the download was aborted.

    </td></tr><tr>
     <td><dfn id="error1" title="event-error"><code>error</code></dfn>

     </td><td><code>ProgressEvent</code> <a href="#refsPROGRESS">[PROGRESS]</a>

     </td><td>An error occurs while fetching the <a href="#media7">media data</a>.
      

     </td><td><code title="dom-media-error"><a href="#error0">error</a></code> is an
      object with the code <code title="dom-MediaError-MEDIA_ERR_NETWORK_ERROR">MEDIA_ERR_NETWORK_ERROR</code>
      or higher. <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> equals either <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> or <code title="dom-media-LOADED"><a href="#loaded">LOADED</a></code>, depending
      on when the download was aborted.

    </td></tr><tr>
     <td><dfn id="emptied" title="event-emptied"><code>emptied</code></dfn>

     </td><td><code>Event</code>

     </td><td>A <a href="#media5">media element</a> whose <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> was previously not in the
      <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> state has
      just switched to that state (either because of a fatal error during
      load that's about to be reported, or because the <code title="dom-media-load"><a href="#load">load()</a></code> method was
      reinvoked, in which case it is fired synchronously during the <code title="dom-media-load"><a href="#load">load()</a></code> method call).

     </td><td><code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code>; all the DOM
      attributes are in their initial states.

    </td></tr><tr>
     <td><dfn id="stalled" title="event-stalled"><code>stalled</code></dfn>

     </td><td><code>ProgressEvent</code>

     </td><td>The user agent is trying to fetch <a href="#media7">media data</a>,
      but data is unexpectedly not forthcoming.

     </td><td>

    </td></tr><tr>
     <td><dfn id="play0" title="event-play"><code>play</code></dfn>

     </td><td><code>Event</code>

     </td><td>Playback has begun. Fired after the <code title="dom-media-play"><a href="#play">play</a></code> method has returned.

     </td><td><code title="dom-media-paused"><a href="#paused">paused</a></code> is
      newly false.

    </td></tr><tr>
     <td><dfn id="pause1" title="event-pause"><code>pause</code></dfn>

     </td><td><code>Event</code>

     </td><td>Playback has been paused. Fired after the <code title="dom-media-pause"><a href="#pause0">pause</a></code> method has
      returned.

     </td><td><code title="dom-media-paused"><a href="#paused">paused</a></code> is
      newly true.

    </td></tr><tr>
     <td><dfn id="waiting" title="event-waiting"><code>waiting</code></dfn>

     </td><td><code>Event</code>

     </td><td>Playback has stopped because the next frame is not available, but
      the user agent expects that frame to become available in due course.

     </td><td><code title="dom-media-readyState"><a href="#readystate">readyState</a></code> is either <code title="dom-media-DATA_UNAVAILABLE"><a href="#dataunavailable">DATA_UNAVAILABLE</a></code> or <code title="dom-media-CAN_SHOW_CURRENT_FRAME"><a href="#canshowcurrentframe">CAN_SHOW_CURRENT_FRAME</a></code>, and
      <code title="dom-media-paused"><a href="#paused">paused</a></code> is
      false. Either <code title="dom-media-seeking"><a href="#seeking0">seeking</a></code> is true, or the <a href="#current">current playback position</a> is not contained in any
      of the ranges in <code title="dom-media-buffered"><a href="#buffered">buffered</a></code>. It is possible for playback to
      stop for two other reasons without <code title="dom-media-paused"><a href="#paused">paused</a></code> being false, but those two reasons do
      not fire this event: maybe <a href="#ended" title="ended
      playback">playback ended</a>, or playback <a href="#stopped">stopped
      due to errors</a>.

    </td></tr><tr>
     <td><dfn id="timeupdate" title="event-timeupdate"><code>timeupdate</code></dfn>

     </td><td><code>Event</code>

     </td><td>The <a href="#current">current playback position</a> changed in an
      interesting way, for example discontinuously.

     </td><td>

    </td></tr><tr>
     <td><dfn id="ended1" title="event-ended"><code>ended</code></dfn>

     </td><td><code>Event</code>

     </td><td>Playback has stopped because the end of the <a href="#media8">media
      resource</a> was reached.

     </td><td><code title="dom-media-currentTime"><a href="#currenttime">currentTime</a></code> equals the <var><a href="#effective2">effective end</a></var>; <code title="dom-media-ended"><a href="#ended0">ended</a></code> is true.

    </td></tr><tr>
     <td><dfn id="dataunavailable0" title="event-dataunavailable"><code>dataunavailable</code></dfn>

     </td><td><code>Event</code>

     </td><td>The user agent cannot render the data at the <a href="#current">current playback position</a> because data for the
      current frame is not immediately available.

     </td><td>The <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> attribute is newly equal to
      <code title="DATA_UNAVAILABLE">DATA_UNAVAILABLE</code>.

    </td></tr><tr>
     <td><dfn id="canshowcurrentframe0" title="event-canshowcurrentframe"><code>canshowcurrentframe</code></dfn>

     </td><td><code>Event</code>

     </td><td>The user agent cannot render the data after the <a href="#current">current playback position</a> because data for the next
      frame is not immediately available.

     </td><td>The <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> attribute is newly equal to
      <code title="dom-media-CAN_SHOW_CURRENT_FRAME"><a href="#canshowcurrentframe">CAN_SHOW_CURRENT_FRAME</a></code>.

    </td></tr><tr>
     <td><dfn id="canplay0" title="event-canplay"><code>canplay</code></dfn>

     </td><td><code>Event</code>

     </td><td>The user agent can resume playback of the <a href="#media7">media
      data</a>, but estimates that if playback were to be started now, the <a href="#media8">media resource</a> could not be rendered at the current
      playback rate up to its end without having to stop for further
      buffering of content.

     </td><td>The <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> attribute is newly equal to
      <code title="dom-media-CAN_PLAY"><a href="#canplay">CAN_PLAY</a></code>.

    </td></tr><tr>
     <td><dfn id="canplaythrough0" title="event-canplaythrough"><code>canplaythrough</code></dfn>

     </td><td><code>Event</code>

     </td><td>The user agent estimates that if playback were to be started now,
      the <a href="#media8">media resource</a> could be rendered at the
      current playback rate all the way to its end without having to stop for
      further buffering.

     </td><td>The <code title="dom-media-readyState"><a href="#readystate">readyState</a></code> attribute is newly equal to
      <code title="dom-media-CAN_PLAY_THROUGH"><a href="#canplaythrough">CAN_PLAY_THROUGH</a></code>.

    </td></tr><tr>
     <td><dfn id="ratechange" title="event-ratehange"><code>ratechange</code></dfn>

     </td><td><code>Event</code>

     </td><td>Either the <code title="dom-media-defaultPlaybackRate"><a href="#defaultplaybackrate">defaultPlaybackRate</a></code> or the <code title="dom-media-playbackRate"><a href="#playbackrate">playbackRate</a></code> attribute has just been
      updated.

     </td><td>

    </td></tr><tr>
     <td><dfn id="durationchange" title="event-durationchange"><code>durationchange</code></dfn>

     </td><td><code>Event</code>

     </td><td>The <code title="dom-media-duration"><a href="#duration">duration</a></code> attribute has just been updated.

     </td><td>

    </td></tr><tr>
     <td><dfn id="volumechange" title="event-volumechange"><code>volumechange</code></dfn>

     </td><td><code>Event</code>

     </td><td>Either the <code title="dom-media-volume"><a href="#volume">volume</a></code> attribute or the <code title="dom-media-muted"><a href="#muted">muted</a></code> attribute has
      changed. Fired after the relevant attribute's setter has returned.

     </td><td>
  </td></tr></tbody></table>

  <h5 id="security0"><span class="secno">3.14.9.13. </span>Security and privacy
   considerations</h5>

  <p class="big-issue">Talk about making sure interactive media files (e.g.
   SVG) don't have access to the container DOM (XSS potential); talk about
   not exposing any sensitive data like metadata from tracks in the media
   files (intranet snooping risk)

  </p><h4 id="the-source"><span class="secno">3.14.10. </span>The <dfn id="source"><code>source</code></dfn> element</h4>
  <!-- element has no special category -->

  <dl class="element">
   <dt>Contexts in which this element may be used:

   </dt><dd>As a child of a <a href="#media5">media element</a>, before any
    content other than <code><a href="#source">source</a></code> elements.

   </dd><dt>Content model:

   </dt><dd>Empty.

   </dd><dt>Element-specific attributes:

   </dt><dd><code title="attr-source-src"><a href="#src7">src</a></code> (required)

   </dd><dd><code title="attr-source-type"><a href="#type8">type</a></code>

   </dd><dd><code title="attr-source-media"><a href="#media9">media</a></code>

   </dd><dt>DOM interface:

   </dt><dd>
    <pre class="idl">interface <dfn id="htmlsourceelement">HTMLSourceElement</dfn> : <a href="section-elements.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a href="#src8" title="dom-source-src">src</a>;
           attribute DOMString <a href="#type9" title="dom-source-type">type</a>;
           attribute DOMString <a href="#media10" title="dom-source-media">media</a>;
};</pre>
  </dd></dl>

  <p>The <code><a href="#source">source</a></code> element allows authors to
   specify multiple <a href="#media8" title="media resource">media
   resources</a> for <a href="#media5" title="media element">media
   elements</a>.

  </p><p>The <dfn id="src7" title="attr-source-src"><code>src</code></dfn> attribute
   gives the address of the <a href="#media8">media resource</a>. The value
   must be a URI (or IRI). This attribute must be present.

  </p><p>The <dfn id="type8" title="attr-source-type"><code>type</code></dfn>
   attribute gives the type of the <a href="#media8">media resource</a>, to
   help the user agent determine if it can play this <a href="#media8">media
   resource</a> before downloading it. Its value must be a MIME type. The
   <code title="">codecs</code> parameter may be specified and might be
   necessary to specify exactly how the resource is encoded. <a href="#refsRFC2046">[RFC2046]</a> <a href="#refsRFC4281">[RFC4281]</a>

  </p><div class="example">
   <p>The following list shows some examples of how to use the <code title="">codecs=</code> MIME parameter in the <code title="attr-source-type"><a href="#type8">type</a></code> attribute.</p>

   <dl>
    <dt>H.264 Simple baseline profile video (main and extended video
     compatible) level 3 and Low-Complexity AAC audio in MP4 container

    </dt><dd>
     <pre>&lt;source src=&quot;video.mp4&quot; type=&quot;video/mp4; codecs=&amp;quot;avc1.42E01E, mp4a.40.2&amp;quot;&quot;&gt;</pre>

    </dd><dt>H.264 Extended profile video (baseline-compatible) level 3 and
     Low-Complexity AAC audio in MP4 container

    </dt><dd>
     <pre>&lt;source src=&quot;video.mp4&quot; type=&quot;video/mp4; codecs=&amp;quot;avc1.58A01E, mp4a.40.2&amp;quot;&quot;&gt;</pre>

    </dd><dt>H.264 Main profile video level 3 and Low-Complexity AAC audio in MP4
     container

    </dt><dd>
     <pre>&lt;source src=&quot;video.mp4&quot; type=&quot;video/mp4; codecs=&amp;quot;avc1.4D401E, mp4a.40.2&amp;quot;&quot;&gt;</pre>

    </dd><dt>H.264 &quot;High&quot; profile video (incompatible with main, baseline, or
     extended profiles) level 3 and Low-Complexity AAC audio in MP4 container

    </dt><dd>
     <pre>&lt;source src=&quot;video.mp4&quot; type=&quot;video/mp4; codecs=&amp;quot;avc1.64001E, mp4a.40.2&amp;quot;&quot;&gt;</pre>

    </dd><dt>MPEG-4 Visual Simple Profile Level 0 video and Low-Complexity AAC
     audio in MP4 container

    </dt><dd>
     <pre>&lt;source src=&quot;video.mp4&quot; type=&quot;video/mp4; codecs=&amp;quot;mp4v.20.8, mp4a.40.2&amp;quot;&quot;&gt;</pre>

    </dd><dt>MPEG-4 Advanced Simple Profile Level 0 video and Low-Complexity AAC
     audio in MP4 container

    </dt><dd>
     <pre>&lt;source src=&quot;video.mp4&quot; type=&quot;video/mp4; codecs=&amp;quot;mp4v.20.240, mp4a.40.2&amp;quot;&quot;&gt;</pre>

    </dd><dt>MPEG-4 Visual Simple Profile Level 0 video and AMR audio in 3GPP
     container

    </dt><dd>
     <pre>&lt;source src=&quot;video.3gp&quot; type=&quot;video/3gpp; codecs=&amp;quot;mp4v.20.8, samr&amp;quot;&quot;&gt;</pre>

    </dd><dt>Theora video and Vorbis audio in Ogg container

    </dt><dd>
     <pre>&lt;source src=&quot;video.ogv&quot; type=&quot;video/ogg; codecs=&amp;quot;theora, vorbis&amp;quot;&quot;&gt;</pre>

    </dd><dt>Theora video and Speex audio in Ogg container

    </dt><dd>
     <pre>&lt;source src=&quot;video.ogv&quot; type=&quot;video/ogg; codecs=&amp;quot;theora, speex&amp;quot;&quot;&gt;</pre>

    </dd><dt>Vorbis audio alone in Ogg container

    </dt><dd>
     <pre>&lt;source src=&quot;audio.oga&quot; type=&quot;audio/ogg; codecs=vorbis&quot;&gt;</pre>
    </dd>
    <!-- you also see .ogg but .oga is preferred -->

    <dt>Speex audio alone in Ogg container

    </dt><dd>
     <pre>&lt;source src=&quot;audio.oga&quot; type=&quot;audio/ogg; codecs=speex&quot;&gt;</pre>
    </dd>
    <!-- you also see .spx but .oga is preferred -->

    <dt>Flac audio alone in Ogg container

    </dt><dd>
     <pre>&lt;source src=&quot;audio.oga&quot; type=&quot;audio/ogg; codecs=flac&quot;&gt;</pre>

    </dd><dt>Dirac video and Vorbis audio in Ogg container

    </dt><dd>
     <pre>&lt;source src=&quot;video.ogv&quot; type=&quot;video/ogg; codecs=&amp;quot;dirac, vorbis&amp;quot;&quot;&gt;</pre>

    </dd><dt>Theora video and Vorbis audio in Matroska container

    </dt><dd>
     <pre>&lt;source src=&quot;video.mkv&quot; type=&quot;video/x-matroska; codecs=&amp;quot;theora, vorbis&amp;quot;&quot;&gt;</pre>
    </dd>
    <!-- awaiting definition by the Ogg or BBC guys:
    <dt>Dirac video and Vorbis audio in Matroska container</dt>
    <dd><pre>&lt;source src="video.mkv" type="video/x-matroska; codecs="></pre></dd>
-->
    <!-- awaiting definition by the Microsoft guys:

    <dt>WMV9 video and WMA 2 audio in ASF container</dt>
    <dd><pre>&lt;source src="video.wmv" type="video/x-ms-wmv; codecs="></pre></dd>

    <dt>WMV8 video and WMA 2 audio in ASF container</dt>
    <dd><pre>&lt;source src="video.wmv" type="video/x-ms-wmv; codecs="></pre></dd>

    <dt>VC-1 video and WMA 10 Pro audio in ASF container</dt>
    <dd><pre>&lt;source src="video.wmv" type="video/x-ms-wmv; codecs="></pre></dd>

    <dt>XviD video and MP3 audio in AVI container</dt>
    <dd><pre>&lt;source src="video.avi" type="video/x-msvideo; codecs="></pre></dd>

    <dt>Motion-JPEG video and uncompressed PCM audio in AVI container</dt>
    <dd><pre>&lt;source src="video.avi" type="video/x-msvideo; codecs="></pre></dd>

-->
    <!-- awaiting definition by Real:
    <dt>Real Video 10 video and High-Efficiency AAC audio in Real Media container</dt>
    <dd><pre>&lt;source src="video.rm" type="application/vnd.rn-realmedia; codecs="></pre></dd>
-->
    <!--  undefined:
    <dt>MPEG-1 video and MPEG-1 Audio Layer II audio in MPEG-1 program stream</dt>
    <dd><pre>&lt;source src="video.mpg" type="video/mpeg; codecs="></pre></dd>
-->
   </dl>
   <!-- XXX #refs https://trac.xiph.org/browser/experimental/ivo/drafts/draft-xiph-rfc3534bis.txt may be relevant -->
   </div>

  <p>The <dfn id="media9" title="attr-source-media"><code>media</code></dfn>
   attribute gives the intended media type of the <a href="#media8">media
   resource</a>, to help the user agent determine if this <a href="#media8">media resource</a> is useful to the user before downloading
   it. Its value must be a valid media query. <a href="#refsMQ">[MQ]</a>

  </p><p>Either the <code title="attr-source-type"><a href="#type8">type</a></code>
   attribute, the <code title="attr-source-media"><a href="#media9">media</a></code> attribute or both, must be specified,
   unless this is the last <code><a href="#source">source</a></code> element
   child of the parent element.

  </p><p>If a <code><a href="#source">source</a></code> element is inserted into
   a <a href="#media5">media element</a> that is already in a document and
   whose <code title="dom-media-networkState"><a href="#networkstate">networkState</a></code> is in the <code title="dom-media-EMPTY"><a href="#empty">EMPTY</a></code> state, the user
   agent must implicitly invoke the <code title="dom-media-load"><a href="#load">load()</a></code> method on the <a href="#media5">media
   element</a> as soon as all other scripts have finished executing. Any
   exceptions raised must be ignored.

  </p><p>The DOM attributes <dfn id="src8" title="dom-source-src"><code>src</code></dfn>, <dfn id="type9" title="dom-source-type"><code>type</code></dfn>, and <dfn id="media10" title="dom-source-media"><code>media</code></dfn> must <a href="section-elements.html#reflect">reflect</a> the respective content attributes of the same
   name.

  </p><script src="http://status.whatwg.org/annotate-web-apps.js" type="text/javascript"></script></body></html>
